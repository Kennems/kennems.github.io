<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Kennem</title>
<meta name="keywords" content="">
<meta name="description" content="acwingç®—æ³•å­¦ä¹  [TOC] ç¬¬ä¸€ç«  è¯¾ä¸Šï¼šå­¦æ€æƒ³ è¯¾ä¸‹ï¼šèƒŒä»£ç  é¢˜ç›®ï¼Œä¸€é“é¢˜å†™å¥½å‡ é ç†è§£æ²¡æœ‰ä»»ä½•æ„ä¹‰ï¼Œä½“åŠ›æ´»&#43;è„‘åŠ›æ´» è®°å¿†åŠ› æ¯…åŠ›/è‡ªåˆ¶åŠ› æ²‰ä¸‹å¿ƒèƒŒä¸œè¥¿ å¿«é€Ÿæ’">
<meta name="author" content="ShowGuan">
<link rel="canonical" href="https://kennems.github.io/en/posts/tech/acwing/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.92e6d237fe179cc604a93575ea9ce4dbea8c09a9b1c7aa3449a9a0514c2b3ab5.css" integrity="sha256-kubSN/4XnMYEqTV16pzk2&#43;qMCamxx6o0SamgUUwrOrU=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://kennems.github.io/img/sun.png">
<link rel="icon" type="image/png" sizes="16x16" href="https://kennems.github.io/img/sun.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://kennems.github.io/img/sun.png">
<link rel="apple-touch-icon" href="https://kennems.github.io/sun.png">
<link rel="mask-icon" href="https://kennems.github.io/sun.png">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://kennems.github.io/en/posts/tech/acwing/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous">

<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.js" integrity="sha384-VQ8d8WVFw0yHhCk5E8I86oOhv48xLpnDZx5T9GogA/Y84DcCKWXDmSDfn13bzFZY" crossorigin="anonymous"></script>

<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/contrib/auto-render.min.js" integrity="sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR" crossorigin="anonymous"
    onload="renderMathInElement(document.body);"></script>


<script>
document.addEventListener("DOMContentLoaded", function() {
    renderMathInElement(document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "$", right: "$", display: false}
        ]
    });
});
</script>


<link href="https://fonts.cdnfonts.com/css/code-new-roman" rel="stylesheet">
                <meta property="og:title" content="" />
<meta property="og:description" content="acwingç®—æ³•å­¦ä¹  [TOC] ç¬¬ä¸€ç«  è¯¾ä¸Šï¼šå­¦æ€æƒ³ è¯¾ä¸‹ï¼šèƒŒä»£ç  é¢˜ç›®ï¼Œä¸€é“é¢˜å†™å¥½å‡ é ç†è§£æ²¡æœ‰ä»»ä½•æ„ä¹‰ï¼Œä½“åŠ›æ´»&#43;è„‘åŠ›æ´» è®°å¿†åŠ› æ¯…åŠ›/è‡ªåˆ¶åŠ› æ²‰ä¸‹å¿ƒèƒŒä¸œè¥¿ å¿«é€Ÿæ’" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://kennems.github.io/en/posts/tech/acwing/" /><meta property="article:section" content="posts" />



<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content=""/>
<meta name="twitter:description" content="acwingç®—æ³•å­¦ä¹  [TOC] ç¬¬ä¸€ç«  è¯¾ä¸Šï¼šå­¦æ€æƒ³ è¯¾ä¸‹ï¼šèƒŒä»£ç  é¢˜ç›®ï¼Œä¸€é“é¢˜å†™å¥½å‡ é ç†è§£æ²¡æœ‰ä»»ä½•æ„ä¹‰ï¼Œä½“åŠ›æ´»&#43;è„‘åŠ›æ´» è®°å¿†åŠ› æ¯…åŠ›/è‡ªåˆ¶åŠ› æ²‰ä¸‹å¿ƒèƒŒä¸œè¥¿ å¿«é€Ÿæ’"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "ğŸ“šæ–‡ç« ",
      "item": "https://kennems.github.io/en/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "ğŸ’»æŠ€æœ¯",
      "item": "https://kennems.github.io/en/posts/tech/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "",
      "item": "https://kennems.github.io/en/posts/tech/acwing/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "",
  "name": "",
  "description": "acwingç®—æ³•å­¦ä¹  [TOC] ç¬¬ä¸€ç«  è¯¾ä¸Šï¼šå­¦æ€æƒ³ è¯¾ä¸‹ï¼šèƒŒä»£ç  é¢˜ç›®ï¼Œä¸€é“é¢˜å†™å¥½å‡ é ç†è§£æ²¡æœ‰ä»»ä½•æ„ä¹‰ï¼Œä½“åŠ›æ´»+è„‘åŠ›æ´» è®°å¿†åŠ› æ¯…åŠ›/è‡ªåˆ¶åŠ› æ²‰ä¸‹å¿ƒèƒŒä¸œè¥¿ å¿«é€Ÿæ’",
  "keywords": [
    
  ],
  "articleBody": "acwingç®—æ³•å­¦ä¹  [TOC]\nç¬¬ä¸€ç«  è¯¾ä¸Šï¼šå­¦æ€æƒ³\nè¯¾ä¸‹ï¼šèƒŒä»£ç \né¢˜ç›®ï¼Œä¸€é“é¢˜å†™å¥½å‡ é\nç†è§£æ²¡æœ‰ä»»ä½•æ„ä¹‰ï¼Œä½“åŠ›æ´»+è„‘åŠ›æ´»\nè®°å¿†åŠ› æ¯…åŠ›/è‡ªåˆ¶åŠ›\næ²‰ä¸‹å¿ƒèƒŒä¸œè¥¿\nå¿«é€Ÿæ’åºç®—æ³•æ¨¡æ¿ â€”â€” æ¨¡æ¿é¢˜ AcWing 785. å¿«é€Ÿæ’åº åˆ†æ²»\n1ã€ç¡®å®šåˆ†ç•Œç‚¹ï¼Œlã€rã€ï¼ˆl+r)/2 éšæœº\n2ã€è°ƒæ•´åŒºé—´ï¼Œåˆ†ä¸ºä¸¤è¾¹ï¼Œå·¦è¾¹å°äºç­‰äºx,å³è¾¹å¤§äºç­‰äºx\n3ã€é€’å½’å¤„ç†å·¦å³ä¸¤æ®µ\nvoid quick_sort(int q[], int l, int r) { if (l \u003e= r) return; int i = l - 1, j = r + 1, x = q[l + r \u003e\u003e 1]; while (i \u003c j) { do i ++ ; while (q[i] \u003c x); do j -- ; while (q[j] \u003e x); if (i \u003c j) swap(q[i], q[j]); } quick_sort(q, l, j), quick_sort(q, j + 1, r); } -std=c++11 å½’å¹¶æ’åºç®—æ³•æ¨¡æ¿ â€”â€” æ¨¡æ¿é¢˜ AcWing 787. å½’å¹¶æ’åº æ’åºç¨³å®šï¼šåºåˆ—ä¸­ç›¸åŒçš„å€¼æ’åºåçš„ç›¸å¯¹ä½ç½®æ˜¯å¦å‘ç”Ÿæ”¹å˜\næ—¶é—´å¤æ‚åº¦æœ‰ ï¼ˆnlogn)\n1ï¼‰ç¡®å®šåˆ†ç•Œç‚¹mid\n2ï¼‰é€’å½’æ’åºä¸¤è¾¹\n2ï¼‰å½’å¹¶ï¼Œåˆå¹¶ä¸ºä¸€ä¸ªæœ‰åºæ•°ç»„\nvoid merge_sort(int q[], int l, int r) { if (l \u003e= r) return; int mid = l + r \u003e\u003e 1; merge_sort(q, l, mid); merge_sort(q, mid + 1, r); int k = 0, i = l, j = mid + 1; while (i \u003c= mid \u0026\u0026 j \u003c= r) if (q[i] \u003c q[j]) tmp[k ++ ] = q[i ++ ]; else tmp[k ++ ] = q[j ++ ]; while (i \u003c= mid) tmp[k ++ ] = q[i ++ ]; while (j \u003c= r) tmp[k ++ ] = q[j ++ ]; for (i = l, j = 0; i \u003c= r; i ++, j ++ ) q[i] = tmp[j]; } æ•´æ•°äºŒåˆ†ç®—æ³•æ¨¡æ¿ â€”â€” æ¨¡æ¿é¢˜ AcWing 789. æ•°çš„èŒƒå›´ è¾¹ç•Œé—®é¢˜\næœ¬è´¨ï¼šåŒºé—´å†…ä¸€åŠæ»¡è¶³ä¸€åŠä¸æ»¡è¶³\nl=midæ—¶åŠ ä¸€\nbool check(int x) {/* ... */} // æ£€æŸ¥xæ˜¯å¦æ»¡è¶³æŸç§æ€§è´¨ // åŒºé—´[l, r]è¢«åˆ’åˆ†æˆ[l, mid]å’Œ[mid + 1, r]æ—¶ä½¿ç”¨ï¼š int bsearch_1(int l, int r) { while (l \u003c r) { int mid = l + r \u003e\u003e 1; if (check(mid)) r = mid; // check()åˆ¤æ–­midæ˜¯å¦æ»¡è¶³æ€§è´¨ else l = mid + 1; } return l; } // åŒºé—´[l, r]è¢«åˆ’åˆ†æˆ[l, mid - 1]å’Œ[mid, r]æ—¶ä½¿ç”¨ï¼š int bsearch_2(int l, int r) { while (l \u003c r) { int mid = l + r + 1 \u003e\u003e 1; if (check(mid)) l = mid; else r = mid - 1; } return l; } æµ®ç‚¹æ•°äºŒåˆ†ç®—æ³•æ¨¡æ¿ â€”â€” æ¨¡æ¿é¢˜ AcWing 790. æ•°çš„ä¸‰æ¬¡æ–¹æ ¹ æµ®ç‚¹æ•°äºŒåˆ†ï¼Œæ¯”è¾ƒå¯¹åº”æ•´æ•°äºŒåˆ†\nbool check(double x) {/* ... */} // æ£€æŸ¥xæ˜¯å¦æ»¡è¶³æŸç§æ€§è´¨ double bsearch_3(double l, double r) { const double eps = 1e-6; // eps è¡¨ç¤ºç²¾åº¦ï¼Œå–å†³äºé¢˜ç›®å¯¹ç²¾åº¦çš„è¦æ±‚ while (r - l \u003e eps) { double mid = (l + r) / 2; if (check(mid)) r = mid; else l = mid; } return l; } é«˜ç²¾åº¦åŠ æ³• â€”â€” æ¨¡æ¿é¢˜ AcWing 791. é«˜ç²¾åº¦åŠ æ³• // C = A + B, A \u003e= 0, B \u003e= 0 vector\u003cint\u003e add(vector\u003cint\u003e \u0026A, vector\u003cint\u003e \u0026B) { if (A.size() \u003c B.size()) return add(B, A); vector\u003cint\u003e C; int t = 0; for (int i = 0; i \u003c A.size(); i ++ ) { t += A[i]; if (i \u003c B.size()) t += B[i]; C.push_back(t % 10); t /= 10; } if (t) C.push_back(t); return C; } é«˜ç²¾åº¦å‡æ³• â€”â€” æ¨¡æ¿é¢˜ AcWing 792. é«˜ç²¾åº¦å‡æ³• // C = A - B, æ»¡è¶³A \u003e= B, A \u003e= 0, B \u003e= 0 vector\u003cint\u003e sub(vector\u003cint\u003e \u0026A, vector\u003cint\u003e \u0026B) { vector\u003cint\u003e C; for (int i = 0, t = 0; i \u003c A.size(); i ++ ) { t = A[i] - t; if (i \u003c B.size()) t -= B[i]; C.push_back((t + 10) % 10); if (t \u003c 0) t = 1; else t = 0; } while (C.size() \u003e 1 \u0026\u0026 C.back() == 0) C.pop_back(); return C; } é«˜ç²¾åº¦ä¹˜ä½ç²¾åº¦ â€”â€” æ¨¡æ¿é¢˜ AcWing 793. é«˜ç²¾åº¦ä¹˜æ³• // C = A * b, A \u003e= 0, b \u003e 0 vector\u003cint\u003e mul(vector\u003cint\u003e \u0026A, int b) { vector\u003cint\u003e C; int t = 0; for (int i = 0; i \u003c A.size() || t; i ++ ) { if (i \u003c A.size()) t += A[i] * b; C.push_back(t % 10); t /= 10; } return C; } é«˜ç²¾åº¦é™¤ä»¥ä½ç²¾åº¦ â€”â€” æ¨¡æ¿é¢˜ AcWing 794. é«˜ç²¾åº¦é™¤æ³• // A / b = C ... r, A \u003e= 0, b \u003e 0 vector\u003cint\u003e div(vector\u003cint\u003e \u0026A, int b, int \u0026r) { vector\u003cint\u003e C; r = 0; for (int i = A.size() - 1; i \u003e= 0; i -- ) { r = r * 10 + A[i]; C.push_back(r / b); r %= b; } reverse(C.begin(), C.end()); while (C.size() \u003e 1 \u0026\u0026 C.back() == 0) C.pop_back(); return C; } ä¸€ç»´å‰ç¼€å’Œ â€”â€” æ¨¡æ¿é¢˜ AcWing 795. å‰ç¼€å’Œ å¿«é€Ÿæ±‚åŒºé—´å’Œ\nS[i] = a[1] + a[2] + ... a[i] a[l] + ... + a[r] = S[r] - S[l - 1] ä»1å¼€å§‹ï¼Œä¾¿äºå¤„ç†è¾¹ç•Œ äºŒç»´å‰ç¼€å’Œ â€”â€” æ¨¡æ¿é¢˜ AcWing 796. å­çŸ©é˜µçš„å’Œ S[i, j] = ç¬¬iè¡Œjåˆ—æ ¼å­å·¦ä¸Šéƒ¨åˆ†æ‰€æœ‰å…ƒç´ çš„å’Œ ä»¥(x1, y1)ä¸ºå·¦ä¸Šè§’ï¼Œ(x2, y2)ä¸ºå³ä¸‹è§’çš„å­çŸ©é˜µçš„å’Œä¸ºï¼š S[x2, y2] - S[x1 - 1, y2] - S[x2, y1 - 1] + S[x1 - 1, y1 - 1] ä¸€ç»´å·®åˆ† â€”â€” æ¨¡æ¿é¢˜ AcWing 797. å·®åˆ† ç»™åŒºé—´[l, r]ä¸­çš„æ¯ä¸ªæ•°åŠ ä¸Šcï¼š B[l] += c, B[r + 1] -= c äºŒç»´å·®åˆ† â€”â€” æ¨¡æ¿é¢˜ AcWing 798. å·®åˆ†çŸ©é˜µ/äºŒç»´å·®åˆ† ç»™ä»¥(x1, y1)ä¸ºå·¦ä¸Šè§’ï¼Œ(x2, y2)ä¸ºå³ä¸‹è§’çš„å­çŸ©é˜µä¸­çš„æ‰€æœ‰å…ƒç´ åŠ ä¸Šcï¼š S[x1, y1] += c, S[x2 + 1, y1] -= c, S[x1, y2 + 1] -= c, S[x2 + 1, y2 + 1] += c åŒæŒ‡é’ˆç®—æ³• â€”â€” æ¨¡æ¿é¢˜ AcWIng 799. æœ€é•¿è¿ç»­ä¸é‡å¤å­åºåˆ—, AcWing 800. æ•°ç»„å…ƒç´ çš„ç›®æ ‡å’Œ __æ»‘åŠ¨çª—å£ï¼Ÿ æ ¸å¿ƒï¼šæŠŠO(n^2)ç®—æ³•ä¼˜åŒ–ä¸ºO(n)\nfor (int i = 0, j = 0; i \u003c n; i ++ ) { while (j \u003c i \u0026\u0026 check(j, i)) j ++ ; // å…·ä½“é—®é¢˜çš„é€»è¾‘ } å¸¸è§é—®é¢˜åˆ†ç±»ï¼š (1) å¯¹äºä¸€ä¸ªåºåˆ—ï¼Œç”¨ä¸¤ä¸ªæŒ‡é’ˆç»´æŠ¤ä¸€æ®µåŒºé—´ (2) å¯¹äºä¸¤ä¸ªåºåˆ—ï¼Œç»´æŠ¤æŸç§æ¬¡åºï¼Œæ¯”å¦‚å½’å¹¶æ’åºä¸­åˆå¹¶ä¸¤ä¸ªæœ‰åºåºåˆ—çš„æ“ä½œ ä½è¿ç®— â€”â€” æ¨¡æ¿é¢˜ AcWing 801. äºŒè¿›åˆ¶ä¸­1çš„ä¸ªæ•° åŸç ï¼Œåç ï¼Œè¡¥ç  æ±‚näºŒè¿›åˆ¶è¡¨ç¤ºä¸­ç¬¬kä½æ•°å­—: n \u003e\u003e k \u0026 1 è¿”å›nçš„æœ€åä¸€ä½1ï¼šlowbit(n) = n \u0026 -n æ ‘çŠ¶æ•°ç»„åŸºæœ¬æ“ä½œ æ•´æ•°ç¦»æ•£åŒ– â€”â€” æ¨¡æ¿é¢˜ AcWing 802. åŒºé—´å’Œ vector\u003cint\u003e alls; // å­˜å‚¨æ‰€æœ‰å¾…ç¦»æ•£åŒ–çš„å€¼ sort(alls.begin(), alls.end()); // å°†æ‰€æœ‰å€¼æ’åº alls.erase(unique(alls.begin(), alls.end())è¿”å›å»é‡åæ•°ç»„æœ«å°¾ç«¯ç‚¹, alls.end()); // å»æ‰é‡å¤å…ƒç´  // äºŒåˆ†æ±‚å‡ºxå¯¹åº”çš„ç¦»æ•£åŒ–çš„å€¼ int find(int x) // æ‰¾åˆ°ç¬¬ä¸€ä¸ªå¤§äºç­‰äºxçš„ä½ç½® { int l = 0, r = alls.size() - 1; while (l \u003c r) { int mid = l + r \u003e\u003e 1; if (alls[mid] \u003e= x) r = mid; else l = mid + 1; } return r + 1; // æ˜ å°„åˆ°1, 2, ...n } åŒºé—´åˆå¹¶ â€”â€” æ¨¡æ¿é¢˜ AcWing 803. åŒºé—´åˆå¹¶ // å°†æ‰€æœ‰å­˜åœ¨äº¤é›†çš„åŒºé—´åˆå¹¶ è´ªå¿ƒ void merge(vector\u003cPII\u003e \u0026segs) { vector\u003cPII\u003e res; sort(segs.begin(), segs.end()); //åŒºé—´å·¦ç«¯ç‚¹æ’åº int st = -2e9, ed = -2e9; for (auto seg : segs) if (ed \u003c seg.first) { if (st != -2e9) res.push_back({st, ed}); st = seg.first, ed = seg.second; } else ed = max(ed, seg.second); if (st != -2e9) res.push_back({st, ed}); segs = res; } ä½œè€…ï¼šyxc é“¾æ¥ï¼šhttps://www.acwing.com/blog/content/277/ æ¥æºï¼šAcWing è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚\nç¬¬äºŒç«  æ•°æ®ç»“æ„ï¼Œä»¥æ•°ç»„æ¨¡æ‹Ÿçš„å½¢å¼\næŒ‡é’ˆ+ç»“æ„ä½“ ï¼š é¢è¯•é¢˜\nå•é“¾è¡¨ â€”â€” æ¨¡æ¿é¢˜ AcWing 826. å•é“¾è¡¨ é‚»æ¥è¡¨-å­˜å‚¨æ ‘å’Œå›¾ é™æ€é“¾è¡¨\nä¸‹æ ‡ä»0å¼€å§‹\n// headå­˜å‚¨é“¾è¡¨å¤´ï¼Œe[]å­˜å‚¨èŠ‚ç‚¹çš„å€¼ï¼Œne[]å­˜å‚¨èŠ‚ç‚¹çš„nextæŒ‡é’ˆï¼Œidxè¡¨ç¤ºå½“å‰ç”¨åˆ°äº†å“ªä¸ªèŠ‚ç‚¹ int head, e[N], ne[N], idx; // åˆå§‹åŒ– void init() { head = -1; idx = 0; } // åœ¨é“¾è¡¨å¤´æ’å…¥ä¸€ä¸ªæ•°a void insert(int a) { e[idx] = a, ne[idx] = head, head = idx ++ ; } // æ’å…¥ä¸‹æ ‡kåé¢ void add(int k,int x) { e[idx]= x, ne[idx] = ne[k], ne[k] = idx++ ; } // å°†å¤´ç»“ç‚¹åˆ é™¤ï¼Œéœ€è¦ä¿è¯å¤´ç»“ç‚¹å­˜åœ¨ void remove() { head = ne[head]; } // å°†kåé¢çš„ç‚¹åˆ æ‰ void remove(int k) { ne[k] = ne[ne[k]]; } åŒé“¾è¡¨ â€”â€” æ¨¡æ¿é¢˜ AcWing 827. åŒé“¾è¡¨ ä¼˜åŒ–æŸäº›é—®é¢˜\n// e[]è¡¨ç¤ºèŠ‚ç‚¹çš„å€¼ï¼Œl[]è¡¨ç¤ºèŠ‚ç‚¹çš„å·¦æŒ‡é’ˆï¼Œr[]è¡¨ç¤ºèŠ‚ç‚¹çš„å³æŒ‡é’ˆï¼Œidxè¡¨ç¤ºå½“å‰ç”¨åˆ°äº†å“ªä¸ªèŠ‚ç‚¹ int e[N], l[N], r[N], idx; // åˆå§‹åŒ– void init() { //0æ˜¯å·¦ç«¯ç‚¹ï¼Œ1æ˜¯å³ç«¯ç‚¹ r[0] = 1, l[1] = 0; idx = 2; } // åœ¨èŠ‚ç‚¹açš„å³è¾¹æ’å…¥ä¸€ä¸ªæ•°x void insert(int a, int x) { e[idx] = x; l[idx] = a, r[idx] = r[a]; l[r[a]] = idx, r[a] = idx ++ ; } // åˆ é™¤èŠ‚ç‚¹a void remove(int a) { l[r[a]] = l[a]; r[l[a]] = r[a]; } æ ˆ â€”â€” æ¨¡æ¿é¢˜ AcWing 828. æ¨¡æ‹Ÿæ ˆ // ttè¡¨ç¤ºæ ˆé¡¶ int stk[N], tt = 0; // å‘æ ˆé¡¶æ’å…¥ä¸€ä¸ªæ•° stk[ ++ tt] = x; // ä»æ ˆé¡¶å¼¹å‡ºä¸€ä¸ªæ•° tt -- ; // æ ˆé¡¶çš„å€¼ stk[tt]; // åˆ¤æ–­æ ˆæ˜¯å¦ä¸ºç©º if (tt \u003e 0) { } é˜Ÿåˆ— â€”â€” æ¨¡æ¿é¢˜ AcWing 829. æ¨¡æ‹Ÿé˜Ÿåˆ— æ™®é€šé˜Ÿåˆ—\n// hh è¡¨ç¤ºé˜Ÿå¤´ï¼Œttè¡¨ç¤ºé˜Ÿå°¾ int q[N], hh = 0, tt = -1; // å‘é˜Ÿå°¾æ’å…¥ä¸€ä¸ªæ•° q[ ++ tt] = x; // ä»é˜Ÿå¤´å¼¹å‡ºä¸€ä¸ªæ•° hh ++ ; // é˜Ÿå¤´çš„å€¼ q[hh]; // åˆ¤æ–­é˜Ÿåˆ—æ˜¯å¦ä¸ºç©º if (hh \u003c= tt) { //ä¸ç©º } å¾ªç¯é˜Ÿåˆ—\n// hh è¡¨ç¤ºé˜Ÿå¤´ï¼Œttè¡¨ç¤ºé˜Ÿå°¾çš„åä¸€ä¸ªä½ç½® int q[N], hh = 0, tt = 0; // å‘é˜Ÿå°¾æ’å…¥ä¸€ä¸ªæ•° q[tt ++ ] = x; if (tt == N) tt = 0; // ä»é˜Ÿå¤´å¼¹å‡ºä¸€ä¸ªæ•° hh ++ ; if (hh == N) hh = 0; // é˜Ÿå¤´çš„å€¼ q[hh]; // åˆ¤æ–­é˜Ÿåˆ—æ˜¯å¦ä¸ºç©º if (hh != tt) { } å•è°ƒæ ˆ â€”â€” æ¨¡æ¿é¢˜ AcWing 830. å•è°ƒæ ˆ å¸¸è§æ¨¡å‹ï¼šæ‰¾å‡ºæ¯ä¸ªæ•°å·¦è¾¹ç¦»å®ƒæœ€è¿‘çš„æ¯”å®ƒå¤§/å°çš„æ•° int tt = 0; for (int i = 1; i \u003c= n; i ++ ) { while (tt \u0026\u0026 check(stk[tt], i)) tt -- ; stk[ ++ tt] = i; } å•è°ƒé˜Ÿåˆ— â€”â€” æ¨¡æ¿é¢˜ AcWing 154. æ»‘åŠ¨çª—å£ å¸¸è§æ¨¡å‹ï¼šæ‰¾å‡ºæ»‘åŠ¨çª—å£ä¸­çš„æœ€å¤§å€¼/æœ€å°å€¼ int hh = 0, tt = -1; for (int i = 0; i \u003c n; i ++ ) { while (hh \u003c= tt \u0026\u0026 check_out(q[hh])) hh ++ ; // åˆ¤æ–­é˜Ÿå¤´æ˜¯å¦æ»‘å‡ºçª—å£ while (hh \u003c= tt \u0026\u0026 check(q[tt], i)) tt -- ; q[ ++ tt] = i; } KMP â€”â€” æ¨¡æ¿é¢˜ AcWing 831. KMPå­—ç¬¦ä¸² ç”¨æ¨¡æ¿ä¸²æ¥åŒ¹é…æ¨¡å¼ä¸²ï¼Œæ‰¾åˆ°æ¨¡å¼ä¸²\nsçš„çœŸå‰ç¼€ä»¥åŠçœŸåç¼€æ˜¯æŒ‡ä¸ç­‰äºsçš„å‰ç¼€ä»¥åŠåç¼€ï¼Œå³è‡³å°‘æ˜¯s[1~n-2]æˆ–s[0~n-1]\nne[i] : ä»¥iç»“å°¾çš„ä¸²ä¸­ æœ€é•¿çœŸå‰ç¼€ä¸çœŸåç¼€ç›¸ç­‰çš„ä¸² çš„é•¿åº¦ï¼Œå¦‚æœæ²¡æœ‰åˆ™ä¸º0ã€‚\n//å‰ç¼€h vector\u003cint\u003e prefix_function(string s) { int n = (int)s.length(); vector\u003cint\u003e pi(n); for (int i = 1; i \u003c n; i++) { int j = pi[i - 1]; while (j \u003e 0 \u0026\u0026 s[i] != s[j]) j = pi[j - 1]; if (s[i] == s[j]) j++; pi[i] = j; } return pi; } å®é™…ä½¿ç”¨èŒƒä¾‹ï¼ˆä¸‹é¢è¿™ä¸ªä¾‹å­å­—ç¬¦ä¸²ä»1å¼€å§‹ï¼‰\n// æ±‚Nextæ•°ç»„ï¼š // ne[i] å­˜å‚¨çœŸå‰ç¼€å’ŒçœŸåç¼€ç›¸ç­‰çš„é•¿åº¦ï¼Œæ‰€ä»¥è‡³å°‘ä»2å¼€å§‹ï¼š //abcab,ä»bå¼€å§‹æ‰æœ‰çœŸå‰ç¼€ // s[]æ˜¯æ¨¡å¼ä¸²ï¼Œp[]æ˜¯æ¨¡æ¿ä¸², næ˜¯sçš„é•¿åº¦ï¼Œmæ˜¯pçš„é•¿åº¦ for (int i = 2, j = 0; i \u003c= m; i ++ ) { while (j \u0026\u0026 p[i] != p[j + 1]) j = ne[j]; if (p[i] == p[j + 1]) j ++ ; ne[i] = j; } // åŒ¹é… for (int i = 1, j = 0; i \u003c= n; i ++ ) { while (j \u0026\u0026 s[i] != p[j + 1]) j = ne[j]; if (s[i] == p[j + 1]) j ++ ; if (j == m) { j = ne[j]; // åŒ¹é…æˆåŠŸåçš„é€»è¾‘ } } Trieæ ‘ â€”â€” æ¨¡æ¿é¢˜ AcWing 835. Trieå­—ç¬¦ä¸²ç»Ÿè®¡ int son[N][26], cnt[N], idx; // 0å·ç‚¹æ—¢æ˜¯æ ¹èŠ‚ç‚¹ï¼Œåˆæ˜¯ç©ºèŠ‚ç‚¹ // son[][]å­˜å‚¨æ ‘ä¸­æ¯ä¸ªèŠ‚ç‚¹çš„å­èŠ‚ç‚¹ // cnt[]å­˜å‚¨ä»¥æ¯ä¸ªèŠ‚ç‚¹ç»“å°¾çš„å•è¯æ•°é‡ // æ’å…¥ä¸€ä¸ªå­—ç¬¦ä¸² void insert(char *str) { int p = 0; for (int i = 0; str[i]; i ++ ) { int u = str[i] - 'a'; if (!son[p][u]) son[p][u] = ++ idx; p = son[p][u]; } cnt[p] ++ ; } // æŸ¥è¯¢å­—ç¬¦ä¸²å‡ºç°çš„æ¬¡æ•° int query(char *str) { int p = 0; for (int i = 0; str[i]; i ++ ) { int u = str[i] - 'a'; if (!son[p][u]) return 0; p = son[p][u]; } return cnt[p]; } å¹¶æŸ¥é›† â€”â€” æ¨¡æ¿é¢˜ AcWing 836. åˆå¹¶é›†åˆ, AcWing 837. è¿é€šå—ä¸­ç‚¹çš„æ•°é‡ æŒ‰ç§©åˆå¹¶\nå­—ç¬¦æŒ‰å­—ç¬¦ä¸²è¯»å…¥\n(1)æœ´ç´ å¹¶æŸ¥é›†ï¼š\nint p[N]; //å­˜å‚¨æ¯ä¸ªç‚¹çš„ç¥–å®—èŠ‚ç‚¹ // è¿”å›xçš„ç¥–å®—èŠ‚ç‚¹ int find(int x) { if (p[x] != x) p[x] = find(p[x]); return p[x]; } // åˆå§‹åŒ–ï¼Œå‡å®šèŠ‚ç‚¹ç¼–å·æ˜¯1~n for (int i = 1; i \u003c= n; i ++ ) p[i] = i; // åˆå¹¶aå’Œbæ‰€åœ¨çš„ä¸¤ä¸ªé›†åˆï¼š p[find(a)] = find(b); (2)ç»´æŠ¤sizeçš„å¹¶æŸ¥é›†ï¼š\nint p[N], size[N]; //p[]å­˜å‚¨æ¯ä¸ªç‚¹çš„ç¥–å®—èŠ‚ç‚¹, size[]åªæœ‰ç¥–å®—èŠ‚ç‚¹çš„æœ‰æ„ä¹‰ï¼Œè¡¨ç¤ºç¥–å®—èŠ‚ç‚¹æ‰€åœ¨é›†åˆä¸­çš„ç‚¹çš„æ•°é‡ // è¿”å›xçš„ç¥–å®—èŠ‚ç‚¹ int find(int x) { if (p[x] != x) p[x] = find(p[x]); return p[x]; } // åˆå§‹åŒ–ï¼Œå‡å®šèŠ‚ç‚¹ç¼–å·æ˜¯1~n for (int i = 1; i \u003c= n; i ++ ) { p[i] = i; size[i] = 1; } // åˆå¹¶aå’Œbæ‰€åœ¨çš„ä¸¤ä¸ªé›†åˆï¼š p[find(a)] = find(b); size[b] += size[a]; (3)ç»´æŠ¤åˆ°ç¥–å®—èŠ‚ç‚¹è·ç¦»çš„å¹¶æŸ¥é›†ï¼š\nint p[N], d[N]; //p[]å­˜å‚¨æ¯ä¸ªç‚¹çš„ç¥–å®—èŠ‚ç‚¹, d[x]å­˜å‚¨xåˆ°p[x]çš„è·ç¦» // è¿”å›xçš„ç¥–å®—èŠ‚ç‚¹ int find(int x) { if (p[x] != x) { int u = find(p[x]); d[x] += d[p[x]]; p[x] = u; } return p[x]; } // åˆå§‹åŒ–ï¼Œå‡å®šèŠ‚ç‚¹ç¼–å·æ˜¯1~n for (int i = 1; i \u003c= n; i ++ ) { p[i] = i; d[i] = 0; } // åˆå¹¶aå’Œbæ‰€åœ¨çš„ä¸¤ä¸ªé›†åˆï¼š p[find(a)] = find(b); d[find(a)] = distance; // æ ¹æ®å…·ä½“é—®é¢˜ï¼Œåˆå§‹åŒ–find(a)çš„åç§»é‡ å † â€”â€” æ¨¡æ¿é¢˜ AcWing 838. å †æ’åº, AcWing 839. æ¨¡æ‹Ÿå † ç»´æŠ¤é›†åˆçš„æ•°æ®ç»“æ„ ï¼ˆå¤§æ ¹å †ï¼Œçˆ¶èŠ‚ç‚¹å€¼ä¸å°äºå­èŠ‚ç‚¹å€¼ï¼‰\n// h[N]å­˜å‚¨å †ä¸­çš„å€¼, h[1]æ˜¯å †é¡¶ï¼Œxçš„å·¦å„¿å­æ˜¯2x, å³å„¿å­æ˜¯2x + 1 // pos[k]å­˜å‚¨ç¬¬kä¸ªæ’å…¥çš„ç‚¹åœ¨å †ä¸­çš„ä½ç½® // ord[k]å­˜å‚¨å †ä¸­ä¸‹æ ‡æ˜¯kçš„ç‚¹æ˜¯ç¬¬å‡ ä¸ªæ’å…¥çš„ int h[N], ph[N], hp[N], size; // äº¤æ¢ä¸¤ä¸ªç‚¹ï¼ŒåŠå…¶æ˜ å°„å…³ç³» void heap_swap(int a, int b) { //swap(ph[hp[a]],ph[hp[b]]); æ ¹æ®é¢˜æ„ //swap(hp[a], hp[b]); swap(h[a], h[b]); } void down(int u) { int t = u; if (u * 2 \u003c= size \u0026\u0026 h[u * 2] \u003c h[t]) t = u * 2; if (u * 2 + 1 \u003c= size \u0026\u0026 h[u * 2 + 1] \u003c h[t]) t = u * 2 + 1; if (u != t) { heap_swap(u, t); down(t); } } void up(int u) { while (u / 2 \u0026\u0026 h[u] \u003c h[u / 2]) { heap_swap(u, u / 2); u \u003e\u003e= 1; } } // O(n)å»ºå † for (int i = n / 2; i; i -- ) down(i); heap[++size] = x; up(size); //æ·»åŠ å…ƒç´  heap[1]; //å †é¡¶å…ƒç´  heap[1]=heap[size]; size--; down(1);//åˆ é™¤ç¬¬sizeä¸ªç»“ç‚¹ heap[k]=heap[size]; size---; down(k);up(k);//åˆ é™¤ç¬¬kä¸ªç»“ç‚¹ heap[k]=x; down(k); up(k); //å°†ç¬¬kä¸ªå…ƒç´ èµ‹å€¼ä¸ºx ä¸€èˆ¬å“ˆå¸Œ â€”â€” æ¨¡æ¿é¢˜ AcWing 840. æ¨¡æ‹Ÿæ•£åˆ—è¡¨ (1) æ‹‰é“¾æ³• int h[N], e[N], ne[N], idx; // å‘å“ˆå¸Œè¡¨ä¸­æ’å…¥ä¸€ä¸ªæ•° void insert(int x) { int k = (x % N + N) % N; e[idx] = x; ne[idx] = h[k]; h[k] = idx ++ ; } // åœ¨å“ˆå¸Œè¡¨ä¸­æŸ¥è¯¢æŸä¸ªæ•°æ˜¯å¦å­˜åœ¨ bool find(int x) { int k = (x % N + N) % N; for (int i = h[k]; i != -1; i = ne[i]) if (e[i] == x) return true; return false; } (2) å¼€æ”¾å¯»å€æ³• int h[N]; // å¦‚æœxåœ¨å“ˆå¸Œè¡¨ä¸­ï¼Œè¿”å›xçš„ä¸‹æ ‡ï¼›å¦‚æœxä¸åœ¨å“ˆå¸Œè¡¨ä¸­ï¼Œè¿”å›xåº”è¯¥æ’å…¥çš„ä½ç½® int find(int x) { int t = (x % N + N) % N; while (h[t] != null \u0026\u0026 h[t] != x) { t ++ ; if (t == N) t = 0; } return t; } å­—ç¬¦ä¸²å“ˆå¸Œ â€”â€” æ¨¡æ¿é¢˜ AcWing 841. å­—ç¬¦ä¸²å“ˆå¸Œ æ ¸å¿ƒæ€æƒ³ï¼šå°†å­—ç¬¦ä¸²çœ‹æˆPè¿›åˆ¶æ•°ï¼ŒPçš„ç»éªŒå€¼æ˜¯131æˆ–13331ï¼Œå–è¿™ä¸¤ä¸ªå€¼çš„å†²çªæ¦‚ç‡ä½ å°æŠ€å·§ï¼šå–æ¨¡çš„æ•°ç”¨2^64ï¼Œè¿™æ ·ç›´æ¥ç”¨unsigned long longå­˜å‚¨ï¼Œæº¢å‡ºçš„ç»“æœå°±æ˜¯å–æ¨¡çš„ç»“æœã€‚\ntypedef unsigned long long ULL; const int P = 131 or 13331 ; ULL h[N], p[N]; // h[k]å­˜å‚¨å­—ç¬¦ä¸²å‰kä¸ªå­—æ¯çš„å“ˆå¸Œå€¼, p[k]å­˜å‚¨ P^k mod 2^64 // åˆå§‹åŒ– p[0] = 1; for (int i = 1; i \u003c= n; i ++ ) { h[i] = h[i - 1] * P + str[i]; p[i] = p[i - 1] * P; } // è®¡ç®—å­ä¸² str[l ~ r] çš„å“ˆå¸Œå€¼ ULL get(int l, int r) { return h[r] - h[l - 1] * p[r - l + 1]; } C++ STLç®€ä»‹ æ‰€æœ‰å®¹å™¨éƒ½æœ‰size() empty() vector, å˜é•¿æ•°ç»„ï¼Œå€å¢çš„æ€æƒ³ size() è¿”å›å…ƒç´ ä¸ªæ•° empty() è¿”å›æ˜¯å¦ä¸ºç©º clear() æ¸…ç©º front()/back() push_back()/pop_back() begin()/end() [] æ”¯æŒæ¯”è¾ƒè¿ç®—ï¼ŒæŒ‰å­—å…¸åº vector\u003cint\u003e a(10,2); a.empty(); pair\u003cint, int\u003e first, ç¬¬ä¸€ä¸ªå…ƒç´  second, ç¬¬äºŒä¸ªå…ƒç´  æ”¯æŒæ¯”è¾ƒè¿ç®—ï¼Œä»¥firstä¸ºç¬¬ä¸€å…³é”®å­—ï¼Œä»¥secondä¸ºç¬¬äºŒå…³é”®å­—ï¼ˆå­—å…¸åºï¼‰ pair\u003cint,int\u003e p; p=make_pair(1,1); p={1,1}; stringï¼Œå­—ç¬¦ä¸² size()/length() è¿”å›å­—ç¬¦ä¸²é•¿åº¦ empty() clear() substr(èµ·å§‹ä¸‹æ ‡ï¼Œ(å­ä¸²é•¿åº¦)) è¿”å›å­ä¸² c_str() è¿”å›å­—ç¬¦ä¸²æ‰€åœ¨å­—ç¬¦æ•°ç»„çš„èµ·å§‹åœ°å€ strcpy(c,s.c_str());//c_str()çš„ä½¿ç”¨æ–¹æ³• queue, é˜Ÿåˆ— æ²¡æœ‰clearå‡½æ•° æ¸…ç©ºç”¨æ–°å»ºqueue size() empty() push() å‘é˜Ÿå°¾æ’å…¥ä¸€ä¸ªå…ƒç´  front() è¿”å›é˜Ÿå¤´å…ƒç´  back() è¿”å›é˜Ÿå°¾å…ƒç´  pop() å¼¹å‡ºé˜Ÿå¤´å…ƒç´  priority_queue, ä¼˜å…ˆé˜Ÿåˆ—ï¼Œé»˜è®¤æ˜¯å¤§æ ¹å † push() æ’å…¥ä¸€ä¸ªå…ƒç´  top() è¿”å›å †é¡¶å…ƒç´  pop() å¼¹å‡ºå †é¡¶å…ƒç´  å®šä¹‰æˆå°æ ¹å †çš„æ–¹å¼ï¼špriority_queue\u003cint, vector\u003cint\u003e, greater\u003cint\u003e\u003e q; stack, æ ˆ size() empty() push() å‘æ ˆé¡¶æ’å…¥ä¸€ä¸ªå…ƒç´  top() è¿”å›æ ˆé¡¶å…ƒç´  pop() å¼¹å‡ºæ ˆé¡¶å…ƒç´  deque, åŒç«¯é˜Ÿåˆ— size() empty() clear() front()/back() push_back()/pop_back() push_front()/pop_front() begin()/end() [] set, map, multiset, multimap, åŸºäºå¹³è¡¡äºŒå‰æ ‘ï¼ˆçº¢é»‘æ ‘ï¼‰ï¼ŒåŠ¨æ€ç»´æŠ¤æœ‰åºåºåˆ— size() empty() clear() begin()/end() ++, -- è¿”å›å‰é©±å’Œåç»§ï¼Œæ—¶é—´å¤æ‚åº¦ O(logn) set/multiset insert() æ’å…¥ä¸€ä¸ªæ•° find() æŸ¥æ‰¾ä¸€ä¸ªæ•° count() è¿”å›æŸä¸€ä¸ªæ•°çš„ä¸ªæ•° erase() (1) è¾“å…¥æ˜¯ä¸€ä¸ªæ•°xï¼Œåˆ é™¤æ‰€æœ‰x O(k + logn) (2) è¾“å…¥ä¸€ä¸ªè¿­ä»£å™¨ï¼Œåˆ é™¤è¿™ä¸ªè¿­ä»£å™¨ lower_bound()/upper_bound() lower_bound(x) è¿”å›å¤§äºç­‰äºxçš„æœ€å°çš„æ•°çš„è¿­ä»£å™¨ upper_bound(x) è¿”å›å¤§äºxçš„æœ€å°çš„æ•°çš„è¿­ä»£å™¨ map/multimap insert() æ’å…¥çš„æ•°æ˜¯ä¸€ä¸ªpair erase() è¾“å…¥çš„å‚æ•°æ˜¯pairæˆ–è€…è¿­ä»£å™¨ find() [] æ³¨æ„multimapä¸æ”¯æŒæ­¤æ“ä½œã€‚ æ—¶é—´å¤æ‚åº¦æ˜¯ O(logn) lower_bound()/upper_bound() unordered_set, unordered_map, unordered_multiset, unordered_multimap, å“ˆå¸Œè¡¨ å’Œä¸Šé¢ç±»ä¼¼ï¼Œå¢åˆ æ”¹æŸ¥çš„æ—¶é—´å¤æ‚åº¦æ˜¯ O(1) ä¸æ”¯æŒ lower_bound()/upper_bound()ï¼Œ è¿­ä»£å™¨çš„++ï¼Œ-- bitset, åœ§ä½ bitset\u003c10000\u003e s; ~, \u0026, |, ^ \u003e\u003e, \u003c\u003c ==, != [] count() è¿”å›æœ‰å¤šå°‘ä¸ª1 none() åˆ¤æ–­æ˜¯å¦å…¨ä¸º0 any() åˆ¤æ–­æ˜¯å¦è‡³å°‘æœ‰ä¸€ä¸ª1 set() æŠŠæ‰€æœ‰ä½ç½®æˆ1 set(k, v) å°†ç¬¬kä½å˜æˆv reset() æŠŠæ‰€æœ‰ä½å˜æˆ0 flip() ç­‰ä»·äº~ flip(k) æŠŠç¬¬kä½å–å ä½œè€…ï¼šyxc é“¾æ¥ï¼šhttps://www.acwing.com/blog/content/404/ æ¥æºï¼šAcWing è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚\nç¬¬ä¸‰ç«  æ ‘ä¸å›¾çš„å­˜å‚¨ æ ‘æ˜¯ä¸€ç§ç‰¹æ®Šçš„å›¾: æ— ç¯è¿é€šå›¾ï¼Œä¸å›¾çš„å­˜å‚¨æ–¹å¼ç›¸åŒã€‚ å¯¹äºæ— å‘å›¾ä¸­çš„è¾¹abï¼Œå­˜å‚¨ä¸¤æ¡æœ‰å‘è¾¹a-\u003eb, b-\u003eaã€‚ å› æ­¤æˆ‘ä»¬å¯ä»¥åªè€ƒè™‘æœ‰å‘å›¾çš„å­˜å‚¨ã€‚\n(1) é‚»æ¥çŸ©é˜µï¼šg[a][b] å­˜å‚¨è¾¹a-\u003eb (2) é‚»æ¥è¡¨ï¼š // å¯¹äºæ¯ä¸ªç‚¹kï¼Œå¼€ä¸€ä¸ªå•é“¾è¡¨ï¼Œå­˜å‚¨kæ‰€æœ‰å¯ä»¥èµ°åˆ°çš„ç‚¹ã€‚h[k]å­˜å‚¨è¿™ä¸ªå•é“¾è¡¨çš„å¤´ç»“ç‚¹ int h[N], e[N], ne[N], idx; // æ·»åŠ ä¸€æ¡è¾¹a-\u003eb void add(int a, int b) { e[idx] = b, ne[idx] = h[a], h[a] = idx ++ ; } // åˆå§‹åŒ– idx = 0; memset(h, -1, sizeof h); æ ‘ä¸å›¾çš„éå† æ—¶é—´å¤æ‚åº¦ O(n+m)O(n+m), nn è¡¨ç¤ºç‚¹æ•°ï¼Œmm è¡¨ç¤ºè¾¹æ•°\n(1) æ·±åº¦ä¼˜å…ˆéå† â€”â€” æ¨¡æ¿é¢˜ AcWing 846. æ ‘çš„é‡å¿ƒ int dfs(int u) { st[u] = true; // st[u] è¡¨ç¤ºç‚¹uå·²ç»è¢«éå†è¿‡ for (int i = h[u]; i != -1; i = ne[i]) { int j = e[i]; if (!st[j]) dfs(j); } } (2) å®½åº¦ä¼˜å…ˆéå† â€”â€” æ¨¡æ¿é¢˜ AcWing 847. å›¾ä¸­ç‚¹çš„å±‚æ¬¡ queue\u003cint\u003e q; st[1] = true; // è¡¨ç¤º1å·ç‚¹å·²ç»è¢«éå†è¿‡ q.push(1); while (q.size()) { int t = q.front(); q.pop(); for (int i = h[t]; i != -1; i = ne[i]) { int j = e[i]; if (!st[j]) { st[j] = true; // è¡¨ç¤ºç‚¹jå·²ç»è¢«éå†è¿‡ q.push(j); } } } æ‹“æ‰‘æ’åº â€”â€” æ¨¡æ¿é¢˜ AcWing 848. æœ‰å‘å›¾çš„æ‹“æ‰‘åºåˆ— æ—¶é—´å¤æ‚åº¦ O(n+m)O(n+m), nn è¡¨ç¤ºç‚¹æ•°ï¼Œmm è¡¨ç¤ºè¾¹æ•°\nbool topsort() { int hh = 0, tt = -1; // d[i] å­˜å‚¨ç‚¹içš„å…¥åº¦ for (int i = 1; i \u003c= n; i ++ ) if (!d[i]) q[ ++ tt] = i; while (hh \u003c= tt) { int t = q[hh ++ ]; for (int i = h[t]; i != -1; i = ne[i]) { int j = e[i]; if (-- d[j] == 0) q[ ++ tt] = j; } } // å¦‚æœæ‰€æœ‰ç‚¹éƒ½å…¥é˜Ÿäº†ï¼Œè¯´æ˜å­˜åœ¨æ‹“æ‰‘åºåˆ—ï¼›å¦åˆ™ä¸å­˜åœ¨æ‹“æ‰‘åºåˆ—ã€‚ return tt == n - 1; } æœ€çŸ­è·¯ å•æºæœ€çŸ­è·¯\næ‰€æœ‰è¾¹æƒå‡ä¸ºæ­£ï¼šæœ´ç´ Dijkstra O(n^2)ï¼›å †ä¼˜åŒ–ç‰ˆçš„Dijkstra(mlogn)\nå­˜åœ¨è´Ÿæƒå˜ï¼šBellman-Ford O(nm) ï¼› SPFAï¼ˆé˜Ÿåˆ—ä¼˜åŒ–Bellman-Ford) ä¸€èˆ¬ï¼šO(m) æœ€å O(nm)\nå¤šå…ƒæ±‡æœ€çŸ­è·¯ï¼šFloyedç®—æ³• O(n^3)\næœ´ç´ dijkstraç®—æ³• â€”â€” æ¨¡æ¿é¢˜ AcWing 849. Dijkstraæ±‚æœ€çŸ­è·¯ I åŸºäºè´ªå¿ƒ æ—¶é—´å¤æ‚æ˜¯ O(n^2+m), n è¡¨ç¤ºç‚¹æ•°ï¼Œm è¡¨ç¤ºè¾¹æ•°\nint g[N][N]; // å­˜å‚¨æ¯æ¡è¾¹ï¼Œ int dist[N]; // å­˜å‚¨1å·ç‚¹åˆ°æ¯ä¸ªç‚¹çš„æœ€çŸ­è·ç¦» bool st[N]; // å­˜å‚¨æ¯ä¸ªç‚¹çš„æœ€çŸ­è·¯æ˜¯å¦å·²ç»ç¡®å®š // æ±‚1å·ç‚¹åˆ°nå·ç‚¹çš„æœ€çŸ­è·¯ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™è¿”å›-1 int dijkstra() { memset(dist, 0x3f, sizeof dist); dist[1] = 0; for (int i = 0; i \u003c n - 1; i ++ ) { int t = -1; // åœ¨è¿˜æœªç¡®å®šæœ€çŸ­è·¯çš„ç‚¹ä¸­ï¼Œå¯»æ‰¾è·ç¦»æœ€å°çš„ç‚¹ for (int j = 1; j \u003c= n; j ++ ) if (!st[j] \u0026\u0026 (t == -1 || dist[t] \u003e dist[j])) t = j; // ç”¨tæ›´æ–°å…¶ä»–ç‚¹çš„è·ç¦» for (int j = 1; j \u003c= n; j ++ ) dist[j] = min(dist[j], dist[t] + g[t][j]); st[t] = true; } if (dist[n] == 0x3f3f3f3f) return -1; return dist[n]; } å †ä¼˜åŒ–ç‰ˆdijkstra â€”â€” æ¨¡æ¿é¢˜ AcWing 850. Dijkstraæ±‚æœ€çŸ­è·¯ II æ—¶é—´å¤æ‚åº¦ O(mlogn), n è¡¨ç¤ºç‚¹æ•°ï¼Œm è¡¨ç¤ºè¾¹æ•°\ntypedef pair\u003cint, int\u003e PII; int n; // ç‚¹çš„æ•°é‡ int h[N], w[N], e[N], ne[N], idx; // é‚»æ¥è¡¨å­˜å‚¨æ‰€æœ‰è¾¹ int dist[N]; // å­˜å‚¨æ‰€æœ‰ç‚¹åˆ°1å·ç‚¹çš„è·ç¦» bool st[N]; // å­˜å‚¨æ¯ä¸ªç‚¹çš„æœ€çŸ­è·ç¦»æ˜¯å¦å·²ç¡®å®š // æ±‚1å·ç‚¹åˆ°nå·ç‚¹çš„æœ€çŸ­è·ç¦»ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œåˆ™è¿”å›-1 int dijkstra() { memset(dist, 0x3f, sizeof dist); dist[1] = 0; priority_queue\u003cPII, vector\u003cPII\u003e, greater\u003cPII\u003e\u003e heap; heap.push({0, 1}); // firstå­˜å‚¨è·ç¦»ï¼Œsecondå­˜å‚¨èŠ‚ç‚¹ç¼–å· while (heap.size()) { auto t = heap.top(); heap.pop(); int ver = t.second, distance = t.first; if (st[ver]) continue; st[ver] = true; for (int i = h[ver]; i != -1; i = ne[i]) { int j = e[i]; if (dist[j] \u003e distance + w[i]) { dist[j] = distance + w[i]; heap.push({dist[j], j}); } } } if (dist[n] == 0x3f3f3f3f) return -1; return dist[n]; } Bellman-Fordç®—æ³• â€”â€” æ¨¡æ¿é¢˜ AcWing 853. æœ‰è¾¹æ•°é™åˆ¶çš„æœ€çŸ­è·¯ æ—¶é—´å¤æ‚åº¦ O(nm), n è¡¨ç¤ºç‚¹æ•°ï¼Œmè¡¨ç¤ºè¾¹æ•° æ³¨æ„åœ¨æ¨¡æ¿é¢˜ä¸­éœ€è¦å¯¹ä¸‹é¢çš„æ¨¡æ¿ç¨ä½œä¿®æ”¹ï¼ŒåŠ ä¸Šå¤‡ä»½æ•°ç»„ï¼Œè¯¦æƒ…è§æ¨¡æ¿é¢˜ã€‚\nint n, m; // nè¡¨ç¤ºç‚¹æ•°ï¼Œmè¡¨ç¤ºè¾¹æ•° int dist[N]; // dist[x]å­˜å‚¨1åˆ°xçš„æœ€çŸ­è·¯è·ç¦» struct Edge // è¾¹ï¼Œaè¡¨ç¤ºå‡ºç‚¹ï¼Œbè¡¨ç¤ºå…¥ç‚¹ï¼Œwè¡¨ç¤ºè¾¹çš„æƒé‡ { int a, b, w; }edges[M]; // æ±‚1åˆ°nçš„æœ€çŸ­è·¯è·ç¦»ï¼Œå¦‚æœæ— æ³•ä»1èµ°åˆ°nï¼Œåˆ™è¿”å›-1ã€‚ int bellman_ford() { memset(dist, 0x3f, sizeof dist); dist[1] = 0; // å¦‚æœç¬¬næ¬¡è¿­ä»£ä»ç„¶ä¼šæ¾å¼›ä¸‰è§’ä¸ç­‰å¼ï¼Œå°±è¯´æ˜å­˜åœ¨ä¸€æ¡é•¿åº¦æ˜¯n+1çš„æœ€çŸ­è·¯å¾„ï¼Œç”±æŠ½å±‰åŸç†ï¼Œè·¯å¾„ä¸­è‡³å°‘å­˜åœ¨ä¸¤ä¸ªç›¸åŒçš„ç‚¹ï¼Œè¯´æ˜å›¾ä¸­å­˜åœ¨è´Ÿæƒå›è·¯ã€‚ for (int i = 0; i \u003c n; i ++ ) { for (int j = 0; j \u003c m; j ++ ) { int a = edges[j].a, b = edges[j].b, w = edges[j].w; if (dist[b] \u003e dist[a] + w) dist[b] = dist[a] + w; } } if (dist[n] \u003e 0x3f3f3f3f / 2) return -1; return dist[n]; } spfa ç®—æ³•ï¼ˆé˜Ÿåˆ—ä¼˜åŒ–çš„Bellman-Fordç®—æ³•ï¼‰ â€”â€” æ¨¡æ¿é¢˜ AcWing 851. spfaæ±‚æœ€çŸ­è·¯ æ—¶é—´å¤æ‚åº¦ å¹³å‡æƒ…å†µä¸‹ O(m)ï¼Œæœ€åæƒ…å†µä¸‹ O(nm), n è¡¨ç¤ºç‚¹æ•°ï¼Œm è¡¨ç¤ºè¾¹æ•°\nint n; // æ€»ç‚¹æ•° int h[N], w[N], e[N], ne[N], idx; // é‚»æ¥è¡¨å­˜å‚¨æ‰€æœ‰è¾¹ int dist[N]; // å­˜å‚¨æ¯ä¸ªç‚¹åˆ°1å·ç‚¹çš„æœ€çŸ­è·ç¦» bool st[N]; // å­˜å‚¨æ¯ä¸ªç‚¹æ˜¯å¦åœ¨é˜Ÿåˆ—ä¸­ // æ±‚1å·ç‚¹åˆ°nå·ç‚¹çš„æœ€çŸ­è·¯è·ç¦»ï¼Œå¦‚æœä»1å·ç‚¹æ— æ³•èµ°åˆ°nå·ç‚¹åˆ™è¿”å›-1 int spfa() { memset(dist, 0x3f, sizeof dist); dist[1] = 0; queue\u003cint\u003e q; q.push(1); st[1] = true; while (q.size()) { auto t = q.front(); q.pop(); st[t] = false; for (int i = h[t]; i != -1; i = ne[i]) { int j = e[i]; if (dist[j] \u003e dist[t] + w[i]) { dist[j] = dist[t] + w[i]; if (!st[j]) // å¦‚æœé˜Ÿåˆ—ä¸­å·²å­˜åœ¨jï¼Œåˆ™ä¸éœ€è¦å°†jé‡å¤æ’å…¥ { q.push(j); st[j] = true; } } } } if (dist[n] == 0x3f3f3f3f) return -1; return dist[n]; } spfaåˆ¤æ–­å›¾ä¸­æ˜¯å¦å­˜åœ¨è´Ÿç¯ â€”â€” æ¨¡æ¿é¢˜ AcWing 852. spfaåˆ¤æ–­è´Ÿç¯ æ—¶é—´å¤æ‚åº¦æ˜¯ O(nm), n è¡¨ç¤ºç‚¹æ•°ï¼Œm è¡¨ç¤ºè¾¹æ•°\nint n; // æ€»ç‚¹æ•° int h[N], w[N], e[N], ne[N], idx; // é‚»æ¥è¡¨å­˜å‚¨æ‰€æœ‰è¾¹ int dist[N], cnt[N]; // dist[x]å­˜å‚¨1å·ç‚¹åˆ°xçš„æœ€çŸ­è·ç¦»ï¼Œcnt[x]å­˜å‚¨1åˆ°xçš„æœ€çŸ­è·¯ä¸­ç»è¿‡çš„ç‚¹æ•° bool st[N]; // å­˜å‚¨æ¯ä¸ªç‚¹æ˜¯å¦åœ¨é˜Ÿåˆ—ä¸­ // å¦‚æœå­˜åœ¨è´Ÿç¯ï¼Œåˆ™è¿”å›trueï¼Œå¦åˆ™è¿”å›falseã€‚ bool spfa() { // ä¸éœ€è¦åˆå§‹åŒ–distæ•°ç»„ // åŸç†ï¼šå¦‚æœæŸæ¡æœ€çŸ­è·¯å¾„ä¸Šæœ‰nä¸ªç‚¹ï¼ˆé™¤äº†è‡ªå·±ï¼‰ï¼Œé‚£ä¹ˆåŠ ä¸Šè‡ªå·±ä¹‹åä¸€å…±æœ‰n+1ä¸ªç‚¹ï¼Œç”±æŠ½å±‰åŸç†ä¸€å®šæœ‰ä¸¤ä¸ªç‚¹ç›¸åŒï¼Œæ‰€ä»¥å­˜åœ¨ç¯ã€‚ queue\u003cint\u003e q; for (int i = 1; i \u003c= n; i ++ ) { q.push(i); st[i] = true; } while (q.size()) { auto t = q.front(); q.pop(); st[t] = false; for (int i = h[t]; i != -1; i = ne[i]) { int j = e[i]; if (dist[j] \u003e dist[t] + w[i]) { dist[j] = dist[t] + w[i]; cnt[j] = cnt[t] + 1; if (cnt[j] \u003e= n) return true; // å¦‚æœä»1å·ç‚¹åˆ°xçš„æœ€çŸ­è·¯ä¸­åŒ…å«è‡³å°‘nä¸ªç‚¹ï¼ˆä¸åŒ…æ‹¬è‡ªå·±ï¼‰ï¼Œåˆ™è¯´æ˜å­˜åœ¨ç¯ if (!st[j]) { q.push(j); st[j] = true; } } } } return false; } floydç®—æ³• â€”â€” æ¨¡æ¿é¢˜ AcWing 854. Floydæ±‚æœ€çŸ­è·¯ æ—¶é—´å¤æ‚åº¦æ˜¯ O(n3)O(n3), nn è¡¨ç¤ºç‚¹æ•° åˆå§‹åŒ–ï¼š for (int i = 1; i \u003c= n; i ++ ) for (int j = 1; j \u003c= n; j ++ ) if (i == j) d[i][j] = 0; else d[i][j] = INF; // ç®—æ³•ç»“æŸåï¼Œd[a][b]è¡¨ç¤ºaåˆ°bçš„æœ€çŸ­è·ç¦» void floyd() { for (int k = 1; k \u003c= n; k ++ ) for (int i = 1; i \u003c= n; i ++ ) for (int j = 1; j \u003c= n; j ++ ) d[i][j] = min(d[i][j], d[i][k] + d[k][j]); } æœ€å°ç”Ÿæˆæ ‘ï¼ˆæ— å‘å›¾ï¼‰ Prim : æœ´ç´ ç‰ˆPrim O(n^2)(ç¨ å¯†å›¾) ; å †ä¼˜åŒ–ç‰ˆPrim O(mlogn)(ä¸€èˆ¬ä¸ä¼šç”¨)\nKruskal : O(mlogm)(ç¨€ç–å›¾)\næœ´ç´ ç‰ˆprimç®—æ³• â€”â€” æ¨¡æ¿é¢˜ AcWing 858. Primç®—æ³•æ±‚æœ€å°ç”Ÿæˆæ ‘ æ—¶é—´å¤æ‚åº¦æ˜¯ O(n^2+m), n è¡¨ç¤ºç‚¹æ•°ï¼Œm è¡¨ç¤ºè¾¹æ•°\nåˆå§‹åŒ–è·ç¦»ä¸ºæ­£æ— ç©·ï¼Œè¿­ä»£æ‰€æœ‰ç‚¹ï¼Œæ‰¾åˆ°é›†åˆä¸­æœ€è¿‘çš„ç‚¹ï¼Œæ›´æ–°å®ƒåˆ°é›†åˆçš„è·ç¦»ï¼ŒæŠŠtåŠ åˆ°é›†åˆä¸­ã€‚\nint n; // nè¡¨ç¤ºç‚¹æ•° int g[N][N]; // é‚»æ¥çŸ©é˜µï¼Œå­˜å‚¨æ‰€æœ‰è¾¹ int dist[N]; // å­˜å‚¨å…¶ä»–ç‚¹åˆ°å½“å‰æœ€å°ç”Ÿæˆæ ‘çš„è·ç¦» bool st[N]; // å­˜å‚¨æ¯ä¸ªç‚¹æ˜¯å¦å·²ç»åœ¨ç”Ÿæˆæ ‘ä¸­ // å¦‚æœå›¾ä¸è¿é€šï¼Œåˆ™è¿”å›INF(å€¼æ˜¯0x3f3f3f3f), å¦åˆ™è¿”å›æœ€å°ç”Ÿæˆæ ‘çš„æ ‘è¾¹æƒé‡ä¹‹å’Œ int prim() { memset(dist, 0x3f, sizeof dist); int res = 0; for (int i = 0; i \u003c n; i ++ ) { int t = -1; for (int j = 1; j \u003c= n; j ++ ) if (!st[j] \u0026\u0026 (t == -1 || dist[t] \u003e dist[j])) t = j; if (i \u0026\u0026 dist[t] == INF) return INF; if (i) res += dist[t]; st[t] = true; for (int j = 1; j \u003c= n; j ++ ) dist[j] = min(dist[j], g[t][j]); } return res; } Kruskalç®—æ³• â€”â€” æ¨¡æ¿é¢˜ AcWing 859. Kruskalç®—æ³•æ±‚æœ€å°ç”Ÿæˆæ ‘ æ—¶é—´å¤æ‚åº¦æ˜¯ O(mlogm), n è¡¨ç¤ºç‚¹æ•°ï¼Œm è¡¨ç¤ºè¾¹æ•°\nint n, m; // næ˜¯ç‚¹æ•°ï¼Œmæ˜¯è¾¹æ•° int p[N]; // å¹¶æŸ¥é›†çš„çˆ¶èŠ‚ç‚¹æ•°ç»„ struct Edge // å­˜å‚¨è¾¹ { int a, b, w; // é‡è½½å°äºå·è¿ç®—ç¬¦ // ç”¨äºæ¯”è¾ƒä¸¤ä¸ªEdgeå¯¹è±¡çš„å¤§å°å…³ç³» bool operator \u003c (const Edge \u0026W) const { return w \u003c W.w; // å¦‚æœå½“å‰å¯¹è±¡çš„è¾¹æƒå°äºWå¯¹è±¡çš„è¾¹æƒï¼Œè¿”å›trueï¼Œå¦åˆ™è¿”å›false } }edges[M]; int find(int x) // å¹¶æŸ¥é›†æ ¸å¿ƒæ“ä½œ { if (p[x] != x) p[x] = find(p[x]); return p[x]; } int kruskal() { sort(edges, edges + m); for (int i = 1; i \u003c= n; i ++ ) p[i] = i; // åˆå§‹åŒ–å¹¶æŸ¥é›† int res = 0, cnt = 0; for (int i = 0; i \u003c m; i ++ ) { int a = edges[i].a, b = edges[i].b, w = edges[i].w; a = find(a), b = find(b); if (a != b) // å¦‚æœä¸¤ä¸ªè¿é€šå—ä¸è¿é€šï¼Œåˆ™å°†è¿™ä¸¤ä¸ªè¿é€šå—åˆå¹¶ { p[a] = b; res += w; cnt ++ ; } } if (cnt \u003c n - 1) return INF; return res; } æŸ“è‰²æ³•ï¼ˆæœ¬è´¨dfs)åˆ¤åˆ«äºŒåˆ†å›¾ â€”â€” æ¨¡æ¿é¢˜ AcWing 860. æŸ“è‰²æ³•åˆ¤å®šäºŒåˆ†å›¾ ç»™å®šä¸€ä¸ª n ä¸ªç‚¹mæ¡è¾¹çš„æ— å‘å›¾ï¼Œå›¾ä¸­å¯èƒ½å­˜åœ¨é‡è¾¹å’Œè‡ªç¯ã€‚è¯·ä½ åˆ¤æ–­è¿™ä¸ªå›¾æ˜¯å¦æ˜¯äºŒåˆ†å›¾ã€‚\næ—¶é—´å¤æ‚åº¦æ˜¯ O(n+m), n è¡¨ç¤ºç‚¹æ•°ï¼Œm è¡¨ç¤ºè¾¹æ•°\nint n; // nè¡¨ç¤ºç‚¹æ•° int h[N], e[M], ne[M], idx; // é‚»æ¥è¡¨å­˜å‚¨å›¾ int color[N]; // è¡¨ç¤ºæ¯ä¸ªç‚¹çš„é¢œè‰²ï¼Œ-1è¡¨ç¤ºä¸ºæŸ“è‰²ï¼Œ0è¡¨ç¤ºç™½è‰²ï¼Œ1è¡¨ç¤ºé»‘è‰² // å‚æ•°ï¼šuè¡¨ç¤ºå½“å‰èŠ‚ç‚¹ï¼Œcè¡¨ç¤ºå½“å‰ç‚¹çš„é¢œè‰² bool dfs(int u, int c) { color[u] = c; for (int i = h[u]; i != -1; i = ne[i]) { int j = e[i]; if (color[j] == -1) { if (!dfs(j, !c)) return false; } else if (color[j] == c) return false; } return true; } bool check() { memset(color, -1, sizeof color); bool flag = true; for (int i = 1; i \u003c= n; i ++ ) if (color[i] == -1) if (!dfs(i, 0)) { flag = false; break; } return flag; } åŒˆç‰™åˆ©ç®—æ³• â€”â€” æ¨¡æ¿é¢˜ AcWing 861. äºŒåˆ†å›¾çš„æœ€å¤§åŒ¹é… æ—¶é—´å¤æ‚åº¦æœ€åæ˜¯ O(nm)ï¼Œå®é™…è¿è¡Œæ—¶é—´ä¸€èˆ¬è¿œå°äºO(nm)ï¼Œ n è¡¨ç¤ºç‚¹æ•°ï¼Œm è¡¨ç¤ºè¾¹æ•°\nåšé”™ä¸€ä»¶äº‹ï¼Œé”™è¿‡ä¸€ä»¶äº‹\nint n1, n2; // n1è¡¨ç¤ºç¬¬ä¸€ä¸ªé›†åˆä¸­çš„ç‚¹æ•°ï¼Œn2è¡¨ç¤ºç¬¬äºŒä¸ªé›†åˆä¸­çš„ç‚¹æ•° int h[N], e[M], ne[M], idx; // é‚»æ¥è¡¨å­˜å‚¨æ‰€æœ‰è¾¹ï¼ŒåŒˆç‰™åˆ©ç®—æ³•ä¸­åªä¼šç”¨åˆ°ä»ç¬¬äºŒä¸ªé›†åˆæŒ‡å‘ç¬¬ä¸€ä¸ªé›†åˆçš„è¾¹ï¼Œæ‰€ä»¥è¿™é‡Œåªç”¨å­˜ä¸€ä¸ªæ–¹å‘çš„è¾¹ int match[N]; // å­˜å‚¨ç¬¬äºŒä¸ªé›†åˆä¸­çš„æ¯ä¸ªç‚¹å½“å‰åŒ¹é…çš„ç¬¬ä¸€ä¸ªé›†åˆä¸­çš„ç‚¹æ˜¯å“ªä¸ª bool st[N]; // è¡¨ç¤ºç¬¬äºŒä¸ªé›†åˆä¸­çš„æ¯ä¸ªç‚¹æ˜¯å¦å·²ç»è¢«éå†è¿‡ bool find(int x) { for (int i = h[x]; i != -1; i = ne[i]) { int j = e[i]; if (!st[j]) { st[j] = true; if (match[j] == 0 || find(match[j])) { match[j] = x; return true; } } } return false; } // æ±‚æœ€å¤§åŒ¹é…æ•°ï¼Œä¾æ¬¡æšä¸¾ç¬¬ä¸€ä¸ªé›†åˆä¸­çš„æ¯ä¸ªç‚¹èƒ½å¦åŒ¹é…ç¬¬äºŒä¸ªé›†åˆä¸­çš„ç‚¹ int res = 0; for (int i = 1; i \u003c= n1; i ++ ) { memset(st, false, sizeof st); if (find(i)) res ++ ; } ä½œè€…ï¼šyxc é“¾æ¥ï¼šhttps://www.acwing.com/blog/content/405/ æ¥æºï¼šAcWing è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚\nç¬¬å››ç«  è¯•é™¤æ³•åˆ¤å®šè´¨æ•° â€”â€” æ¨¡æ¿é¢˜ AcWing 866. è¯•é™¤æ³•åˆ¤å®šè´¨æ•° è´¨æ•°ï¼šå¤§äº1çš„æ•´æ•°ä¸­ï¼Œå¦‚æœåªåŒ…å«1å’Œæœ¬èº«ä¸¤ä¸ªçº¦æŸï¼Œç§°ä¸ºè´¨æ•°ï¼ˆç´ æ•°ï¼‰\nï¼ˆ1ï¼‰åˆ¤å®šï¼Œè¯•é™¤æ³•\nï¼ˆ2ï¼‰åˆ†è§£è´¨å› æ•°\nbool is_prime(int x) { if (x \u003c 2) return false; for (int i = 2; i \u003c= x / i; i ++ ) if (x % i == 0) return false; return true; } è¯•é™¤æ³•åˆ†è§£è´¨å› æ•° â€”â€” æ¨¡æ¿é¢˜ AcWing 867. åˆ†è§£è´¨å› æ•° void divide(int x) { for (int i = 2; i \u003c= x / i; i ++ ) if (x % i == 0) { int s = 0; while (x % i == 0) x /= i, s ++ ; cout \u003c\u003c i \u003c\u003c ' ' \u003c\u003c s \u003c\u003c endl; } if (x \u003e 1) cout \u003c\u003c x \u003c\u003c ' ' \u003c\u003c 1 \u003c\u003c endl; cout \u003c\u003c endl; } æœ´ç´ ç­›æ³•æ±‚ç´ æ•° â€”â€” æ¨¡æ¿é¢˜ AcWing 868. ç­›è´¨æ•° int primes[N], cnt; // primes[]å­˜å‚¨æ‰€æœ‰ç´ æ•° bool st[N]; // st[x]å­˜å‚¨xæ˜¯å¦è¢«ç­›æ‰ void get_primes(int n) { for (int i = 2; i \u003c= n; i ++ ) { if (st[i]) continue; primes[cnt ++ ] = i; for (int j = i; j \u003c= n; j += i) st[j] = true; } } çº¿æ€§ç­›æ³•æ±‚ç´ æ•° â€”â€” æ¨¡æ¿é¢˜ AcWing 868. ç­›è´¨æ•° è¢«æœ€å°è´¨å› å­ç­›æ‰\nint primes[N], cnt; // primes[]å­˜å‚¨æ‰€æœ‰ç´ æ•° bool st[N]; // st[x]å­˜å‚¨xæ˜¯å¦è¢«ç­›æ‰ void get_primes(int n) { for (int i = 2; i \u003c= n; i ++ ) { if (!st[i]) primes[cnt ++ ] = i; for (int j = 0; primes[j] \u003c= n / i; j ++ ) { st[primes[j] * i] = true; if (i % primes[j] == 0) break; } } } è¯•é™¤æ³•æ±‚æ‰€æœ‰çº¦æ•° â€”â€” æ¨¡æ¿é¢˜ AcWing 869. è¯•é™¤æ³•æ±‚çº¦æ•° intèŒƒå›´å†…çº¦æ•°ä¸ªæ•°æœ€å¤šä¸º1500ä¸ªå·¦å³\nvector\u003cint\u003e get_divisors(int x) { vector\u003cint\u003e res; for (int i = 1; i \u003c= x / i; i ++ ) if (x % i == 0) { res.push_back(i); if (i != x / i) res.push_back(x / i); } sort(res.begin(), res.end()); return res; } çº¦æ•°ä¸ªæ•°å’Œçº¦æ•°ä¹‹å’Œ â€”â€” æ¨¡æ¿é¢˜ AcWing 870. çº¦æ•°ä¸ªæ•°, AcWing 871. çº¦æ•°ä¹‹å’Œ å¦‚æœ N = p1^c1 * p2^c2 * ... *pk^ck çº¦æ•°ä¸ªæ•°ï¼š (c1 + 1) * (c2 + 1) * ... * (ck + 1) çº¦æ•°ä¹‹å’Œï¼š (p1^0 + p1^1 + ... + p1^c1) * ... * (pk^0 + pk^1 + ... + pk^ck) æ¬§å‡ é‡Œå¾—ç®—æ³• â€”â€” æ¨¡æ¿é¢˜ AcWing 872. æœ€å¤§å…¬çº¦æ•° int gcd(int a, int b) { return b ? gcd(b, a % b) : a; } æ±‚æ¬§æ‹‰å‡½æ•° â€”â€” æ¨¡æ¿é¢˜ AcWing 873. æ¬§æ‹‰å‡½æ•° æ¬§æ‹‰å‡½æ•°å…¬å¼ï¼ˆå®¹æ–¥åŸç†) : n*(1-p1)*(1-p2)â€¦(1-pk)\nint phi(int x) { int res = x; for (int i = 2; i \u003c= x / i; i ++ ) if (x % i == 0) { res = res / i * (i - 1); while (x % i == 0) x /= i; } if (x \u003e 1) res = res / x * (x - 1); return res; } ç­›æ³•æ±‚æ¬§æ‹‰å‡½æ•° â€”â€” æ¨¡æ¿é¢˜ AcWing 874. ç­›æ³•æ±‚æ¬§æ‹‰å‡½æ•° O(n) çº¿æ€§æ±‚æ‰€æœ‰æ•°çš„æ¬§æ‹‰å‡½æ•°\nåº”ç”¨ï¼šæ¬§æ‹‰å®šç†ï¼šaä¸näº’è´¨ a^Ï†(n)=1(mod n)\nint primes[N], cnt; // primes[]å­˜å‚¨æ‰€æœ‰ç´ æ•° int euler[N]; // å­˜å‚¨æ¯ä¸ªæ•°çš„æ¬§æ‹‰å‡½æ•° bool st[N]; // st[x]å­˜å‚¨xæ˜¯å¦è¢«ç­›æ‰ void get_eulers(int n) { euler[1] = 1; for (int i = 2; i \u003c= n; i ++ ) { if (!st[i]) { primes[cnt ++ ] = i; euler[i] = i - 1; } for (int j = 0; primes[j] \u003c= n / i; j ++ ) { int t = primes[j] * i; st[t] = true; if (i % primes[j] == 0) { euler[t] = euler[i] * primes[j]; break; } euler[t] = euler[i] * (primes[j] - 1); } } } å¿«é€Ÿå¹‚ â€”â€” æ¨¡æ¿é¢˜ AcWing 875. å¿«é€Ÿå¹‚ æ±‚ m^k mod pï¼Œæ—¶é—´å¤æ‚åº¦ O(logk)ã€‚\nint qmi(int m, int k, int p) { int res = 1 % p, t = m; while (k) { if (k\u00261) res = res * t % p; t = t * t % p; k \u003e\u003e= 1; } return res; } æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³• â€”â€” æ¨¡æ¿é¢˜ AcWing 877. æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³• // æ±‚x, yï¼Œä½¿å¾—ax + by = gcd(a, b) int exgcd(int a, int b, int \u0026x, int \u0026y) { if (!b) { x = 1; y = 0; return a; } int d = exgcd(b, a % b, y, x); y -= (a/b) * x; return d; } é«˜æ–¯æ¶ˆå…ƒ â€”â€” æ¨¡æ¿é¢˜ AcWing 883. é«˜æ–¯æ¶ˆå…ƒè§£çº¿æ€§æ–¹ç¨‹ç»„ O(n^3)æ—¶é—´å†…è§£nä¸ªæ–¹ç¨‹nä¸ªæœªçŸ¥æ•°çš„è§£ã€‚\nè§£ï¼šæ— è§£ ï¼› æ— ç©·å¤šç»„è§£ ï¼› å”¯ä¸€è§£ ï¼›\nå®Œç¾é˜¶æ¢¯å‹ï¼šå”¯ä¸€è§£ *0=*éé›¶ ï¼š *æ— è§£ 0=0 ï¼š æ— ç©·å¤šç»„è§£ é«˜æ–¯æ¶ˆå…ƒï¼š\næšä¸¾æ¯ä¸€åˆ—cï¼š\næ‰¾åˆ°ç»å¯¹å€¼æœ€å¤§çš„ä¸€è¡Œ å°†è¯¥è¡Œæ¢åˆ°æœ€ä¸Šé¢ å°†è¯¥è¡Œç¬¬ä¸€ä¸ªæ•°å˜æˆ1 å°†ä¸‹é¢æ‰€æœ‰è¡Œçš„ç¬¬cåˆ—æ¶ˆæˆ0 // a[N][N]æ˜¯å¢å¹¿çŸ©é˜µ int gauss() { int c, r; for (c = 0, r = 0; c \u003c n; c ++ ) { int t = r; for (int i = r; i \u003c n; i ++ ) // æ‰¾åˆ°ç»å¯¹å€¼æœ€å¤§çš„è¡Œ if (fabs(a[i][c]) \u003e fabs(a[t][c])) t = i; if (fabs(a[t][c]) \u003c eps) continue; for (int i = c; i \u003c= n; i ++ ) swap(a[t][i], a[r][i]); // å°†ç»å¯¹å€¼æœ€å¤§çš„è¡Œæ¢åˆ°æœ€é¡¶ç«¯ for (int i = n; i \u003e= c; i -- ) a[r][i] /= a[r][c]; // å°†å½“å‰ä¸Šçš„é¦–ä½å˜æˆ1 for (int i = r + 1; i \u003c n; i ++ ) // ç”¨å½“å‰è¡Œå°†ä¸‹é¢æ‰€æœ‰çš„åˆ—æ¶ˆæˆ0 if (fabs(a[i][c]) \u003e eps) for (int j = n; j \u003e= c; j -- ) a[i][j] -= a[r][j] * a[i][c]; r ++ ; } if (r \u003c n) { for (int i = r; i \u003c n; i ++ ) if (fabs(a[i][n]) \u003e eps) return 2; // æ— è§£ return 1; // æœ‰æ— ç©·å¤šç»„è§£ } for (int i = n - 1; i \u003e= 0; i -- ) for (int j = i + 1; j \u003c n; j ++ ) a[i][n] -= a[i][j] * a[j][n]; return 0; // æœ‰å”¯ä¸€è§£ } é€’å½’æ³•æ±‚ç»„åˆæ•° â€”â€” æ¨¡æ¿é¢˜ AcWing 885. æ±‚ç»„åˆæ•° I åä¸‡ 1",
  "wordCount" : "13859",
  "inLanguage": "en",
  "datePublished": "0001-01-01T00:00:00Z",
  "dateModified": "0001-01-01T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "ShowGuan"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://kennems.github.io/en/posts/tech/acwing/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Kennem",
    "logo": {
      "@type": "ImageObject",
      "url": "https://kennems.github.io/img/sun.png"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://kennems.github.io/en/" accesskey="h" title="Kennem&#39;s Blog (Alt + H)">
                <img src="https://kennems.github.io/img/sun.png" alt="" aria-label="logo"
                    height="35">Kennem&#39;s Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://kennems.github.io/en/" title="ğŸ ä¸»é¡µ">
                    <span>ğŸ ä¸»é¡µ</span>
                </a>
            </li>
            <li>
                <a href="https://kennems.github.io/en/search" title="ğŸ”æœç´¢ (Alt &#43; /)" accesskey=/>
                    <span>ğŸ”æœç´¢</span>
                </a>
            </li>
            <li>
                <a href="https://kennems.github.io/en/posts" title="ğŸ“šæ–‡ç« ">
                    <span>ğŸ“šæ–‡ç« </span>
                </a>
            </li>
            <li>
                <a href="https://kennems.github.io/en/archives/" title="â±æ—¶é—´è½´">
                    <span>â±æ—¶é—´è½´</span>
                </a>
            </li>
            <li>
                <a href="https://kennems.github.io/en/tags" title="ğŸ”–æ ‡ç­¾">
                    <span>ğŸ”–æ ‡ç­¾</span>
                </a>
            </li>
            <li>
                <a href="https://kennems.github.io/en/categories" title="ğŸ—‚ï¸åˆ†ç±»">
                    <span>ğŸ—‚ï¸åˆ†ç±»</span>
                </a>
            </li>
            <li>
                <a href="https://kennems.github.io/en/about" title="ğŸ™‹ğŸ»â€â™‚ï¸å…³äº">
                    <span>ğŸ™‹ğŸ»â€â™‚ï¸å…³äº</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://kennems.github.io/en/">Home</a>&nbsp;Â»&nbsp;<a href="https://kennems.github.io/en/posts/">ğŸ“šæ–‡ç« </a>&nbsp;Â»&nbsp;<a href="https://kennems.github.io/en/posts/tech/">ğŸ’»æŠ€æœ¯</a></div>
    <h1 class="post-title entry-hint-parent">
      
    </h1>
    <div class="post-meta">28 min&nbsp;Â·&nbsp;13859 words&nbsp;Â·&nbsp;updated:&nbsp;0001-01-01&nbsp;Â·&nbsp;ShowGuan

</div>
	
	 <div class="post-password">
        
    </div>
  </header> <div class="toc">
    <details  open>
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#acwing%e7%ae%97%e6%b3%95%e5%ad%a6%e4%b9%a0" aria-label="acwingç®—æ³•å­¦ä¹ ">acwingç®—æ³•å­¦ä¹ </a><ul>
                        
                <li>
                    <a href="#%e7%ac%ac%e4%b8%80%e7%ab%a0" aria-label="ç¬¬ä¸€ç« ">ç¬¬ä¸€ç« </a><ul>
                        
                <li>
                    <a href="#%e5%bf%ab%e9%80%9f%e6%8e%92%e5%ba%8f%e7%ae%97%e6%b3%95%e6%a8%a1%e6%9d%bf--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-785-%e5%bf%ab%e9%80%9f%e6%8e%92%e5%ba%8f" aria-label="å¿«é€Ÿæ’åºç®—æ³•æ¨¡æ¿ â€”â€” æ¨¡æ¿é¢˜ AcWing 785. å¿«é€Ÿæ’åº">å¿«é€Ÿæ’åºç®—æ³•æ¨¡æ¿ â€”â€” æ¨¡æ¿é¢˜ AcWing 785. å¿«é€Ÿæ’åº</a></li>
                <li>
                    <a href="#%e5%bd%92%e5%b9%b6%e6%8e%92%e5%ba%8f%e7%ae%97%e6%b3%95%e6%a8%a1%e6%9d%bf--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-787-%e5%bd%92%e5%b9%b6%e6%8e%92%e5%ba%8f" aria-label="å½’å¹¶æ’åºç®—æ³•æ¨¡æ¿ â€”â€” æ¨¡æ¿é¢˜ AcWing 787. å½’å¹¶æ’åº">å½’å¹¶æ’åºç®—æ³•æ¨¡æ¿ â€”â€” æ¨¡æ¿é¢˜ AcWing 787. å½’å¹¶æ’åº</a></li>
                <li>
                    <a href="#%e6%95%b4%e6%95%b0%e4%ba%8c%e5%88%86%e7%ae%97%e6%b3%95%e6%a8%a1%e6%9d%bf--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-789-%e6%95%b0%e7%9a%84%e8%8c%83%e5%9b%b4" aria-label="æ•´æ•°äºŒåˆ†ç®—æ³•æ¨¡æ¿ â€”â€” æ¨¡æ¿é¢˜ AcWing 789. æ•°çš„èŒƒå›´">æ•´æ•°äºŒåˆ†ç®—æ³•æ¨¡æ¿ â€”â€” æ¨¡æ¿é¢˜ AcWing 789. æ•°çš„èŒƒå›´</a></li>
                <li>
                    <a href="#%e6%b5%ae%e7%82%b9%e6%95%b0%e4%ba%8c%e5%88%86%e7%ae%97%e6%b3%95%e6%a8%a1%e6%9d%bf--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-790-%e6%95%b0%e7%9a%84%e4%b8%89%e6%ac%a1%e6%96%b9%e6%a0%b9" aria-label="æµ®ç‚¹æ•°äºŒåˆ†ç®—æ³•æ¨¡æ¿ â€”â€” æ¨¡æ¿é¢˜ AcWing 790. æ•°çš„ä¸‰æ¬¡æ–¹æ ¹">æµ®ç‚¹æ•°äºŒåˆ†ç®—æ³•æ¨¡æ¿ â€”â€” æ¨¡æ¿é¢˜ AcWing 790. æ•°çš„ä¸‰æ¬¡æ–¹æ ¹</a></li>
                <li>
                    <a href="#%e9%ab%98%e7%b2%be%e5%ba%a6%e5%8a%a0%e6%b3%95--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-791-%e9%ab%98%e7%b2%be%e5%ba%a6%e5%8a%a0%e6%b3%95" aria-label="é«˜ç²¾åº¦åŠ æ³• â€”â€” æ¨¡æ¿é¢˜ AcWing 791. é«˜ç²¾åº¦åŠ æ³•">é«˜ç²¾åº¦åŠ æ³• â€”â€” æ¨¡æ¿é¢˜ AcWing 791. é«˜ç²¾åº¦åŠ æ³•</a></li>
                <li>
                    <a href="#%e9%ab%98%e7%b2%be%e5%ba%a6%e5%87%8f%e6%b3%95--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-792-%e9%ab%98%e7%b2%be%e5%ba%a6%e5%87%8f%e6%b3%95" aria-label="é«˜ç²¾åº¦å‡æ³• â€”â€” æ¨¡æ¿é¢˜ AcWing 792. é«˜ç²¾åº¦å‡æ³•">é«˜ç²¾åº¦å‡æ³• â€”â€” æ¨¡æ¿é¢˜ AcWing 792. é«˜ç²¾åº¦å‡æ³•</a></li>
                <li>
                    <a href="#%e9%ab%98%e7%b2%be%e5%ba%a6%e4%b9%98%e4%bd%8e%e7%b2%be%e5%ba%a6--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-793-%e9%ab%98%e7%b2%be%e5%ba%a6%e4%b9%98%e6%b3%95" aria-label="é«˜ç²¾åº¦ä¹˜ä½ç²¾åº¦ â€”â€” æ¨¡æ¿é¢˜ AcWing 793. é«˜ç²¾åº¦ä¹˜æ³•">é«˜ç²¾åº¦ä¹˜ä½ç²¾åº¦ â€”â€” æ¨¡æ¿é¢˜ AcWing 793. é«˜ç²¾åº¦ä¹˜æ³•</a></li>
                <li>
                    <a href="#%e9%ab%98%e7%b2%be%e5%ba%a6%e9%99%a4%e4%bb%a5%e4%bd%8e%e7%b2%be%e5%ba%a6--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-794-%e9%ab%98%e7%b2%be%e5%ba%a6%e9%99%a4%e6%b3%95" aria-label="é«˜ç²¾åº¦é™¤ä»¥ä½ç²¾åº¦ â€”â€” æ¨¡æ¿é¢˜ AcWing 794. é«˜ç²¾åº¦é™¤æ³•">é«˜ç²¾åº¦é™¤ä»¥ä½ç²¾åº¦ â€”â€” æ¨¡æ¿é¢˜ AcWing 794. é«˜ç²¾åº¦é™¤æ³•</a></li>
                <li>
                    <a href="#%e4%b8%80%e7%bb%b4%e5%89%8d%e7%bc%80%e5%92%8c--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-795-%e5%89%8d%e7%bc%80%e5%92%8c" aria-label="ä¸€ç»´å‰ç¼€å’Œ â€”â€” æ¨¡æ¿é¢˜ AcWing 795. å‰ç¼€å’Œ">ä¸€ç»´å‰ç¼€å’Œ â€”â€” æ¨¡æ¿é¢˜ AcWing 795. å‰ç¼€å’Œ</a></li>
                <li>
                    <a href="#%e4%ba%8c%e7%bb%b4%e5%89%8d%e7%bc%80%e5%92%8c--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-796-%e5%ad%90%e7%9f%a9%e9%98%b5%e7%9a%84%e5%92%8c" aria-label="äºŒç»´å‰ç¼€å’Œ â€”â€” æ¨¡æ¿é¢˜ AcWing 796. å­çŸ©é˜µçš„å’Œ">äºŒç»´å‰ç¼€å’Œ â€”â€” æ¨¡æ¿é¢˜ AcWing 796. å­çŸ©é˜µçš„å’Œ</a></li>
                <li>
                    <a href="#%e4%b8%80%e7%bb%b4%e5%b7%ae%e5%88%86--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-797-%e5%b7%ae%e5%88%86" aria-label="ä¸€ç»´å·®åˆ† â€”â€” æ¨¡æ¿é¢˜ AcWing 797. å·®åˆ†">ä¸€ç»´å·®åˆ† â€”â€” æ¨¡æ¿é¢˜ AcWing 797. å·®åˆ†</a></li>
                <li>
                    <a href="#%e4%ba%8c%e7%bb%b4%e5%b7%ae%e5%88%86--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-798-%e5%b7%ae%e5%88%86%e7%9f%a9%e9%98%b5%e4%ba%8c%e7%bb%b4%e5%b7%ae%e5%88%86" aria-label="äºŒç»´å·®åˆ† â€”â€” æ¨¡æ¿é¢˜ AcWing 798. å·®åˆ†çŸ©é˜µ/äºŒç»´å·®åˆ†">äºŒç»´å·®åˆ† â€”â€” æ¨¡æ¿é¢˜ AcWing 798. å·®åˆ†çŸ©é˜µ/äºŒç»´å·®åˆ†</a></li>
                <li>
                    <a href="#%e5%8f%8c%e6%8c%87%e9%92%88%e7%ae%97%e6%b3%95--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-799-%e6%9c%80%e9%95%bf%e8%bf%9e%e7%bb%ad%e4%b8%8d%e9%87%8d%e5%a4%8d%e5%ad%90%e5%ba%8f%e5%88%97-acwing-800-%e6%95%b0%e7%bb%84%e5%85%83%e7%b4%a0%e7%9a%84%e7%9b%ae%e6%a0%87%e5%92%8c-__%e6%bb%91%e5%8a%a8%e7%aa%97%e5%8f%a3" aria-label="åŒæŒ‡é’ˆç®—æ³• â€”â€” æ¨¡æ¿é¢˜ AcWIng 799. æœ€é•¿è¿ç»­ä¸é‡å¤å­åºåˆ—, AcWing 800. æ•°ç»„å…ƒç´ çš„ç›®æ ‡å’Œ __æ»‘åŠ¨çª—å£ï¼Ÿ">åŒæŒ‡é’ˆç®—æ³• â€”â€” æ¨¡æ¿é¢˜ AcWIng 799. æœ€é•¿è¿ç»­ä¸é‡å¤å­åºåˆ—, AcWing 800. æ•°ç»„å…ƒç´ çš„ç›®æ ‡å’Œ __æ»‘åŠ¨çª—å£ï¼Ÿ</a></li>
                <li>
                    <a href="#%e4%bd%8d%e8%bf%90%e7%ae%97--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-801-%e4%ba%8c%e8%bf%9b%e5%88%b6%e4%b8%ad1%e7%9a%84%e4%b8%aa%e6%95%b0" aria-label="ä½è¿ç®— â€”â€” æ¨¡æ¿é¢˜ AcWing 801. äºŒè¿›åˆ¶ä¸­1çš„ä¸ªæ•°">ä½è¿ç®— â€”â€” æ¨¡æ¿é¢˜ AcWing 801. äºŒè¿›åˆ¶ä¸­1çš„ä¸ªæ•°</a></li>
                <li>
                    <a href="#%e6%95%b4%e6%95%b0%e7%a6%bb%e6%95%a3%e5%8c%96--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-802-%e5%8c%ba%e9%97%b4%e5%92%8c" aria-label="æ•´æ•°ç¦»æ•£åŒ– â€”â€” æ¨¡æ¿é¢˜ AcWing 802. åŒºé—´å’Œ">æ•´æ•°ç¦»æ•£åŒ– â€”â€” æ¨¡æ¿é¢˜ AcWing 802. åŒºé—´å’Œ</a></li>
                <li>
                    <a href="#%e5%8c%ba%e9%97%b4%e5%90%88%e5%b9%b6--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-803-%e5%8c%ba%e9%97%b4%e5%90%88%e5%b9%b6" aria-label="åŒºé—´åˆå¹¶ â€”â€” æ¨¡æ¿é¢˜ AcWing 803. åŒºé—´åˆå¹¶">åŒºé—´åˆå¹¶ â€”â€” æ¨¡æ¿é¢˜ AcWing 803. åŒºé—´åˆå¹¶</a></li></ul>
                </li>
                <li>
                    <a href="#%e7%ac%ac%e4%ba%8c%e7%ab%a0" aria-label="ç¬¬äºŒç« ">ç¬¬äºŒç« </a><ul>
                        
                <li>
                    <a href="#%e5%8d%95%e9%93%be%e8%a1%a8--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-826-%e5%8d%95%e9%93%be%e8%a1%a8" aria-label="å•é“¾è¡¨ â€”â€” æ¨¡æ¿é¢˜ AcWing 826. å•é“¾è¡¨">å•é“¾è¡¨ â€”â€” æ¨¡æ¿é¢˜ AcWing 826. å•é“¾è¡¨</a></li>
                <li>
                    <a href="#%e5%8f%8c%e9%93%be%e8%a1%a8--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-827-%e5%8f%8c%e9%93%be%e8%a1%a8" aria-label="åŒé“¾è¡¨ â€”â€” æ¨¡æ¿é¢˜ AcWing 827. åŒé“¾è¡¨">åŒé“¾è¡¨ â€”â€” æ¨¡æ¿é¢˜ AcWing 827. åŒé“¾è¡¨</a></li>
                <li>
                    <a href="#%e6%a0%88--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-828-%e6%a8%a1%e6%8b%9f%e6%a0%88" aria-label="æ ˆ â€”â€” æ¨¡æ¿é¢˜ AcWing 828. æ¨¡æ‹Ÿæ ˆ">æ ˆ â€”â€” æ¨¡æ¿é¢˜ AcWing 828. æ¨¡æ‹Ÿæ ˆ</a></li>
                <li>
                    <a href="#%e9%98%9f%e5%88%97--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-829-%e6%a8%a1%e6%8b%9f%e9%98%9f%e5%88%97" aria-label="é˜Ÿåˆ— â€”â€” æ¨¡æ¿é¢˜ AcWing 829. æ¨¡æ‹Ÿé˜Ÿåˆ—">é˜Ÿåˆ— â€”â€” æ¨¡æ¿é¢˜ AcWing 829. æ¨¡æ‹Ÿé˜Ÿåˆ—</a></li>
                <li>
                    <a href="#%e5%8d%95%e8%b0%83%e6%a0%88--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-830-%e5%8d%95%e8%b0%83%e6%a0%88" aria-label="å•è°ƒæ ˆ â€”â€” æ¨¡æ¿é¢˜ AcWing 830. å•è°ƒæ ˆ">å•è°ƒæ ˆ â€”â€” æ¨¡æ¿é¢˜ AcWing 830. å•è°ƒæ ˆ</a></li>
                <li>
                    <a href="#%e5%8d%95%e8%b0%83%e9%98%9f%e5%88%97--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-154-%e6%bb%91%e5%8a%a8%e7%aa%97%e5%8f%a3" aria-label="å•è°ƒé˜Ÿåˆ— â€”â€” æ¨¡æ¿é¢˜ AcWing 154. æ»‘åŠ¨çª—å£">å•è°ƒé˜Ÿåˆ— â€”â€” æ¨¡æ¿é¢˜ AcWing 154. æ»‘åŠ¨çª—å£</a></li>
                <li>
                    <a href="#kmp--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-831-kmp%e5%ad%97%e7%ac%a6%e4%b8%b2" aria-label="KMP â€”â€” æ¨¡æ¿é¢˜ AcWing 831. KMPå­—ç¬¦ä¸²">KMP â€”â€” æ¨¡æ¿é¢˜ AcWing 831. KMPå­—ç¬¦ä¸²</a></li>
                <li>
                    <a href="#trie%e6%a0%91--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-835-trie%e5%ad%97%e7%ac%a6%e4%b8%b2%e7%bb%9f%e8%ae%a1" aria-label="Trieæ ‘ â€”â€” æ¨¡æ¿é¢˜ AcWing 835. Trieå­—ç¬¦ä¸²ç»Ÿè®¡">Trieæ ‘ â€”â€” æ¨¡æ¿é¢˜ AcWing 835. Trieå­—ç¬¦ä¸²ç»Ÿè®¡</a></li>
                <li>
                    <a href="#%e5%b9%b6%e6%9f%a5%e9%9b%86--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-836-%e5%90%88%e5%b9%b6%e9%9b%86%e5%90%88-acwing-837-%e8%bf%9e%e9%80%9a%e5%9d%97%e4%b8%ad%e7%82%b9%e7%9a%84%e6%95%b0%e9%87%8f" aria-label="å¹¶æŸ¥é›† â€”â€” æ¨¡æ¿é¢˜ AcWing 836. åˆå¹¶é›†åˆ, AcWing 837. è¿é€šå—ä¸­ç‚¹çš„æ•°é‡">å¹¶æŸ¥é›† â€”â€” æ¨¡æ¿é¢˜ AcWing 836. åˆå¹¶é›†åˆ, AcWing 837. è¿é€šå—ä¸­ç‚¹çš„æ•°é‡</a></li>
                <li>
                    <a href="#%e5%a0%86--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-838-%e5%a0%86%e6%8e%92%e5%ba%8f-acwing-839-%e6%a8%a1%e6%8b%9f%e5%a0%86" aria-label="å † â€”â€” æ¨¡æ¿é¢˜ AcWing 838. å †æ’åº, AcWing 839. æ¨¡æ‹Ÿå †">å † â€”â€” æ¨¡æ¿é¢˜ AcWing 838. å †æ’åº, AcWing 839. æ¨¡æ‹Ÿå †</a></li>
                <li>
                    <a href="#%e4%b8%80%e8%88%ac%e5%93%88%e5%b8%8c--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-840-%e6%a8%a1%e6%8b%9f%e6%95%a3%e5%88%97%e8%a1%a8" aria-label="ä¸€èˆ¬å“ˆå¸Œ â€”â€” æ¨¡æ¿é¢˜ AcWing 840. æ¨¡æ‹Ÿæ•£åˆ—è¡¨">ä¸€èˆ¬å“ˆå¸Œ â€”â€” æ¨¡æ¿é¢˜ AcWing 840. æ¨¡æ‹Ÿæ•£åˆ—è¡¨</a></li>
                <li>
                    <a href="#%e5%ad%97%e7%ac%a6%e4%b8%b2%e5%93%88%e5%b8%8c--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-841-%e5%ad%97%e7%ac%a6%e4%b8%b2%e5%93%88%e5%b8%8c" aria-label="å­—ç¬¦ä¸²å“ˆå¸Œ â€”â€” æ¨¡æ¿é¢˜ AcWing 841. å­—ç¬¦ä¸²å“ˆå¸Œ">å­—ç¬¦ä¸²å“ˆå¸Œ â€”â€” æ¨¡æ¿é¢˜ AcWing 841. å­—ç¬¦ä¸²å“ˆå¸Œ</a></li></ul>
                </li>
                <li>
                    <a href="#c-stl%e7%ae%80%e4%bb%8b" aria-label="C&#43;&#43; STLç®€ä»‹">C++ STLç®€ä»‹</a></li>
                <li>
                    <a href="#%e7%ac%ac%e4%b8%89%e7%ab%a0" aria-label="ç¬¬ä¸‰ç« ">ç¬¬ä¸‰ç« </a><ul>
                        
                <li>
                    <a href="#%e6%a0%91%e4%b8%8e%e5%9b%be%e7%9a%84%e5%ad%98%e5%82%a8" aria-label="æ ‘ä¸å›¾çš„å­˜å‚¨">æ ‘ä¸å›¾çš„å­˜å‚¨</a></li>
                <li>
                    <a href="#%e6%a0%91%e4%b8%8e%e5%9b%be%e7%9a%84%e9%81%8d%e5%8e%86" aria-label="æ ‘ä¸å›¾çš„éå†">æ ‘ä¸å›¾çš„éå†</a><ul>
                        
                <li>
                    <a href="#1-%e6%b7%b1%e5%ba%a6%e4%bc%98%e5%85%88%e9%81%8d%e5%8e%86--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-846-%e6%a0%91%e7%9a%84%e9%87%8d%e5%bf%83" aria-label="(1) æ·±åº¦ä¼˜å…ˆéå† â€”â€” æ¨¡æ¿é¢˜ AcWing 846. æ ‘çš„é‡å¿ƒ">(1) æ·±åº¦ä¼˜å…ˆéå† â€”â€” æ¨¡æ¿é¢˜ AcWing 846. æ ‘çš„é‡å¿ƒ</a></li>
                <li>
                    <a href="#2-%e5%ae%bd%e5%ba%a6%e4%bc%98%e5%85%88%e9%81%8d%e5%8e%86--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-847-%e5%9b%be%e4%b8%ad%e7%82%b9%e7%9a%84%e5%b1%82%e6%ac%a1" aria-label="(2) å®½åº¦ä¼˜å…ˆéå† â€”â€” æ¨¡æ¿é¢˜ AcWing 847. å›¾ä¸­ç‚¹çš„å±‚æ¬¡">(2) å®½åº¦ä¼˜å…ˆéå† â€”â€” æ¨¡æ¿é¢˜ AcWing 847. å›¾ä¸­ç‚¹çš„å±‚æ¬¡</a></li></ul>
                </li>
                <li>
                    <a href="#%e6%8b%93%e6%89%91%e6%8e%92%e5%ba%8f--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-848-%e6%9c%89%e5%90%91%e5%9b%be%e7%9a%84%e6%8b%93%e6%89%91%e5%ba%8f%e5%88%97" aria-label="æ‹“æ‰‘æ’åº â€”â€” æ¨¡æ¿é¢˜ AcWing 848. æœ‰å‘å›¾çš„æ‹“æ‰‘åºåˆ—">æ‹“æ‰‘æ’åº â€”â€” æ¨¡æ¿é¢˜ AcWing 848. æœ‰å‘å›¾çš„æ‹“æ‰‘åºåˆ—</a></li>
                <li>
                    <a href="#%e6%9c%80%e7%9f%ad%e8%b7%af" aria-label="æœ€çŸ­è·¯">æœ€çŸ­è·¯</a></li>
                <li>
                    <a href="#%e6%9c%b4%e7%b4%a0dijkstra%e7%ae%97%e6%b3%95--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-849-dijkstra%e6%b1%82%e6%9c%80%e7%9f%ad%e8%b7%af-i-%e5%9f%ba%e4%ba%8e%e8%b4%aa%e5%bf%83" aria-label="æœ´ç´ dijkstraç®—æ³• â€”â€” æ¨¡æ¿é¢˜ AcWing 849. Dijkstraæ±‚æœ€çŸ­è·¯ I åŸºäºè´ªå¿ƒ">æœ´ç´ dijkstraç®—æ³• â€”â€” æ¨¡æ¿é¢˜ AcWing 849. Dijkstraæ±‚æœ€çŸ­è·¯ I åŸºäºè´ªå¿ƒ</a></li>
                <li>
                    <a href="#%e5%a0%86%e4%bc%98%e5%8c%96%e7%89%88dijkstra--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-850-dijkstra%e6%b1%82%e6%9c%80%e7%9f%ad%e8%b7%af-ii" aria-label="å †ä¼˜åŒ–ç‰ˆdijkstra â€”â€” æ¨¡æ¿é¢˜ AcWing 850. Dijkstraæ±‚æœ€çŸ­è·¯ II">å †ä¼˜åŒ–ç‰ˆdijkstra â€”â€” æ¨¡æ¿é¢˜ AcWing 850. Dijkstraæ±‚æœ€çŸ­è·¯ II</a></li>
                <li>
                    <a href="#bellman-ford%e7%ae%97%e6%b3%95--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-853-%e6%9c%89%e8%be%b9%e6%95%b0%e9%99%90%e5%88%b6%e7%9a%84%e6%9c%80%e7%9f%ad%e8%b7%af" aria-label="Bellman-Fordç®—æ³• â€”â€” æ¨¡æ¿é¢˜ AcWing 853. æœ‰è¾¹æ•°é™åˆ¶çš„æœ€çŸ­è·¯">Bellman-Fordç®—æ³• â€”â€” æ¨¡æ¿é¢˜ AcWing 853. æœ‰è¾¹æ•°é™åˆ¶çš„æœ€çŸ­è·¯</a></li>
                <li>
                    <a href="#spfa-%e7%ae%97%e6%b3%95%e9%98%9f%e5%88%97%e4%bc%98%e5%8c%96%e7%9a%84bellman-ford%e7%ae%97%e6%b3%95--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-851-spfa%e6%b1%82%e6%9c%80%e7%9f%ad%e8%b7%af" aria-label="spfa ç®—æ³•ï¼ˆé˜Ÿåˆ—ä¼˜åŒ–çš„Bellman-Fordç®—æ³•ï¼‰ â€”â€” æ¨¡æ¿é¢˜ AcWing 851. spfaæ±‚æœ€çŸ­è·¯">spfa ç®—æ³•ï¼ˆé˜Ÿåˆ—ä¼˜åŒ–çš„Bellman-Fordç®—æ³•ï¼‰ â€”â€” æ¨¡æ¿é¢˜ AcWing 851. spfaæ±‚æœ€çŸ­è·¯</a></li>
                <li>
                    <a href="#spfa%e5%88%a4%e6%96%ad%e5%9b%be%e4%b8%ad%e6%98%af%e5%90%a6%e5%ad%98%e5%9c%a8%e8%b4%9f%e7%8e%af--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-852-spfa%e5%88%a4%e6%96%ad%e8%b4%9f%e7%8e%af" aria-label="spfaåˆ¤æ–­å›¾ä¸­æ˜¯å¦å­˜åœ¨è´Ÿç¯ â€”â€” æ¨¡æ¿é¢˜ AcWing 852. spfaåˆ¤æ–­è´Ÿç¯">spfaåˆ¤æ–­å›¾ä¸­æ˜¯å¦å­˜åœ¨è´Ÿç¯ â€”â€” æ¨¡æ¿é¢˜ AcWing 852. spfaåˆ¤æ–­è´Ÿç¯</a></li>
                <li>
                    <a href="#floyd%e7%ae%97%e6%b3%95--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-854-floyd%e6%b1%82%e6%9c%80%e7%9f%ad%e8%b7%af" aria-label="floydç®—æ³• â€”â€” æ¨¡æ¿é¢˜ AcWing 854. Floydæ±‚æœ€çŸ­è·¯">floydç®—æ³• â€”â€” æ¨¡æ¿é¢˜ AcWing 854. Floydæ±‚æœ€çŸ­è·¯</a></li>
                <li>
                    <a href="#%e6%9c%80%e5%b0%8f%e7%94%9f%e6%88%90%e6%a0%91%e6%97%a0%e5%90%91%e5%9b%be" aria-label="æœ€å°ç”Ÿæˆæ ‘ï¼ˆæ— å‘å›¾ï¼‰">æœ€å°ç”Ÿæˆæ ‘ï¼ˆæ— å‘å›¾ï¼‰</a></li>
                <li>
                    <a href="#%e6%9c%b4%e7%b4%a0%e7%89%88prim%e7%ae%97%e6%b3%95--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-858-prim%e7%ae%97%e6%b3%95%e6%b1%82%e6%9c%80%e5%b0%8f%e7%94%9f%e6%88%90%e6%a0%91" aria-label="æœ´ç´ ç‰ˆprimç®—æ³• â€”â€” æ¨¡æ¿é¢˜ AcWing 858. Primç®—æ³•æ±‚æœ€å°ç”Ÿæˆæ ‘">æœ´ç´ ç‰ˆprimç®—æ³• â€”â€” æ¨¡æ¿é¢˜ AcWing 858. Primç®—æ³•æ±‚æœ€å°ç”Ÿæˆæ ‘</a></li>
                <li>
                    <a href="#kruskal%e7%ae%97%e6%b3%95--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-859-kruskal%e7%ae%97%e6%b3%95%e6%b1%82%e6%9c%80%e5%b0%8f%e7%94%9f%e6%88%90%e6%a0%91" aria-label="Kruskalç®—æ³• â€”â€” æ¨¡æ¿é¢˜ AcWing 859. Kruskalç®—æ³•æ±‚æœ€å°ç”Ÿæˆæ ‘">Kruskalç®—æ³• â€”â€” æ¨¡æ¿é¢˜ AcWing 859. Kruskalç®—æ³•æ±‚æœ€å°ç”Ÿæˆæ ‘</a></li>
                <li>
                    <a href="#%e6%9f%93%e8%89%b2%e6%b3%95%e6%9c%ac%e8%b4%a8dfs%e5%88%a4%e5%88%ab%e4%ba%8c%e5%88%86%e5%9b%be--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-860-%e6%9f%93%e8%89%b2%e6%b3%95%e5%88%a4%e5%ae%9a%e4%ba%8c%e5%88%86%e5%9b%be" aria-label="æŸ“è‰²æ³•ï¼ˆæœ¬è´¨dfs)åˆ¤åˆ«äºŒåˆ†å›¾ â€”â€” æ¨¡æ¿é¢˜ AcWing 860. æŸ“è‰²æ³•åˆ¤å®šäºŒåˆ†å›¾">æŸ“è‰²æ³•ï¼ˆæœ¬è´¨dfs)åˆ¤åˆ«äºŒåˆ†å›¾ â€”â€” æ¨¡æ¿é¢˜ AcWing 860. æŸ“è‰²æ³•åˆ¤å®šäºŒåˆ†å›¾</a></li>
                <li>
                    <a href="#%e5%8c%88%e7%89%99%e5%88%a9%e7%ae%97%e6%b3%95--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-861-%e4%ba%8c%e5%88%86%e5%9b%be%e7%9a%84%e6%9c%80%e5%a4%a7%e5%8c%b9%e9%85%8d" aria-label="åŒˆç‰™åˆ©ç®—æ³• â€”â€” æ¨¡æ¿é¢˜ AcWing 861. äºŒåˆ†å›¾çš„æœ€å¤§åŒ¹é…">åŒˆç‰™åˆ©ç®—æ³• â€”â€” æ¨¡æ¿é¢˜ AcWing 861. äºŒåˆ†å›¾çš„æœ€å¤§åŒ¹é…</a></li></ul>
                </li>
                <li>
                    <a href="#%e7%ac%ac%e5%9b%9b%e7%ab%a0" aria-label="ç¬¬å››ç« ">ç¬¬å››ç« </a><ul>
                        
                <li>
                    <a href="#%e8%af%95%e9%99%a4%e6%b3%95%e5%88%a4%e5%ae%9a%e8%b4%a8%e6%95%b0--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-866-%e8%af%95%e9%99%a4%e6%b3%95%e5%88%a4%e5%ae%9a%e8%b4%a8%e6%95%b0" aria-label="è¯•é™¤æ³•åˆ¤å®šè´¨æ•° â€”â€” æ¨¡æ¿é¢˜ AcWing 866. è¯•é™¤æ³•åˆ¤å®šè´¨æ•°">è¯•é™¤æ³•åˆ¤å®šè´¨æ•° â€”â€” æ¨¡æ¿é¢˜ AcWing 866. è¯•é™¤æ³•åˆ¤å®šè´¨æ•°</a></li>
                <li>
                    <a href="#%e8%af%95%e9%99%a4%e6%b3%95%e5%88%86%e8%a7%a3%e8%b4%a8%e5%9b%a0%e6%95%b0--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-867-%e5%88%86%e8%a7%a3%e8%b4%a8%e5%9b%a0%e6%95%b0" aria-label="è¯•é™¤æ³•åˆ†è§£è´¨å› æ•° â€”â€” æ¨¡æ¿é¢˜ AcWing 867. åˆ†è§£è´¨å› æ•°">è¯•é™¤æ³•åˆ†è§£è´¨å› æ•° â€”â€” æ¨¡æ¿é¢˜ AcWing 867. åˆ†è§£è´¨å› æ•°</a></li>
                <li>
                    <a href="#%e6%9c%b4%e7%b4%a0%e7%ad%9b%e6%b3%95%e6%b1%82%e7%b4%a0%e6%95%b0--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-868-%e7%ad%9b%e8%b4%a8%e6%95%b0" aria-label="æœ´ç´ ç­›æ³•æ±‚ç´ æ•° â€”â€” æ¨¡æ¿é¢˜ AcWing 868. ç­›è´¨æ•°">æœ´ç´ ç­›æ³•æ±‚ç´ æ•° â€”â€” æ¨¡æ¿é¢˜ AcWing 868. ç­›è´¨æ•°</a></li>
                <li>
                    <a href="#%e7%ba%bf%e6%80%a7%e7%ad%9b%e6%b3%95%e6%b1%82%e7%b4%a0%e6%95%b0--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-868-%e7%ad%9b%e8%b4%a8%e6%95%b0" aria-label="çº¿æ€§ç­›æ³•æ±‚ç´ æ•° â€”â€” æ¨¡æ¿é¢˜ AcWing 868. ç­›è´¨æ•°">çº¿æ€§ç­›æ³•æ±‚ç´ æ•° â€”â€” æ¨¡æ¿é¢˜ AcWing 868. ç­›è´¨æ•°</a></li>
                <li>
                    <a href="#%e8%af%95%e9%99%a4%e6%b3%95%e6%b1%82%e6%89%80%e6%9c%89%e7%ba%a6%e6%95%b0--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-869-%e8%af%95%e9%99%a4%e6%b3%95%e6%b1%82%e7%ba%a6%e6%95%b0" aria-label="è¯•é™¤æ³•æ±‚æ‰€æœ‰çº¦æ•° â€”â€” æ¨¡æ¿é¢˜ AcWing 869. è¯•é™¤æ³•æ±‚çº¦æ•°">è¯•é™¤æ³•æ±‚æ‰€æœ‰çº¦æ•° â€”â€” æ¨¡æ¿é¢˜ AcWing 869. è¯•é™¤æ³•æ±‚çº¦æ•°</a></li>
                <li>
                    <a href="#%e7%ba%a6%e6%95%b0%e4%b8%aa%e6%95%b0%e5%92%8c%e7%ba%a6%e6%95%b0%e4%b9%8b%e5%92%8c--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-870-%e7%ba%a6%e6%95%b0%e4%b8%aa%e6%95%b0-acwing-871-%e7%ba%a6%e6%95%b0%e4%b9%8b%e5%92%8c" aria-label="çº¦æ•°ä¸ªæ•°å’Œçº¦æ•°ä¹‹å’Œ â€”â€” æ¨¡æ¿é¢˜ AcWing 870. çº¦æ•°ä¸ªæ•°, AcWing 871. çº¦æ•°ä¹‹å’Œ">çº¦æ•°ä¸ªæ•°å’Œçº¦æ•°ä¹‹å’Œ â€”â€” æ¨¡æ¿é¢˜ AcWing 870. çº¦æ•°ä¸ªæ•°, AcWing 871. çº¦æ•°ä¹‹å’Œ</a></li>
                <li>
                    <a href="#%e6%ac%a7%e5%87%a0%e9%87%8c%e5%be%97%e7%ae%97%e6%b3%95--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-872-%e6%9c%80%e5%a4%a7%e5%85%ac%e7%ba%a6%e6%95%b0" aria-label="æ¬§å‡ é‡Œå¾—ç®—æ³• â€”â€” æ¨¡æ¿é¢˜ AcWing 872. æœ€å¤§å…¬çº¦æ•°">æ¬§å‡ é‡Œå¾—ç®—æ³• â€”â€” æ¨¡æ¿é¢˜ AcWing 872. æœ€å¤§å…¬çº¦æ•°</a></li>
                <li>
                    <a href="#%e6%b1%82%e6%ac%a7%e6%8b%89%e5%87%bd%e6%95%b0--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-873-%e6%ac%a7%e6%8b%89%e5%87%bd%e6%95%b0" aria-label="æ±‚æ¬§æ‹‰å‡½æ•° â€”â€” æ¨¡æ¿é¢˜ AcWing 873. æ¬§æ‹‰å‡½æ•°">æ±‚æ¬§æ‹‰å‡½æ•° â€”â€” æ¨¡æ¿é¢˜ AcWing 873. æ¬§æ‹‰å‡½æ•°</a></li>
                <li>
                    <a href="#%e7%ad%9b%e6%b3%95%e6%b1%82%e6%ac%a7%e6%8b%89%e5%87%bd%e6%95%b0--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-874-%e7%ad%9b%e6%b3%95%e6%b1%82%e6%ac%a7%e6%8b%89%e5%87%bd%e6%95%b0" aria-label="ç­›æ³•æ±‚æ¬§æ‹‰å‡½æ•° â€”â€” æ¨¡æ¿é¢˜ AcWing 874. ç­›æ³•æ±‚æ¬§æ‹‰å‡½æ•°">ç­›æ³•æ±‚æ¬§æ‹‰å‡½æ•° â€”â€” æ¨¡æ¿é¢˜ AcWing 874. ç­›æ³•æ±‚æ¬§æ‹‰å‡½æ•°</a></li>
                <li>
                    <a href="#%e5%bf%ab%e9%80%9f%e5%b9%82--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-875-%e5%bf%ab%e9%80%9f%e5%b9%82" aria-label="å¿«é€Ÿå¹‚ â€”â€” æ¨¡æ¿é¢˜ AcWing 875. å¿«é€Ÿå¹‚">å¿«é€Ÿå¹‚ â€”â€” æ¨¡æ¿é¢˜ AcWing 875. å¿«é€Ÿå¹‚</a></li>
                <li>
                    <a href="#%e6%89%a9%e5%b1%95%e6%ac%a7%e5%87%a0%e9%87%8c%e5%be%97%e7%ae%97%e6%b3%95--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-877-%e6%89%a9%e5%b1%95%e6%ac%a7%e5%87%a0%e9%87%8c%e5%be%97%e7%ae%97%e6%b3%95" aria-label="æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³• â€”â€” æ¨¡æ¿é¢˜ AcWing 877. æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•">æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³• â€”â€” æ¨¡æ¿é¢˜ AcWing 877. æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•</a></li>
                <li>
                    <a href="#%e9%ab%98%e6%96%af%e6%b6%88%e5%85%83--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-883-%e9%ab%98%e6%96%af%e6%b6%88%e5%85%83%e8%a7%a3%e7%ba%bf%e6%80%a7%e6%96%b9%e7%a8%8b%e7%bb%84" aria-label="é«˜æ–¯æ¶ˆå…ƒ â€”â€” æ¨¡æ¿é¢˜ AcWing 883. é«˜æ–¯æ¶ˆå…ƒè§£çº¿æ€§æ–¹ç¨‹ç»„">é«˜æ–¯æ¶ˆå…ƒ â€”â€” æ¨¡æ¿é¢˜ AcWing 883. é«˜æ–¯æ¶ˆå…ƒè§£çº¿æ€§æ–¹ç¨‹ç»„</a></li>
                <li>
                    <a href="#%e9%80%92%e5%bd%92%e6%b3%95%e6%b1%82%e7%bb%84%e5%90%88%e6%95%b0--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-885-%e6%b1%82%e7%bb%84%e5%90%88%e6%95%b0-i" aria-label="é€’å½’æ³•æ±‚ç»„åˆæ•° â€”â€” æ¨¡æ¿é¢˜ AcWing 885. æ±‚ç»„åˆæ•° I">é€’å½’æ³•æ±‚ç»„åˆæ•° â€”â€” æ¨¡æ¿é¢˜ AcWing 885. æ±‚ç»„åˆæ•° I</a></li>
                <li>
                    <a href="#%e9%80%9a%e8%bf%87%e9%a2%84%e5%a4%84%e7%90%86%e9%80%86%e5%85%83%e7%9a%84%e6%96%b9%e5%bc%8f%e6%b1%82%e7%bb%84%e5%90%88%e6%95%b0--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-886-%e6%b1%82%e7%bb%84%e5%90%88%e6%95%b0-ii" aria-label="é€šè¿‡é¢„å¤„ç†é€†å…ƒçš„æ–¹å¼æ±‚ç»„åˆæ•° â€”â€” æ¨¡æ¿é¢˜ AcWing 886. æ±‚ç»„åˆæ•° II">é€šè¿‡é¢„å¤„ç†é€†å…ƒçš„æ–¹å¼æ±‚ç»„åˆæ•° â€”â€” æ¨¡æ¿é¢˜ AcWing 886. æ±‚ç»„åˆæ•° II</a></li>
                <li>
                    <a href="#lucas%e5%ae%9a%e7%90%86--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-887-%e6%b1%82%e7%bb%84%e5%90%88%e6%95%b0-iii" aria-label="Lucaså®šç† â€”â€” æ¨¡æ¿é¢˜ AcWing 887. æ±‚ç»„åˆæ•° III">Lucaså®šç† â€”â€” æ¨¡æ¿é¢˜ AcWing 887. æ±‚ç»„åˆæ•° III</a></li>
                <li>
                    <a href="#%e5%88%86%e8%a7%a3%e8%b4%a8%e5%9b%a0%e6%95%b0%e6%b3%95%e6%b1%82%e7%bb%84%e5%90%88%e6%95%b0--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-888-%e6%b1%82%e7%bb%84%e5%90%88%e6%95%b0-iv" aria-label="åˆ†è§£è´¨å› æ•°æ³•æ±‚ç»„åˆæ•° â€”â€” æ¨¡æ¿é¢˜ AcWing 888. æ±‚ç»„åˆæ•° IV">åˆ†è§£è´¨å› æ•°æ³•æ±‚ç»„åˆæ•° â€”â€” æ¨¡æ¿é¢˜ AcWing 888. æ±‚ç»„åˆæ•° IV</a></li>
                <li>
                    <a href="#%e5%8d%a1%e7%89%b9%e5%85%b0%e6%95%b0--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-889-%e6%bb%a1%e8%b6%b3%e6%9d%a1%e4%bb%b6%e7%9a%8401%e5%ba%8f%e5%88%97" aria-label="å¡ç‰¹å…°æ•° â€”â€” æ¨¡æ¿é¢˜ AcWing 889. æ»¡è¶³æ¡ä»¶çš„01åºåˆ—">å¡ç‰¹å…°æ•° â€”â€” æ¨¡æ¿é¢˜ AcWing 889. æ»¡è¶³æ¡ä»¶çš„01åºåˆ—</a></li>
                <li>
                    <a href="#%e5%ae%b9%e6%96%a5%e5%8e%9f%e7%90%86" aria-label="å®¹æ–¥åŸç†">å®¹æ–¥åŸç†</a></li>
                <li>
                    <a href="#nim%e5%b0%bc%e5%a7%86%e6%b8%b8%e6%88%8f--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-891-nim%e6%b8%b8%e6%88%8f" aria-label="NIM(å°¼å§†)æ¸¸æˆ â€”â€” æ¨¡æ¿é¢˜ AcWing 891. Nimæ¸¸æˆ">NIM(å°¼å§†)æ¸¸æˆ â€”â€” æ¨¡æ¿é¢˜ AcWing 891. Nimæ¸¸æˆ</a></li>
                <li>
                    <a href="#%e6%9c%89%e5%90%91%e5%9b%be%e6%b8%b8%e6%88%8f%e7%9a%84%e5%92%8c--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-893-%e9%9b%86%e5%90%88-nim%e6%b8%b8%e6%88%8f" aria-label="æœ‰å‘å›¾æ¸¸æˆçš„å’Œ â€”â€” æ¨¡æ¿é¢˜ AcWing 893. é›†åˆ-Nimæ¸¸æˆ">æœ‰å‘å›¾æ¸¸æˆçš„å’Œ â€”â€” æ¨¡æ¿é¢˜ AcWing 893. é›†åˆ-Nimæ¸¸æˆ</a></li></ul>
                </li>
                <li>
                    <a href="#%e6%97%b6%e7%a9%ba%e5%a4%8d%e6%9d%82%e5%ba%a6%e5%88%86%e6%9e%90" aria-label="æ—¶ç©ºå¤æ‚åº¦åˆ†æ">æ—¶ç©ºå¤æ‚åº¦åˆ†æ</a></li></ul>
                </li>
                <li>
                    <a href="#%e5%8a%a8%e6%80%81%e8%a7%84%e5%88%92" aria-label="åŠ¨æ€è§„åˆ’">åŠ¨æ€è§„åˆ’</a><ul>
                        
                <li>
                    <a href="#%e8%83%8c%e5%8c%85-%e4%b9%9d%e8%ae%b2" aria-label="èƒŒåŒ… ä¹è®²">èƒŒåŒ… ä¹è®²</a><ul>
                        
                <li>
                    <a href="#01%e8%83%8c%e5%8c%85" aria-label="01èƒŒåŒ…">01èƒŒåŒ…</a></li>
                <li>
                    <a href="#%e5%ae%8c%e5%85%a8%e8%83%8c%e5%8c%85" aria-label="å®Œå…¨èƒŒåŒ…">å®Œå…¨èƒŒåŒ…</a></li>
                <li>
                    <a href="#%e5%a4%9a%e9%87%8d%e8%83%8c%e5%8c%85" aria-label="å¤šé‡èƒŒåŒ…">å¤šé‡èƒŒåŒ…</a><ul>
                        
                <li>
                    <a href="#%e4%ba%8c%e8%bf%9b%e5%88%b6%e4%bc%98%e5%8c%96" aria-label="äºŒè¿›åˆ¶ä¼˜åŒ–">äºŒè¿›åˆ¶ä¼˜åŒ–</a></li>
                <li>
                    <a href="#%e5%8d%95%e8%b0%83%e9%98%9f%e5%88%97%e4%bc%98%e5%8c%96" aria-label="å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–">å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–</a></li></ul>
                </li>
                <li>
                    <a href="#%e5%88%86%e7%bb%84%e8%83%8c%e5%8c%85" aria-label="åˆ†ç»„èƒŒåŒ…">åˆ†ç»„èƒŒåŒ…</a></li>
                <li>
                    <a href="#%e6%b7%b7%e5%90%88%e8%83%8c%e5%8c%85" aria-label="æ··åˆèƒŒåŒ…">æ··åˆèƒŒåŒ…</a></li>
                <li>
                    <a href="#%e4%ba%8c%e7%bb%b4%e8%b4%b9%e7%94%a8%e7%9a%84%e8%83%8c%e5%8c%85%e9%97%ae%e9%a2%98" aria-label="äºŒç»´è´¹ç”¨çš„èƒŒåŒ…é—®é¢˜">äºŒç»´è´¹ç”¨çš„èƒŒåŒ…é—®é¢˜</a></li></ul>
                </li>
                <li>
                    <a href="#%e7%ba%bf%e6%80%a7dp" aria-label="çº¿æ€§dp">çº¿æ€§dp</a><ul>
                        <ul>
                        
                <li>
                    <a href="#%e6%95%b0%e5%ad%97%e4%b8%89%e8%a7%92%e5%bd%a2" aria-label="æ•°å­—ä¸‰è§’å½¢">æ•°å­—ä¸‰è§’å½¢</a></li>
                <li>
                    <a href="#lis" aria-label="LIS">LIS</a></li>
                <li>
                    <a href="#lcs" aria-label="LCS">LCS</a></li></ul>
                    
                <li>
                    <a href="#%e5%8c%ba%e9%97%b4dp" aria-label="åŒºé—´dp">åŒºé—´dp</a><ul>
                        
                <li>
                    <a href="#%e7%9f%b3%e5%ad%90%e5%90%88%e5%b9%b6" aria-label="çŸ³å­åˆå¹¶">çŸ³å­åˆå¹¶</a></li></ul>
                </li></ul>
                </li>
                <li>
                    <a href="#%e6%95%b0%e4%bd%8d%e7%bb%9f%e8%ae%a1dp" aria-label="æ•°ä½ç»Ÿè®¡dp">æ•°ä½ç»Ÿè®¡dp</a></li>
                <li>
                    <a href="#%e7%8a%b6%e6%80%81%e5%8e%8b%e7%bc%a9-dp" aria-label="çŠ¶æ€å‹ç¼© dp">çŠ¶æ€å‹ç¼© dp</a></li>
                <li>
                    <a href="#%e6%a0%91%e5%bd%a2dp" aria-label="æ ‘å½¢dp">æ ‘å½¢dp</a><ul>
                        
                <li>
                    <a href="#%e8%ae%b0%e5%bf%86%e5%8c%96" aria-label="è®°å¿†åŒ–">è®°å¿†åŒ–</a></li></ul>
                </li></ul>
                </li>
                <li>
                    <a href="#%e4%b9%a0%e9%a2%98%e8%af%be" aria-label="ä¹ é¢˜è¯¾">ä¹ é¢˜è¯¾</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h1 id="acwingç®—æ³•å­¦ä¹ ">acwingç®—æ³•å­¦ä¹ <a hidden class="anchor" aria-hidden="true" href="#acwingç®—æ³•å­¦ä¹ ">#</a></h1>
<p>[TOC]</p>
<h2 id="ç¬¬ä¸€ç« ">ç¬¬ä¸€ç« <a hidden class="anchor" aria-hidden="true" href="#ç¬¬ä¸€ç« ">#</a></h2>
<p>è¯¾ä¸Šï¼šå­¦æ€æƒ³</p>
<p>è¯¾ä¸‹ï¼šèƒŒä»£ç </p>
<p>é¢˜ç›®ï¼Œä¸€é“é¢˜å†™å¥½å‡ é</p>
<p>ç†è§£æ²¡æœ‰ä»»ä½•æ„ä¹‰ï¼Œä½“åŠ›æ´»+è„‘åŠ›æ´»</p>
<p><strong>è®°å¿†åŠ› æ¯…åŠ›/è‡ªåˆ¶åŠ›</strong></p>
<p>æ²‰ä¸‹å¿ƒèƒŒä¸œè¥¿</p>
<h3 id="å¿«é€Ÿæ’åºç®—æ³•æ¨¡æ¿--æ¨¡æ¿é¢˜-acwing-785-å¿«é€Ÿæ’åº">å¿«é€Ÿæ’åºç®—æ³•æ¨¡æ¿ â€”â€” æ¨¡æ¿é¢˜ AcWing 785. å¿«é€Ÿæ’åº<a hidden class="anchor" aria-hidden="true" href="#å¿«é€Ÿæ’åºç®—æ³•æ¨¡æ¿--æ¨¡æ¿é¢˜-acwing-785-å¿«é€Ÿæ’åº">#</a></h3>
<p><strong>åˆ†æ²»</strong></p>
<p>1ã€ç¡®å®šåˆ†ç•Œç‚¹ï¼Œlã€rã€ï¼ˆl+r)/2 éšæœº</p>
<p>2ã€è°ƒæ•´åŒºé—´ï¼Œåˆ†ä¸ºä¸¤è¾¹ï¼Œå·¦è¾¹å°äºç­‰äºx,å³è¾¹å¤§äºç­‰äºx</p>
<p>3ã€é€’å½’å¤„ç†å·¦å³ä¸¤æ®µ</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">quick_sort</span>(<span style="color:#66d9ef">int</span> q[], <span style="color:#66d9ef">int</span> l, <span style="color:#66d9ef">int</span> r)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (l <span style="color:#f92672">&gt;=</span> r) <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> l <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>, j <span style="color:#f92672">=</span> r <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>, x <span style="color:#f92672">=</span> q[l <span style="color:#f92672">+</span> r <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">1</span>];
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> (i <span style="color:#f92672">&lt;</span> j)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">do</span> i <span style="color:#f92672">++</span> ; <span style="color:#66d9ef">while</span> (q[i] <span style="color:#f92672">&lt;</span> x);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">do</span> j <span style="color:#f92672">--</span> ; <span style="color:#66d9ef">while</span> (q[j] <span style="color:#f92672">&gt;</span> x);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (i <span style="color:#f92672">&lt;</span> j) swap(q[i], q[j]); 
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    quick_sort(q, l, j), quick_sort(q, j <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>, r);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#f92672">-</span>std<span style="color:#f92672">=</span>c<span style="color:#f92672">++</span><span style="color:#ae81ff">11</span>
</span></span></code></pre></div><h3 id="å½’å¹¶æ’åºç®—æ³•æ¨¡æ¿--æ¨¡æ¿é¢˜-acwing-787-å½’å¹¶æ’åº">å½’å¹¶æ’åºç®—æ³•æ¨¡æ¿ â€”â€” æ¨¡æ¿é¢˜ AcWing 787. å½’å¹¶æ’åº<a hidden class="anchor" aria-hidden="true" href="#å½’å¹¶æ’åºç®—æ³•æ¨¡æ¿--æ¨¡æ¿é¢˜-acwing-787-å½’å¹¶æ’åº">#</a></h3>
<p>æ’åºç¨³å®šï¼šåºåˆ—ä¸­ç›¸åŒçš„å€¼æ’åºåçš„ç›¸å¯¹ä½ç½®æ˜¯å¦å‘ç”Ÿæ”¹å˜</p>
<p>æ—¶é—´å¤æ‚åº¦æœ‰ ï¼ˆnlogn)</p>
<p>1ï¼‰ç¡®å®šåˆ†ç•Œç‚¹mid</p>
<p>2ï¼‰é€’å½’æ’åºä¸¤è¾¹</p>
<p>2ï¼‰å½’å¹¶ï¼Œåˆå¹¶ä¸ºä¸€ä¸ªæœ‰åºæ•°ç»„</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">merge_sort</span>(<span style="color:#66d9ef">int</span> q[], <span style="color:#66d9ef">int</span> l, <span style="color:#66d9ef">int</span> r)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (l <span style="color:#f92672">&gt;=</span> r) <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> mid <span style="color:#f92672">=</span> l <span style="color:#f92672">+</span> r <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>    merge_sort(q, l, mid); merge_sort(q, mid <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>, r);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> k <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, i <span style="color:#f92672">=</span> l, j <span style="color:#f92672">=</span> mid <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> (i <span style="color:#f92672">&lt;=</span> mid <span style="color:#f92672">&amp;&amp;</span> j <span style="color:#f92672">&lt;=</span> r)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (q[i] <span style="color:#f92672">&lt;</span> q[j]) tmp[k <span style="color:#f92672">++</span> ] <span style="color:#f92672">=</span> q[i <span style="color:#f92672">++</span> ];
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span> tmp[k <span style="color:#f92672">++</span> ] <span style="color:#f92672">=</span> q[j <span style="color:#f92672">++</span> ];
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> (i <span style="color:#f92672">&lt;=</span> mid) tmp[k <span style="color:#f92672">++</span> ] <span style="color:#f92672">=</span> q[i <span style="color:#f92672">++</span> ];
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> (j <span style="color:#f92672">&lt;=</span> r) tmp[k <span style="color:#f92672">++</span> ] <span style="color:#f92672">=</span> q[j <span style="color:#f92672">++</span> ];
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (i <span style="color:#f92672">=</span> l, j <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;=</span> r; i <span style="color:#f92672">++</span>, j <span style="color:#f92672">++</span> ) q[i] <span style="color:#f92672">=</span> tmp[j];
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="æ•´æ•°äºŒåˆ†ç®—æ³•æ¨¡æ¿--æ¨¡æ¿é¢˜-acwing-789-æ•°çš„èŒƒå›´">æ•´æ•°äºŒåˆ†ç®—æ³•æ¨¡æ¿ â€”â€” æ¨¡æ¿é¢˜ AcWing 789. æ•°çš„èŒƒå›´<a hidden class="anchor" aria-hidden="true" href="#æ•´æ•°äºŒåˆ†ç®—æ³•æ¨¡æ¿--æ¨¡æ¿é¢˜-acwing-789-æ•°çš„èŒƒå›´">#</a></h3>
<p>è¾¹ç•Œé—®é¢˜</p>
<p>æœ¬è´¨ï¼šåŒºé—´å†…ä¸€åŠæ»¡è¶³ä¸€åŠä¸æ»¡è¶³</p>
<p>l=midæ—¶åŠ ä¸€</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#66d9ef">bool</span> <span style="color:#a6e22e">check</span>(<span style="color:#66d9ef">int</span> x) {<span style="color:#75715e">/* ... */</span>} <span style="color:#75715e">// æ£€æŸ¥xæ˜¯å¦æ»¡è¶³æŸç§æ€§è´¨
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// åŒºé—´[l, r]è¢«åˆ’åˆ†æˆ[l, mid]å’Œ[mid + 1, r]æ—¶ä½¿ç”¨ï¼š
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">bsearch_1</span>(<span style="color:#66d9ef">int</span> l, <span style="color:#66d9ef">int</span> r)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> (l <span style="color:#f92672">&lt;</span> r)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> mid <span style="color:#f92672">=</span> l <span style="color:#f92672">+</span> r <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (check(mid)) r <span style="color:#f92672">=</span> mid;    <span style="color:#75715e">// check()åˆ¤æ–­midæ˜¯å¦æ»¡è¶³æ€§è´¨
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#66d9ef">else</span> l <span style="color:#f92672">=</span> mid <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> l;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// åŒºé—´[l, r]è¢«åˆ’åˆ†æˆ[l, mid - 1]å’Œ[mid, r]æ—¶ä½¿ç”¨ï¼š
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">bsearch_2</span>(<span style="color:#66d9ef">int</span> l, <span style="color:#66d9ef">int</span> r)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> (l <span style="color:#f92672">&lt;</span> r)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> mid <span style="color:#f92672">=</span> l <span style="color:#f92672">+</span> r <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (check(mid)) l <span style="color:#f92672">=</span> mid;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span> r <span style="color:#f92672">=</span> mid <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> l;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="æµ®ç‚¹æ•°äºŒåˆ†ç®—æ³•æ¨¡æ¿--æ¨¡æ¿é¢˜-acwing-790-æ•°çš„ä¸‰æ¬¡æ–¹æ ¹">æµ®ç‚¹æ•°äºŒåˆ†ç®—æ³•æ¨¡æ¿ â€”â€” æ¨¡æ¿é¢˜ AcWing 790. æ•°çš„ä¸‰æ¬¡æ–¹æ ¹<a hidden class="anchor" aria-hidden="true" href="#æµ®ç‚¹æ•°äºŒåˆ†ç®—æ³•æ¨¡æ¿--æ¨¡æ¿é¢˜-acwing-790-æ•°çš„ä¸‰æ¬¡æ–¹æ ¹">#</a></h3>
<p>æµ®ç‚¹æ•°äºŒåˆ†ï¼Œæ¯”è¾ƒå¯¹åº”æ•´æ•°äºŒåˆ†</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#66d9ef">bool</span> <span style="color:#a6e22e">check</span>(<span style="color:#66d9ef">double</span> x) {<span style="color:#75715e">/* ... */</span>} <span style="color:#75715e">// æ£€æŸ¥xæ˜¯å¦æ»¡è¶³æŸç§æ€§è´¨
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">double</span> <span style="color:#a6e22e">bsearch_3</span>(<span style="color:#66d9ef">double</span> l, <span style="color:#66d9ef">double</span> r)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">double</span> eps <span style="color:#f92672">=</span> <span style="color:#ae81ff">1e-6</span>;   <span style="color:#75715e">// eps è¡¨ç¤ºç²¾åº¦ï¼Œå–å†³äºé¢˜ç›®å¯¹ç²¾åº¦çš„è¦æ±‚
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">while</span> (r <span style="color:#f92672">-</span> l <span style="color:#f92672">&gt;</span> eps)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">double</span> mid <span style="color:#f92672">=</span> (l <span style="color:#f92672">+</span> r) <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (check(mid)) r <span style="color:#f92672">=</span> mid;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span> l <span style="color:#f92672">=</span> mid;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> l;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="é«˜ç²¾åº¦åŠ æ³•--æ¨¡æ¿é¢˜-acwing-791-é«˜ç²¾åº¦åŠ æ³•">é«˜ç²¾åº¦åŠ æ³• â€”â€” æ¨¡æ¿é¢˜ AcWing 791. é«˜ç²¾åº¦åŠ æ³•<a hidden class="anchor" aria-hidden="true" href="#é«˜ç²¾åº¦åŠ æ³•--æ¨¡æ¿é¢˜-acwing-791-é«˜ç²¾åº¦åŠ æ³•">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#75715e">// C = A + B, A &gt;= 0, B &gt;= 0
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>vector<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span> add(vector<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span> <span style="color:#f92672">&amp;</span>A, vector<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span> <span style="color:#f92672">&amp;</span>B)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (A.size() <span style="color:#f92672">&lt;</span> B.size()) <span style="color:#66d9ef">return</span> add(B, A);
</span></span><span style="display:flex;"><span>    vector<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span> C;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> t <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> A.size(); i <span style="color:#f92672">++</span> )
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        t <span style="color:#f92672">+=</span> A[i];
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (i <span style="color:#f92672">&lt;</span> B.size()) t <span style="color:#f92672">+=</span> B[i];
</span></span><span style="display:flex;"><span>        C.push_back(t <span style="color:#f92672">%</span> <span style="color:#ae81ff">10</span>);
</span></span><span style="display:flex;"><span>        t <span style="color:#f92672">/=</span> <span style="color:#ae81ff">10</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (t) C.push_back(t);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> C;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="é«˜ç²¾åº¦å‡æ³•--æ¨¡æ¿é¢˜-acwing-792-é«˜ç²¾åº¦å‡æ³•">é«˜ç²¾åº¦å‡æ³• â€”â€” æ¨¡æ¿é¢˜ AcWing 792. é«˜ç²¾åº¦å‡æ³•<a hidden class="anchor" aria-hidden="true" href="#é«˜ç²¾åº¦å‡æ³•--æ¨¡æ¿é¢˜-acwing-792-é«˜ç²¾åº¦å‡æ³•">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#75715e">// C = A - B, æ»¡è¶³A &gt;= B, A &gt;= 0, B &gt;= 0
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>vector<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span> sub(vector<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span> <span style="color:#f92672">&amp;</span>A, vector<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span> <span style="color:#f92672">&amp;</span>B)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    vector<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span> C;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, t <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> A.size(); i <span style="color:#f92672">++</span> )
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        t <span style="color:#f92672">=</span> A[i] <span style="color:#f92672">-</span> t;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (i <span style="color:#f92672">&lt;</span> B.size()) t <span style="color:#f92672">-=</span> B[i];
</span></span><span style="display:flex;"><span>        C.push_back((t <span style="color:#f92672">+</span> <span style="color:#ae81ff">10</span>) <span style="color:#f92672">%</span> <span style="color:#ae81ff">10</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (t <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0</span>) t <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span> t <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> (C.size() <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">&amp;&amp;</span> C.back() <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>) C.pop_back();
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> C;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="é«˜ç²¾åº¦ä¹˜ä½ç²¾åº¦--æ¨¡æ¿é¢˜-acwing-793-é«˜ç²¾åº¦ä¹˜æ³•">é«˜ç²¾åº¦ä¹˜ä½ç²¾åº¦ â€”â€” æ¨¡æ¿é¢˜ AcWing 793. é«˜ç²¾åº¦ä¹˜æ³•<a hidden class="anchor" aria-hidden="true" href="#é«˜ç²¾åº¦ä¹˜ä½ç²¾åº¦--æ¨¡æ¿é¢˜-acwing-793-é«˜ç²¾åº¦ä¹˜æ³•">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#75715e">// C = A * b, A &gt;= 0, b &gt; 0
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>vector<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span> mul(vector<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span> <span style="color:#f92672">&amp;</span>A, <span style="color:#66d9ef">int</span> b)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    vector<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span> C;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> t <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> A.size() <span style="color:#f92672">||</span> t; i <span style="color:#f92672">++</span> )
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (i <span style="color:#f92672">&lt;</span> A.size()) t <span style="color:#f92672">+=</span> A[i] <span style="color:#f92672">*</span> b;
</span></span><span style="display:flex;"><span>        C.push_back(t <span style="color:#f92672">%</span> <span style="color:#ae81ff">10</span>);
</span></span><span style="display:flex;"><span>        t <span style="color:#f92672">/=</span> <span style="color:#ae81ff">10</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> C;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="é«˜ç²¾åº¦é™¤ä»¥ä½ç²¾åº¦--æ¨¡æ¿é¢˜-acwing-794-é«˜ç²¾åº¦é™¤æ³•">é«˜ç²¾åº¦é™¤ä»¥ä½ç²¾åº¦ â€”â€” æ¨¡æ¿é¢˜ AcWing 794. é«˜ç²¾åº¦é™¤æ³•<a hidden class="anchor" aria-hidden="true" href="#é«˜ç²¾åº¦é™¤ä»¥ä½ç²¾åº¦--æ¨¡æ¿é¢˜-acwing-794-é«˜ç²¾åº¦é™¤æ³•">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#75715e">// A / b = C ... r, A &gt;= 0, b &gt; 0
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>vector<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span> div(vector<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span> <span style="color:#f92672">&amp;</span>A, <span style="color:#66d9ef">int</span> b, <span style="color:#66d9ef">int</span> <span style="color:#f92672">&amp;</span>r)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    vector<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span> C;
</span></span><span style="display:flex;"><span>    r <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> A.size() <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>; i <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">--</span> )
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        r <span style="color:#f92672">=</span> r <span style="color:#f92672">*</span> <span style="color:#ae81ff">10</span> <span style="color:#f92672">+</span> A[i];
</span></span><span style="display:flex;"><span>        C.push_back(r <span style="color:#f92672">/</span> b);
</span></span><span style="display:flex;"><span>        r <span style="color:#f92672">%=</span> b;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    reverse(C.begin(), C.end());
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> (C.size() <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">&amp;&amp;</span> C.back() <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>) C.pop_back();
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> C;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="ä¸€ç»´å‰ç¼€å’Œ--æ¨¡æ¿é¢˜-acwing-795-å‰ç¼€å’Œ">ä¸€ç»´å‰ç¼€å’Œ â€”â€” æ¨¡æ¿é¢˜ AcWing 795. å‰ç¼€å’Œ<a hidden class="anchor" aria-hidden="true" href="#ä¸€ç»´å‰ç¼€å’Œ--æ¨¡æ¿é¢˜-acwing-795-å‰ç¼€å’Œ">#</a></h3>
<p>å¿«é€Ÿæ±‚åŒºé—´å’Œ</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span>S[i] <span style="color:#f92672">=</span> a[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">+</span> a[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">+</span> ... a[i]
</span></span><span style="display:flex;"><span>a[l] <span style="color:#f92672">+</span> ... <span style="color:#f92672">+</span> a[r] <span style="color:#f92672">=</span> S[r] <span style="color:#f92672">-</span> S[l <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>] <span style="color:#960050;background-color:#1e0010">ä»</span><span style="color:#ae81ff">1</span><span style="color:#960050;background-color:#1e0010">å¼€å§‹ï¼Œä¾¿äºå¤„ç†è¾¹ç•Œ</span>
</span></span></code></pre></div><h3 id="äºŒç»´å‰ç¼€å’Œ--æ¨¡æ¿é¢˜-acwing-796-å­çŸ©é˜µçš„å’Œ">äºŒç»´å‰ç¼€å’Œ â€”â€” æ¨¡æ¿é¢˜ AcWing 796. å­çŸ©é˜µçš„å’Œ<a hidden class="anchor" aria-hidden="true" href="#äºŒç»´å‰ç¼€å’Œ--æ¨¡æ¿é¢˜-acwing-796-å­çŸ©é˜µçš„å’Œ">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span>S[i, j] <span style="color:#f92672">=</span> <span style="color:#960050;background-color:#1e0010">ç¬¬</span>iè¡Œjåˆ—æ ¼å­å·¦ä¸Šéƒ¨åˆ†æ‰€æœ‰å…ƒç´ çš„å’Œ
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">ä»¥</span>(x1, y1)<span style="color:#960050;background-color:#1e0010">ä¸ºå·¦ä¸Šè§’ï¼Œ</span>(x2, y2)<span style="color:#960050;background-color:#1e0010">ä¸ºå³ä¸‹è§’çš„å­çŸ©é˜µçš„å’Œä¸ºï¼š</span>
</span></span><span style="display:flex;"><span>S[x2, y2] <span style="color:#f92672">-</span> S[x1 <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>, y2] <span style="color:#f92672">-</span> S[x2, y1 <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>] <span style="color:#f92672">+</span> S[x1 <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>, y1 <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>]
</span></span></code></pre></div><h3 id="ä¸€ç»´å·®åˆ†--æ¨¡æ¿é¢˜-acwing-797-å·®åˆ†">ä¸€ç»´å·®åˆ† â€”â€” æ¨¡æ¿é¢˜ AcWing 797. å·®åˆ†<a hidden class="anchor" aria-hidden="true" href="#ä¸€ç»´å·®åˆ†--æ¨¡æ¿é¢˜-acwing-797-å·®åˆ†">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">ç»™åŒºé—´</span>[l, r]<span style="color:#960050;background-color:#1e0010">ä¸­çš„æ¯ä¸ªæ•°åŠ ä¸Š</span>c<span style="color:#960050;background-color:#1e0010">ï¼š</span>
</span></span><span style="display:flex;"><span>B[l] <span style="color:#f92672">+=</span> c, 
</span></span><span style="display:flex;"><span>B[r <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>] <span style="color:#f92672">-=</span> c
</span></span></code></pre></div><h3 id="äºŒç»´å·®åˆ†--æ¨¡æ¿é¢˜-acwing-798-å·®åˆ†çŸ©é˜µäºŒç»´å·®åˆ†">äºŒç»´å·®åˆ† â€”â€” æ¨¡æ¿é¢˜ AcWing 798. å·®åˆ†çŸ©é˜µ/äºŒç»´å·®åˆ†<a hidden class="anchor" aria-hidden="true" href="#äºŒç»´å·®åˆ†--æ¨¡æ¿é¢˜-acwing-798-å·®åˆ†çŸ©é˜µäºŒç»´å·®åˆ†">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">ç»™ä»¥</span>(x1, y1)<span style="color:#960050;background-color:#1e0010">ä¸ºå·¦ä¸Šè§’ï¼Œ</span>(x2, y2)<span style="color:#960050;background-color:#1e0010">ä¸ºå³ä¸‹è§’çš„å­çŸ©é˜µä¸­çš„æ‰€æœ‰å…ƒç´ åŠ ä¸Š</span>c<span style="color:#960050;background-color:#1e0010">ï¼š</span>
</span></span><span style="display:flex;"><span>S[x1, y1] <span style="color:#f92672">+=</span> c, 
</span></span><span style="display:flex;"><span>S[x2 <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>, y1] <span style="color:#f92672">-=</span> c, 
</span></span><span style="display:flex;"><span>S[x1, y2 <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>] <span style="color:#f92672">-=</span> c, 
</span></span><span style="display:flex;"><span>S[x2 <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>, y2 <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>] <span style="color:#f92672">+=</span> c
</span></span></code></pre></div><h3 id="åŒæŒ‡é’ˆç®—æ³•--æ¨¡æ¿é¢˜-acwing-799-æœ€é•¿è¿ç»­ä¸é‡å¤å­åºåˆ—-acwing-800-æ•°ç»„å…ƒç´ çš„ç›®æ ‡å’Œ-__æ»‘åŠ¨çª—å£">åŒæŒ‡é’ˆç®—æ³• â€”â€” æ¨¡æ¿é¢˜ AcWIng 799. æœ€é•¿è¿ç»­ä¸é‡å¤å­åºåˆ—, AcWing 800. æ•°ç»„å…ƒç´ çš„ç›®æ ‡å’Œ __æ»‘åŠ¨çª—å£ï¼Ÿ<a hidden class="anchor" aria-hidden="true" href="#åŒæŒ‡é’ˆç®—æ³•--æ¨¡æ¿é¢˜-acwing-799-æœ€é•¿è¿ç»­ä¸é‡å¤å­åºåˆ—-acwing-800-æ•°ç»„å…ƒç´ çš„ç›®æ ‡å’Œ-__æ»‘åŠ¨çª—å£">#</a></h3>
<p>æ ¸å¿ƒï¼šæŠŠO(n^2)ç®—æ³•ä¼˜åŒ–ä¸ºO(n)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, j <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> n; i <span style="color:#f92672">++</span> )
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> (j <span style="color:#f92672">&lt;</span> i <span style="color:#f92672">&amp;&amp;</span> check(j, i)) j <span style="color:#f92672">++</span> ;
</span></span><span style="display:flex;"><span><span style="color:#75715e">// å…·ä½“é—®é¢˜çš„é€»è¾‘
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">å¸¸è§é—®é¢˜åˆ†ç±»ï¼š</span> 
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">1</span>) <span style="color:#960050;background-color:#1e0010">å¯¹äºä¸€ä¸ªåºåˆ—ï¼Œç”¨ä¸¤ä¸ªæŒ‡é’ˆç»´æŠ¤ä¸€æ®µåŒºé—´</span>
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">2</span>) <span style="color:#960050;background-color:#1e0010">å¯¹äºä¸¤ä¸ªåºåˆ—ï¼Œç»´æŠ¤æŸç§æ¬¡åºï¼Œæ¯”å¦‚å½’å¹¶æ’åºä¸­åˆå¹¶ä¸¤ä¸ªæœ‰åºåºåˆ—çš„æ“ä½œ</span>
</span></span></code></pre></div><h3 id="ä½è¿ç®—--æ¨¡æ¿é¢˜-acwing-801-äºŒè¿›åˆ¶ä¸­1çš„ä¸ªæ•°">ä½è¿ç®— â€”â€” æ¨¡æ¿é¢˜ AcWing 801. äºŒè¿›åˆ¶ä¸­1çš„ä¸ªæ•°<a hidden class="anchor" aria-hidden="true" href="#ä½è¿ç®—--æ¨¡æ¿é¢˜-acwing-801-äºŒè¿›åˆ¶ä¸­1çš„ä¸ªæ•°">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">åŸç ï¼Œåç ï¼Œè¡¥ç </span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">æ±‚</span>näºŒè¿›åˆ¶è¡¨ç¤ºä¸­ç¬¬kä½æ•°å­—: n <span style="color:#f92672">&gt;&gt;</span> k <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">1</span> 
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">è¿”å›</span>nçš„æœ€åä¸€ä½1<span style="color:#960050;background-color:#1e0010">ï¼š</span>lowbit(n) <span style="color:#f92672">=</span> n <span style="color:#f92672">&amp;</span> <span style="color:#f92672">-</span>n <span style="color:#960050;background-color:#1e0010">æ ‘çŠ¶æ•°ç»„åŸºæœ¬æ“ä½œ</span>
</span></span></code></pre></div><h3 id="æ•´æ•°ç¦»æ•£åŒ–--æ¨¡æ¿é¢˜-acwing-802-åŒºé—´å’Œ">æ•´æ•°ç¦»æ•£åŒ– â€”â€” æ¨¡æ¿é¢˜ AcWing 802. åŒºé—´å’Œ<a hidden class="anchor" aria-hidden="true" href="#æ•´æ•°ç¦»æ•£åŒ–--æ¨¡æ¿é¢˜-acwing-802-åŒºé—´å’Œ">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span>vector<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span> alls; <span style="color:#75715e">// å­˜å‚¨æ‰€æœ‰å¾…ç¦»æ•£åŒ–çš„å€¼
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>sort(alls.begin(), alls.end()); <span style="color:#75715e">// å°†æ‰€æœ‰å€¼æ’åº
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>alls.erase(unique(alls.begin(), alls.end())<span style="color:#960050;background-color:#1e0010">è¿”å›å»é‡åæ•°ç»„æœ«å°¾ç«¯ç‚¹</span>, alls.end());   <span style="color:#75715e">// å»æ‰é‡å¤å…ƒç´ 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// äºŒåˆ†æ±‚å‡ºxå¯¹åº”çš„ç¦»æ•£åŒ–çš„å€¼
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">find</span>(<span style="color:#66d9ef">int</span> x) <span style="color:#75715e">// æ‰¾åˆ°ç¬¬ä¸€ä¸ªå¤§äºç­‰äºxçš„ä½ç½®
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> l <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, r <span style="color:#f92672">=</span> alls.size() <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> (l <span style="color:#f92672">&lt;</span> r)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> mid <span style="color:#f92672">=</span> l <span style="color:#f92672">+</span> r <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (alls[mid] <span style="color:#f92672">&gt;=</span> x) r <span style="color:#f92672">=</span> mid;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span> l <span style="color:#f92672">=</span> mid <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> r <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>; <span style="color:#75715e">// æ˜ å°„åˆ°1, 2, ...n
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span></code></pre></div><h3 id="åŒºé—´åˆå¹¶--æ¨¡æ¿é¢˜-acwing-803-åŒºé—´åˆå¹¶">åŒºé—´åˆå¹¶ â€”â€” æ¨¡æ¿é¢˜ AcWing 803. åŒºé—´åˆå¹¶<a hidden class="anchor" aria-hidden="true" href="#åŒºé—´åˆå¹¶--æ¨¡æ¿é¢˜-acwing-803-åŒºé—´åˆå¹¶">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#75715e">// å°†æ‰€æœ‰å­˜åœ¨äº¤é›†çš„åŒºé—´åˆå¹¶ è´ªå¿ƒ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">merge</span>(vector<span style="color:#f92672">&lt;</span>PII<span style="color:#f92672">&gt;</span> <span style="color:#f92672">&amp;</span>segs)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    vector<span style="color:#f92672">&lt;</span>PII<span style="color:#f92672">&gt;</span> res;
</span></span><span style="display:flex;"><span>    sort(segs.begin(), segs.end()); <span style="color:#75715e">//åŒºé—´å·¦ç«¯ç‚¹æ’åº
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">int</span> st <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">2e9</span>, ed <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">2e9</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">auto</span> seg : segs)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (ed <span style="color:#f92672">&lt;</span> seg.first)
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (st <span style="color:#f92672">!=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">2e9</span>) res.push_back({st, ed});
</span></span><span style="display:flex;"><span>            st <span style="color:#f92672">=</span> seg.first, ed <span style="color:#f92672">=</span> seg.second;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span> ed <span style="color:#f92672">=</span> max(ed, seg.second);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (st <span style="color:#f92672">!=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">2e9</span>) res.push_back({st, ed});
</span></span><span style="display:flex;"><span>    segs <span style="color:#f92672">=</span> res;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>ä½œè€…ï¼šyxc
é“¾æ¥ï¼šhttps://www.acwing.com/blog/content/277/
æ¥æºï¼šAcWing
è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p>
<h2 id="ç¬¬äºŒç« ">ç¬¬äºŒç« <a hidden class="anchor" aria-hidden="true" href="#ç¬¬äºŒç« ">#</a></h2>
<p>æ•°æ®ç»“æ„ï¼Œä»¥æ•°ç»„æ¨¡æ‹Ÿçš„å½¢å¼</p>
<p>æŒ‡é’ˆ+ç»“æ„ä½“ ï¼š é¢è¯•é¢˜</p>
<h3 id="å•é“¾è¡¨--æ¨¡æ¿é¢˜-acwing-826-å•é“¾è¡¨">å•é“¾è¡¨ â€”â€” æ¨¡æ¿é¢˜ AcWing 826. å•é“¾è¡¨<a hidden class="anchor" aria-hidden="true" href="#å•é“¾è¡¨--æ¨¡æ¿é¢˜-acwing-826-å•é“¾è¡¨">#</a></h3>
<p>é‚»æ¥è¡¨-å­˜å‚¨æ ‘å’Œå›¾  é™æ€é“¾è¡¨</p>
<p>ä¸‹æ ‡ä»0å¼€å§‹</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#75715e">// headå­˜å‚¨é“¾è¡¨å¤´ï¼Œe[]å­˜å‚¨èŠ‚ç‚¹çš„å€¼ï¼Œne[]å­˜å‚¨èŠ‚ç‚¹çš„nextæŒ‡é’ˆï¼Œidxè¡¨ç¤ºå½“å‰ç”¨åˆ°äº†å“ªä¸ªèŠ‚ç‚¹
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> head, e[N], ne[N], idx;
</span></span><span style="display:flex;"><span><span style="color:#75715e">// åˆå§‹åŒ–
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">init</span>()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    head <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>    idx <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#75715e">// åœ¨é“¾è¡¨å¤´æ’å…¥ä¸€ä¸ªæ•°a
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">insert</span>(<span style="color:#66d9ef">int</span> a)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    e[idx] <span style="color:#f92672">=</span> a, ne[idx] <span style="color:#f92672">=</span> head, head <span style="color:#f92672">=</span> idx <span style="color:#f92672">++</span> ;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#75715e">// æ’å…¥ä¸‹æ ‡kåé¢
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">add</span>(<span style="color:#66d9ef">int</span> k,<span style="color:#66d9ef">int</span> x)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    e[idx]<span style="color:#f92672">=</span> x, ne[idx] <span style="color:#f92672">=</span> ne[k], ne[k] <span style="color:#f92672">=</span> idx<span style="color:#f92672">++</span> ;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#75715e">// å°†å¤´ç»“ç‚¹åˆ é™¤ï¼Œéœ€è¦ä¿è¯å¤´ç»“ç‚¹å­˜åœ¨
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">remove</span>()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    head <span style="color:#f92672">=</span> ne[head];
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#75715e">// å°†kåé¢çš„ç‚¹åˆ æ‰
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">remove</span>(<span style="color:#66d9ef">int</span> k)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    ne[k] <span style="color:#f92672">=</span> ne[ne[k]];
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="åŒé“¾è¡¨--æ¨¡æ¿é¢˜-acwing-827-åŒé“¾è¡¨">åŒé“¾è¡¨ â€”â€” æ¨¡æ¿é¢˜ AcWing 827. åŒé“¾è¡¨<a hidden class="anchor" aria-hidden="true" href="#åŒé“¾è¡¨--æ¨¡æ¿é¢˜-acwing-827-åŒé“¾è¡¨">#</a></h3>
<p>ä¼˜åŒ–æŸäº›é—®é¢˜</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#75715e">// e[]è¡¨ç¤ºèŠ‚ç‚¹çš„å€¼ï¼Œl[]è¡¨ç¤ºèŠ‚ç‚¹çš„å·¦æŒ‡é’ˆï¼Œr[]è¡¨ç¤ºèŠ‚ç‚¹çš„å³æŒ‡é’ˆï¼Œidxè¡¨ç¤ºå½“å‰ç”¨åˆ°äº†å“ªä¸ªèŠ‚ç‚¹
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> e[N], l[N], r[N], idx;
</span></span><span style="display:flex;"><span><span style="color:#75715e">// åˆå§‹åŒ–
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">init</span>()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">//0æ˜¯å·¦ç«¯ç‚¹ï¼Œ1æ˜¯å³ç«¯ç‚¹
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    r[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>, l[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>    idx <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#75715e">// åœ¨èŠ‚ç‚¹açš„å³è¾¹æ’å…¥ä¸€ä¸ªæ•°x
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">insert</span>(<span style="color:#66d9ef">int</span> a, <span style="color:#66d9ef">int</span> x)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    e[idx] <span style="color:#f92672">=</span> x;
</span></span><span style="display:flex;"><span>    l[idx] <span style="color:#f92672">=</span> a, r[idx] <span style="color:#f92672">=</span> r[a];
</span></span><span style="display:flex;"><span>    l[r[a]] <span style="color:#f92672">=</span> idx, r[a] <span style="color:#f92672">=</span> idx <span style="color:#f92672">++</span> ;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#75715e">// åˆ é™¤èŠ‚ç‚¹a
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">remove</span>(<span style="color:#66d9ef">int</span> a)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    l[r[a]] <span style="color:#f92672">=</span> l[a];
</span></span><span style="display:flex;"><span>    r[l[a]] <span style="color:#f92672">=</span> r[a];
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="æ ˆ--æ¨¡æ¿é¢˜-acwing-828-æ¨¡æ‹Ÿæ ˆ">æ ˆ â€”â€” æ¨¡æ¿é¢˜ AcWing 828. æ¨¡æ‹Ÿæ ˆ<a hidden class="anchor" aria-hidden="true" href="#æ ˆ--æ¨¡æ¿é¢˜-acwing-828-æ¨¡æ‹Ÿæ ˆ">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#75715e">// ttè¡¨ç¤ºæ ˆé¡¶
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> stk[N], tt <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span><span style="color:#75715e">// å‘æ ˆé¡¶æ’å…¥ä¸€ä¸ªæ•°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>stk[ <span style="color:#f92672">++</span> tt] <span style="color:#f92672">=</span> x;
</span></span><span style="display:flex;"><span><span style="color:#75715e">// ä»æ ˆé¡¶å¼¹å‡ºä¸€ä¸ªæ•°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>tt <span style="color:#f92672">--</span> ;
</span></span><span style="display:flex;"><span><span style="color:#75715e">// æ ˆé¡¶çš„å€¼
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>stk[tt];
</span></span><span style="display:flex;"><span><span style="color:#75715e">// åˆ¤æ–­æ ˆæ˜¯å¦ä¸ºç©º
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">if</span> (tt <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="é˜Ÿåˆ—--æ¨¡æ¿é¢˜-acwing-829-æ¨¡æ‹Ÿé˜Ÿåˆ—">é˜Ÿåˆ— â€”â€” æ¨¡æ¿é¢˜ AcWing 829. æ¨¡æ‹Ÿé˜Ÿåˆ—<a hidden class="anchor" aria-hidden="true" href="#é˜Ÿåˆ—--æ¨¡æ¿é¢˜-acwing-829-æ¨¡æ‹Ÿé˜Ÿåˆ—">#</a></h3>
<p>æ™®é€šé˜Ÿåˆ—</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#75715e">// hh è¡¨ç¤ºé˜Ÿå¤´ï¼Œttè¡¨ç¤ºé˜Ÿå°¾
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> q[N], hh <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, tt <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span><span style="color:#75715e">// å‘é˜Ÿå°¾æ’å…¥ä¸€ä¸ªæ•°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>q[ <span style="color:#f92672">++</span> tt] <span style="color:#f92672">=</span> x;
</span></span><span style="display:flex;"><span><span style="color:#75715e">// ä»é˜Ÿå¤´å¼¹å‡ºä¸€ä¸ªæ•°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>hh <span style="color:#f92672">++</span> ;
</span></span><span style="display:flex;"><span><span style="color:#75715e">// é˜Ÿå¤´çš„å€¼
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>q[hh];
</span></span><span style="display:flex;"><span><span style="color:#75715e">// åˆ¤æ–­é˜Ÿåˆ—æ˜¯å¦ä¸ºç©º
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">if</span> (hh <span style="color:#f92672">&lt;=</span> tt)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">//ä¸ç©º
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span></code></pre></div><p><strong>å¾ªç¯é˜Ÿåˆ—</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#75715e">// hh è¡¨ç¤ºé˜Ÿå¤´ï¼Œttè¡¨ç¤ºé˜Ÿå°¾çš„åä¸€ä¸ªä½ç½®
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> q[N], hh <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, tt <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span><span style="color:#75715e">// å‘é˜Ÿå°¾æ’å…¥ä¸€ä¸ªæ•°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>q[tt <span style="color:#f92672">++</span> ] <span style="color:#f92672">=</span> x;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (tt <span style="color:#f92672">==</span> N) tt <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span><span style="color:#75715e">// ä»é˜Ÿå¤´å¼¹å‡ºä¸€ä¸ªæ•°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>hh <span style="color:#f92672">++</span> ;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (hh <span style="color:#f92672">==</span> N) hh <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span><span style="color:#75715e">// é˜Ÿå¤´çš„å€¼
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>q[hh];
</span></span><span style="display:flex;"><span><span style="color:#75715e">// åˆ¤æ–­é˜Ÿåˆ—æ˜¯å¦ä¸ºç©º
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">if</span> (hh <span style="color:#f92672">!=</span> tt)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="å•è°ƒæ ˆ--æ¨¡æ¿é¢˜-acwing-830-å•è°ƒæ ˆ">å•è°ƒæ ˆ â€”â€” æ¨¡æ¿é¢˜ AcWing 830. å•è°ƒæ ˆ<a hidden class="anchor" aria-hidden="true" href="#å•è°ƒæ ˆ--æ¨¡æ¿é¢˜-acwing-830-å•è°ƒæ ˆ">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">å¸¸è§æ¨¡å‹ï¼šæ‰¾å‡ºæ¯ä¸ªæ•°å·¦è¾¹ç¦»å®ƒæœ€è¿‘çš„æ¯”å®ƒå¤§</span><span style="color:#f92672">/</span><span style="color:#960050;background-color:#1e0010">å°çš„æ•°</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> tt <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>; i <span style="color:#f92672">&lt;=</span> n; i <span style="color:#f92672">++</span> )
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> (tt <span style="color:#f92672">&amp;&amp;</span> check(stk[tt], i)) tt <span style="color:#f92672">--</span> ;
</span></span><span style="display:flex;"><span>    stk[ <span style="color:#f92672">++</span> tt] <span style="color:#f92672">=</span> i;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="å•è°ƒé˜Ÿåˆ—--æ¨¡æ¿é¢˜-acwing-154-æ»‘åŠ¨çª—å£">å•è°ƒé˜Ÿåˆ— â€”â€” æ¨¡æ¿é¢˜ AcWing 154. æ»‘åŠ¨çª—å£<a hidden class="anchor" aria-hidden="true" href="#å•è°ƒé˜Ÿåˆ—--æ¨¡æ¿é¢˜-acwing-154-æ»‘åŠ¨çª—å£">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">å¸¸è§æ¨¡å‹ï¼šæ‰¾å‡ºæ»‘åŠ¨çª—å£ä¸­çš„æœ€å¤§å€¼</span><span style="color:#f92672">/</span><span style="color:#960050;background-color:#1e0010">æœ€å°å€¼</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> hh <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, tt <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> n; i <span style="color:#f92672">++</span> )
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> (hh <span style="color:#f92672">&lt;=</span> tt <span style="color:#f92672">&amp;&amp;</span> check_out(q[hh])) hh <span style="color:#f92672">++</span> ;  <span style="color:#75715e">// åˆ¤æ–­é˜Ÿå¤´æ˜¯å¦æ»‘å‡ºçª—å£
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">while</span> (hh <span style="color:#f92672">&lt;=</span> tt <span style="color:#f92672">&amp;&amp;</span> check(q[tt], i)) tt <span style="color:#f92672">--</span> ;
</span></span><span style="display:flex;"><span>    q[ <span style="color:#f92672">++</span> tt] <span style="color:#f92672">=</span> i;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="kmp--æ¨¡æ¿é¢˜-acwing-831-kmpå­—ç¬¦ä¸²">KMP â€”â€” æ¨¡æ¿é¢˜ AcWing 831. KMPå­—ç¬¦ä¸²<a hidden class="anchor" aria-hidden="true" href="#kmp--æ¨¡æ¿é¢˜-acwing-831-kmpå­—ç¬¦ä¸²">#</a></h3>
<p>ç”¨<strong>æ¨¡æ¿</strong>ä¸²æ¥åŒ¹é…<strong>æ¨¡å¼</strong>ä¸²ï¼Œæ‰¾åˆ°æ¨¡å¼ä¸²</p>
<p>sçš„çœŸå‰ç¼€ä»¥åŠçœŸåç¼€æ˜¯æŒ‡ä¸ç­‰äºsçš„å‰ç¼€ä»¥åŠåç¼€ï¼Œå³è‡³å°‘æ˜¯<strong>s[1~n-2]<strong>æˆ–</strong>s[0~n-1]</strong></p>
<p>ne[i] : ä»¥<strong>i</strong>ç»“å°¾çš„ä¸²ä¸­ <strong>æœ€é•¿çœŸå‰ç¼€ä¸çœŸåç¼€ç›¸ç­‰çš„ä¸²</strong> çš„é•¿åº¦ï¼Œå¦‚æœæ²¡æœ‰åˆ™ä¸º0ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#75715e">//å‰ç¼€h
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>vector<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span> prefix_function(string s) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">int</span> n <span style="color:#f92672">=</span> (<span style="color:#66d9ef">int</span>)s.length();
</span></span><span style="display:flex;"><span>  vector<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span> pi(n);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>; i <span style="color:#f92672">&lt;</span> n; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> pi[i <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>];
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> (j <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">&amp;&amp;</span> s[i] <span style="color:#f92672">!=</span> s[j]) j <span style="color:#f92672">=</span> pi[j <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>];
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (s[i] <span style="color:#f92672">==</span> s[j]) j<span style="color:#f92672">++</span>;
</span></span><span style="display:flex;"><span>    pi[i] <span style="color:#f92672">=</span> j;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> pi;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><strong>å®é™…ä½¿ç”¨èŒƒä¾‹ï¼ˆä¸‹é¢è¿™ä¸ªä¾‹å­å­—ç¬¦ä¸²ä»1å¼€å§‹ï¼‰</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#75715e">// æ±‚Nextæ•°ç»„ï¼š
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// ne[i] å­˜å‚¨çœŸå‰ç¼€å’ŒçœŸåç¼€ç›¸ç­‰çš„é•¿åº¦ï¼Œæ‰€ä»¥è‡³å°‘ä»2å¼€å§‹ï¼š
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">//abcab,ä»bå¼€å§‹æ‰æœ‰çœŸå‰ç¼€
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// s[]æ˜¯æ¨¡å¼ä¸²ï¼Œp[]æ˜¯æ¨¡æ¿ä¸², næ˜¯sçš„é•¿åº¦ï¼Œmæ˜¯pçš„é•¿åº¦
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>, j <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;=</span> m; i <span style="color:#f92672">++</span> )
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> (j <span style="color:#f92672">&amp;&amp;</span> p[i] <span style="color:#f92672">!=</span> p[j <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>]) j <span style="color:#f92672">=</span> ne[j];
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (p[i] <span style="color:#f92672">==</span> p[j <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>]) j <span style="color:#f92672">++</span> ;
</span></span><span style="display:flex;"><span>    ne[i] <span style="color:#f92672">=</span> j;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// åŒ¹é…
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>, j <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;=</span> n; i <span style="color:#f92672">++</span> )
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> (j <span style="color:#f92672">&amp;&amp;</span> s[i] <span style="color:#f92672">!=</span> p[j <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>]) j <span style="color:#f92672">=</span> ne[j];
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (s[i] <span style="color:#f92672">==</span> p[j <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>]) j <span style="color:#f92672">++</span> ;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (j <span style="color:#f92672">==</span> m)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        j <span style="color:#f92672">=</span> ne[j];
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// åŒ¹é…æˆåŠŸåçš„é€»è¾‘
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="trieæ ‘--æ¨¡æ¿é¢˜-acwing-835-trieå­—ç¬¦ä¸²ç»Ÿè®¡">Trieæ ‘ â€”â€” æ¨¡æ¿é¢˜ AcWing 835. Trieå­—ç¬¦ä¸²ç»Ÿè®¡<a hidden class="anchor" aria-hidden="true" href="#trieæ ‘--æ¨¡æ¿é¢˜-acwing-835-trieå­—ç¬¦ä¸²ç»Ÿè®¡">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#66d9ef">int</span> son[N][<span style="color:#ae81ff">26</span>], cnt[N], idx;
</span></span><span style="display:flex;"><span><span style="color:#75715e">// 0å·ç‚¹æ—¢æ˜¯æ ¹èŠ‚ç‚¹ï¼Œåˆæ˜¯ç©ºèŠ‚ç‚¹
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// son[][]å­˜å‚¨æ ‘ä¸­æ¯ä¸ªèŠ‚ç‚¹çš„å­èŠ‚ç‚¹
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// cnt[]å­˜å‚¨ä»¥æ¯ä¸ªèŠ‚ç‚¹ç»“å°¾çš„å•è¯æ•°é‡
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// æ’å…¥ä¸€ä¸ªå­—ç¬¦ä¸²
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">insert</span>(<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>str)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> p <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; str[i]; i <span style="color:#f92672">++</span> )
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> u <span style="color:#f92672">=</span> str[i] <span style="color:#f92672">-</span> <span style="color:#e6db74">&#39;a&#39;</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>son[p][u]) son[p][u] <span style="color:#f92672">=</span> <span style="color:#f92672">++</span> idx;
</span></span><span style="display:flex;"><span>        p <span style="color:#f92672">=</span> son[p][u];
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    cnt[p] <span style="color:#f92672">++</span> ;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#75715e">// æŸ¥è¯¢å­—ç¬¦ä¸²å‡ºç°çš„æ¬¡æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">query</span>(<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>str)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> p <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; str[i]; i <span style="color:#f92672">++</span> )
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> u <span style="color:#f92672">=</span> str[i] <span style="color:#f92672">-</span> <span style="color:#e6db74">&#39;a&#39;</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>son[p][u]) <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>        p <span style="color:#f92672">=</span> son[p][u];
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> cnt[p];
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="å¹¶æŸ¥é›†--æ¨¡æ¿é¢˜-acwing-836-åˆå¹¶é›†åˆ-acwing-837-è¿é€šå—ä¸­ç‚¹çš„æ•°é‡">å¹¶æŸ¥é›† â€”â€” æ¨¡æ¿é¢˜ AcWing 836. åˆå¹¶é›†åˆ, AcWing 837. è¿é€šå—ä¸­ç‚¹çš„æ•°é‡<a hidden class="anchor" aria-hidden="true" href="#å¹¶æŸ¥é›†--æ¨¡æ¿é¢˜-acwing-836-åˆå¹¶é›†åˆ-acwing-837-è¿é€šå—ä¸­ç‚¹çš„æ•°é‡">#</a></h3>
<p>æŒ‰ç§©åˆå¹¶</p>
<p>å­—ç¬¦æŒ‰å­—ç¬¦ä¸²è¯»å…¥</p>
<p>(1)æœ´ç´ å¹¶æŸ¥é›†ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#66d9ef">int</span> p[N]; <span style="color:#75715e">//å­˜å‚¨æ¯ä¸ªç‚¹çš„ç¥–å®—èŠ‚ç‚¹
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// è¿”å›xçš„ç¥–å®—èŠ‚ç‚¹
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">find</span>(<span style="color:#66d9ef">int</span> x)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (p[x] <span style="color:#f92672">!=</span> x) p[x] <span style="color:#f92672">=</span> find(p[x]);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> p[x];
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#75715e">// åˆå§‹åŒ–ï¼Œå‡å®šèŠ‚ç‚¹ç¼–å·æ˜¯1~n
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>; i <span style="color:#f92672">&lt;=</span> n; i <span style="color:#f92672">++</span> ) p[i] <span style="color:#f92672">=</span> i;
</span></span><span style="display:flex;"><span><span style="color:#75715e">// åˆå¹¶aå’Œbæ‰€åœ¨çš„ä¸¤ä¸ªé›†åˆï¼š
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>p[find(a)] <span style="color:#f92672">=</span> find(b);
</span></span></code></pre></div><p>(2)ç»´æŠ¤sizeçš„å¹¶æŸ¥é›†ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#66d9ef">int</span> p[N], size[N];
</span></span><span style="display:flex;"><span><span style="color:#75715e">//p[]å­˜å‚¨æ¯ä¸ªç‚¹çš„ç¥–å®—èŠ‚ç‚¹, size[]åªæœ‰ç¥–å®—èŠ‚ç‚¹çš„æœ‰æ„ä¹‰ï¼Œè¡¨ç¤ºç¥–å®—èŠ‚ç‚¹æ‰€åœ¨é›†åˆä¸­çš„ç‚¹çš„æ•°é‡
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// è¿”å›xçš„ç¥–å®—èŠ‚ç‚¹
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">find</span>(<span style="color:#66d9ef">int</span> x)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (p[x] <span style="color:#f92672">!=</span> x) p[x] <span style="color:#f92672">=</span> find(p[x]);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> p[x];
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#75715e">// åˆå§‹åŒ–ï¼Œå‡å®šèŠ‚ç‚¹ç¼–å·æ˜¯1~n
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>; i <span style="color:#f92672">&lt;=</span> n; i <span style="color:#f92672">++</span> )
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    p[i] <span style="color:#f92672">=</span> i;
</span></span><span style="display:flex;"><span>    size[i] <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#75715e">// åˆå¹¶aå’Œbæ‰€åœ¨çš„ä¸¤ä¸ªé›†åˆï¼š
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>p[find(a)] <span style="color:#f92672">=</span> find(b);
</span></span><span style="display:flex;"><span>size[b] <span style="color:#f92672">+=</span> size[a];
</span></span></code></pre></div><p>(3)ç»´æŠ¤åˆ°ç¥–å®—èŠ‚ç‚¹è·ç¦»çš„å¹¶æŸ¥é›†ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#66d9ef">int</span> p[N], d[N];
</span></span><span style="display:flex;"><span><span style="color:#75715e">//p[]å­˜å‚¨æ¯ä¸ªç‚¹çš„ç¥–å®—èŠ‚ç‚¹, d[x]å­˜å‚¨xåˆ°p[x]çš„è·ç¦»
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// è¿”å›xçš„ç¥–å®—èŠ‚ç‚¹
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">find</span>(<span style="color:#66d9ef">int</span> x)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (p[x] <span style="color:#f92672">!=</span> x)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> u <span style="color:#f92672">=</span> find(p[x]);
</span></span><span style="display:flex;"><span>        d[x] <span style="color:#f92672">+=</span> d[p[x]];
</span></span><span style="display:flex;"><span>        p[x] <span style="color:#f92672">=</span> u;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> p[x];
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#75715e">// åˆå§‹åŒ–ï¼Œå‡å®šèŠ‚ç‚¹ç¼–å·æ˜¯1~n
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>; i <span style="color:#f92672">&lt;=</span> n; i <span style="color:#f92672">++</span> )
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    p[i] <span style="color:#f92672">=</span> i;
</span></span><span style="display:flex;"><span>    d[i] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#75715e">// åˆå¹¶aå’Œbæ‰€åœ¨çš„ä¸¤ä¸ªé›†åˆï¼š
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>p[find(a)] <span style="color:#f92672">=</span> find(b);
</span></span><span style="display:flex;"><span>d[find(a)] <span style="color:#f92672">=</span> distance; <span style="color:#75715e">// æ ¹æ®å…·ä½“é—®é¢˜ï¼Œåˆå§‹åŒ–find(a)çš„åç§»é‡
</span></span></span></code></pre></div><h3 id="å †--æ¨¡æ¿é¢˜-acwing-838-å †æ’åº-acwing-839-æ¨¡æ‹Ÿå †">å † â€”â€” æ¨¡æ¿é¢˜ AcWing 838. å †æ’åº, AcWing 839. æ¨¡æ‹Ÿå †<a hidden class="anchor" aria-hidden="true" href="#å †--æ¨¡æ¿é¢˜-acwing-838-å †æ’åº-acwing-839-æ¨¡æ‹Ÿå †">#</a></h3>
<p>ç»´æŠ¤é›†åˆçš„æ•°æ®ç»“æ„ ï¼ˆå¤§æ ¹å †ï¼Œçˆ¶èŠ‚ç‚¹å€¼ä¸å°äºå­èŠ‚ç‚¹å€¼ï¼‰</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#75715e">// h[N]å­˜å‚¨å †ä¸­çš„å€¼, h[1]æ˜¯å †é¡¶ï¼Œxçš„å·¦å„¿å­æ˜¯2x, å³å„¿å­æ˜¯2x + 1
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// pos[k]å­˜å‚¨ç¬¬kä¸ªæ’å…¥çš„ç‚¹åœ¨å †ä¸­çš„ä½ç½®
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// ord[k]å­˜å‚¨å †ä¸­ä¸‹æ ‡æ˜¯kçš„ç‚¹æ˜¯ç¬¬å‡ ä¸ªæ’å…¥çš„
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> h[N], ph[N], hp[N], size;
</span></span><span style="display:flex;"><span><span style="color:#75715e">// äº¤æ¢ä¸¤ä¸ªç‚¹ï¼ŒåŠå…¶æ˜ å°„å…³ç³»
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">heap_swap</span>(<span style="color:#66d9ef">int</span> a, <span style="color:#66d9ef">int</span> b)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">//swap(ph[hp[a]],ph[hp[b]]); æ ¹æ®é¢˜æ„
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">//swap(hp[a], hp[b]);
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    swap(h[a], h[b]);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">down</span>(<span style="color:#66d9ef">int</span> u)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> t <span style="color:#f92672">=</span> u;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (u <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">&lt;=</span> size <span style="color:#f92672">&amp;&amp;</span> h[u <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span>] <span style="color:#f92672">&lt;</span> h[t]) t <span style="color:#f92672">=</span> u <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (u <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">&lt;=</span> size <span style="color:#f92672">&amp;&amp;</span> h[u <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>] <span style="color:#f92672">&lt;</span> h[t]) t <span style="color:#f92672">=</span> u <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (u <span style="color:#f92672">!=</span> t)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        heap_swap(u, t);
</span></span><span style="display:flex;"><span>        down(t);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">up</span>(<span style="color:#66d9ef">int</span> u)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> (u <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">&amp;&amp;</span> h[u] <span style="color:#f92672">&lt;</span> h[u <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>])
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        heap_swap(u, u <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>);
</span></span><span style="display:flex;"><span>        u <span style="color:#f92672">&gt;&gt;=</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#75715e">// O(n)å»ºå †
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> n <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>; i; i <span style="color:#f92672">--</span> ) down(i);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>heap[<span style="color:#f92672">++</span>size] <span style="color:#f92672">=</span> x; up(size); <span style="color:#75715e">//æ·»åŠ å…ƒç´ 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>heap[<span style="color:#ae81ff">1</span>]; <span style="color:#75715e">//å †é¡¶å…ƒç´ 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>heap[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">=</span>heap[size]; size<span style="color:#f92672">--</span>; down(<span style="color:#ae81ff">1</span>);<span style="color:#75715e">//åˆ é™¤ç¬¬sizeä¸ªç»“ç‚¹
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>heap[k]<span style="color:#f92672">=</span>heap[size]; size<span style="color:#f92672">---</span>; down(k);up(k);<span style="color:#75715e">//åˆ é™¤ç¬¬kä¸ªç»“ç‚¹
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>heap[k]<span style="color:#f92672">=</span>x; down(k); up(k); <span style="color:#75715e">//å°†ç¬¬kä¸ªå…ƒç´ èµ‹å€¼ä¸ºx
</span></span></span></code></pre></div><h3 id="ä¸€èˆ¬å“ˆå¸Œ--æ¨¡æ¿é¢˜-acwing-840-æ¨¡æ‹Ÿæ•£åˆ—è¡¨">ä¸€èˆ¬å“ˆå¸Œ â€”â€” æ¨¡æ¿é¢˜ AcWing 840. æ¨¡æ‹Ÿæ•£åˆ—è¡¨<a hidden class="anchor" aria-hidden="true" href="#ä¸€èˆ¬å“ˆå¸Œ--æ¨¡æ¿é¢˜-acwing-840-æ¨¡æ‹Ÿæ•£åˆ—è¡¨">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span>(<span style="color:#ae81ff">1</span>) <span style="color:#960050;background-color:#1e0010">æ‹‰é“¾æ³•</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> h[N], e[N], ne[N], idx;
</span></span><span style="display:flex;"><span><span style="color:#75715e">// å‘å“ˆå¸Œè¡¨ä¸­æ’å…¥ä¸€ä¸ªæ•°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">insert</span>(<span style="color:#66d9ef">int</span> x)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> k <span style="color:#f92672">=</span> (x <span style="color:#f92672">%</span> N <span style="color:#f92672">+</span> N) <span style="color:#f92672">%</span> N;
</span></span><span style="display:flex;"><span>    e[idx] <span style="color:#f92672">=</span> x;
</span></span><span style="display:flex;"><span>    ne[idx] <span style="color:#f92672">=</span> h[k];
</span></span><span style="display:flex;"><span>    h[k] <span style="color:#f92672">=</span> idx <span style="color:#f92672">++</span> ;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#75715e">// åœ¨å“ˆå¸Œè¡¨ä¸­æŸ¥è¯¢æŸä¸ªæ•°æ˜¯å¦å­˜åœ¨
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">bool</span> <span style="color:#a6e22e">find</span>(<span style="color:#66d9ef">int</span> x)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> k <span style="color:#f92672">=</span> (x <span style="color:#f92672">%</span> N <span style="color:#f92672">+</span> N) <span style="color:#f92672">%</span> N;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> h[k]; i <span style="color:#f92672">!=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>; i <span style="color:#f92672">=</span> ne[i])
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (e[i] <span style="color:#f92672">==</span> x)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> true;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> false;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>(<span style="color:#ae81ff">2</span>) <span style="color:#960050;background-color:#1e0010">å¼€æ”¾å¯»å€æ³•</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> h[N];
</span></span><span style="display:flex;"><span><span style="color:#75715e">// å¦‚æœxåœ¨å“ˆå¸Œè¡¨ä¸­ï¼Œè¿”å›xçš„ä¸‹æ ‡ï¼›å¦‚æœxä¸åœ¨å“ˆå¸Œè¡¨ä¸­ï¼Œè¿”å›xåº”è¯¥æ’å…¥çš„ä½ç½®
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">find</span>(<span style="color:#66d9ef">int</span> x)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> t <span style="color:#f92672">=</span> (x <span style="color:#f92672">%</span> N <span style="color:#f92672">+</span> N) <span style="color:#f92672">%</span> N;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> (h[t] <span style="color:#f92672">!=</span> null <span style="color:#f92672">&amp;&amp;</span> h[t] <span style="color:#f92672">!=</span> x)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        t <span style="color:#f92672">++</span> ;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (t <span style="color:#f92672">==</span> N) t <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> t;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="å­—ç¬¦ä¸²å“ˆå¸Œ--æ¨¡æ¿é¢˜-acwing-841-å­—ç¬¦ä¸²å“ˆå¸Œ">å­—ç¬¦ä¸²å“ˆå¸Œ â€”â€” æ¨¡æ¿é¢˜ AcWing 841. å­—ç¬¦ä¸²å“ˆå¸Œ<a hidden class="anchor" aria-hidden="true" href="#å­—ç¬¦ä¸²å“ˆå¸Œ--æ¨¡æ¿é¢˜-acwing-841-å­—ç¬¦ä¸²å“ˆå¸Œ">#</a></h3>
<p>æ ¸å¿ƒæ€æƒ³ï¼šå°†å­—ç¬¦ä¸²çœ‹æˆPè¿›åˆ¶æ•°ï¼ŒPçš„ç»éªŒå€¼æ˜¯131æˆ–13331ï¼Œå–è¿™ä¸¤ä¸ªå€¼çš„å†²çªæ¦‚ç‡ä½
å°æŠ€å·§ï¼šå–æ¨¡çš„æ•°ç”¨2^64ï¼Œè¿™æ ·ç›´æ¥ç”¨unsigned long longå­˜å‚¨ï¼Œæº¢å‡ºçš„ç»“æœå°±æ˜¯å–æ¨¡çš„ç»“æœã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#66d9ef">typedef</span> <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">long</span> <span style="color:#66d9ef">long</span> ULL;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#66d9ef">int</span> P <span style="color:#f92672">=</span> <span style="color:#ae81ff">131</span> or <span style="color:#ae81ff">13331</span> ;
</span></span><span style="display:flex;"><span>ULL h[N], p[N]; <span style="color:#75715e">// h[k]å­˜å‚¨å­—ç¬¦ä¸²å‰kä¸ªå­—æ¯çš„å“ˆå¸Œå€¼, p[k]å­˜å‚¨ P^k mod 2^64
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// åˆå§‹åŒ–
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>p[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>; i <span style="color:#f92672">&lt;=</span> n; i <span style="color:#f92672">++</span> )
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    h[i] <span style="color:#f92672">=</span> h[i <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>] <span style="color:#f92672">*</span> P <span style="color:#f92672">+</span> str[i];
</span></span><span style="display:flex;"><span>    p[i] <span style="color:#f92672">=</span> p[i <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>] <span style="color:#f92672">*</span> P;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#75715e">// è®¡ç®—å­ä¸² str[l ~ r] çš„å“ˆå¸Œå€¼
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>ULL <span style="color:#a6e22e">get</span>(<span style="color:#66d9ef">int</span> l, <span style="color:#66d9ef">int</span> r)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> h[r] <span style="color:#f92672">-</span> h[l <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>] <span style="color:#f92672">*</span> p[r <span style="color:#f92672">-</span> l <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>];
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="c-stlç®€ä»‹">C++ STLç®€ä»‹<a hidden class="anchor" aria-hidden="true" href="#c-stlç®€ä»‹">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">æ‰€æœ‰å®¹å™¨éƒ½æœ‰</span>size() empty()
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>vector, <span style="color:#960050;background-color:#1e0010">å˜é•¿æ•°ç»„ï¼Œå€å¢çš„æ€æƒ³</span>
</span></span><span style="display:flex;"><span>    size()  <span style="color:#960050;background-color:#1e0010">è¿”å›å…ƒç´ ä¸ªæ•°</span>
</span></span><span style="display:flex;"><span>    empty()  <span style="color:#960050;background-color:#1e0010">è¿”å›æ˜¯å¦ä¸ºç©º</span>
</span></span><span style="display:flex;"><span>    clear()  <span style="color:#960050;background-color:#1e0010">æ¸…ç©º</span>
</span></span><span style="display:flex;"><span>    front()<span style="color:#f92672">/</span>back()
</span></span><span style="display:flex;"><span>    push_back()<span style="color:#f92672">/</span>pop_back()
</span></span><span style="display:flex;"><span>    begin()<span style="color:#f92672">/</span>end()
</span></span><span style="display:flex;"><span>    []
</span></span><span style="display:flex;"><span>    <span style="color:#960050;background-color:#1e0010">æ”¯æŒæ¯”è¾ƒè¿ç®—ï¼ŒæŒ‰å­—å…¸åº</span>
</span></span><span style="display:flex;"><span>    vector<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span> a(<span style="color:#ae81ff">10</span>,<span style="color:#ae81ff">2</span>);
</span></span><span style="display:flex;"><span>	a.empty();
</span></span><span style="display:flex;"><span>pair<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">int</span>, <span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    first, <span style="color:#960050;background-color:#1e0010">ç¬¬ä¸€ä¸ªå…ƒç´ </span>
</span></span><span style="display:flex;"><span>    second, <span style="color:#960050;background-color:#1e0010">ç¬¬äºŒä¸ªå…ƒç´ </span>
</span></span><span style="display:flex;"><span>    <span style="color:#960050;background-color:#1e0010">æ”¯æŒæ¯”è¾ƒè¿ç®—ï¼Œä»¥</span>firstä¸ºç¬¬ä¸€å…³é”®å­—<span style="color:#960050;background-color:#1e0010">ï¼Œä»¥</span>secondä¸ºç¬¬äºŒå…³é”®å­—<span style="color:#960050;background-color:#1e0010">ï¼ˆå­—å…¸åºï¼‰</span>
</span></span><span style="display:flex;"><span>	pair<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">int</span>,<span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span> p;
</span></span><span style="display:flex;"><span>	p<span style="color:#f92672">=</span>make_pair(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>	p<span style="color:#f92672">=</span>{<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1</span>};
</span></span><span style="display:flex;"><span>string<span style="color:#960050;background-color:#1e0010">ï¼Œå­—ç¬¦ä¸²</span>
</span></span><span style="display:flex;"><span>    size()<span style="color:#f92672">/</span>length()  <span style="color:#960050;background-color:#1e0010">è¿”å›å­—ç¬¦ä¸²é•¿åº¦</span>
</span></span><span style="display:flex;"><span>    empty()
</span></span><span style="display:flex;"><span>    clear()
</span></span><span style="display:flex;"><span>    substr(<span style="color:#960050;background-color:#1e0010">èµ·å§‹ä¸‹æ ‡ï¼Œ</span>(<span style="color:#960050;background-color:#1e0010">å­ä¸²é•¿åº¦</span>))  <span style="color:#960050;background-color:#1e0010">è¿”å›å­ä¸²</span>
</span></span><span style="display:flex;"><span>    c_str()  <span style="color:#960050;background-color:#1e0010">è¿”å›å­—ç¬¦ä¸²æ‰€åœ¨å­—ç¬¦æ•°ç»„çš„èµ·å§‹åœ°å€</span>
</span></span><span style="display:flex;"><span>        strcpy(c,s.c_str());<span style="color:#75715e">//c_str()çš„ä½¿ç”¨æ–¹æ³•
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>queue, <span style="color:#960050;background-color:#1e0010">é˜Ÿåˆ—</span>
</span></span><span style="display:flex;"><span>    <span style="color:#960050;background-color:#1e0010">æ²¡æœ‰</span>clearå‡½æ•°
</span></span><span style="display:flex;"><span>    <span style="color:#960050;background-color:#1e0010">æ¸…ç©ºç”¨æ–°å»º</span>queue
</span></span><span style="display:flex;"><span>    size()
</span></span><span style="display:flex;"><span>    empty()
</span></span><span style="display:flex;"><span>    push()  <span style="color:#960050;background-color:#1e0010">å‘é˜Ÿå°¾æ’å…¥ä¸€ä¸ªå…ƒç´ </span>
</span></span><span style="display:flex;"><span>    front()  <span style="color:#960050;background-color:#1e0010">è¿”å›é˜Ÿå¤´å…ƒç´ </span>
</span></span><span style="display:flex;"><span>    back()  <span style="color:#960050;background-color:#1e0010">è¿”å›é˜Ÿå°¾å…ƒç´ </span>
</span></span><span style="display:flex;"><span>    pop()  <span style="color:#960050;background-color:#1e0010">å¼¹å‡ºé˜Ÿå¤´å…ƒç´ </span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>priority_queue, <span style="color:#960050;background-color:#1e0010">ä¼˜å…ˆé˜Ÿåˆ—ï¼Œé»˜è®¤æ˜¯å¤§æ ¹å †</span>
</span></span><span style="display:flex;"><span>    push()  <span style="color:#960050;background-color:#1e0010">æ’å…¥ä¸€ä¸ªå…ƒç´ </span>
</span></span><span style="display:flex;"><span>    top()  <span style="color:#960050;background-color:#1e0010">è¿”å›å †é¡¶å…ƒç´ </span>
</span></span><span style="display:flex;"><span>    pop()  <span style="color:#960050;background-color:#1e0010">å¼¹å‡ºå †é¡¶å…ƒç´ </span>
</span></span><span style="display:flex;"><span>    <span style="color:#960050;background-color:#1e0010">å®šä¹‰æˆå°æ ¹å †çš„æ–¹å¼ï¼š</span>priority_queue<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">int</span>, vector<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span>, greater<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;&gt;</span> q;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>stack, <span style="color:#960050;background-color:#1e0010">æ ˆ</span>
</span></span><span style="display:flex;"><span>    size()
</span></span><span style="display:flex;"><span>    empty()
</span></span><span style="display:flex;"><span>    push()  <span style="color:#960050;background-color:#1e0010">å‘æ ˆé¡¶æ’å…¥ä¸€ä¸ªå…ƒç´ </span>
</span></span><span style="display:flex;"><span>    top()  <span style="color:#960050;background-color:#1e0010">è¿”å›æ ˆé¡¶å…ƒç´ </span>
</span></span><span style="display:flex;"><span>    pop()  <span style="color:#960050;background-color:#1e0010">å¼¹å‡ºæ ˆé¡¶å…ƒç´ </span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>deque, <span style="color:#960050;background-color:#1e0010">åŒç«¯é˜Ÿåˆ—</span>
</span></span><span style="display:flex;"><span>    size()
</span></span><span style="display:flex;"><span>    empty()
</span></span><span style="display:flex;"><span>    clear()
</span></span><span style="display:flex;"><span>    front()<span style="color:#f92672">/</span>back()
</span></span><span style="display:flex;"><span>    push_back()<span style="color:#f92672">/</span>pop_back()
</span></span><span style="display:flex;"><span>    push_front()<span style="color:#f92672">/</span>pop_front()
</span></span><span style="display:flex;"><span>    begin()<span style="color:#f92672">/</span>end()
</span></span><span style="display:flex;"><span>    []
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>set, map, multiset, multimap, <span style="color:#960050;background-color:#1e0010">åŸºäºå¹³è¡¡äºŒå‰æ ‘ï¼ˆçº¢é»‘æ ‘ï¼‰ï¼ŒåŠ¨æ€ç»´æŠ¤æœ‰åºåºåˆ—</span>
</span></span><span style="display:flex;"><span>    size()
</span></span><span style="display:flex;"><span>    empty()
</span></span><span style="display:flex;"><span>    clear()
</span></span><span style="display:flex;"><span>    begin()<span style="color:#f92672">/</span>end()
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">++</span>, <span style="color:#f92672">--</span> <span style="color:#960050;background-color:#1e0010">è¿”å›å‰é©±å’Œåç»§ï¼Œæ—¶é—´å¤æ‚åº¦</span> O(logn)
</span></span><span style="display:flex;"><span>set<span style="color:#f92672">/</span>multiset
</span></span><span style="display:flex;"><span>    insert()  <span style="color:#960050;background-color:#1e0010">æ’å…¥ä¸€ä¸ªæ•°</span>
</span></span><span style="display:flex;"><span>    find()  <span style="color:#960050;background-color:#1e0010">æŸ¥æ‰¾ä¸€ä¸ªæ•°</span>
</span></span><span style="display:flex;"><span>    count()  <span style="color:#960050;background-color:#1e0010">è¿”å›æŸä¸€ä¸ªæ•°çš„ä¸ªæ•°</span>
</span></span><span style="display:flex;"><span>    erase()
</span></span><span style="display:flex;"><span>        (<span style="color:#ae81ff">1</span>) <span style="color:#960050;background-color:#1e0010">è¾“å…¥æ˜¯ä¸€ä¸ªæ•°</span>x<span style="color:#960050;background-color:#1e0010">ï¼Œåˆ é™¤æ‰€æœ‰</span>x   O(k <span style="color:#f92672">+</span> logn)
</span></span><span style="display:flex;"><span>        (<span style="color:#ae81ff">2</span>) <span style="color:#960050;background-color:#1e0010">è¾“å…¥ä¸€ä¸ªè¿­ä»£å™¨ï¼Œåˆ é™¤è¿™ä¸ªè¿­ä»£å™¨</span>
</span></span><span style="display:flex;"><span>    lower_bound()<span style="color:#f92672">/</span>upper_bound()
</span></span><span style="display:flex;"><span>        lower_bound(x)  <span style="color:#960050;background-color:#1e0010">è¿”å›å¤§äºç­‰äº</span>xçš„æœ€å°çš„æ•°çš„è¿­ä»£å™¨
</span></span><span style="display:flex;"><span>        upper_bound(x)  <span style="color:#960050;background-color:#1e0010">è¿”å›å¤§äº</span>xçš„æœ€å°çš„æ•°çš„è¿­ä»£å™¨
</span></span><span style="display:flex;"><span>map<span style="color:#f92672">/</span>multimap
</span></span><span style="display:flex;"><span>    insert()  <span style="color:#960050;background-color:#1e0010">æ’å…¥çš„æ•°æ˜¯ä¸€ä¸ª</span>pair
</span></span><span style="display:flex;"><span>    erase()  <span style="color:#960050;background-color:#1e0010">è¾“å…¥çš„å‚æ•°æ˜¯</span>pairæˆ–è€…è¿­ä»£å™¨
</span></span><span style="display:flex;"><span>    find()
</span></span><span style="display:flex;"><span>    []  <span style="color:#960050;background-color:#1e0010">æ³¨æ„</span>multimapä¸æ”¯æŒæ­¤æ“ä½œ<span style="color:#960050;background-color:#1e0010">ã€‚</span> <span style="color:#960050;background-color:#1e0010">æ—¶é—´å¤æ‚åº¦æ˜¯</span> O(logn)
</span></span><span style="display:flex;"><span>    lower_bound()<span style="color:#f92672">/</span>upper_bound()
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>unordered_set, unordered_map, unordered_multiset, unordered_multimap, <span style="color:#960050;background-color:#1e0010">å“ˆå¸Œè¡¨</span>
</span></span><span style="display:flex;"><span>    <span style="color:#960050;background-color:#1e0010">å’Œä¸Šé¢ç±»ä¼¼ï¼Œå¢åˆ æ”¹æŸ¥çš„æ—¶é—´å¤æ‚åº¦æ˜¯</span> O(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#960050;background-color:#1e0010">ä¸æ”¯æŒ</span> lower_bound()<span style="color:#f92672">/</span>upper_bound()<span style="color:#960050;background-color:#1e0010">ï¼Œ</span> <span style="color:#960050;background-color:#1e0010">è¿­ä»£å™¨çš„</span><span style="color:#f92672">++</span><span style="color:#960050;background-color:#1e0010">ï¼Œ</span><span style="color:#f92672">--</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>bitset, <span style="color:#960050;background-color:#1e0010">åœ§ä½</span>
</span></span><span style="display:flex;"><span>    bitset<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">10000</span><span style="color:#f92672">&gt;</span> s;
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">~</span>, <span style="color:#f92672">&amp;</span>, <span style="color:#f92672">|</span>, <span style="color:#f92672">^</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&gt;&gt;</span>, <span style="color:#f92672">&lt;&lt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">==</span>, <span style="color:#f92672">!=</span>
</span></span><span style="display:flex;"><span>    []
</span></span><span style="display:flex;"><span>    count()  <span style="color:#960050;background-color:#1e0010">è¿”å›æœ‰å¤šå°‘ä¸ª</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    none()  <span style="color:#960050;background-color:#1e0010">åˆ¤æ–­æ˜¯å¦å…¨ä¸º</span><span style="color:#ae81ff">0</span>     any()  <span style="color:#960050;background-color:#1e0010">åˆ¤æ–­æ˜¯å¦è‡³å°‘æœ‰ä¸€ä¸ª</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    set()  <span style="color:#960050;background-color:#1e0010">æŠŠæ‰€æœ‰ä½ç½®æˆ</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    set(k, v)  <span style="color:#960050;background-color:#1e0010">å°†ç¬¬</span>kä½å˜æˆv
</span></span><span style="display:flex;"><span>    reset()  <span style="color:#960050;background-color:#1e0010">æŠŠæ‰€æœ‰ä½å˜æˆ</span><span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    flip()  <span style="color:#960050;background-color:#1e0010">ç­‰ä»·äº</span><span style="color:#f92672">~</span>
</span></span><span style="display:flex;"><span>    flip(k) <span style="color:#960050;background-color:#1e0010">æŠŠç¬¬</span>kä½å–å
</span></span></code></pre></div><p>ä½œè€…ï¼šyxc
é“¾æ¥ï¼šhttps://www.acwing.com/blog/content/404/
æ¥æºï¼šAcWing
è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p>
<h2 id="ç¬¬ä¸‰ç« ">ç¬¬ä¸‰ç« <a hidden class="anchor" aria-hidden="true" href="#ç¬¬ä¸‰ç« ">#</a></h2>
<h3 id="æ ‘ä¸å›¾çš„å­˜å‚¨">æ ‘ä¸å›¾çš„å­˜å‚¨<a hidden class="anchor" aria-hidden="true" href="#æ ‘ä¸å›¾çš„å­˜å‚¨">#</a></h3>
<p><strong>æ ‘æ˜¯ä¸€ç§ç‰¹æ®Šçš„å›¾: æ— ç¯è¿é€šå›¾</strong>ï¼Œä¸å›¾çš„å­˜å‚¨æ–¹å¼ç›¸åŒã€‚
å¯¹äºæ— å‘å›¾ä¸­çš„è¾¹abï¼Œå­˜å‚¨ä¸¤æ¡æœ‰å‘è¾¹a-&gt;b, b-&gt;aã€‚
å› æ­¤æˆ‘ä»¬å¯ä»¥åªè€ƒè™‘æœ‰å‘å›¾çš„å­˜å‚¨ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span>(<span style="color:#ae81ff">1</span>) <span style="color:#960050;background-color:#1e0010">é‚»æ¥çŸ©é˜µï¼š</span>g[a][b] <span style="color:#960050;background-color:#1e0010">å­˜å‚¨è¾¹</span>a<span style="color:#f92672">-&gt;</span>b
</span></span><span style="display:flex;"><span>(<span style="color:#ae81ff">2</span>) <span style="color:#960050;background-color:#1e0010">é‚»æ¥è¡¨ï¼š</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// å¯¹äºæ¯ä¸ªç‚¹kï¼Œå¼€ä¸€ä¸ªå•é“¾è¡¨ï¼Œå­˜å‚¨kæ‰€æœ‰å¯ä»¥èµ°åˆ°çš„ç‚¹ã€‚h[k]å­˜å‚¨è¿™ä¸ªå•é“¾è¡¨çš„å¤´ç»“ç‚¹
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> h[N], e[N], ne[N], idx;
</span></span><span style="display:flex;"><span><span style="color:#75715e">// æ·»åŠ ä¸€æ¡è¾¹a-&gt;b
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">add</span>(<span style="color:#66d9ef">int</span> a, <span style="color:#66d9ef">int</span> b)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    e[idx] <span style="color:#f92672">=</span> b, ne[idx] <span style="color:#f92672">=</span> h[a], h[a] <span style="color:#f92672">=</span> idx <span style="color:#f92672">++</span> ;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#75715e">// åˆå§‹åŒ–
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>idx <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>memset(h, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, <span style="color:#66d9ef">sizeof</span> h); 
</span></span></code></pre></div><h3 id="æ ‘ä¸å›¾çš„éå†">æ ‘ä¸å›¾çš„éå†<a hidden class="anchor" aria-hidden="true" href="#æ ‘ä¸å›¾çš„éå†">#</a></h3>
<p>æ—¶é—´å¤æ‚åº¦ O(n+m)O(n+m), nn è¡¨ç¤ºç‚¹æ•°ï¼Œmm è¡¨ç¤ºè¾¹æ•°</p>
<h4 id="1-æ·±åº¦ä¼˜å…ˆéå†--æ¨¡æ¿é¢˜-acwing-846-æ ‘çš„é‡å¿ƒ">(1) æ·±åº¦ä¼˜å…ˆéå† â€”â€” æ¨¡æ¿é¢˜ AcWing 846. æ ‘çš„é‡å¿ƒ<a hidden class="anchor" aria-hidden="true" href="#1-æ·±åº¦ä¼˜å…ˆéå†--æ¨¡æ¿é¢˜-acwing-846-æ ‘çš„é‡å¿ƒ">#</a></h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">dfs</span>(<span style="color:#66d9ef">int</span> u)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    st[u] <span style="color:#f92672">=</span> true; <span style="color:#75715e">// st[u] è¡¨ç¤ºç‚¹uå·²ç»è¢«éå†è¿‡
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> h[u]; i <span style="color:#f92672">!=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>; i <span style="color:#f92672">=</span> ne[i])
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> e[i];
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>st[j]) dfs(j);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h4 id="2-å®½åº¦ä¼˜å…ˆéå†--æ¨¡æ¿é¢˜-acwing-847-å›¾ä¸­ç‚¹çš„å±‚æ¬¡">(2) å®½åº¦ä¼˜å…ˆéå† â€”â€” æ¨¡æ¿é¢˜ AcWing 847. å›¾ä¸­ç‚¹çš„å±‚æ¬¡<a hidden class="anchor" aria-hidden="true" href="#2-å®½åº¦ä¼˜å…ˆéå†--æ¨¡æ¿é¢˜-acwing-847-å›¾ä¸­ç‚¹çš„å±‚æ¬¡">#</a></h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span>queue<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span> q;
</span></span><span style="display:flex;"><span>st[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span> true; <span style="color:#75715e">// è¡¨ç¤º1å·ç‚¹å·²ç»è¢«éå†è¿‡
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>q.push(<span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">while</span> (q.size())
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> t <span style="color:#f92672">=</span> q.front();
</span></span><span style="display:flex;"><span>    q.pop();
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> h[t]; i <span style="color:#f92672">!=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>; i <span style="color:#f92672">=</span> ne[i])
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> e[i];
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>st[j])
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            st[j] <span style="color:#f92672">=</span> true; <span style="color:#75715e">// è¡¨ç¤ºç‚¹jå·²ç»è¢«éå†è¿‡
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            q.push(j);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="æ‹“æ‰‘æ’åº--æ¨¡æ¿é¢˜-acwing-848-æœ‰å‘å›¾çš„æ‹“æ‰‘åºåˆ—">æ‹“æ‰‘æ’åº â€”â€” æ¨¡æ¿é¢˜ AcWing 848. æœ‰å‘å›¾çš„æ‹“æ‰‘åºåˆ—<a hidden class="anchor" aria-hidden="true" href="#æ‹“æ‰‘æ’åº--æ¨¡æ¿é¢˜-acwing-848-æœ‰å‘å›¾çš„æ‹“æ‰‘åºåˆ—">#</a></h3>
<p>æ—¶é—´å¤æ‚åº¦ O(n+m)O(n+m), nn è¡¨ç¤ºç‚¹æ•°ï¼Œmm è¡¨ç¤ºè¾¹æ•°</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#66d9ef">bool</span> <span style="color:#a6e22e">topsort</span>()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> hh <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, tt <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// d[i] å­˜å‚¨ç‚¹içš„å…¥åº¦
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>; i <span style="color:#f92672">&lt;=</span> n; i <span style="color:#f92672">++</span> )
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>d[i])
</span></span><span style="display:flex;"><span>            q[ <span style="color:#f92672">++</span> tt] <span style="color:#f92672">=</span> i;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> (hh <span style="color:#f92672">&lt;=</span> tt)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> t <span style="color:#f92672">=</span> q[hh <span style="color:#f92672">++</span> ];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> h[t]; i <span style="color:#f92672">!=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>; i <span style="color:#f92672">=</span> ne[i])
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> e[i];
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (<span style="color:#f92672">--</span> d[j] <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>                q[ <span style="color:#f92672">++</span> tt] <span style="color:#f92672">=</span> j;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// å¦‚æœæ‰€æœ‰ç‚¹éƒ½å…¥é˜Ÿäº†ï¼Œè¯´æ˜å­˜åœ¨æ‹“æ‰‘åºåˆ—ï¼›å¦åˆ™ä¸å­˜åœ¨æ‹“æ‰‘åºåˆ—ã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">return</span> tt <span style="color:#f92672">==</span> n <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="æœ€çŸ­è·¯">æœ€çŸ­è·¯<a hidden class="anchor" aria-hidden="true" href="#æœ€çŸ­è·¯">#</a></h3>
<p>å•æºæœ€çŸ­è·¯</p>
<p>æ‰€æœ‰è¾¹æƒå‡ä¸ºæ­£ï¼šæœ´ç´ Dijkstra O(n^2)ï¼›å †ä¼˜åŒ–ç‰ˆçš„Dijkstra(mlogn)</p>
<p>å­˜åœ¨è´Ÿæƒå˜ï¼šBellman-Ford O(nm) ï¼› SPFAï¼ˆé˜Ÿåˆ—ä¼˜åŒ–Bellman-Ford) ä¸€èˆ¬ï¼šO(m) æœ€å O(nm)</p>
<p>å¤šå…ƒæ±‡æœ€çŸ­è·¯ï¼šFloyedç®—æ³• O(n^3)</p>
<h3 id="æœ´ç´ dijkstraç®—æ³•--æ¨¡æ¿é¢˜-acwing-849-dijkstraæ±‚æœ€çŸ­è·¯-i-åŸºäºè´ªå¿ƒ">æœ´ç´ dijkstraç®—æ³• â€”â€” æ¨¡æ¿é¢˜ AcWing 849. Dijkstraæ±‚æœ€çŸ­è·¯ I åŸºäºè´ªå¿ƒ<a hidden class="anchor" aria-hidden="true" href="#æœ´ç´ dijkstraç®—æ³•--æ¨¡æ¿é¢˜-acwing-849-dijkstraæ±‚æœ€çŸ­è·¯-i-åŸºäºè´ªå¿ƒ">#</a></h3>
<p>æ—¶é—´å¤æ‚æ˜¯ O(n^2+m), n è¡¨ç¤ºç‚¹æ•°ï¼Œm è¡¨ç¤ºè¾¹æ•°</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#66d9ef">int</span> g[N][N];  <span style="color:#75715e">// å­˜å‚¨æ¯æ¡è¾¹ï¼Œ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> dist[N];  <span style="color:#75715e">// å­˜å‚¨1å·ç‚¹åˆ°æ¯ä¸ªç‚¹çš„æœ€çŸ­è·ç¦»
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">bool</span> st[N];   <span style="color:#75715e">// å­˜å‚¨æ¯ä¸ªç‚¹çš„æœ€çŸ­è·¯æ˜¯å¦å·²ç»ç¡®å®š
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// æ±‚1å·ç‚¹åˆ°nå·ç‚¹çš„æœ€çŸ­è·¯ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™è¿”å›-1
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">dijkstra</span>()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    memset(dist, <span style="color:#ae81ff">0x3f</span>, <span style="color:#66d9ef">sizeof</span> dist);
</span></span><span style="display:flex;"><span>    dist[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> n <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>; i <span style="color:#f92672">++</span> )
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> t <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>;     <span style="color:#75715e">// åœ¨è¿˜æœªç¡®å®šæœ€çŸ­è·¯çš„ç‚¹ä¸­ï¼Œå¯»æ‰¾è·ç¦»æœ€å°çš„ç‚¹
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>; j <span style="color:#f92672">&lt;=</span> n; j <span style="color:#f92672">++</span> )
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>st[j] <span style="color:#f92672">&amp;&amp;</span> (t <span style="color:#f92672">==</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span> <span style="color:#f92672">||</span> dist[t] <span style="color:#f92672">&gt;</span> dist[j]))
</span></span><span style="display:flex;"><span>                t <span style="color:#f92672">=</span> j;
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// ç”¨tæ›´æ–°å…¶ä»–ç‚¹çš„è·ç¦»
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>; j <span style="color:#f92672">&lt;=</span> n; j <span style="color:#f92672">++</span> )
</span></span><span style="display:flex;"><span>            dist[j] <span style="color:#f92672">=</span> min(dist[j], dist[t] <span style="color:#f92672">+</span> g[t][j]);
</span></span><span style="display:flex;"><span>        st[t] <span style="color:#f92672">=</span> true;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (dist[n] <span style="color:#f92672">==</span> <span style="color:#ae81ff">0x3f3f3f3f</span>) <span style="color:#66d9ef">return</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> dist[n];
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="å †ä¼˜åŒ–ç‰ˆdijkstra--æ¨¡æ¿é¢˜-acwing-850-dijkstraæ±‚æœ€çŸ­è·¯-ii">å †ä¼˜åŒ–ç‰ˆdijkstra â€”â€” æ¨¡æ¿é¢˜ AcWing 850. Dijkstraæ±‚æœ€çŸ­è·¯ II<a hidden class="anchor" aria-hidden="true" href="#å †ä¼˜åŒ–ç‰ˆdijkstra--æ¨¡æ¿é¢˜-acwing-850-dijkstraæ±‚æœ€çŸ­è·¯-ii">#</a></h3>
<p>æ—¶é—´å¤æ‚åº¦ O(mlogn), n è¡¨ç¤ºç‚¹æ•°ï¼Œm è¡¨ç¤ºè¾¹æ•°</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#66d9ef">typedef</span> pair<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">int</span>, <span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span> PII;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> n;      <span style="color:#75715e">// ç‚¹çš„æ•°é‡
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> h[N], w[N], e[N], ne[N], idx;       <span style="color:#75715e">// é‚»æ¥è¡¨å­˜å‚¨æ‰€æœ‰è¾¹
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> dist[N];        <span style="color:#75715e">// å­˜å‚¨æ‰€æœ‰ç‚¹åˆ°1å·ç‚¹çš„è·ç¦»
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">bool</span> st[N];     <span style="color:#75715e">// å­˜å‚¨æ¯ä¸ªç‚¹çš„æœ€çŸ­è·ç¦»æ˜¯å¦å·²ç¡®å®š
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// æ±‚1å·ç‚¹åˆ°nå·ç‚¹çš„æœ€çŸ­è·ç¦»ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œåˆ™è¿”å›-1
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">dijkstra</span>()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    memset(dist, <span style="color:#ae81ff">0x3f</span>, <span style="color:#66d9ef">sizeof</span> dist);
</span></span><span style="display:flex;"><span>    dist[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>    priority_queue<span style="color:#f92672">&lt;</span>PII, vector<span style="color:#f92672">&lt;</span>PII<span style="color:#f92672">&gt;</span>, greater<span style="color:#f92672">&lt;</span>PII<span style="color:#f92672">&gt;&gt;</span> heap;
</span></span><span style="display:flex;"><span>    heap.push({<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>});      <span style="color:#75715e">// firstå­˜å‚¨è·ç¦»ï¼Œsecondå­˜å‚¨èŠ‚ç‚¹ç¼–å·
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">while</span> (heap.size())
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">auto</span> t <span style="color:#f92672">=</span> heap.top();
</span></span><span style="display:flex;"><span>        heap.pop();
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> ver <span style="color:#f92672">=</span> t.second, distance <span style="color:#f92672">=</span> t.first;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (st[ver]) <span style="color:#66d9ef">continue</span>;
</span></span><span style="display:flex;"><span>        st[ver] <span style="color:#f92672">=</span> true;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> h[ver]; i <span style="color:#f92672">!=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>; i <span style="color:#f92672">=</span> ne[i])
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> e[i];
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (dist[j] <span style="color:#f92672">&gt;</span> distance <span style="color:#f92672">+</span> w[i])
</span></span><span style="display:flex;"><span>            {
</span></span><span style="display:flex;"><span>                dist[j] <span style="color:#f92672">=</span> distance <span style="color:#f92672">+</span> w[i];
</span></span><span style="display:flex;"><span>                heap.push({dist[j], j});
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (dist[n] <span style="color:#f92672">==</span> <span style="color:#ae81ff">0x3f3f3f3f</span>) <span style="color:#66d9ef">return</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> dist[n];
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="bellman-fordç®—æ³•--æ¨¡æ¿é¢˜-acwing-853-æœ‰è¾¹æ•°é™åˆ¶çš„æœ€çŸ­è·¯">Bellman-Fordç®—æ³• â€”â€” æ¨¡æ¿é¢˜ AcWing 853. æœ‰è¾¹æ•°é™åˆ¶çš„æœ€çŸ­è·¯<a hidden class="anchor" aria-hidden="true" href="#bellman-fordç®—æ³•--æ¨¡æ¿é¢˜-acwing-853-æœ‰è¾¹æ•°é™åˆ¶çš„æœ€çŸ­è·¯">#</a></h3>
<p>æ—¶é—´å¤æ‚åº¦ O(nm), n è¡¨ç¤ºç‚¹æ•°ï¼Œmè¡¨ç¤ºè¾¹æ•°
æ³¨æ„åœ¨æ¨¡æ¿é¢˜ä¸­éœ€è¦å¯¹ä¸‹é¢çš„æ¨¡æ¿ç¨ä½œä¿®æ”¹ï¼ŒåŠ ä¸Šå¤‡ä»½æ•°ç»„ï¼Œè¯¦æƒ…è§æ¨¡æ¿é¢˜ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#66d9ef">int</span> n, m;       <span style="color:#75715e">// nè¡¨ç¤ºç‚¹æ•°ï¼Œmè¡¨ç¤ºè¾¹æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> dist[N];        <span style="color:#75715e">// dist[x]å­˜å‚¨1åˆ°xçš„æœ€çŸ­è·¯è·ç¦»
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">struct</span> <span style="color:#a6e22e">Edge</span>     <span style="color:#75715e">// è¾¹ï¼Œaè¡¨ç¤ºå‡ºç‚¹ï¼Œbè¡¨ç¤ºå…¥ç‚¹ï¼Œwè¡¨ç¤ºè¾¹çš„æƒé‡
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> a, b, w;
</span></span><span style="display:flex;"><span>}edges[M];
</span></span><span style="display:flex;"><span><span style="color:#75715e">// æ±‚1åˆ°nçš„æœ€çŸ­è·¯è·ç¦»ï¼Œå¦‚æœæ— æ³•ä»1èµ°åˆ°nï¼Œåˆ™è¿”å›-1ã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">bellman_ford</span>()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    memset(dist, <span style="color:#ae81ff">0x3f</span>, <span style="color:#66d9ef">sizeof</span> dist);
</span></span><span style="display:flex;"><span>    dist[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// å¦‚æœç¬¬næ¬¡è¿­ä»£ä»ç„¶ä¼šæ¾å¼›ä¸‰è§’ä¸ç­‰å¼ï¼Œå°±è¯´æ˜å­˜åœ¨ä¸€æ¡é•¿åº¦æ˜¯n+1çš„æœ€çŸ­è·¯å¾„ï¼Œç”±æŠ½å±‰åŸç†ï¼Œè·¯å¾„ä¸­è‡³å°‘å­˜åœ¨ä¸¤ä¸ªç›¸åŒçš„ç‚¹ï¼Œè¯´æ˜å›¾ä¸­å­˜åœ¨è´Ÿæƒå›è·¯ã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> n; i <span style="color:#f92672">++</span> )
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; j <span style="color:#f92672">&lt;</span> m; j <span style="color:#f92672">++</span> )
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> a <span style="color:#f92672">=</span> edges[j].a, b <span style="color:#f92672">=</span> edges[j].b, w <span style="color:#f92672">=</span> edges[j].w;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (dist[b] <span style="color:#f92672">&gt;</span> dist[a] <span style="color:#f92672">+</span> w)
</span></span><span style="display:flex;"><span>                dist[b] <span style="color:#f92672">=</span> dist[a] <span style="color:#f92672">+</span> w;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (dist[n] <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0x3f3f3f3f</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>) <span style="color:#66d9ef">return</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> dist[n];
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="spfa-ç®—æ³•é˜Ÿåˆ—ä¼˜åŒ–çš„bellman-fordç®—æ³•--æ¨¡æ¿é¢˜-acwing-851-spfaæ±‚æœ€çŸ­è·¯">spfa ç®—æ³•ï¼ˆé˜Ÿåˆ—ä¼˜åŒ–çš„Bellman-Fordç®—æ³•ï¼‰ â€”â€” æ¨¡æ¿é¢˜ AcWing 851. spfaæ±‚æœ€çŸ­è·¯<a hidden class="anchor" aria-hidden="true" href="#spfa-ç®—æ³•é˜Ÿåˆ—ä¼˜åŒ–çš„bellman-fordç®—æ³•--æ¨¡æ¿é¢˜-acwing-851-spfaæ±‚æœ€çŸ­è·¯">#</a></h3>
<p>æ—¶é—´å¤æ‚åº¦ å¹³å‡æƒ…å†µä¸‹ O(m)ï¼Œæœ€åæƒ…å†µä¸‹ O(nm), n è¡¨ç¤ºç‚¹æ•°ï¼Œm è¡¨ç¤ºè¾¹æ•°</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#66d9ef">int</span> n;      <span style="color:#75715e">// æ€»ç‚¹æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> h[N], w[N], e[N], ne[N], idx;       <span style="color:#75715e">// é‚»æ¥è¡¨å­˜å‚¨æ‰€æœ‰è¾¹
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> dist[N];        <span style="color:#75715e">// å­˜å‚¨æ¯ä¸ªç‚¹åˆ°1å·ç‚¹çš„æœ€çŸ­è·ç¦»
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">bool</span> st[N];     <span style="color:#75715e">// å­˜å‚¨æ¯ä¸ªç‚¹æ˜¯å¦åœ¨é˜Ÿåˆ—ä¸­
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// æ±‚1å·ç‚¹åˆ°nå·ç‚¹çš„æœ€çŸ­è·¯è·ç¦»ï¼Œå¦‚æœä»1å·ç‚¹æ— æ³•èµ°åˆ°nå·ç‚¹åˆ™è¿”å›-1
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">spfa</span>()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    memset(dist, <span style="color:#ae81ff">0x3f</span>, <span style="color:#66d9ef">sizeof</span> dist);
</span></span><span style="display:flex;"><span>    dist[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>    queue<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span> q;
</span></span><span style="display:flex;"><span>    q.push(<span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>    st[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span> true;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> (q.size())
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">auto</span> t <span style="color:#f92672">=</span> q.front();
</span></span><span style="display:flex;"><span>        q.pop(); st[t] <span style="color:#f92672">=</span> false;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> h[t]; i <span style="color:#f92672">!=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>; i <span style="color:#f92672">=</span> ne[i])
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> e[i];
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (dist[j] <span style="color:#f92672">&gt;</span> dist[t] <span style="color:#f92672">+</span> w[i])
</span></span><span style="display:flex;"><span>            {
</span></span><span style="display:flex;"><span>                dist[j] <span style="color:#f92672">=</span> dist[t] <span style="color:#f92672">+</span> w[i];
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>st[j])     <span style="color:#75715e">// å¦‚æœé˜Ÿåˆ—ä¸­å·²å­˜åœ¨jï¼Œåˆ™ä¸éœ€è¦å°†jé‡å¤æ’å…¥
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                {
</span></span><span style="display:flex;"><span>                    q.push(j); st[j] <span style="color:#f92672">=</span> true;
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (dist[n] <span style="color:#f92672">==</span> <span style="color:#ae81ff">0x3f3f3f3f</span>) <span style="color:#66d9ef">return</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> dist[n];
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="spfaåˆ¤æ–­å›¾ä¸­æ˜¯å¦å­˜åœ¨è´Ÿç¯--æ¨¡æ¿é¢˜-acwing-852-spfaåˆ¤æ–­è´Ÿç¯">spfaåˆ¤æ–­å›¾ä¸­æ˜¯å¦å­˜åœ¨è´Ÿç¯ â€”â€” æ¨¡æ¿é¢˜ AcWing 852. spfaåˆ¤æ–­è´Ÿç¯<a hidden class="anchor" aria-hidden="true" href="#spfaåˆ¤æ–­å›¾ä¸­æ˜¯å¦å­˜åœ¨è´Ÿç¯--æ¨¡æ¿é¢˜-acwing-852-spfaåˆ¤æ–­è´Ÿç¯">#</a></h3>
<p>æ—¶é—´å¤æ‚åº¦æ˜¯ O(nm), n è¡¨ç¤ºç‚¹æ•°ï¼Œm è¡¨ç¤ºè¾¹æ•°</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#66d9ef">int</span> n;      <span style="color:#75715e">// æ€»ç‚¹æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> h[N], w[N], e[N], ne[N], idx;       <span style="color:#75715e">// é‚»æ¥è¡¨å­˜å‚¨æ‰€æœ‰è¾¹
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> dist[N], cnt[N];        <span style="color:#75715e">// dist[x]å­˜å‚¨1å·ç‚¹åˆ°xçš„æœ€çŸ­è·ç¦»ï¼Œcnt[x]å­˜å‚¨1åˆ°xçš„æœ€çŸ­è·¯ä¸­ç»è¿‡çš„ç‚¹æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">bool</span> st[N];     <span style="color:#75715e">// å­˜å‚¨æ¯ä¸ªç‚¹æ˜¯å¦åœ¨é˜Ÿåˆ—ä¸­
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// å¦‚æœå­˜åœ¨è´Ÿç¯ï¼Œåˆ™è¿”å›trueï¼Œå¦åˆ™è¿”å›falseã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">bool</span> <span style="color:#a6e22e">spfa</span>()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// ä¸éœ€è¦åˆå§‹åŒ–distæ•°ç»„
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// åŸç†ï¼šå¦‚æœæŸæ¡æœ€çŸ­è·¯å¾„ä¸Šæœ‰nä¸ªç‚¹ï¼ˆé™¤äº†è‡ªå·±ï¼‰ï¼Œé‚£ä¹ˆåŠ ä¸Šè‡ªå·±ä¹‹åä¸€å…±æœ‰n+1ä¸ªç‚¹ï¼Œç”±æŠ½å±‰åŸç†ä¸€å®šæœ‰ä¸¤ä¸ªç‚¹ç›¸åŒï¼Œæ‰€ä»¥å­˜åœ¨ç¯ã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    queue<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span> q;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>; i <span style="color:#f92672">&lt;=</span> n; i <span style="color:#f92672">++</span> )
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        q.push(i);
</span></span><span style="display:flex;"><span>        st[i] <span style="color:#f92672">=</span> true;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> (q.size())
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">auto</span> t <span style="color:#f92672">=</span> q.front();
</span></span><span style="display:flex;"><span>        q.pop();
</span></span><span style="display:flex;"><span>        st[t] <span style="color:#f92672">=</span> false;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> h[t]; i <span style="color:#f92672">!=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>; i <span style="color:#f92672">=</span> ne[i])
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> e[i];
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (dist[j] <span style="color:#f92672">&gt;</span> dist[t] <span style="color:#f92672">+</span> w[i])
</span></span><span style="display:flex;"><span>            {
</span></span><span style="display:flex;"><span>                dist[j] <span style="color:#f92672">=</span> dist[t] <span style="color:#f92672">+</span> w[i];
</span></span><span style="display:flex;"><span>                cnt[j] <span style="color:#f92672">=</span> cnt[t] <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> (cnt[j] <span style="color:#f92672">&gt;=</span> n) <span style="color:#66d9ef">return</span> true;       <span style="color:#75715e">// å¦‚æœä»1å·ç‚¹åˆ°xçš„æœ€çŸ­è·¯ä¸­åŒ…å«è‡³å°‘nä¸ªç‚¹ï¼ˆä¸åŒ…æ‹¬è‡ªå·±ï¼‰ï¼Œåˆ™è¯´æ˜å­˜åœ¨ç¯
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>st[j])
</span></span><span style="display:flex;"><span>                {
</span></span><span style="display:flex;"><span>                    q.push(j);
</span></span><span style="display:flex;"><span>                    st[j] <span style="color:#f92672">=</span> true;
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> false;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="floydç®—æ³•--æ¨¡æ¿é¢˜-acwing-854-floydæ±‚æœ€çŸ­è·¯">floydç®—æ³• â€”â€” æ¨¡æ¿é¢˜ AcWing 854. Floydæ±‚æœ€çŸ­è·¯<a hidden class="anchor" aria-hidden="true" href="#floydç®—æ³•--æ¨¡æ¿é¢˜-acwing-854-floydæ±‚æœ€çŸ­è·¯">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">æ—¶é—´å¤æ‚åº¦æ˜¯</span> <span style="color:#a6e22e">O</span>(n3)O(n3), nn <span style="color:#960050;background-color:#1e0010">è¡¨ç¤ºç‚¹æ•°</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">åˆå§‹åŒ–ï¼š</span> 
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>; i <span style="color:#f92672">&lt;=</span> n; i <span style="color:#f92672">++</span> )
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>; j <span style="color:#f92672">&lt;=</span> n; j <span style="color:#f92672">++</span> )
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (i <span style="color:#f92672">==</span> j) d[i][j] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">else</span> d[i][j] <span style="color:#f92672">=</span> INF;
</span></span><span style="display:flex;"><span><span style="color:#75715e">// ç®—æ³•ç»“æŸåï¼Œd[a][b]è¡¨ç¤ºaåˆ°bçš„æœ€çŸ­è·ç¦»
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">floyd</span>()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> k <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>; k <span style="color:#f92672">&lt;=</span> n; k <span style="color:#f92672">++</span> )
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>; i <span style="color:#f92672">&lt;=</span> n; i <span style="color:#f92672">++</span> )
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>; j <span style="color:#f92672">&lt;=</span> n; j <span style="color:#f92672">++</span> )
</span></span><span style="display:flex;"><span>                d[i][j] <span style="color:#f92672">=</span> min(d[i][j], d[i][k] <span style="color:#f92672">+</span> d[k][j]);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="æœ€å°ç”Ÿæˆæ ‘æ— å‘å›¾">æœ€å°ç”Ÿæˆæ ‘ï¼ˆæ— å‘å›¾ï¼‰<a hidden class="anchor" aria-hidden="true" href="#æœ€å°ç”Ÿæˆæ ‘æ— å‘å›¾">#</a></h3>
<p>Prim : æœ´ç´ ç‰ˆPrim O(n^2)(ç¨ å¯†å›¾) ; å †ä¼˜åŒ–ç‰ˆPrim O(mlogn)(ä¸€èˆ¬ä¸ä¼šç”¨)</p>
<p>Kruskal  : O(mlogm)(ç¨€ç–å›¾)</p>
<h3 id="æœ´ç´ ç‰ˆprimç®—æ³•--æ¨¡æ¿é¢˜-acwing-858-primç®—æ³•æ±‚æœ€å°ç”Ÿæˆæ ‘">æœ´ç´ ç‰ˆprimç®—æ³• â€”â€” æ¨¡æ¿é¢˜ AcWing 858. Primç®—æ³•æ±‚æœ€å°ç”Ÿæˆæ ‘<a hidden class="anchor" aria-hidden="true" href="#æœ´ç´ ç‰ˆprimç®—æ³•--æ¨¡æ¿é¢˜-acwing-858-primç®—æ³•æ±‚æœ€å°ç”Ÿæˆæ ‘">#</a></h3>
<p>æ—¶é—´å¤æ‚åº¦æ˜¯ O(n^2+m), n è¡¨ç¤ºç‚¹æ•°ï¼Œm è¡¨ç¤ºè¾¹æ•°</p>
<p>åˆå§‹åŒ–è·ç¦»ä¸ºæ­£æ— ç©·ï¼Œè¿­ä»£æ‰€æœ‰ç‚¹ï¼Œæ‰¾åˆ°é›†åˆä¸­æœ€è¿‘çš„ç‚¹ï¼Œæ›´æ–°å®ƒåˆ°<strong>é›†åˆ</strong>çš„è·ç¦»ï¼ŒæŠŠtåŠ åˆ°é›†åˆä¸­ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#66d9ef">int</span> n;      <span style="color:#75715e">// nè¡¨ç¤ºç‚¹æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> g[N][N];        <span style="color:#75715e">// é‚»æ¥çŸ©é˜µï¼Œå­˜å‚¨æ‰€æœ‰è¾¹
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> dist[N];        <span style="color:#75715e">// å­˜å‚¨å…¶ä»–ç‚¹åˆ°å½“å‰æœ€å°ç”Ÿæˆæ ‘çš„è·ç¦»
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">bool</span> st[N];     <span style="color:#75715e">// å­˜å‚¨æ¯ä¸ªç‚¹æ˜¯å¦å·²ç»åœ¨ç”Ÿæˆæ ‘ä¸­
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// å¦‚æœå›¾ä¸è¿é€šï¼Œåˆ™è¿”å›INF(å€¼æ˜¯0x3f3f3f3f), å¦åˆ™è¿”å›æœ€å°ç”Ÿæˆæ ‘çš„æ ‘è¾¹æƒé‡ä¹‹å’Œ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">prim</span>()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    memset(dist, <span style="color:#ae81ff">0x3f</span>, <span style="color:#66d9ef">sizeof</span> dist);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> res <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> n; i <span style="color:#f92672">++</span> )
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> t <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>; j <span style="color:#f92672">&lt;=</span> n; j <span style="color:#f92672">++</span> )
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>st[j] <span style="color:#f92672">&amp;&amp;</span> (t <span style="color:#f92672">==</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span> <span style="color:#f92672">||</span> dist[t] <span style="color:#f92672">&gt;</span> dist[j]))
</span></span><span style="display:flex;"><span>                t <span style="color:#f92672">=</span> j;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (i <span style="color:#f92672">&amp;&amp;</span> dist[t] <span style="color:#f92672">==</span> INF) <span style="color:#66d9ef">return</span> INF;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (i) res <span style="color:#f92672">+=</span> dist[t];
</span></span><span style="display:flex;"><span>        st[t] <span style="color:#f92672">=</span> true;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>; j <span style="color:#f92672">&lt;=</span> n; j <span style="color:#f92672">++</span> ) dist[j] <span style="color:#f92672">=</span> min(dist[j], g[t][j]);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> res;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="kruskalç®—æ³•--æ¨¡æ¿é¢˜-acwing-859-kruskalç®—æ³•æ±‚æœ€å°ç”Ÿæˆæ ‘">Kruskalç®—æ³• â€”â€” æ¨¡æ¿é¢˜ AcWing 859. Kruskalç®—æ³•æ±‚æœ€å°ç”Ÿæˆæ ‘<a hidden class="anchor" aria-hidden="true" href="#kruskalç®—æ³•--æ¨¡æ¿é¢˜-acwing-859-kruskalç®—æ³•æ±‚æœ€å°ç”Ÿæˆæ ‘">#</a></h3>
<p>æ—¶é—´å¤æ‚åº¦æ˜¯ O(mlogm), n è¡¨ç¤ºç‚¹æ•°ï¼Œm è¡¨ç¤ºè¾¹æ•°</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#66d9ef">int</span> n, m;       <span style="color:#75715e">// næ˜¯ç‚¹æ•°ï¼Œmæ˜¯è¾¹æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> p[N];       <span style="color:#75715e">// å¹¶æŸ¥é›†çš„çˆ¶èŠ‚ç‚¹æ•°ç»„
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">struct</span> <span style="color:#a6e22e">Edge</span>     <span style="color:#75715e">// å­˜å‚¨è¾¹
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> a, b, w;
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// é‡è½½å°äºå·è¿ç®—ç¬¦
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// ç”¨äºæ¯”è¾ƒä¸¤ä¸ªEdgeå¯¹è±¡çš„å¤§å°å…³ç³»
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">bool</span> <span style="color:#66d9ef">operator</span> <span style="color:#f92672">&lt;</span> (<span style="color:#66d9ef">const</span> Edge <span style="color:#f92672">&amp;</span>W) <span style="color:#66d9ef">const</span>
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> w <span style="color:#f92672">&lt;</span> W.w; <span style="color:#75715e">// å¦‚æœå½“å‰å¯¹è±¡çš„è¾¹æƒå°äºWå¯¹è±¡çš„è¾¹æƒï¼Œè¿”å›trueï¼Œå¦åˆ™è¿”å›false
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    }
</span></span><span style="display:flex;"><span>}edges[M];
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">find</span>(<span style="color:#66d9ef">int</span> x)     <span style="color:#75715e">// å¹¶æŸ¥é›†æ ¸å¿ƒæ“ä½œ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (p[x] <span style="color:#f92672">!=</span> x) p[x] <span style="color:#f92672">=</span> find(p[x]);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> p[x];
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">kruskal</span>()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    sort(edges, edges <span style="color:#f92672">+</span> m);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>; i <span style="color:#f92672">&lt;=</span> n; i <span style="color:#f92672">++</span> ) p[i] <span style="color:#f92672">=</span> i;    <span style="color:#75715e">// åˆå§‹åŒ–å¹¶æŸ¥é›†
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">int</span> res <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, cnt <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> m; i <span style="color:#f92672">++</span> )
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> a <span style="color:#f92672">=</span> edges[i].a, b <span style="color:#f92672">=</span> edges[i].b, w <span style="color:#f92672">=</span> edges[i].w;
</span></span><span style="display:flex;"><span>        a <span style="color:#f92672">=</span> find(a), b <span style="color:#f92672">=</span> find(b);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (a <span style="color:#f92672">!=</span> b)     <span style="color:#75715e">// å¦‚æœä¸¤ä¸ªè¿é€šå—ä¸è¿é€šï¼Œåˆ™å°†è¿™ä¸¤ä¸ªè¿é€šå—åˆå¹¶
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        {
</span></span><span style="display:flex;"><span>            p[a] <span style="color:#f92672">=</span> b;
</span></span><span style="display:flex;"><span>            res <span style="color:#f92672">+=</span> w;
</span></span><span style="display:flex;"><span>            cnt <span style="color:#f92672">++</span> ;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (cnt <span style="color:#f92672">&lt;</span> n <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>) <span style="color:#66d9ef">return</span> INF;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> res;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="æŸ“è‰²æ³•æœ¬è´¨dfsåˆ¤åˆ«äºŒåˆ†å›¾--æ¨¡æ¿é¢˜-acwing-860-æŸ“è‰²æ³•åˆ¤å®šäºŒåˆ†å›¾">æŸ“è‰²æ³•ï¼ˆæœ¬è´¨dfs)åˆ¤åˆ«äºŒåˆ†å›¾ â€”â€” æ¨¡æ¿é¢˜ AcWing 860. æŸ“è‰²æ³•åˆ¤å®šäºŒåˆ†å›¾<a hidden class="anchor" aria-hidden="true" href="#æŸ“è‰²æ³•æœ¬è´¨dfsåˆ¤åˆ«äºŒåˆ†å›¾--æ¨¡æ¿é¢˜-acwing-860-æŸ“è‰²æ³•åˆ¤å®šäºŒåˆ†å›¾">#</a></h3>
<p><strong>ç»™å®šä¸€ä¸ª n ä¸ªç‚¹mæ¡è¾¹çš„æ— å‘å›¾ï¼Œå›¾ä¸­å¯èƒ½å­˜åœ¨é‡è¾¹å’Œè‡ªç¯ã€‚è¯·ä½ åˆ¤æ–­è¿™ä¸ªå›¾æ˜¯å¦æ˜¯äºŒåˆ†å›¾ã€‚</strong></p>
<p>æ—¶é—´å¤æ‚åº¦æ˜¯ O(n+m), n è¡¨ç¤ºç‚¹æ•°ï¼Œm è¡¨ç¤ºè¾¹æ•°</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#66d9ef">int</span> n;      <span style="color:#75715e">// nè¡¨ç¤ºç‚¹æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> h[N], e[M], ne[M], idx;     <span style="color:#75715e">// é‚»æ¥è¡¨å­˜å‚¨å›¾
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> color[N];       <span style="color:#75715e">// è¡¨ç¤ºæ¯ä¸ªç‚¹çš„é¢œè‰²ï¼Œ-1è¡¨ç¤ºä¸ºæŸ“è‰²ï¼Œ0è¡¨ç¤ºç™½è‰²ï¼Œ1è¡¨ç¤ºé»‘è‰²
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// å‚æ•°ï¼šuè¡¨ç¤ºå½“å‰èŠ‚ç‚¹ï¼Œcè¡¨ç¤ºå½“å‰ç‚¹çš„é¢œè‰²
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">bool</span> <span style="color:#a6e22e">dfs</span>(<span style="color:#66d9ef">int</span> u, <span style="color:#66d9ef">int</span> c)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    color[u] <span style="color:#f92672">=</span> c;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> h[u]; i <span style="color:#f92672">!=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>; i <span style="color:#f92672">=</span> ne[i])
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> e[i];
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (color[j] <span style="color:#f92672">==</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>dfs(j, <span style="color:#f92672">!</span>c)) <span style="color:#66d9ef">return</span> false;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (color[j] <span style="color:#f92672">==</span> c) <span style="color:#66d9ef">return</span> false;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> true;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">bool</span> <span style="color:#a6e22e">check</span>()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    memset(color, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, <span style="color:#66d9ef">sizeof</span> color);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">bool</span> flag <span style="color:#f92672">=</span> true;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>; i <span style="color:#f92672">&lt;=</span> n; i <span style="color:#f92672">++</span> )
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (color[i] <span style="color:#f92672">==</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>dfs(i, <span style="color:#ae81ff">0</span>))
</span></span><span style="display:flex;"><span>            {
</span></span><span style="display:flex;"><span>                flag <span style="color:#f92672">=</span> false;
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> flag;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="åŒˆç‰™åˆ©ç®—æ³•--æ¨¡æ¿é¢˜-acwing-861-äºŒåˆ†å›¾çš„æœ€å¤§åŒ¹é…">åŒˆç‰™åˆ©ç®—æ³• â€”â€” æ¨¡æ¿é¢˜ AcWing 861. äºŒåˆ†å›¾çš„æœ€å¤§åŒ¹é…<a hidden class="anchor" aria-hidden="true" href="#åŒˆç‰™åˆ©ç®—æ³•--æ¨¡æ¿é¢˜-acwing-861-äºŒåˆ†å›¾çš„æœ€å¤§åŒ¹é…">#</a></h3>
<p>æ—¶é—´å¤æ‚åº¦æœ€åæ˜¯ O(nm)ï¼Œå®é™…è¿è¡Œæ—¶é—´ä¸€èˆ¬è¿œå°äºO(nm)ï¼Œ n è¡¨ç¤ºç‚¹æ•°ï¼Œm è¡¨ç¤ºè¾¹æ•°</p>
<p>åšé”™ä¸€ä»¶äº‹ï¼Œé”™è¿‡ä¸€ä»¶äº‹</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#66d9ef">int</span> n1, n2;     <span style="color:#75715e">// n1è¡¨ç¤ºç¬¬ä¸€ä¸ªé›†åˆä¸­çš„ç‚¹æ•°ï¼Œn2è¡¨ç¤ºç¬¬äºŒä¸ªé›†åˆä¸­çš„ç‚¹æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> h[N], e[M], ne[M], idx;     <span style="color:#75715e">// é‚»æ¥è¡¨å­˜å‚¨æ‰€æœ‰è¾¹ï¼ŒåŒˆç‰™åˆ©ç®—æ³•ä¸­åªä¼šç”¨åˆ°ä»ç¬¬äºŒä¸ªé›†åˆæŒ‡å‘ç¬¬ä¸€ä¸ªé›†åˆçš„è¾¹ï¼Œæ‰€ä»¥è¿™é‡Œåªç”¨å­˜ä¸€ä¸ªæ–¹å‘çš„è¾¹
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> match[N];       <span style="color:#75715e">// å­˜å‚¨ç¬¬äºŒä¸ªé›†åˆä¸­çš„æ¯ä¸ªç‚¹å½“å‰åŒ¹é…çš„ç¬¬ä¸€ä¸ªé›†åˆä¸­çš„ç‚¹æ˜¯å“ªä¸ª
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">bool</span> st[N];     <span style="color:#75715e">// è¡¨ç¤ºç¬¬äºŒä¸ªé›†åˆä¸­çš„æ¯ä¸ªç‚¹æ˜¯å¦å·²ç»è¢«éå†è¿‡
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">bool</span> <span style="color:#a6e22e">find</span>(<span style="color:#66d9ef">int</span> x)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> h[x]; i <span style="color:#f92672">!=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>; i <span style="color:#f92672">=</span> ne[i])
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> e[i];
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>st[j])
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            st[j] <span style="color:#f92672">=</span> true;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (match[j] <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">||</span> find(match[j]))
</span></span><span style="display:flex;"><span>            {
</span></span><span style="display:flex;"><span>                match[j] <span style="color:#f92672">=</span> x;
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">return</span> true;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> false;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#75715e">// æ±‚æœ€å¤§åŒ¹é…æ•°ï¼Œä¾æ¬¡æšä¸¾ç¬¬ä¸€ä¸ªé›†åˆä¸­çš„æ¯ä¸ªç‚¹èƒ½å¦åŒ¹é…ç¬¬äºŒä¸ªé›†åˆä¸­çš„ç‚¹
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> res <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>; i <span style="color:#f92672">&lt;=</span> n1; i <span style="color:#f92672">++</span> )
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    memset(st, false, <span style="color:#66d9ef">sizeof</span> st);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (find(i)) res <span style="color:#f92672">++</span> ;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>ä½œè€…ï¼šyxc
é“¾æ¥ï¼šhttps://www.acwing.com/blog/content/405/
æ¥æºï¼šAcWing
è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p>
<h2 id="ç¬¬å››ç« ">ç¬¬å››ç« <a hidden class="anchor" aria-hidden="true" href="#ç¬¬å››ç« ">#</a></h2>
<h3 id="è¯•é™¤æ³•åˆ¤å®šè´¨æ•°--æ¨¡æ¿é¢˜-acwing-866-è¯•é™¤æ³•åˆ¤å®šè´¨æ•°">è¯•é™¤æ³•åˆ¤å®šè´¨æ•° â€”â€” æ¨¡æ¿é¢˜ AcWing 866. è¯•é™¤æ³•åˆ¤å®šè´¨æ•°<a hidden class="anchor" aria-hidden="true" href="#è¯•é™¤æ³•åˆ¤å®šè´¨æ•°--æ¨¡æ¿é¢˜-acwing-866-è¯•é™¤æ³•åˆ¤å®šè´¨æ•°">#</a></h3>
<p>è´¨æ•°ï¼šå¤§äº1çš„æ•´æ•°ä¸­ï¼Œå¦‚æœåªåŒ…å«1å’Œæœ¬èº«ä¸¤ä¸ªçº¦æŸï¼Œç§°ä¸ºè´¨æ•°ï¼ˆç´ æ•°ï¼‰</p>
<p>ï¼ˆ1ï¼‰åˆ¤å®šï¼Œè¯•é™¤æ³•</p>
<p>ï¼ˆ2ï¼‰åˆ†è§£è´¨å› æ•°</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#66d9ef">bool</span> <span style="color:#a6e22e">is_prime</span>(<span style="color:#66d9ef">int</span> x)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (x <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">2</span>) <span style="color:#66d9ef">return</span> false;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>; i <span style="color:#f92672">&lt;=</span> x <span style="color:#f92672">/</span> i; i <span style="color:#f92672">++</span> )
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (x <span style="color:#f92672">%</span> i <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> false;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> true;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="è¯•é™¤æ³•åˆ†è§£è´¨å› æ•°--æ¨¡æ¿é¢˜-acwing-867-åˆ†è§£è´¨å› æ•°">è¯•é™¤æ³•åˆ†è§£è´¨å› æ•° â€”â€” æ¨¡æ¿é¢˜ AcWing 867. åˆ†è§£è´¨å› æ•°<a hidden class="anchor" aria-hidden="true" href="#è¯•é™¤æ³•åˆ†è§£è´¨å› æ•°--æ¨¡æ¿é¢˜-acwing-867-åˆ†è§£è´¨å› æ•°">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">divide</span>(<span style="color:#66d9ef">int</span> x)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>; i <span style="color:#f92672">&lt;=</span> x <span style="color:#f92672">/</span> i; i <span style="color:#f92672">++</span> )
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (x <span style="color:#f92672">%</span> i <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> s <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">while</span> (x <span style="color:#f92672">%</span> i <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>) x <span style="color:#f92672">/=</span> i, s <span style="color:#f92672">++</span> ;
</span></span><span style="display:flex;"><span>            cout <span style="color:#f92672">&lt;&lt;</span> i <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#39; &#39;</span> <span style="color:#f92672">&lt;&lt;</span> s <span style="color:#f92672">&lt;&lt;</span> endl;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (x <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">1</span>) cout <span style="color:#f92672">&lt;&lt;</span> x <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#39; &#39;</span> <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">&lt;&lt;</span> endl;
</span></span><span style="display:flex;"><span>    cout <span style="color:#f92672">&lt;&lt;</span> endl;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="æœ´ç´ ç­›æ³•æ±‚ç´ æ•°--æ¨¡æ¿é¢˜-acwing-868-ç­›è´¨æ•°">æœ´ç´ ç­›æ³•æ±‚ç´ æ•° â€”â€” æ¨¡æ¿é¢˜ AcWing 868. ç­›è´¨æ•°<a hidden class="anchor" aria-hidden="true" href="#æœ´ç´ ç­›æ³•æ±‚ç´ æ•°--æ¨¡æ¿é¢˜-acwing-868-ç­›è´¨æ•°">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#66d9ef">int</span> primes[N], cnt;     <span style="color:#75715e">// primes[]å­˜å‚¨æ‰€æœ‰ç´ æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">bool</span> st[N];         <span style="color:#75715e">// st[x]å­˜å‚¨xæ˜¯å¦è¢«ç­›æ‰
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">get_primes</span>(<span style="color:#66d9ef">int</span> n)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>; i <span style="color:#f92672">&lt;=</span> n; i <span style="color:#f92672">++</span> )
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (st[i]) <span style="color:#66d9ef">continue</span>;
</span></span><span style="display:flex;"><span>        primes[cnt <span style="color:#f92672">++</span> ] <span style="color:#f92672">=</span> i;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> i; j <span style="color:#f92672">&lt;=</span> n; j <span style="color:#f92672">+=</span> i)
</span></span><span style="display:flex;"><span>            st[j] <span style="color:#f92672">=</span> true;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="çº¿æ€§ç­›æ³•æ±‚ç´ æ•°--æ¨¡æ¿é¢˜-acwing-868-ç­›è´¨æ•°">çº¿æ€§ç­›æ³•æ±‚ç´ æ•° â€”â€” æ¨¡æ¿é¢˜ AcWing 868. ç­›è´¨æ•°<a hidden class="anchor" aria-hidden="true" href="#çº¿æ€§ç­›æ³•æ±‚ç´ æ•°--æ¨¡æ¿é¢˜-acwing-868-ç­›è´¨æ•°">#</a></h3>
<p>è¢«æœ€å°è´¨å› å­ç­›æ‰</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#66d9ef">int</span> primes[N], cnt;     <span style="color:#75715e">// primes[]å­˜å‚¨æ‰€æœ‰ç´ æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">bool</span> st[N];         <span style="color:#75715e">// st[x]å­˜å‚¨xæ˜¯å¦è¢«ç­›æ‰
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">get_primes</span>(<span style="color:#66d9ef">int</span> n)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>; i <span style="color:#f92672">&lt;=</span> n; i <span style="color:#f92672">++</span> )
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>st[i]) primes[cnt <span style="color:#f92672">++</span> ] <span style="color:#f92672">=</span> i;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; primes[j] <span style="color:#f92672">&lt;=</span> n <span style="color:#f92672">/</span> i; j <span style="color:#f92672">++</span> )
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            st[primes[j] <span style="color:#f92672">*</span> i] <span style="color:#f92672">=</span> true;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (i <span style="color:#f92672">%</span> primes[j] <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>) <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="è¯•é™¤æ³•æ±‚æ‰€æœ‰çº¦æ•°--æ¨¡æ¿é¢˜-acwing-869-è¯•é™¤æ³•æ±‚çº¦æ•°">è¯•é™¤æ³•æ±‚æ‰€æœ‰çº¦æ•° â€”â€” æ¨¡æ¿é¢˜ AcWing 869. è¯•é™¤æ³•æ±‚çº¦æ•°<a hidden class="anchor" aria-hidden="true" href="#è¯•é™¤æ³•æ±‚æ‰€æœ‰çº¦æ•°--æ¨¡æ¿é¢˜-acwing-869-è¯•é™¤æ³•æ±‚çº¦æ•°">#</a></h3>
<p>intèŒƒå›´å†…çº¦æ•°ä¸ªæ•°æœ€å¤šä¸º1500ä¸ªå·¦å³</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span>vector<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span> get_divisors(<span style="color:#66d9ef">int</span> x)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    vector<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span> res;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>; i <span style="color:#f92672">&lt;=</span> x <span style="color:#f92672">/</span> i; i <span style="color:#f92672">++</span> )
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (x <span style="color:#f92672">%</span> i <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            res.push_back(i);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (i <span style="color:#f92672">!=</span> x <span style="color:#f92672">/</span> i) res.push_back(x <span style="color:#f92672">/</span> i);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    sort(res.begin(), res.end());
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> res;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="çº¦æ•°ä¸ªæ•°å’Œçº¦æ•°ä¹‹å’Œ--æ¨¡æ¿é¢˜-acwing-870-çº¦æ•°ä¸ªæ•°-acwing-871-çº¦æ•°ä¹‹å’Œ">çº¦æ•°ä¸ªæ•°å’Œçº¦æ•°ä¹‹å’Œ â€”â€” æ¨¡æ¿é¢˜ AcWing 870. çº¦æ•°ä¸ªæ•°, AcWing 871. çº¦æ•°ä¹‹å’Œ<a hidden class="anchor" aria-hidden="true" href="#çº¦æ•°ä¸ªæ•°å’Œçº¦æ•°ä¹‹å’Œ--æ¨¡æ¿é¢˜-acwing-870-çº¦æ•°ä¸ªæ•°-acwing-871-çº¦æ•°ä¹‹å’Œ">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">å¦‚æœ</span> N <span style="color:#f92672">=</span> p1<span style="color:#f92672">^</span>c1 <span style="color:#f92672">*</span> p2<span style="color:#f92672">^</span>c2 <span style="color:#f92672">*</span> ... <span style="color:#f92672">*</span>pk<span style="color:#f92672">^</span>ck
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">çº¦æ•°ä¸ªæ•°ï¼š</span> (c1 <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">*</span> (c2 <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">*</span> ... <span style="color:#f92672">*</span> (ck <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">çº¦æ•°ä¹‹å’Œï¼š</span> (p1<span style="color:#f92672">^</span><span style="color:#ae81ff">0</span> <span style="color:#f92672">+</span> p1<span style="color:#f92672">^</span><span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> ... <span style="color:#f92672">+</span> p1<span style="color:#f92672">^</span>c1) <span style="color:#f92672">*</span> ... <span style="color:#f92672">*</span> (pk<span style="color:#f92672">^</span><span style="color:#ae81ff">0</span> <span style="color:#f92672">+</span> pk<span style="color:#f92672">^</span><span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> ... <span style="color:#f92672">+</span> pk<span style="color:#f92672">^</span>ck)
</span></span></code></pre></div><h3 id="æ¬§å‡ é‡Œå¾—ç®—æ³•--æ¨¡æ¿é¢˜-acwing-872-æœ€å¤§å…¬çº¦æ•°">æ¬§å‡ é‡Œå¾—ç®—æ³• â€”â€” æ¨¡æ¿é¢˜ AcWing 872. æœ€å¤§å…¬çº¦æ•°<a hidden class="anchor" aria-hidden="true" href="#æ¬§å‡ é‡Œå¾—ç®—æ³•--æ¨¡æ¿é¢˜-acwing-872-æœ€å¤§å…¬çº¦æ•°">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">gcd</span>(<span style="color:#66d9ef">int</span> a, <span style="color:#66d9ef">int</span> b)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> b <span style="color:#f92672">?</span> gcd(b, a <span style="color:#f92672">%</span> b) <span style="color:#f92672">:</span> a;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="æ±‚æ¬§æ‹‰å‡½æ•°--æ¨¡æ¿é¢˜-acwing-873-æ¬§æ‹‰å‡½æ•°">æ±‚æ¬§æ‹‰å‡½æ•° â€”â€” æ¨¡æ¿é¢˜ AcWing 873. æ¬§æ‹‰å‡½æ•°<a hidden class="anchor" aria-hidden="true" href="#æ±‚æ¬§æ‹‰å‡½æ•°--æ¨¡æ¿é¢˜-acwing-873-æ¬§æ‹‰å‡½æ•°">#</a></h3>
<p>æ¬§æ‹‰å‡½æ•°å…¬å¼ï¼ˆå®¹æ–¥åŸç†) : n*(1-p1)*(1-p2)&hellip;(1-pk)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">phi</span>(<span style="color:#66d9ef">int</span> x)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> res <span style="color:#f92672">=</span> x;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>; i <span style="color:#f92672">&lt;=</span> x <span style="color:#f92672">/</span> i; i <span style="color:#f92672">++</span> )
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (x <span style="color:#f92672">%</span> i <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            res <span style="color:#f92672">=</span> res <span style="color:#f92672">/</span> i <span style="color:#f92672">*</span> (i <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">while</span> (x <span style="color:#f92672">%</span> i <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>) x <span style="color:#f92672">/=</span> i;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (x <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">1</span>) res <span style="color:#f92672">=</span> res <span style="color:#f92672">/</span> x <span style="color:#f92672">*</span> (x <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> res;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="ç­›æ³•æ±‚æ¬§æ‹‰å‡½æ•°--æ¨¡æ¿é¢˜-acwing-874-ç­›æ³•æ±‚æ¬§æ‹‰å‡½æ•°">ç­›æ³•æ±‚æ¬§æ‹‰å‡½æ•° â€”â€” æ¨¡æ¿é¢˜ AcWing 874. ç­›æ³•æ±‚æ¬§æ‹‰å‡½æ•°<a hidden class="anchor" aria-hidden="true" href="#ç­›æ³•æ±‚æ¬§æ‹‰å‡½æ•°--æ¨¡æ¿é¢˜-acwing-874-ç­›æ³•æ±‚æ¬§æ‹‰å‡½æ•°">#</a></h3>
<p>O(n) çº¿æ€§æ±‚æ‰€æœ‰æ•°çš„æ¬§æ‹‰å‡½æ•°</p>
<p>åº”ç”¨ï¼šæ¬§æ‹‰å®šç†ï¼šaä¸näº’è´¨   a^Ï†(n)=1(mod n)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#66d9ef">int</span> primes[N], cnt;     <span style="color:#75715e">// primes[]å­˜å‚¨æ‰€æœ‰ç´ æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> euler[N];           <span style="color:#75715e">// å­˜å‚¨æ¯ä¸ªæ•°çš„æ¬§æ‹‰å‡½æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">bool</span> st[N];         <span style="color:#75715e">// st[x]å­˜å‚¨xæ˜¯å¦è¢«ç­›æ‰
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">get_eulers</span>(<span style="color:#66d9ef">int</span> n)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    euler[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>; i <span style="color:#f92672">&lt;=</span> n; i <span style="color:#f92672">++</span> )
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>st[i])
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            primes[cnt <span style="color:#f92672">++</span> ] <span style="color:#f92672">=</span> i;
</span></span><span style="display:flex;"><span>            euler[i] <span style="color:#f92672">=</span> i <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; primes[j] <span style="color:#f92672">&lt;=</span> n <span style="color:#f92672">/</span> i; j <span style="color:#f92672">++</span> )
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> t <span style="color:#f92672">=</span> primes[j] <span style="color:#f92672">*</span> i;
</span></span><span style="display:flex;"><span>            st[t] <span style="color:#f92672">=</span> true;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (i <span style="color:#f92672">%</span> primes[j] <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>            {
</span></span><span style="display:flex;"><span>                euler[t] <span style="color:#f92672">=</span> euler[i] <span style="color:#f92672">*</span> primes[j];
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            euler[t] <span style="color:#f92672">=</span> euler[i] <span style="color:#f92672">*</span> (primes[j] <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="å¿«é€Ÿå¹‚--æ¨¡æ¿é¢˜-acwing-875-å¿«é€Ÿå¹‚">å¿«é€Ÿå¹‚ â€”â€” æ¨¡æ¿é¢˜ AcWing 875. å¿«é€Ÿå¹‚<a hidden class="anchor" aria-hidden="true" href="#å¿«é€Ÿå¹‚--æ¨¡æ¿é¢˜-acwing-875-å¿«é€Ÿå¹‚">#</a></h3>
<p>æ±‚ m^k mod pï¼Œæ—¶é—´å¤æ‚åº¦ O(logk)ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">qmi</span>(<span style="color:#66d9ef">int</span> m, <span style="color:#66d9ef">int</span> k, <span style="color:#66d9ef">int</span> p)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> res <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">%</span> p, t <span style="color:#f92672">=</span> m;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> (k)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (k<span style="color:#f92672">&amp;</span><span style="color:#ae81ff">1</span>) res <span style="color:#f92672">=</span> res <span style="color:#f92672">*</span> t <span style="color:#f92672">%</span> p;
</span></span><span style="display:flex;"><span>        t <span style="color:#f92672">=</span> t <span style="color:#f92672">*</span> t <span style="color:#f92672">%</span> p;
</span></span><span style="display:flex;"><span>        k <span style="color:#f92672">&gt;&gt;=</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> res;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•--æ¨¡æ¿é¢˜-acwing-877-æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•">æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³• â€”â€” æ¨¡æ¿é¢˜ AcWing 877. æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•<a hidden class="anchor" aria-hidden="true" href="#æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•--æ¨¡æ¿é¢˜-acwing-877-æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#75715e">// æ±‚x, yï¼Œä½¿å¾—ax + by = gcd(a, b)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">exgcd</span>(<span style="color:#66d9ef">int</span> a, <span style="color:#66d9ef">int</span> b, <span style="color:#66d9ef">int</span> <span style="color:#f92672">&amp;</span>x, <span style="color:#66d9ef">int</span> <span style="color:#f92672">&amp;</span>y)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>b)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        x <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>; y <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> a;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> d <span style="color:#f92672">=</span> exgcd(b, a <span style="color:#f92672">%</span> b, y, x);
</span></span><span style="display:flex;"><span>    y <span style="color:#f92672">-=</span> (a<span style="color:#f92672">/</span>b) <span style="color:#f92672">*</span> x;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> d;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="é«˜æ–¯æ¶ˆå…ƒ--æ¨¡æ¿é¢˜-acwing-883-é«˜æ–¯æ¶ˆå…ƒè§£çº¿æ€§æ–¹ç¨‹ç»„">é«˜æ–¯æ¶ˆå…ƒ â€”â€” æ¨¡æ¿é¢˜ AcWing 883. é«˜æ–¯æ¶ˆå…ƒè§£çº¿æ€§æ–¹ç¨‹ç»„<a hidden class="anchor" aria-hidden="true" href="#é«˜æ–¯æ¶ˆå…ƒ--æ¨¡æ¿é¢˜-acwing-883-é«˜æ–¯æ¶ˆå…ƒè§£çº¿æ€§æ–¹ç¨‹ç»„">#</a></h3>
<p>O(n^3)æ—¶é—´å†…è§£nä¸ªæ–¹ç¨‹nä¸ªæœªçŸ¥æ•°çš„è§£ã€‚</p>
<p>è§£ï¼šæ— è§£ ï¼› æ— ç©·å¤šç»„è§£ ï¼› å”¯ä¸€è§£ ï¼›</p>
<ul>
<li>å®Œç¾é˜¶æ¢¯å‹ï¼šå”¯ä¸€è§£</li>
<li>*0=*éé›¶ ï¼š *<em>æ— è§£</em></li>
<li>0=0 ï¼š æ— ç©·å¤šç»„è§£</li>
</ul>
<p>é«˜æ–¯æ¶ˆå…ƒï¼š</p>
<p>æšä¸¾æ¯ä¸€åˆ—cï¼š</p>
<ol>
<li>æ‰¾åˆ°ç»å¯¹å€¼æœ€å¤§çš„ä¸€è¡Œ</li>
<li>å°†è¯¥è¡Œæ¢åˆ°æœ€ä¸Šé¢</li>
<li>å°†è¯¥è¡Œç¬¬ä¸€ä¸ªæ•°å˜æˆ1</li>
<li>å°†ä¸‹é¢æ‰€æœ‰è¡Œçš„ç¬¬cåˆ—æ¶ˆæˆ0</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#75715e">// a[N][N]æ˜¯å¢å¹¿çŸ©é˜µ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">gauss</span>()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> c, r;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (c <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, r <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; c <span style="color:#f92672">&lt;</span> n; c <span style="color:#f92672">++</span> )
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> t <span style="color:#f92672">=</span> r;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> r; i <span style="color:#f92672">&lt;</span> n; i <span style="color:#f92672">++</span> )   <span style="color:#75715e">// æ‰¾åˆ°ç»å¯¹å€¼æœ€å¤§çš„è¡Œ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            <span style="color:#66d9ef">if</span> (fabs(a[i][c]) <span style="color:#f92672">&gt;</span> fabs(a[t][c]))
</span></span><span style="display:flex;"><span>                t <span style="color:#f92672">=</span> i;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (fabs(a[t][c]) <span style="color:#f92672">&lt;</span> eps) <span style="color:#66d9ef">continue</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> c; i <span style="color:#f92672">&lt;=</span> n; i <span style="color:#f92672">++</span> ) swap(a[t][i], a[r][i]);      <span style="color:#75715e">// å°†ç»å¯¹å€¼æœ€å¤§çš„è¡Œæ¢åˆ°æœ€é¡¶ç«¯
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> n; i <span style="color:#f92672">&gt;=</span> c; i <span style="color:#f92672">--</span> ) a[r][i] <span style="color:#f92672">/=</span> a[r][c];      <span style="color:#75715e">// å°†å½“å‰ä¸Šçš„é¦–ä½å˜æˆ1
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> r <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>; i <span style="color:#f92672">&lt;</span> n; i <span style="color:#f92672">++</span> )       <span style="color:#75715e">// ç”¨å½“å‰è¡Œå°†ä¸‹é¢æ‰€æœ‰çš„åˆ—æ¶ˆæˆ0
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            <span style="color:#66d9ef">if</span> (fabs(a[i][c]) <span style="color:#f92672">&gt;</span> eps)
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> n; j <span style="color:#f92672">&gt;=</span> c; j <span style="color:#f92672">--</span> )
</span></span><span style="display:flex;"><span>                    a[i][j] <span style="color:#f92672">-=</span> a[r][j] <span style="color:#f92672">*</span> a[i][c];
</span></span><span style="display:flex;"><span>        r <span style="color:#f92672">++</span> ;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (r <span style="color:#f92672">&lt;</span> n)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> r; i <span style="color:#f92672">&lt;</span> n; i <span style="color:#f92672">++</span> )
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (fabs(a[i][n]) <span style="color:#f92672">&gt;</span> eps)
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">2</span>; <span style="color:#75715e">// æ— è§£
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span>; <span style="color:#75715e">// æœ‰æ— ç©·å¤šç»„è§£
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> n <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>; i <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">--</span> )
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> i <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>; j <span style="color:#f92672">&lt;</span> n; j <span style="color:#f92672">++</span> )
</span></span><span style="display:flex;"><span>            a[i][n] <span style="color:#f92672">-=</span> a[i][j] <span style="color:#f92672">*</span> a[j][n];
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>; <span style="color:#75715e">// æœ‰å”¯ä¸€è§£
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span></code></pre></div><h3 id="é€’å½’æ³•æ±‚ç»„åˆæ•°--æ¨¡æ¿é¢˜-acwing-885-æ±‚ç»„åˆæ•°-i">é€’å½’æ³•æ±‚ç»„åˆæ•° â€”â€” æ¨¡æ¿é¢˜ <em>AcWing</em> 885. æ±‚ç»„åˆæ•° I<a hidden class="anchor" aria-hidden="true" href="#é€’å½’æ³•æ±‚ç»„åˆæ•°--æ¨¡æ¿é¢˜-acwing-885-æ±‚ç»„åˆæ•°-i">#</a></h3>
<p>åä¸‡ 1&lt;b&lt;a&lt;2000 O(n^2)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#75715e">// c[a][b] è¡¨ç¤ºä»aä¸ªè‹¹æœä¸­é€‰bä¸ªçš„æ–¹æ¡ˆæ•°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> N; i <span style="color:#f92672">++</span> )
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; j <span style="color:#f92672">&lt;=</span> i; j <span style="color:#f92672">++</span> )
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>j) c[i][j] <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span> c[i][j] <span style="color:#f92672">=</span> (c[i <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>][j] <span style="color:#f92672">+</span> c[i <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>][j <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>]) <span style="color:#f92672">%</span> mod;
</span></span></code></pre></div><h3 id="é€šè¿‡é¢„å¤„ç†é€†å…ƒçš„æ–¹å¼æ±‚ç»„åˆæ•°--æ¨¡æ¿é¢˜-acwing-886-æ±‚ç»„åˆæ•°-ii">é€šè¿‡é¢„å¤„ç†é€†å…ƒçš„æ–¹å¼æ±‚ç»„åˆæ•° â€”â€” æ¨¡æ¿é¢˜ AcWing 886. æ±‚ç»„åˆæ•° II<a hidden class="anchor" aria-hidden="true" href="#é€šè¿‡é¢„å¤„ç†é€†å…ƒçš„æ–¹å¼æ±‚ç»„åˆæ•°--æ¨¡æ¿é¢˜-acwing-886-æ±‚ç»„åˆæ•°-ii">#</a></h3>
<p>ä¸€ä¸‡ 1&lt;b&lt;a&lt;10^5 O(logn)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">é¦–å…ˆé¢„å¤„ç†å‡ºæ‰€æœ‰é˜¶ä¹˜å–æ¨¡çš„ä½™æ•°</span>fact[N]<span style="color:#960050;background-color:#1e0010">ï¼Œä»¥åŠæ‰€æœ‰é˜¶ä¹˜å–æ¨¡çš„é€†å…ƒ</span>infact[N]
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">å¦‚æœå–æ¨¡çš„æ•°æ˜¯è´¨æ•°ï¼Œå¯ä»¥ç”¨è´¹é©¬å°å®šç†æ±‚é€†å…ƒ</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> qmi(<span style="color:#66d9ef">int</span> a, <span style="color:#66d9ef">int</span> k, <span style="color:#66d9ef">int</span> p)    <span style="color:#75715e">// å¿«é€Ÿå¹‚æ¨¡æ¿
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> res <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> (k)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (k <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">1</span>) res <span style="color:#f92672">=</span> (LL)res <span style="color:#f92672">*</span> a <span style="color:#f92672">%</span> p;
</span></span><span style="display:flex;"><span>        a <span style="color:#f92672">=</span> (LL)a <span style="color:#f92672">*</span> a <span style="color:#f92672">%</span> p;
</span></span><span style="display:flex;"><span>        k <span style="color:#f92672">&gt;&gt;=</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> res;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#75715e">// é¢„å¤„ç†é˜¶ä¹˜çš„ä½™æ•°å’Œé˜¶ä¹˜é€†å…ƒçš„ä½™æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>fact[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">=</span> infact[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>; i <span style="color:#f92672">&lt;</span> N; i <span style="color:#f92672">++</span> )
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    fact[i] <span style="color:#f92672">=</span> (LL)fact[i <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>] <span style="color:#f92672">*</span> i <span style="color:#f92672">%</span> mod;
</span></span><span style="display:flex;"><span>    infact[i] <span style="color:#f92672">=</span> (LL)infact[i <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>] <span style="color:#f92672">*</span> qmi(i, mod <span style="color:#f92672">-</span> <span style="color:#ae81ff">2</span>, mod) <span style="color:#f92672">%</span> mod;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>ll <span style="color:#a6e22e">C</span>(ll n,ll m){
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span>(m<span style="color:#f92672">&gt;</span>n) <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0ll</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> fact[n]<span style="color:#f92672">*</span>infact[m]<span style="color:#f92672">%</span>mod<span style="color:#f92672">*</span>infact[n<span style="color:#f92672">-</span>m]<span style="color:#f92672">%</span>mod;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="lucaså®šç†--æ¨¡æ¿é¢˜-acwing-887-æ±‚ç»„åˆæ•°-iii"><em>Lucas</em>å®šç† â€”â€” æ¨¡æ¿é¢˜ AcWing 887. æ±‚ç»„åˆæ•° III<a hidden class="anchor" aria-hidden="true" href="#lucaså®šç†--æ¨¡æ¿é¢˜-acwing-887-æ±‚ç»„åˆæ•°-iii">#</a></h3>
<p>ç»„åˆæ•°ï¼Œ1&lt;b&lt;a</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">è‹¥</span>pæ˜¯è´¨æ•°<span style="color:#960050;background-color:#1e0010">ï¼Œåˆ™å¯¹äºä»»æ„æ•´æ•°</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">&lt;=</span> m <span style="color:#f92672">&lt;=</span> n<span style="color:#960050;background-color:#1e0010">ï¼Œæœ‰ï¼š</span>
</span></span><span style="display:flex;"><span>    C(n, m) <span style="color:#f92672">=</span> C(n <span style="color:#f92672">%</span> p, m <span style="color:#f92672">%</span> p) <span style="color:#f92672">*</span> C(n <span style="color:#f92672">/</span> p, m <span style="color:#f92672">/</span> p) (mod p)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> qmi(<span style="color:#66d9ef">int</span> a, <span style="color:#66d9ef">int</span> k)       <span style="color:#75715e">// å¿«é€Ÿå¹‚æ¨¡æ¿
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> res <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> (k)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (k <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">1</span>) res <span style="color:#f92672">=</span> (LL)res <span style="color:#f92672">*</span> a <span style="color:#f92672">%</span> p;
</span></span><span style="display:flex;"><span>        a <span style="color:#f92672">=</span> (LL)a <span style="color:#f92672">*</span> a <span style="color:#f92672">%</span> p;
</span></span><span style="display:flex;"><span>        k <span style="color:#f92672">&gt;&gt;=</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> res;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">C</span>(<span style="color:#66d9ef">int</span> a, <span style="color:#66d9ef">int</span> b)     <span style="color:#75715e">// é€šè¿‡å®šç†æ±‚ç»„åˆæ•°C(a, b)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> res <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>, j <span style="color:#f92672">=</span> a; i <span style="color:#f92672">&lt;=</span> b; i <span style="color:#f92672">++</span>, j <span style="color:#f92672">--</span> )
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        res <span style="color:#f92672">=</span> (LL)res <span style="color:#f92672">*</span> j <span style="color:#f92672">%</span> p;
</span></span><span style="display:flex;"><span>        res <span style="color:#f92672">=</span> (LL)res <span style="color:#f92672">*</span> qmi(i, p <span style="color:#f92672">-</span> <span style="color:#ae81ff">2</span>) <span style="color:#f92672">%</span> p;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> res;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">lucas</span>(LL a, LL b)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (a <span style="color:#f92672">&lt;</span> p <span style="color:#f92672">&amp;&amp;</span> b <span style="color:#f92672">&lt;</span> p) <span style="color:#66d9ef">return</span> C(a, b);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> (LL)C(a <span style="color:#f92672">%</span> p, b <span style="color:#f92672">%</span> p) <span style="color:#f92672">*</span> lucas(a <span style="color:#f92672">/</span> p, b <span style="color:#f92672">/</span> p) <span style="color:#f92672">%</span> p;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="åˆ†è§£è´¨å› æ•°æ³•æ±‚ç»„åˆæ•°--æ¨¡æ¿é¢˜-acwing-888-æ±‚ç»„åˆæ•°-iv">åˆ†è§£è´¨å› æ•°æ³•æ±‚ç»„åˆæ•° â€”â€” æ¨¡æ¿é¢˜ AcWing 888. æ±‚ç»„åˆæ•° IV<a hidden class="anchor" aria-hidden="true" href="#åˆ†è§£è´¨å› æ•°æ³•æ±‚ç»„åˆæ•°--æ¨¡æ¿é¢˜-acwing-888-æ±‚ç»„åˆæ•°-iv">#</a></h3>
<p>å½“æˆ‘ä»¬éœ€è¦æ±‚å‡ºç»„åˆæ•°çš„çœŸå®å€¼ï¼Œè€Œéå¯¹æŸä¸ªæ•°çš„ä½™æ•°æ—¶ï¼Œåˆ†è§£è´¨å› æ•°çš„æ–¹å¼æ¯”è¾ƒå¥½ç”¨ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#ae81ff">1.</span> <span style="color:#960050;background-color:#1e0010">ç­›æ³•æ±‚å‡ºèŒƒå›´å†…çš„æ‰€æœ‰è´¨æ•°</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2.</span> <span style="color:#960050;background-color:#1e0010">é€šè¿‡</span> C(a, b) <span style="color:#f92672">=</span> a<span style="color:#f92672">!</span> <span style="color:#f92672">/</span> b<span style="color:#f92672">!</span> <span style="color:#f92672">/</span> (a <span style="color:#f92672">-</span> b)<span style="color:#f92672">!</span> <span style="color:#960050;background-color:#1e0010">è¿™ä¸ªå…¬å¼æ±‚å‡ºæ¯ä¸ªè´¨å› å­çš„æ¬¡æ•°ã€‚</span> n<span style="color:#f92672">!</span> <span style="color:#960050;background-color:#1e0010">ä¸­</span>pçš„æ¬¡æ•°æ˜¯ n <span style="color:#f92672">/</span> p <span style="color:#f92672">+</span> n <span style="color:#f92672">/</span> p<span style="color:#f92672">^</span><span style="color:#ae81ff">2</span> <span style="color:#f92672">+</span> n <span style="color:#f92672">/</span> p<span style="color:#f92672">^</span><span style="color:#ae81ff">3</span> <span style="color:#f92672">+</span> ...
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3.</span> <span style="color:#960050;background-color:#1e0010">ç”¨é«˜ç²¾åº¦ä¹˜æ³•å°†æ‰€æœ‰è´¨å› å­ç›¸ä¹˜</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> primes[N], cnt;     <span style="color:#75715e">// å­˜å‚¨æ‰€æœ‰è´¨æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> sum[N];     <span style="color:#75715e">// å­˜å‚¨æ¯ä¸ªè´¨æ•°çš„æ¬¡æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">bool</span> st[N];     <span style="color:#75715e">// å­˜å‚¨æ¯ä¸ªæ•°æ˜¯å¦å·²è¢«ç­›æ‰
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">get_primes</span>(<span style="color:#66d9ef">int</span> n)      <span style="color:#75715e">// çº¿æ€§ç­›æ³•æ±‚ç´ æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>; i <span style="color:#f92672">&lt;=</span> n; i <span style="color:#f92672">++</span> )
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>st[i]) primes[cnt <span style="color:#f92672">++</span> ] <span style="color:#f92672">=</span> i;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; primes[j] <span style="color:#f92672">&lt;=</span> n <span style="color:#f92672">/</span> i; j <span style="color:#f92672">++</span> )
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            st[primes[j] <span style="color:#f92672">*</span> i] <span style="color:#f92672">=</span> true;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (i <span style="color:#f92672">%</span> primes[j] <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>) <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">get</span>(<span style="color:#66d9ef">int</span> n, <span style="color:#66d9ef">int</span> p)       <span style="color:#75715e">// æ±‚nï¼ä¸­çš„æ¬¡æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> res <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> (n)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        res <span style="color:#f92672">+=</span> n <span style="color:#f92672">/</span> p;
</span></span><span style="display:flex;"><span>        n <span style="color:#f92672">/=</span> p;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> res;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>vector<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span> mul(vector<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span> a, <span style="color:#66d9ef">int</span> b)       <span style="color:#75715e">// é«˜ç²¾åº¦ä¹˜ä½ç²¾åº¦æ¨¡æ¿
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>{
</span></span><span style="display:flex;"><span>    vector<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span> c;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> t <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> a.size(); i <span style="color:#f92672">++</span> )
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        t <span style="color:#f92672">+=</span> a[i] <span style="color:#f92672">*</span> b;
</span></span><span style="display:flex;"><span>        c.push_back(t <span style="color:#f92672">%</span> <span style="color:#ae81ff">10</span>);
</span></span><span style="display:flex;"><span>        t <span style="color:#f92672">/=</span> <span style="color:#ae81ff">10</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> (t)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        c.push_back(t <span style="color:#f92672">%</span> <span style="color:#ae81ff">10</span>);
</span></span><span style="display:flex;"><span>        t <span style="color:#f92672">/=</span> <span style="color:#ae81ff">10</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> c;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>get_primes(a);  <span style="color:#75715e">// é¢„å¤„ç†èŒƒå›´å†…çš„æ‰€æœ‰è´¨æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> cnt; i <span style="color:#f92672">++</span> )     <span style="color:#75715e">// æ±‚æ¯ä¸ªè´¨å› æ•°çš„æ¬¡æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> p <span style="color:#f92672">=</span> primes[i];
</span></span><span style="display:flex;"><span>    sum[i] <span style="color:#f92672">=</span> get(a, p) <span style="color:#f92672">-</span> get(b, p) <span style="color:#f92672">-</span> get(a <span style="color:#f92672">-</span> b, p);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>vector<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span> res;
</span></span><span style="display:flex;"><span>res.push_back(<span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> cnt; i <span style="color:#f92672">++</span> )     <span style="color:#75715e">// ç”¨é«˜ç²¾åº¦ä¹˜æ³•å°†æ‰€æœ‰è´¨å› å­ç›¸ä¹˜
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; j <span style="color:#f92672">&lt;</span> sum[i]; j <span style="color:#f92672">++</span> )
</span></span><span style="display:flex;"><span>        res <span style="color:#f92672">=</span> mul(res, primes[i]);
</span></span></code></pre></div><h3 id="å¡ç‰¹å…°æ•°--æ¨¡æ¿é¢˜-acwing-889-æ»¡è¶³æ¡ä»¶çš„01åºåˆ—">å¡ç‰¹å…°æ•° â€”â€” æ¨¡æ¿é¢˜ AcWing 889. æ»¡è¶³æ¡ä»¶çš„01åºåˆ—<a hidden class="anchor" aria-hidden="true" href="#å¡ç‰¹å…°æ•°--æ¨¡æ¿é¢˜-acwing-889-æ»¡è¶³æ¡ä»¶çš„01åºåˆ—">#</a></h3>
<p>ç»™å®šnä¸ª0å’Œnä¸ª1ï¼Œå®ƒä»¬æŒ‰ç…§æŸç§é¡ºåºæ’æˆé•¿åº¦ä¸º2nçš„åºåˆ—ï¼Œæ»¡è¶³ä»»æ„å‰ç¼€ä¸­0çš„ä¸ªæ•°éƒ½ä¸å°‘äº1çš„ä¸ªæ•°çš„åºåˆ—çš„æ•°é‡ä¸ºï¼š
$$
Cat(n) = C(2n, n) / (n + 1)
$$</p>
<h3 id="å®¹æ–¥åŸç†">å®¹æ–¥åŸç†<a hidden class="anchor" aria-hidden="true" href="#å®¹æ–¥åŸç†">#</a></h3>
<p>æ‰¾1~nä¸­èƒ½è‡³å°‘è¢«ç´ æ•°p1,p2,&hellip;,pnä¸€ä¸ªæ•´é™¤çš„æ•´æ•°æœ‰å¤šå°‘ä¸ªã€‚</p>
<p>ä½è¿ç®—å¯¹åº”å®¹æ–¥åŸç†é›†åˆï¼Œ1~nä¸­èƒ½è¢«xæ•´é™¤çš„ä¸ªæ•°ä¸ºn/xï¼Œå¥‡æ•°åŠ ä¸Šï¼Œå¶æ•°å‡å»</p>
<h3 id="nimå°¼å§†æ¸¸æˆ--æ¨¡æ¿é¢˜-acwing-891-nimæ¸¸æˆ">NIM(å°¼å§†)æ¸¸æˆ â€”â€” æ¨¡æ¿é¢˜ AcWing 891. Nimæ¸¸æˆ<a hidden class="anchor" aria-hidden="true" href="#nimå°¼å§†æ¸¸æˆ--æ¨¡æ¿é¢˜-acwing-891-nimæ¸¸æˆ">#</a></h3>
<p>ç»™å®š<strong>N</strong>å †ç‰©å“ï¼Œç¬¬<strong>i</strong>å †ç‰©å“æœ‰<strong>Ai</strong>ä¸ªã€‚ä¸¤åç©å®¶è½®æµè¡ŒåŠ¨ï¼Œæ¯æ¬¡å¯ä»¥ä»»é€‰ä¸€å †ï¼Œå–èµ°ä»»æ„å¤šä¸ªç‰©å“ï¼Œå¯æŠŠä¸€å †å–å…‰ï¼Œä½†ä¸èƒ½ä¸å–ã€‚å–èµ°æœ€åä¸€ä»¶ç‰©å“è€…è·èƒœã€‚ä¸¤äººéƒ½é‡‡å–æœ€ä¼˜ç­–ç•¥ï¼Œé—®å…ˆæ‰‹æ˜¯å¦å¿…èƒœã€‚</p>
<p>æˆ‘ä»¬æŠŠè¿™ç§æ¸¸æˆç§°ä¸º<strong>NIM</strong>åšå¼ˆã€‚æŠŠæ¸¸æˆè¿‡ç¨‹ä¸­é¢ä¸´çš„çŠ¶æ€ç§°ä¸ºå±€é¢ã€‚æ•´å±€æ¸¸æˆç¬¬ä¸€ä¸ªè¡ŒåŠ¨çš„ç§°ä¸ºå…ˆæ‰‹ï¼Œç¬¬äºŒä¸ªè¡ŒåŠ¨çš„ç§°ä¸ºåæ‰‹ã€‚è‹¥åœ¨æŸä¸€å±€é¢ä¸‹æ— è®ºé‡‡å–ä½•ç§è¡ŒåŠ¨ï¼Œéƒ½ä¼šè¾“æ‰æ¸¸æˆï¼Œåˆ™ç§°è¯¥å±€é¢å¿…è´¥ã€‚
æ‰€è°“é‡‡å–æœ€ä¼˜ç­–ç•¥æ˜¯æŒ‡ï¼Œè‹¥åœ¨æŸä¸€å±€é¢ä¸‹å­˜åœ¨æŸç§è¡ŒåŠ¨ï¼Œä½¿å¾—è¡ŒåŠ¨åå¯¹é¢é¢ä¸´å¿…è´¥å±€é¢ï¼Œåˆ™ä¼˜å…ˆé‡‡å–è¯¥è¡ŒåŠ¨ã€‚åŒæ—¶ï¼Œè¿™æ ·çš„å±€é¢è¢«ç§°ä¸ºå¿…èƒœã€‚æˆ‘ä»¬è®¨è®ºçš„åšå¼ˆé—®é¢˜ä¸€èˆ¬éƒ½åªè€ƒè™‘ç†æƒ³æƒ…å†µï¼Œå³ä¸¤äººå‡æ— å¤±è¯¯ï¼Œéƒ½é‡‡å–æœ€ä¼˜ç­–ç•¥è¡ŒåŠ¨æ—¶æ¸¸æˆçš„ç»“æœã€‚
<strong>NIM</strong>åšå¼ˆä¸å­˜åœ¨å¹³å±€ï¼Œåªæœ‰<strong>å…ˆæ‰‹å¿…èƒœ</strong>å’Œ<strong>å…ˆæ‰‹å¿…è´¥</strong>ä¸¤ç§æƒ…å†µã€‚</p>
<p><strong>å®šç†</strong>ï¼š <strong>NIM</strong>åšå¼ˆ<strong>å…ˆæ‰‹å¿…èƒœ</strong>ï¼Œå½“ä¸”ä»…å½“ A1 ^ A2 ^ â€¦ ^ An != 0</p>
<p>å…¬å¹³ç»„åˆæ¸¸æˆICG
è‹¥ä¸€ä¸ªæ¸¸æˆæ»¡è¶³ï¼š</p>
<p>ç”±ä¸¤åç©å®¶äº¤æ›¿è¡ŒåŠ¨ï¼›
åœ¨æ¸¸æˆè¿›ç¨‹çš„ä»»æ„æ—¶åˆ»ï¼Œå¯ä»¥æ‰§è¡Œçš„åˆæ³•è¡ŒåŠ¨ä¸è½®åˆ°å“ªåç©å®¶æ— å…³ï¼›
ä¸èƒ½è¡ŒåŠ¨çš„ç©å®¶åˆ¤è´Ÿï¼›
åˆ™ç§°è¯¥æ¸¸æˆä¸ºä¸€ä¸ªå…¬å¹³ç»„åˆæ¸¸æˆã€‚
NIMåšå¼ˆå±äºå…¬å¹³ç»„åˆæ¸¸æˆï¼Œä½†åŸå»ºçš„æ£‹ç±»æ¸¸æˆï¼Œæ¯”å¦‚å›´æ£‹ï¼Œå°±ä¸æ˜¯å…¬å¹³ç»„åˆæ¸¸æˆã€‚å› ä¸ºå›´æ£‹äº¤æˆ˜åŒæ–¹åˆ†åˆ«åªèƒ½è½é»‘å­å’Œç™½å­ï¼Œèƒœè´Ÿåˆ¤å®šä¹Ÿæ¯”è¾ƒå¤æ‚ï¼Œä¸æ»¡è¶³æ¡ä»¶2å’Œæ¡ä»¶3ã€‚</p>
<p><strong>æœ‰å‘å›¾æ¸¸æˆ</strong>
ç»™å®šä¸€ä¸ªæœ‰å‘æ— ç¯å›¾ï¼Œå›¾ä¸­æœ‰ä¸€ä¸ªå”¯ä¸€çš„èµ·ç‚¹ï¼Œåœ¨èµ·ç‚¹ä¸Šæ”¾æœ‰ä¸€æšæ£‹å­ã€‚ä¸¤åç©å®¶äº¤æ›¿åœ°æŠŠè¿™æšæ£‹å­æ²¿æœ‰å‘è¾¹è¿›è¡Œç§»åŠ¨ï¼Œæ¯æ¬¡å¯ä»¥ç§»åŠ¨ä¸€æ­¥ï¼Œæ— æ³•ç§»åŠ¨è€…åˆ¤è´Ÿã€‚è¯¥æ¸¸æˆè¢«ç§°ä¸ºæœ‰å‘å›¾æ¸¸æˆã€‚
ä»»ä½•ä¸€ä¸ªå…¬å¹³ç»„åˆæ¸¸æˆéƒ½å¯ä»¥è½¬åŒ–ä¸ºæœ‰å‘å›¾æ¸¸æˆã€‚å…·ä½“æ–¹æ³•æ˜¯ï¼ŒæŠŠæ¯ä¸ªå±€é¢çœ‹æˆå›¾ä¸­çš„ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå¹¶ä¸”ä»æ¯ä¸ªå±€é¢å‘æ²¿ç€åˆæ³•è¡ŒåŠ¨èƒ½å¤Ÿåˆ°è¾¾çš„ä¸‹ä¸€ä¸ªå±€é¢è¿æœ‰å‘è¾¹ã€‚</p>
<p><strong>Mexè¿ç®—</strong>
è®¾Sè¡¨ç¤ºä¸€ä¸ªéè´Ÿæ•´æ•°é›†åˆã€‚å®šä¹‰mex(S)ä¸ºæ±‚å‡ºä¸å±äºé›†åˆSçš„æœ€å°éè´Ÿæ•´æ•°çš„è¿ç®—ï¼Œå³ï¼š
mex(S) = min{x}, xå±äºè‡ªç„¶æ•°ï¼Œä¸”xä¸å±äºS</p>
<p><strong>SGå‡½æ•°</strong>
åœ¨æœ‰å‘å›¾æ¸¸æˆä¸­ï¼Œå¯¹äºæ¯ä¸ªèŠ‚ç‚¹xï¼Œè®¾ä»xå‡ºå‘å…±æœ‰kæ¡æœ‰å‘è¾¹ï¼Œåˆ†åˆ«åˆ°è¾¾èŠ‚ç‚¹y1, y2, â€¦, ykï¼Œå®šä¹‰SG(x)ä¸ºxçš„åç»§èŠ‚ç‚¹y1, y2, â€¦, yk çš„SGå‡½æ•°å€¼æ„æˆçš„é›†åˆå†æ‰§è¡Œ**mex(S)**è¿ç®—çš„ç»“æœï¼Œå³ï¼š
SG(x) = mex({SG(y1), SG(y2), â€¦, SG(yk)})
ç‰¹åˆ«åœ°ï¼Œæ•´ä¸ªæœ‰å‘å›¾æ¸¸æˆGçš„SGå‡½æ•°å€¼è¢«å®šä¹‰ä¸ºæœ‰å‘å›¾æ¸¸æˆèµ·ç‚¹sçš„SGå‡½æ•°å€¼ï¼Œå³SG(G) = SG(s)ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">sg</span>(<span style="color:#66d9ef">int</span> x){
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> (f[x] <span style="color:#f92672">!=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>) <span style="color:#66d9ef">return</span> f[x];
</span></span><span style="display:flex;"><span>    unordered_set<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span> S;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> m; i<span style="color:#f92672">++</span> ) {
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">int</span> sum <span style="color:#f92672">=</span> s[i];
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (x <span style="color:#f92672">&gt;=</span> sum) S.insert(sg(x <span style="color:#f92672">-</span> sum));
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>; ; i<span style="color:#f92672">++</span> )
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>S.count(i))
</span></span><span style="display:flex;"><span>            	<span style="color:#66d9ef">return</span> f[x] <span style="color:#f92672">=</span> i;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="æœ‰å‘å›¾æ¸¸æˆçš„å’Œ--æ¨¡æ¿é¢˜-acwing-893-é›†åˆ-nimæ¸¸æˆ">æœ‰å‘å›¾æ¸¸æˆçš„å’Œ â€”â€” æ¨¡æ¿é¢˜ AcWing 893. é›†åˆ-Nimæ¸¸æˆ<a hidden class="anchor" aria-hidden="true" href="#æœ‰å‘å›¾æ¸¸æˆçš„å’Œ--æ¨¡æ¿é¢˜-acwing-893-é›†åˆ-nimæ¸¸æˆ">#</a></h3>
<p>è®¾G1, G2, â€¦, Gm æ˜¯<strong>mä¸ªæœ‰å‘å›¾æ¸¸æˆ</strong>ã€‚å®šä¹‰æœ‰å‘å›¾æ¸¸æˆGï¼Œå®ƒçš„è¡ŒåŠ¨è§„åˆ™æ˜¯ä»»é€‰æŸä¸ªæœ‰å‘å›¾æ¸¸æˆGiï¼Œå¹¶åœ¨Giä¸Šè¡ŒåŠ¨ä¸€æ­¥ã€‚Gè¢«ç§°ä¸ºæœ‰å‘å›¾æ¸¸æˆG1, G2, â€¦, Gmçš„å’Œã€‚
æœ‰å‘å›¾æ¸¸æˆçš„<strong>å’Œçš„SGå‡½æ•°å€¼</strong>ç­‰äºå®ƒåŒ…å«çš„å„ä¸ªå­æ¸¸æˆSGå‡½æ•°å€¼çš„å¼‚æˆ–å’Œï¼Œå³ï¼š
SG(G) = SG(G1) ^ SG(G2) ^ â€¦ ^ SG(Gm)</p>
<p>å®šç†
æœ‰å‘å›¾æ¸¸æˆçš„æŸä¸ªå±€é¢å¿…èƒœï¼Œå½“ä¸”ä»…å½“è¯¥å±€é¢å¯¹åº”èŠ‚ç‚¹çš„SGå‡½æ•°å€¼å¤§äº0ã€‚
æœ‰å‘å›¾æ¸¸æˆçš„æŸä¸ªå±€é¢å¿…è´¥ï¼Œå½“ä¸”ä»…å½“è¯¥å±€é¢å¯¹åº”èŠ‚ç‚¹çš„SGå‡½æ•°å€¼ç­‰äº0ã€‚</p>
<p>ä½œè€…ï¼šyxc
é“¾æ¥ï¼šhttps://www.acwing.com/blog/content/406/
æ¥æºï¼šAcWing
è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p>
<h2 id="æ—¶ç©ºå¤æ‚åº¦åˆ†æ">æ—¶ç©ºå¤æ‚åº¦åˆ†æ<a hidden class="anchor" aria-hidden="true" href="#æ—¶ç©ºå¤æ‚åº¦åˆ†æ">#</a></h2>
<p>å½“å¤„ç†ACMæˆ–ç¬”è¯•é¢˜æ—¶ï¼Œé€šå¸¸æ—¶é—´é™åˆ¶ä¸º1ç§’æˆ–2ç§’ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒC++ä»£ç ä¸­çš„æ“ä½œæ¬¡æ•°åº”æ§åˆ¶åœ¨10^7 åˆ° 10^8ä¹‹é—´ï¼Œè¿™æ˜¯æœ€ä½³èŒƒå›´ã€‚</p>
<p>ä»¥ä¸‹æ˜¯åœ¨ä¸åŒæ•°æ®è§„æ¨¡ä¸‹ï¼Œä»£ç çš„æ—¶é—´å¤æ‚åº¦å’Œç®—æ³•é€‰æ‹©çš„æŒ‡å¯¼ï¼š</p>
<ol>
<li><strong>n â‰¤ 30</strong>ï¼šæŒ‡æ•°çº§åˆ«ï¼Œä½¿ç”¨DFS+å‰ªæï¼ŒçŠ¶æ€å‹ç¼©DPã€‚</li>
<li><strong>n â‰¤ 100</strong>ï¼šO(n^3)ï¼Œé€‚ç”¨äºFloydã€DPã€é«˜æ–¯æ¶ˆå…ƒã€‚</li>
<li><strong>n â‰¤ 1000</strong>ï¼šO(n^2)æˆ–O(n^2*logn)ï¼Œé€‚ç”¨äºDPã€åˆ†æ²»ã€é«˜æ–¯æ¶ˆå…ƒã€æœ´ç´ ç‰ˆDijkstraã€æœ´ç´ ç‰ˆPrimã€Bellman-Fordã€‚</li>
<li><strong>n â‰¤ 10000</strong>ï¼šO(n * âˆšn)ï¼Œé€‚ç”¨äºå—çŠ¶é“¾è¡¨ã€åˆ†å—ã€è«é˜Ÿã€‚</li>
<li><strong>n â‰¤ 100000</strong>ï¼šO(nlogn)ï¼Œé€‚ç”¨äºå„ç§æ’åºã€çº¿æ®µæ ‘ã€æ ‘çŠ¶æ•°ç»„ã€é›†åˆ/æ˜ å°„ã€å †ã€æ‹“æ‰‘æ’åºã€Dijkstra+å †ã€Primã€Kruskalã€SPFAã€æ±‚å‡¸åŒ…ã€æ±‚åŠå¹³é¢äº¤ã€äºŒåˆ†ã€CDQåˆ†æ²»ã€æ•´ä½“äºŒåˆ†ã€åç¼€æ•°ç»„ã€æ ‘é“¾å‰–åˆ†ã€åŠ¨æ€æ ‘ã€‚</li>
<li><strong>n &lt; 1000000</strong>ï¼šO(n)æˆ–å¸¸æ•°è¾ƒå°çš„O(nlogn)ï¼Œé€‚ç”¨äºå•è°ƒé˜Ÿåˆ—ã€å“ˆå¸Œæ˜ å°„ã€åŒæŒ‡é’ˆæ‰«æã€BFSã€å¹¶æŸ¥é›†ã€KMPã€ACè‡ªåŠ¨æœºã€å¸¸æ•°è¾ƒå°çš„O(nlogn)çš„åšæ³•ï¼ˆå¦‚æ’åºã€æ ‘çŠ¶æ•°ç»„ã€å †ã€Dijkstraã€SPFAï¼‰ã€‚</li>
<li><strong>n &lt; 10000000</strong>ï¼šO(n)ï¼Œé€‚ç”¨äºåŒæŒ‡é’ˆæ‰«æã€KMPã€ACè‡ªåŠ¨æœºã€çº¿æ€§ç­›ç´ æ•°ã€‚</li>
<li><strong>n â‰¤ 10^9</strong>ï¼šO(nâˆšn)ï¼Œé€‚ç”¨äºåˆ¤æ–­è´¨æ•°ã€‚</li>
<li><strong>n â‰¤ 10^18</strong>ï¼šO(logn)ï¼Œé€‚ç”¨äºæœ€å¤§å…¬çº¦æ•°ã€å¿«é€Ÿå¹‚ã€æ•°ä½DPã€‚</li>
<li><strong>n â‰¤ 10^1000</strong>ï¼šO((logn)^2)ï¼Œé€‚ç”¨äºé«˜ç²¾åº¦åŠ å‡ä¹˜é™¤ã€‚</li>
<li><strong>n â‰¤ 10^100000</strong>ï¼šO(logk Ã— loglogk)ï¼Œå…¶ä¸­kè¡¨ç¤ºä½æ•°ï¼Œé€‚ç”¨äºé«˜ç²¾åº¦åŠ å‡ã€FFT/NTTã€‚</li>
</ol>
<p>åŠ¨æ€è§„åˆ’è®¡ç®—é‡ ï¼š çŠ¶æ€æ•° * çŠ¶æ€è½¬ç§»æ•°é‡</p>
<p>1 Byte = 8 bit</p>
<p>1KB = 1024 Byte</p>
<p>1MB = 1024<em>1024</em>1024 Byte</p>
<p>1GB = 1024 * 1024 * 1024 Byte</p>
<p>int 4 Byte</p>
<p>char 1 Byte</p>
<p>double, long long 8 Byte</p>
<h1 id="åŠ¨æ€è§„åˆ’">åŠ¨æ€è§„åˆ’<a hidden class="anchor" aria-hidden="true" href="#åŠ¨æ€è§„åˆ’">#</a></h1>
<p>å¸¸è§æ¨¡å‹</p>
<h2 id="èƒŒåŒ…-ä¹è®²">èƒŒåŒ… ä¹è®²<a hidden class="anchor" aria-hidden="true" href="#èƒŒåŒ…-ä¹è®²">#</a></h2>
<h3 id="01èƒŒåŒ…">01èƒŒåŒ…<a hidden class="anchor" aria-hidden="true" href="#01èƒŒåŒ…">#</a></h3>
<p><strong>æ¯ä»¶ç‰©å“æœ€å¤šå¯ä»¥ç”¨ä¸€æ¬¡</strong></p>
<p>ä½“ç§¯ä»å¤§åˆ°å°çš„åŸå›  ï¼š å¦‚æœä»å°åˆ°å¤§ï¼Œåˆ™<code>f[j-w[i]]+v[i]</code>å®é™…æ˜¯<code>f[i-1][j-w[i]]+v[i]</code>ï¼Œéœ€è¦çš„æ˜¯ä¸Šä¸€ç»´åº¦f[i-1]ç»´åº¦ï¼Œæ‰€ä»¥ä»å¤§åˆ°å°å¯ä»¥ä½¿ç”¨ä¸Šä¸€ç»´åº¦çš„ï¼Œå› ä¸ºè¿™ä¸€ç»´åº¦çš„è¿˜æ²¡æœ‰è¢«è®¡ç®—åˆ°ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>;i<span style="color:#f92672">&lt;=</span>N;i<span style="color:#f92672">++</span>){
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> j<span style="color:#f92672">=</span>V;j<span style="color:#f92672">&gt;=</span>w[i];j<span style="color:#f92672">--</span>){
</span></span><span style="display:flex;"><span>            f[j]<span style="color:#f92672">=</span>max(f[j],f[j<span style="color:#f92672">-</span>w[i]]<span style="color:#f92672">+</span>v[i]);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span></code></pre></div><h3 id="å®Œå…¨èƒŒåŒ…">å®Œå…¨èƒŒåŒ…<a hidden class="anchor" aria-hidden="true" href="#å®Œå…¨èƒŒåŒ…">#</a></h3>
<p>æ¯ä»¶ç‰©å“å¯ä»¥ç”¨æ— é™æ¬¡</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>;i<span style="color:#f92672">&lt;=</span>N;i<span style="color:#f92672">++</span>){
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> j<span style="color:#f92672">=</span>w[i];j<span style="color:#f92672">&lt;=</span>V;j<span style="color:#f92672">++</span>){
</span></span><span style="display:flex;"><span>            f[j]<span style="color:#f92672">=</span>max(f[j],f[j<span style="color:#f92672">-</span>w[i]]<span style="color:#f92672">+</span>v[i]);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span></code></pre></div><h3 id="å¤šé‡èƒŒåŒ…">å¤šé‡èƒŒåŒ…<a hidden class="anchor" aria-hidden="true" href="#å¤šé‡èƒŒåŒ…">#</a></h3>
<p>æ¯ä»¶ç‰©å“ç‰¹å®šæ•°é‡</p>
<h4 id="äºŒè¿›åˆ¶ä¼˜åŒ–">äºŒè¿›åˆ¶ä¼˜åŒ–<a hidden class="anchor" aria-hidden="true" href="#äºŒè¿›åˆ¶ä¼˜åŒ–">#</a></h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>;i<span style="color:#f92672">&lt;=</span>N;i<span style="color:#f92672">++</span>){
</span></span><span style="display:flex;"><span>        cin<span style="color:#f92672">&gt;&gt;</span>a<span style="color:#f92672">&gt;&gt;</span>b<span style="color:#f92672">&gt;&gt;</span>c; <span style="color:#75715e">//æƒé‡a,ä»·å€¼bï¼Œæ•°é‡c
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#66d9ef">int</span> k<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">while</span>(k<span style="color:#f92672">&lt;=</span>c){
</span></span><span style="display:flex;"><span>            cnt<span style="color:#f92672">++</span>; c<span style="color:#f92672">-=</span>k;
</span></span><span style="display:flex;"><span>            w[cnt]<span style="color:#f92672">=</span>k<span style="color:#f92672">*</span>a;
</span></span><span style="display:flex;"><span>            v[cnt]<span style="color:#f92672">=</span>k<span style="color:#f92672">*</span>b;
</span></span><span style="display:flex;"><span>            k<span style="color:#f92672">*=</span><span style="color:#ae81ff">2</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span>(c){
</span></span><span style="display:flex;"><span>            cnt<span style="color:#f92672">++</span>;
</span></span><span style="display:flex;"><span>            w[cnt]<span style="color:#f92672">=</span>c<span style="color:#f92672">*</span>a;
</span></span><span style="display:flex;"><span>            v[cnt]<span style="color:#f92672">=</span>c<span style="color:#f92672">*</span>b;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    } <span style="color:#75715e">//ä¹‹åç”¨01èƒŒåŒ…
</span></span></span></code></pre></div><h4 id="å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–">å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–<a hidden class="anchor" aria-hidden="true" href="#å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–">#</a></h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>;i<span style="color:#f92672">&lt;=</span>N;i<span style="color:#f92672">++</span>){ <span style="color:#75715e">// éå†æ¯ä»¶ç‰©å“
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        memcpy(g, f, <span style="color:#66d9ef">sizeof</span> g); <span style="color:#75715e">// å°†ä¸Šä¸€è½®çš„æœ€ä¼˜è§£æ‹·è´ç»™gæ•°ç»„
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> r<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;r<span style="color:#f92672">&lt;</span>v[i];r<span style="color:#f92672">++</span>){ <span style="color:#75715e">// éå†ä½™æ•°rï¼ˆç”¨äºä¼˜åŒ–å¾ªç¯ï¼‰
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            <span style="color:#66d9ef">int</span> h<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>,t<span style="color:#f92672">=-</span><span style="color:#ae81ff">1</span>; <span style="color:#75715e">// æ»‘åŠ¨çª—å£çš„èµ·å§‹ç´¢å¼•å’Œç»“æŸç´¢å¼•
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> l<span style="color:#f92672">=</span>r;l<span style="color:#f92672">&lt;=</span>V;l<span style="color:#f92672">+=</span>v[i]){ <span style="color:#75715e">// éå†èƒŒåŒ…å®¹é‡ï¼Œé—´éš”ä¸ºå½“å‰ç‰©å“ä½“ç§¯
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#66d9ef">while</span>(h<span style="color:#f92672">&lt;=</span>t <span style="color:#f92672">&amp;&amp;</span> l<span style="color:#f92672">-</span>q[h]<span style="color:#f92672">&gt;</span>s[i]<span style="color:#f92672">*</span>v[i]) h<span style="color:#f92672">++</span>; <span style="color:#75715e">// å¦‚æœçª—å£å·¦è¾¹ç•Œè¶…å‡ºé™åˆ¶ï¼Œåˆ™å·¦è¾¹ç•Œå³ç§»
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#66d9ef">while</span>(h<span style="color:#f92672">&lt;=</span>t <span style="color:#f92672">&amp;&amp;</span> g[q[t]] <span style="color:#f92672">+</span> (l<span style="color:#f92672">-</span>q[t])<span style="color:#f92672">/</span>v[i]<span style="color:#f92672">*</span>w[i]<span style="color:#f92672">&lt;=</span>g[l]) t<span style="color:#f92672">--</span>; <span style="color:#75715e">// ä¿æŒçª—å£å•è°ƒæ€§ï¼Œå°†çª—å£å†…ä¸ç¬¦åˆæ¡ä»¶çš„è§£ç§»é™¤
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                q[<span style="color:#f92672">++</span>t] <span style="color:#f92672">=</span> l; <span style="color:#75715e">// å°†å½“å‰çŠ¶æ€çš„èƒŒåŒ…å®¹é‡åŠ å…¥çª—å£
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                f[l] <span style="color:#f92672">=</span> g[q[h]] <span style="color:#f92672">+</span> (l<span style="color:#f92672">-</span>q[h])<span style="color:#f92672">/</span>v[i]<span style="color:#f92672">*</span>w[i]; <span style="color:#75715e">// æ›´æ–°å½“å‰çŠ¶æ€çš„æœ€ä¼˜è§£
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span></code></pre></div><h3 id="åˆ†ç»„èƒŒåŒ…">åˆ†ç»„èƒŒåŒ…<a hidden class="anchor" aria-hidden="true" href="#åˆ†ç»„èƒŒåŒ…">#</a></h3>
<p>è‹¥å¹²ç»„ï¼Œä¸€ç»„åªèƒ½é€‰ä¸€ä¸ª</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>;i<span style="color:#f92672">&lt;=</span>N;i<span style="color:#f92672">++</span>){
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> j<span style="color:#f92672">=</span>V;j<span style="color:#f92672">&gt;=</span><span style="color:#ae81ff">0</span>;j<span style="color:#f92672">--</span>){
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> k<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>;k<span style="color:#f92672">&lt;=</span>s[i];k<span style="color:#f92672">++</span>){
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span>(w[i][k]<span style="color:#f92672">&lt;=</span>j){
</span></span><span style="display:flex;"><span>                    f[j]<span style="color:#f92672">=</span>max(f[j],f[j<span style="color:#f92672">-</span> w[i][k] ]<span style="color:#f92672">+</span>v[i][k]);
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span></code></pre></div><h3 id="æ··åˆèƒŒåŒ…">æ··åˆèƒŒåŒ…<a hidden class="anchor" aria-hidden="true" href="#æ··åˆèƒŒåŒ…">#</a></h3>
<p>è½¬æ¢æˆ01èƒŒåŒ…é—®é¢˜</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>;i<span style="color:#f92672">&lt;=</span>N;i<span style="color:#f92672">++</span>){
</span></span><span style="display:flex;"><span>        cin<span style="color:#f92672">&gt;&gt;</span>a<span style="color:#f92672">&gt;&gt;</span>b<span style="color:#f92672">&gt;&gt;</span>s;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span>(s<span style="color:#f92672">==-</span><span style="color:#ae81ff">1</span>) s<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span> <span style="color:#a6e22e">if</span>(s<span style="color:#f92672">==</span><span style="color:#ae81ff">0</span>) s<span style="color:#f92672">=</span>V<span style="color:#f92672">/</span>a;
</span></span><span style="display:flex;"><span>        k<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">while</span>(k<span style="color:#f92672">&lt;=</span>s){
</span></span><span style="display:flex;"><span>            s<span style="color:#f92672">-=</span>k; cnt<span style="color:#f92672">++</span>;
</span></span><span style="display:flex;"><span>            v[cnt] <span style="color:#f92672">=</span> k<span style="color:#f92672">*</span>a; w[cnt] <span style="color:#f92672">=</span> k<span style="color:#f92672">*</span>b;
</span></span><span style="display:flex;"><span>            k<span style="color:#f92672">*=</span><span style="color:#ae81ff">2</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span>(s){
</span></span><span style="display:flex;"><span>            cnt<span style="color:#f92672">++</span>;
</span></span><span style="display:flex;"><span>            v[cnt] <span style="color:#f92672">=</span> s<span style="color:#f92672">*</span>a; w[cnt] <span style="color:#f92672">=</span> s<span style="color:#f92672">*</span>b;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>;i<span style="color:#f92672">&lt;=</span>cnt;i<span style="color:#f92672">++</span>){
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> j<span style="color:#f92672">=</span>V;j<span style="color:#f92672">&gt;=</span>v[i];j<span style="color:#f92672">--</span>){
</span></span><span style="display:flex;"><span>            f[j] <span style="color:#f92672">=</span> max(f[j], f[j<span style="color:#f92672">-</span>v[i]]<span style="color:#f92672">+</span>w[i]);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span></code></pre></div><h3 id="äºŒç»´è´¹ç”¨çš„èƒŒåŒ…é—®é¢˜">äºŒç»´è´¹ç”¨çš„èƒŒåŒ…é—®é¢˜<a hidden class="anchor" aria-hidden="true" href="#äºŒç»´è´¹ç”¨çš„èƒŒåŒ…é—®é¢˜">#</a></h3>
<p>é‡‡ç”¨ä¸¤å±‚å¾ªç¯</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>    cin<span style="color:#f92672">&gt;&gt;</span>N<span style="color:#f92672">&gt;&gt;</span>V<span style="color:#f92672">&gt;&gt;</span>W;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>;i<span style="color:#f92672">&lt;=</span>N;i<span style="color:#f92672">++</span>){
</span></span><span style="display:flex;"><span>        cin<span style="color:#f92672">&gt;&gt;</span>v<span style="color:#f92672">&gt;&gt;</span>m<span style="color:#f92672">&gt;&gt;</span>w;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> j<span style="color:#f92672">=</span>V;j<span style="color:#f92672">&gt;=</span>v;j<span style="color:#f92672">--</span>){
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> k<span style="color:#f92672">=</span>W;k<span style="color:#f92672">&gt;=</span>m;k<span style="color:#f92672">--</span>){
</span></span><span style="display:flex;"><span>                f[j][k] <span style="color:#f92672">=</span> max(f[j][k], f[j<span style="color:#f92672">-</span>v][k<span style="color:#f92672">-</span>m] <span style="color:#f92672">+</span> w);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    cout<span style="color:#f92672">&lt;&lt;</span>f[V][W]<span style="color:#f92672">&lt;&lt;</span>endl;
</span></span></code></pre></div><h2 id="çº¿æ€§dp">çº¿æ€§dp<a hidden class="anchor" aria-hidden="true" href="#çº¿æ€§dp">#</a></h2>
<h4 id="æ•°å­—ä¸‰è§’å½¢">æ•°å­—ä¸‰è§’å½¢<a hidden class="anchor" aria-hidden="true" href="#æ•°å­—ä¸‰è§’å½¢">#</a></h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span>	<span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>;i<span style="color:#f92672">&lt;=</span>n;i<span style="color:#f92672">++</span>){
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> j<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>;j<span style="color:#f92672">&lt;=</span>i;j<span style="color:#f92672">++</span>){
</span></span><span style="display:flex;"><span>			a[i][j]<span style="color:#f92672">+=</span>max(a[i<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>][j],a[i<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>][j<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]);
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>	}
</span></span></code></pre></div><h4 id="lis">LIS<a hidden class="anchor" aria-hidden="true" href="#lis">#</a></h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span>	<span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>;i<span style="color:#f92672">&lt;=</span>n;i<span style="color:#f92672">++</span>){
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> j<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>;j<span style="color:#f92672">&lt;</span>i;j<span style="color:#f92672">++</span>){
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">if</span>(a[j]<span style="color:#f92672">&lt;</span>a[i]) f[i]<span style="color:#f92672">=</span>max(f[j]<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>,f[i]);
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>;i<span style="color:#f92672">&lt;=</span>n;i<span style="color:#f92672">++</span>){
</span></span><span style="display:flex;"><span>		ma<span style="color:#f92672">=</span>max(f[i],ma);
</span></span><span style="display:flex;"><span>	}
</span></span></code></pre></div><h4 id="lcs">LCS<a hidden class="anchor" aria-hidden="true" href="#lcs">#</a></h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span>	<span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>;i<span style="color:#f92672">&lt;=</span>n;i<span style="color:#f92672">++</span>){
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> j<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>;j<span style="color:#f92672">&lt;=</span>m;j<span style="color:#f92672">++</span>){
</span></span><span style="display:flex;"><span>			f[i][j]<span style="color:#f92672">=</span>max(f[i<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>][j],f[i][j<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]);
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">if</span>(a[i]<span style="color:#f92672">==</span>b[j]) f[i][j]<span style="color:#f92672">=</span>f[i<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>][j<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>	}
</span></span></code></pre></div><h3 id="åŒºé—´dp">åŒºé—´dp<a hidden class="anchor" aria-hidden="true" href="#åŒºé—´dp">#</a></h3>
<h4 id="çŸ³å­åˆå¹¶">çŸ³å­åˆå¹¶<a hidden class="anchor" aria-hidden="true" href="#çŸ³å­åˆå¹¶">#</a></h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span>	memset(f, <span style="color:#ae81ff">0x3f</span>, <span style="color:#66d9ef">sizeof</span> f);
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> len<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>;len<span style="color:#f92672">&lt;=</span>n;len<span style="color:#f92672">++</span>){
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>;i<span style="color:#f92672">+</span>len<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span><span style="color:#f92672">&lt;=</span>n;i<span style="color:#f92672">++</span>){
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">int</span> j<span style="color:#f92672">=</span>i<span style="color:#f92672">+</span>len<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (len <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>) {
</span></span><span style="display:flex;"><span>             	f[i][j] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;  <span style="color:#75715e">// è¾¹ç•Œåˆå§‹åŒ–
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#66d9ef">continue</span>;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> k<span style="color:#f92672">=</span>i;k<span style="color:#f92672">&lt;</span>j;k<span style="color:#f92672">++</span>){
</span></span><span style="display:flex;"><span>				f[l][r]<span style="color:#f92672">=</span>min(f[l][r],f[l][k]<span style="color:#f92672">+</span>f[k<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>][r]<span style="color:#f92672">+</span>s[r]<span style="color:#f92672">-</span>s[l<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	cout<span style="color:#f92672">&lt;&lt;</span>f[<span style="color:#ae81ff">1</span>][n];
</span></span></code></pre></div><h2 id="æ•°ä½ç»Ÿè®¡dp">æ•°ä½ç»Ÿè®¡dp<a hidden class="anchor" aria-hidden="true" href="#æ•°ä½ç»Ÿè®¡dp">#</a></h2>
<p>çŠ¶æ€è¡¨ç¤º</p>
<p>åˆ†æƒ…å†µè®¨è®º</p>
<h2 id="çŠ¶æ€å‹ç¼©-dp">çŠ¶æ€å‹ç¼© dp<a hidden class="anchor" aria-hidden="true" href="#çŠ¶æ€å‹ç¼©-dp">#</a></h2>
<p>è’™å¾·é‡Œå®‰çš„æ¢¦æƒ³</p>
<p>æœ€çŸ­Hamiltonè·ç¦»</p>
<h2 id="æ ‘å½¢dp">æ ‘å½¢dp<a hidden class="anchor" aria-hidden="true" href="#æ ‘å½¢dp">#</a></h2>
<p>æ²¡æœ‰ä¸Šå¸çš„èˆä¼š</p>
<h3 id="è®°å¿†åŒ–">è®°å¿†åŒ–<a hidden class="anchor" aria-hidden="true" href="#è®°å¿†åŒ–">#</a></h3>
<p>æ»‘é›ª</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#75715e">#include&lt;bits/stdc++.h&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">using</span> <span style="color:#66d9ef">namespace</span> std;
</span></span><span style="display:flex;"><span><span style="color:#75715e">#define ll long long
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#66d9ef">int</span> maxn<span style="color:#f92672">=</span><span style="color:#ae81ff">1e4</span>;
</span></span><span style="display:flex;"><span>ll f[maxn][maxn],g[maxn][maxn]; <span style="color:#75715e">//distance
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">struct</span> <span style="color:#a6e22e">node</span>{
</span></span><span style="display:flex;"><span>    ll i,j,num;
</span></span><span style="display:flex;"><span>}a[maxn];
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">struct</span> <span style="color:#a6e22e">cmp</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">bool</span> <span style="color:#a6e22e">operator</span> () (node x,node y){
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> x.num<span style="color:#f92672">&gt;</span>y.num;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    ios<span style="color:#f92672">::</span>sync_with_stdio(false);
</span></span><span style="display:flex;"><span>    cin.tie(<span style="color:#ae81ff">0</span>);
</span></span><span style="display:flex;"><span>    cout.tie(<span style="color:#ae81ff">0</span>);
</span></span><span style="display:flex;"><span>    ll n,m,ma<span style="color:#f92672">=-</span><span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>    cin<span style="color:#f92672">&gt;&gt;</span>n<span style="color:#f92672">&gt;&gt;</span>m;
</span></span><span style="display:flex;"><span>    priority_queue<span style="color:#f92672">&lt;</span>node, vector<span style="color:#f92672">&lt;</span>node<span style="color:#f92672">&gt;</span>,cmp<span style="color:#f92672">&gt;</span>pq;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span>(ll i<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>;i<span style="color:#f92672">&lt;=</span>n;i<span style="color:#f92672">++</span>){
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span>(ll j<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>;j<span style="color:#f92672">&lt;=</span>m;j<span style="color:#f92672">++</span>){
</span></span><span style="display:flex;"><span>            f[i][j]<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>            node a;
</span></span><span style="display:flex;"><span>            a.i<span style="color:#f92672">=</span>i;
</span></span><span style="display:flex;"><span>            a.j<span style="color:#f92672">=</span>j;
</span></span><span style="display:flex;"><span>            cin<span style="color:#f92672">&gt;&gt;</span>a.num;
</span></span><span style="display:flex;"><span>            g[i][j]<span style="color:#f92672">=</span>a.num;
</span></span><span style="display:flex;"><span>            pq.push(a);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span>(<span style="color:#f92672">!</span>pq.empty()){
</span></span><span style="display:flex;"><span>        node t<span style="color:#f92672">=</span>pq.top();
</span></span><span style="display:flex;"><span>        pq.pop();
</span></span><span style="display:flex;"><span>        ll i<span style="color:#f92672">=</span>t.i;
</span></span><span style="display:flex;"><span>        ll j<span style="color:#f92672">=</span>t.j;
</span></span><span style="display:flex;"><span>        ll nu<span style="color:#f92672">=</span>t.num;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span>(g[i<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>][j]<span style="color:#f92672">&lt;</span>nu) f[i][j]<span style="color:#f92672">=</span>max(f[i][j],f[i<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>][j]<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span>(g[i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>][j]<span style="color:#f92672">&lt;</span>nu) f[i][j]<span style="color:#f92672">=</span>max(f[i][j],f[i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>][j]<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span>(g[i][j<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">&lt;</span>nu) f[i][j]<span style="color:#f92672">=</span>max(f[i][j],f[i][j<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span>(g[i][j<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">&lt;</span>nu) f[i][j]<span style="color:#f92672">=</span>max(f[i][j],f[i][j<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>        ma<span style="color:#f92672">=</span>max(ma,f[i][j]);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    cout<span style="color:#f92672">&lt;&lt;</span>ma<span style="color:#f92672">&lt;&lt;</span>endl;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h1 id="ä¹ é¢˜è¯¾">ä¹ é¢˜è¯¾<a hidden class="anchor" aria-hidden="true" href="#ä¹ é¢˜è¯¾">#</a></h1>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
		
	
<nav class="paginav">
  <a class="prev" href="https://kennems.github.io/en/posts/tech/5.transformer/">
    <span class="title">Â« Prev</span>
    <br>
    <span>5. Transformer</span>
  </a>
  <a class="next" href="https://kennems.github.io/en/posts/tech/leetcode%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%982405/">
    <span class="title">Next Â»</span>
    <br>
    <span></span>
  </a>
</nav>


<ul class="share-buttons">
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share  on x"
            href="https://x.com/intent/tweet/?text=&amp;url=https%3a%2f%2fkennems.github.io%2fen%2fposts%2ftech%2facwing%2f&amp;hashtags=">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M512 62.554 L 512 449.446 C 512 483.97 483.97 512 449.446 512 L 62.554 512 C 28.03 512 0 483.97 0 449.446 L 0 62.554 C 0 28.03 28.029 0 62.554 0 L 449.446 0 C 483.971 0 512 28.03 512 62.554 Z M 269.951 190.75 L 182.567 75.216 L 56 75.216 L 207.216 272.95 L 63.9 436.783 L 125.266 436.783 L 235.9 310.383 L 332.567 436.783 L 456 436.783 L 298.367 228.367 L 432.367 75.216 L 371.033 75.216 Z M 127.633 110 L 164.101 110 L 383.481 400.065 L 349.5 400.065 Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share  on linkedin"
            href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fkennems.github.io%2fen%2fposts%2ftech%2facwing%2f&amp;title=&amp;summary=&amp;source=https%3a%2f%2fkennems.github.io%2fen%2fposts%2ftech%2facwing%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share  on reddit"
            href="https://reddit.com/submit?url=https%3a%2f%2fkennems.github.io%2fen%2fposts%2ftech%2facwing%2f&title=">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share  on facebook"
            href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fkennems.github.io%2fen%2fposts%2ftech%2facwing%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share  on whatsapp"
            href="https://api.whatsapp.com/send?text=%20-%20https%3a%2f%2fkennems.github.io%2fen%2fposts%2ftech%2facwing%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share  on telegram"
            href="https://telegram.me/share/url?text=&amp;url=https%3a%2f%2fkennems.github.io%2fen%2fposts%2ftech%2facwing%2f">
            <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28" height="30px" width="30px" fill="currentColor">
                <path
                    d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share  on ycombinator"
            href="https://news.ycombinator.com/submitlink?t=&u=https%3a%2f%2fkennems.github.io%2fen%2fposts%2ftech%2facwing%2f">
            <svg version="1.1" xml:space="preserve" width="30px" height="30px" viewBox="0 0 512 512" fill="currentColor"
                xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape">
                <path
                    d="M449.446 0C483.971 0 512 28.03 512 62.554L512 449.446C512 483.97 483.97 512 449.446 512L62.554 512C28.03 512 0 483.97 0 449.446L0 62.554C0 28.03 28.029 0 62.554 0L449.446 0ZM183.8767 87.9921H121.8427L230.6673 292.4508V424.0079H281.3328V292.4508L390.1575 87.9921H328.1233L256 238.2489z" />
            </svg>
        </a>
    </li>
</ul>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2024 <a href="https://kennems.github.io/en/">Kennem</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
<footer class="footer">
    <script async src="https://busuanzi.sukap.cn/busuanzi.pure.mini.js"></script>
    <span id="busuanzi_container">
        <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
        Visitors: <span id="busuanzi_value_page_uv"></span>
        Views: <span id="busuanzi_value_page_pv"></span>

        
    </span>
</footer>


</body>

</html>
