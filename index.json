[{"content":"LeetCode 1215 å‘¨èµ› å½“ä½ æ€è·¯å¯¹äº†ï¼Œç­‰æœ€ç»ˆè°ƒå‡ºæ¥æœ€å¤šå·®ä¸¤ä¸‰åˆ†é’Ÿï¼Œä½†æ˜¯ä»£ç æœ‰é”™è¯¯é”™ä¸€æ¬¡å°±æ˜¯äº”åˆ†é’Ÿã€‚\nT2 3387. ä¸¤å¤©è‡ªç”±å¤–æ±‡äº¤æ˜“åçš„æœ€å¤§è´§å¸æ•° 1. é¢˜ç›®å¤§æ„ ä½ åˆå§‹æ‹¥æœ‰ 1 å•ä½çš„æŒ‡å®šè´§å¸ initialCurrencyã€‚åœ¨ä¸¤å¤©å†…ï¼Œå¯ä»¥æŒ‰ç…§åˆ†åˆ«æä¾›çš„æ±‡ç‡ rates1 å’Œ rates2 è¿›è¡Œä»»æ„æ¬¡æ•°çš„è´§å¸å…‘æ¢ã€‚æ¯ç§è´§å¸å¯¹çš„æ±‡ç‡å¯ä»¥åå‘å…‘æ¢ï¼ˆæ±‡ç‡ä¸º 1/rate1/\\text{rate}1/rateï¼‰ã€‚ç›®æ ‡æ˜¯ç»è¿‡ä¸¤å¤©åï¼Œä½¿å¾—æœ€ç»ˆæŒæœ‰çš„ initialCurrency æ•°é‡æœ€å¤§åŒ–ã€‚\n2. å®ç°æ€è·¯ æ„å»ºæ±‡ç‡å›¾ï¼š ä½¿ç”¨å›¾è¡¨ç¤ºä¸¤å¤©çš„æ±‡ç‡å…³ç³»ï¼Œæ¯ç§è´§å¸ä¸ºèŠ‚ç‚¹ï¼Œè´§å¸å¯¹çš„æ±‡ç‡ä¸ºæœ‰å‘è¾¹çš„æƒé‡ã€‚ æ„å»ºä¸¤ä¸ªç‹¬ç«‹çš„å›¾ graph1 å’Œ graph2ï¼Œåˆ†åˆ«è¡¨ç¤ºç¬¬ 1 å¤©å’Œç¬¬ 2 å¤©çš„æ±‡ç‡å›¾ã€‚ å¹¿åº¦ä¼˜å…ˆæœç´¢ (BFS)ï¼š å¯¹æ¯ä¸€å¤©çš„æ±‡ç‡å›¾ï¼Œä»æŸä¸ªè´§å¸å‡ºå‘ï¼Œä½¿ç”¨ BFS è®¡ç®—ä»¥æ­¤è´§å¸ä¸ºèµ·ç‚¹å¯åˆ°è¾¾å…¶ä»–è´§å¸çš„æœ€å¤§å…‘æ¢å€¼ã€‚ BFS è¿‡ç¨‹ä¸­ç»´æŠ¤ä¸€ä¸ªå­—å…¸ max_valuesï¼Œè®°å½•å½“å‰è´§å¸çš„æœ€å¤§å…‘æ¢å€¼ã€‚ ä¸¤å¤©çš„æœ€å¤§åŒ–è¿‡ç¨‹ï¼š ç¬¬ 1 å¤©ï¼Œä»åˆå§‹è´§å¸å‡ºå‘ï¼Œè®¡ç®—æ‰€æœ‰å¯èƒ½çš„è´§å¸åŠå…¶å¯¹åº”çš„æœ€å¤§æ•°é‡ã€‚ ç¬¬ 2 å¤©ï¼Œå°è¯•ä»ç¬¬ 1 å¤©çš„ç»“æœå‡ºå‘ï¼Œè®¡ç®—å›åˆ°åˆå§‹è´§å¸çš„æœ€å¤§å¯èƒ½æ•°é‡ã€‚ è¿”å›ç»“æœï¼š è¿”å›ç»è¿‡ä¸¤å¤©å…‘æ¢åï¼Œå›åˆ°åˆå§‹è´§å¸ initialCurrency çš„æœ€å¤§å¯èƒ½å€¼ã€‚ class Solution: def maxAmount(self, c: str, p1: List[List[str]], r1: List[float], p2: List[List[str]], r2: List[float]) -\u0026gt; float: from collections import defaultdict, deque # æ„å»ºæ±‡ç‡å›¾ def build(pairs, rates): g = defaultdict(list) for (s, t), rate in zip(pairs, rates): g[s].append((t, rate)) # æ·»åŠ ä» s åˆ° t çš„æ±‡ç‡ g[t].append((s, 1 / rate)) # æ·»åŠ ä» t åˆ° s çš„åå‘æ±‡ç‡ return g # ä½¿ç”¨ BFS æŸ¥æ‰¾ä» start å‡ºå‘åˆ°æ‰€æœ‰è´§å¸çš„æœ€å¤§å…‘æ¢å€¼ def bfs(g, start): mx = defaultdict(float) # å­˜å‚¨æ¯ç§è´§å¸çš„æœ€å¤§å…‘æ¢å€¼ mx[start] = 1.0 # åˆå§‹è´§å¸çš„æ•°é‡ä¸º 1.0 q = deque([start]) # BFS é˜Ÿåˆ—åˆå§‹åŒ–ä¸º start while q: cur = q.popleft() # å½“å‰å¤„ç†çš„è´§å¸ for nxt, rate in g[cur]: val = mx[cur] * rate # è®¡ç®—é€šè¿‡å½“å‰è·¯å¾„åˆ°è¾¾ nxt çš„æ•°é‡ if val \u0026gt; mx[nxt]: # å¦‚æœæ–°å€¼æ›´å¤§ï¼Œåˆ™æ›´æ–°å¹¶åŠ å…¥é˜Ÿåˆ— mx[nxt] = val q.append(nxt) return mx # ç¬¬ 1 å¤©çš„æ±‡ç‡å›¾ g1 = build(p1, r1) # ç¬¬ 2 å¤©çš„æ±‡ç‡å›¾ g2 = build(p2, r2) # ç¬¬ 1 å¤©çš„å…‘æ¢ç»“æœ res1 = bfs(g1, c) res = 0 # éå†ç¬¬ 1 å¤©çš„æ‰€æœ‰å¯èƒ½ç»“æœï¼Œä½œä¸ºç¬¬ 2 å¤©çš„åˆå§‹çŠ¶æ€ for cur, amt in res1.items(): # ç¬¬ 2 å¤©çš„å…‘æ¢ç»“æœ res2 = bfs(g2, cur) # å¦‚æœå¯ä»¥å›åˆ°åˆå§‹è´§å¸ï¼Œåˆ™è®¡ç®—æ€»å…‘æ¢å€¼ if c in res2: res = max(res, amt * res2[c]) return res T3 3388. ç»Ÿè®¡æ•°ç»„ä¸­çš„ç¾ä¸½åˆ†å‰² 1. é¢˜ç›®å¤§æ„ ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ numsï¼Œè¦æ±‚æ‰¾å‡ºæ‰€æœ‰æ»¡è¶³ä»¥ä¸‹æ¡ä»¶çš„ ç¾ä¸½åˆ†å‰² çš„æ•°é‡ï¼š\nå°†æ•°ç»„åˆ†ä¸ºä¸‰ä¸ªéç©ºå­æ•°ç»„ nums1ã€nums2 å’Œ nums3ï¼Œå®ƒä»¬æŒ‰é¡ºåºæ‹¼æ¥å¯ä»¥è¿˜åŸä¸ºåŸæ•°ç»„ numsã€‚ å­æ•°ç»„ nums1 æ˜¯å­æ•°ç»„ nums2 çš„å‰ç¼€ï¼Œæˆ–è€… nums2 æ˜¯å­æ•°ç»„ nums3 çš„å‰ç¼€ã€‚ å­æ•°ç»„æ˜¯æŒ‡æ•°ç»„ä¸­è¿ç»­çš„ä¸€æ®µå…ƒç´ ï¼Œå‰ç¼€æ˜¯ä»æ•°ç»„å¤´éƒ¨å¼€å§‹çš„è¿ç»­å­æ•°ç»„ã€‚\n2. å®ç°æ€è·¯ å‰ç¼€å“ˆå¸Œï¼š ä¸ºäº†å¿«é€Ÿåˆ¤æ–­å­æ•°ç»„æ˜¯å¦ç›¸ç­‰ï¼Œé‡‡ç”¨å‰ç¼€å“ˆå¸Œè®¡ç®—å­æ•°ç»„çš„å“ˆå¸Œå€¼ã€‚å“ˆå¸Œå€¼çš„è®¡ç®—å…¬å¼ä¸ºï¼š\n$h[i]=(h[iâˆ’1]â‹…base+nums[iâˆ’1])%modh[i] = (h[i-1] \\cdot \\text{base} + \\text{nums}[i-1]) % \\text{mod}$\nä½¿ç”¨å“ˆå¸Œå¯ä»¥åœ¨ O(1)O(1) æ—¶é—´å†…æ¯”è¾ƒä»»æ„ä¸¤ä¸ªå­æ•°ç»„æ˜¯å¦ç›¸ç­‰ã€‚\nåŒå±‚éå†ï¼š\nç¬¬ä¸€å±‚éå†ç¡®å®šåˆ†å‰²ç‚¹ iï¼Œå°†æ•°ç»„åˆ†ä¸º nums1 å’Œ nums2 + nums3ã€‚ ç¬¬äºŒå±‚éå†ç¡®å®šåˆ†å‰²ç‚¹ jï¼Œå°† nums2 + nums3 å†åˆ†ä¸º nums2 å’Œ nums3ã€‚ åœ¨æ¯æ¬¡åˆ†å‰²ä¸­åˆ¤æ–­ï¼š nums1 æ˜¯å¦æ˜¯ nums2 çš„å‰ç¼€ï¼Œæˆ–è€… nums2 æ˜¯å¦æ˜¯ nums3 çš„å‰ç¼€ã€‚ åˆ¤æ–­å‰ç¼€ï¼š ä½¿ç”¨å“ˆå¸Œå€¼æ¯”è¾ƒä¸¤ä¸ªå­æ•°ç»„æ˜¯å¦ç›¸ç­‰ï¼ŒåŒæ—¶ä¿è¯é•¿åº¦å…³ç³»æ»¡è¶³é¢˜ç›®è¦æ±‚ã€‚\nå¤æ‚åº¦åˆ†æï¼š\næ„å»ºå‰ç¼€å“ˆå¸Œçš„æ—¶é—´å¤æ‚åº¦ä¸º $O(n)$ã€‚ åŒå±‚éå†çš„æ—¶é—´å¤æ‚åº¦ä¸º$O(n^2)$ã€‚ æ€»æ—¶é—´å¤æ‚åº¦ä¸º$O(n^2)$ï¼Œå¯ä»¥æ»¡è¶³é¢˜ç›®è¦æ±‚ã€‚ 3. å†™æ»¡æ³¨é‡Šçš„ä»£ç  å­—ç¬¦ä¸²å“ˆå¸Œ from typing import List class Solution: def beautifulSplits(self, nums: List[int]) -\u0026gt; int: n = len(nums) # å‰ç¼€å“ˆå¸Œæ•°ç»„ h = [0] * (n + 1) # å¹‚æ¬¡æ•°ç»„ï¼Œç”¨äºå¿«é€Ÿè®¡ç®—å­æ•°ç»„çš„å“ˆå¸Œå€¼ p = [1] * (n + 1) base = 131 mod = int(1e9) + 7 # ä¼˜åŒ–äºŒ é€‚åˆçš„è´¨æ•° # é¢„è®¡ç®—å‰ç¼€å“ˆå¸Œå€¼å’Œå¹‚æ¬¡å€¼ for i in range(1, n + 1): h[i] = (h[i - 1] * base + nums[i - 1]) % mod p[i] = (p[i - 1] * base) % mod # å­å‡½æ•°ï¼šè®¡ç®— [l, r] çš„å“ˆå¸Œå€¼ def get_hash(l, r): return (h[r + 1] - h[l] * p[r - l + 1] % mod + mod) % mod res = 0 # æšä¸¾åˆ†å‰²ç‚¹ iï¼Œnums1 å’Œ nums2+nums3 çš„åˆ†ç•Œç‚¹ for i in range(1, n - 1): l1 = i # nums1 çš„é•¿åº¦ # nums1 çš„å“ˆå¸Œå€¼ s1 = get_hash(0, l1 - 1) # æšä¸¾åˆ†å‰²ç‚¹ jï¼Œnums2 å’Œ nums3 çš„åˆ†ç•Œç‚¹ for j in range(i + 1, n): l2 = j - i # nums2 çš„é•¿åº¦ # æ£€æŸ¥ nums1 æ˜¯å¦æ˜¯ nums2 çš„å‰ç¼€ if l1 \u0026lt;= l2 and s1 == get_hash(i, i + l1 - 1): # nums3 é•¿åº¦ä¸º n - jï¼Œç›´æ¥ç»Ÿè®¡ res += (n - j) # ###ä¼˜åŒ–ä¸€ break # åç»­åˆ†å‰²ä¸å†ç¬¦åˆæ¡ä»¶ # æ£€æŸ¥ nums2 æ˜¯å¦æ˜¯ nums3 çš„å‰ç¼€ l3 = n - j # nums3 çš„é•¿åº¦ s2 = get_hash(i, i + l2 - 1) if l2 \u0026lt;= l3 and s2 == get_hash(j, j + l2 - 1): res += 1 return res Zå‡½æ•° class Solution: def beautifulSplits(self, nums: List[int]) -\u0026gt; int: n = len(nums) lcp = [[0] * (n + 1) for _ in range(n + 1)] for i in range(n - 1, -1, -1): for j in range(n - 1, i - 1, -1): if nums[i] == nums[j]: lcp[i][j] = lcp[i + 1][j + 1] + 1 res = 0 for i in range(1, n - 1): for j in range(i + 1, n): if i \u0026lt;= j - i and lcp[0][i] \u0026gt;= i or \\ j - i \u0026lt;= n - j and lcp[i][j] \u0026gt;= j - i: res += 1 return res T4 3389. ä½¿å­—ç¬¦é¢‘ç‡ç›¸ç­‰çš„æœ€å°‘æ“ä½œæ¬¡æ•° 1ã€é¢˜ç›®å¤§æ„ ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸² ssï¼Œéœ€è¦å°†å…¶è½¬æ¢ä¸ºä¸€ä¸ªâ€œå¥½å­—ç¬¦ä¸²â€ã€‚â€œå¥½å­—ç¬¦ä¸²â€çš„å®šä¹‰æ˜¯å…¶ä¸­æ‰€æœ‰å­—ç¬¦çš„é¢‘ç‡éƒ½ç›¸ç­‰ã€‚ä½ å¯ä»¥é€šè¿‡ä»¥ä¸‹æ“ä½œå°† ss è½¬æ¢ä¸ºâ€œå¥½å­—ç¬¦ä¸²â€ï¼š\nåˆ é™¤ ss ä¸­çš„ä¸€ä¸ªå­—ç¬¦ã€‚ å‘ ss ä¸­æ·»åŠ ä¸€ä¸ªå­—ç¬¦ã€‚ å°† ss ä¸­çš„ä¸€ä¸ªå­—ç¬¦å˜ä¸ºå­—æ¯è¡¨ä¸­çš„ä¸‹ä¸€ä¸ªå­—æ¯ï¼ˆä½†ä¸èƒ½ä» \u0026lsquo;z\u0026rsquo; å˜ä¸º \u0026lsquo;a\u0026rsquo;ï¼‰ã€‚ æ±‚å°† ss å˜ä¸ºâ€œå¥½å­—ç¬¦ä¸²â€æ‰€éœ€çš„æœ€å°æ“ä½œæ¬¡æ•°ã€‚\n2ã€å®ç°æ€è·¯ å­—ç¬¦é¢‘ç‡ç»Ÿè®¡ï¼š ä½¿ç”¨ Counter ç»Ÿè®¡æ¯ä¸ªå­—ç¬¦çš„é¢‘ç‡ã€‚ æ±‚ç›®æ ‡é¢‘ç‡ï¼š è®¾å®šä¸€ä¸ªç›®æ ‡é¢‘ç‡ tï¼Œè®©æ‰€æœ‰å­—ç¬¦çš„é¢‘ç‡å°½é‡æ¥è¿‘ tã€‚ç›®æ ‡é¢‘ç‡èŒƒå›´ä» 0 åˆ°å­—ç¬¦ä¸²ä¸­æŸä¸ªå­—ç¬¦çš„æœ€å¤§é¢‘ç‡ã€‚ è®¡ç®—ä»£ä»·ï¼š å¯¹äºæ¯ä¸ªå¯èƒ½çš„ç›®æ ‡é¢‘ç‡ tï¼Œè®¡ç®—æ‰€æœ‰å­—ç¬¦ä»å½“å‰é¢‘ç‡å˜ä¸º t æ‰€éœ€çš„ä»£ä»·ï¼š è‹¥å­—ç¬¦é¢‘ç‡é«˜äº tï¼Œéœ€è¦é€šè¿‡åˆ é™¤æ“ä½œå‡å°‘é¢‘ç‡ã€‚ è‹¥å­—ç¬¦é¢‘ç‡ä½äº tï¼Œéœ€è¦é€šè¿‡æ·»åŠ æˆ–å˜æ¢æ“ä½œå¢åŠ é¢‘ç‡ã€‚ ä¼˜åŒ–æœç´¢ï¼š æšä¸¾æ‰€æœ‰å¯èƒ½çš„ç›®æ ‡é¢‘ç‡ï¼Œè®°å½•æœ€å°çš„æ“ä½œæ¬¡æ•°ã€‚ from collections import Counter class Solution: def makeStringGood(self, s: str) -\u0026gt; int: # ç»Ÿè®¡æ¯ä¸ªå­—ç¬¦çš„é¢‘ç‡ï¼Œå­˜å‚¨ä¸º Counter å¯¹è±¡ cnt = Counter(s) # å°†é¢‘ç‡å€¼è½¬æ¢ä¸ºåˆ—è¡¨ï¼Œå¯¹åº”å­—æ¯è¡¨é¡ºåº [a, b, ..., z] çš„é¢‘ç‡ cnt = [cnt[chr(c)] for c in range(97, 97 + 26)] # åˆå§‹åŒ–ç»“æœä¸ºå­—ç¬¦ä¸²é•¿åº¦ï¼Œè¡¨ç¤ºæœ€å·®æƒ…å†µä¸‹æ‰€æœ‰å­—ç¬¦éƒ½éœ€æ›¿æ¢ ans = len(s) # ç”¨äºåŠ¨æ€è§„åˆ’çš„è¾…åŠ©æ•°ç»„ï¼Œè¡¨ç¤ºåˆ°å½“å‰å­—æ¯ä¸ºæ­¢çš„æœ€å°æ“ä½œæ•° f = [0] * 27 # æšä¸¾ç›®æ ‡é¢‘ç‡ targetï¼Œä» 0 åˆ° max(cnt) for target in range(max(cnt) + 1): # åˆå§‹åŒ–æœ€åä¸€ä¸ªå­—æ¯ z çš„æ“ä½œæ•°ï¼Œå–é¢‘ç‡è°ƒæ•´ä¸º target æˆ– 0 çš„æœ€å°å€¼ f[25] = min(cnt[25], abs(cnt[25] - target)) # ä»åå¾€å‰ä¾æ¬¡è®¡ç®—å„å­—æ¯çš„æœ€ä¼˜æ“ä½œæ•° for i in range(24, -1, -1): x, y = cnt[i], cnt[i + 1] # å½“å‰å­—æ¯å’Œåä¸€ä¸ªå­—æ¯çš„é¢‘ç‡ # å½“å‰å­—æ¯å•ç‹¬è°ƒæ•´åˆ°ç›®æ ‡é¢‘ç‡æˆ– 0 f[i] = f[i + 1] + min(x, abs(x - target)) # åŒæ—¶è€ƒè™‘å½“å‰å­—æ¯ x å’Œåä¸€ä¸ªå­—æ¯ y çš„è°ƒæ•´ä»£ä»· if y \u0026lt; target: # åªæœ‰å½“ y å°äºç›®æ ‡é¢‘ç‡æ—¶ï¼Œè€ƒè™‘ç¬¬ä¸‰ç§æ“ä½œ t = target if x \u0026gt; target else 0 # x å¯èƒ½å˜ä¸º target æˆ– 0 f[i] = min(f[i], f[i + 2] + max(x - t, target - y)) # æ›´æ–°æœ€å°æ“ä½œæ¬¡æ•° ans = min(ans, f[0]) return ans ","permalink":"https://kennems.github.io/posts/tech/leetcode-1215-%E5%91%A8%E8%B5%9B/","summary":"LeetCode 1215 å‘¨èµ› å½“ä½ æ€è·¯å¯¹äº†ï¼Œç­‰æœ€ç»ˆè°ƒå‡ºæ¥æœ€å¤šå·®ä¸¤ä¸‰åˆ†é’Ÿï¼Œä½†æ˜¯ä»£ç æœ‰é”™è¯¯é”™ä¸€æ¬¡å°±æ˜¯äº”åˆ†é’Ÿã€‚ T2 3387. ä¸¤å¤©è‡ªç”±å¤–æ±‡äº¤æ˜“åçš„æœ€å¤§è´§å¸æ•° 1. é¢˜ç›®å¤§æ„ ä½ åˆå§‹æ‹¥æœ‰ 1 å•","title":"LeetCode 1215 å‘¨èµ›"},{"content":"LeetCode 12/07 12/08 å‘¨èµ›/åŒå‘¨èµ› åŒå‘¨èµ› T3 3377. ä½¿ä¸¤ä¸ªæ•´æ•°ç›¸ç­‰çš„æ•°ä½æ“ä½œ é¢˜ç›®æ€»ç»“ï¼š ç»™å®šä¸¤ä¸ªæ•´æ•° n å’Œ mï¼Œè¦æ±‚å°† n è½¬å˜ä¸º mï¼Œè½¬å˜è¿‡ç¨‹ä¸­éœ€è¦æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š\nn å’Œ m çš„æ•°ä½é•¿åº¦ç›¸åŒï¼› å¯ä»¥å¯¹ nçš„æ•°ä½æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š å°† n ä¸­çš„ä»»æ„ä¸€ä¸ª ä¸æ˜¯ 9 çš„æ•°ä½ å¢åŠ  1ï¼› å°† n ä¸­çš„ä»»æ„ä¸€ä¸ª ä¸æ˜¯ 0 çš„æ•°ä½ å‡å°‘ 1ï¼› è½¬å˜è¿‡ç¨‹ä¸­ï¼Œn ä»»ä½•ä¸­é—´çŠ¶æ€éƒ½ ä¸èƒ½æ˜¯è´¨æ•°ï¼› éœ€è¦è¿”å›ä» n å˜ä¸º m çš„æœ€å°ä»£ä»·ï¼Œä»£ä»·ä¸ºè½¬å˜è¿‡ç¨‹ä¸­æ‰€æœ‰ n çš„å€¼ä¹‹å’Œï¼› å¦‚æœæ— æ³•å°† n å˜ä¸º mï¼Œè¿”å› -1ã€‚ å®ç°æ€è·¯ï¼š è´¨æ•°ç­›é€‰ï¼š ä½¿ç”¨çº¿æ€§ç­›æ³•ç”Ÿæˆ 1~10000 èŒƒå›´å†…çš„è´¨æ•°è¡¨ï¼Œç”¨å¸ƒå°”æ•°ç»„ st æ ‡è®°æ¯ä¸ªæ•°æ˜¯å¦ä¸ºè´¨æ•°ï¼Œé¿å…é‡å¤è®¡ç®—è´¨æ•°åˆ¤æ–­ã€‚ åˆ¤æ–­æ˜¯å¦æ˜¯è´¨æ•°ï¼š å®šä¹‰å‡½æ•° isPrime(x)ï¼Œé€šè¿‡ st[x] å¿«é€Ÿåˆ¤æ–­ä¸€ä¸ªæ•°æ˜¯å¦ä¸ºè´¨æ•°ã€‚ ç‰¹æ®Šæƒ…å†µè¿‡æ»¤ï¼š å¦‚æœ n æˆ– m æœ¬èº«æ˜¯è´¨æ•°ï¼Œåˆ™ç›´æ¥è¿”å› -1ï¼Œå› ä¸ºæ— æ³•æ»¡è¶³æ¡ä»¶ã€‚ æœ€çŸ­è·¯å¾„æ±‚è§£ï¼š ä½¿ç”¨ Dijkstra ç®—æ³• æ±‚è§£æœ€å°ä»£ä»·ã€‚ ç”¨ä¼˜å…ˆé˜Ÿåˆ—ï¼ˆå †ï¼‰å­˜å‚¨å½“å‰çš„å€¼å’Œè·¯å¾„ä»£ä»·ï¼Œèµ·ç‚¹ä¸º nï¼Œç»ˆç‚¹ä¸º mã€‚ éå†å½“å‰æ•°çš„æ¯ä¸€ä½ï¼Œåˆ†åˆ«å°è¯•å°†è¯¥ä½å¢åŠ æˆ–å‡å°‘ 1ï¼Œç”Ÿæˆæ–°çš„æ•°å­— new_nï¼š å¦‚æœ new_n ä¸ä¸ºè´¨æ•°ï¼Œå¹¶ä¸”æ›´æ–°çš„ä»£ä»·æ¯”å½“å‰å·²çŸ¥ä»£ä»·æ›´å°ï¼Œåˆ™å°†å…¶åŠ å…¥å †ä¸­ã€‚ é‡å¤ä»¥ä¸Šè¿‡ç¨‹ç›´åˆ°æ‰¾åˆ°ä» n åˆ° m çš„æœ€å°ä»£ä»·ã€‚ è¿”å›ç»“æœï¼š å¦‚æœåœ¨æœç´¢ä¸­æ‰¾åˆ°è·¯å¾„ï¼Œè¿”å›æœ€å°ä»£ä»·ï¼›å¦åˆ™è¿”å› -1 è¡¨ç¤ºæ— æ³•è½¬æ¢ã€‚ class Solution: def minOperations(self, n: int, m: int) -\u0026gt; int: N = 10000 primes = [] st = [False] * (N + 1) st[1] = True def sieve(n): for i in range(2, n + 1): if not st[i]: primes.append(i) for prime in primes: if i * prime \u0026gt; n: break st[i * prime] = True if i % prime == 0: break sieve(N) def isPrime(x): return not st[x] if isPrime(n) or isPrime(m): return -1 dis = [inf] * (N + 1) def dijkstra(): h = [(n, n)] dis[n] = n while h: dist, ver = heappop(h) if ver == m: return dist if dist \u0026gt; dis[ver]: continue str_n = list(str(ver)) for i in range(len(str_n)): ch = str_n[i] for delta in [-1, 1]: new_ch = chr(ord(ch) + delta) if \u0026#39;0\u0026#39; \u0026lt;= new_ch \u0026lt;= \u0026#39;9\u0026#39;: new_n = int(\u0026#34;\u0026#34;.join(str_n[:i] + [new_ch] + str_n[i+1:])) if not isPrime(new_n) and dist + new_n \u0026lt; dis[new_n]: dis[new_n] = dist + new_n heappush(h, (dis[new_n], new_n)) return dis[m] res = dijkstra() return res if res \u0026lt; inf else -1 T4 3378. ç»Ÿè®¡æœ€å°å…¬å€æ•°å›¾ä¸­çš„è¿é€šå—æ•°ç›® é¢˜ç›®å¤§æ„ é¢˜ç›®ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ nums å’Œä¸€ä¸ªæ­£æ•´æ•° thresholdï¼Œå®šä¹‰ä¸€å¼ ç”± nums çš„å…ƒç´ ç»„æˆçš„å›¾ã€‚å¦‚æœä¸¤ä¸ªèŠ‚ç‚¹å¯¹åº”çš„å€¼ nums[i] å’Œ nums[j] çš„æœ€å°å…¬å€æ•°ï¼ˆLCMï¼‰å°äºç­‰äº thresholdï¼Œåˆ™åœ¨å›¾ä¸­å°†ä¸¤ä¸ªèŠ‚ç‚¹ç›¸è¿ã€‚è¦æ±‚è¿”å›å›¾ä¸­ è¿é€šå—çš„æ•°é‡ï¼Œå³æ‰€æœ‰ç›¸äº’è¿é€šçš„èŠ‚ç‚¹ç»„æˆçš„ç‹¬ç«‹å­å›¾çš„æ•°é‡ã€‚\nè§£é¢˜æ€è·¯ ä¸ºäº†å®ç°é¢˜ç›®çš„è¦æ±‚ï¼Œæˆ‘ä»¬éœ€è¦è§£å†³ä»¥ä¸‹é—®é¢˜ï¼š\næ„å»ºå›¾çš„è¿é€šæ€§ï¼š æˆ‘ä»¬ä¸ç”¨æ˜¾å¼æ„å»ºå›¾ï¼Œè€Œæ˜¯åˆ©ç”¨å¹¶æŸ¥é›†ï¼ˆUnion-Findï¼‰æ¥åŠ¨æ€åˆå¹¶æ»¡è¶³æ¡ä»¶çš„èŠ‚ç‚¹ã€‚ å¦‚æœä¸¤ä¸ªå€¼ nums[i] å’Œ nums[j] æ»¡è¶³ LCM çš„æ¡ä»¶ï¼Œåˆ™åˆå¹¶å¯¹åº”çš„è¿é€šå—ã€‚ ä¼˜åŒ–æœ€å°å…¬å€æ•°çš„è®¡ç®—ï¼š å¯¹äºä»»æ„ä¸¤ä¸ªæ•° a å’Œ bï¼Œå®ƒä»¬çš„æœ€å°å…¬å€æ•°ï¼ˆLCMï¼‰å¯ä»¥é€šè¿‡å…¬å¼è®¡ç®—ï¼š lcm(a, b) = a * b / gcd(a, b) ç”±äº nums ä¸­å…ƒç´ äº’ä¸ç›¸åŒï¼Œå¯é€šè¿‡å› æ•°æ¥è¿›è¡Œç­›é€‰è€Œé¿å…ç›´æ¥è®¡ç®— LCMã€‚ é€šè¿‡å› æ•°ä¼˜åŒ–è¿æ¥è¿‡ç¨‹ï¼š ä»å°åˆ°å¤§éå†æ‰€æœ‰çš„å› æ•° gï¼ˆä» 1 åˆ° thresholdï¼‰ï¼Œå¯¹äº nums ä¸­èƒ½è¢« g æ•´é™¤çš„æ‰€æœ‰æ•°ï¼Œå°†è¿™äº›æ•°é€šè¿‡å¹¶æŸ¥é›†è¿›è¡Œåˆå¹¶ã€‚ è¿™æ ·å¯ä»¥é¿å…é€ä¸€æ£€æŸ¥ä»»æ„ä¸¤æ•°é—´çš„ LCMï¼Œæå¤§åœ°ä¼˜åŒ–æ€§èƒ½ã€‚ å¹¶æŸ¥é›†ç»´æŠ¤è¿é€šæ€§ï¼š ä½¿ç”¨è·¯å¾„å‹ç¼©å’ŒæŒ‰ç§©åˆå¹¶ä¼˜åŒ–çš„å¹¶æŸ¥é›†ï¼Œä¿è¯æŸ¥æ‰¾å’Œåˆå¹¶æ“ä½œçš„æ—¶é—´å¤æ‚åº¦æ¥è¿‘ O(1)ã€‚ class Solution: def countComponents(self, nums: List[int], threshold: int) -\u0026gt; int: n = len(nums) f = list(range(n)) # éé€’å½’å¹¶æŸ¥é›† def find(x: int) -\u0026gt; int: while x != f[x]: f[x] = f[f[x]] x = f[x] return x # è®°å½•æ¯ä¸ªæ•°çš„ä¸‹æ ‡ idx = {x: i for i, x in enumerate(nums)} for g in range(1, threshold + 1): fi = -1 for x in range(g, threshold + 1, g): if x in idx: fi = find(idx[x]) break if fi \u0026lt; 0: continue for y in range(x + g, g * threshold // x + 1, g): if y in idx: fj = find(idx[y]) if fj != fi: f[fj] = fi # åˆå¹¶ idx[x] å’Œ idx[y] n -= 1 return n å‘¨èµ› T3 3381. é•¿åº¦å¯è¢« K æ•´é™¤çš„å­æ•°ç»„çš„æœ€å¤§å…ƒç´ å’Œ é¢˜ç›®å¤§æ„ ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ nums å’Œä¸€ä¸ªæ•´æ•° kï¼Œè¦æ±‚æ‰¾åˆ°ä¸€ä¸ªéç©ºå­æ•°ç»„ï¼Œä½¿å¾—å…¶é•¿åº¦å¯ä»¥è¢« k æ•´é™¤ï¼ŒåŒæ—¶è¯¥å­æ•°ç»„çš„å’Œæœ€å¤§ã€‚è¿”å›è¿™ä¸ªå­æ•°ç»„çš„æœ€å¤§å’Œã€‚\nè§£é¢˜æ€è·¯ ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨å‰ç¼€å’Œçš„æ€æƒ³ï¼Œç»“åˆæ¨¡è¿ç®—æ¥å¤„ç†å­æ•°ç»„é•¿åº¦çš„æ•´é™¤æ€§é—®é¢˜ã€‚\næ ¸å¿ƒæ€æƒ³ å‰ç¼€å’Œæ€§è´¨ï¼š å¯¹äºä»»æ„å­æ•°ç»„ [i, j] çš„å’Œï¼Œå¯ä»¥ç”¨å‰ç¼€å’Œ s è¡¨ç¤ºï¼š å­æ•°ç»„å’Œ = s[j + 1] - s[i] å¦‚æœå­æ•°ç»„çš„é•¿åº¦ (j - i + 1) å¯ä»¥è¢« k æ•´é™¤ï¼Œåˆ™æœ‰ (j + 1) % k == i % kã€‚ å› æ­¤ï¼Œæˆ‘ä»¬åªéœ€è¦è®°å½•æ¯ä¸ªå‰ç¼€å’Œçš„æ¨¡ k çš„æœ€å°å€¼å³å¯ï¼Œéšåç”¨å½“å‰çš„å‰ç¼€å’Œå‡å»æ­¤å‰çš„æœ€å°å€¼å¾—åˆ°æœ€å¤§çš„å­æ•°ç»„å’Œã€‚ ä¼˜åŒ–å­˜å‚¨å’Œè®¡ç®—ï¼š ä½¿ç”¨ä¸€ä¸ªå“ˆå¸Œè¡¨ pre æ¥è®°å½•æ¯ä¸ªæ¨¡å€¼å¯¹åº”çš„æœ€å°å‰ç¼€å’Œã€‚ éå†æ•°ç»„æ—¶ï¼Œæ›´æ–°å½“å‰å‰ç¼€å’Œå¹¶æ£€æŸ¥æ˜¯å¦å­˜åœ¨æ»¡è¶³æ¡ä»¶çš„æ¨¡å€¼ï¼Œè®¡ç®—å‡ºå¯èƒ½çš„æœ€å¤§å­æ•°ç»„å’Œã€‚ ç‰¹æ®Šæƒ…å†µå¤„ç†ï¼š åˆå§‹æ—¶ï¼Œå‡è®¾å‰ç¼€å’Œä¸º 0 æ—¶ï¼Œæ¨¡å€¼ä¸º 0ï¼ˆå³å¯ä»¥æ•´é™¤ï¼‰ï¼Œå› æ­¤éœ€è¦åˆå§‹åŒ– pre[0] = 0ã€‚ class Solution: def maxSubarraySum(self, nums: List[int], k: int) -\u0026gt; int: n = len(nums) s = 0 pre = {0: 0} res = float(\u0026#39;-inf\u0026#39;) for i in range(n): s += nums[i] l_mod = (i + 1) % k # length mod if l_mod in pre: res = max(res, s - pre[l_mod]) if l_mod not in pre: pre[l_mod] = s else: pre[l_mod] = min(pre[l_mod], s) return res T4 3382. ç”¨ç‚¹æ„é€ é¢ç§¯æœ€å¤§çš„çŸ©å½¢ II é¢˜ç›®å¤§æ„ åœ¨æ— é™å¹³é¢ä¸Šï¼Œç»™å®šä¸€ç»„ç‚¹ (xCoord[i], yCoord[i])ï¼Œè¦æ±‚æ‰¾åˆ°å››ä¸ªç‚¹ç»„æˆçš„çŸ©å½¢ï¼Œæ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š\nçŸ©å½¢çš„å››ä¸ªé¡¶ç‚¹å¿…é¡»æ˜¯è¾“å…¥ç‚¹ä¸­çš„ç‚¹ï¼› çŸ©å½¢çš„å†…éƒ¨æˆ–è¾¹ç•Œä¸Šä¸èƒ½åŒ…å«ä»»ä½•å…¶ä»–ç‚¹ï¼› çŸ©å½¢çš„è¾¹ä¸åæ ‡è½´å¹³è¡Œã€‚ è¿”å›æ­¤ç±»çŸ©å½¢çš„æœ€å¤§é¢ç§¯ï¼Œå¦‚æœæ— æ³•å½¢æˆè¿™æ ·çš„çŸ©å½¢ï¼Œåˆ™è¿”å› -1ã€‚\nè§£é¢˜æ€è·¯ å…³é”®ç‚¹ åæ ‡æ˜ å°„ä¸æ’åºï¼š åˆ©ç”¨ xCoord å’Œ yCoord åˆ†åˆ«æ„é€ ç‚¹åœ¨æ¨ªåæ ‡å’Œçºµåæ ‡ä¸Šçš„åˆ†å¸ƒï¼Œå¹¶è®°å½•æ¯ä¸ªç‚¹çš„ä¿¡æ¯ã€‚ é€šè¿‡å¯¹æ¨ªåæ ‡å’Œçºµåæ ‡çš„æ’åºï¼Œä¾¿äºæšä¸¾å¯èƒ½çš„çŸ©å½¢ç‚¹å¯¹ã€‚ æ„é€ è§„åˆ™çŸ©å½¢ï¼š æšä¸¾æ¯ä¸ªç‚¹ä½œä¸ºå³ä¸Šè§’ (x2, y2)ï¼Œå¹¶é€šè¿‡é¢„å¤„ç†æ‰¾åˆ°ï¼š å·¦ä¸‹è§’ (x1, y1)ï¼› çŸ©å½¢å·¦ä¸Šè§’ (x1, y2)ï¼› çŸ©å½¢å³ä¸‹è§’ (x2, y1)ã€‚ é€šè¿‡è¿™äº›ç‚¹ç¡®å®šçŸ©å½¢çš„è¾¹ç•Œï¼Œå¹¶è¿›è¡ŒéªŒè¯ã€‚ çŸ©å½¢å†…ç‚¹çš„éªŒè¯ï¼š æ„é€ æ ‘çŠ¶æ•°ç»„ï¼ˆæˆ–å…¶ä»–æ•°æ®ç»“æ„ï¼‰æ”¯æŒå¿«é€Ÿç»Ÿè®¡æŸä¸ªçŸ©å½¢èŒƒå›´å†…çš„ç‚¹æ•°ã€‚ é€šè¿‡ç¦»çº¿å¤„ç†æ‰€æœ‰å¯èƒ½çš„çŸ©å½¢èŒƒå›´ï¼Œåˆ©ç”¨å‰ç¼€å’Œæˆ–æ ‘çŠ¶æ•°ç»„è¿›è¡Œæ‰¹é‡æŸ¥è¯¢ï¼Œç¡®ä¿æ•ˆç‡ã€‚ è®°å½•é¢ç§¯ï¼š å¦‚æœä¸€ä¸ªçŸ©å½¢æ»¡è¶³æ¡ä»¶ä¸”æ­£å¥½åŒ…å« 4 ä¸ªé¡¶ç‚¹ï¼Œåˆ™è®¡ç®—å…¶é¢ç§¯å¹¶ä¸å½“å‰æœ€å¤§é¢ç§¯æ¯”è¾ƒã€‚ # æ ‘çŠ¶æ•°ç»„æ¨¡æ¿ class Fenwick: def __init__(self, n: int): self.tree = [0] * (n + 1) def add(self, i: int) -\u0026gt; None: while i \u0026lt; len(self.tree): self.tree[i] += 1 i += i \u0026amp; -i # [1,i] ä¸­çš„å…ƒç´ å’Œ def pre(self, i: int) -\u0026gt; int: res = 0 while i \u0026gt; 0: res += self.tree[i] i \u0026amp;= i - 1 return res # [l,r] ä¸­çš„å…ƒç´ å’Œ def query(self, l: int, r: int) -\u0026gt; int: return self.pre(r) - self.pre(l - 1) class Solution: def maxRectangleArea(self, xCoord: List[int], yCoord: List[int]) -\u0026gt; int: x_map = defaultdict(list) y_map = defaultdict(list) for i, x in enumerate(xCoord): y = yCoord[i] x_map[x].append(y) y_map[y].append(x) # é¢„å¤„ç†æ¯ä¸ªç‚¹çš„æ­£ä¸‹æ–¹çš„ç‚¹ below = {} for x, ys in x_map.items(): ys.sort() for y1, y2 in pairwise(ys): below[(x, y2)] = y1 # é¢„å¤„ç†æ¯ä¸ªç‚¹çš„æ­£å·¦è¾¹çš„ç‚¹ left = {} for y, xs in y_map.items(): xs.sort() for x1, x2 in pairwise(xs): left[(x2, y)] = x1 # ç¦»æ•£åŒ–ç”¨ xs = sorted(x_map) ys = sorted(y_map) # æ”¶é›†è¯¢é—®ï¼šçŸ©å½¢åŒºåŸŸï¼ˆåŒ…æ‹¬è¾¹ç•Œï¼‰çš„ç‚¹çš„ä¸ªæ•° queries = [] # æšä¸¾ (x2,y2) ä½œä¸ºçŸ©å½¢çš„å³ä¸Šè§’ for x2, list_y in x_map.items(): for y1, y2 in pairwise(list_y): # è®¡ç®—çŸ©å½¢å·¦ä¸‹è§’ (x1,y1) x1 = left.get((x2, y2), None) # çŸ©å½¢å³ä¸‹è§’çš„å·¦è¾¹çš„ç‚¹çš„æ¨ªåæ ‡å¿…é¡»æ˜¯ x1 # çŸ©å½¢å·¦ä¸Šè§’çš„ä¸‹è¾¹çš„ç‚¹çš„çºµåæ ‡å¿…é¡»æ˜¯ y1 if x1 is not None and left.get((x2, y1), None) == x1 and below.get((x1, y2), None) == y1: queries.append(( bisect_left(xs, x1), # ç¦»æ•£åŒ– bisect_left(xs, x2), bisect_left(ys, y1), bisect_left(ys, y2), (x2 - x1) * (y2 - y1), )) # ç¦»çº¿è¯¢é—® qs = [[] for _ in range(len(xs))] for i, (x1, x2, y1, y2, _) in enumerate(queries): if x1 \u0026gt; 0: qs[x1 - 1].append((i, -1, y1, y2)) qs[x2].append((i, 1, y1, y2)) # å›ç­”è¯¢é—® res = [0] * len(queries) tree = Fenwick(len(ys)) for i, x in enumerate(xs): # æŠŠæ¨ªåæ ‡ä¸º x çš„æ‰€æœ‰ç‚¹éƒ½åŠ åˆ°æ ‘çŠ¶æ•°ç»„ä¸­ for y in x_map[x]: tree.add(bisect_left(ys, y) + 1) # ç¦»æ•£åŒ– for qid, sign, y1, y2 in qs[i]: # æŸ¥è¯¢ [y1,y2] ä¸­ç‚¹çš„ä¸ªæ•° res[qid] += sign * tree.query(y1 + 1, y2 + 1) ans = -1 for cnt, q in zip(res, queries): if cnt == 4: ans = max(ans, q[4]) return ans ","permalink":"https://kennems.github.io/posts/tech/leetcode-1207-1208-%E5%91%A8%E8%B5%9B%E5%8F%8C%E5%91%A8%E8%B5%9B/","summary":"LeetCode 12/07 12/08 å‘¨èµ›/åŒå‘¨èµ› åŒå‘¨èµ› T3 3377. ä½¿ä¸¤ä¸ªæ•´æ•°ç›¸ç­‰çš„æ•°ä½æ“ä½œ é¢˜ç›®æ€»ç»“ï¼š ç»™å®šä¸¤ä¸ªæ•´æ•° n å’Œ mï¼Œè¦æ±‚å°† n è½¬å˜ä¸º mï¼Œè½¬å˜è¿‡ç¨‹ä¸­éœ€è¦æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š n å’Œ m çš„æ•°ä½","title":"LeetCode 12/07 12/08 å‘¨èµ›/åŒå‘¨èµ›"},{"content":"LeetCode Hot 100 ç²¾ç»ƒğŸ¥¸(2) è®°å¿†ä¸­çš„ä¸œè¥¿ä¸€å®šä¼šæ¶ˆé€€ï¼ŒçœŸæ­£ç•™ä¸‹çš„æ‰æ˜¯å­¦åˆ°çš„ï¼Œä¸€å®šè¦åŠæ—¶å›é¡¾ã€‚\n215. æ•°ç»„ä¸­çš„ç¬¬Kä¸ªæœ€å¤§å…ƒç´  é¢˜ç›®å¤§æ„ï¼š ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ nums å’Œä¸€ä¸ªæ•´æ•° kï¼Œè¦æ±‚è¿”å›æ•°ç»„ä¸­æ’åºåçš„ç¬¬ k ä¸ªæœ€å¤§çš„å…ƒç´ ã€‚ä½ å¿…é¡»è®¾è®¡ä¸€ä¸ªæ—¶é—´å¤æ‚åº¦ä¸º O(n) çš„ç®—æ³•æ¥è§£å†³æ­¤é—®é¢˜ã€‚\næ€è·¯åˆ†æï¼š å¿«é€Ÿé€‰æ‹©ç®—æ³•ï¼š è¯¥é¢˜çš„æ ¸å¿ƒæ€æƒ³æ˜¯åˆ©ç”¨å¿«é€Ÿæ’åºçš„æ€æƒ³ï¼Œé€šè¿‡åˆ†æ²»çš„æ–¹å¼æ¥æ‰¾åˆ°ç¬¬ k ä¸ªæœ€å¤§å…ƒç´ ã€‚ä¼ ç»Ÿçš„å¿«é€Ÿæ’åºæ—¶é—´å¤æ‚åº¦æ˜¯ O(n log n)ï¼Œä½†é€šè¿‡æ”¹é€ å¿«é€Ÿæ’åºæˆå¿«é€Ÿé€‰æ‹©ç®—æ³•ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ—¶é—´å¤æ‚åº¦é™ä½åˆ° O(n)ï¼Œä»è€Œæ»¡è¶³é¢˜ç›®çš„è¦æ±‚ã€‚ ç®—æ³•æ­¥éª¤ï¼š é€‰æ‹©æ¢çº½å…ƒç´ ï¼šé€‰æ‹©æ•°ç»„ä¸­çš„ä¸€ä¸ªå…ƒç´ ä½œä¸ºæ¢çº½ï¼ˆé€šå¸¸æ˜¯æ•°ç»„çš„ä¸­é—´å…ƒç´ ï¼‰ã€‚ åˆ†åŒºï¼šå°†æ•°ç»„åˆ†æˆä¸¤ä¸ªéƒ¨åˆ†ï¼šä¸€éƒ¨åˆ†æ‰€æœ‰å…ƒç´ éƒ½å¤§äºç­‰äºæ¢çº½ï¼Œå¦ä¸€éƒ¨åˆ†æ‰€æœ‰å…ƒç´ éƒ½å°äºæ¢çº½ã€‚ é€’å½’æŸ¥æ‰¾ï¼šå¦‚æœ k æ¯”è¾ƒæ¥è¿‘å³åŠéƒ¨åˆ†çš„å…ƒç´ ï¼Œåˆ™åœ¨å³åŠéƒ¨åˆ†ç»§ç»­æŸ¥æ‰¾ï¼›å¦‚æœ k æ¯”è¾ƒæ¥è¿‘å·¦åŠéƒ¨åˆ†çš„å…ƒç´ ï¼Œåˆ™åœ¨å·¦åŠéƒ¨åˆ†ç»§ç»­æŸ¥æ‰¾ã€‚ å®ç°æ­¥éª¤ï¼š åœ¨æ¯æ¬¡åˆ’åˆ†åï¼Œé€šè¿‡æ¯”è¾ƒ k çš„ä½ç½®æ¥å†³å®šç»§ç»­å¤„ç†å“ªä¸€éƒ¨åˆ†ã€‚ å½“æ‰¾åˆ°çš„å…ƒç´ åˆšå¥½æ˜¯ç¬¬ k ä¸ªæœ€å¤§çš„å…ƒç´ æ—¶ï¼Œè¿”å›è¯¥å…ƒç´ ã€‚ class Solution: def findKthLargest(self, nums: List[int], k: int) -\u0026gt; int: def qs(q, l, r, k): if l \u0026gt;= r: return i, j, x = l - 1, r + 1, q[l + r \u0026gt;\u0026gt; 1] while i \u0026lt; j: i += 1 while q[i] \u0026lt; x: i += 1 j -= 1 while q[j] \u0026gt; x: j -= 1 if i \u0026lt; j: q[i], q[j] = q[j], q[i] if j \u0026lt; k: qs(q, j + 1, r, k) else: qs(q, l, j, k) # qs(q, i, j, k) # qs(q, j + 1, r, k) n = len(nums) k = n - k # n - 1 - k + 1 qs(nums, 0, n - 1, k) return nums[k] 208. å®ç° Trie (å‰ç¼€æ ‘) é¢˜ç›®å¤§æ„ï¼š å®ç°ä¸€ä¸ª Trieï¼ˆå‰ç¼€æ ‘ï¼‰ æ•°æ®ç»“æ„ï¼Œå®ƒæ”¯æŒä»¥ä¸‹ä¸‰ç§æ“ä½œï¼š\ninsert(String word)ï¼šå‘å‰ç¼€æ ‘ä¸­æ’å…¥ä¸€ä¸ªå­—ç¬¦ä¸² wordã€‚ search(String word)ï¼šæ£€æŸ¥å­—ç¬¦ä¸² word æ˜¯å¦å·²ç»å­˜åœ¨äºå‰ç¼€æ ‘ä¸­ã€‚ startsWith(String prefix)ï¼šæ£€æŸ¥æ˜¯å¦æœ‰å·²æ’å…¥çš„å­—ç¬¦ä¸²ä»¥ prefix ä½œä¸ºå‰ç¼€ã€‚ æ€è·¯åˆ†æï¼š æ•°æ®ç»“æ„é€‰æ‹©ï¼š ä½¿ç”¨å­—å…¸ï¼ˆdictï¼‰æ¥è¡¨ç¤ºå‰ç¼€æ ‘çš„èŠ‚ç‚¹ã€‚æ¯ä¸ªèŠ‚ç‚¹çš„é”®æ˜¯å­—ç¬¦ï¼Œå€¼æ˜¯ä¸‹ä¸€ä¸ªèŠ‚ç‚¹æˆ–è€…ä¸€ä¸ªç‰¹æ®Šæ ‡è®°ï¼ˆå¦‚ '#'ï¼‰æ¥è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦ä¸²çš„ç»“æŸã€‚ æ’å…¥æ“ä½œ (insert)ï¼š ä»æ ¹èŠ‚ç‚¹å¼€å§‹ï¼Œé€ä¸ªå­—ç¬¦æ£€æŸ¥è¯¥å­—ç¬¦æ˜¯å¦å­˜åœ¨äºå½“å‰èŠ‚ç‚¹çš„å­—å…¸ä¸­ã€‚å¦‚æœä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºæ–°çš„èŠ‚ç‚¹ã€‚ å½“å­—ç¬¦ä¸²éå†å®Œæ¯•æ—¶ï¼Œè®¾ç½®ä¸€ä¸ªç‰¹æ®Šçš„æ ‡è®°ï¼ˆä¾‹å¦‚ '#'ï¼‰æ¥æ ‡è®°è¯¥èŠ‚ç‚¹ä¸ºä¸€ä¸ªå®Œæ•´å•è¯çš„ç»“å°¾ã€‚ æŸ¥æ‰¾æ“ä½œ (search)ï¼š ä»æ ¹èŠ‚ç‚¹å¼€å§‹ï¼Œé€ä¸ªå­—ç¬¦æŸ¥æ‰¾ï¼Œè‹¥ä»»æ„å­—ç¬¦ä¸å­˜åœ¨ï¼Œåˆ™è¿”å› Falseã€‚ å¦‚æœæŸ¥æ‰¾åˆ°å­—ç¬¦ä¸²æœ«å°¾ï¼Œå¹¶ä¸”è¯¥èŠ‚ç‚¹æœ‰ '#' æ ‡è®°ï¼Œåˆ™è¿”å› Trueï¼Œè¡¨ç¤ºè¯¥å­—ç¬¦ä¸²å·²ç»æ’å…¥ã€‚ å‰ç¼€æŸ¥æ‰¾æ“ä½œ (startsWith)ï¼š ç±»ä¼¼ searchï¼Œä½†ä¸éœ€è¦åˆ¤æ–­æ˜¯å¦åˆ°è¾¾å­—ç¬¦ä¸²æœ«å°¾ï¼Œåªè¦èƒ½å¤Ÿéå†å®Œå‰ç¼€å³å¯ã€‚ class Trie: def __init__(self): self.trie = {} def insert(self, word: str) -\u0026gt; None: cur = self.trie for ch in word: if ch not in cur: cur[ch] = {} cur = cur[ch] cur[\u0026#39;#\u0026#39;] = True def search(self, word: str) -\u0026gt; bool: cur = self.trie for ch in word: if ch not in cur: return False cur = cur[ch] return cur[\u0026#39;#\u0026#39;] if \u0026#39;#\u0026#39; in cur else False def startsWith(self, prefix: str) -\u0026gt; bool: cur = self.trie for ch in prefix: if ch not in cur: return False cur = cur[ch] return True 146. LRU ç¼“å­˜ é¢˜ç›®å¤§æ„ï¼š è®¾è®¡å¹¶å®ç°ä¸€ä¸ªæ”¯æŒ LRUï¼ˆæœ€è¿‘æœ€å°‘ä½¿ç”¨ï¼‰ç¼“å­˜çš„æ•°æ®ç»“æ„ï¼Œè¯¥ç¼“å­˜å…·æœ‰ä»¥ä¸‹åŠŸèƒ½ï¼š\nget(key)ï¼šå¦‚æœå…³é”®å­— key å­˜åœ¨äºç¼“å­˜ä¸­ï¼Œåˆ™è¿”å›å…¶å¯¹åº”çš„å€¼ï¼›å¦åˆ™ï¼Œè¿”å› -1ã€‚ put(key, value)ï¼šå°† key ä¸ value å­˜å…¥ç¼“å­˜ã€‚å¦‚æœç¼“å­˜å®¹é‡å·²æ»¡ï¼Œåˆ™åˆ é™¤æœ€è¿‘æœ€å°‘ä½¿ç”¨çš„å…ƒç´ ã€‚ è¦æ±‚ï¼š\nget å’Œ put æ“ä½œéƒ½å¿…é¡»åœ¨ O(1) çš„å¹³å‡æ—¶é—´å¤æ‚åº¦å†…å®Œæˆã€‚ æ€è·¯åˆ†æï¼š LRU ç¼“å­˜è¦æ±‚æœ€è¿‘è®¿é—®çš„å…ƒç´ ä¿æŒåœ¨ç¼“å­˜ä¸­ï¼Œè€Œæœ€ä¹…æœªè®¿é—®çš„å…ƒç´ è¢«æ·˜æ±°ã€‚ä¸ºäº†å®ç°è¿™ä¸ªåŠŸèƒ½ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ä¸ª åŒå‘é“¾è¡¨ å’Œä¸€ä¸ª å“ˆå¸Œè¡¨ã€‚\næ•°æ®ç»“æ„è®¾è®¡ï¼š åŒå‘é“¾è¡¨ï¼š åŒå‘é“¾è¡¨çš„èŠ‚ç‚¹åŒ…å« key å’Œ valueã€‚ ç»´æŠ¤ä¸¤ä¸ªè™šæ‹ŸèŠ‚ç‚¹ï¼Œheadï¼ˆå¤´éƒ¨ï¼‰å’Œ tailï¼ˆå°¾éƒ¨ï¼‰ã€‚head çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹æ˜¯æœ€å…ˆè®¿é—®çš„èŠ‚ç‚¹ï¼Œè€Œ tail çš„å‰ä¸€ä¸ªèŠ‚ç‚¹æ˜¯æœ€è¿‘è®¿é—®çš„èŠ‚ç‚¹ã€‚ å½“ä¸€ä¸ªèŠ‚ç‚¹è¢«è®¿é—®æˆ–æ’å…¥æ—¶ï¼Œå®ƒä¼šè¢«ç§»åŠ¨åˆ°é“¾è¡¨çš„å¤´éƒ¨ï¼›å½“ç¼“å­˜æ»¡æ—¶ï¼Œæˆ‘ä»¬ä¼šç§»é™¤å°¾éƒ¨çš„èŠ‚ç‚¹ï¼ˆæœ€ä¹…æœªä½¿ç”¨ï¼‰ã€‚ å“ˆå¸Œè¡¨ï¼š å“ˆå¸Œè¡¨ç”¨äºå­˜å‚¨ç¼“å­˜çš„ key å’Œå¯¹åº”çš„èŠ‚ç‚¹ã€‚è¿™æ ·æˆ‘ä»¬å¯ä»¥é€šè¿‡ key å¿«é€Ÿæ‰¾åˆ°å¯¹åº”çš„èŠ‚ç‚¹ï¼Œå¹¶è¿›è¡Œ O(1) çš„æ“ä½œã€‚ ä¸»è¦æ“ä½œï¼š get(key)ï¼š æŸ¥æ‰¾å“ˆå¸Œè¡¨ä¸­æ˜¯å¦å­˜åœ¨è¯¥ keyã€‚å¦‚æœå­˜åœ¨ï¼Œå°†å¯¹åº”çš„èŠ‚ç‚¹ç§»åŠ¨åˆ°é“¾è¡¨çš„å¤´éƒ¨ï¼Œå¹¶è¿”å›å…¶å€¼ã€‚å¦‚æœä¸å­˜åœ¨ï¼Œè¿”å› -1ã€‚ put(key, value)ï¼š å¦‚æœ key å·²å­˜åœ¨ï¼Œåˆ™æ›´æ–°èŠ‚ç‚¹çš„å€¼å¹¶å°†å…¶ç§»åˆ°é“¾è¡¨å¤´éƒ¨ã€‚ å¦‚æœ key ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºä¸€ä¸ªæ–°èŠ‚ç‚¹å¹¶æ’å…¥é“¾è¡¨å¤´éƒ¨ã€‚å¦‚æœç¼“å­˜å·²æ»¡ï¼Œç§»é™¤å°¾éƒ¨èŠ‚ç‚¹ã€‚ class DoubleLinkedList: def __init__(self, key = 0, value = 0): self.key = key self.value = value self.pre = None self.next = None class LRUCache: def __init__(self, capacity: int): self.capacity = capacity self.size = 0 self.cache = dict() self.head = DoubleLinkedList() self.tail = DoubleLinkedList() self.head.next = self.tail self.tail.pre = self.head def get(self, key: int) -\u0026gt; int: if key not in self.cache: return -1 node = self.cache[key] self.moveToHead(node) return node.value def put(self, key: int, value: int) -\u0026gt; None: if key in self.cache: node = self.cache[key] node.value = value self.moveToHead(node) else: node = DoubleLinkedList(key, value) self.cache[key] = node if self.size \u0026lt; self.capacity: self.size += 1 else: tail = self.removeTail() del self.cache[tail.key] self.addToHead(node) def removeNode(self, node): node.next.pre = node.pre node.pre.next = node.next def addToHead(self, node): node.next = self.head.next node.pre = self.head self.head.next.pre = node self.head.next = node def moveToHead(self, node): self.removeNode(node) self.addToHead(node) def removeTail(self): node = self.tail.pre self.removeNode(node) return node 124. äºŒå‰æ ‘ä¸­çš„æœ€å¤§è·¯å¾„å’Œ é¢˜ç›®å¤§æ„ï¼š ç»™å®šä¸€æ£µäºŒå‰æ ‘ï¼Œè¦æ±‚æ‰¾å‡ºå…¶ä¸­è·¯å¾„çš„æœ€å¤§å’Œã€‚è·¯å¾„å¯ä»¥ç»è¿‡ä»»æ„èŠ‚ç‚¹ï¼Œä½†æ¯ä¸ªèŠ‚ç‚¹æœ€å¤šåªèƒ½è¢«ä½¿ç”¨ä¸€æ¬¡ã€‚è·¯å¾„çš„å®šä¹‰æ˜¯ä»ä¸€ä¸ªèŠ‚ç‚¹åˆ°å¦ä¸€ä¸ªèŠ‚ç‚¹çš„è¿ç»­è·¯å¾„ï¼Œè·¯å¾„å’Œæ˜¯è·¯å¾„ä¸­æ‰€æœ‰èŠ‚ç‚¹å€¼çš„å’Œã€‚\nå®ç°æ€è·¯ï¼š DFSéå†ï¼š é‡‡ç”¨æ·±åº¦ä¼˜å…ˆæœç´¢ (DFS) æ¥éå†äºŒå‰æ ‘ï¼Œè®¡ç®—ä»¥æ¯ä¸ªèŠ‚ç‚¹ä¸ºèµ·ç‚¹çš„è·¯å¾„å’Œã€‚ é€’å½’çš„è¿”å›å€¼ï¼š å¯¹æ¯ä¸ªèŠ‚ç‚¹ï¼Œæˆ‘ä»¬éœ€è¦è®¡ç®—å…¶åŒ…å«å·¦å­æ ‘å’Œå³å­æ ‘çš„æœ€å¤§è´¡çŒ®å€¼ã€‚ä¸ºäº†è®¡ç®—æœ€å¤§è·¯å¾„å’Œï¼Œæˆ‘ä»¬éœ€è¦è€ƒè™‘ä»¥ä¸‹ä¸¤ç§æƒ…å†µï¼š è·¯å¾„å’Œï¼šèŠ‚ç‚¹è‡ªèº«çš„å€¼åŠ ä¸Šå…¶å·¦æˆ–å³å­æ ‘çš„æœ€å¤§è·¯å¾„å’Œã€‚ è·¯å¾„é€šè¿‡å½“å‰èŠ‚ç‚¹ï¼šè€ƒè™‘ä»å½“å‰èŠ‚ç‚¹å‡ºå‘ï¼Œå·¦å­æ ‘ã€å³å­æ ‘éƒ½å‚ä¸çš„è·¯å¾„ã€‚ æœ€å¤§è·¯å¾„å’Œçš„æ›´æ–°ï¼š é€’å½’è¿‡ç¨‹ä¸­ç»´æŠ¤ä¸€ä¸ªå…¨å±€å˜é‡ resï¼Œè®°å½•å½“å‰æœ€å¤§çš„è·¯å¾„å’Œã€‚å¯¹äºæ¯ä¸ªèŠ‚ç‚¹ï¼Œè®¡ç®—å…¶é€šè¿‡å·¦å­æ ‘å’Œå³å­æ ‘çš„è·¯å¾„å’Œï¼Œç„¶åæ›´æ–° resã€‚ é€’å½’è¿”å›ï¼š æ¯æ¬¡é€’å½’è¿”å›çš„æ˜¯â€œå½“å‰èŠ‚ç‚¹åŠå…¶å·¦å³å­æ ‘è·¯å¾„çš„æœ€å¤§å’Œâ€ï¼Œå³ä¸€ä¸ªèŠ‚ç‚¹åˆ°å…¶çˆ¶èŠ‚ç‚¹çš„è·¯å¾„å’Œã€‚ class Solution: def maxPathSum(self, root: Optional[TreeNode]) -\u0026gt; int: res = -inf def dfs(r): if not r: return 0 nonlocal res d1 = dfs(r.left) d2 = dfs(r.right) cur = max(r.val, r.val + max(d1, d2)) res = max(res, cur, r.val + d1 + d2) return cur dfs(root) return res ","permalink":"https://kennems.github.io/posts/tech/leetcode-hot-100-2-/","summary":"LeetCode Hot 100 ç²¾ç»ƒğŸ¥¸(2) è®°å¿†ä¸­çš„ä¸œè¥¿ä¸€å®šä¼šæ¶ˆé€€ï¼ŒçœŸæ­£ç•™ä¸‹çš„æ‰æ˜¯å­¦åˆ°çš„ï¼Œä¸€å®šè¦åŠæ—¶å›é¡¾ã€‚ 215. æ•°ç»„ä¸­çš„ç¬¬Kä¸ªæœ€å¤§å…ƒç´  é¢˜ç›®å¤§æ„ï¼š ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ nums å’Œä¸€ä¸ªæ•´","title":"LeetCode Hot 100 ç²¾ç»ƒğŸ¥¸(2)"},{"content":"é»‘é©¬å¤´æ¡ï¼ˆ2ï¼‰ ä»ä¸šåŠ¡è§’åº¦åˆ†æå¦‚ä½•åˆ†è¡¨ æ»šå±åˆ†é¡µçš„é€»è¾‘ å¤§æ–‡æœ¬é™æ€åŒ–æ–¹æ¡ˆï¼š\nfreemarker minio è¡¨çš„æ‹†åˆ†-å‚ç›´åˆ†è¡¨ å‚ç›´åˆ†è¡¨ï¼šå°†ä¸€ä¸ªè¡¨çš„å­—æ®µåˆ†æ•£åˆ°å¤šä¸ªè¡¨ä¸­ï¼Œæ¯ä¸ªè¡¨å­˜å‚¨å…¶ä¸­ä¸€éƒ¨åˆ†å­—æ®µã€‚\nä¼˜åŠ¿ï¼š\nå‡å°‘IOäº‰æŠ¢ï¼Œå‡å°‘é”è¡¨çš„å‡ ç‡ï¼ŒæŸ¥çœ‹æ–‡ç« æ¦‚è¿°ä¸æ–‡ç« è¯¦æƒ…äº’ä¸å½±å“ å……åˆ†å‘æŒ¥é«˜é¢‘æ•°æ®çš„æ“ä½œæ•ˆç‡ï¼Œå¯¹æ–‡ç« æ¦‚è¿°æ•°æ®çš„æ“ä½œçš„é«˜æ•ˆç‡ä¸ä¼šè¢«æ“ä½œæ–‡ç« è¯¦æƒ…æ•°æ®çš„ä½æ•ˆç‡æ‰€æ‹–ç´¯ æ‹†åˆ†è§„åˆ™ï¼š\næŠŠä¸å¸¸ç”¨çš„å­—æ®µå•ç‹¬æ”¾åœ¨ä¸€å¼ è¡¨ æŠŠtextã€blobç­‰å¤§å­—æ®µæ‹†åˆ†å‡ºæ¥å•ç‹¬æ”¾åœ¨ä¸€å¼ è¡¨ ç»å¸¸ç»„åˆæŸ¥è¯¢çš„å­—æ®µå•ç‹¬æ”¾åœ¨ä¸€å¼ è¡¨ä¸­ æ–‡ç« è¯¦æƒ… FreeMarker FreeMarkeræ˜¯ä¸€æ¬¾æ¨¡æ¿å¼•æ“ï¼šå³ä¸€ç§åŸºäºæ¨¡æ¿å’Œè¦æ”¹å˜çš„æ•°æ®ï¼Œå¹¶ç”¨æ¥ç”Ÿæˆè¾“å‡ºæ–‡æœ¬ï¼ˆHTMLç½‘é¡µï¼Œç”µå­é‚®ä»¶ï¼Œé…ç½®æ–‡ä»¶ï¼ŒåŸä»£ç ç­‰ï¼‰çš„é€šç”¨å·¥å…·ã€‚å®ƒä¸æ˜¯é¢å‘æœ€ç»ˆç”¨æˆ·çš„ï¼Œè€Œæ˜¯ä¸€ä¸ªJavaç±»åº“ï¼Œæ˜¯ä¸€æ¬¾ç¨‹åºå‘˜å¯ä»¥åµŒå…¥æ‰€å¼€å‘äº§å“çš„ç»„ä»¶ã€‚\nä¾èµ–å¯¼å…¥ï¼š \u0026lt;dependencies\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;junit\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;junit\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;3.8.1\u0026lt;/version\u0026gt; \u0026lt;scope\u0026gt;test\u0026lt;/scope\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.boot\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-boot-starter-web\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.boot\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-boot-starter-freemarker\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.boot\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-boot-starter-test\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;!-- lombok --\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.projectlombok\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;lombok\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;!-- apache å¯¹ java io çš„å°è£…å·¥å…·åº“ --\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.apache.commons\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;commons-io\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.3.2\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;/dependencies\u0026gt; controllerä¸­æŒ‡å®šå¯¹åº”çš„æ•°æ®ï¼š @Controller public class HelloController { @GetMapping(\u0026#34;/basic\u0026#34;) public String hello(Model model){ // name model.addAttribute(\u0026#34;name\u0026#34;, \u0026#34;freemarker\u0026#34;); Student student = new Student(); student.setName(\u0026#34;Kennem\u0026#34;); student.setAge(21); student.setBirthday(new Date(2003, 1, 15)); model.addAttribute(\u0026#34;stu\u0026#34;, student); return \u0026#34;01-basic\u0026#34;; } } templateä¸­æŒ‡å®šå¯¹åº”çš„æ ·å¼ï¼š01-basic.ftl æœ€ç»ˆæ ·å¼ï¼š\nFreemarkeræŒ‡ä»¤è¯­æ³• æ³¨é‡Šï¼Œå³\u0026lt;#â€“ â€“\u0026gt;ï¼Œä»‹äºå…¶ä¹‹é—´çš„å†…å®¹ä¼šè¢«freemarkerå¿½ç•¥ \u0026lt;#--è¿™é‡Œæ˜¯æ³¨é‡Š--\u0026gt; æ’å€¼ï¼ˆInterpolationï¼‰ï¼šå³${..}éƒ¨åˆ†ï¼Œfreemarkerä¼šç”¨çœŸå®çš„å€¼ä»£æ›¿${..} Hello ${name} FTLæŒ‡ä»¤ï¼šå’ŒHTMLæ ‡è®°ç±»ä¼¼ï¼Œåå­—å‰åŠ #äºˆä»¥åŒºåˆ†ï¼ŒFreemarkerä¼šè§£ææ ‡ç­¾ä¸­çš„è¡¨è¾¾å¼æˆ–é€»è¾‘ã€‚ \u0026lt;# \u0026gt;FTLæŒ‡ä»¤\u0026lt;/#\u0026gt; æ–‡æœ¬ï¼Œä»…æ–‡æœ¬ä¿¡æ¯ï¼Œè¿™äº›ä¸æ˜¯freemarkerçš„æ³¨é‡Šã€æ’å€¼ã€FTLæŒ‡ä»¤çš„å†…å®¹ä¼šè¢«freemarkerå¿½ç•¥ \u0026lt;#-- freemarkerä¸­çš„æ™®é€šæ–‡æœ¬ --\u0026gt;\rè¿™æ˜¯æ™®é€šæ–‡æœ¬ é›†åˆæŒ‡ä»¤-List \u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;utf-8\u0026#34;\u0026gt; \u0026lt;title\u0026gt;Hello World!\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;#--List æ•°æ®å±•ç¤º--\u0026gt; \u0026lt;b\u0026gt;List æ•°æ®å±•ç¤ºï¼š\u0026lt;/b\u0026gt; \u0026lt;br\u0026gt;\u0026lt;br\u0026gt; \u0026lt;table\u0026gt; \u0026lt;tr\u0026gt; \u0026lt;td\u0026gt;åºå·\u0026lt;/td\u0026gt; \u0026lt;td\u0026gt;å§“å\u0026lt;/td\u0026gt; \u0026lt;td\u0026gt;å¹´é¾„\u0026lt;/td\u0026gt; \u0026lt;td\u0026gt;é’±åŒ…\u0026lt;/td\u0026gt; \u0026lt;/tr\u0026gt; \u0026lt;#list stus as stu\u0026gt; \u0026lt;tr\u0026gt; \u0026lt;td\u0026gt;${stu_index + 1}\u0026lt;/td\u0026gt; \u0026lt;td\u0026gt;${stu.name}\u0026lt;/td\u0026gt; \u0026lt;td\u0026gt;${stu.age}\u0026lt;/td\u0026gt; \u0026lt;td\u0026gt;${stu.money}\u0026lt;/td\u0026gt; \u0026lt;/tr\u0026gt; \u0026lt;/#list\u0026gt; \u0026lt;/table\u0026gt; \u0026lt;hr\u0026gt; \u0026lt;#--Map æ•°æ®å±•ç¤º--\u0026gt; \u0026lt;b\u0026gt;Map æ•°æ®å±•ç¤ºï¼š\u0026lt;/b\u0026gt;\u0026lt;br\u0026gt;\u0026lt;br\u0026gt; \u0026lt;a href=\u0026#34;###\u0026#34;\u0026gt;æ–¹å¼ä¸€ï¼šé€šè¿‡map[\u0026#39;keyname\u0026#39;].property\u0026lt;/a\u0026gt;\u0026lt;br/\u0026gt; è¾“å‡ºstu1çš„å­¦ç”Ÿä¿¡æ¯ï¼š\u0026lt;br/\u0026gt; å§“åï¼š${stuMap[\u0026#39;stu1\u0026#39;].name}\u0026lt;br/\u0026gt; å¹´é¾„ï¼š${stuMap[\u0026#39;stu1\u0026#39;].age}\u0026lt;br/\u0026gt; é’±åŒ…ï¼š${stuMap[\u0026#39;stu1\u0026#39;].money}\u0026lt;br/\u0026gt; \u0026lt;hr\u0026gt; \u0026lt;br\u0026gt; \u0026lt;a href=\u0026#34;###\u0026#34;\u0026gt;æ–¹å¼äºŒï¼šé€šè¿‡map.keyname.property\u0026lt;/a\u0026gt;\u0026lt;br/\u0026gt; è¾“å‡ºstu2çš„å­¦ç”Ÿä¿¡æ¯ï¼š\u0026lt;br/\u0026gt; å§“åï¼š${stuMap.stu2.name}\u0026lt;br/\u0026gt; å¹´é¾„ï¼š${stuMap.stu2.age}\u0026lt;br/\u0026gt; é’±åŒ…ï¼š${stuMap.stu2.money}\u0026lt;br/\u0026gt; \u0026lt;hr\u0026gt; \u0026lt;br/\u0026gt; \u0026lt;a href=\u0026#34;###\u0026#34;\u0026gt;éå†mapä¸­ä¸¤ä¸ªå­¦ç”Ÿä¿¡æ¯ï¼š\u0026lt;/a\u0026gt;\u0026lt;br/\u0026gt; \u0026lt;table\u0026gt; \u0026lt;tr\u0026gt; \u0026lt;td\u0026gt;åºå·\u0026lt;/td\u0026gt; \u0026lt;td\u0026gt;å§“å\u0026lt;/td\u0026gt; \u0026lt;td\u0026gt;å¹´é¾„\u0026lt;/td\u0026gt; \u0026lt;td\u0026gt;é’±åŒ…\u0026lt;/td\u0026gt; \u0026lt;/tr\u0026gt; \u0026lt;#list stuMap?keys as key\u0026gt; \u0026lt;tr\u0026gt; \u0026lt;td\u0026gt;${key_index + 1}\u0026lt;/td\u0026gt; \u0026lt;td\u0026gt;${stuMap[key].name}\u0026lt;/td\u0026gt; \u0026lt;td\u0026gt;${stuMap[key].age}\u0026lt;/td\u0026gt; \u0026lt;td\u0026gt;${stuMap[key].money}\u0026lt;/td\u0026gt; \u0026lt;/tr\u0026gt; \u0026lt;/#list\u0026gt; \u0026lt;/table\u0026gt; \u0026lt;hr\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; ifæŒ‡ä»¤ \u0026lt;table\u0026gt; \u0026lt;tr\u0026gt; \u0026lt;td\u0026gt;åºå·\u0026lt;/td\u0026gt; \u0026lt;td\u0026gt;å§“å\u0026lt;/td\u0026gt; \u0026lt;td\u0026gt;å¹´é¾„\u0026lt;/td\u0026gt; \u0026lt;td\u0026gt;é’±åŒ…\u0026lt;/td\u0026gt; \u0026lt;/tr\u0026gt; \u0026lt;#list stus as stu\u0026gt; \u0026lt;tr\u0026gt; \u0026lt;#if stu.name=\u0026#39;å°çº¢\u0026#39;\u0026gt; \u0026lt;td\u0026gt;${stu_index + 1}\u0026lt;/td\u0026gt; \u0026lt;td\u0026gt;\u0026lt;font color=\u0026#34;red\u0026#34;\u0026gt;${stu.name}\u0026lt;/font\u0026gt;\u0026lt;/td\u0026gt; \u0026lt;td\u0026gt;${stu.age}\u0026lt;/td\u0026gt; \u0026lt;td\u0026gt;${stu.money}\u0026lt;/td\u0026gt; \u0026lt;#else\u0026gt; \u0026lt;td\u0026gt;${stu_index + 1}\u0026lt;/td\u0026gt; \u0026lt;td\u0026gt;${stu.name}\u0026lt;/td\u0026gt; \u0026lt;td\u0026gt;${stu.age}\u0026lt;/td\u0026gt; \u0026lt;td\u0026gt;${stu.money}\u0026lt;/td\u0026gt; \u0026lt;/#if\u0026gt; \u0026lt;/tr\u0026gt; \u0026lt;/#list\u0026gt; \u0026lt;/table\u0026gt; è¿ç®—ç¬¦ ç®—æœ¯è¿ç®—ç¬¦ FreeMarkerè¡¨è¾¾å¼ä¸­å®Œå…¨æ”¯æŒç®—æœ¯è¿ç®—ï¼ŒFreeMarkeræ”¯æŒçš„ç®—æœ¯è¿ç®—ç¬¦åŒ…æ‹¬ï¼š\nåŠ æ³•ï¼š+ å‡æ³•ï¼š- ä¹˜æ³•ï¼š* é™¤æ³•ï¼š/ æ±‚æ¨¡ï¼ˆæ±‚ä½™ï¼‰ï¼š% æ¯”è¾ƒè¿ç®—ç¬¦ =æˆ–è€…==\n!=\n\u0026gt; æˆ–è€… gt\n\u0026gt;= æˆ–è€… gte\n\u0026lt;æˆ–è€…lt\n\u0026lt;=æˆ–è€…lte\né€»è¾‘è¿ç®—ç¬¦ é€»è¾‘ä¸ï¼š\u0026amp;\u0026amp; é€»è¾‘æˆ–ï¼š|| é€»è¾‘éï¼šï¼ ç©ºå€¼å¤„ç† åˆ¤æ–­æŸå˜é‡æ˜¯å¦å­˜åœ¨ä½¿ç”¨?? ç”¨æ³•ä¸ºï¼švariable??ï¼Œå¦‚æœè¯¥å˜é‡å­˜åœ¨ï¼Œè¿”å›trueï¼Œå¦åˆ™è¿”å›false\n\u0026lt;#if stus??\u0026gt; \u0026lt;#list stus as stu\u0026gt; \u0026lt;tr\u0026gt; \u0026lt;#if stu.name=\u0026#39;å°çº¢\u0026#39;\u0026gt; \u0026lt;td\u0026gt;${stu_index + 1}\u0026lt;/td\u0026gt; \u0026lt;td\u0026gt;\u0026lt;font color=\u0026#34;red\u0026#34;\u0026gt;${stu.name}\u0026lt;/font\u0026gt;\u0026lt;/td\u0026gt; \u0026lt;td\u0026gt;${stu.age}\u0026lt;/td\u0026gt; \u0026lt;td\u0026gt;${stu.money}\u0026lt;/td\u0026gt; \u0026lt;#else\u0026gt; \u0026lt;td\u0026gt;${stu_index + 1}\u0026lt;/td\u0026gt; \u0026lt;td\u0026gt;${stu.name}\u0026lt;/td\u0026gt; \u0026lt;td\u0026gt;${stu.age}\u0026lt;/td\u0026gt; \u0026lt;td\u0026gt;${stu.money}\u0026lt;/td\u0026gt; \u0026lt;/#if\u0026gt; \u0026lt;/tr\u0026gt; \u0026lt;/#list\u0026gt; \u0026lt;/#if\u0026gt; ç¼ºå¤±å˜é‡é»˜è®¤å€¼ä½¿ç”¨! ä½¿ç”¨!è¦ä»¥æŒ‡å®šä¸€ä¸ªé»˜è®¤å€¼ï¼Œå½“å˜é‡ä¸ºç©ºæ—¶æ˜¾ç¤ºé»˜è®¤å€¼ ä¾‹å¦‚ï¼š${name!''}è¡¨ç¤ºå¦‚æœnameä¸ºç©ºæ˜¾ç¤ºç©ºå­—ç¬¦ä¸² å¦‚æœæ˜¯åµŒå¥—å¯¹è±¡åˆ™å»ºè®®ä½¿ç”¨()æ‹¬èµ·æ¥ ä¾‹å¦‚ï¼š${(stu.name)''}è¡¨ç¤ºï¼Œå¦‚æœstuæˆ–nameä¸ºç©ºé»˜è®¤æ˜¾ç¤ºç©ºå­—ç¬¦ä¸² å†…å»ºå‡½æ•° å†…å»ºå‡½æ•°è¯­æ³•æ ¼å¼ï¼šå˜é‡ + ï¼Ÿ+ å‡½æ•°åç§°\n1.é›†åˆçš„å¤§å° ${é›†åˆå?size} 2.æ—¥æœŸæ ¼å¼åŒ– å½“å‰çš„æ—¥æœŸï¼š${today?date}\u0026lt;br/\u0026gt; å½“å‰çš„æ—¥æœŸï¼š${today?time}\u0026lt;br/\u0026gt; å½“å‰çš„æ—¥æœŸï¼š${today?datetime}\u0026lt;br/\u0026gt; å½“å‰çš„æ—¥æœŸï¼š${today?string(\u0026#34;yyyy-MM-mm\u0026#34;)}\u0026lt;br/\u0026gt; 3.å†…å»ºå‡½æ•°c //é•¿æ•°å€¼ç±»å‹ model.addAttribute(\u0026#34;point\u0026#34;, 6549255147894651651L); é»˜è®¤æ¯ä¸‰ä½ä½¿ç”¨é€—å·åˆ†éš”\nå¦‚æœä¸æƒ³æ˜¾ç¤ºä¸ºæ¯ä¸‰ä½åˆ†éš”çš„æ•°å­—ï¼Œå¯ä»¥ä½¿ç”¨cå‡½æ•°å°†æ•°å­—å‹è½¬æˆå­—ç¬¦ä¸²è¾“å‡º\n${point?c} 4.å°†jsonå­—ç¬¦ä¸²è½¬æˆå¯¹è±¡ ä¸€ä¸ªä¾‹å­ï¼š\nå…¶ä¸­ç”¨åˆ°äº†assignæ ‡ç­¾ï¼Œassignçš„ä½œç”¨æ˜¯å®šä¹‰ä¸€ä¸ªå˜é‡\nè¾“å‡ºé™æ€åŒ–æ–‡ä»¶ ä»£ç è¡¥å…¨æ—¶æ³¨æ„é€‰æ‹©å“ªä¸€ä¸ªåŒ…\n@SpringBootTest(classes = FreemarkerDemoApplication.class) @RunWith(SpringRunner.class) public class FreemarkerTest { @Autowired private Configuration configuration; @Test public void test() throws IOException, TemplateException { Template template = configuration.getTemplate(\u0026#34;02-list.ftl\u0026#34;); /** * åˆæˆæ–¹æ³• * * å‚æ•°1ï¼šæ•°æ®æ¨¡å‹ * å‚æ•°2ï¼šè¾“å‡ºæµ */ Map map = getData(); template.process(map, new FileWriter(\u0026#34;d:/test/list.html\u0026#34;)); } private Map getData() { Map\u0026lt;String, Object\u0026gt; map = new HashMap\u0026lt;\u0026gt;(); //------------------------------------ Student stu1 = new Student(); stu1.setName(\u0026#34;å°å¼º\u0026#34;); stu1.setAge(18); stu1.setMoney(1000.86f); stu1.setBirthday(new Date()); //å°çº¢å¯¹è±¡æ¨¡å‹æ•°æ® Student stu2 = new Student(); stu2.setName(\u0026#34;å°çº¢\u0026#34;); stu2.setMoney(200.1f); stu2.setAge(19); //å°†ä¸¤ä¸ªå¯¹è±¡æ¨¡å‹æ•°æ®å­˜æ”¾åˆ°Listé›†åˆä¸­ List\u0026lt;Student\u0026gt; list = new ArrayList\u0026lt;\u0026gt;(); list.add(stu1); list.add(stu2); //å‘modelä¸­å­˜æ”¾Listé›†åˆæ•°æ® map.put(\u0026#34;stus\u0026#34;, list); //------------------------------------ //åˆ›å»ºMapæ•°æ® Map\u0026lt;String, Student\u0026gt; stuMap = new HashMap\u0026lt;\u0026gt;(); stuMap.put(\u0026#34;stu1\u0026#34;, stu1); stuMap.put(\u0026#34;stu2\u0026#34;, stu2); // 3.1 å‘modelä¸­å­˜æ”¾Mapæ•°æ® map.put(\u0026#34;stuMap\u0026#34;, stuMap); map.put(\u0026#34;today\u0026#34;, new Date()); //é•¿æ•°å€¼ç±»å‹ map.put(\u0026#34;point\u0026#34;, 6549255147894651651L); return map; } } è¾“å‡ºå¯¹åº”å«æœ‰æ•°æ®çš„htmlæ–‡ä»¶ MinIO å¯¹è±¡å­˜å‚¨çš„æ–¹å¼å¯¹æ¯”ï¼š\nå­˜å‚¨æ–¹å¼ ä¼˜ç‚¹ ç¼ºç‚¹ FastDFS 1. ä¸»å¤‡æœåŠ¡ï¼Œé«˜å¯ç”¨2. æ”¯æŒä¸»ä»æ–‡ä»¶ï¼Œæ”¯æŒè‡ªå®šä¹‰æ‰©å±•å3. æ”¯æŒåŠ¨æ€æ‰©å®¹ 1. æ²¡æœ‰å®Œå–„çš„å®˜æ–¹æ–‡æ¡£ï¼Œè¿‘å‡ å¹´æ²¡æœ‰æ›´æ–°2. ç¯å¢ƒæ­å»ºè¾ƒä¸ºéº»çƒ¦ MinIO 1. æ€§èƒ½é«˜ï¼Œå‡†ç¡¬ä»¶æ¡ä»¶ä¸‹å®ƒèƒ½è¾¾åˆ°55GB/sçš„è¯»ã€35GB/sçš„å†™é€Ÿç‡2. éƒ¨ç½²è‡ªå¸¦ç®¡ç†ç•Œé¢3. MinIO Incè¿è¥çš„å¼€æºé¡¹ç›®ï¼Œç¤¾åŒºæ´»è·ƒåº¦é«˜4. æä¾›äº†æ‰€æœ‰ä¸»æµå¼€å‘è¯­è¨€çš„SDK 1. ä¸æ”¯æŒåŠ¨æ€å¢åŠ èŠ‚ç‚¹ dockeréƒ¨ç½² docker search minio docker run -p 9000:9000 --name minio -d --restart=always -e \u0026#34;MINIO_ACCESS_KEY=minio\u0026#34; -e \u0026#34;MINIO_SECRET_KEY=minio123\u0026#34; -v /home/data:/data -v /home/config:/root/.minio minio/minio server /data åŸºæœ¬æ¦‚å¿µ bucket-ç±»æ¯”äºæ–‡ä»¶ç³»ç»Ÿçš„ç›®å½• Object-ç±»æ¯”æ–‡ä»¶ç³»ç»Ÿçš„æ–‡ä»¶ Keys-ç±»æ¯”æ–‡ä»¶å ä¸Šä¼ æ–‡ä»¶è¿›è¡Œé™æ€è®¿é—® public class MinIOTest { public static void main(String[] args){ try { FileInputStream fileInputStream = new FileInputStream(\u0026#34;D:\\\\test\\\\list.html\u0026#34;); // è·å–minioçš„é“¾æ¥ä¿¡æ¯ï¼Œ åˆ›å»ºä¸€ä¸ªminioçš„å®¢æˆ·ç«¯ MinioClient minioClient = MinioClient.builder().credentials(\u0026#34;minio\u0026#34;, \u0026#34;minio123\u0026#34;).endpoint(\u0026#34;http://192.168.200.130:9000/\u0026#34;).build(); // ä¸Šä¼  PutObjectArgs putObjectArgs = PutObjectArgs.builder() .object(\u0026#34;list.html\u0026#34;) .contentType(\u0026#34;text/html\u0026#34;) .bucket(\u0026#34;leadnews\u0026#34;) .stream(fileInputStream, fileInputStream.available(), -1).build(); minioClient.putObject(putObjectArgs); } catch (Exception e) { throw new RuntimeException(e); } } } å°è£…MinIOä¸ºstarter MinIOä¸ºstarter\né”™è¯¯ï¼š @Autowireä¸æˆåŠŸ\nè§£å†³æ–¹æ³•ï¼š æ£€æŸ¥å¯åŠ¨ç±»æ˜¯å¦æœ‰@SpringBootApplication\næ¨¡å—å†…å¯¼å…¥ä¾èµ–ï¼š\n","permalink":"https://kennems.github.io/posts/tech/%E9%BB%91%E9%A9%AC%E5%A4%B4%E6%9D%A12/","summary":"é»‘é©¬å¤´æ¡ï¼ˆ2ï¼‰ ä»ä¸šåŠ¡è§’åº¦åˆ†æå¦‚ä½•åˆ†è¡¨ æ»šå±åˆ†é¡µçš„é€»è¾‘ å¤§æ–‡æœ¬é™æ€åŒ–æ–¹æ¡ˆï¼š freemarker minio è¡¨çš„æ‹†åˆ†-å‚ç›´åˆ†è¡¨ å‚ç›´åˆ†è¡¨ï¼šå°†ä¸€ä¸ªè¡¨çš„å­—æ®µåˆ†æ•£åˆ°å¤šä¸ªè¡¨ä¸­ï¼Œæ¯ä¸ªè¡¨å­˜å‚¨","title":"é»‘é©¬å¤´æ¡ï¼ˆ2ï¼‰"},{"content":"LeetCode 11/24 11/25 å‘¨èµ›/åŒå‘¨èµ› å¤ªé•¿æ—¶é—´ä¸å‚åŠ å‘¨èµ›æ‰‹ç”Ÿäº†å¾ˆå¤šï¼Œæœ‰æ—¶é—´å°±æ‰“ï¼Œæ²¡æ—¶é—´åˆ·ç†Ÿ LeetCode Hot 100 + é¢è¯•é¢˜150 + LCR\nåŒå‘¨èµ› T3 3362. é›¶æ•°ç»„å˜æ¢ III é¢˜ç›®å¤§æ„ ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ nums å’ŒäºŒç»´æ•°ç»„ queriesï¼Œæ¯ä¸ªæ“ä½œ [li, ri] å¯ä»¥å°† nums[li] åˆ° nums[ri] èŒƒå›´å†…çš„æ¯ä¸ªå…ƒç´  æœ€å¤šå‡ 1ã€‚\næ±‚æœ€å¤šå¯ä»¥åˆ é™¤å¤šå°‘ä¸ªæ“ä½œï¼Œä½¿å‰©ä½™æ“ä½œä»èƒ½å°† nums å˜ä¸ºå…¨é›¶æ•°ç»„ã€‚å¦‚æœæ— æ³•å˜ä¸ºé›¶æ•°ç»„ï¼Œè¿”å› -1ã€‚\nä»£ç å®ç° class Solution: def maxRemoval(self, nums: List[int], queries: List[List[int]]) -\u0026gt; int: n = len(nums) # æ•°ç»„é•¿åº¦ # ç”¨äºå­˜å‚¨æ¯ä¸ªèµ·ç‚¹çš„ç»ˆç‚¹åŒºé—´ g = defaultdict(list) for l, r in queries: g[l].append(r) ans = 0 # è¢«é€‰ä¸­ï¼ˆæœªåˆ é™¤ï¼‰çš„ queries æ•°é‡ sel = [] # å½“å‰è¢«é€‰ä¸­åŒºé—´çš„ç»ˆç‚¹ï¼ˆå°æ ¹å †ï¼‰ hq = [] # å½“å‰å¯é€‰åŒºé—´çš„ç»ˆç‚¹ï¼ˆå¤§æ ¹å †ï¼Œç”¨è´Ÿæ•°æ¨¡æ‹Ÿï¼‰ # éå† nums çš„æ¯ä¸€ä¸ªä½ç½® for i, x in enumerate(nums): # ç§»é™¤å·²ç»è¿‡æœŸçš„åŒºé—´ï¼ˆå°äºå½“å‰ä¸‹æ ‡ i çš„ï¼‰ while sel and sel[0] \u0026lt; i: heappop(sel) # å°†èµ·ç‚¹ä¸º i çš„æ‰€æœ‰åŒºé—´ç»ˆç‚¹åŠ å…¥å¤§æ ¹å † for r in g[i]: heappush(hq, -r) # éœ€è¦ä¸ºå½“å‰ä¸‹æ ‡ i çš„å€¼ x æ‰¾åˆ°è¶³å¤Ÿçš„åŒºé—´æ¥è¦†ç›– while x \u0026gt; len(sel): # å¦‚æœå½“å‰æ²¡æœ‰å¯ç”¨çš„åŒºé—´æˆ–åŒºé—´ä¸åˆæ³•ï¼Œè¿”å› -1 if not hq or -hq[0] \u0026lt; i: return -1 # ä»æœ€å¤§ç»ˆç‚¹åŒºé—´ä¸­é€‰å–ä¸€ä¸ª heappush(sel, -heappop(hq)) ans += 1 # ç»Ÿè®¡è¢«é€‰ä¸­çš„åŒºé—´æ•° # è¿”å›æœ€å¤šå¯ä»¥åˆ é™¤çš„ queries æ•°é‡ return len(queries) - ans T4 3363. æœ€å¤šå¯æ”¶é›†çš„æ°´æœæ•°ç›® é¢˜ç›®å¤§æ„ ç»™å®šä¸€ä¸ª n x n çš„ç½‘æ ¼ fruitsï¼Œå…¶ä¸­ fruits[i][j] è¡¨ç¤ºæˆ¿é—´ (i, j) ä¸­çš„æ°´æœæ•°é‡ã€‚ä¸‰ä¸ªå°æœ‹å‹åˆ†åˆ«ä» (0,0)ã€(0,n-1) å’Œ (n-1,0) å‡ºå‘ï¼Œæ¯äººç§»åŠ¨ n-1 æ¬¡åˆ°è¾¾ (n-1,n-1)ã€‚ ä»–ä»¬ä¼šæ”¶é›†ç»è¿‡æˆ¿é—´çš„æ°´æœï¼Œä¸”åŒä¸€æˆ¿é—´çš„æ°´æœåªèƒ½è¢«ä¸€ä¸ªå°æœ‹å‹æ”¶é›†ã€‚æ±‚ä¸‰äººæœ€å¤šå¯ä»¥æ”¶é›†çš„æ°´æœæ€»æ•°ã€‚\nä»£ç å®ç° class Solution: def maxCollectedFruits(self, fruits: List[List[int]]) -\u0026gt; int: n = len(fruits) # å®šä¹‰ä¸€ä¸ªé€’å½’å‡½æ•°ï¼Œè®¡ç®—ä» (i, j) åˆ°ç»ˆç‚¹çš„æœ€å¤§æ”¶é›†æ°´æœæ•° @cache def dfs(i: int, j: int) -\u0026gt; int: # æ£€æŸ¥åæ ‡æ˜¯å¦è¶Šç•Œï¼ˆé™åˆ¶åœ¨ç½‘æ ¼å†…ï¼‰ if not (n - 1 - i \u0026lt;= j \u0026lt; n): return -inf # å¦‚æœåˆ°è¾¾èµ·ç‚¹ (0, x)ï¼Œç›´æ¥è¿”å›æˆ¿é—´ä¸­çš„æ°´æœæ•°é‡ if i == 0: return fruits[i][j] # ä¸‰ç§å¯èƒ½çš„ç§»åŠ¨æ–¹å¼ return max( dfs(i - 1, j - 1), # å·¦ä¸Š dfs(i - 1, j), # ä¸Š dfs(i - 1, j + 1) # å³ä¸Š ) + fruits[i][j] # ç»Ÿè®¡ç¬¬ä¸€æ¡è·¯å¾„ (0, 0) å‡ºå‘çš„å°æœ‹å‹æ”¶é›†çš„æ°´æœ ans = sum(fruits[i][i] for i in range(n)) # è®¡ç®—ç¬¬äºŒæ¡è·¯å¾„ï¼Œä»å³ä¸Šè§’ (0, n-1) å‡ºå‘ ans += dfs(n - 2, n - 1) # ä»å€’æ•°ç¬¬äºŒè¡Œå¾€ä¸Šé€’å½’è®¡ç®— dfs.cache_clear() # å¯¹ç½‘æ ¼è½¬ç½®ï¼Œç›¸å½“äºä¸»å¯¹è§’çº¿ç¿»è½¬ï¼Œç”¨äºè®¡ç®—ç¬¬ä¸‰æ¡è·¯å¾„ fruits = list(zip(*fruits)) # è®¡ç®—ç¬¬ä¸‰æ¡è·¯å¾„ï¼Œä»å·¦ä¸‹è§’ (n-1, 0) å‡ºå‘ ans += dfs(n - 2, n - 1) return ans å‘¨èµ› T3 3366. æœ€å°æ•°ç»„å’Œ é¢˜ç›®å¤§æ„ ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ nums å’Œä¸‰ä¸ªæ•´æ•° kã€op1 å’Œ op2ï¼Œä½ éœ€è¦é€šè¿‡ä»¥ä¸‹ä¸¤ç§æ“ä½œå°½å¯èƒ½å‡å°‘æ•°ç»„å…ƒç´ çš„å’Œï¼š\næ“ä½œ 1: é€‰æ‹©ä¸€ä¸ªä¸‹æ ‡ iï¼Œå°† nums[i] é™¤ä»¥ 2 å¹¶å‘ä¸Šå–æ•´ã€‚æ¯ä¸ªä¸‹æ ‡æœ€å¤šåªèƒ½åº”ç”¨ä¸€æ¬¡æ­¤æ“ä½œï¼Œæœ€å¤šå¯ä»¥åº”ç”¨ op1 æ¬¡ã€‚ æ“ä½œ 2: é€‰æ‹©ä¸€ä¸ªä¸‹æ ‡ iï¼Œä»…å½“ nums[i] \u0026gt;= k æ—¶ï¼Œä» nums[i] ä¸­å‡å» kã€‚æ¯ä¸ªä¸‹æ ‡æœ€å¤šåªèƒ½åº”ç”¨ä¸€æ¬¡æ­¤æ“ä½œï¼Œæœ€å¤šå¯ä»¥åº”ç”¨ op2 æ¬¡ã€‚ ä¸¤ç§æ“ä½œå¯ä»¥åº”ç”¨äºåŒä¸€ä¸ªä¸‹æ ‡ï¼Œä½†æ¯ç§æ“ä½œæœ€å¤šåªèƒ½åº”ç”¨ä¸€æ¬¡ã€‚\nä½ éœ€è¦è®¡ç®—å‡ºç»è¿‡ä»»æ„æ¬¡æ•°çš„æ“ä½œåï¼Œæ•°ç»„å…ƒç´ å’Œçš„æœ€å°å¯èƒ½å€¼ã€‚\nä»£ç å®ç°ï¼ˆå«æ³¨é‡Šï¼‰ class Solution: def minArraySum(self, nums: List[int], k: int, op1: int, op2: int) -\u0026gt; int: # åˆå§‹åŒ–å˜é‡ n = len(nums) # åˆ›å»º DP è¡¨ fï¼Œå…¶ä¸­ f[i][j][x] è¡¨ç¤ºå¤„ç†å‰ i ä¸ªå…ƒç´ æ—¶ï¼Œä½¿ç”¨ j æ¬¡æ“ä½œ 1 å’Œ x æ¬¡æ“ä½œ 2 çš„æœ€å°å’Œ f = [[[float(\u0026#39;inf\u0026#39;)] * (op2 + 1) for _ in range(op1 + 1)] for _ in range(2)] f[0][0][0] = 0 # åˆå§‹çŠ¶æ€ï¼Œæœªæ“ä½œæ—¶å’Œä¸º 0 # åŠ¨æ€è§„åˆ’è¿­ä»£ for i in range(1, n + 1): # éå†æ¯ä¸ªå…ƒç´  cur, prev = i % 2, (i - 1) % 2 # å½“å‰å’Œå‰ä¸€çŠ¶æ€çš„ç´¢å¼• for j in range(op1 + 1): # éå†æ“ä½œ 1 çš„ä½¿ç”¨æ¬¡æ•° for x in range(op2 + 1): # éå†æ“ä½œ 2 çš„ä½¿ç”¨æ¬¡æ•° # ä¸å¯¹ nums[i-1] æ“ä½œ f[cur][j][x] = f[prev][j][x] + nums[i - 1] # å¦‚æœå¯ä»¥ä½¿ç”¨æ“ä½œ 1 if j \u0026gt; 0: f[cur][j][x] = min( f[cur][j][x], f[prev][j - 1][x] + math.ceil(nums[i - 1] / 2) ) # å¦‚æœå¯ä»¥ä½¿ç”¨æ“ä½œ 2 ä¸” nums[i-1] \u0026gt;= k if x \u0026gt; 0 and nums[i - 1] \u0026gt;= k: f[cur][j][x] = min( f[cur][j][x], f[prev][j][x - 1] + max(nums[i - 1] - k, 0) ) # å¦‚æœå¯ä»¥åŒæ—¶ä½¿ç”¨æ“ä½œ 1 å’Œæ“ä½œ 2 if j \u0026gt; 0 and x \u0026gt; 0: reduced = math.ceil(nums[i - 1] / 2) # æ“ä½œ 1 åçš„å€¼ if reduced \u0026gt;= k: # æ“ä½œ 1 åä»å¯åº”ç”¨æ“ä½œ 2 f[cur][j][x] = min( f[cur][j][x], f[prev][j - 1][x - 1] + max(reduced - k, 0) ) if nums[i - 1] \u0026gt;= k: # æ“ä½œ 2 åä»å¯åº”ç”¨æ“ä½œ 1 after_sub = nums[i - 1] - k f[cur][j][x] = min( f[cur][j][x], f[prev][j - 1][x - 1] + math.ceil(after_sub / 2) ) # è®¡ç®—æœ€ç»ˆç»“æœ res = float(\u0026#39;inf\u0026#39;) for j in range(op1 + 1): for x in range(op2 + 1): res = min(res, f[n % 2][j][x]) # å–æ‰€æœ‰å¯èƒ½çŠ¶æ€çš„æœ€å°å€¼ return res T4 3367. ç§»é™¤è¾¹ä¹‹åçš„æƒé‡æœ€å¤§å’Œ é¢˜ç›®å¤§æ„ ç»™å®šä¸€æ£µæœ‰ nnn ä¸ªèŠ‚ç‚¹çš„æ— å‘æ ‘ï¼Œæ ‘ä¸­æ¯æ¡è¾¹æœ‰æƒé‡ï¼ŒèŠ‚ç‚¹ç¼–å·ä» 000 åˆ° nâˆ’1n-1nâˆ’1ã€‚è¾“å…¥æ˜¯ä¸€ä¸ªé•¿åº¦ä¸º nâˆ’1n-1nâˆ’1 çš„äºŒç»´æ•´æ•°æ•°ç»„ edgesï¼Œå…¶ä¸­æ¯ä¸ªå…ƒç´  [u_i, v_i, w_i]è¡¨ç¤ºèŠ‚ç‚¹ ui å’Œ viä¹‹é—´æœ‰ä¸€æ¡æƒé‡ä¸º wi çš„è¾¹ã€‚\nä»»åŠ¡æ˜¯ï¼š\nç§»é™¤é›¶æ¡æˆ–å¤šæ¡è¾¹ï¼Œä½¿å¾—æ¯ä¸ªèŠ‚ç‚¹ä¸æœ€å¤š kkk ä¸ªå…¶ä»–èŠ‚ç‚¹ç›´æ¥ç›¸è¿ã€‚ åœ¨æ»¡è¶³ä¸Šè¿°æ¡ä»¶ä¸‹ï¼Œå‰©ä½™è¾¹çš„æƒé‡ä¹‹å’Œæœ€å¤§åŒ–ã€‚ è¿”å›æ»¡è¶³æ¡ä»¶çš„ æœ€å¤§å¯èƒ½æƒé‡å’Œã€‚\nä»£ç å®ç° class Solution: def maximizeSumOfWeights(self, edges: List[List[int]], k: int) -\u0026gt; int: # å»ºç«‹é‚»æ¥è¡¨å­˜å‚¨æ ‘çš„ç»“æ„ graph = defaultdict(list) for x, y, weight in edges: graph[x].append((y, weight)) graph[y].append((x, weight)) # æ·±åº¦ä¼˜å…ˆæœç´¢ï¼Œè¿”å› (ä¸é€‰å½“å‰èŠ‚ç‚¹çš„æœ€å¤§æƒé‡å’Œ, é€‰å½“å‰èŠ‚ç‚¹çš„æœ€å¤§æƒé‡å’Œ) def dfs(node: int, parent: int) -\u0026gt; Tuple[int, int]: # `not_choose` è¡¨ç¤ºå½“å‰èŠ‚ç‚¹ä¸é€‰æ‹©æ—¶çš„æœ€å¤§æƒé‡å’Œ not_choose = 0 # `inc` å­˜å‚¨æ‰€æœ‰å­æ ‘ä¸­æƒé‡çš„å¢é‡å€¼ï¼ˆé€‰æ‹© vs ä¸é€‰æ‹©å­æ ‘ï¼‰ increments = [] # éå†å­èŠ‚ç‚¹ for neighbor, weight in graph[node]: if neighbor == parent: continue # è·³è¿‡çˆ¶èŠ‚ç‚¹ï¼Œé¿å…å›ç¯ nc, c = dfs(neighbor, node) # å­èŠ‚ç‚¹é€’å½’è®¡ç®— not_choose += nc # ç´¯åŠ å­èŠ‚ç‚¹ä¸é€‰æ—¶çš„æœ€å¤§æƒé‡å’Œ # å¦‚æœé€‰æ‹©å­èŠ‚ç‚¹å¯ä»¥å¢åŠ æƒé‡ï¼Œå°†å¢é‡å­˜å…¥ `increments` delta = c + weight - nc if delta \u0026gt; 0: increments.append(delta) # æŒ‰å¢é‡ä»å¤§åˆ°å°æ’åºï¼Œå–å‰ k æˆ– k-1 ä¸ª increments.sort(reverse=True) choose_k = not_choose + sum(increments[:k]) # é€‰ k ä¸ªå¢é‡ choose_k_minus_1 = not_choose + sum(increments[:k - 1]) # é€‰ k-1 ä¸ªå¢é‡ return choose_k, choose_k_minus_1 # é€’å½’ä»æ ¹èŠ‚ç‚¹å¼€å§‹ï¼Œè¿”å›æœ€å¤§å¯èƒ½çš„æƒé‡å’Œ return max(dfs(0, -1)) ","permalink":"https://kennems.github.io/posts/tech/leetcode-1124-1125-%E5%91%A8%E8%B5%9B%E5%8F%8C%E5%91%A8%E8%B5%9B/","summary":"LeetCode 11/24 11/25 å‘¨èµ›/åŒå‘¨èµ› å¤ªé•¿æ—¶é—´ä¸å‚åŠ å‘¨èµ›æ‰‹ç”Ÿäº†å¾ˆå¤šï¼Œæœ‰æ—¶é—´å°±æ‰“ï¼Œæ²¡æ—¶é—´åˆ·ç†Ÿ LeetCode Hot 100 + é¢è¯•é¢˜150 + LCR åŒå‘¨èµ› T3 3362. é›¶æ•°ç»„å˜æ¢ III é¢˜ç›®å¤§æ„ ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„","title":"LeetCodeå‘¨èµ›425 \u0026 144(241124)"},{"content":"é»‘é©¬å¤´æ¡ï¼ˆ1ï¼‰ å¾®æœåŠ¡æ¶æ„å¼€å‘ Springboot Spring cloud Nacos ç¯å¢ƒæ­å»º ç›®æ ‡ï¼šæ¥å£æµ‹è¯•å·¥å…·åŠå‰åç«¯è”è°ƒ\nç±»ä¼¼ä»Šæ—¥å¤´æ¡\nä¸šåŠ¡è¯´æ˜ æŠ€æœ¯æ ˆ ç»¼åˆçŸ¥è¯†çš„è¿ç”¨ï¼š\nSpringBoot SpringCloud nacos redis docker elasticSearch kafka seata ä¸šåŠ¡æˆ–æŠ€æœ¯è§£å†³æ–¹æ¡ˆï¼š\nåˆ†å¸ƒå¼äº‹åŠ¡ åˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦ å»¶è¿Ÿé˜Ÿåˆ— å¼‚æ­¥çº¿ç¨‹ çƒ­æ•°æ®çš„å¤„ç† è¯„è®ºç³»ç»Ÿ å…³æ³¨ç‚¹èµ è½¯ç¡¬ç¼–ç¨‹æ€æƒ³æå‡\nä¸šåŠ¡åˆ†æ è®¾è®¡ ç¼–ç  æµ‹è¯• éƒ¨ç½² nacoséƒ¨ç½² docker run --env MODE=standalone --name nacos --restart=always -d -p 8848:8848 nacos/nacos-server:1.2.0 å¼€å‘ç¯å¢ƒè¯´æ˜ é¡¹ç›®ä¾èµ–ç¯å¢ƒï¼š\nJDK1.8 Idea maven-3.6.1 Git å…¨å±€å¼‚å¸¸ tinyIntç±»å‹ï¼šå 1ä¸ªå­—èŠ‚ï¼Œä¸æŒ‡å®šunsignedï¼ˆéè´Ÿæ•°ï¼‰ï¼Œå€¼èŒƒå›´ï¼ˆ-128ï¼Œ 127ï¼‰ï¼ŒæŒ‡å®šäº†unsignedï¼Œ å€¼èŒƒå›´ï¼ˆ0ï¼Œ255ï¼‰\ntinyInté€šå¸¸è¡¨ç¤ºå°èŒƒå›´çš„æ•°å€¼ï¼Œæˆ–è€…è¡¨ç¤ºtrueæˆ–falseï¼Œé€šå¸¸å€¼ä¸º0è¡¨ç¤ºfalseï¼Œå€¼ä¸º1è¡¨ç¤ºtrue\né¡¹ç›®ä¸­çš„æŒä¹…å±‚ä½¿ç”¨çš„æ˜¯mybatis-plusï¼Œä¸€èˆ¬éƒ½ä½¿ç”¨mybatis-plusé€†å‘ç”Ÿæˆå¯¹åº”çš„å®ä½“ç±»\nsalt-ç›å€¼ æ‰‹åŠ¨åŠ å¯†ï¼ˆmd5 + éšæœºå­—ç¬¦ä¸²ï¼‰\nmd5æ˜¯ä¸å¯é€†åŠ å¯†ï¼Œmd5ç›¸åŒçš„å¯†ç æ¯æ¬¡åŠ å¯†éƒ½ä¸€æ ·ï¼Œä¸å¤ªå®‰å…¨ã€‚åœ¨md5çš„åŸºç¡€ä¸Šæ‰‹åŠ¨åŠ ç›ï¼ˆsaltï¼‰å¤„ç†\nappç™»å½• æ¥å£è·¯å¾„ ï¼š /api/v1/login/login_auth\nè¯·æ±‚æ–¹å¼ï¼šPOST\nå‚æ•°ï¼šLoginDto\nå“åº”ç»“æœï¼šResponseResult\nResponseResult Postmanæµ‹è¯• Swaggeræµ‹è¯• å‰åç«¯åˆ†ç¦»å¼€å‘\né¡¹ç›®åŸºäºå‰åç«¯åˆ†ç¦»çš„æ¶æ„è¿›è¡Œå¼€å‘ï¼Œå‰åç«¯åˆ†ç¦»æ¶æ„æ€»ä½“ä¸ŠåŒ…æ‹¬å‰ç«¯å’ŒæœåŠ¡ç«¯ï¼Œé€šå¸¸æ˜¯å¤šäººåä½œå¼€å‘\nSwaggeræ˜¯ä¸€ä¸ªè§„èŒƒå’Œå®Œæ•´çš„æ¡†æ¶ï¼Œç”¨äºç”Ÿæˆã€æè¿°ã€è°ƒç”¨å’Œå¯è§†åŒ–RESTfulé£æ ¼çš„WebæœåŠ¡\nä¸»è¦ä½œç”¨ï¼š\nä½¿å¾—å‰åç«¯åˆ†ç¦»å¼€å‘æ›´åŠ æ–¹ä¾¿ï¼Œæœ‰åˆ©äºå›¢é˜Ÿåä½œ æ¥å£çš„æ–‡æ¡£åœ¨çº¿è‡ªåŠ¨ç”Ÿæˆï¼Œé™ä½åç«¯å¼€å‘äººå‘˜ç¼–å†™æ¥å£æ–‡æ¡£çš„è´Ÿæ‹… åŠŸèƒ½æµ‹è¯• knife4jæµ‹è¯• knife4jæ˜¯ä¸ºJava MVCæ¡†æ¶é›†æˆSwaggerç”ŸæˆApiæ–‡æ¡£çš„å¢å¼ºè§£å†³æ–¹æ¡ˆï¼Œå‰èº«æ˜¯swagger-bootstrap-ui\nappç«¯ç½‘å…³ è®¤è¯è¿‡æ»¤å™¨ å…¨å±€è¿‡æ»¤å™¨å®ç°jwtæ ¡éªŒ\nappå‰ç«¯é¡¹ç›®é›†æˆ å…¨è‹±æ–‡ç›®å½•æ”¾ç½®nginxï¼š\nnginxå­˜æ”¾ç›®å½• ï¼š d:develop\né…ç½®nginxï¼š\næŒ‡å®šå‰ç«¯é¡µé¢çš„ç›®å½•ï¼š\nä¿®æ”¹é…ç½®åéœ€è¦ä½¿ç”¨å‘½ä»¤é‡æ–°åŠ è½½ï¼š\nnginx -s reload ","permalink":"https://kennems.github.io/posts/tech/%E9%BB%91%E9%A9%AC%E5%A4%B4%E6%9D%A11/","summary":"é»‘é©¬å¤´æ¡ï¼ˆ1ï¼‰ å¾®æœåŠ¡æ¶æ„å¼€å‘ Springboot Spring cloud Nacos ç¯å¢ƒæ­å»º ç›®æ ‡ï¼šæ¥å£æµ‹è¯•å·¥å…·åŠå‰åç«¯è”è°ƒ ç±»ä¼¼ä»Šæ—¥å¤´æ¡ ä¸šåŠ¡è¯´æ˜ æŠ€æœ¯æ ˆ ç»¼åˆçŸ¥è¯†çš„è¿ç”¨ï¼š SpringBoot SpringCloud nacos redis docker elasticSearch kafka seata ä¸šåŠ¡æˆ–æŠ€","title":"é»‘é©¬å¤´æ¡ï¼ˆ1ï¼‰"},{"content":"é¢ç»ï¼ˆ2ï¼‰ è…¾è®¯é¢ç»\n1. è‡ªæˆ‘ä»‹ç»ä¸é¡¹ç›® åœ¨è‡ªæˆ‘ä»‹ç»ç¯èŠ‚ï¼Œå»ºè®®çªå‡ºä»¥ä¸‹å‡ ç‚¹ï¼š\nèƒŒæ™¯å’Œæ•™è‚²ç»å†ï¼šè¯´æ˜ä½ çš„ä¸“ä¸šã€å­¦æ ¡å’Œæ¯•ä¸šæ—¶é—´ã€‚å¦‚æœæœ‰ç›¸å…³çš„å­¦æœ¯æˆæœæˆ–è€…å¥–é¡¹ä¹Ÿå¯ä»¥æåŠã€‚ å®ä¹ å’Œé¡¹ç›®ç»éªŒï¼šé‡ç‚¹ä»‹ç»å’Œé¢è¯•å²—ä½é«˜åº¦ç›¸å…³çš„å®ä¹ æˆ–é¡¹ç›®ç»å†ã€‚æ¯”å¦‚ï¼Œå¯ä»¥æ¦‚æ‹¬æ€§åœ°æè¿°ä½ è´Ÿè´£çš„æ¨¡å—ã€ä½¿ç”¨çš„æŠ€æœ¯æ ˆã€è§£å†³çš„æ ¸å¿ƒé—®é¢˜å’Œå–å¾—çš„æˆæ•ˆã€‚ æŠ€æœ¯æ ˆï¼šå¯ä»¥å…·ä½“ä»‹ç»ç²¾é€šçš„ç¼–ç¨‹è¯­è¨€ï¼ˆå¦‚Javaã€Pythonï¼‰ï¼ŒæŒæ¡çš„æ¡†æ¶æˆ–å·¥å…·ï¼ˆå¦‚Spring Bootã€Djangoï¼‰ï¼Œä»¥åŠæ•°æ®åº“å’Œå¼€å‘å·¥å…·çš„ç»éªŒï¼ˆå¦‚MySQLã€Gitï¼‰ã€‚ é¡¹ç›®ç»†èŠ‚ï¼šå¯¹äºé¡¹ç›®ï¼Œå¯ä»¥é€‰æ‹©ä¸€ä¸¤ä¸ªå…·æœ‰ä»£è¡¨æ€§çš„é¡¹ç›®è¿›è¡Œè¯¦ç»†è¯´æ˜ã€‚å»ºè®®ç»“æ„å¦‚ä¸‹ï¼š é¡¹ç›®èƒŒæ™¯åŠç›®æ ‡ ä½ åœ¨é¡¹ç›®ä¸­çš„è§’è‰²åŠæ‰¿æ‹…çš„ä¸»è¦å·¥ä½œ é¡¹ç›®è¿‡ç¨‹ä¸­é‡åˆ°çš„æŒ‘æˆ˜å’Œä½ å¦‚ä½•è§£å†³è¿™äº›é—®é¢˜ é¡¹ç›®çš„æœ€ç»ˆæˆæœåŠå…¶å½±å“ï¼ˆæ•°æ®å’Œç»“æœèƒ½å¸®åŠ©é‡åŒ–ï¼‰ 2. æ“ä½œç³»ç»Ÿ è™šæ‹Ÿçº¿ç¨‹ è™šæ‹Ÿçº¿ç¨‹ï¼ˆvirtual threadï¼‰æ˜¯ç°ä»£ç¼–ç¨‹è¯­è¨€ï¼ˆå¦‚Javaï¼‰ä¸­ä¸ºæé«˜å¹¶å‘æ€§èƒ½è€Œå¼•å…¥çš„è½»é‡çº§çº¿ç¨‹æœºåˆ¶ã€‚ç›¸æ¯”ä¼ ç»Ÿçº¿ç¨‹ï¼Œè™šæ‹Ÿçº¿ç¨‹çš„åˆ›å»ºå’Œé”€æ¯ä»£ä»·æ›´ä½ï¼Œæ›´é€‚åˆé«˜å¹¶å‘åœºæ™¯ã€‚\nè™šæ‹Ÿçº¿ç¨‹çš„å†…å­˜ç½®æ¢ åœ¨æ“ä½œç³»ç»Ÿä¸­ï¼Œçº¿ç¨‹åˆ‡æ¢æ—¶ä¸€èˆ¬æ¶‰åŠçº¿ç¨‹ä¸Šä¸‹æ–‡çš„ä¿å­˜å’Œæ¢å¤ï¼Œä¸»è¦æ˜¯å¯„å­˜å™¨çš„å†…å®¹ã€‚è™šæ‹Ÿçº¿ç¨‹å¹¶ä¸ç›´æ¥å½±å“å†…å­˜ç½®æ¢çš„å®ç°ï¼Œå†…å­˜ç½®æ¢æ˜¯æ“ä½œç³»ç»Ÿç®¡ç†å†…å­˜æ—¶æ ¹æ®é¡µé¢ä½¿ç”¨æƒ…å†µè¿›è¡Œçš„ã€‚\næ“ä½œç³»ç»Ÿçš„å†…å­˜ç½®æ¢æœºåˆ¶ åœ¨æ“ä½œç³»ç»Ÿä¸­ï¼Œå†…å­˜ç½®æ¢çš„å®ç°æ–¹å¼é€šå¸¸åŒ…æ‹¬ï¼š\nåˆ†é¡µæœºåˆ¶ï¼šæ“ä½œç³»ç»Ÿå°†è¿›ç¨‹çš„å†…å­˜åˆ†ä¸ºå¤šä¸ªå¤§å°å›ºå®šçš„é¡µé¢ï¼Œå½“å†…å­˜ä¸è¶³æ—¶ï¼Œé€šè¿‡é¡µé¢ç½®æ¢å°†éƒ¨åˆ†é¡µé¢äº¤æ¢åˆ°ç£ç›˜ä¸­ã€‚ é¡µé¢ç½®æ¢ç®—æ³•ï¼šé¡µé¢ç½®æ¢ç®—æ³•å†³å®šå“ªäº›é¡µé¢éœ€è¦è¢«äº¤æ¢ï¼Œä¾‹å¦‚FIFOã€LRUï¼ˆæœ€è¿‘æœ€å°‘ä½¿ç”¨ï¼‰ã€LFUï¼ˆæœ€å°‘ä½¿ç”¨é¢‘ç‡ï¼‰ã€Clockç®—æ³•ç­‰ã€‚ è¿›ç¨‹ã€çº¿ç¨‹ã€åç¨‹çš„åŒºåˆ« ç‰¹æ€§ è¿›ç¨‹ çº¿ç¨‹ åç¨‹ å®šä¹‰ æ“ä½œç³»ç»Ÿèµ„æºåˆ†é…çš„åŸºæœ¬å•ä½ è¿›ç¨‹å†…çš„æ‰§è¡Œå•ä½ ç”¨æˆ·ç©ºé—´çš„è½»é‡çº§çº¿ç¨‹ è°ƒåº¦æ–¹å¼ ç”±æ“ä½œç³»ç»Ÿè°ƒåº¦ ç”±æ“ä½œç³»ç»Ÿè°ƒåº¦ ç”±ç¨‹åºè‡ªè¡Œæ§åˆ¶ï¼ˆåä½œè°ƒåº¦ï¼‰ å†…å­˜ç‹¬ç«‹æ€§ è¿›ç¨‹é—´ç›¸äº’ç‹¬ç«‹ çº¿ç¨‹å…±äº«åŒä¸€è¿›ç¨‹çš„å†…å­˜ç©ºé—´ è¿è¡Œåœ¨çº¿ç¨‹å†…å…±äº«çº¿ç¨‹çš„å†…å­˜ åˆ‡æ¢å¼€é”€ é«˜ è¾ƒä½ æä½ ä½¿ç”¨åœºæ™¯ é€‚ç”¨äºéš”ç¦»æ€§è¦æ±‚é«˜çš„ä»»åŠ¡ å¹¶å‘æ‰§è¡ŒIOå¯†é›†å‹æˆ–CPUå¯†é›†å‹ä»»åŠ¡ é«˜å¹¶å‘IOæ“ä½œã€ååŒä»»åŠ¡å¤„ç† 3. è®¡ç®—æœºç½‘ç»œ å¼€æ”¾æ€§é—®é¢˜ï¼šAæœºå™¨å‘é€æŠ¥æ–‡åˆ°Bæœºå™¨é€”ä¸­æœ‰å“ªäº›å¯èƒ½åŸå› ä¼šå¯¼è‡´ä¸¢åŒ…ï¼Ÿ\nå¯èƒ½å¯¼è‡´æŠ¥æ–‡ä¸¢å¤±çš„åŸå› å¦‚ä¸‹ï¼š\nç½‘ç»œæ‹¥å¡ï¼šè·¯ç”±å™¨ã€äº¤æ¢æœºç­‰ä¸­é—´è®¾å¤‡å¤„ç†èƒ½åŠ›æœ‰é™ï¼Œå½“æµé‡è¶…è¿‡å…¶å¤„ç†èƒ½åŠ›æ—¶ï¼Œå¯èƒ½ä¼šä¸¢å¼ƒéƒ¨åˆ†æŠ¥æ–‡ã€‚ é“¾è·¯é”™è¯¯ï¼šåœ¨ä¼ è¾“ä»‹è´¨ï¼ˆå¦‚é“œçº¿ã€å…‰çº¤ï¼‰ä¸Šå¯èƒ½ä¼šå—åˆ°ç”µç£å¹²æ‰°ã€å™ªå£°ç­‰å½±å“å¯¼è‡´æ•°æ®é”™è¯¯è€Œè¢«ä¸¢å¼ƒã€‚ TTLï¼ˆç”Ÿå­˜æ—¶é—´ï¼‰è¶…æ—¶ï¼šIPæŠ¥æ–‡æœ‰ä¸€ä¸ªTTLå­—æ®µï¼Œæ¯ç»è¿‡ä¸€ä¸ªè·¯ç”±å™¨å‡å°‘1ï¼Œè‹¥TTLä¸º0æŠ¥æ–‡ä¼šè¢«ä¸¢å¼ƒã€‚ é˜²ç«å¢™è¿‡æ»¤ï¼šç½‘ç»œè·¯å¾„ä¸­æŸäº›é˜²ç«å¢™è®¾ç½®å¯èƒ½ä¼šæ ¹æ®æŠ¥æ–‡å†…å®¹æˆ–ç«¯å£ç­–ç•¥ä¸¢å¼ƒæŸäº›æŠ¥æ–‡ã€‚ ARPç¼“å­˜æœªæ›´æ–°ï¼šAæœºå™¨å¯èƒ½æ²¡æœ‰Bæœºå™¨çš„æœ€æ–°ARPè®°å½•ï¼Œå¯¼è‡´æ•°æ®å‘é€é”™è¯¯ã€‚ è®¾å¤‡æ•…éšœï¼šè·¯ç”±å™¨ã€äº¤æ¢æœºæˆ–ç½‘å¡ç­‰è®¾å¤‡æ•…éšœä¹Ÿå¯èƒ½å¯¼è‡´ä¸¢åŒ…ã€‚ 4. ç®—æ³•é¢˜ï¼šLCR 023. ç›¸äº¤é“¾è¡¨ é¢˜ç›®æè¿°ï¼š ç»™å®šä¸¤ä¸ªå•é“¾è¡¨ï¼Œåˆ¤æ–­å®ƒä»¬æ˜¯å¦ç›¸äº¤ï¼Œå¦‚æœç›¸äº¤ï¼Œè¿”å›ç›¸äº¤çš„èµ·å§‹èŠ‚ç‚¹ã€‚å‡è®¾é“¾è¡¨ç»“æ„ä¸å¯å˜ï¼Œä¸”ä¸ä½¿ç”¨é¢å¤–å†…å­˜ç©ºé—´ã€‚\nè§£é¢˜æ€è·¯ï¼š\nåŒæŒ‡é’ˆæ³•ï¼šä½¿ç”¨ä¸¤ä¸ªæŒ‡é’ˆåˆ†åˆ«ä»ä¸¤ä¸ªé“¾è¡¨çš„å¤´å¼€å§‹éå†ã€‚å½“æŸä¸€æŒ‡é’ˆéå†å®Œä¸€æ¡é“¾è¡¨åï¼Œä»å¦ä¸€æ¡é“¾è¡¨å¤´å¼€å§‹ï¼Œæœ€ç»ˆåœ¨ç›¸äº¤ç‚¹ç›¸é‡ã€‚ ä»£ç å®ç°ï¼š\nclass ListNode: def __init__(self, x): self.val = x self.next = None def getIntersectionNode(headA: ListNode, headB: ListNode) -\u0026gt; ListNode: if not headA or not headB: return None pA, pB = headA, headB # ä¸¤ä¸ªæŒ‡é’ˆèµ°è¿‡ç›¸åŒé•¿åº¦ï¼ˆAé“¾è¡¨+Bé“¾è¡¨ï¼‰ï¼Œæœ€ç»ˆç›¸é‡æˆ–åˆ°è¾¾None while pA != pB: # å¦‚æœpAåˆ°è¾¾æœ«å°¾åˆ™è½¬åˆ°headBï¼Œå¦åˆ™ç»§ç»­å‘ä¸‹ pA = pA.next if pA else headB # å¦‚æœpBåˆ°è¾¾æœ«å°¾åˆ™è½¬åˆ°headAï¼Œå¦åˆ™ç»§ç»­å‘ä¸‹ pB = pB.next if pB else headA return pA # è¿”å›ç›¸äº¤èŠ‚ç‚¹æˆ–Noneï¼ˆä¸ç›¸äº¤ï¼‰ å¤æ‚åº¦åˆ†æï¼š\næ—¶é—´å¤æ‚åº¦ï¼šO(m + n)ï¼Œmå’Œnæ˜¯ä¸¤ä¸ªé“¾è¡¨çš„é•¿åº¦ã€‚ ç©ºé—´å¤æ‚åº¦ï¼šO(1)ï¼Œåªç”¨äº†ä¸¤ä¸ªæŒ‡é’ˆï¼Œä¸éœ€è¦é¢å¤–ç©ºé—´ã€‚ è§£é‡Šï¼š é€šè¿‡åŒæŒ‡é’ˆæ³•ï¼Œä¸¤ä¸ªæŒ‡é’ˆçš„æ€»è·¯ç¨‹ç›¸åŒï¼Œå¦‚æœé“¾è¡¨ç›¸äº¤ï¼ŒæŒ‡é’ˆä¼šåœ¨ç›¸äº¤èŠ‚ç‚¹å¤„ç›¸é‡ï¼›å¦‚æœä¸ç›¸äº¤ï¼Œæœ€ç»ˆä¸¤ä¸ªæŒ‡é’ˆéƒ½ä¼šèµ°åˆ°é“¾è¡¨å°¾éƒ¨çš„Noneã€‚\n","permalink":"https://kennems.github.io/posts/tech/%E9%9D%A2%E7%BB%8F2/","summary":"é¢ç»ï¼ˆ2ï¼‰ è…¾è®¯é¢ç» 1. è‡ªæˆ‘ä»‹ç»ä¸é¡¹ç›® åœ¨è‡ªæˆ‘ä»‹ç»ç¯èŠ‚ï¼Œå»ºè®®çªå‡ºä»¥ä¸‹å‡ ç‚¹ï¼š èƒŒæ™¯å’Œæ•™è‚²ç»å†ï¼šè¯´æ˜ä½ çš„ä¸“ä¸šã€å­¦æ ¡å’Œæ¯•ä¸šæ—¶é—´ã€‚å¦‚æœæœ‰ç›¸å…³çš„å­¦æœ¯æˆæœæˆ–è€…å¥–","title":"é¢ç»ï¼ˆ2ï¼‰"},{"content":"RabbitMQ åŒæ­¥é€šè®¯ å’Œ å¼‚æ­¥é€šè®¯\nåŒæ­¥è°ƒç”¨ åŒæ­¥è°ƒç”¨çš„é—®é¢˜ï¼š\næ‹“å±•æ€§å·® æ€§èƒ½ä¸‹é™ çº§è”å¤±è´¥ å¼‚æ­¥è°ƒç”¨ å¼‚æ­¥è°ƒç”¨æ–¹å¼å…¶å®å°±æ˜¯åŸºäºæ¶ˆæ¯é€šçŸ¥çš„æ–¹å¼ï¼Œä¸€èˆ¬åŒ…å«ä¸‰ä¸ªè§’è‰²ï¼š\næ¶ˆæ¯å‘é€è€…ï¼šæŠ•é€’æ¶ˆæ¯çš„äººï¼Œå°±æ˜¯åŸæ¥çš„è°ƒç”¨æ–¹ æ¶ˆæ¯ä»£ç†ï¼šç®¡ç†ã€æš‚å­˜ã€è½¬å‘æ¶ˆæ¯ï¼Œå¯ä»¥ç†è§£ä¸ºå¾®ä¿¡æœåŠ¡å™¨ æ¶ˆæ¯æ¥æ”¶è€…ï¼šæ¥å—å’Œå¤„ç†æ¶ˆæ¯çš„äººï¼Œå°±æ˜¯åŸæ¥çš„æœåŠ¡æä¾›æ–¹ æ”¯ä»˜æœåŠ¡ä¸å†åŒæ­¥è°ƒç”¨ä¸šåŠ¡å…³è”åº¦ä½çš„æœåŠ¡ï¼Œè€Œæ˜¯å‘é€æ¶ˆæ¯é€šçŸ¥åˆ°Brokerã€‚\nå…·å¤‡ä¸‹åˆ—ä¼˜åŠ¿ï¼š\nè§£é™¤è€¦åˆï¼Œæ‹“å±•æ€§å¼º æ— éœ€ç­‰å¾…ï¼Œæ€§èƒ½å¥½ æ•…éšœéš”ç¦» ç¼“å­˜æ¶ˆæ¯ï¼Œæµé‡å‰Šå³°å¡«è°· ç¼ºç‚¹ï¼š\nä¸èƒ½ç«‹åˆ»å¾—åˆ°è°ƒç”¨ç»“æœï¼Œæ—¶æ•ˆæ€§å·® ä¸ç¡®å®šä¸‹æ¸¸ä¸šåŠ¡æ‰§è¡Œæ˜¯å¦æˆåŠŸ ä¸šåŠ¡å®‰å…¨ä¾èµ–äºBrokerçš„å¯é æ€§ MQ MQï¼ˆMessageQueueï¼‰ï¼Œæ¶ˆæ¯é˜Ÿåˆ—ï¼Œå­˜æ”¾æ¶ˆæ¯çš„é˜Ÿåˆ—ï¼Œä¹Ÿå°±æ˜¯å¼‚æ­¥è°ƒç”¨ä¸­çš„Brokerã€‚\nç‰¹æ€§ RabbitMQ ActiveMQ RocketMQ Kafka å…¬å¸/ç¤¾åŒº Rabbit Apache é˜¿é‡Œ Apache å¼€å‘è¯­è¨€ Erlang Java Java Scala \u0026amp; Java åè®®æ”¯æŒ AMQP, XMPP, SMTP, STOMP OpenWire, STOMP, REST, XMPP, AMQP è‡ªå®šä¹‰åè®® è‡ªå®šä¹‰åè®® å¯ç”¨æ€§ é«˜ ä¸€èˆ¬ é«˜ éå¸¸é«˜ å•æœºååé‡ ä¸€èˆ¬ å·® é«˜ éå¸¸é«˜ æ¶ˆæ¯å»¶è¿Ÿ å¾®ç§’çº§ æ¯«ç§’çº§ æ¯«ç§’çº§ æ¯«ç§’ä»¥å†… æ¶ˆæ¯å¯é æ€§ é«˜ ä¸€èˆ¬ é«˜ ä¸€èˆ¬ RabbitMQçš„æ•´ä½“æ¶æ„åŠæ ¸å¿ƒæ¦‚å¿µ virtual-hostï¼šè™šæ‹Ÿä¸»æœºï¼Œèµ·åˆ°æ•°æ®éš”ç¦»çš„ä½œç”¨ publisherï¼šæ¶ˆæ¯å‘é€è€… consumerï¼šæ¶ˆæ¯çš„æ¶ˆè´¹è€… queueï¼šé˜Ÿåˆ—ï¼Œå­˜å‚¨æ¶ˆæ¯ exchangeï¼šäº¤æ¢æœºï¼Œè´Ÿè´£è·¯ç”±æ¶ˆæ¯ å¿«é€Ÿå…¥é—¨ å¯åŠ¨MQ docker run \\ -e RABBITMQ_DEFAULT_USER=itheima \\ -e RABBITMQ_DEFAULT_PASS=123321 \\ -v mq-plugins:/plugins \\ --name mq \\ --hostname mq \\ -p 15672:15672 \\ -p 5672:5672 \\ --network hmall \\ -d \\ rabbitmq:3.8-management ç¨‹åºæ§åˆ¶ AMQP Advanced Message Queuing Protocolï¼Œ æ˜¯ç”¨äºåœ¨åº”ç”¨ç¨‹åºä¹‹é—´ä¼ é€’ä¸šåŠ¡æ¶ˆæ¯çš„å¼€æ”¾æ ‡å‡†ã€‚æ”¹åè®®ä¸è¯­è¨€å’Œå¹³å°æ— å…³ï¼Œæ›´ç¬¦åˆå¾®æœåŠ¡ä¸­ç‹¬ç«‹æ€§çš„è¦æ±‚ã€‚\nSpring AMQP Spring AMQP æ˜¯åŸºäºAMQPåè®®å®šä¹‰çš„ä¸€å¥—APIè§„èŒƒï¼Œæä¾›äº†æ¨¡æ¿æ¥å‘é€å’Œæ¥å—æ¶ˆæ¯ã€‚åŒ…å«ä¸¤éƒ¨åˆ†ï¼Œå…¶ä¸­spring-amqpæ˜¯åŸºç¡€æŠ½è±¡ï¼Œspring-rabbitæ˜¯åº•å±‚çš„é»˜è®¤å®ç°ã€‚\nå‘é€è€… @SpringBootTest public class SpringAmqpTest { @Autowired private RabbitTemplate rabbitTemplate; @Test void testSendMessage2Queue(){ String queueName = \u0026#34;simple.queue\u0026#34;; String msg = \u0026#34;hello, rabbitmq\u0026#34;; rabbitTemplate.convertAndSend(queueName, msg); } } ç›‘å¬è€… @Slf4j @Component public class MqListener { @RabbitListener(queues = \u0026#34;simple.queue\u0026#34;) public void listenSimpleQueue(String msg) { System.out.println(\u0026#34;æ¶ˆè´¹è€…æ”¶åˆ°æ¶ˆæ¯ï¼šã€\u0026#34; + msg + \u0026#34;ã€‘\u0026#34;); } } Workæ¨¡å‹çš„ä½¿ç”¨ï¼š\nå¤šä¸ªæ¶ˆè´¹è€…ç»‘å®šåˆ°ä¸€ä¸ªé˜Ÿåˆ—ï¼Œå¯ä»¥åŠ å¿«æ¶ˆæ¯å¤„ç†é€Ÿåº¦ åŒä¸€æ¡æ¶ˆæ¯åªä¼šè¢«ä¸€ä¸ªæ¶ˆè´¹è€…å¤„ç† é€šè¿‡è®¾ç½®prefetchæ¥æ§åˆ¶æ¶ˆè´¹è€…é¢„å–çš„æ¶ˆæ¯æ•°é‡ï¼Œå¤„ç†å®Œä¸€æ¡å†å¤„ç†ä¸‹ä¸€æ¡ï¼Œå®ç°èƒ½è€…å¤šåŠ³ äº¤æ¢æœº çœŸæ­£ç”Ÿäº§ç¯å¢ƒéƒ½ä¼šç»è¿‡exchangeæ¥å‘é€æ¶ˆæ¯ï¼Œè€Œä¸æ˜¯ç›´æ¥å‘é€åˆ°é˜Ÿåˆ—ï¼Œäº¤æ¢æœºçš„ç±»å‹æœ‰ä»¥ä¸‹ä¸‰ç§ï¼š\nFanoutï¼šå¹¿æ’­ Directï¼šå®šå‘ Topicï¼šè¯é¢˜ Fanoutäº¤æ¢æœº Fanout Exchangeä¼šå°†æ¥å—åˆ°çš„æ¶ˆæ¯å¹¿æ’­åˆ°æ¯ä¸€ä¸ªè·Ÿå…¶ç»‘å®šçš„queueï¼Œæ‰€ä»¥ä¹Ÿå«å¹¿æ’­æ¨¡å¼\nDirectäº¤æ¢æœº Direct Exchangeä¼šå°†æ¥æ”¶åˆ°çš„æ¶ˆæ¯æ ¹æ®è§„åˆ™è·¯ç”±åˆ°æŒ‡å®šçš„Queueï¼Œå› æ­¤ç§°ä¸ºå®šå‘è·¯ç”±ã€‚\næ¯ä¸€ä¸ªQueueéƒ½ä¸Exchangeè®¾ç½®ä¸€ä¸ªBindingKey å‘å¸ƒè€…å‘é€æ¶ˆæ¯æ—¶ï¼ŒæŒ‡å®šæ¶ˆæ¯çš„RoutingKey Exchangeå°†æ¶ˆæ¯è·¯ç”±åˆ°BindingKeyä¸æ¶ˆæ¯RoutingKeyä¸€è‡´çš„é˜Ÿåˆ— Topicäº¤æ¢æœº TopicExchangeä¸DirectExchangeç±»ä¼¼ï¼ŒåŒºåˆ«åœ¨äºroutingKeyå¯ä»¥æ—¶å¤šä¸ªå•è¯çš„åˆ—è¡¨ï¼Œå¹¶ä¸”ä»¥ï¼Œåˆ†å‰²ã€‚\nQueueä¸ExchangeæŒ‡å®šBindingKeyæ—¶å¯ä»¥ä½¿ç”¨é€šé…ç¬¦ï¼š\n# ï¼šä»£æŒ‡0ä¸ªæˆ–å¤šä¸ªå•è¯ *ï¼šä»£æŒ‡ä¸€ä¸ªå•è¯ å£°æ˜é˜Ÿåˆ—å’Œäº¤æ¢æœº SpringAMQPæä¾›äº†å‡ ä¸ªç±»ï¼Œç”¨æ¥å£°æ˜é˜Ÿåˆ—ã€äº¤æ¢æœºåŠå…¶ç»‘å®šå…³ç³»ï¼š\nQueueï¼šç”¨äºå£°æ˜é˜Ÿåˆ—ï¼Œå¯ä»¥ç”¨å·¥å‚ç±»QueueBuilderæ„å»º Exchangeï¼šç”¨äºå£°æ˜äº¤æ¢æœºï¼Œå¯ä»¥ç”¨å·¥å‚ç±»ExchangeBuilderæ„å»º Bindingï¼šç”¨äºå£°æ˜é˜Ÿåˆ—å’Œäº¤æ¢æœºçš„ç»‘å®šå…³ç³»ï¼Œå¯ä»¥ç”¨å·¥å‚ç±»BindingBuilderæ„å»º @Configuration public class DirectConfiguration { @Bean public DirectExchange directExchange() { return new DirectExchange(\u0026#34;hmall.direct\u0026#34;); } @Bean public Queue directQueue1() { return new Queue(\u0026#34;direct.queue1\u0026#34;); } @Bean public Binding directQueue1BindingRed(Queue directQueue1, DirectExchange directExchange) { return BindingBuilder.bind(directQueue1).to(directExchange).with(\u0026#34;red\u0026#34;); } @Bean public Binding directQueue1BindingBlue(Queue directQueue1, DirectExchange directExchange) { return BindingBuilder.bind(directQueue1).to(directExchange).with(\u0026#34;blue\u0026#34;); } @Bean public Queue directQueue2() { return new Queue(\u0026#34;direct.queue2\u0026#34;); } @Bean public Binding directQueue2BindingRed(Queue directQueue2, DirectExchange directExchange) { return BindingBuilder.bind(directQueue2).to(directExchange).with(\u0026#34;red\u0026#34;); } @Bean public Binding directQueue2BindingYellow(Queue directQueue2, DirectExchange directExchange) { return BindingBuilder.bind(directQueue2).to(directExchange).with(\u0026#34;yellow\u0026#34;); } } åŸºäºæ³¨è§£å£°æ˜ @RabbitListener(bindings = @QueueBinding( value = @Queue(name = \u0026#34;direct.queue1\u0026#34;, durable = \u0026#34;true\u0026#34;), exchange = @Exchange(name = \u0026#34;hmall.direct\u0026#34;, type = ExchangeTypes.DIRECT), key = {\u0026#34;red\u0026#34;, \u0026#34;blue\u0026#34;, \u0026#34;Kennem\u0026#34;} )) public void listenDirectQueue1(String msg) throws InterruptedException { System.out.println(\u0026#34;æ¶ˆè´¹è€…1 æ”¶åˆ° direct.queue1 æ¶ˆæ¯ï¼šã€\u0026#34; + msg + \u0026#34;ã€‘.......\u0026#34;); } @RabbitListener(bindings = @QueueBinding( value = @Queue(name = \u0026#34;direct.queue2\u0026#34;, durable = \u0026#34;true\u0026#34;), exchange = @Exchange(name = \u0026#34;hmall.direct\u0026#34;, type = ExchangeTypes.DIRECT), key = {\u0026#34;red\u0026#34;, \u0026#34;yellow\u0026#34;} )) public void listenDirectQueue2(String msg) throws InterruptedException { System.out.println(\u0026#34;æ¶ˆè´¹è€…2 æ”¶åˆ° direct.queue1 æ¶ˆæ¯ï¼šã€\u0026#34; + msg + \u0026#34;ã€‘.......\u0026#34;); } æ¶ˆæ¯è½¬æ¢å™¨ å¯¼å…¥ä¾èµ–\n\u0026lt;!--Jackon--\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.fasterxml.jackson.dataformat\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;jackson-dataformat-xml\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; å®šä¹‰è½¬æ¢å™¨\n@Bean public MessageConverter jackonMessageConverter() { return new Jackson2JsonMessageConverter(); } ä¸šåŠ¡æ”¹é€  éœ€æ±‚ï¼šæ”¹é€ ä½™é¢æ”¯ä»˜åŠŸèƒ½ï¼Œä¸å†åŒæ­¥è°ƒç”¨äº¤æ˜“æœåŠ¡çš„OpenFeignæ¥å£ï¼Œè€Œæ˜¯é‡‡ç”¨å¼‚æ­¥MQé€šçŸ¥äº¤æ˜“æœåŠ¡æ›´æ–°è®¢å•çŠ¶æ€\nMQé«˜çº§ æ¶ˆæ¯å¯é æ€§é—®é¢˜ å‘é€è€…çš„å¯é æ€§ ç”Ÿäº§è€…é‡è¿ ç”±äºç½‘ç»œæ³¢åŠ¨ï¼Œå¯èƒ½ä¼šå‡ºç°å®¢æˆ·ç«¯è¿æ¥MQå¤±è´¥çš„æƒ…å†µã€‚é€šè¿‡é…ç½®æˆ‘ä»¬å¯ä»¥å¼€å¯è¿æ¥å¤±è´¥åçš„é‡è¿æœºåˆ¶ã€‚\nspring: rabbitmq: connection-timeout: 1s template: retry: enabled: true SpringAMQPæä¾›çš„é‡è¯•æœºåˆ¶æ˜¯é˜»å¡å¼çš„é‡è¯•ï¼Œä¹Ÿå°±æ˜¯è¯´å¤šæ¬¡é‡è¯•ç­‰å¾…çš„è¿‡ç¨‹ä¸­ï¼Œå½“å‰çº¿ç¨‹æ˜¯è¢«é˜»å¡çš„ï¼Œä¼šå½±å“ä¸šåŠ¡æ€§èƒ½ã€‚\nå¦‚æœå¯¹äºä¸šåŠ¡æ€§èƒ½æœ‰è¦æ±‚ï¼Œå»ºè®®ç¦ç”¨é‡è¯•æœºåˆ¶ã€‚å¦‚æœä¸€å®šè¦ç”¨ï¼Œè¯·åˆç†é…ç½®ç­‰å¾…æ—¶é•¿å’Œé‡è¯•æ¬¡æ•°ï¼Œä¹Ÿå¯ä»¥è€ƒè™‘ä½¿ç”¨å¼‚æ­¥çº¿ç¨‹æ¥æ‰§è¡Œå‘é€æ¶ˆæ¯çš„ä»£ç \nç”Ÿäº§è€…ç¡®è®¤ RabbitMQæä¾›äº†Publisher Confirmå’ŒPublisher Returnä¸¤ç§ç¡®è®¤æœºåˆ¶ã€‚å¼€å¯ç¡®è®¤æœºåˆ¶åä¼šè¿”å›ç¡®è®¤æ¶ˆæ¯ç»™ç”Ÿäº§è€…ã€‚è¿”å›çš„ç»“æœæœ‰ä»¥ä¸‹å‡ ç§æƒ…å†µï¼š\næ¶ˆæ¯æŠ•é€’åˆ°äº†MQï¼Œä½†æ˜¯è·¯ç”±å¤±è´¥ã€‚æ­¤æ—¶ä¼šé€šè¿‡PublisherReturnè¿”å›è·¯ç”±å¼‚å¸¸åŸå› ï¼Œç„¶åè¿”å›ACKï¼Œå‘ŠçŸ¥æŠ•é€’æˆåŠŸ ä¸´æ—¶æ¶ˆæ¯æŠ•é€’åˆ°äº†MQï¼Œå¹¶ä¸”å…¥é˜ŸæˆåŠŸï¼Œè¿”å›ACKï¼Œå‘ŠçŸ¥æŠ•é€’æˆåŠŸ æŒä¹…æ¶ˆæ¯æŠ•é€’åˆ°äº†MQï¼Œå¹¶ä¸”å…¥é˜Ÿå®ŒæˆæŒä¹…åŒ–ï¼Œè¿”å›ACKï¼Œå‘ŠçŸ¥æŠ•é€’æˆåŠŸ å…¶ä»–æƒ…å†µéƒ½ä¼šè¿”å›NACKï¼Œå‘ŠçŸ¥æŠ•é€’å¤±è´¥ åœ¨publisherè¿™ä¸ªå¾®æœåŠ¡çš„application.ymlä¸­æ·»åŠ é…ç½®ï¼š spring: rabbitmq: publisher-confirm-type: correlated publisher-returns: true é…ç½®è¯´æ˜ï¼š\npublisher-comfirm-typeæœ‰ä¸‰ç§æ¨¡å¼å¯é€‰ï¼š\nnoneï¼šå…³é—­confirmæœºåˆ¶ simpleï¼šåŒæ­¥é˜»å¡ç­‰å¾…MQçš„å›æ‰§æ¶ˆæ¯ correlatedï¼šMQå¼‚æ­¥å›è°ƒæ–¹å¼è¿”å›å›æ‰§æ¶ˆæ¯ æ¯ä¸ªRabbitTemplateåªèƒ½é…ç½®ReturnCallbackï¼Œå› æ­¤éœ€è¦åœ¨é¡¹ç›®å¯åŠ¨è¿‡ç¨‹ä¸­é…ç½®ï¼š @Slf4j @Configuration public class CommonConfig implements ApplicationContextAware { @Override public void setApplicationContext(ApplicationContext applicationContext) throws BeansException { // è·å–RabbitTemplate RabbitTemplate rabbitTemplate = applicationContext.getBean(RabbitTemplate.class); // è®¾ç½®ReturnCallback rabbitTemplate.setReturnCallback((message, replyCode, replyText, exchange, routingKey) -\u0026gt; { log.info(\u0026#34;æ¶ˆæ¯å‘é€å¤±è´¥, åº”ç­”ç {}, åŸå› {}, äº¤æ¢æœº{}, è·¯ç”±é”®{},æ¶ˆæ¯{}\u0026#34;, replyCode, replyText, exchange, routingKey, message.toString()); }); } } å‘é€æ¶ˆæ¯ï¼ŒæŒ‡å®šæ¶ˆæ¯IDã€æ¶ˆæ¯ConfirmCallback @Test void testPublisherConfirm() throws InterruptedException { // 1. åˆ›å»ºCorrelationData CorrelationData cd = new CorrelationData(); // 2. ç»™Futureæ·»åŠ ConfirmCallback cd.getFuture().addCallback(new ListenableFutureCallback\u0026lt;CorrelationData.Confirm\u0026gt;() { @Override public void onFailure(Throwable ex) { // 2.1.Futureå‘ç”Ÿå¼‚å¸¸æ—¶çš„å¤„ç†é€»è¾‘,åŸºæœ¬ä¸ä¼šè§¦å‘ log.error(\u0026#34;handle message ack fail\u0026#34;, ex); } @Override public void onSuccess(CorrelationData.Confirm result) { // 2.2.Futureæ¥æ”¶åˆ°å›æ‰§çš„å¤„ç†é€»è¾‘,å‚æ•°ä¸­çš„resultå°±æ˜¯å›æ‰§å†…å®¹ if(result.isAck()){ // result.isAck(), booleanç±»å‹, trueä»£è¡¨ackå›æ‰§, false ä»£è¡¨ nackå›æ‰§ log.debug(\u0026#34;å‘é€æ¶ˆæ¯æˆåŠŸ, æ”¶åˆ° ack!\u0026#34;); }else{ // result.getReason(), Stringç±»å‹, è¿”å›nackæ—¶çš„å¼‚å¸¸æè¿° log.error(\u0026#34;å‘é€æ¶ˆæ¯å¤±è´¥, æ”¶åˆ° nack, reason : {}\u0026#34;, result.getReason()); } } }); // 3. å‘é€æ¶ˆæ¯ rabbitTemplate.convertAndSend(\u0026#34;hmall.direct\u0026#34;, \u0026#34;red1\u0026#34;, \u0026#34;hello\u0026#34;, cd);d } ç”Ÿäº§è€…ç¡®è®¤éœ€è¦é¢å¤–çš„ç½‘ç»œå’Œç³»ç»Ÿèµ„æºå¼€é”€ï¼Œå°½é‡ä¸è¦ä½¿ç”¨ å¦‚æœä¸€å®šè¦ç”¨ï¼Œæ— éœ€å¼€å¯Publisher-Returnæœºåˆ¶ï¼Œå› ä¸ºä¸€èˆ¬è·¯ç”±å¤±è´¥æ˜¯è‡ªå·±ä¸šåŠ¡é—®é¢˜ å¯¹äºnackæ¶ˆæ¯å¯ä»¥æœ‰é™æ¬¡æ•°é‡è¯•ï¼Œä¾ç„¶å¤±è´¥åˆ™è®°å½•å¼‚å¸¸æ¶ˆæ¯ MQçš„å¯é æ€§ åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼ŒRabbitMQä¼šå°†æ¥æ”¶åˆ°çš„æ¶ˆæ¯ä¿å­˜åœ¨å†…å­˜ä¸­ä»¥é™ä½æ¶ˆæ¯æ”¶å‘çš„å»¶è¿Ÿã€‚è¿™æ ·ä¼šå¯¼è‡´ä¸¤ä¸ªé—®é¢˜ï¼š\nä¸€æ—¦MQå®•æœºï¼Œå†…å­˜ä¸­çš„æ¶ˆæ¯ä¼šä¸¢å¤± å†…å­˜ç©ºé—´æœ‰é™ï¼Œå½“æ¶ˆè´¹è€…æ•…éšœæˆ–å¤„ç†è¿‡æ…¢æ—¶ï¼Œä¼šå¯¼è‡´æ¶ˆæ¯ç§¯å‹ï¼Œå¼•å‘MQé˜»å¡ æ•°æ®æŒä¹…åŒ– Rabbit MQå®ç°çš„æ•°æ®æŒä¹…åŒ–åŒ…æ‹¬3ä¸ªæ–¹é¢ï¼š\näº¤æ¢æœºæŒä¹…åŒ– æŒ‡å®šdurable é˜Ÿåˆ—æŒä¹…åŒ– æŒ‡å®šdurable æ¶ˆæ¯æŒä¹…åŒ– æŒ‡å®špersistent LazyQueue ä»RabbitMQçš„3.6.0ç‰ˆæœ¬å¼€å§‹ï¼Œå°±å¢åŠ äº†Lazy Queueçš„æ¦‚å¿µï¼Œä¹Ÿå°±æ˜¯æƒ°æ€§é˜Ÿåˆ—\næƒ°æ€§é˜Ÿåˆ—çš„ç‰¹å¾å¦‚ä¸‹ï¼š\næ¥æ”¶åˆ°æ¶ˆæ¯åç›´æ¥å­˜å…¥ç£ç›˜è€Œéå†…å­˜ï¼ˆå†…å­˜ä¸­åªä¿ç•™æœ€è¿‘çš„æ¶ˆæ¯ï¼Œé»˜è®¤2048æ¡ï¼‰ æ¶ˆè´¹è€…è¦æ¶ˆè´¹æ¶ˆæ¯æ—¶æ‰ä¼šä»ç£ç›˜ä¸­è¯»å–å¹¶åŠ è½½åˆ°å†…å­˜ æ”¯æŒæ•°ç™¾ä¸‡æ¡çš„æ¶ˆæ¯å­˜å‚¨ åœ¨3.12ç‰ˆæœ¬ä¹‹åï¼Œæ‰€æœ‰é˜Ÿåˆ—éƒ½æ˜¯Lazy Queueæ¨¡å¼ï¼Œæ— æ³•æ›´æ”¹\nå®šä¹‰queueå½¢å¼\n@Bean public Queue lazyQueue(){ return QueueBuilder .durable(\u0026#34;lazy.queue\u0026#34;) .lazy() // å¼€å¯Lazyæ¨¡å¼ .build(); } åŸºäºæ³¨è§£å½¢å¼ï¼š\n@RabbitListener(queuesToDeclare = @Queue( name = \u0026#34;lazy.queue\u0026#34;, durable = \u0026#34;true\u0026#34;, arguments = @Argument(name = \u0026#34;x-queue-mode\u0026#34;, value = \u0026#34;lazy\u0026#34;) )) public void listenLazyQueue(String msg){ log.info(\u0026#34;æ¥æ”¶åˆ° lazy.queueçš„æ¶ˆæ¯: {}\u0026#34;, msg); } å¼€å¯æŒä¹…åŒ–å’Œç”Ÿäº§è€…ç¡®è®¤æ—¶ï¼ŒRabbitMQåªæœ‰åœ¨æ¶ˆæ¯æŒä¹…åŒ–å®Œæˆåæ‰ä¼šç»™ç”Ÿäº§è€…è¿”å›ACKå›æ‰§ã€‚ æ¶ˆè´¹è€…çš„å¯é æ€§ æ¶ˆè´¹è€…ç¡®è®¤æœºåˆ¶ ä¸ºäº†ç¡®è®¤æ¶ˆè´¹è€…æ˜¯å¦æˆåŠŸå¤„ç†æ¶ˆæ¯ï¼ŒRabbitMQæä¾›äº†æ¶ˆè´¹è€…ç¡®è®¤æœºåˆ¶ï¼ˆConsumer Acknowledgementï¼‰ã€‚å½“æ¶ˆè´¹è€…å¤„ç†æ¶ˆæ¯ç»“æŸåï¼Œåº”è¯¥å‘RabbitMQå‘é€ä¸€ä¸ªå›æ‰§ï¼Œå‘ŠçŸ¥RabbitMQè‡ªå·±æ¶ˆæ¯å¤„ç†çŠ¶æ€ã€‚å›æ‰§æœ‰ä¸‰ç§å¯é€‰å€¼ï¼š\nackï¼šæˆåŠŸå¤„ç†æ¶ˆæ¯ï¼ŒRabbitMQä»é˜Ÿåˆ—ä¸­åˆ é™¤æ¶ˆæ¯ nackï¼šæ¶ˆæ¯å¤„ç†å¤±è´¥ï¼ŒRabbitMQéœ€è¦å†æ¬¡æŠ•é€’æ¶ˆæ¯ rejectï¼šæ¶ˆæ¯å¤„ç†å¤±è´¥å¹¶æ‹’ç»è¯¥æ¶ˆæ¯ï¼ŒRabbitMQä»é˜Ÿåˆ—ä¸­åˆ é™¤è¯¥æ¶ˆæ¯ SpringAMQPå·²ç»å®ç°äº†æ¶ˆæ¯ç¡®è®¤åŠŸèƒ½ã€‚å¹¶å…è®¸æˆ‘ä»¬é€šè¿‡é…ç½®æ–‡ä»¶é€‰æ‹©ACKå¤„ç†æ–¹å¼ï¼Œæœ‰ä¸‰ç§æ–¹å¼ï¼š\nnoneï¼šä¸å¤„ç†ã€‚å³æ¶ˆæ¯æŠ•é€’ç»™æ¶ˆè´¹è€…åç«‹åˆ»ackï¼Œæ¶ˆæ¯ä¼šç«‹åˆ»ä»MQåˆ é™¤ã€‚éå¸¸ä¸å®‰å…¨ï¼Œä¸å»ºè®®ä½¿ç”¨ manualï¼šæ‰‹åŠ¨æ¨¡å¼ã€‚éœ€è¦è‡ªå·±åœ¨ä¸šåŠ¡ä»£ç ä¸­è°ƒç”¨apiï¼Œå‘é€ackå’Œrejectï¼Œå­˜åœ¨ä¸šåŠ¡å…¥ä¾µï¼Œä½†æ›´çµæ´» autoï¼šè‡ªåŠ¨æ¨¡å¼ã€‚SpringAMQPåˆ©ç”¨AOPå¯¹æˆ‘ä»¬çš„æ¶ˆæ¯å¤„ç†é€»è¾‘åšäº†ç¯ç»•å¢å¼ºï¼Œå½“ä¸šåŠ¡æ­£å¸¸æ‰§è¡Œæ—¶åˆ»è‡ªåŠ¨è¿”å›ackï¼Œå½“ä¸šåŠ¡å‡ºç°å¼‚å¸¸æ—¶ï¼Œæ ¹æ®å¼‚å¸¸åˆ¤æ–­è¿”å›ä¸åŒç»“æœï¼š å¦‚æœä¸šåŠ¡å¼‚å¸¸ï¼Œä¼šè‡ªåŠ¨è¿”å›nack å¦‚æœæ˜¯æ¶ˆæ¯å¤„ç†æˆ–æ ¡éªŒå¼‚å¸¸ï¼Œè‡ªåŠ¨è¿”å›reject å¤±è´¥æ¶ˆæ¯å¤„ç†ç­–ç•¥ åœ¨å¼€å¯é‡è¯•æ¨¡å¼åï¼Œé‡è¯•æ¬¡æ•°è€—å°½ï¼Œå¦‚æœæ¶ˆæ¯ä¾ç„¶å¤±è´¥ï¼Œåˆ™éœ€è¦æœ‰MessageRecovereræ¥å£æ¥å¤„ç†ï¼Œå®ƒåŒ…å«ä¸‰ç§ä¸åŒçš„å®ç°ï¼š\nRejectAndDontRequeueRecovererï¼šé‡è¯•è€—å°½åï¼Œç›´æ¥rejectï¼Œä¸¢å¼ƒæ¶ˆæ¯ã€‚é»˜è®¤å°±æ˜¯è¿™ç§æ–¹å¼ã€‚ ImmediateRequeueMessageRecovererï¼šé‡è¯•è€—å°½åï¼Œè¿”å›nackï¼Œæ¶ˆæ¯é‡æ–°å…¥é˜Ÿ RepublishMessageRecovererï¼šé‡è¯•è€—å°½åï¼Œå°†å¤±è´¥æ¶ˆæ¯æŠ•é€’åˆ°æŒ‡å®šçš„äº¤æ¢æœº RepublishMessageRecoverer å¤šæ¬¡é‡è¯•è€—å°½åï¼Œå°†é”™è¯¯è½¬å‘åˆ°error.directäº¤æ¢æœºä¸­\n@Configuration @ConditionalOnProperty(prefix = \u0026#34;spring.rabbitmq.listener.simple.retry\u0026#34;, name = \u0026#34;enabled\u0026#34;, havingValue = \u0026#34;true\u0026#34;) public class ErrorConfiguration { @Bean public DirectExchange errorExchange(){ return new DirectExchange(\u0026#34;error.direct\u0026#34;); } @Bean public Queue errorQueue(){ return new Queue(\u0026#34;error.queue\u0026#34;); } @Bean public Binding errorBinding(Queue errorQueue, DirectExchange errorExchange){ return BindingBuilder.bind(errorQueue).to(errorExchange).with(\u0026#34;error\u0026#34;); } @Bean public MessageRecoverer messageRecoverer(RabbitTemplate rabbitTemplate){ return new RepublishMessageRecoverer(rabbitTemplate, \u0026#34;error.direct\u0026#34;, \u0026#34;error\u0026#34;); } } ä¸šåŠ¡å¹‚ç­‰æ€§ å¹‚ç­‰æ˜¯ä¸€ä¸ªæ•°å­¦æ¦‚å¿µï¼Œç”¨å‡½æ•°è¡¨è¾¾å¼æ¥æè¿°ï¼š$f(x) = f(f(x))$ã€‚åœ¨ç¨‹åºå¼€å‘ä¸­ï¼Œåˆ™æŒ‡åŒä¸€ä¸ªä¸šåŠ¡ï¼Œæ‰§è¡Œå¤šæ¬¡å¯¹ä¸šåŠ¡çŠ¶æ€çš„å½±å“æ˜¯ä¸€è‡´çš„ã€‚\næŸ¥è¯¢å’Œåˆ é™¤æ“ä½œå¤©ç”Ÿå¹‚ç­‰ å”¯ä¸€æ¶ˆæ¯Id æ–¹æ¡ˆä¸€ï¼Œç»™æ¯ä¸ªæ¶ˆæ¯éƒ½è®¾ç½®ä¸€ä¸ªå”¯ä¸€çš„idï¼Œåˆ©ç”¨idåŒºåˆ†æ˜¯å¦æ˜¯é‡å¤æ¶ˆæ¯ï¼š\næ¯ä¸€æ¡æ¶ˆæ¯éƒ½ç”Ÿæˆä¸€ä¸ªå”¯ä¸€çš„idï¼Œä¸æ¶ˆæ¯ä¸€èµ·æŠ•é€’ç»™æ¶ˆè´¹è€… æ¶ˆè´¹è€…æ¥æ”¶åˆ°æ¶ˆæ¯åå¤„ç†è‡ªå·±çš„ä¸šåŠ¡ï¼Œä¸šåŠ¡å¤„ç†æˆåŠŸåå°†æ¶ˆæ¯IDä¿å­˜åˆ°æ•°æ®åº“ä¸­ å¦‚æœä¸‹æ¬¡åˆæ”¶åˆ°ç›¸åŒçš„æ¶ˆæ¯ï¼Œå»æ•°æ®åº“æŸ¥è¯¢åˆ¤æ–­æ˜¯å¦å­˜åœ¨ï¼Œå­˜åœ¨åˆ™ä¸ºé‡å¤æ¶ˆæ¯æ”¾å¼ƒå¤„ç† @Bean public MessageConverter jackonMessageConverter() { Jackson2JsonMessageConverter jjmc = new Jackson2JsonMessageConverter(); jjmc.setCreateMessageIds(true); return jjmc; } æ–¹æ¡ˆäºŒï¼Œç»“åˆä¸šåŠ¡é€»è¾‘ï¼ŒåŸºäºä¸šåŠ¡æœ¬èº«åšåˆ¤æ–­ã€‚\né¢è¯•é¢˜ å¦‚æœä¿è¯æ”¯ä»˜æœåŠ¡ä¸äº¤æ˜“æœåŠ¡ä¹‹é—´çš„è®¢å•çŠ¶æ€ä¸€è‡´æ€§ï¼Ÿ é¦–å…ˆï¼Œæ”¯ä»˜æœåŠ¡ä¼šæ­£åœ¨ç”¨æˆ·æ”¯ä»˜æˆåŠŸä»¥ååˆ©ç”¨MQæ¶ˆæ¯é€šçŸ¥äº¤æ˜“æœåŠ¡ï¼Œå®Œæˆè®¢å•çŠ¶æ€åŒæ­¥ã€‚ å…¶æ¬¡ï¼Œä¸ºäº†ä¿è¯MQæ¶ˆæ¯çš„å¯é æ€§ï¼Œæˆ‘ä»¬é‡‡ç”¨äº†ç”Ÿäº§è€…ç¡®è®¤æœºåˆ¶ã€æ¶ˆè´¹è€…ç¡®è®¤ã€æ¶ˆè´¹è€…å¤±è´¥é‡è¯•ç­‰ç­–ç•¥ï¼Œç¡®ä¿æ¶ˆæ¯æŠ•é€’å’Œå¤„ç†çš„å¯é æ€§ã€‚åŒæ—¶ä¹Ÿå¼€å¯äº†MQçš„æŒä¹…åŒ–ï¼Œé¿å…å› æœåŠ¡å®•æœºå¯¼è‡´æ¶ˆæ¯ä¸¢å¤±ã€‚ æœ€åï¼Œæˆ‘ä»¬è¿˜åœ¨äº¤æ˜“æœåŠ¡æ›´æ–°è®¢å•çŠ¶æ€æ—¶åšäº†ä¸šåŠ¡å¹‚ç­‰åˆ¤æ–­ï¼Œé¿å…äº†å› ä¸ºé‡å¤æ¶ˆè´¹å¯¼è‡´è®¢å•çŠ¶æ€å¼‚å¸¸ã€‚ å¦‚æœäº¤æ˜“æœåŠ¡æ¶ˆæ¯å¤„ç†å¤±è´¥ï¼Œæœ‰æ²¡æœ‰ä»€ä¹ˆå…œåº•æ–¹æ¡ˆï¼Ÿ æˆ‘ä»¬å¯ä»¥åœ¨äº¤æ˜“æœåŠ¡è®¾ç½®å®šæ—¶ä»»åŠ¡ï¼Œå®šæ—¶æŸ¥è¯¢è®¢å•æ”¯ä»˜çŠ¶æ€ã€‚è¿™æ ·å³ä¾¿MQé€šçŸ¥å¤±è´¥ï¼Œè¿˜å¯ä»¥åˆ©ç”¨å®šæ—¶ä»»åŠ¡ä½œä¸ºå…œåº•æ–¹æ¡ˆï¼Œç¡®ä¿è®¢å•æ”¯ä»˜çŠ¶æ€çš„æœ€ç»ˆä¸€è‡´æ€§ã€‚ å»¶è¿Ÿæ¶ˆæ¯ å»¶è¿Ÿæ¶ˆæ¯ï¼šç”Ÿäº§è€…å‘é€æ¶ˆæ¯æ—¶æŒ‡å®šä¸€ä¸ªæ—¶é—´ï¼Œæ¶ˆè´¹è€…ä¸ä¼šç«‹åˆ»æ”¶åˆ°æ¶ˆæ¯ï¼Œè€Œæ˜¯åœ¨æŒ‡å®šæ—¶é—´ä¹‹åæ‰æ”¶åˆ°æ¶ˆæ¯\nå»¶è¿Ÿä»»åŠ¡ï¼šè®¾ç½®åœ¨ä¸€å®šæ—¶é—´ä¹‹åæ‰æ‰§è¡Œçš„ä»»åŠ¡\næ­»ä¿¡äº¤æ¢æœº å½“ä¸€ä¸ªé˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯æ»¡è¶³ä¸‹åˆ—æƒ…å†µä¹‹ä¸€æ—¶ï¼Œå°±ä¼šæˆä¸ºæ­»ä¿¡ï¼ˆdead letterï¼‰ï¼š\næ¶ˆè´¹è€…ä½¿ç”¨ basic.reject æˆ– basic.nack å£°æ˜æ¶ˆè´¹å¤±è´¥ï¼Œå¹¶ä¸”æ¶ˆæ¯çš„requeueå‚æ•°è®¾ç½®ä¸ºfalse æ¶ˆæ¯æ˜¯ä¸€ä¸ªè¿‡æœŸæ¶ˆæ¯ï¼ˆè¾¾åˆ°äº†é˜Ÿåˆ—æˆ–æ¶ˆæ¯æœ¬èº«è®¾ç½®çš„è¿‡æœŸæ—¶é—´ï¼‰ï¼Œè¶…æ—¶æ— äººæ¶ˆè´¹ è¦æŠ•é€’çš„é˜Ÿåˆ—æ¶ˆæ¯å †ç§¯æ»¡äº†ï¼Œæœ€æ—©çš„æ¶ˆæ¯å¯èƒ½ç§°ä¸ºæ­»ä¿¡ å¦‚æœé˜Ÿåˆ—é€šè¿‡dead-letter-exchangeå±æ€§åˆ¶å®šäº†ä¸€ä¸ªäº¤æ¢æœºï¼Œé‚£ä¹ˆè¯¥é˜Ÿåˆ—ä¸­çš„æ­»ä¿¡å°±ä¼šæŠ•é€’åˆ°è¿™ä¸ªäº¤æ¢æœºä¸­ã€‚è¿™ä¸ªäº¤æ¢æœºç§°ä¸ºæ­»ä¿¡äº¤æ¢æœºï¼ˆDead Letter Exchangeï¼Œ ç®€ç§°DLXï¼‰\nå»¶è¿Ÿæ¶ˆæ¯æ’ä»¶ ","permalink":"https://kennems.github.io/posts/tech/rabbitmq/","summary":"RabbitMQ åŒæ­¥é€šè®¯ å’Œ å¼‚æ­¥é€šè®¯ åŒæ­¥è°ƒç”¨ åŒæ­¥è°ƒç”¨çš„é—®é¢˜ï¼š æ‹“å±•æ€§å·® æ€§èƒ½ä¸‹é™ çº§è”å¤±è´¥ å¼‚æ­¥è°ƒç”¨ å¼‚æ­¥è°ƒç”¨æ–¹å¼å…¶å®å°±æ˜¯åŸºäºæ¶ˆæ¯é€šçŸ¥çš„æ–¹å¼ï¼Œä¸€èˆ¬åŒ…å«ä¸‰ä¸ªè§’è‰²ï¼š æ¶ˆæ¯å‘","title":"RabbitMQ"},{"content":"è‹ç©¹å¤–å–å‰ç«¯å¼€å‘(Day1) node.jså®‰è£… é…ç½®å…¨å±€ä¸‹è½½åŒ…åœ°å€å’Œç¼“å­˜åœ°å€ npm config set prefix \u0026#34;E:x\\nodejs\\node_global\u0026#34; npm config set cache \u0026#34;E:\\x\\nodejs\\node_cache\u0026#34; æœ€æ–°çš„é…ç½®æ·˜å®é•œåƒçš„æ·˜å®å®˜æ–¹æä¾›çš„æ–¹æ³• npm config set registry https://registry.npmmirror.com å®‰è£…Vue npm i @vue/cli -g åˆ›å»ºVueé¡¹ç›® å‘½ä»¤è¡Œåˆ›å»ºï¼ˆåªèƒ½åœ¨cmdï¼Œ ä¸èƒ½ç”¨powershellï¼‰\nvue create vue-demo-1 ç”¨ç½‘é¡µçš„å½¢å¼åˆ›å»º\nvue ui Vueç›®å½•ç»“æ„ node_modulesï¼šå½“å‰é¡¹ç›®ä¾èµ–çš„jsåŒ… assetsï¼šé™æ€èµ„æºå­˜æ”¾ç›®å½• componentsï¼šå…¬å…±ç»„ä»¶å­˜æ”¾ç›®å½• App.vueï¼šé¡¹ç›®çš„ä¸»ç»„ä»¶ï¼Œé¡µé¢çš„å…¥å£æ–‡ä»¶ main.jsï¼šæ•´ä¸ªé¡¹ç›®çš„å…¥å£æ–‡ä»¶ package.jsonï¼šé¡¹ç›®çš„é…ç½®ä¿¡æ¯ã€ä¾èµ–åŒ…ç®¡ç† vue.config.jsï¼švue-clié…ç½®æ–‡ä»¶ å¯åŠ¨Vueé¡¹ç›®å·¥ç¨‹ åœ¨Vueé¡¹ç›®æ–‡ä»¶å¤¹ä¸­ï¼š\nnpm run serve Vueçš„åŸºæœ¬ä½¿ç”¨æ–¹å¼ Vueç»„ä»¶ Vueçš„ç»„ä»¶æ–‡ä»¶ä»¥.vueç»“å°¾ï¼Œæ¯ä¸ªç»„ä»¶ç”±ä¸‰éƒ¨åˆ†ç»„æˆ\nç»“æ„ \u0026lt;template\u0026gt; åªæœ‰ä¸€ä¸ªæ ¹å…ƒç´  ç”±å®ƒç”ŸæˆHTMLä»£ç  æ ·å¼ \u0026lt;style\u0026gt; ç¼–å†™CSSï¼Œæ§åˆ¶é¡µé¢å±•ç¤ºæ•ˆæœ å…¨å±€æ ·å¼ï¼šå½±å“æ‰€æœ‰ç»„ä»¶ å±€éƒ¨æ ·å¼ï¼šåªä½œç”¨äºå½“å‰ç»„ä»¶ é€»è¾‘ \u0026lt;script\u0026gt; ç¼–å†™JSä»£ç  æ§åˆ¶æ¨¡æ¿çš„æ•°æ®æ¥æºå’Œè¡Œä¸º VueåŸºæœ¬ä½¿ç”¨æ–¹å¼ æ–‡æœ¬æ’å€¼ ä½œç”¨ï¼šç”¨æ¥ç»‘å®šdataæ–¹æ³•è¿”å›çš„å¯¹è±¡å±æ€§ ç”¨æ³•ï¼š{{}} å…ˆå®šä¹‰data()\n\u0026lt;script\u0026gt; export default { name: \u0026#34;HelloWorld\u0026#34;, props: { msg: String, }, data() { return { name: \u0026#34;å¼ ä¸‰\u0026#34;, age: 30, }; }, }; \u0026lt;/script\u0026gt; ä¹‹ååœ¨templateä¸­ä½¿ç”¨\n\u0026lt;div class=\u0026#34;hello\u0026#34;\u0026gt; {{ name }} {{ age \u0026gt; 60 ? \u0026#34;è€å¹´\u0026#34; : \u0026#34;é’å¹´\u0026#34; }} \u0026lt;/div\u0026gt; å±æ€§ç»‘å®š ä½œç”¨ï¼šä¸ºæ ‡ç­¾çš„å±æ€§ç»‘å®šdataæ–¹æ³•ä¸­è¿”å›çš„å±æ€§ ç”¨æ³•ï¼šv-bind:xxx ç®€å†™ä¸º:xxx \u0026lt;input type=\u0026#34;text\u0026#34; v-bind:value=\u0026#34;name\u0026#34;/\u0026gt; \u0026lt;input type=\u0026#34;text\u0026#34; :value=\u0026#34;age\u0026#34;/\u0026gt; \u0026lt;img :src=\u0026#34;src\u0026#34;/\u0026gt; äº‹ä»¶ç»‘å®š ä½œç”¨ï¼šä¸ºå…ƒç´ ç»‘å®šå¯¹åº”çš„äº‹ä»¶ ç”¨æ³•ï¼šv-on:xxxï¼Œç®€å†™ä¸º@xxx \u0026lt;input type=\u0026#34;button\u0026#34; value=\u0026#34;ä¿å­˜\u0026#34; v-on:click=\u0026#34;handleSave\u0026#34; /\u0026gt; \u0026lt;input type=\u0026#34;button\u0026#34; value=\u0026#34;ä¿å­˜\u0026#34; @click=\u0026#34;handleSave\u0026#34; /\u0026gt; \u0026lt;script\u0026gt; export default { methods: { handleSave() { alert(\u0026#34;ä½ ç‚¹å‡»äº†ä¿å­˜æŒ‰é’®ï¼\u0026#34;) }, }, }; \u0026lt;/script\u0026gt; åŒå‘ç»‘å®š ä½œç”¨ï¼šè¡¨å•è¾“å…¥é¡¹å’Œdataæ–¹æ³•ä¸­çš„å±æ€§è¿›è¡Œç»‘å®šï¼Œä»»æ„ä¸€æ–¹æ”¹å˜éƒ½ä¼šåŒæ­¥ç»™å¦ä¸€æ–¹ ç”¨æ³•ï¼šv-model \u0026lt;input type=\u0026#34;text\u0026#34; v-model=\u0026#34;name\u0026#34;/\u0026gt; æ¡ä»¶æ¸²æŸ“ ä½œç”¨ï¼šæ ¹æ®è¡¨è¾¾å¼çš„å€¼æ¥åŠ¨æ€æ¸²æŸ“é¡µé¢å…ƒç´  ç”¨æ³•ï¼šv-ifã€v-elseã€v-else-if \u0026lt;div v-if=\u0026#34;sex == 1\u0026#34;\u0026gt;ç”·\u0026lt;/div\u0026gt; \u0026lt;div v-else-if=\u0026#34;sex == 2\u0026#34;\u0026gt;å¥³\u0026lt;/div\u0026gt; \u0026lt;div v-else\u0026gt;æœªçŸ¥\u0026lt;/div\u0026gt; Vueçš„åŸºæœ¬ä½¿ç”¨æ–¹å¼ - axios Axiosæ˜¯ä¸€ä¸ªåŸºäºpromiseçš„ç½‘ç»œè¯·æ±‚åº“ï¼Œä½œç”¨äºæµè§ˆå™¨å’Œnode.jsä¸­\nå®‰è£…å‘½ä»¤\nnpm install axios å¯¼å…¥å‘½ä»¤ï¼š\nimport axios from \u0026#39;axios\u0026#39; axiosçš„APIåˆ—è¡¨ è¯·æ±‚ å¤‡æ³¨ axios.get(url[, config]) â­ axios.delete(url[, config]) axios.head(url[, config]) axios.options(url[, config]) axios.post(url[, data[, config]]) â­ axios.put(url[, data[, config]]) axios.patch(url[, data[, config]]) urlï¼šè¯·æ±‚è·¯å¾„ dataï¼šè¯·æ±‚ä½“æ•°æ®ï¼Œæœ€å¸¸è§çš„æ˜¯JSONæ ¼å¼æ•°æ® configï¼šé…ç½®å¯¹è±¡ï¼Œå¯ä»¥è®¾ç½®æŸ¥è¯¢å‚æ•°ï¼Œè¯·æ±‚å¤´ä¿¡æ¯ \u0026lt;script\u0026gt; import axios from \u0026#34;axios\u0026#34;; export default { methods: { handleSendPOST() { // é€šè¿‡axioså‘é€HTTPè¯·æ±‚ axios .post(\u0026#34;/api/admin/employee/login\u0026#34;, { username: \u0026#34;admin\u0026#34;, password: \u0026#34;123456\u0026#34;, }) .then((res) =\u0026gt; { console.log(res.data); }) .catch((error) =\u0026gt; { console.log(error.response); }); }, handleSendGET() { // é€šè¿‡ axios å‘é€getè¯·æ±‚ axios .get(\u0026#34;/api/admin/shop/status\u0026#34;, { headers: { token: \u0026#34;eyJhbGciOiJIUzI1NiJ9.eyJlbXBJZCI6MSwiZXhwIjoxNzI5OTMzMjU4fQ.JV9g9K6u4UPzdSIMzcX5crMM3VXImspm6PbvolDpkSg\u0026#34;, }, }) .then((res) =\u0026gt; { console.log(res.data); }); }, }, }; \u0026lt;/script\u0026gt; Vueçš„åŸºæœ¬ä½¿ç”¨æ–¹å¼ - axios axios ç»Ÿä¸€ä½¿ç”¨æ–¹å¼ axios(config)\n\u0026lt;script\u0026gt; import axios from \u0026#34;axios\u0026#34;; export default { handleSend() { // é€šè¿‡ axios å‘é€getè¯·æ±‚ axios({ url: \u0026#34;/api/admin/employee/login\u0026#34;, method: \u0026#34;post\u0026#34;, data: { //dataè¡¨ç¤ºé€šè¿‡è¯·æ±‚ä½“ä¼ å‚ username: \u0026#34;admin\u0026#34;, password: \u0026#34;123456\u0026#34;, }, }).then((res) =\u0026gt; { console.log(res.data.data.token) axios({ url:\u0026#39;api/admin/shop/status\u0026#39;, method:\u0026#39;get\u0026#39;, headers:{ token: res.data.data.token } } ) }); }, }, }; \u0026lt;/script\u0026gt; Vue-Router vueå±äºå•é¡µé¢åº”ç”¨ï¼Œæ‰€è°“çš„è·¯ç”±ï¼Œå°±æ˜¯æ ¹æ®æµè§ˆå™¨è·¯å¾„çš„ä¸åŒï¼Œç”¨ä¸åŒçš„è§†å›¾ç»„ä»¶æ›¿æ¢è¿™ä¸ªé¡µé¢å†…å®¹\nåˆ›å»ºVueé¡¹ç›®æ—¶å‹¾é€‰routeré€‰é¡¹\nè€é¡¹ç›®ä¸­ä½¿ç”¨\nnpm install vue-router è·¯ç”±é…ç½® è·¯ç”±ç»„æˆ\nVueRouterï¼šè·¯ç”±å™¨ï¼Œæ ¹æ®è·¯ç”±è¯·æ±‚åœ¨è·¯ç”±è§†å›¾ä¸­åŠ¨æ€æ¸²æŸ“å¯¹åº”çš„è§†å›¾ç»„ä»¶ \u0026lt;router-link\u0026gt;ï¼šè·¯ç”±é“¾æ¥ç»„ä»¶ï¼Œæµè§ˆå™¨ä¼šè§£ææˆ\u0026lt;a\u0026gt; \u0026lt;router-view\u0026gt;ï¼šè·¯ç”±è§†å›¾ç»„ä»¶ï¼Œç”¨æ¥å±•ç¤ºä¸è·¯ç”±è·¯å¾„åŒ¹é…çš„è§†å›¾ç»„ä»¶ router/index.jsä¸­æŒ‡å®šè·¯ç”±è¡¨ App.vueä¸­æŒ‡å®šè·¯ç”±çš„ä½ç½® åµŒå¥—è·¯ç”± åµŒå¥—è·¯ç”±ï¼šç»„ä»¶å†…è¦åˆ‡æ¢å†…å®¹ï¼Œå°±éœ€è¦ç”¨åˆ°åµŒå¥—è·¯ç”±ï¼ˆå­è·¯ç”±ï¼‰ // ç»´æŠ¤è·¯ç”±è¡¨ï¼ŒæŸä¸ªè·¯ç”±è·¯å¾„å¯¹åº”å“ªä¸ªè§†å›¾ç»„ä»¶ const routes = [ { path: \u0026#39;/\u0026#39;, name: \u0026#39;home\u0026#39;, component: HomeView }, { path: \u0026#39;/about\u0026#39;, name: \u0026#39;about\u0026#39;, component: () =\u0026gt; import(\u0026#39;../views/AboutView.vue\u0026#39;) }, { path: \u0026#39;/404\u0026#39;, component: () =\u0026gt; import(\u0026#39;../views/404View.vue\u0026#39;) }, { path: \u0026#39;/c\u0026#39;, component: () =\u0026gt; import(\u0026#39;../views/container/ContainerView.vue\u0026#39;), redirect: \u0026#39;/c/p1\u0026#39;, // åµŒå¥—è·¯ç”±ï¼ˆå­è·¯ç”±ï¼‰ children:[ { path:\u0026#39;/c/p1\u0026#39;, component: () =\u0026gt; import(\u0026#39;../views/container/P1View.vue\u0026#39;), }, { path: \u0026#39;/c/p2\u0026#39;, component: () =\u0026gt; import(\u0026#39;../views/container/P2View.vue\u0026#39;), }, { path: \u0026#39;/c/p3\u0026#39;, component: () =\u0026gt; import(\u0026#39;../views/container/P3View.vue\u0026#39;), } ] }, { //é‡å®šå‘åˆ°404 path: \u0026#39;/*\u0026#39;, redirect: \u0026#39;/404\u0026#39; }, ] çŠ¶æ€ç®¡ç†vuex vuexæ˜¯ä¸€ä¸ªä¸“é—¨ä¸ºVue.jsåº”ç”¨ç¨‹åºå¼€å‘çš„çŠ¶æ€ç®¡ç†åº“ vuexå¯ä»¥åœ¨å¤šä¸ªç»„ä»¶ä¹‹é—´å…±äº«æ•°æ®ï¼Œå¹¶ä¸”å…±äº«çš„æ•°æ®æ˜¯å“åº”å¼çš„ï¼Œå³æ•°æ®çš„å˜æ›´èƒ½åŠæ—¶æ¸²æŸ“åˆ°æ¨¡æ¿ vuexé‡‡ç”¨é›†ä¸­å¼å­˜å‚¨ç®¡ç†æ‰€æœ‰ç»„ä»¶çš„çŠ¶æ€ vuexä»‹ç» stateï¼šçŠ¶æ€å¯¹è±¡ï¼Œé›†ä¸­å®šä¹‰å„ä¸ªç»„ä»¶å…±äº«çš„æ•°æ® mutationsï¼šç±»ä¼¼äºä¸€ä¸ªäº‹ä»¶ï¼Œç”¨äºä¿®æ”¹å…±äº«æ•°æ®ï¼Œè¦æ±‚å¿…é¡»æ˜¯åŒæ­¥å‡½æ•° actionsï¼šç±»ä¼¼äºmutationï¼Œå¯ä»¥åŒ…å«å¼‚æ­¥æ“ä½œï¼Œé€šè¿‡è°ƒç”¨mutationæ¥æ”¹å˜å…±äº«æ•°æ® å®šä¹‰å’Œå±•ç¤ºå…±äº«æ•°æ® // é›†ä¸­ç®¡ç†å¤šä¸ªç»„ä»¶å…±äº«çš„æ•°æ® export default new Vuex.Store({ // é›†ä¸­å®šä¹‰å…±äº«æ•°æ® state: { name: \u0026#39;æœªç™»å½•æ¸¸å®¢\u0026#39; }, getters: { }, mutations: { }, actions: { }, modules: { } }) ä½¿ç”¨å…±äº«æ•°æ®ï¼š\n\u0026lt;div id=\u0026#34;app\u0026#34;\u0026gt; æ¬¢è¿ä½ ï¼Œ{{$store.state.name}} \u0026lt;img alt=\u0026#34;Vue logo\u0026#34; src=\u0026#34;./assets/logo.png\u0026#34;\u0026gt; \u0026lt;HelloWorld msg=\u0026#34;Welcome to Your Vue.js App\u0026#34;/\u0026gt; \u0026lt;/div\u0026gt; åœ¨mutationsä¸­å®šä¹‰å‡½æ•°ï¼Œä¿®æ”¹å…±äº«æ•°æ® export default new Vuex.Store({ state: { }, getters: { }, // é€šè¿‡å½“å‰å±æ€§ä¸­å®šä¹‰çš„å‡½æ•°ä¿®æ”¹å…±äº«æ•°æ®ï¼Œå¿…é¡»éƒ½æ˜¯åŒæ­¥æ“ä½œ mutations: { setName(state, newName){ state.name = newName } }, actions: { }, modules: { } }) åœ¨vueä¸­è°ƒç”¨mutationsä¸­çš„å‡½æ•° \u0026lt;script\u0026gt; import HelloWorld from \u0026#39;./components/HelloWorld.vue\u0026#39; export default { name: \u0026#39;App\u0026#39;, components: { HelloWorld }, methods: { handleUpdate(){ // mutationsä¸­å®šä¹‰çš„å‡½æ•°ä¸èƒ½ç›´æ¥è°ƒç”¨ï¼Œå¿…é¡»é€šè¿‡è¿™ç§æ–¹å¼æ¥è°ƒç”¨ this.$store.commit(\u0026#34;setName\u0026#34;, \u0026#34;Kennem\u0026#34;) } }, } \u0026lt;/script\u0026gt; åœ¨actionsä¸­å®šä¹‰å‡½æ•°ï¼Œç”¨äºè°ƒç”¨mutation \u0026lt;script\u0026gt; import HelloWorld from \u0026#34;./components/HelloWorld.vue\u0026#34;; export default { name: \u0026#34;App\u0026#34;, components: { HelloWorld, }, methods: { handleUpdate() { // mutationsä¸­å®šä¹‰çš„å‡½æ•°ä¸èƒ½ç›´æ¥è°ƒç”¨ï¼Œå¿…é¡»é€šè¿‡è¿™ç§æ–¹å¼æ¥è°ƒç”¨ this.$store.commit(\u0026#34;setName\u0026#34;, \u0026#34;Kennem\u0026#34;); }, handleCallAction(){ //è°ƒç”¨actionsä¸­å®šä¹‰çš„å‡½æ•°ï¼ŒsetNameByAxiosä¸ºå‡½æ•°åç§° this.$store.dispatch(\u0026#39;setNameByAxios\u0026#39;) } }, }; \u0026lt;/script\u0026gt; // é›†ä¸­ç®¡ç†å¤šä¸ªç»„ä»¶å…±äº«çš„æ•°æ® export default new Vuex.Store({ // é›†ä¸­å®šä¹‰å…±äº«æ•°æ® state: { name: \u0026#39;æœªç™»å½•æ¸¸å®¢\u0026#39; }, getters: { }, // é€šè¿‡å½“å‰å±æ€§ä¸­å®šä¹‰çš„å‡½æ•°ä¿®æ”¹å…±äº«æ•°æ®ï¼Œå¿…é¡»éƒ½æ˜¯åŒæ­¥æ“ä½œ mutations: { setName(state, newName) { state.name = newName } }, actions: { setNameByAxios(context) { axios({ url: \u0026#39;/api/admin/employee/login\u0026#39;, method: \u0026#39;post\u0026#39;, data: { username: \u0026#39;admin\u0026#39;, password: \u0026#39;123456\u0026#39; } }).then(res=\u0026gt;{ if(res.data.code == 1){ // å¼‚æ­¥è¯·æ±‚åï¼Œéœ€è¦ä¿®æ”¹å…±äº«æ•°æ® // åœ¨actionsä¸­è°ƒç”¨mutationsä¸­å®šä¹‰çš„setNameå‡½æ•° context.commit(\u0026#39;setName\u0026#39;, res.data.data.name) } }) } }, modules: { } }) TypeScript function hello(msg:string){ console.log(msg) } hello(\u0026#34;123\u0026#34;) TS ä¸ºä»€ä¹ˆè¦å¢åŠ ç±»å‹æ”¯æŒï¼Ÿ TSå±äºé™æ€ç±»å‹ç¼–ç¨‹è¯­è¨€ï¼ŒJSå±äºåŠ¨æ€ç±»å‹ç¼–ç¨‹è¯­è¨€ é™æ€ç±»å‹åœ¨ç¼–è¯‘æœŸåšç±»å‹æ£€æŸ¥ï¼ŒåŠ¨æ€ç±»å‹åœ¨æ‰§è¡ŒæœŸåšç±»å‹æ£€æŸ¥ å¯¹äºJSæ¥è¯´ï¼Œéœ€è¦ç­‰åˆ°ä»£ç æ‰§è¡Œçš„æ—¶å€™æ‰èƒ½å‘ç°é”™è¯¯ï¼ˆæ™šï¼‰ å¯¹äºTSæ¥è¯´ï¼Œåœ¨ä»£ç ç¼–è¯‘çš„æ—¶å€™å°±å¯ä»¥å‘ç°é”™è¯¯ï¼ˆæ—©ï¼‰ é…åˆVSCodeå¼€å‘å·¥å…·ï¼ŒTSå¯ä»¥ä½“æ£€åˆ°åœ¨ç¼–å†™ä»£ç çš„åŒæ—¶å°±å‘ç°ä»£ç é”™è¯¯ï¼Œå‡å°‘Bugï¼Œæ”¹Bugçš„æ—¶é—´ã€‚ å¦‚ä½•ç†è§£TSï¼Ÿ æ˜¯JSçš„è¶…é›†ï¼Œå…¼å®¹JavaScript æ‰©å±•äº†JavaScriptçš„è¯­æ³•ï¼Œæ–‡ä»¶æ‰©å±•åä¸ºts å¯ä»¥ç¼–è¯‘æˆæ ‡å‡†çš„JavaScriptï¼Œå¹¶ä¸”å¯ä»¥åœ¨ç¼–è¯‘æ—¶è¿›è¡Œç±»å‹æ£€æŸ¥ å…¨å±€å®‰è£…npm install -g typescript ä½¿ç”¨tscå‘½ä»¤å°†tsæ–‡ä»¶ç¼–è¯‘æˆjsæ–‡ä»¶ ç±»å‹ ä¾‹ å¤‡æ³¨ å­—ç¬¦ä¸²ç±»å‹ string æ•°å­—ç±»å‹ number å¸ƒå°”ç±»å‹ boolean æ•°ç»„ç±»å‹ number[], string[], boolean[] ä¾æ­¤ç±»æ¨ ä»»æ„ç±»å‹ any ç›¸å½“äºåˆå›åˆ°äº†æ²¡æœ‰ç±»å‹çš„æ—¶ä»£ å¤æ‚ç±»å‹ type ä¸ interface å‡½æ•°ç±»å‹ () =\u0026gt; void å¯¹å‡½æ•°çš„å‚æ•°å’Œè¿”å›å€¼è¿›è¡Œè¯´æ˜ å­—é¢é‡ç±»å‹ \u0026ldquo;a\u0026rdquo; | \u0026ldquo;b\u0026rdquo; | \u0026ldquo;c\u0026rdquo; é™åˆ¶å˜é‡æˆ–å‚æ•°çš„å–å€¼ class ç±» class Animal TypeScriptå¸¸ç”¨ç±»å‹ ç±»å‹æ ‡æ³¨çš„ä½ç½® æ ‡æ³¨å˜é‡ æ ‡æ³¨å‚æ•° æ ‡æ³¨è¿”å›å€¼ // å­—ç¬¦ä¸²ç±»å‹ let username: string = \u0026#39;Kennem\u0026#39; // æ•°å­—ç±»å‹ let age: number = 20 // å¸ƒå°”ç±»å‹ let isTrue: boolean = true å­—é¢é‡ç±»å‹ ç±»ä¼¼Javaä¸­çš„æšä¸¾ï¼Œé™åˆ¶å˜é‡çš„å–å€¼ // å­—é¢é‡ç±»å‹ function printText(s, alignment) { console.log(s, alignment); } printText(\u0026#39;hello\u0026#39;, \u0026#39;center\u0026#39;); interfaceç±»å‹ interface Cat { name: string, age?: number // å½“å‰å±æ€§ä¸ºå¯é€‰ } const c1: Cat = {name: \u0026#39;Kennem\u0026#39;, age:1} const c2: Cat = {name: \u0026#39;Kennem\u0026#39;} classç±»-åŸºæœ¬ä½¿ç”¨ ä½¿ç”¨classå…³é”®å­—æ¥å®šä¹‰ç±»ï¼Œç±»ä¸­å¯ä»¥åŒ…å«å±æ€§ã€æ„é€ æ–¹æ³•ã€æ™®é€šæ–¹æ³•\n//å®šä¹‰ä¸€ä¸ªç±» class User{ name: string constructor(name: string){ this.name = name } study(){ console.log(this.name + \u0026#39; is studying\u0026#39;); } } const user = new User(\u0026#39;Kennem\u0026#39;) console.log(user.name); user.study(); classç±»-å®ç°æ¥å£ interface Animal { name: string eat(): void } class Bird implements Animal { name: string constructor(name: string) { this.name = name } eat() { console.log(this.name + \u0026#39; is eating\u0026#39;); } } // åˆ›å»ºç±»å‹ä¸ºbirdçš„å¯¹è±¡ const b1: Bird = new Bird(\u0026#39;ç‡•å­\u0026#39;) console.log(b1.name); b1.eat() classç±»-ç±»çš„ç»§æ‰¿ class Parrot extends Bird { fly() { console.log(this.name + \u0026#39; is flying\u0026#39;); } } const myParrot: Parrot = new Parrot(\u0026#39;é¹¦é¹‰ä¸€å·\u0026#39;) myParrot.fly() myParrot.eat() ","permalink":"https://kennems.github.io/posts/tech/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91day1/","summary":"è‹ç©¹å¤–å–å‰ç«¯å¼€å‘(Day1) node.jså®‰è£… é…ç½®å…¨å±€ä¸‹è½½åŒ…åœ°å€å’Œç¼“å­˜åœ°å€ npm config set prefix \u0026#34;E:x\\nodejs\\node_global\u0026#34; npm config set cache \u0026#34;E:\\x\\nodejs\\node_cache\u0026#34; æœ€æ–°çš„é…ç½®æ·˜å®é•œåƒçš„æ·˜å®å®˜æ–¹æä¾›çš„æ–¹æ³• npm config set registry","title":"è‹ç©¹å¤–å–å‰ç«¯å¼€å‘(Day1)"},{"content":"è‹ç©¹å¤–å–åç«¯å¼€å‘(Day12) å·¥ä½œå° åè¯è§£é‡Šï¼š\nè¥ä¸šé¢ï¼šå·²å®Œæˆè®¢å•çš„æ€»é‡‘é¢ æœ‰æ•ˆè®¢å•ï¼šå·²å®Œæˆè®¢å•çš„æ•°é‡ è®¢å•å®Œæˆç‡ï¼šæœ‰æ•ˆè®¢å•æ•° / æ€»è®¢å•æ•° * 100% å¹³å‡å®¢å•ä»·ï¼šè¥ä¸šé¢ / æœ‰æ•ˆè®¢å•æ•° æ–°å¢ç”¨æˆ·ï¼šæ–°å¢ç”¨æˆ·çš„æ•°é‡ Apache POI Apache POI æ˜¯ä¸€ä¸ªå¤„ç†Microsoft Office å„ç§æ–‡ä»¶æ ¼å¼çš„å¼€æºé¡¹ç›®ã€‚\n@SpringBootTest public class POITest { public static final String filePath = \u0026#34;D:\\\\test\\\\test.xlsx\u0026#34;; /** * é€šè¿‡POIå‘æ–‡ä»¶å†…å†™å…¥å†…å®¹ */ public static void write() throws Exception { XSSFWorkbook excel = new XSSFWorkbook(); XSSFSheet sheet = excel.createSheet(\u0026#34;info\u0026#34;); // rowNumber ä» 0 å¼€å§‹ XSSFRow row = sheet.createRow(1); XSSFCell cell = row.createCell(0); row.createCell(1).setCellValue(\u0026#34;å§“å\u0026#34;); row.createCell(2).setCellValue(\u0026#34;åŸå¸‚\u0026#34;); row = sheet.createRow(2); row.createCell(1).setCellValue(\u0026#34;å¼ ä¸‰\u0026#34;); row.createCell(2).setCellValue(\u0026#34;åŒ—äº¬\u0026#34;); row = sheet.createRow(3); row.createCell(1).setCellValue(\u0026#34;æå››\u0026#34;); row.createCell(2).setCellValue(\u0026#34;å—äº¬\u0026#34;); // é€šè¿‡è¾“å‡ºæµå°†å†…å­˜ä¸­çš„excelæ–‡ä»¶å†™å…¥åˆ°ç¡¬ç›˜ä¸­ FileOutputStream outputStream = new FileOutputStream(new File(filePath)); excel.write(outputStream); outputStream.close(); excel.close(); System.out.println(\u0026#34;å†™å…¥æˆåŠŸï¼\u0026#34;); } public static void read() throws Exception{ // è¯»å–å·²æœ‰çš„excelæ–‡ä»¶ FileInputStream inputStream = new FileInputStream(new File(filePath)); XSSFWorkbook excel = new XSSFWorkbook(inputStream); // è¯»å–excelæ–‡ä»¶ä¸­çš„ç¬¬ä¸€ä¸ªsheeté¡µ XSSFSheet sheet = excel.getSheetAt(0); // è·å–sheetä¸­æœ€åä¸€è¡Œè¡Œå· int lastRowNum = sheet.getLastRowNum(); for (int i = 1; i \u0026lt;= lastRowNum; i++) { XSSFRow row = sheet.getRow(i); // è·å–å•å…ƒæ ¼å¯¹è±¡ String stringCellValue1 = row.getCell(1).getStringCellValue(); String stringCellValue2 = row.getCell(2).getStringCellValue(); System.out.println(stringCellValue1 + \u0026#34; \u0026#34; + stringCellValue2); } inputStream.close(); excel.close(); } public static void main(String[] args) throws Exception { write(); read(); } } å¯¼å‡ºè¿è¥æ•°æ®ExcelæŠ¥è¡¨ å®ç°ä¸€ä¸ªæ— è¿”å›å€¼çš„æ¥å£\n/** * å¯¼å‡ºè¿è¥æ•°æ®æŠ¥è¡¨ * @param response */ @GetMapping(\u0026#34;/export\u0026#34;) @ApiOperation(\u0026#34;å¯¼å‡ºè¿è¥æ•°æ®æŠ¥è¡¨\u0026#34;) public void export(HttpServletResponse response) throws IOException { reportService.exportBusinessData(response); } å‡†å¤‡å¥½åˆ›å»ºå¥½æ ¼å¼çš„Excelæ–‡ä»¶ï¼š\nServiceå®ç°å±‚å®Œæˆç›¸å…³æ“ä½œ /** * å¯¼å‡ºè¿è¥æŠ¥è¡¨ * * @param response */ public void exportBusinessData(HttpServletResponse response) { // æŸ¥è¯¢æ•°æ®åº“ï¼Œè·å–è¥ä¸šæ•°æ®--æŸ¥è¯¢æœ€è¿‘30å¤©çš„è¿è¥æ•°æ® LocalDate dateBegin = LocalDate.now().minusDays(30); LocalDate dateEnd = LocalDate.now().minusDays(1); // æŸ¥è¯¢æ¦‚è§ˆæ•°æ® BusinessDataVO businessDataVO = workspaceService.getBusinessData(LocalDateTime.of(dateBegin, LocalTime.MIN), LocalDateTime.of(dateEnd, LocalTime.MAX)); // é€šè¿‡POIå°†æ•°æ®å†™å…¥åˆ°Excelæ–‡ä»¶ä¸­ InputStream inputStream = this.getClass().getClassLoader().getResourceAsStream(\u0026#34;template/è¿è¥æ•°æ®æŠ¥è¡¨æ¨¡æ¿.xlsx\u0026#34;); try { XSSFWorkbook excel = new XSSFWorkbook(inputStream); XSSFSheet sheet = excel.getSheet(\u0026#34;Sheet1\u0026#34;); // å¡«å……æ•°æ®-æ—¶é—´ sheet.getRow(1).getCell(1).setCellValue(\u0026#34;æ—¶é—´ï¼š\u0026#34; + dateBegin + \u0026#34;è‡³\u0026#34; + dateEnd); XSSFRow row = sheet.getRow(3); row.getCell(2).setCellValue(businessDataVO.getTurnover()); row.getCell(4).setCellValue(businessDataVO.getOrderCompletionRate()); row.getCell(6).setCellValue(businessDataVO.getNewUsers()); row = sheet.getRow(4); row.getCell(2).setCellValue(businessDataVO.getValidOrderCount()); row.getCell(4).setCellValue(businessDataVO.getUnitPrice()); for (int i = 0; i \u0026lt; 30; i++) { LocalDate date = dateBegin.plusDays(i); // æŸ¥è¯¢æŸä¸€å¤©çš„è¥ä¸šæ•°æ® BusinessDataVO businessData = workspaceService.getBusinessData(LocalDateTime.of(date, LocalTime.MIN), LocalDateTime.of(date, LocalTime.MAX)); // è·å¾—æŸä¸€è¡Œ row = sheet.getRow(7 + i); row.getCell(1).setCellValue(date.toString()); row.getCell(2).setCellValue(businessData.getTurnover()); row.getCell(3).setCellValue(businessData.getValidOrderCount()); row.getCell(4).setCellValue(businessData.getOrderCompletionRate()); row.getCell(5).setCellValue(businessData.getUnitPrice()); row.getCell(6).setCellValue(businessData.getNewUsers()); } ServletOutputStream outputStream = response.getOutputStream(); // é€šè¿‡è¾“å‡ºæµå°†Excelæ–‡ä»¶ä¸‹è½½åˆ°å®¢æˆ·ç«¯æµè§ˆå™¨ excel.write(outputStream); //å…³é—­èµ„æº outputStream.close(); excel.close(); } catch (Exception e) { e.printStackTrace(); } } ","permalink":"https://kennems.github.io/posts/tech/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91day12/","summary":"è‹ç©¹å¤–å–åç«¯å¼€å‘(Day12) å·¥ä½œå° åè¯è§£é‡Šï¼š è¥ä¸šé¢ï¼šå·²å®Œæˆè®¢å•çš„æ€»é‡‘é¢ æœ‰æ•ˆè®¢å•ï¼šå·²å®Œæˆè®¢å•çš„æ•°é‡ è®¢å•å®Œæˆç‡ï¼šæœ‰æ•ˆè®¢å•æ•° / æ€»è®¢å•æ•° * 100% å¹³å‡å®¢","title":"è‹ç©¹å¤–å–åç«¯å¼€å‘(Day12)"},{"content":"è‹ç©¹å¤–å–åç«¯å¼€å‘(Day11) Apache ECharts https://echarts.apache.org/zh/index.html\nè¥ä¸šé¢ç»Ÿè®¡ é”€é‡æ’åTop10 æ ¹æ®è¿”å›ç»“æœè®¾è®¡VOå¯¹è±¡\nSalesTop10ReportVO\n\u0026lt;select id=\u0026#34;getSalesTop10\u0026#34; resultType=\u0026#34;com.sky.dto.GoodsSalesDTO\u0026#34;\u0026gt; SELECT name, sum(od.number) number from order_detail od, orders o where od.order_id = o.id and o.status = 5 \u0026lt;if test=\u0026#34;begin != null\u0026#34;\u0026gt; and o.order_time \u0026amp;gt; #{begin} \u0026lt;/if\u0026gt; \u0026lt;if test=\u0026#34;end != null\u0026#34;\u0026gt; and o.order_time \u0026amp;lt; #{end} \u0026lt;/if\u0026gt; GROUP BY od.name ORDER BY number DESC LIMIT 10; \u0026lt;/select\u0026gt; ","permalink":"https://kennems.github.io/posts/tech/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91day11/","summary":"è‹ç©¹å¤–å–åç«¯å¼€å‘(Day11) Apache ECharts https://echarts.apache.org/zh/index.html è¥ä¸šé¢ç»Ÿè®¡ é”€é‡æ’åTop10 æ ¹æ®è¿”å›ç»“æœè®¾è®¡VOå¯¹è±¡ SalesTop10ReportVO \u0026lt;select id=\u0026#34;getSalesTop10\u0026#34; resultType=\u0026#34;com.sky.dto.GoodsSalesDTO\u0026#34;\u0026gt; SELECT name, sum(od.number) number from order_detail od, orders o where od.order_id = o.id and o.status = 5 \u0026lt;if test=\u0026#34;begin != null\u0026#34;\u0026gt; and","title":"è‹ç©¹å¤–å–åç«¯å¼€å‘(Day11)"},{"content":"è‹ç©¹å¤–å–åç«¯å¼€å‘(Day10) Spring Task Spring Task æ˜¯ Spring æ¡†æ¶æä¾›çš„ä»»åŠ¡è°ƒåº¦å·¥å…·ï¼Œå¯ä»¥æŒ‰ç…§çº¦å®šçš„æ—¶é—´è‡ªåŠ¨æ‰§è¡ŒæŸä¸ªä»£ç é€»è¾‘ã€‚\ncron è¡¨è¾¾å¼ cron è¡¨è¾¾å¼å…¶å®å°±æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œé€šè¿‡cronè¡¨è¾¾å¼å¯ä»¥å®šä¹‰ä»»åŠ¡è§¦å‘çš„æ—¶é—´\næ„æˆè§„åˆ™ï¼šåˆ†ä¸º6ä¸ªæˆ–7ä¸ªåŸŸï¼Œç”±ç©ºæ ¼åˆ†éš”å¼€ï¼Œæ¯ä¸ªåŸŸä»£è¡¨ä¸€ä¸ªå«ä¹‰\næ¯ä¸ªåŸŸçš„å«ä¹‰åˆ†åˆ«ä¸ºï¼šç§’ã€åˆ†é’Ÿã€å°æ—¶ã€æ—¥ã€æœˆã€å‘¨ã€å¹´ï¼ˆå¯é€‰ï¼‰\nSpring Task ä½¿ç”¨æ­¥éª¤ï¼š\nå¯¼å…¥mavenåæ ‡ spring-context å¯åŠ¨ç±»æ·»åŠ æ³¨è§£ @EnableScheduling å¼€å¯ä»»åŠ¡è°ƒåº¦ è‡ªå®šä¹‰å®šæ—¶ä»»åŠ¡ç±» è®¢å•çŠ¶æ€å®šæ—¶å¤„ç† éœ€æ±‚åˆ†æ ç”¨æˆ·ä¸‹å•åå¯èƒ½å­˜åœ¨çš„æƒ…å†µ\nä¸‹å•åæœªæ”¯ä»˜ï¼Œè®¢å•ä¸€ç›´å¤„äºâ€œå¾…æ”¯ä»˜â€çŠ¶æ€ ç”¨æˆ·æ”¶è´§åç®¡ç†ç«¯æœªç‚¹å‡»å®ŒæˆæŒ‰é’®ï¼Œè®¢å•ä¸€ç›´å¤„äºâ€œæ´¾é€ä¸­â€çŠ¶æ€ å¯¹äºä¸Šé¢ä¸¤ç§æƒ…å†µéœ€è¦é€šè¿‡å®šæ—¶ä»»åŠ¡æ¥ä¿®æ”¹è®¢å•çŠ¶æ€ï¼Œå…·ä½“é€»è¾‘ä¸ºï¼š\né€šè¿‡å®šæ—¶ä»»åŠ¡æ¯åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡æ˜¯å¦å­˜åœ¨æ”¯ä»˜è¶…æ—¶è®¢å•ï¼ˆä¸‹å•åè¶…è¿‡15åˆ†é’Ÿä»æœªæ”¯ä»˜åˆ™åˆ¤å®šæœªæ”¯ä»˜è¶…æ—¶è®¢å•ï¼‰ï¼Œå¦‚æœå­˜åœ¨åˆ™ä¿®æ”¹è®¢å•çŠ¶æ€ä¸ºâ€œå·²å–æ¶ˆâ€ã€‚ é€šè¿‡å®šæ—¶ä»»åŠ¡æ¯å¤©å‡Œæ™¨1ç‚¹æ£€æŸ¥ä¸€æ¬¡æ˜¯å¦å­˜åœ¨â€œæ´¾é€ä¸­â€çš„è®¢å•ï¼Œå¦‚æœå­˜åœ¨åˆ™ä¿®æ”¹è®¢å•çŠ¶æ€ä¸ºâ€œå·²å®Œæˆâ€ã€‚ WebSocket WebSocketæ˜¯åŸºäºTCPçš„ä¸€ç§æ–°çš„ç½‘ç»œåè®®ã€‚å®ƒå®ç°äº†æµè§ˆå™¨ä¸æœåŠ¡å™¨å…¨åŒå·¥é€šä¿¡â€”â€”æµè§ˆå™¨å’ŒæœåŠ¡å™¨åªéœ€è¦å®Œæˆä¸€æ¬¡æ¡æ‰‹ï¼Œä¸¤è€…ä¹‹é—´å°±å¯ä»¥åˆ›å»ºæŒä¹…æ€§çš„è¿æ¥ï¼Œå¹¶è¿›è¡ŒåŒå‘æ•°æ®ä¼ è¾“ã€‚\nHTTPåè®®å’ŒWebSocketåè®®å¯¹æ¯”ï¼š\nHTTPæ˜¯çŸ­è¿æ¥ WebSocketæ˜¯é•¿è¿æ¥ HTTPé€šä¿¡æ˜¯å•å‘çš„ï¼ŒåŸºäºè¯·æ±‚å“åº”æ¨¡å¼ WebSocketæ”¯æŒåŒå‘é€šä¿¡ HTTPå’ŒWebSocketåº•å±‚éƒ½æ˜¯TCPè¿æ¥ è®¾è®¡ï¼š\né€šè¿‡WebSocketå®ç°ç®¡ç†ç«¯é¡µé¢å’ŒæœåŠ¡ç«¯ä¿æŒé•¿è¿æ¥çŠ¶æ€ å½“å®¢æˆ·æ”¯ä»˜åï¼Œè°ƒç”¨WebSocketçš„ç›¸å…³APIå®ç°æœåŠ¡ç«¯å‘å®¢æˆ·ç«¯æ¨é€æ¶ˆæ¯ å®¢æˆ·ç«¯æµè§ˆå™¨è§£ææœåŠ¡ç«¯æ¨é€çš„æ¶ˆæ¯ï¼Œåˆ¤æ–­æ˜¯æ¥å•æé†’è¿˜æ˜¯å®¢æˆ·å‚¬å•ï¼Œè¿›è¡Œç›¸åº”çš„æ¶ˆæ¯æç¤ºå’Œè¯­è¨€æ’­æŠ¥ çº¦å®šæœåŠ¡ç«¯å‘é€ç»™å®¢æˆ·ç«¯æµè§ˆå™¨çš„æ ¼å¼ä¸ºJSONï¼Œå­—æ®µåŒ…æ‹¬ï¼štype, orderId, content typeä¸ºæ¶ˆæ¯ç±»å‹ï¼Œ1ä¸ºæ¥ç”µæé†’ 2ä¸ºå®¢æˆ·å‚¬å• orderIdä¸ºè®¢å•id contentä¸ºæ¶ˆæ¯å†…å®¹ ç”¨æˆ·ä¸‹å•æé†’ ç”¨æˆ·å‚¬å•æé†’ ","permalink":"https://kennems.github.io/posts/tech/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91day10/","summary":"è‹ç©¹å¤–å–åç«¯å¼€å‘(Day10) Spring Task Spring Task æ˜¯ Spring æ¡†æ¶æä¾›çš„ä»»åŠ¡è°ƒåº¦å·¥å…·ï¼Œå¯ä»¥æŒ‰ç…§çº¦å®šçš„æ—¶é—´è‡ªåŠ¨æ‰§è¡ŒæŸä¸ªä»£ç é€»è¾‘ã€‚ cron è¡¨è¾¾å¼ cron è¡¨è¾¾å¼å…¶å®å°±æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²","title":"è‹ç©¹å¤–å–åç«¯å¼€å‘(Day10)"},{"content":"è‹ç©¹å¤–å–åç«¯å¼€å‘(Day7) ç¼“å­˜èœå“ ç”¨æˆ·ç«¯å°ç¨‹åºå±•ç¤ºçš„èœå“æ•°æ®éƒ½æ˜¯é€šè¿‡æŸ¥è¯¢æ•°æ®åº“è·å¾—ï¼Œå¦‚æœç”¨æˆ·ç«¯è®¿é—®é‡æ¯”è¾ƒå¤§ï¼Œæ•°æ®åº“è®¿é—®çš„å‹åŠ›éšä¹‹å¢å¤§ã€‚\nå®ç°æ€è·¯ é€šè¿‡Redisæ¥ç¼“å­˜èœå“æ•°æ®ï¼Œå‡å°‘æ•°æ®åº“æŸ¥è¯¢æ“ä½œã€‚\nç¼“å­˜é€»è¾‘åˆ†æï¼š\næ¯ä¸ªåˆ†ç±»ä¸‹çš„èœå“ä¿å­˜ä¸€ä»½ç¼“å­˜æ•°æ® æ•°æ®åº“ä¸­èœå“æ•°æ®æœ‰å˜æ›´æ—¶æ¸…ç†ç¼“å­˜æ•°æ® /** * æ ¹æ®åˆ†ç±»idæŸ¥è¯¢èœå“ * * @param categoryId * @return */ @GetMapping(\u0026#34;/list\u0026#34;) @ApiOperation(\u0026#34;æ ¹æ®åˆ†ç±»idæŸ¥è¯¢èœå“\u0026#34;) public Result\u0026lt;List\u0026lt;DishVO\u0026gt;\u0026gt; list(Long categoryId) { // æ„é€ redisä¸­çš„ key, è§„åˆ™ï¼šdish_åˆ†ç±»id String key = \u0026#34;dish_\u0026#34; + categoryId; // æŸ¥è¯¢redisä¸­æ˜¯å¦å­˜åœ¨èœå“æ•°æ® List\u0026lt;DishVO\u0026gt; list = (List\u0026lt;DishVO\u0026gt;) redisTemplate.opsForValue().get(key); if (list != null \u0026amp;\u0026amp; list.size()\u0026gt; 0) { // å¦‚æœå­˜åœ¨ï¼Œç›´æ¥è¿”å›ï¼Œæ— é¡»æŸ¥è¯¢æ•°æ®åº“ return Result.success(list); } Dish dish = new Dish(); dish.setCategoryId(categoryId); dish.setStatus(StatusConstant.ENABLE);//æŸ¥è¯¢èµ·å”®ä¸­çš„èœå“ // å¦‚æœä¸å­˜åœ¨ï¼ŒæŸ¥è¯¢æ•°æ®åº“ï¼Œå°†æŸ¥è¯¢åˆ°çš„æ•°æ®æ”¾å…¥redisä¸­ list = dishService.listWithFlavor(dish); redisTemplate.opsForValue().set(key, list); return Result.success(list); } Spring Cache Spring Cache æ˜¯ä¸€ä¸ªæ¡†æ¶ï¼Œå®ç°äº†åŸºäºæ³¨è§£çš„ç¼“å­˜åŠŸèƒ½ï¼Œåªéœ€è¦ç®€å•åœ°åŠ ä¸€ä¸ªæ³¨è§£ï¼Œå°±èƒ½å®ç°ç¼“å­˜åŠŸèƒ½\nSpring Cache æä¾›äº†ä¸€å±‚æŠ½è±¡ï¼Œåº•å±‚å¯ä»¥åˆ‡æ¢ä¸åŒçš„ç¼“å­˜å®ç°ï¼Œä¾‹å¦‚ï¼š\nEHCache \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.boot\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-boot-starter-cache\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;2.7.3\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; Caffeine Redis å¸¸ç”¨æ³¨è§£ æ³¨è§£ è¯´æ˜ @EnableCaching å¼€å¯ç¼“å­˜æ³¨è§£åŠŸèƒ½ï¼Œé€šå¸¸åŠ åœ¨å¯åŠ¨ç±»ä¸Š @Cacheable åœ¨æ–¹æ³•æ‰§è¡Œå‰å…ˆæŸ¥è¯¢ç¼“å­˜ä¸­æ˜¯å¦æœ‰æ•°æ®ï¼Œå¦‚æœæœ‰æ•°æ®ï¼Œåˆ™ç›´æ¥è¿”å›ç¼“å­˜æ•°æ®ï¼›å¦‚æœæ²¡æœ‰ç¼“å­˜æ•°æ®ï¼Œè°ƒç”¨æ–¹æ³•å¹¶å°†æ–¹æ³•è¿”å›å€¼æ”¾åˆ°ç¼“å­˜ä¸­ã€‚ @CachePut å°†æ–¹æ³•çš„è¿”å›å€¼æ”¾åˆ°ç¼“å­˜ä¸­ @CacheEvict å°†ä¸€æ¡æˆ–å¤šæ¡æ•°æ®ä»ç¼“å­˜ä¸­åˆ é™¤ ç¼“å­˜å¥—é¤ æ·»åŠ è´­ç‰©è½¦ /** * æ·»åŠ è´­ç‰©è½¦ * @param shoppingCartDTO * @return */ @PostMapping(\u0026#34;/add\u0026#34;) @ApiOperation(\u0026#34;æ·»åŠ è´­ç‰©è½¦\u0026#34;) public Result add(@RequestBody ShoppingCartDTO shoppingCartDTO){ log.info(\u0026#34;æ·»åŠ è´­ç‰©è½¦ï¼Œå•†å“ä¿¡æ¯ä¸ºï¼š{}\u0026#34;,shoppingCartDTO); shoppingCartService.addShoppingCart(shoppingCartDTO); return Result.success(); } æŸ¥çœ‹è´­ç‰©è½¦ @GetMapping(\u0026#34;/list\u0026#34;) @ApiOperation(\u0026#34;æŸ¥çœ‹è´­ç‰©è½¦\u0026#34;) public Result\u0026lt;List\u0026lt;ShoppingCart\u0026gt;\u0026gt; list(){ List\u0026lt;ShoppingCart\u0026gt; list = shoppingCartService.showShoppingCart(); return Result.success(list); } æ¸…ç©ºè´­ç‰©è½¦ å¯¼å…¥åœ°å€ç°¿åŠŸèƒ½ ç”¨æˆ·ä¸‹å• éœ€æ±‚åˆ†æå’Œè®¾è®¡\nç”¨æˆ·ä¸‹å•ä¸šåŠ¡è¯´æ˜ï¼š\nå†ç”µå•†ç³»ç»Ÿä¸­ï¼Œç”¨æˆ·æ˜¯é€šè¿‡ä¸‹å•çš„æ–¹å¼é€šçŸ¥å•†å®¶ï¼Œç”¨æˆ·å·²ç»è´­ä¹°äº†å•†å“ï¼Œéœ€è¦å•†å®¶è¿›è¡Œå¤‡è´§å’Œå‘è´§ã€‚\næ•°æ®åº“è®¾è®¡ è®¢å•è¡¨ orders è®¢å•æ˜ç»†è¡¨ order_detail è®¢å•æ”¯ä»˜ å†…ç½‘ç©¿é€ Cpolar cpolar.exe http 80 å°†å¯¹åº”çš„ç«¯å£å·è¿›è¡Œå†…ç½‘ç©¿é€\n","permalink":"https://kennems.github.io/posts/tech/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91day7/","summary":"è‹ç©¹å¤–å–åç«¯å¼€å‘(Day7) ç¼“å­˜èœå“ ç”¨æˆ·ç«¯å°ç¨‹åºå±•ç¤ºçš„èœå“æ•°æ®éƒ½æ˜¯é€šè¿‡æŸ¥è¯¢æ•°æ®åº“è·å¾—ï¼Œå¦‚æœç”¨æˆ·ç«¯è®¿é—®é‡æ¯”è¾ƒå¤§ï¼Œæ•°æ®åº“è®¿é—®çš„å‹åŠ›éšä¹‹å¢å¤§ã€‚ å®ç°","title":"è‹ç©¹å¤–å–åç«¯å¼€å‘(Day7)"},{"content":"è‹ç©¹å¤–å–åç«¯å¼€å‘(Day6) HttpClient HttpClientæ˜¯ Apache Jakarta Common ä¸‹çš„å­é¡¹ç›®ï¼Œå¯ä»¥ç”¨æ¥æä¾›é«˜æ•ˆçš„ã€æœ€æ–°çš„ã€åŠŸèƒ½ä¸°å¯Œçš„æ”¯æŒHTTPåè®®çš„å®¢æˆ·ç«¯ç¼–ç¨‹å·¥å…·åŒ…ï¼Œå¹¶ä¸”å®ƒæ”¯æŒHTTPåè®®æœ€æ–°çš„ç‰ˆæœ¬å’Œå»ºè®®ã€‚\n\u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.apache.httpcomponents\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;httpclient\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;4.5.13\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; æ ¸å¿ƒAPIï¼š\nHttpClient HttpClients CloseableHttpClient HttpGet HttpPost å‘é€è¯·æ±‚æ­¥éª¤ï¼š\nåˆ›å»ºHttpClientå¯¹è±¡ åˆ›å»ºHttpè¯·æ±‚å¯¹è±¡ è°ƒç”¨HttpClientçš„executeæ–¹æ³•å‘é€è¯·æ±‚ /** * æµ‹è¯•é€šè¿‡httpclientå‘é€GETæ–¹å¼çš„è¯·æ±‚ */ @Test public void testGet() throws Exception { //åˆ›å»ºHTTPå¯¹è±¡ CloseableHttpClient httpClient = HttpClients.createDefault(); // åˆ›å»ºè¯·æ±‚å¯¹è±¡ HttpGet httpGet = new HttpGet(\u0026#34;http://localhost:8080/user/shop/status\u0026#34;); //å‘é€è¯·æ±‚ï¼Œæ¥æ”¶å“åº”ç»“æœ CloseableHttpResponse response = httpClient.execute(httpGet); // è·å–æœåŠ¡ç«¯è¿”å›çš„çŠ¶æ€ç  int statusCode = response.getStatusLine().getStatusCode(); System.out.println(\u0026#34;æœåŠ¡ç«¯è¿”å›çš„çŠ¶æ€ç æ˜¯:\u0026#34; + statusCode); HttpEntity entity = response.getEntity(); String body = EntityUtils.toString(entity); System.out.println(\u0026#34;æœåŠ¡ç«¯è¿”å›çš„æ•°æ®ä¸º:\u0026#34; + body); //å…³é—­èµ„æº response.close(); httpClient.close(); } /** * æµ‹è¯•é€šè¿‡httpclientå‘é€POSTæ–¹å¼çš„è¯·æ±‚ */ @Test public void testPOST() throws Exception { // åˆ›å»ºhttpclientå¯¹è±¡ CloseableHttpClient httpClient = HttpClients.createDefault(); // åˆ›å»ºè¯·æ±‚å¯¹è±¡ HttpPost httpPost = new HttpPost(\u0026#34;http://localhost:8080/admin/employee/login\u0026#34;); JSONObject jsonObject = new JSONObject(); jsonObject.put(\u0026#34;username\u0026#34;, \u0026#34;admin\u0026#34;); jsonObject.put(\u0026#34;password\u0026#34;, \u0026#34;123456\u0026#34;); StringEntity entity = new StringEntity(jsonObject.toString()); // æŒ‡å®šè¯·æ±‚ç¼–ç æ–¹å¼ entity.setContentEncoding(\u0026#34;UTF-8\u0026#34;); // æ•°æ®æ ¼å¼ entity.setContentType(\u0026#34;application/json\u0026#34;); httpPost.setEntity(entity); // å‘é€è¯·æ±‚ CloseableHttpResponse response = httpClient.execute(httpPost); //è§£æè¿”å›ç»“æœ int statusCode = response.getStatusLine().getStatusCode(); System.out.println(\u0026#34;å“åº”ç ä¸ºï¼š:\u0026#34; + statusCode); HttpEntity entity1 = response.getEntity(); String body = EntityUtils.toString(entity1); System.out.println(\u0026#34;å“åº”æ•°æ®ä¸ºï¼š\u0026#34; + body); //å…³é—­èµ„æº response.close(); httpClient.close(); } å¾®ä¿¡å°ç¨‹åº å°ç¨‹åºåŒ…å«ä¸€ä¸ªæè¿°æ•´ä½“ç¨‹åºçš„appå’Œå¤šä¸ªæè¿°å„è‡ªé¡µé¢çš„pageã€‚ä¸€ä¸ªå°ç¨‹åºä¸»ä½“éƒ¨åˆ†ç”±ä¸‰ä¸ªæ–‡ä»¶ç»„æˆï¼Œå¿…é¡»æ”¾åœ¨é¡¹ç›®çš„æ ¹ç›®å½•ï¼Œå¦‚ä¸‹ï¼š\næ–‡ä»¶ å¿…éœ€ ä½œç”¨ app.js æ˜¯ å°ç¨‹åºé€»è¾‘ app.json æ˜¯ å°ç¨‹åºå…¬å…±é…ç½® app.wxss å¦ å°ç¨‹åºå…¬å…±æ ·å¼è¡¨ éœ€æ±‚åˆ†æå’Œè®¾è®¡ ä¸šåŠ¡è§„åˆ™ï¼š\nåŸºäºå¾®ä¿¡ç™»å½•å®ç°å°ç¨‹åºçš„ç™»å½•åŠŸèƒ½ å¦‚æœæ˜¯æ–°ç”¨æˆ·éœ€è¦è‡ªåŠ¨å®Œæˆæ³¨å†Œ æ·»åŠ UserController æ·»åŠ æ‹¦æˆªå™¨ /** * jwtä»¤ç‰Œæ ¡éªŒçš„æ‹¦æˆªå™¨ */ @Component @Slf4j public class JwtTokenUserInterceptor implements HandlerInterceptor { @Autowired private JwtProperties jwtProperties; /** * æ ¡éªŒjwt * * @param request * @param response * @param handler * @return * @throws Exception */ public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception { System.out.println(\u0026#34;å½“å‰çº¿ç¨‹çš„id:\u0026#34; + Thread.currentThread().getId()); //åˆ¤æ–­å½“å‰æ‹¦æˆªåˆ°çš„æ˜¯Controllerçš„æ–¹æ³•è¿˜æ˜¯å…¶ä»–èµ„æº if (!(handler instanceof HandlerMethod)) { //å½“å‰æ‹¦æˆªåˆ°çš„ä¸æ˜¯åŠ¨æ€æ–¹æ³•ï¼Œç›´æ¥æ”¾è¡Œ return true; } //1ã€ä»è¯·æ±‚å¤´ä¸­è·å–ä»¤ç‰Œ String token = request.getHeader(jwtProperties.getUserTokenName()); //2ã€æ ¡éªŒä»¤ç‰Œ try { log.info(\u0026#34;jwtæ ¡éªŒ:{}\u0026#34;, token); Claims claims = JwtUtil.parseJWT(jwtProperties.getUserSecretKey(), token); Long userId = Long.valueOf(claims.get(JwtClaimsConstant.USER_ID).toString()); log.info(\u0026#34;å½“å‰ç”¨æˆ·idï¼š{}\u0026#34;, userId); BaseContext.setCurrentId(userId); //3ã€é€šè¿‡ï¼Œæ”¾è¡Œ return true; } catch (Exception ex) { //4ã€ä¸é€šè¿‡ï¼Œå“åº”401çŠ¶æ€ç  response.setStatus(401); return false; } } } ","permalink":"https://kennems.github.io/posts/tech/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91day6/","summary":"è‹ç©¹å¤–å–åç«¯å¼€å‘(Day6) HttpClient HttpClientæ˜¯ Apache Jakarta Common ä¸‹çš„å­é¡¹ç›®ï¼Œå¯ä»¥ç”¨æ¥æä¾›é«˜æ•ˆçš„ã€æœ€æ–°çš„ã€åŠŸèƒ½ä¸°å¯Œçš„æ”¯æŒHTTPåè®®çš„å®¢æˆ·ç«¯ç¼–ç¨‹å·¥å…·","title":"è‹ç©¹å¤–å–åç«¯å¼€å‘(Day6)"},{"content":"è‹ç©¹å¤–å–åç«¯å¼€å‘(Day5) Redis Redis æ˜¯ä¸€ä¸ªåŸºäºå†…å­˜çš„key-valueç»“æ„æ•°æ®åº“çš„\nåŸºäºå†…å­˜å­˜å‚¨ï¼Œè¯»å†™æ€§èƒ½é«˜ é€‚åˆå­˜å‚¨çƒ­ç‚¹æ•°æ®ï¼ˆçƒ­ç‚¹å•†å“ï¼Œèµ„è®¯ï¼Œæ–°é—»ï¼‰ ä¼ä¸šåº”ç”¨å¹¿æ³› Rediså®‰è£…å’Œä½¿ç”¨ å®‰è£…Redis\nå¯åŠ¨Redis\nredis-server.exe redis.windows.conf ä¹‹ååœ¨å¦ä¸€ä¸ªçª—å£ä¸­è¿æ¥Redis\nredis-cli.exe -h localhost -p 6379 -a 123456 å…¶ä¸­-aåé¢æ˜¯å¯†ç ï¼Œ é»˜è®¤æ²¡æœ‰å¯†ç ï¼Œ\näº”ç§å¸¸ç”¨æ•°æ®ç±»å‹ä»‹ç» Rediså­˜å‚¨çš„æ˜¯key-valueç»“æ„çš„æ•°æ®ï¼Œå…¶ä¸­keyæ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼Œvalueæœ‰5ç§å¸¸ç”¨çš„æ•°æ®ç±»å‹ï¼š\nå­—ç¬¦ä¸² string å“ˆå¸Œ hash åˆ—è¡¨ list é›†åˆ set æœ‰åºé›†åˆ sorted set / zset å­—ç¬¦ä¸²ï¼ˆstringï¼‰ï¼šæ™®é€šå­—ç¬¦ä¸²ï¼ŒRedisç§æœ€ç®€å•çš„æ•°æ®ç±»å‹ å“ˆå¸Œï¼ˆhashï¼‰ï¼šä¹Ÿå«æ•£åˆ—ï¼Œç±»ä¼¼äºJavaç§HashMapç»“æ„ åˆ—è¡¨ï¼ˆlistï¼‰ï¼šæŒ‰ç…§æ’å…¥é¡ºåºæ’åºï¼Œå¯ä»¥æœ‰é‡å¤å…ƒç´ ï¼Œç±»ä¼¼äºJavaç§çš„LinkedList é›†åˆï¼ˆsetï¼‰ï¼šæ— åºé›†åˆï¼Œæ²¡æœ‰é‡å¤å…ƒç´ ï¼Œç±»ä¼¼äºJavaç§çš„HashSet æœ‰åºé›†åˆï¼ˆsorted set / zsetï¼‰ï¼šé›†åˆç§æ¯ä¸ªå…ƒç´ å…³è”ä¸€ä¸ªåˆ†æ•°ï¼ˆscoreï¼‰ï¼Œæ ¹æ®åˆ†æ•°å‡åºæ’åˆ—ï¼Œæ²¡æœ‰é‡å¤å…ƒç´  Rediså‘½ä»¤ å­—ç¬¦ä¸²æ“ä½œå‘½ä»¤ SET key value è®¾ç½®æŒ‡å®škeyçš„å€¼ GET key è·å–æŒ‡å®škeyçš„å€¼ SETEX key seconds value è®¾ç½®æŒ‡å®š key çš„å€¼ï¼Œ å¹¶å°† key çš„è¿‡æœŸæ—¶é—´è®¾ä¸ºseconds ç§’ SETNX key value åªæœ‰åœ¨keyä¸å­˜åœ¨æ—¶è®¾ç½®keyçš„å€¼ å“ˆå¸Œæ“ä½œå‘½ä»¤ Redis hash æ˜¯ä¸€ä¸ª string ç±»å‹çš„ field å’Œ value çš„æ˜ å°„è¡¨ï¼Œhashç‰¹åˆ«é€‚åˆç”¨äºå­˜å‚¨å¯¹è±¡ï¼Œå¸¸ç”¨å‘½ä»¤ï¼š\nHSET key field value å°†å“ˆå¸Œè¡¨ key ç§çš„å­—æ®µfieldçš„å€¼è®¾ä¸º value HGET key field è·å–å­˜å‚¨åœ¨å“ˆå¸Œè¡¨ä¸­æŒ‡å®šå­—æ®µçš„å€¼ HDEL key field åˆ é™¤å­˜å‚¨åœ¨å“ˆå¸Œè¡¨ç§çš„æŒ‡å®šå­—æ®µ HKEYS key è·å–å“ˆå¸Œè¡¨ç§æ‰€æœ‰å­—æ®µ HVALS key è·å–å“ˆå¸Œè¡¨ç§æ‰€æœ‰å€¼ åˆ—è¡¨æ“ä½œå‘½ä»¤ Redisåˆ—è¡¨æ˜¯æœ€ç®€å•çš„å­—ç¬¦ä¸²åˆ—è¡¨ï¼ŒæŒ‰ç…§æ’å…¥é¡ºåºæ’åºï¼Œå¸¸ç”¨å‘½ä»¤ï¼š\nLPUSH key value1 [value2] å°†ä¸€ä¸ªæˆ–å¤šä¸ªå€¼æ’å…¥åˆ°åˆ—è¡¨å¤´éƒ¨ LRANGE key start stop è·å–åˆ—è¡¨æŒ‡å®šèŒƒå›´å†…çš„å…ƒç´  RPOP key ç§»é™¤å¹¶è·å–åˆ—è¡¨æœ€åä¸€ä¸ªå…ƒç´  LLEN key è·å–åˆ—è¡¨é•¿åº¦ é›†åˆæ“ä½œå‘½ä»¤ Redis set æ˜¯ string ç±»å‹çš„æ— åºé›†åˆã€‚é›†åˆæˆå‘˜æ˜¯å”¯ä¸€çš„ï¼Œé›†åˆä¸­ä¸èƒ½å‡ºç°é‡å¤çš„æ•°æ®ï¼Œå¸¸ç”¨å‘½ä»¤ï¼š\nSADD key member1 [member2] å‘é›†åˆæ·»åŠ ä¸€ä¸ªæˆ–å¤šä¸ªæˆå‘˜ SMEMBERS key è¿”å›é›†åˆä¸­çš„æ‰€æœ‰æˆå‘˜ SCARD key è·å–é›†åˆçš„æˆå‘˜æ•° SINTER key1 [key2] è¿”å›ç»™å®šæ‰€æœ‰é›†åˆçš„äº¤é›† SUNION key1 [key2] è¿”å›æ‰€æœ‰ç»™å®šé›†åˆçš„å¹¶é›† SREM key member1 [member2] åˆ é™¤é›†åˆç§ä¸€ä¸ªæˆ–å¤šä¸ªæˆå‘˜ æœ‰åºé›†åˆæ“ä½œå‘½ä»¤ Redisæœ‰åºé›†åˆæ˜¯stringç±»å‹å…ƒç´ çš„é›†åˆï¼Œ ä¸”ä¸å…è®¸æœ‰é‡å¤æˆå‘˜ã€‚æ¯ä¸ªå…ƒç´ éƒ½ä¼šå…³è”ä¸€ä¸ªdoubleç±»å‹çš„åˆ†æ•°ã€‚å¸¸ç”¨å‘½ä»¤ï¼š\nZADD key score1 member1 [score2 member2] å‘æœ‰åºé›†åˆæ·»åŠ ä¸€ä¸ªæˆ–å¤šä¸ªæˆå‘˜ ZRANGE key start stop [WITHSCORES] é€šè¿‡ç´¢å¼•åŒºé—´è¿”å›æœ‰åºé›†åˆç§æŒ‡å®šåŒºé—´å†…çš„æˆå‘˜ ZINCRBY key increment member æœ‰åºé›†åˆä¸­å¯¹æŒ‡å®šæˆå‘˜çš„åˆ†æ•°åŠ ä¸Šå¢é‡ increment ZREM key member [member â€¦ ] ç§»é™¤æœ‰åºé›†åˆä¸­çš„ä¸€ä¸ªæˆ–å¤šä¸ªæˆå‘˜ é€šç”¨å‘½ä»¤ Redis çš„é€šç”¨å‘½ä»¤æ˜¯ä¸åˆ†æ•°æ®ç±»å‹çš„ï¼Œéƒ½å¯ä»¥ä½¿ç”¨çš„å‘½ä»¤ï¼š\nKEYS pattern æŸ¥æ‰¾æ‰€æœ‰ç¬¦åˆç»™å®šæ¨¡å¼ï¼ˆpatternï¼‰çš„key EXISTS key æ£€æŸ¥ç»™å®škeyæ˜¯å¦å­˜åœ¨ TYPE key è¿”å›keyæ‰€å­˜å‚¨çš„å€¼çš„ç±»å‹ DEL key ç”¨äºåœ¨keyå­˜åœ¨æ—¶åˆ é™¤key Redisçš„Javaå®¢æˆ·ç«¯ Jedis Lettuce Spring Data Redis Spring Data Redis æ˜¯ Spring çš„ä¸€éƒ¨åˆ†ï¼Œ å¯¹ Redis åº•å±‚å¼€å‘åŒ…è¿›è¡Œäº†é«˜åº¦å°è£…ã€‚\nåœ¨Springé¡¹ç›®ä¸­ï¼Œå¯ä»¥ä½¿ç”¨Spring Data Redisæ¥ç®€åŒ–æ“ä½œã€‚\nSpring Data Redis ä½¿ç”¨æ–¹å¼ æ“ä½œæ­¥éª¤ï¼š\nå¯¼å…¥Spring Data Redis çš„ maven åæ ‡ é…ç½®Redisæ•°æ®æº ç¼–å†™é…ç½®ç±»ï¼Œåˆ›å»ºRedisTemplateå¯¹è±¡ é€šè¿‡RedisTemplateå¯¹è±¡æ“ä½œRedis pom.xml \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.boot\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-boot-starter-data-redis\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; application.yml spring: redis: host: localhost port: 6379 password: 123456 é…ç½®ç±» @Configuration @Slf4j public class RedisConfiguration { @Bean public RedisTemplate redisTemplate(RedisConnectionFactory redisConnectionFactory) { Log.info(\u0026#34;å¼€å§‹åˆ›å»ºredisæ¨¡æ¿ç±»...\u0026#34;); RedisTemplate redisTemplate = new RedisTemplate(); // è®¾ç½®Keyçš„åºåˆ—åŒ–å™¨ï¼Œé»˜è®¤ä¸ºJdkSerializationRedisSerializer redisTemplate.setKeySerializer(new StringRedisSerializer()); redisTemplate.setConnectionFactory(redisConnectionFactory); return redisTemplate; } } Javaç¨‹åºä¸­è¿›è¡Œå­—ç¬¦ä¸²æ“ä½œ ","permalink":"https://kennems.github.io/posts/tech/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91day5/","summary":"è‹ç©¹å¤–å–åç«¯å¼€å‘(Day5) Redis Redis æ˜¯ä¸€ä¸ªåŸºäºå†…å­˜çš„key-valueç»“æ„æ•°æ®åº“çš„ åŸºäºå†…å­˜å­˜å‚¨ï¼Œè¯»å†™æ€§èƒ½é«˜ é€‚åˆå­˜å‚¨çƒ­ç‚¹æ•°æ®ï¼ˆçƒ­ç‚¹å•†å“ï¼Œèµ„è®¯ï¼Œæ–°é—»","title":"è‹ç©¹å¤–å–åç«¯å¼€å‘(Day5)"},{"content":"è‹ç©¹å¤–å–åç«¯å¼€å‘(Day3) èœå“ç®¡ç† å…¬å…±å­—æ®µè‡ªåŠ¨å¡«å…… å¯¹äºåˆ›å»ºæ—¶é—´ã€åˆ›å»ºäººidï¼Œä¿®æ”¹æ—¶é—´ï¼Œä¿®æ”¹äººidç­‰å­—æ®µ é‡å¤æ€§ä»£ç è¿›è¡Œç»Ÿä¸€ç¼–å†™\nè‡ªå®šä¹‰æ³¨è§£AutoFillï¼Œç”¨äºæ ‡è¯†éœ€è¦è¿›è¡Œå…¬å…±å­—æ®µè‡ªåŠ¨å¡«å……çš„æ–¹æ³• package com.sky.annotation; /** * è‡ªå®šä¹‰æ³¨è§£ï¼Œç”¨äºæ ‡è¯†æŸä¸ªæ–¹æ³•éœ€è¦è¿›è¡ŒåŠŸèƒ½å­—æ®µè‡ªåŠ¨å¡«å……å¤„ç†ã€‚ * è¿™ä¸ªæ³¨è§£å¯ä»¥åº”ç”¨äºæ–¹æ³•ä¸Šï¼Œç”¨äºæŒ‡ç¤ºåœ¨ç‰¹å®šçš„æ•°æ®åº“æ“ä½œæ—¶ * éœ€è¦è‡ªåŠ¨å¡«å……æŸäº›åŠŸèƒ½å­—æ®µã€‚ */ @Target(ElementType.METHOD) // æŒ‡å®šæ³¨è§£å¯ä»¥ç”¨äºæ–¹æ³• @Retention(RetentionPolicy.RUNTIME) // æŒ‡å®šæ³¨è§£åœ¨è¿è¡Œæ—¶å¯ç”¨ public @interface AutoFill { /** * æ•°æ®åº“æ“ä½œç±»å‹ï¼šç”¨äºæŒ‡ç¤ºè‡ªåŠ¨å¡«å……çš„æ“ä½œç±»å‹ã€‚ * å¯é€‰å€¼åŒ…æ‹¬ UPDATE å’Œ INSERTã€‚ * * @return æ“ä½œç±»å‹ */ OperationType value(); } è‡ªå®šä¹‰åˆ‡é¢ç±»AutoFillAspectï¼Œ ç»Ÿä¸€æ‹¦æˆªåŠ å…¥äº†AutoFillæ³¨è§£çš„æ–¹æ³•ï¼Œé€šè¿‡åå°„ä¸ºå…¬å…±å­—æ®µèµ‹å€¼ã€‚ package com.sky.aspect; /** * è‡ªå®šä¹‰åˆ‡é¢ï¼Œ å®ç°å…¬å…±å­—æ®µè‡ªåŠ¨å¡«å…… */ @Aspect @Component @Slf4j public class AutoFillAspect { /** * å®šä¹‰åˆ‡å…¥ç‚¹ï¼ŒåŒ¹é…com.sky.mapperåŒ…ä¸‹çš„æ‰€æœ‰æ–¹æ³•ï¼Œå¹¶ä¸”æ–¹æ³•ä¸Šéœ€æœ‰@AutoFillæ³¨è§£ */ @Pointcut(\u0026#34;execution(* com.sky.mapper.*.*(..)) \u0026amp;\u0026amp; @annotation(com.sky.annotation.AutoFill)\u0026#34;) public void autoFillPointCut() { } /** * å‰ç½®é€šçŸ¥ï¼Œåœ¨ç›®æ ‡æ–¹æ³•æ‰§è¡Œå‰è¿›è¡Œå…¬å…±å­—æ®µèµ‹å€¼ * * @param joinPoint è¿æ¥ç‚¹ï¼Œè¡¨ç¤ºè¢«æ‹¦æˆªçš„æ–¹æ³•è°ƒç”¨ */ @Before(\u0026#34;autoFillPointCut()\u0026#34;) public void autoFill(JoinPoint joinPoint) { log.info(\u0026#34;å¼€å§‹è¿›è¡Œå…¬å…±å­—æ®µè‡ªåŠ¨å¡«å……...\u0026#34;); // è·å–å½“å‰è¢«æ‹¦æˆªæ–¹æ³•çš„ç­¾åï¼ˆæ–¹æ³•ä¿¡æ¯ï¼‰ MethodSignature signature = (MethodSignature) joinPoint.getSignature(); // ä»æ–¹æ³•ç­¾åä¸­è·å–@AutoFillæ³¨è§£ AutoFill autoFill = signature.getMethod().getAnnotation(AutoFill.class); // è·å–æ“ä½œç±»å‹ï¼ˆINSERTæˆ–UPDATEï¼‰ OperationType operationType = autoFill.value(); // è·å–ç›®æ ‡æ–¹æ³•çš„å‚æ•°ï¼ˆå‡è®¾ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å®ä½“å¯¹è±¡ï¼‰ Object[] args = joinPoint.getArgs(); if (args == null || args.length == 0) { return; // å¦‚æœæ²¡æœ‰å‚æ•°åˆ™ç›´æ¥è¿”å› } // è·å–å®ä½“å¯¹è±¡ï¼ˆç›®æ ‡æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼‰ Object entity = args[0]; // è·å–å½“å‰æ—¶é—´å’Œå½“å‰æ“ä½œç”¨æˆ·ID LocalDateTime now = LocalDateTime.now(); Long currentId = BaseContext.getCurrentId(); // æ ¹æ®æ“ä½œç±»å‹åˆ¤æ–­æ˜¯INSERTè¿˜æ˜¯UPDATEæ“ä½œ if (operationType == OperationType.INSERT) { try { // é€šè¿‡åå°„è°ƒç”¨å®ä½“å¯¹è±¡çš„setæ–¹æ³•ï¼Œèµ‹å€¼åˆ›å»ºå’Œæ›´æ–°æ—¶é—´ã€åˆ›å»ºå’Œæ›´æ–°ç”¨æˆ· Method setCreateTime = entity.getClass().getDeclaredMethod(AutoFillConstant.SET_CREATE_TIME, LocalDateTime.class); Method setCreateUser = entity.getClass().getDeclaredMethod(AutoFillConstant.SET_CREATE_USER, Long.class); Method setUpdateTime = entity.getClass().getDeclaredMethod(AutoFillConstant.SET_UPDATE_TIME, LocalDateTime.class); Method setUpdateUser = entity.getClass().getDeclaredMethod(AutoFillConstant.SET_UPDATE_USER, Long.class); // è°ƒç”¨æ–¹æ³•è¿›è¡Œèµ‹å€¼ setCreateTime.invoke(entity, now); setCreateUser.invoke(entity, currentId); setUpdateTime.invoke(entity, now); setUpdateUser.invoke(entity, currentId); } catch (Exception e) { e.printStackTrace(); // æ•è·å¼‚å¸¸å¹¶æ‰“å° } } else if (operationType == OperationType.UPDATE) { try { // é€šè¿‡åå°„è°ƒç”¨å®ä½“å¯¹è±¡çš„setæ–¹æ³•ï¼Œèµ‹å€¼æ›´æ–°æ—¶é—´å’Œæ›´æ–°ç”¨æˆ· Method setUpdateTime = entity.getClass().getDeclaredMethod(AutoFillConstant.SET_UPDATE_TIME, LocalDateTime.class); Method setUpdateUser = entity.getClass().getDeclaredMethod(AutoFillConstant.SET_UPDATE_USER, Long.class); // è°ƒç”¨æ–¹æ³•è¿›è¡Œèµ‹å€¼ setUpdateTime.invoke(entity, now); setUpdateUser.invoke(entity, currentId); } catch (Exception e) { e.printStackTrace(); // æ•è·å¼‚å¸¸å¹¶æ‰“å° } } } } åœ¨Mapperçš„æ–¹æ³•ä¸ŠåŠ å…¥AutoFillæ³¨è§£ @AutoFill(value = OperationType.INSERT) @AutoFill(value = OperationType.UPDATE) æ–°å¢èœå“ äº§å“åŸå‹ ä¸šåŠ¡è§„åˆ™ï¼š èœå“åç§°å¿…é¡»æ˜¯å”¯ä¸€çš„ èœå“å¿…é¡»å±äºæŸä¸ªåˆ†ç±»ä¸‹ï¼Œä¸èƒ½å•ç‹¬å­˜åœ¨ æ–°å¢èœå“æ—¶å¯ä»¥æ ¹æ®æƒ…å†µé€‰æ‹©èœå“çš„å£å‘³ æ¯ä¸ªèœå“å¿…é¡»å¯¹åº”ä¸€å¼ å›¾ç‰‡ æ¥å£è®¾è®¡ï¼š æ ¹æ®ç±»å‹æŸ¥è¯¢åˆ†é… æ–‡ä»¶ä¸Šä¼  æ–°å¢èœå“ æ•°æ®åº“è®¾è®¡ï¼ˆdishèœå“è¡¨å’Œdish_flavorå£å‘³è¡¨ï¼‰ï¼š é…ç½®OSSå›¾åƒå­˜å‚¨æœåŠ¡\nå¯ä»¥é€šè¿‡ä¸‹é¢çš„Propertiesæ–‡ä»¶é…ç½®OSSçš„å±æ€§ã€‚\npackage com.sky.properties; @Component @ConfigurationProperties(prefix = \u0026#34;sky.alioss\u0026#34;) @Data public class AliOssProperties { private String endpoint; private String accessKeyId; private String accessKeySecret; private String bucketName; } åœ¨application-devä¸­è¯¦ç»†é…ç½®id, keyç­‰ã€‚\né€šç”¨æ¥å£ package com.sky.controller.admin; /** * é€šç”¨æ¥å£ */ @RestController @RequestMapping(\u0026#34;/admin/common\u0026#34;) @Api(tags = \u0026#34;é€šç”¨æ¥å£\u0026#34;) @Slf4j public class CommonController { @Autowired private AliOssUtil aliOssUtil; /** * æ–‡ä»¶ä¸Šä¼  * @param file * @return */ @PostMapping(\u0026#34;/upload\u0026#34;) public Result\u0026lt;String\u0026gt; upload(MultipartFile file){ log.info(\u0026#34;æ–‡ä»¶ä¸Šä¼ ï¼š{}\u0026#34;,file); try { // åŸå§‹æ–‡ä»¶å String originalFilename = file.getOriginalFilename(); // æˆªå–åŸå§‹æ–‡ä»¶åçš„åç¼€ String extension = originalFilename.substring(originalFilename.lastIndexOf(\u0026#39;.\u0026#39;)); // æ„é€ æ–°æ–‡ä»¶åç§° String objectName = UUID.randomUUID().toString() + extension; // æ–‡ä»¶çš„è¯·æ±‚è·¯å¾„ String filePath = aliOssUtil.upload(file.getBytes(), objectName); return Result.success(filePath); } catch (IOException e) { log.error(\u0026#34;æ–‡ä»¶ä¸Šä¼ å¤±è´¥ï¼š{}\u0026#34;, e); } return Result.error(MessageConstant.UPLOAD_FAILED); } } èœå“æ¥å£ package com.sky.controller.admin; @RestController @RequestMapping(\u0026#34;/admin/dish\u0026#34;) @Api(tags = \u0026#34;èœå“ç›¸å…³æ¥å£\u0026#34;) @Slf4j public class DishController { @Autowired private DishService dishService; @PostMapping @ApiOperation(\u0026#34;æ–°å¢èœå“\u0026#34;) public Result save(@RequestBody DishDTO dishDTO){ log.info(\u0026#34;æ–°å¢èœå“ï¼š{}\u0026#34;, dishDTO); dishService.saveWithFlavor(dishDTO); return Result.success(); } } åœ¨DishServiceImplä¸­å®ç°saveWithFlavor\npackage com.sky.service.impl; @Service public class DishServiceImpl implements DishService { @Autowired private DishMapper dishMapper; @Autowired private DishFlavorMapper dishFlavorMapper; /** * æ–°å¢èœå“å’Œå¯¹åº”çš„å£å‘³ * @param dishDTO */ @Transactional public void saveWithFlavor(DishDTO dishDTO) { Dish dish = new Dish(); BeanUtils.copyProperties(dishDTO, dish); // å‘èœå“è¡¨æ’å…¥1æ¡æ•°æ® dishMapper.insert(dish); Long dishId = dish.getId(); List\u0026lt;DishFlavor\u0026gt; flavors = dishDTO.getFlavors(); if (flavors != null \u0026amp;\u0026amp; flavors.size() \u0026gt; 0) { flavors.forEach(dishFlavor -\u0026gt; dishFlavor.setDishId(dishId)); // å‘å£å‘³è¡¨æ’å…¥næ¡æ•°æ® dishFlavorMapper.insertBatch(flavors); } } } åœ¨Mapperä¸­å®ç°SQL DishMapper \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34; ?\u0026gt; \u0026lt;!DOCTYPE mapper PUBLIC \u0026#34;-//mybatis.org//DTD Mapper 3.0//EN\u0026#34; \u0026#34;http://mybatis.org/dtd/mybatis-3-mapper.dtd\u0026#34; \u0026gt; \u0026lt;mapper namespace=\u0026#34;com.sky.mapper.DishMapper\u0026#34;\u0026gt; \u0026lt;insert id=\u0026#34;insert\u0026#34; useGeneratedKeys=\u0026#34;true\u0026#34; keyProperty=\u0026#34;id\u0026#34;\u0026gt; insert into dish (name, category_id, price, image, description, create_time, update_time, create_user, update_user) values (#{name}, #{categoryId}, #{price}, #{image}, #{description}, #{createTime}, #{updateTime}, #{createUser}, #{updateUser}) \u0026lt;/insert\u0026gt; \u0026lt;/mapper\u0026gt; useGeneratedKeys=\u0026quot;true\u0026quot;: è¡¨ç¤ºåœ¨æ’å…¥æ“ä½œåï¼Œä½¿ç”¨æ•°æ®åº“ç”Ÿæˆçš„ä¸»é”®å€¼ã€‚è¿™ä¸ªé€‰é¡¹é€šå¸¸ä¸ä¸»é”®è‡ªå¢ï¼ˆå¦‚ MySQL çš„ AUTO_INCREMENTï¼‰ä¸€èµ·ä½¿ç”¨ã€‚\nkeyProperty=\u0026quot;id\u0026quot;: æŒ‡å®šå­˜å‚¨ç”Ÿæˆä¸»é”®å€¼çš„å¯¹è±¡å±æ€§ã€‚åœ¨æ’å…¥æˆåŠŸåï¼Œæ•°æ®åº“ç”Ÿæˆçš„ä¸»é”®å€¼ä¼šè¢«è®¾ç½®åˆ°è¿™ä¸ªå±æ€§ä¸Šã€‚\nDishFlavorMapper \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34; ?\u0026gt; \u0026lt;!DOCTYPE mapper PUBLIC \u0026#34;-//mybatis.org//DTD Mapper 3.0//EN\u0026#34; \u0026#34;http://mybatis.org/dtd/mybatis-3-mapper.dtd\u0026#34; \u0026gt; \u0026lt;mapper namespace=\u0026#34;com.sky.mapper.DishFlavorMapper\u0026#34;\u0026gt; \u0026lt;insert id=\u0026#34;insertBatch\u0026#34;\u0026gt; insert into dish_flavor(dish_id, name, value) VALUES \u0026lt;foreach collection=\u0026#34;flavors\u0026#34; item=\u0026#34;df\u0026#34; separator=\u0026#34;,\u0026#34;\u0026gt; (#{df.dishId}, #{df.name}, #{df.value}) \u0026lt;/foreach\u0026gt; \u0026lt;/insert\u0026gt; \u0026lt;/mapper\u0026gt; èœå“åˆ†é¡µæŸ¥è¯¢ éœ€æ±‚åˆ†æå’Œè®¾è®¡ DishController /** * èœå“åˆ†é¡µæŸ¥è¯¢ * @param dishPageQueryDTO * @return */ @GetMapping(\u0026#34;/page\u0026#34;) @ApiOperation(\u0026#34;èœå“åˆ†é¡µæŸ¥è¯¢\u0026#34;) public Result\u0026lt;PageResult\u0026gt; page(DishPageQueryDTO dishPageQueryDTO){ log.info(\u0026#34;èœå“åˆ†é¡µæŸ¥è¯¢{}\u0026#34;, dishPageQueryDTO); PageResult pageResult = dishService.pageQuery(dishPageQueryDTO); return Result.success(pageResult); } å®ç°pageQuery @Override public PageResult pageQuery(DishPageQueryDTO dishPageQueryDTO) { PageHelper.startPage(dishPageQueryDTO.getPage(), dishPageQueryDTO.getPageSize()); Page\u0026lt;DishVO\u0026gt; page = dishMapper.pageQuery(dishPageQueryDTO); return new PageResult(page.getTotal(), page.getResult()); } Mapper \u0026lt;select id=\u0026#34;pageQuery\u0026#34; resultType=\u0026#34;com.sky.vo.DishVO\u0026#34;\u0026gt; select d.*, c.name as categoryName from dish d left join category c on d.category_id = c.id \u0026lt;where\u0026gt; \u0026lt;if test=\u0026#34;name != null\u0026#34;\u0026gt; and d.name like concat(\u0026#39;%\u0026#39;, #{name},\u0026#39;%\u0026#39;) \u0026lt;/if\u0026gt; \u0026lt;if test=\u0026#34;categoryId != null\u0026#34;\u0026gt; and d.category_id = #{categoryId} \u0026lt;/if\u0026gt; \u0026lt;if test=\u0026#34;status != null\u0026#34;\u0026gt; and d.status = #{status} \u0026lt;/if\u0026gt; \u0026lt;/where\u0026gt; order by d.create_time desc \u0026lt;/select\u0026gt; èœå“åˆ é™¤ ä¸šåŠ¡è§„åˆ™ï¼š\nå¯ä»¥ä¸€æ¬¡åˆ é™¤ä¸€ä¸ªèœå“ï¼Œä¹Ÿå¯ä»¥æ‰¹é‡åˆ é™¤å¤šä¸ªèœå“ å¯å”®çš„èœå“ä¸èƒ½åˆ é™¤ è¢«å¥—é¤å…³è”çš„èœå“ä¸èƒ½åˆ é™¤ åˆ é™¤èœå“åï¼Œå…³è”çš„å£å‘³æ•°æ®ä¹Ÿéœ€è¦åˆ é™¤æ‰ @DeleteMapping @ApiOperation(\u0026#34;èœå“æ‰¹é‡åˆ é™¤\u0026#34;) public Result delete(@RequestParam List\u0026lt;Long\u0026gt; ids){ log.info(\u0026#34;èœå“æ‰¹é‡åˆ é™¤:{}\u0026#34;,ids); dishService.deleteBatch(ids); return Result.success(); } ","permalink":"https://kennems.github.io/posts/tech/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91day3/","summary":"è‹ç©¹å¤–å–åç«¯å¼€å‘(Day3) èœå“ç®¡ç† å…¬å…±å­—æ®µè‡ªåŠ¨å¡«å…… å¯¹äºåˆ›å»ºæ—¶é—´ã€åˆ›å»ºäººidï¼Œä¿®æ”¹æ—¶é—´ï¼Œä¿®æ”¹äººidç­‰å­—æ®µ é‡å¤æ€§ä»£ç è¿›è¡Œç»Ÿä¸€ç¼–å†™ è‡ªå®šä¹‰æ³¨è§£Au","title":"è‹ç©¹å¤–å–åç«¯å¼€å‘(Day3)"},{"content":"è‹ç©¹å¤–å–åç«¯å¼€å‘(Day2) æ–°å¢å‘˜å·¥ ç®¡ç†ç«¯å‘å‡ºçš„è¯·æ±‚ï¼Œ ç»Ÿä¸€ä½¿ç”¨/adminä½œä¸ºå‰ç¼€ ç”¨æˆ·ç«¯å‘å‡ºçš„è¯·æ±‚ï¼Œç»Ÿä¸€ä½¿ç”¨/userä½œä¸ºå‰ç¼€ ä»£ç å¼€å‘ æ ¹æ®æ–°å¢å‘˜å·¥æ¥å£è®¾è®¡å¯¹åº”çš„DTO\næ³¨æ„ ï¼š å½“å‰ç«¯æäº¤çš„æ•°æ®å’Œå®ä½“ç±»ä¸­å¯¹åº”çš„å±æ€§å·®åˆ«æ¯”è¾ƒå¤§æ—¶ï¼Œå»ºè®®ä½¿ç”¨DTOæ¥å°è£…æ•°æ®\nåŠŸèƒ½æµ‹è¯• åŠŸèƒ½æµ‹è¯•æ–¹å¼ï¼š\né€šè¿‡æ¥å£æ–‡æ¡£æµ‹è¯• é€šè¿‡å‰åç«¯è”è°ƒæµ‹è¯• æ³¨æ„ï¼šç”±äºå¼€å‘é˜¶æ®µå‰ç«¯å’Œåç«¯æ—¶å¹¶è¡Œå¼€å‘çš„ï¼Œåç«¯å®ŒæˆæŸä¸ªåŠŸèƒ½åï¼Œæ­¤æ—¶å‰ç«¯å¯¹åº”çš„åŠŸèƒ½å¯èƒ½è¿˜æ²¡æœ‰å¼€å‘å®Œæˆï¼Œå¯¼è‡´æ— æ³•è¿›è¡Œå‰åç«¯è”è°ƒæµ‹è¯•ã€‚æ‰€ä»¥åœ¨å¼€å‘é˜¶æ®µï¼Œåç«¯æµ‹è¯•ä¸»è¦ä»¥æ¥å£æ–‡æ¡£æµ‹è¯•ä¸ºä¸»ã€‚\nä»£ç å®Œå–„ å½•å…¥çš„ç”¨æˆ·åå·²å­˜åœ¨ï¼ŒæŠ›å‡ºå¼‚å¸¸åæ²¡æœ‰å¤„ç† æ–°å¢å‘˜å·¥æ—¶ï¼Œåˆ›å»ºäººidå’Œä¿®æ”¹äººidè®¾ç½®ä¸ºäº†å›ºå®šå€¼ ThreadLocal å¹¶ä¸æ˜¯ä¸€ä¸ªThreadï¼Œè€Œæ˜¯Threadçš„å±€éƒ¨å˜é‡ã€‚\nThreadLocalä¸ºæ¯ä¸ªçº¿ç¨‹æä¾›å•ç‹¬ä¸€ä»½å­˜å‚¨ç©ºé—´ï¼Œå…·æœ‰çº¿ç¨‹éš”ç¦»çš„æ•ˆæœï¼Œ åªæœ‰åœ¨çº¿ç¨‹å†…æ‰èƒ½è·å–åˆ°å¯¹åº”çš„å€¼ï¼Œçº¿ç¨‹å¤–åˆ™ä¸èƒ½è®¿é—®ã€‚\nThreadLocalå¸¸ç”¨æ–¹æ³•ï¼š\npublic void set(T value) //è®¾ç½®å½“å‰çº¿ç¨‹çš„çº¿ç¨‹å±€éƒ¨å˜é‡çš„å€¼ public T get() //è¿”å›å½“å‰çº¿ç¨‹æ‰€å¯¹åº”çš„çº¿ç¨‹å±€éƒ¨å˜é‡çš„å€¼ public void remove() //ç§»é™¤å½“å‰çº¿ç¨‹çš„çº¿ç¨‹å±€éƒ¨å˜é‡ å‘˜å·¥åˆ†é¡µæŸ¥è¯¢ éœ€æ±‚åˆ†æå’Œè®¾è®¡ ä¸šåŠ¡è§„åˆ™ ï¼š\næ ¹æ®é¡µç å±•ç¤ºå‘˜å·¥ä¿¡æ¯ æ¯é¡µå±•ç¤º10æ¡æ•°æ® åˆ†é¡µæŸ¥è¯¢æ—¶å¯ä»¥æ ¹æ®éœ€è¦ï¼Œè¾“å…¥å‘˜å·¥å§“åè¿›è¡ŒæŸ¥è¯¢ ä»£ç å¼€å‘ /** * å‘˜å·¥åˆ†é¡µæŸ¥è¯¢ * @param employeePageQueryDTO * @return */ @GetMapping(\u0026#34;/page\u0026#34;) @ApiOperation(\u0026#34;å‘˜å·¥åˆ†é¡µæŸ¥è¯¢\u0026#34;) public Result\u0026lt;PageResult\u0026gt; page(EmployeePageQueryDTO employeePageQueryDTO){ log.info(\u0026#34;å‘˜å·¥åˆ†é¡µæŸ¥è¯¢ï¼Œ å‚æ•°ä¸ºï¼š{}\u0026#34;, employeePageQueryDTO); PageResult pageResult = employeeService.pageQuery(employeePageQueryDTO); return Result.success(pageResult); } æ ¹æ®åˆ†é¡µæŸ¥è¯¢æ¥å£è®¾è®¡å¯¹åº”çš„DTOï¼š\nè§£å†³æ–¹å¼ï¼š\næ–¹å¼ä¸€ï¼šåœ¨å±æ€§ä¸ŠåŠ å…¥æ³¨è§£ï¼Œå¯¹æ—¥æœŸè¿›è¡Œæ ¼å¼åŒ– //æ›´æ–°æ—¶é—´ @JsonFormat(pattern = \u0026#34;yyyy-MM-dd HH:mm:ss\u0026#34;) private LocalDateTime updateTime; æ–¹å¼äºŒï¼šåœ¨WebMvcConfigurationä¸­æ‰©å±•Spring MVCçš„æ¶ˆæ¯è½¬æ¢å™¨ï¼Œç»Ÿä¸€å¯¹æ—¥æœŸç±»å‹è¿›è¡Œæ ¼å¼åŒ–å¤„ç† /** * æ‰©å±•mvcæ¡†æ¶çš„æ¶ˆæ¯è½¬æ¢å™¨ * @param converters */ protected void extendMessageConverters(List\u0026lt;HttpMessageConverter\u0026lt;?\u0026gt;\u0026gt; converters) { Log.info(\u0026#34;å¼€å§‹æ‰©å±•æ¶ˆæ¯è½¬æ¢å™¨...\u0026#34;); // åˆ›å»ºä¸€ä¸ªæ¶ˆæ¯è½¬æ¢å™¨å¯¹è±¡ MappingJackson2HttpMessageConverter converter = new MappingJackson2HttpMessageConverter(); // è®¾ç½®å¯¹è±¡è½¬æ¢å™¨ï¼Œå¯ä»¥å°†Javaå¯¹è±¡è½¬ä¸ºjsonå­—ç¬¦ä¸² converter.setObjectMapper(new JacksonObjectMapper()); // å°†æˆ‘ä»¬è‡ªå·±çš„è½¬æ¢å™¨æ”¾å…¥Spring MVCæ¡†æ¶çš„å®¹å™¨ä¸­ converters.add(0, converter); } å¯ç”¨ç¦ç”¨å‘˜å·¥è´¦å· ä¸šåŠ¡è§„åˆ™ï¼š\nå¯ä»¥å¯¹çŠ¶æ€ä¸ºâ€å¯ç”¨â€œçš„å‘˜å·¥è´¦å·è¿›è¡Œâ€œç¦ç”¨â€æ“ä½œ å¯ä»¥å¯¹çŠ¶æ€ä¸ºâ€œç¦ç”¨â€çš„å‘˜å·¥è´¦å·è¿›è¡Œâ€œå¯ç”¨â€æ“ä½œ çŠ¶æ€ä¸ºâ€œç¦ç”¨â€çš„å‘˜å·¥è´¦å·ä¸èƒ½ç™»å½•ç³»ç»Ÿ ä»£ç å¼€å‘ /** * å¯ç”¨ç¦ç”¨å‘˜å·¥è´¦å· * @param status * @param id * @return */ @PostMapping(\u0026#34;status/{status}\u0026#34;) @ApiOperation(\u0026#34;å¯ç”¨ç¦ç”¨å‘˜å·¥è´¦å·\u0026#34;) public Result startOrStop(@PathVariable(\u0026#34;status\u0026#34;) Integer status, Long id){ log.info(\u0026#34;å¯ç”¨ç¦ç”¨å‘˜å·¥è´¦å·ï¼š{}, {}\u0026#34;, status, id); employeeService.startOrStop(status, id); return Result.success(); } ç¼–è¾‘å‘˜å·¥ æ¶‰åŠåˆ°ä¸¤ä¸ªæ¥å£ï¼š\næ ¹æ®idæŸ¥è¯¢å‘˜å·¥ä¿¡æ¯ ç¼–è¾‘å‘˜å·¥ä¿¡æ¯ ä»£ç å¼€å‘ @GetMapping(\u0026#34;/{id}\u0026#34;) @ApiOperation(\u0026#34;æ ¹æ®idæŸ¥è¯¢å‘˜å·¥ä¿¡æ¯\u0026#34;) public Result\u0026lt;Employee\u0026gt; getById(@PathVariable Long id) { Employee employee = employeeService.getById(id); return Result.success(employee); } @PutMapping @ApiOperation(\u0026#34;ç¼–è¾‘ä¿®æ”¹å‘˜å·¥ä¿¡æ¯\u0026#34;) public Result update(@RequestBody EmployeeDTO employeeDTO) { log.info(\u0026#34;ç¼–è¾‘å‘˜å·¥ä¿¡æ¯{}\u0026#34;, employeeDTO); employeeService.update(employeeDTO); return Result.success(); } å¯¼å…¥åˆ†ç±»æ¨¡å—åŠŸèƒ½ä»£ç  ä¸šåŠ¡è§„åˆ™ï¼š\nåˆ†ç±»åç§°å¿…é¡»æ˜¯å”¯ä¸€çš„ åˆ†ç±»æŒ‰ç…§ç±»å‹å¯ä»¥åˆ†ä¸ºèœå“åˆ†ç±»å’Œå¥—é¤åˆ†ç±» æ–°æ·»åŠ çš„åˆ†ç±»çŠ¶æ€é»˜è®¤ä¸ºâ€œç¦ç”¨â€ ","permalink":"https://kennems.github.io/posts/tech/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91day2/","summary":"è‹ç©¹å¤–å–åç«¯å¼€å‘(Day2) æ–°å¢å‘˜å·¥ ç®¡ç†ç«¯å‘å‡ºçš„è¯·æ±‚ï¼Œ ç»Ÿä¸€ä½¿ç”¨/adminä½œä¸ºå‰ç¼€ ç”¨æˆ·ç«¯å‘å‡ºçš„è¯·æ±‚ï¼Œç»Ÿä¸€ä½¿ç”¨/userä½œä¸ºå‰ç¼€ ä»£ç å¼€å‘ æ ¹æ®æ–°","title":"è‹ç©¹å¤–å–åç«¯å¼€å‘(Day2)"},{"content":"Docker å¿«é€Ÿæ„å»ºã€è¿è¡Œã€ç®¡ç†åº”ç”¨çš„å·¥å…·\nDockeræ‰“å°æ‰€æœ‰å®¹å™¨ï¼ˆåŒ…æ‹¬å…³é—­çš„ï¼‰\ndocker ps -a æ­£åœ¨è¿è¡Œçš„\ndocker ps åˆ é™¤å®¹å™¨\ndocker rm \u0026lt;container_id\u0026gt; å¯åŠ¨å·²æœ‰çš„å®¹å™¨\ndocker start \u0026lt;å®¹å™¨IDæˆ–åç§°\u0026gt; å¯åŠ¨å®¹å™¨å¹¶è¿›å…¥å…¶äº¤äº’å¼ç»ˆç«¯\ndocker start -i \u0026lt;å®¹å™¨IDæˆ–åç§°\u0026gt; å¯åŠ¨åç›´æ¥è¿›å…¥å®¹å™¨çš„ bash ç»ˆç«¯\ndocker exec -it \u0026lt;å®¹å™¨IDæˆ–åç§°\u0026gt; /bin/bash åœæ­¢å®¹å™¨\ndocker stop \u0026lt;container_id\u0026gt; docker run -d \\ --name mysql \\ -p 3306:3306 \\ -e TZ=Asia/Shanghai \\ -e MYSQL_ROOT_PASSWORD=123 \\ mysql DockeråŸºç¡€çŸ¥è¯† Docker æ•°æ®å· ä½œç”¨ï¼šå®¿ä¸»æœºç›®å½•å’Œdockerå®¹å™¨å†…ç›®å½•åšä¸€ä¸ªå…³è”\nMySqlå®¹å™¨çš„æ•°æ®æŒ‚è½½ docker run -d \\ --name mysql \\ -p 3307:3306 \\ -e TZ=Asia/Shanghai \\ -e MYSQL_ROOT_PASSWORD=123 \\ -v /root/mysql/data:/var/lib/mysql \\ -v /root/mysql/init:/docker-entrypoint-initdb.d \\ -v /root/mysql/conf:/etc/mysql/conf.d \\ mysql è‡ªå®šä¹‰é•œåƒ DokerFile DockerFileå°±æ˜¯ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œ å…¶ä¸­åŒ…æ‹¬ä¸€ä¸ªä¸ªçš„æŒ‡ä»¤ï¼ˆInstructionï¼‰ï¼Œç”¨æŒ‡ä»¤æ¥è¯´æ˜è¦æ‰§è¡Œä»€ä¹ˆæ“ä½œæ¥æ„å»ºé•œåƒã€‚å°†æ¥Dockerå¯ä»¥æ ¹æ®DockerFileå¸®æˆ‘ä»¬æ„å»ºé•œåƒã€‚\nç½‘ç»œ åŠ å…¥è‡ªå®šä¹‰ç½‘ç»œçš„å®¹å™¨æ‰å¯ä»¥é€šè¿‡å®¹å™¨äº’ç›¸è®¿é—®ï¼Œ Dockerçš„ç½‘ç»œæ“ä½œå‘½ä»¤å¦‚ä¸‹ï¼š\nå‘½ä»¤ è¯´æ˜ docker network ls åˆ—å‡ºæ‰€æœ‰ Docker ç½‘ç»œ docker network inspect \u0026lt;network\u0026gt; æ˜¾ç¤ºæŒ‡å®šç½‘ç»œçš„è¯¦ç»†ä¿¡æ¯ docker network create \u0026lt;network\u0026gt; åˆ›å»ºä¸€ä¸ªæ–°çš„ Docker ç½‘ç»œ docker network rm \u0026lt;network\u0026gt; åˆ é™¤æŒ‡å®šçš„ Docker ç½‘ç»œ docker network connect \u0026lt;network\u0026gt; \u0026lt;container\u0026gt; å°†å®¹å™¨è¿æ¥åˆ°æŒ‡å®šçš„ç½‘ç»œ docker network disconnect \u0026lt;network\u0026gt; \u0026lt;container\u0026gt; å°†å®¹å™¨ä»æŒ‡å®šçš„ç½‘ç»œæ–­å¼€ docker network prune åˆ é™¤æ‰€æœ‰æœªä½¿ç”¨çš„ Docker ç½‘ç»œ docker run --network \u0026lt;network\u0026gt; \u0026lt;image\u0026gt; è¿è¡Œå®¹å™¨å¹¶æŒ‡å®šä½¿ç”¨çš„ç½‘ç»œ docker network create --driver \u0026lt;driver\u0026gt; \u0026lt;network\u0026gt; ä½¿ç”¨æŒ‡å®šçš„é©±åŠ¨ç¨‹åºåˆ›å»ºç½‘ç»œï¼ˆbridge, overlay, hostç­‰ï¼‰ docker network inspect --format \u0026lt;template\u0026gt; \u0026lt;network\u0026gt; ä»¥è‡ªå®šä¹‰æ ¼å¼æ˜¾ç¤ºç½‘ç»œçš„è¯¦ç»†ä¿¡æ¯ docker network connect --ip \u0026lt;ip\u0026gt; \u0026lt;network\u0026gt; \u0026lt;container\u0026gt; å°†å®¹å™¨è¿æ¥åˆ°æŒ‡å®šç½‘ç»œå¹¶åˆ†é…é™æ€ IP docker network create --subnet \u0026lt;subnet\u0026gt; \u0026lt;network\u0026gt; æŒ‡å®šå­ç½‘å’Œ IP èŒƒå›´åˆ›å»ºç½‘ç»œï¼ˆä¾‹ï¼š\u0026ndash;subnet=192.168.1.0/24ï¼‰ docker network create --gateway \u0026lt;gateway\u0026gt; \u0026lt;network\u0026gt; åˆ›å»ºç½‘ç»œæ—¶æŒ‡å®šç½‘å…³ IP docker network disconnect -f \u0026lt;network\u0026gt; \u0026lt;container\u0026gt; å¼ºåˆ¶å°†å®¹å™¨ä»æŒ‡å®šçš„ç½‘ç»œæ–­å¼€ docker network connect --alias \u0026lt;alias\u0026gt; \u0026lt;network\u0026gt; \u0026lt;container\u0026gt; å°†ç½‘ç»œä¸­çš„å®¹å™¨æ·»åŠ åˆ«åï¼ˆä¾¿äºæœåŠ¡å‘ç°ï¼‰ éƒ¨ç½²æµç¨‹ éƒ¨ç½²Javaåº”ç”¨\néƒ¨ç½²nginx\ndocker run -d \\ --name nginx \\ -p 18080:18080 \\ -p 18081:18081 \\ -v /root/nginx/html:/usr/share/nginx/html \\ -v /root/nginx/nginx.conf:/etc/nginx/nginx.conf \\ --network kennem \\ nginx DockerCompose DockerComposeé€šè¿‡ä¸€ä¸ªå•ç‹¬çš„docker-compose.ymlæ¨¡æ¿æ–‡ä»¶ï¼ˆYAMLæ ¼å¼ï¼‰æ¥å®šä¹‰ä¸€ç»„ç›¸å…³è”çš„åº”ç”¨å®¹å™¨ï¼Œ å¸®åŠ©æˆ‘ä»¬å®ç°å¤šä¸ªç›¸äº’å…³è”çš„Dockerå®¹å™¨çš„å¿«é€Ÿéƒ¨ç½²ã€‚\nversion: \u0026#34;3.8\u0026#34; services: mysql: image: mysql container_name: mysql ports: - \u0026#34;3306:3306\u0026#34; environment: TZ: Asia/Shanghai MYSQL_ROOT_PASSWORD: 123 volumes: - \u0026#34;./mysql/conf:/etc/mysql/conf.d\u0026#34; - \u0026#34;./mysql/data:/var/lib/mysql\u0026#34; - \u0026#34;./mysql/init:/docker-entrypoint-initdb.d\u0026#34; networks: - hm-net hmall: build: context: . dockerfile: Dockerfile container_name: hmall ports: - \u0026#34;8080:8080\u0026#34; networks: - hm-net depends_on: - mysql nginx: image: nginx container_name: nginx ports: - \u0026#34;18080:18080\u0026#34; - \u0026#34;18081:18081\u0026#34; volumes: - \u0026#34;./nginx/nginx.conf:/etc/nginx/nginx.conf\u0026#34; - \u0026#34;./nginx/html:/usr/share/nginx/html\u0026#34; depends_on: - hmall networks: - hm-net networks: hm-net: name: hmall ","permalink":"https://kennems.github.io/posts/tech/docker/","summary":"Docker å¿«é€Ÿæ„å»ºã€è¿è¡Œã€ç®¡ç†åº”ç”¨çš„å·¥å…· Dockeræ‰“å°æ‰€æœ‰å®¹å™¨ï¼ˆåŒ…æ‹¬å…³é—­çš„ï¼‰ docker ps -a æ­£åœ¨è¿è¡Œçš„ docker ps åˆ é™¤å®¹å™¨ docker rm \u0026lt;container_id\u0026gt; å¯åŠ¨å·²æœ‰çš„å®¹å™¨ docker start \u0026lt;å®¹å™¨IDæˆ–","title":"Docker"},{"content":"è‹ç©¹å¤–å–åç«¯å¼€å‘(Day1) è½¯ä»¶å¼€å‘æµç¨‹ éœ€æ±‚åˆ†æ ï¼š éœ€æ±‚è§„æ ¼è¯´æ˜è¯´ã€äº§å“åŸå‹\nè®¾è®¡ ï¼š UIè®¾è®¡ã€ æ•°æ®åº“è®¾è®¡ã€æ¥å£è®¾è®¡\nç¼–ç  ï¼š é¡¹ç›®ä»£ç ã€å•å…ƒæµ‹è¯•\næµ‹è¯• ï¼š æµ‹è¯•ç”¨ä¾‹ã€æµ‹è¯•æŠ¥å‘Š\nä¸Šçº¿è¿ç»´ ï¼š è½¯ä»¶ç¯å¢ƒå®‰è£…ã€é…ç½®\nè§’è‰²åˆ†å·¥ é¡¹ç›®ç»ç†ï¼šå¯¹æ•´ä¸ªé¡¹ç›®è´Ÿè´£ï¼Œä»»åŠ¡åˆ†é…ï¼ŒæŠŠæ§è¿›åº¦ã€‚ äº§å“ç»ç†ï¼šè¿›è¡Œéœ€æ±‚è°ƒç ”ï¼Œè¾“å‡ºéœ€æ±‚è°ƒç ”æ–‡æ¡£ã€äº§å“åŸå‹ç­‰ UIè®¾è®¡å¸ˆï¼šæ ¹æ®äº§å“åŸå‹è¾“å‡ºç•Œé¢æ•ˆæœå›¾ æ¶æ„å¸ˆï¼šé¡¹ç›®æ•´ä½“æ¶æ„è®¾è®¡ã€æŠ€æœ¯é€‰å‹ç­‰ å¼€å‘å·¥ç¨‹å¸ˆï¼šä»£ç å®ç° æµ‹è¯•å·¥ç¨‹å¸ˆï¼šç¼–å†™æµ‹è¯•ç”¨ä¾‹ï¼Œè¾“å‡ºæµ‹è¯•æŠ¥å‘Š è¿ç»´å·¥ç¨‹å¸ˆï¼šè½¯ä»¶ç¯å¢ƒæ­å»ºï¼Œé¡¹ç›®ä¸Šçº¿ è½¯ä»¶ç¯å¢ƒ å¼€å‘ç¯å¢ƒï¼ˆdevelopmentï¼‰ï¼šå¼€å‘äººå‘˜åœ¨å¼€å‘é˜¶æ®µä½¿ç”¨çš„ç¯å¢ƒï¼Œä¸€èˆ¬å¤–éƒ¨ç”¨æˆ·æ— æ³•è®¿é—® æµ‹è¯•ç¯å¢ƒï¼ˆtestingï¼‰ï¼šä¸“é—¨ç»™æµ‹è¯•äººå‘˜ä½¿ç”¨çš„ç¯å¢ƒï¼Œç”¨äºæµ‹è¯•é¡¹ç›®ï¼Œä¸€èˆ¬å¤–éƒ¨ç”¨æˆ·æ— æ³•è®¿é—® ç”Ÿäº§ç¯å¢ƒï¼ˆproductionï¼‰ï¼šå³çº¿ä¸Šç¯å¢ƒï¼Œæ­£å¼æä¾›å¯¹å¤–æœåŠ¡çš„ç¯å¢ƒã€‚ è‹ç©¹å¤–å–é¡¹ç›®ä»‹ç» é¡¹ç›®ä»‹ç» å®šä½ ï¼š ä¸“é—¨ä¸ºé¤é¥®ä¼ä¸šï¼ˆé¤å…ã€é¥­åº—ï¼‰å®šåˆ¶çš„ä¸€æ¬¾è½¯ä»¶äº§å“\näº§å“åŸå‹ äº§å“åŸå‹ ï¼šç”¨äºå±•ç¤ºé¡¹ç›®çš„ä¸šåŠ¡åŠŸèƒ½ï¼Œä¸€èˆ¬ç”±äº§å“ç»ç†è¿›è¡Œè®¾è®¡\næŠ€æœ¯é€‰å‹ æŠ€æœ¯é€‰å‹ ï¼š å±•ç¤ºé¡¹ç›®ä¸­ä½¿ç”¨åˆ°çš„æŠ€æœ¯æ¡†æ¶å’Œä¸­é—´ä»¶ç­‰ã€‚\næ•´ä½“ç»“æ„ å‰ç«¯ç¯å¢ƒæ­å»º NginxæœåŠ¡å™¨ åç«¯ç¯å¢ƒæ­å»º åç«¯å·¥ç¨‹åŸºäºmavenè¿›è¡Œé¡¹ç›®æ„å»ºï¼Œå¹¶ä¸”è¿›è¡Œåˆ†æ¨¡å—å¼€å‘\nsky-take-out : maven çˆ¶å·¥ç¨‹ï¼Œ ç»Ÿä¸€ç®¡ç†ä¾èµ–ç‰ˆæœ¬ï¼Œ èšåˆå…¶ä»–å­æ¨¡å— sky-common : å­æ¨¡å—ï¼Œ å­˜æ”¾å…¬å…±ç±»ï¼Œä¾‹å¦‚ ï¼š å·¥å…·ç±»ã€å¸¸é‡ç±»ã€å¼‚å¸¸ç±»ç­‰ sky-pojo : å­æ¨¡å— ï¼Œå­˜æ”¾å®ä½“ç±»ï¼ŒVOï¼Œ DTOç­‰ åç§° è¯´æ˜ Entity å®ä½“ï¼Œé€šç”¨å’Œæ•°æ®åº“ä¸­çš„å¯¹åº” DTO æ•°æ®ä¼ è¾“å¯¹è±¡ï¼Œé€šç”¨ç”¨ç¨‹åºä¸­å„å±‚ä¹‹é—´ä¼ é€’æ•°æ® VO è§†å›¾å¯¹è±¡ï¼Œä¸ºå‰ç«¯å±•ç¤ºæ•°æ®æä¾›çš„å¯¹è±¡ POJO æ™®é€šJavaå¯¹è±¡ï¼Œåªæœ‰å±æ€§å’Œå¯¹åº”çš„getterå’Œsetter sky-server : å­æ¨¡å—ï¼Œåç«¯æœåŠ¡ï¼Œå­˜æ”¾é…ç½®æ–‡ä»¶, é…ç½®ç±»ï¼Œæ‹¦æˆªå™¨ï¼ŒControllerï¼Œ Serviceï¼Œ Mapperç­‰ æ•°æ®åº“ç¯å¢ƒæ­å»º MySQL + Navicat\nåç«¯ç¯å¢ƒæ­å»º - å‰åç«¯è”è°ƒ åç«¯çš„åˆå§‹å·¥ç¨‹ä¸­å·²ç»å®ç°äº†ç™»å½•åŠŸèƒ½ï¼Œ ç›´æ¥è¿›è¡Œå‰åç«¯è”è°ƒæµ‹è¯•å³å¯ã€‚\nå‰åç«¯è¯·æ±‚åœ°å€ä¸å¯¹åº”ï¼Œä½†æ˜¯å‰åç«¯è”è°ƒæˆåŠŸ\nnginxåå‘ä»£ç†ï¼Œ å°±æ˜¯è®²å‰ç«¯å‘é€çš„åŠ¨æ€è¯·æ±‚ç”±nginxè½¬å‘åˆ°åç«¯æœåŠ¡å™¨\nnginxåå‘ä»£ç†çš„å¥½å¤„ï¼š\næé«˜è®¿é—®é€Ÿåº¦ è¿›è¡Œè´Ÿè½½å‡è¡¡ ä¿è¯åç«¯æœåŠ¡å®‰å…¨ nginxè´Ÿè½½å‡è¡¡ç­–ç•¥ï¼š\nåç§° è¯´æ˜ è½®è¯¢ é»˜è®¤ä¸ºæ–¹å¼ weight æƒé‡æ–¹å¼ï¼Œé»˜è®¤ä¸ºï¼Œæƒé‡è¶Šé«˜ï¼Œè¢«åˆ†é…çš„å®¢æˆ·ç»ˆç«¯èµ„æºå°±è¶Šå¤š ip_hash ä¾èµ–äºIPåœ°å€åˆ†é…ï¼Œè¿™æ ·æ¯ä¸ªè®¿å®¢å¯ä»¥å›ºå®šè®¿é—®åŒä¸€ä¸ªåç«¯æœåŠ¡ least_conn ä¾èµ–äºè¿æ¥æ•°ï¼ŒæŠŠè¯·æ±‚ä¼˜å…ˆåˆ†é…åˆ°è¿æ¥æ•°æœ€å°‘çš„åç«¯æœåŠ¡ url_hash ä¾èµ–äºè¯·æ±‚çš„URLï¼Œè¿™æ ·è¯·æ±‚å¯¹åº”çš„æœåŠ¡åç§°ä¼šè¢«ä¼˜å…ˆåˆ†é… fair ä¾èµ–äºå“åº”æ—¶é—´ï¼Œå“åº”æ—¶é—´è¶ŠçŸ­çš„æœåŠ¡å°†è¢«ä¼˜å…ˆåˆ†é… å®Œå–„ç™»å½•åŠŸèƒ½ å°†å¯†ç åŠ å¯†åå­˜å‚¨ï¼Œæé«˜å®‰å…¨æ€§\nå°†åç»­éœ€è¦å®Œå–„çš„ä»£ç ç”¨ TODO æ ‡è¯†å‡ºæ¥\npassword = DigestUtils.md5DigestAsHex(password.getBytes()); å¯¼å…¥æ¥å£æ–‡æ¡£ ä½¿ç”¨apifoxå¯¼å…¥jsonæ–‡ä»¶\nSwagger æµ‹è¯•å·¥å…·\nä½¿ç”¨Swaggeråªéœ€è¦æŒ‰ç…§å®ƒçš„è§„èŒƒå»å®šä¹‰æ¥å£ä»¥åŠæ¥å£ç›¸å…³çš„ä¿¡æ¯ï¼Œå°±å¯ä»¥åšåˆ°ç”Ÿæˆæ¥å£æ–‡æ¡£ï¼Œä»¥åŠåœ¨çº¿æ¥å£è°ƒè¯•é¡µé¢\nKnife4j æ˜¯ä¸º Java MVC æ¡†æ¶é›†æˆSwaggerç”Ÿæˆ Api æ–‡æ¡£çš„å¢å¼ºè§£å†³æ–¹æ¡ˆã€‚\n1ã€å¯¼å…¥knife4jåæ ‡\n\u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.github.xiaoymin\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;knife4j-spring-boot-starter\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;3.0.2\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; 2ã€åœ¨é…ç½®ç±»ä¸­åŠ å…¥knife4jç›¸å…³é…ç½®\n@Bean public Docket docket() { ApiInfo apiInfo = new ApiInfoBuilder() .title(\u0026#34;è‹ç©¹å¤–å–é¡¹ç›®æ¥å£æ–‡æ¡£\u0026#34;) .version(\u0026#34;2.0\u0026#34;) .description(\u0026#34;è‹ç©¹å¤–å–é¡¹ç›®æ¥å£æ–‡æ¡£\u0026#34;) .build(); Docket docket = new Docket(DocumentationType.SWAGGER_2) .apiInfo(apiInfo) .select() // æŒ‡å®šç”Ÿæˆæ¥å£éœ€è¦æ‰«æçš„åŒ… .apis(RequestHandlerSelectors.basePackage(\u0026#34;com.sky.controller\u0026#34;)) .paths(PathSelectors.any()) .build(); return docket; } 3ã€è®¾ç½®é™æ€èµ„æºæ˜ å°„ï¼Œå¦åˆ™æ¥å£æ–‡æ¡£é¡µé¢æ— æ³•è®¿é—®\n/** * è®¾ç½®é™æ€èµ„æºæ˜ å°„ * @param registry */ protected void addResourceHandlers(ResourceHandlerRegistry registry) { log.info(\u0026#34;å¼€å§‹è®¾ç½®é™æ€èµ„æºæ˜ å°„...\u0026#34;); registry.addResourceHandler(\u0026#34;/doc.html\u0026#34;).addResourceLocations(\u0026#34;classpath:/META-INF/resources/\u0026#34;); registry.addResourceHandler(\u0026#34;/webjars/**\u0026#34;).addResourceLocations(\u0026#34;classpath:/META-INF/resources/webjars/\u0026#34;); } YAPI(ApiFox)ç”¨äºè®¾è®¡æ¥å£æ—¶ä½¿ç”¨ï¼Œ è€ŒSwaggerç”¨äºåç«¯å¼€å‘å¥½ä¹‹åæµ‹è¯•ä½¿ç”¨ã€‚\nå¸¸ç”¨æ³¨è§£ æ³¨è§£ è¯´æ˜ @Api ç”¨åœ¨ç±»ä¸Šï¼Œä¾‹å¦‚Controllerï¼Œè¡¨ç¤ºå¯¹ç±»çš„è¯´æ˜ @ApiModel ç”¨åœ¨ç±»ä¸Šï¼Œä¾‹å¦‚entityã€DTOã€VO @ApiModelProperty ç”¨åœ¨å±æ€§ä¸Šï¼Œæè¿°å±æ€§ä¿¡æ¯ @ApiOperation ç”¨åœ¨æ–¹æ³•ä¸Šï¼Œä¾‹å¦‚Controllerçš„æ–¹æ³•ï¼Œè¯´æ˜æ–¹æ³•çš„ç”¨é€”ã€ä½œç”¨ ","permalink":"https://kennems.github.io/posts/tech/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91day1/","summary":"è‹ç©¹å¤–å–åç«¯å¼€å‘(Day1) è½¯ä»¶å¼€å‘æµç¨‹ éœ€æ±‚åˆ†æ ï¼š éœ€æ±‚è§„æ ¼è¯´æ˜è¯´ã€äº§å“åŸå‹ è®¾è®¡ ï¼š UIè®¾è®¡ã€ æ•°æ®åº“è®¾è®¡ã€æ¥å£è®¾è®¡ ç¼–ç  ï¼š é¡¹ç›®ä»£ç ã€å•å…ƒæµ‹è¯• æµ‹è¯• ï¼š","title":"è‹ç©¹å¤–å–åç«¯å¼€å‘(Day1)"},{"content":"Prompt è¦æ±‚ï¼šå­—æ•°å°½å¯èƒ½å¤šï¼Œå†…å®¹éœ€è¦å…¨é¢ï¼Œå¯ä»¥ä¸æŒ‰ç…§æˆ‘çš„æ ‡é¢˜æ¥å†™ï¼Œå¯ä»¥é€‚å½“æ·»åŠ ä¸€äº›å†…å®¹ï¼Œä½†æ˜¯å†…å®¹ä¸€å®šä¸€å®šè¦å¤šï¼Œè¦ä¸“ä¸š è¯·æ ¹æ®ä»¥ä¸Šå†…å®¹ä»¥åŠä½ çš„æ•°æ®åº“å†…å®¹ï¼Œæ’°å†™ ï¼š æ•°æ®å¤„ç†ä¸åˆ†æ æµ·æµªæ³¢è°±ä»ªé‡‡é›†çš„æ•°æ®éœ€è¦ç»è¿‡å¤æ‚çš„å¤„ç†ä¸åˆ†æï¼Œæ‰èƒ½ç”Ÿæˆæœ‰ç”¨çš„æ³¢è°±å›¾ã€‚æ•°æ®å¤„ç†è¿‡ç¨‹åŒ…æ‹¬å»å™ªã€æ»¤æ³¢ã€é¢‘è°±åˆ†æç­‰æ­¥éª¤ã€‚å¸¸ç”¨çš„é¢‘è°±åˆ†ææ–¹æ³•åŒ…æ‹¬å¿«é€Ÿå‚…é‡Œå¶å˜æ¢ï¼ˆFFTï¼‰å’Œå°æ³¢å˜æ¢ç­‰ã€‚é€šè¿‡å¯¹æµ·æµªé¢‘è°±çš„åˆ†æï¼Œå¯ä»¥æå–å‡ºæµ·æµªçš„ä¸»å¯¼é¢‘ç‡ã€æ³¢é«˜åˆ†å¸ƒã€èƒ½é‡è°±ç­‰é‡è¦ä¿¡æ¯ã€‚\rè¯¦ç»† æˆ‘ç°åœ¨éœ€è¦å†™å®éªŒæŠ¥å‘Šï¼Œè¯·ç¼©å†™ä¸Šéƒ¨åˆ†å†…å®¹ï¼Œä½†æ˜¯ä¸è¦æŸå¤±å…¶è¡¨è¾¾çš„æ„æ€ æ–‡ç« ç”Ÿæˆ â€œæˆ‘æƒ³å†™ä¸€ç¯‡ç§‘æ™®æ–‡ç« ï¼Œæ ‡é¢˜æ˜¯ï¼šâ€˜[åœ¨æ­¤å¤„æ’å…¥ä½ çš„æ ‡é¢˜]â€™ã€‚ä½ èƒ½å¸®æˆ‘åˆ†æä¸€ä¸‹è¿™ä¸ªæ ‡é¢˜å—ï¼Ÿå®ƒæ˜¯å¦æœ‰å¸å¼•åŠ›ï¼Œæœ‰æ²¡æœ‰å¯ä»¥æ”¹è¿›çš„åœ°æ–¹æ¥å¢å¼ºå…¶å¸å¼•åŠ›ï¼Ÿâ€\ræ–‡ç« ç”Ÿæˆï¼š\râ€œåœ¨ä¼˜åŒ–æ ‡é¢˜åï¼Œå¸®æˆ‘ç”Ÿæˆä¸€ç¯‡æ–‡ç« ã€‚æ–‡ç« çš„ç›®æ ‡æ˜¯å‘è¯»è€…ç§‘æ™®å…³äº[æ’å…¥ä¸»é¢˜]çš„çŸ¥è¯†ã€‚è¯·ç¡®ä¿å†…å®¹æ˜“äºæ™®é€šè¯»è€…ç†è§£ï¼ŒåŒæ—¶ä¿æŒç§‘å­¦çš„å‡†ç¡®æ€§å’Œè¶£å‘³æ€§ã€‚æ–‡ç« åº”åŒ…æ‹¬ä»¥ä¸‹éƒ¨åˆ†ï¼šå¼•è¨€ã€å®šä¹‰ã€ç¤ºä¾‹ã€ç°å®åº”ç”¨ä»¥åŠç»“è®ºã€‚è¯­æ°”è¦ä¿æŒä¿¡æ¯æ€§ï¼Œä½†å°½é‡äº²åˆ‡ã€æ˜“æ‡‚ã€‚â€ æœ—è¯»å†…å®¹ å…ˆé‡å¤ä¸‹é¢çš„å†…å®¹ï¼Œç„¶ååŠ ä¸€ä¸ªç®€çŸ­çš„æ€»ç»“ Leetcodeé¢˜ç›®æ€»ç»“ ä¸‹é¢æˆ‘ç»™å‡ºä¸€ä¸ªé¢˜ç›®ï¼Œä»£ç å®ç°ï¼Œå’Œå¯¹é¢˜ç›®çš„æ€»ç»“å’Œå®ç°æ€è·¯ï¼Œ ä½ éœ€è¦çš„æ˜¯å­¦ä¹ æˆ‘æ˜¯å¦‚ä½•æ€»ç»“çš„ï¼Œå¦‚æœä½ çœ‹æ‡‚äº†åˆ™å›å¤æˆ‘ä½ æ‡‚äº†, ä¸ç”¨å›å¤åˆ«çš„\r\u0026#34;\u0026#34;\u0026#34;\rç»™ä½ ä¸€ä¸ª n ä¸ªèŠ‚ç‚¹çš„æ ‘ï¼ˆä¹Ÿå°±æ˜¯ä¸€ä¸ªæ— ç¯è¿é€šæ— å‘å›¾ï¼‰ï¼ŒèŠ‚ç‚¹ç¼–å·ä» 0 åˆ° n - 1 ï¼Œä¸”æ°å¥½æœ‰ n - 1 æ¡è¾¹ï¼Œæ¯ä¸ªèŠ‚ç‚¹æœ‰ä¸€ä¸ªå€¼ã€‚æ ‘çš„ æ ¹èŠ‚ç‚¹ ä¸º 0 å·ç‚¹ã€‚\rç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ nums å’Œä¸€ä¸ªäºŒç»´æ•°ç»„ edges æ¥è¡¨ç¤ºè¿™æ£µæ ‘ã€‚nums[i] è¡¨ç¤ºç¬¬ i ä¸ªç‚¹çš„å€¼ï¼Œedges[j] = [uj, vj] è¡¨ç¤ºèŠ‚ç‚¹ uj å’ŒèŠ‚ç‚¹ vj åœ¨æ ‘ä¸­æœ‰ä¸€æ¡è¾¹ã€‚\rå½“ gcd(x, y) == 1 ï¼Œæˆ‘ä»¬ç§°ä¸¤ä¸ªæ•° x å’Œ y æ˜¯ äº’è´¨çš„ ï¼Œå…¶ä¸­ gcd(x, y) æ˜¯ x å’Œ y çš„ æœ€å¤§å…¬çº¦æ•° ã€‚\rä»èŠ‚ç‚¹ i åˆ° æ ¹ æœ€çŸ­è·¯å¾„ä¸Šçš„ç‚¹éƒ½æ˜¯èŠ‚ç‚¹ i çš„ç¥–å…ˆèŠ‚ç‚¹ã€‚ä¸€ä¸ªèŠ‚ç‚¹ ä¸æ˜¯ å®ƒè‡ªå·±çš„ç¥–å…ˆèŠ‚ç‚¹ã€‚\rè¯·ä½ è¿”å›ä¸€ä¸ªå¤§å°ä¸º n çš„æ•°ç»„ ans ï¼Œå…¶ä¸­ ans[i]æ˜¯ç¦»èŠ‚ç‚¹ i æœ€è¿‘çš„ç¥–å…ˆèŠ‚ç‚¹ä¸”æ»¡è¶³ nums[i] å’Œ nums[ans[i]] æ˜¯ äº’è´¨çš„ ï¼Œå¦‚æœä¸å­˜åœ¨è¿™æ ·çš„ç¥–å…ˆèŠ‚ç‚¹ï¼Œans[i] ä¸º -1 ã€‚\rç¤ºä¾‹ 1ï¼š\rè¾“å…¥ï¼šnums = [2,3,3,2], edges = [[0,1],[1,2],[1,3]]\rè¾“å‡ºï¼š[-1,0,0,1]\rè§£é‡Šï¼šä¸Šå›¾ä¸­ï¼Œæ¯ä¸ªèŠ‚ç‚¹çš„å€¼åœ¨æ‹¬å·ä¸­è¡¨ç¤ºã€‚\r- èŠ‚ç‚¹ 0 æ²¡æœ‰äº’è´¨ç¥–å…ˆã€‚\r- èŠ‚ç‚¹ 1 åªæœ‰ä¸€ä¸ªç¥–å…ˆèŠ‚ç‚¹ 0 ã€‚å®ƒä»¬çš„å€¼æ˜¯äº’è´¨çš„ï¼ˆgcd(2,3) == 1ï¼‰ã€‚\r- èŠ‚ç‚¹ 2 æœ‰ä¸¤ä¸ªç¥–å…ˆèŠ‚ç‚¹ï¼Œåˆ†åˆ«æ˜¯èŠ‚ç‚¹ 1 å’ŒèŠ‚ç‚¹ 0 ã€‚èŠ‚ç‚¹ 1 çš„å€¼ä¸å®ƒçš„å€¼ä¸æ˜¯äº’è´¨çš„ï¼ˆgcd(3,3) == 3ï¼‰ä½†èŠ‚ç‚¹ 0 çš„å€¼æ˜¯äº’è´¨çš„(gcd(2,3) == 1)ï¼Œæ‰€ä»¥èŠ‚ç‚¹ 0 æ˜¯æœ€è¿‘çš„ç¬¦åˆè¦æ±‚çš„ç¥–å…ˆèŠ‚ç‚¹ã€‚\r- èŠ‚ç‚¹ 3 æœ‰ä¸¤ä¸ªç¥–å…ˆèŠ‚ç‚¹ï¼Œåˆ†åˆ«æ˜¯èŠ‚ç‚¹ 1 å’ŒèŠ‚ç‚¹ 0 ã€‚å®ƒä¸èŠ‚ç‚¹ 1 äº’è´¨ï¼ˆgcd(3,2) == 1ï¼‰ï¼Œæ‰€ä»¥èŠ‚ç‚¹ 1 æ˜¯ç¦»å®ƒæœ€è¿‘çš„ç¬¦åˆè¦æ±‚çš„ç¥–å…ˆèŠ‚ç‚¹ã€‚\rç¤ºä¾‹ 2ï¼š\rè¾“å…¥ï¼šnums = [5,6,10,2,3,6,15], edges = [[0,1],[0,2],[1,3],[1,4],[2,5],[2,6]]\rè¾“å‡ºï¼š[-1,0,-1,0,0,0,-1]\ræç¤ºï¼š\rnums.length == n\r1 \u0026lt;= nums[i] \u0026lt;= 50\r1 \u0026lt;= n \u0026lt;= 105\redges.length == n - 1\redges[j].length == 2\r0 \u0026lt;= uj, vj \u0026lt; n\ruj != vj\rä»£ç å®ç°ï¼š\rclass Solution:\rdef getCoprimes(self, nums: List[int], edges: List[List[int]]) -\u0026gt; List[int]:\rn = len(nums)\rg = [[]*n for _ in range(n)]\rret = [-1]*n\rstore = [[] for _ in range(51)]\rmem = [(-1, -1)]*(51) for i in range(1, 51):\rfor j in range(1, 51):\rif gcd(i, j)==1:\rstore[i].append(j)\rfor u, v in edges:\rg[u].append(v)\rg[v].append(u)\rdef dfs(u, last, level):\rret[u] = max(mem[i] for i in store[nums[u]])[1]\rtmp = mem[nums[u]]\rmem[nums[u]] = (level, u)\rfor son in g[u]:\rif son==last:\rcontinue\rdfs(son, u, level+1)\rmem[nums[u]] = tmp\rdfs(0, -1, 0)\rreturn ret\r\u0026#34;\u0026#34;\u0026#34; å¥½çš„ï¼Œä½ ç°åœ¨éœ€è¦åšçš„æ˜¯ ï¼š æˆ‘ç»™ä½ å…¶ä»–é¢˜ç›®ï¼Œå¹¶ç»™å‡ºå·²ç»ACçš„ä»£ç å®ç°ï¼Œä½ éœ€è¦è¡¥å……ï¼š1ã€é¢˜ç›®å¤§æ„ 2ã€å®ç°æ€è·¯\rå¦‚æœä½ å·²ç»äº†è§£äº†æˆ‘çš„éœ€æ±‚ï¼Œè¯·å›å¤æˆ‘æ‡‚äº† ","permalink":"https://kennems.github.io/posts/tech/prompt/","summary":"Prompt è¦æ±‚ï¼šå­—æ•°å°½å¯èƒ½å¤šï¼Œå†…å®¹éœ€è¦å…¨é¢ï¼Œå¯ä»¥ä¸æŒ‰ç…§æˆ‘çš„æ ‡é¢˜æ¥å†™ï¼Œå¯ä»¥é€‚å½“æ·»åŠ ä¸€äº›å†…å®¹ï¼Œä½†æ˜¯å†…å®¹ä¸€å®šä¸€å®šè¦å¤šï¼Œè¦ä¸“ä¸š è¯·æ ¹æ®ä»¥ä¸Šå†…å®¹ä»¥åŠä½ çš„æ•°æ®åº“å†…","title":"Prompt"},{"content":"MIT6.S081(13)-Coordination (sleep\u0026amp;wakeup) plan Re-emphasize a few points about xv6 thread switching sequence coordination sleep \u0026amp; wakeup lost wakeup problem termination\nWhy hold p-\u0026gt;lock across swtch()? this is an important point and affects many situations in xv6 [diagram: P1, STACK1, swtch, STACK_SCHED] yield:\nacquire(\u0026amp;p-\u0026gt;lock); p-\u0026gt;state = RUNNABLE; swtch(); scheduler:\nswtch(); release(\u0026amp;p-\u0026gt;lock); the main point of holding p-\u0026gt;lock across swtch(): prevent another core\u0026rsquo;s scheduler from seeing p-\u0026gt;state == RUNNABLE until after the original core has stopped executing the thread and after the original core has stopped using the thread\u0026rsquo;s stack\nWhy does sched() forbid spinlocks from being held when yielding the CPU? (other than p-\u0026gt;lock) i.e. sched() checks that noff == 1 on a single-core machine, imagine this:\nP1 P2\racq(L)\rsched()\racq(L) this is a deadlock: P2 will spin until P1 releases \u0026ndash; and P2 won\u0026rsquo;t yield the CPU but P1 won\u0026rsquo;t release until it runs again with multiple cores, deadlock can also arise; more spinlocks must be involved solution: do not hold spinlocks and yield the CPU!\ntopic: sequence coordination threads need to wait for specific events or conditions: wait for disk read to complete (event is from an interrupt) wait for pipe writer to produce data (event is from a thread) wait for any child to exit\ncoordination is a fundamental building-block for thread programming.\noften straightforward to use. but (like locks) subject to rules that sometimes present difficult puzzles.\nwhy not just have a while-loop that spins until event happens? pipe read:\nwhile buffer is empty {\r} pipe write:\nput data in buffer better solution: coordination primitives that yield the CPU\nthere are a bunch e.g. barriers, semaphores, event queues. xv6 uses sleep \u0026amp; wakeup\nexample: uartwrite() and uartintr() in uart.c I have modified these functions! not the same as default xv6 see \u0026ldquo;code\u0026rdquo; link on schedule page the basic idea: the UART can only accept one (really a few) bytes of output at a time takes a long time to send each byte, perhaps millisecond processes writing the console must wait until UART sends prev char the UART interrupts after it has sent each character writing thread should give up the CPU until then write() calls uartwrite() uartwrite() writes first byte (if it can) uartwrite() calls sleep() to wait for the UART\u0026rsquo;s interrupt uartintr() calls wakeup() the \u0026ldquo;\u0026amp;tx_chan\u0026rdquo; argument serves to link the sleep and wakeup simple and flexible: sleep/wakeup don\u0026rsquo;t need to understand what you\u0026rsquo;re waiting for no need to allocate explicit coordination objects\nWhy the lock argument to sleep()? sadly you cannot design sleep() as cleanly as you might hope sleep() cannot simply be \u0026ldquo;wait for this event\u0026rdquo; the problem is called \u0026ldquo;lost wakeups\u0026rdquo; it lurks behind all sequence coordination schemes, and is a pain here\u0026rsquo;s the story\nsuppose just sleep(chan); how would we implement? here\u0026rsquo;s a BROKEN sleep/wakeup broken_sleep(chan) sleeps on a \u0026ldquo;channel\u0026rdquo;, a number/address identifies the condition/event we are waiting for\np-\u0026gt;state = SLEEPING;\rp-\u0026gt;chan = chan;\rsched();\rwakeup(chan) â€‹ wakeup wakes up all threads sleeping on chan â€‹ may wake up more than one thread\nfor each p:\rif p-\u0026gt;state == SLEEPING \u0026amp;\u0026amp; p-\u0026gt;chan == chan:\rp-\u0026gt;state = RUNNABLE how would uart code use this (broken) sleep/wakeup? int done uartwrite(buf): for each char c: while not done: sleep(\u0026amp;done) send c done = false uartintr(): done = true wakeup(\u0026amp;done) done==true is the condition we\u0026#39;re waiting for \u0026amp;done is the sleep channel (not really related to the condition)\nbut what about locking? driver\u0026rsquo;s data structures e.g. done\nUART hardware\nboth uartwrite() and uartintr() need to lock should uartwrite() hold a lock for the whole sequence? no: then uartintr() can\u0026rsquo;t get lock and set done maybe uartwrite() could release the lock before sleep()? let\u0026rsquo;s try it \u0026ndash; modify uart.c to call broken_sleep()\nrelease(\u0026amp;uart_tx_lock); broken_sleep(\u0026amp;tx_chan); acquire(\u0026amp;uart_tx_lock); what goes wrong when uartwrite() releases the lock before broken_sleep()? uartwrite() saw that the previous character wasn\u0026rsquo;t yet done being sent interrupt occurred after release(), before broken_sleep() uartwrite() went to sleep EVEN THOUGH UART TX WAS DONE now there is nothing to wake up uartwrite(), it will sleep forever\nthis is the \u0026ldquo;lost wakeup\u0026rdquo; problem.\nwe need to eliminate the window between uartwrite()\u0026rsquo;s check of the condition, and sleep() marking the process as asleep. we\u0026rsquo;ll use locks to prevent wakeup() from running during the entire window.\nwe\u0026rsquo;ll change the sleep() interface and the way it\u0026rsquo;s used. we\u0026rsquo;ll require that there be a lock that protects the condition, and that the callers of both sleep() and wakeup() hold the \u0026ldquo;condition lock\u0026rdquo; sleep(chan, lock) caller must hold lock sleep releases lock, re-acquires before returning wakeup(chan) caller must hold lock (repair uart.c)\nlet\u0026rsquo;s look at wakeup(chan) in proc.c it scans the process table, looking for SLEEPING and chan it grabs each p-\u0026gt;lock remember also that caller acquired condition lock before calling wakeup() so wakeup() holds BOTH the condition lock and each p-\u0026gt;lock\nlet\u0026rsquo;s look at sleep() in proc.c sleep must release the condition lock since we can\u0026rsquo;t hold locks when calling swtch(), other than p-\u0026gt;lock\nQ: how can sleep() prevent wakeup() from running after it releases the condition lock? A: acquire p-\u0026gt;lock before releasing condition lock since wakeup() holds both locks, it\u0026rsquo;s enough for sleep() to hold either in order to force wakeup() to spin rather than look at this process now wakeup() can\u0026rsquo;t proceed until after swtch() completes so wakeup() is guaranteed to see p-\u0026gt;state==SLEEPING and p-\u0026gt;chan==chan thus: no lost wakeups!\nnote that uartwrite() wraps the sleep() in a loop i.e. re-checks the condition after sleep() returns, may sleep again\ntwo reasons: â€‹ maybe multiple waiters, another thread might have consumed the event â€‹ kill() wakes up processes even when condition isn\u0026rsquo;t true all uses of sleep are wrapped in a loop, so they re-check\nAnother example: piperead() the condition is data waiting to be read (nread != nwrite) pipewrite() calls wakeup() at the end what is the race if piperead() used broken_sleep()? note the the loop around sleep() multiple processes may be reading the same pipe why the wakeup() at the end of piperead()?\nthe sleep/wakeup interface/rules are a little complex sleep() doesn\u0026rsquo;t need to understand the condition, but it needs the condition lock sleep/wakeup is pretty flexible, though low-level there are other schemes that are cleaner but perhaps less general-purpose e.g. the counting semaphore in today\u0026rsquo;s reading all have to cope with lost wakeups, one way or another\nanother coordination challenge \u0026ndash; how to terminate a thread? a puzzle: we want need to free resources that might still be in use\nproblem: thread X cannot just destroy thread Y what if Y is executing on another core? what if Y holds locks? what if Y is in the middle of a complex update to important data structures?\nproblem: a thread cannot free all of its own resources e.g. its own stack, which it is still using e.g. its struct context, which it may need to call swtch()\nxv6 has two ways to get rid of processes: exit() and kill() ordinary case: process voluntarily quits with exit() system call some freeing in exit(), some in parent\u0026rsquo;s wait() exit() in proc.c:\nclose open files\rchange parent of children to PID 1 (init)\rwake up wait()ing parent\rp-\u0026gt;state = ZOMBIE â€‹ dying but not yet dead â€‹ won\u0026rsquo;t run again â€‹ won\u0026rsquo;t (yet) be re-allocated by fork(), eitheÂ·r â€‹ (note stack and proc[] entry are still allocated\u0026hellip;) â€‹ swtch() to scheduler wait() in proc.c (parent, or init, will eventually call): â€‹ sleep()s waiting for any child exit() â€‹ scans proc[] table for children with p-\u0026gt;state==ZOMBIE â€‹ calls freeproc() â€‹ (p-\u0026gt;lock held\u0026hellip;) â€‹ trapframe, pagetable, \u0026hellip;, p-\u0026gt;state=UNUSED thus: wait() is not just for app convenience, but for O/S as well â€‹ every process must be wait()ed for â€‹ thus the re-parenting of children of an exiting process some complexity due to â€‹ child exits concurrently with its own parent â€‹ parent-then-child locking order to avoid deadlock\nwhat about kill(pid)? problem: may not be safe to forcibly terminate a process it might be executing in the kernel using its kernel stack, page table, proc[] entry, trapframe it might hold locks e.g. in the middle of fork()ing a new process and must finish to restore invariants so: kill() can\u0026rsquo;t directly destroy the target! solution: kill() sets p-\u0026gt;killed flag, nothing else the target process itself checks for p-\u0026gt;killed and calls exit() itself look for \u0026ldquo;if(p-\u0026gt;killed) exit(-1);\u0026rdquo; in usertrap() no locks are held at that point so it\u0026rsquo;s safe to exit()\nwhat if kill() target is sleep()ing? in that case it doesn\u0026rsquo;t hold locks, and isn\u0026rsquo;t executing! is it OK for kill() destroy the target right away? might be OK: waiting for console input might not be OK: waiting for disk midway through file creation\nxv6 solution to kill() of sleep()ing process see kill() in proc.c changes SLEEPING to RUNNABLE \u0026ndash; like wakeup() so sleep() will return, probably before condition is true some sleep loops check for p-\u0026gt;killed e.g. piperead(), consoleread() otherwise read could hang indefinitely for a killed process some sleep loops don\u0026rsquo;t check p-\u0026gt;killed e.g. virtio_disk.c OK not to check p-\u0026gt;killed since disk reads are pretty quick so a kill()ed process may continue for a while but usertrap() will exit() after the system call finishes\nxv6 spec for kill if target is in user space will die next time it makes a system call or takes a timer interrupt if target is in the kernel target will never execute another user instruction but may spend quite a while yet in the kernel\nSummary sleep/wakeup let threads wait for specific events concurrency means we have to worry about lost wakeups termination is a pain in threading systems\nLab: locks Memory allocator (moderate) ä¼˜åŒ–xv6çš„å†…å­˜åˆ†é…å™¨ï¼Œå‡å°‘é”äº‰ç”¨ã€‚å½“å‰çš„å®ç°ä½¿ç”¨ä¸€ä¸ªå…¨å±€çš„è‡ªç”±åˆ—è¡¨å’Œå•ä¸€çš„é”ä¿æŠ¤ï¼Œå¯¼è‡´å¤šæ ¸ç³»ç»Ÿä¸­å¤šä¸ªè¿›ç¨‹å¹¶å‘æ‰§è¡Œæ—¶é”äº‰ç”¨ä¸¥é‡ã€‚ä½ éœ€è¦å°†å•ä¸€è‡ªç”±åˆ—è¡¨æ”¹ä¸ºæ¯ä¸ªCPUéƒ½æœ‰è‡ªå·±çš„è‡ªç”±åˆ—è¡¨ï¼Œæ¯ä¸ªè‡ªç”±åˆ—è¡¨æœ‰è‡ªå·±çš„é”ã€‚è¿™æ ·ï¼Œå¤šä¸ªCPUå¯ä»¥å¹¶è¡Œè¿›è¡Œå†…å­˜åˆ†é…å’Œé‡Šæ”¾ï¼Œä»è€Œå‡å°‘é”äº‰ç”¨ã€‚\nä»»åŠ¡åˆ†è§£ï¼š åˆ›å»ºæ¯ä¸ªCPUçš„è‡ªç”±åˆ—è¡¨ï¼š æ¯ä¸ªCPUæœ‰è‡ªå·±ç‹¬ç«‹çš„è‡ªç”±å†…å­˜å—åˆ—è¡¨ï¼Œå¹¶ä¸”æ¯ä¸ªåˆ—è¡¨æœ‰è‡ªå·±çš„é”ã€‚ ä½¿ç”¨NCPUï¼ˆåœ¨param.hä¸­å®šä¹‰ï¼‰ç¡®å®šCPUçš„æ•°é‡ã€‚ ä¸ºæ¯ä¸ªCPUåˆ›å»ºä¸€ä¸ªå¯¹åº”çš„é”ï¼Œç”¨äºä¿æŠ¤å…¶è‡ªç”±åˆ—è¡¨ã€‚ ä¿®æ”¹freerangeå‡½æ•°ï¼š freerangeåº”è¯¥æ ¹æ®å½“å‰CPUï¼Œå°†ç©ºé—²å†…å­˜å—åˆ†é…åˆ°å½“å‰CPUçš„è‡ªç”±åˆ—è¡¨ä¸­ã€‚ä½ å¯ä»¥ä½¿ç”¨cpuidæ¥è·å–å½“å‰CPUç¼–å·ï¼Œä½†è¦ç¡®ä¿è°ƒç”¨å®ƒæ—¶ä¸­æ–­å·²å…³é—­ã€‚ ä½¿ç”¨push_off()å’Œpop_off()æ¥å…³é—­å’Œå¼€å¯ä¸­æ–­ï¼Œä¿è¯è°ƒç”¨cpuidæ—¶çš„å®‰å…¨æ€§ã€‚ å®ç°å†…å­˜åˆ†é…å’Œé‡Šæ”¾ï¼š ä¿®æ”¹kallocå’Œkfreeï¼Œä½¿å®ƒä»¬åªæ“ä½œå½“å‰CPUçš„è‡ªç”±åˆ—è¡¨ã€‚é€šè¿‡ä½¿ç”¨å½“å‰CPUçš„é”æ¥ä¿æŠ¤å¹¶å‘è®¿é—®ã€‚ å½“æŸä¸ªCPUçš„è‡ªç”±åˆ—è¡¨ä¸ºç©ºæ—¶ï¼Œéœ€è¦ä»å…¶ä»–CPUçš„è‡ªç”±åˆ—è¡¨ä¸­â€œå·å–â€å†…å­˜å—ã€‚ å®ç°è·¨CPUçš„å†…å­˜â€œå·å–â€ï¼š å¦‚æœå½“å‰CPUçš„è‡ªç”±åˆ—è¡¨ä¸ºç©ºï¼ŒæŸ¥æ‰¾å…¶ä»–CPUçš„è‡ªç”±åˆ—è¡¨ï¼Œå°è¯•ä»ä¸­â€œå·å–â€éƒ¨åˆ†å†…å­˜ã€‚ â€œå·å–â€è¿‡ç¨‹å¯èƒ½å¼•å…¥é”äº‰ç”¨ï¼Œä½†ç”±äºå·å–å‘ç”Ÿè¾ƒå°‘ï¼Œå¯ä»¥å°†äº‰ç”¨æ§åˆ¶åœ¨è¾ƒä½èŒƒå›´ã€‚ é”çš„å‘½åï¼š æ ¹æ®è¦æ±‚ï¼Œæ‰€æœ‰æ¶‰åŠçš„é”å¿…é¡»ä»¥â€œkmemâ€å¼€å¤´ã€‚ä½ å¯ä»¥ä½¿ç”¨initlockå‡½æ•°æ¥åˆå§‹åŒ–é”ï¼Œå¹¶ä½¿ç”¨åˆé€‚çš„åç§°ï¼ˆå¦‚kmem_cpu0ã€kmem_cpu1ç­‰ï¼‰ã€‚ æµ‹è¯•ï¼š è¿è¡Œkalloctestï¼Œè§‚å¯Ÿkmemé”çš„äº‰ç”¨æƒ…å†µï¼Œäº‰ç”¨æ¬¡æ•°åº”æ˜æ˜¾å‡å°‘ã€‚ è¿è¡Œusertests sbrkmuchæµ‹è¯•å†…å­˜åˆ†é…å™¨ï¼Œç¡®ä¿æ‰€æœ‰å†…å­˜åˆ†é…å’Œé‡Šæ”¾åŠŸèƒ½æ­£å¸¸ã€‚ å®ç°æ­¥éª¤ï¼š 1ã€å®šä¹‰æ¯ä¸ªCPUçš„è‡ªç”±åˆ—è¡¨ï¼š åœ¨kmemç»“æ„ä¸­ï¼Œæ·»åŠ ä¸€ä¸ªæ•°ç»„ä¿å­˜æ¯ä¸ªCPUçš„è‡ªç”±åˆ—è¡¨å’Œå¯¹åº”çš„é” struct { struct spinlock lock[NCPU]; struct run *freelist[NCPU]; } kmem; 2ã€åˆå§‹åŒ–æ¯ä¸ªCPUçš„é”å’Œè‡ªç”±åˆ—è¡¨ï¼š åœ¨freerangeå‡½æ•°ä¸­ï¼Œä¸ºå½“å‰CPUçš„è‡ªç”±åˆ—è¡¨åˆ†é…å†…å­˜ï¼Œå¹¶ç”¨initlockä¸ºæ¯ä¸ªCPUçš„é”è¿›è¡Œåˆå§‹åŒ–ï¼š 3ã€ä¿®æ”¹kallocå‡½æ•°ï¼š ä½¿ç”¨å½“å‰CPUçš„è‡ªç”±åˆ—è¡¨åˆ†é…å†…å­˜ï¼Œå¹¶åœ¨åˆ—è¡¨ä¸ºç©ºæ—¶ä»å…¶ä»–CPUçš„è‡ªç”±åˆ—è¡¨ä¸­â€œå·å–â€å†…å­˜ï¼š void * kalloc(void) { struct run *r; int id = cpuid(); push_off(); // å…³é—­ä¸­æ–­ï¼Œé˜²æ­¢ç«æ€ acquire(\u0026amp;kmem.lock[id]); r = kmem.freelist[id]; // ä»å½“å‰CPUçš„ç©ºé—²åˆ—è¡¨ä¸­åˆ†é… if (r) { kmem.freelist[id] = r-\u0026gt;next; } // å¦‚æœå½“å‰CPUç©ºé—²åˆ—è¡¨ä¸ºç©ºï¼Œå°è¯•ä»å…¶ä»–CPUçªƒå–å†…å­˜ release(\u0026amp;kmem.lock[id]); if (r == 0) { for (int i = 0; i \u0026lt; NCPU; i++) { if (i != id) { acquire(\u0026amp;kmem.lock[i]); r = kmem.freelist[i]; if (r) { kmem.freelist[i] = r-\u0026gt;next; release(\u0026amp;kmem.lock[i]); break; } release(\u0026amp;kmem.lock[i]); } } } pop_off(); if (r) memset((char *)r, 5, PGSIZE); // fill with junk return (void *)r; } 4ã€ä¿®æ”¹kfreeå‡½æ•°ï¼š å°†é‡Šæ”¾çš„å†…å­˜å—æ”¾å…¥å½“å‰CPUçš„è‡ªç”±åˆ—è¡¨ï¼Œå¹¶ä½¿ç”¨å½“å‰CPUçš„é”ä¿æŠ¤ï¼š 5ã€(ä¹‹å‰ç¬¬3æ­¥ä¸­å·²ç»åŒ…æ‹¬ä¸‹é¢çš„ä»£ç å®ç°ï¼‰å®ç°â€œå·å–â€æœºåˆ¶ï¼š åœ¨kallocå‡½æ•°ä¸­ï¼Œå½“å½“å‰CPUçš„è‡ªç”±åˆ—è¡¨ä¸ºç©ºæ—¶ï¼Œéå†å…¶ä»–CPUçš„è‡ªç”±åˆ—è¡¨å¹¶â€œå·å–â€å†…å­˜å—ï¼Œå…·ä½“é€»è¾‘å¯èƒ½å¦‚ä¸‹ï¼š for (int i = 0; i \u0026lt; NCPU; i++) { if (i != id) { acquire(\u0026amp;kmem.lock[i]); r = kmem.freelist[i]; if (r) { kmem.freelist[i] = r-\u0026gt;next; release(\u0026amp;kmem.lock[i]); break; } release(\u0026amp;kmem.lock[i]); } } æœ€ç»ˆæ£€æŸ¥ï¼š è¿è¡Œkalloctestå’Œusertests sbrkmuchï¼Œç¡®ä¿æ‰€æœ‰å†…å­˜åˆ†é…ã€é‡Šæ”¾å’Œå¹¶å‘å¤„ç†æ­£å¸¸ï¼ŒåŒæ—¶é”äº‰ç”¨æ˜¾è‘—å‡å°‘ã€‚ Buffer cache (hard) ä¿®æ”¹ xv6 çš„å—ç¼“å­˜ï¼ˆblock cacheï¼‰æœºåˆ¶ï¼Œå‡å°‘å¤šä¸ªè¿›ç¨‹åŒæ—¶è®¿é—®ç¼“å­˜æ—¶å¯¹é” bcache.lock çš„äº‰ç”¨ã€‚ä½ éœ€è¦ç‰¹åˆ«ä¼˜åŒ– bget å’Œ brelse å‡½æ•°ï¼Œç¡®ä¿å¹¶å‘è¯»å–å’Œé‡Šæ”¾ä¸åŒçš„ç¼“å­˜å—æ—¶ä¸ä¼šå†²çªã€‚æœ€ç»ˆçš„ç›®æ ‡æ˜¯è®©è¿è¡Œ bcachetest æ—¶ï¼Œæ‰€æœ‰ä¸å—ç¼“å­˜ç›¸å…³çš„é”çš„è·å–æ¬¡æ•°æ¥è¿‘é›¶ï¼ˆç†æƒ³æƒ…å†µä¸‹æ€»å’Œå°äº500ï¼‰ã€‚æ­¤å¤–ï¼Œä½ éœ€è¦é€šè¿‡ usertests æµ‹è¯•ï¼Œå¹¶ä¸”ç¡®ä¿å®ç°ä¸­çš„é”åéƒ½ä»¥â€œbcacheâ€å¼€å¤´ã€‚\nå®ç°æ­¥éª¤è¯¦ç»†è¯´æ˜ï¼š ç†è§£ç°æœ‰é”äº‰ç”¨ï¼š bcache.lock ä¿æŠ¤äº†ç¼“å­˜å—åˆ—è¡¨ã€ç¼“å­˜å—çš„å¼•ç”¨è®¡æ•° b-\u0026gt;refcnt ä»¥åŠç¼“å­˜å—çš„æ ‡è¯† b-\u0026gt;dev å’Œ b-\u0026gt;blocknoã€‚å¤šä¸ªè¿›ç¨‹åŒæ—¶è®¿é—®æ—¶å¯èƒ½å‘ç”Ÿé”äº‰ç”¨ã€‚ ä½¿ç”¨å“ˆå¸Œè¡¨æ›¿ä»£å…¨å±€ç¼“å­˜é”ï¼š ä½¿ç”¨ä¸€ä¸ªå“ˆå¸Œè¡¨æ¥å­˜å‚¨ç¼“å­˜å—ï¼Œå¹¶ä¸ºæ¯ä¸ªå“ˆå¸Œæ¡¶è®¾ç½®å•ç‹¬çš„é”ã€‚é€šè¿‡å“ˆå¸Œåˆ†æ¡¶æœºåˆ¶ï¼Œä½ å¯ä»¥å‡å°‘å¹¶å‘è®¿é—®ä¸åŒç¼“å­˜å—æ—¶å¯¹åŒä¸€ä¸ªé”çš„äº‰ç”¨ã€‚ å¯ä»¥é€‰æ‹©ä½¿ç”¨ä¸€ä¸ªè´¨æ•°ï¼ˆä¾‹å¦‚13ï¼‰ä½œä¸ºå“ˆå¸Œæ¡¶çš„æ•°é‡ï¼Œä»¥å‡å°‘å“ˆå¸Œå†²çªçš„æ¦‚ç‡ã€‚ ä¿®æ”¹ bget å’Œ brelseï¼š bgetï¼šè¿™æ˜¯è·å–ç¼“å­˜å—çš„å‡½æ•°ã€‚ä½ éœ€è¦ä¿®æ”¹å®ƒï¼Œä½¿å¾—åœ¨æŸ¥æ‰¾å’Œè·å–ç¼“å­˜å—æ—¶ï¼Œåªå¯¹ç›¸åº”çš„å“ˆå¸Œæ¡¶è¿›è¡ŒåŠ é”ï¼Œè€Œä¸æ˜¯å…¨å±€åŠ é”ã€‚åŒæ—¶ï¼Œç¡®ä¿å¦‚æœç¼“å­˜ä¸­æ²¡æœ‰å¯¹åº”çš„å—ï¼Œéœ€è¦é€‰æ‹©ä¸€ä¸ªæ›¿æ¢å—æ—¶ï¼Œæ›¿æ¢é€»è¾‘æ˜¯åŸå­çš„ï¼Œå¹¶ä¸”é˜²æ­¢å“ˆå¸Œå†²çªå¯¼è‡´çš„æ­»é”ã€‚ brelseï¼šè¿™æ˜¯é‡Šæ”¾ç¼“å­˜å—çš„å‡½æ•°ã€‚ä½ å¯ä»¥é€šè¿‡ä½¿ç”¨æ—¶é—´æˆ³ï¼ˆå¦‚ ticksï¼‰æ¥è®°å½•ç¼“å­˜å—çš„æœ€åä½¿ç”¨æ—¶é—´ï¼Œä»è€Œé¿å…åœ¨é‡Šæ”¾å—æ—¶å¿…é¡»è·å–å…¨å±€ bcache.lockã€‚å½“ brelse è¢«è°ƒç”¨æ—¶ï¼Œåªéœ€è¦æ›´æ–°æ—¶é—´æˆ³ï¼Œè€Œä¸éœ€è¦åŠ é”ã€‚ æ›¿æ¢ç¼“å­˜å—çš„ç®¡ç†æœºåˆ¶ï¼š å–æ¶ˆå…¨å±€ç¼“å­˜å—é“¾è¡¨ï¼ˆå¦‚ bcache.head ç­‰ï¼‰ï¼Œè€Œæ˜¯é€šè¿‡æ—¶é—´æˆ³è®°å½•ç¼“å­˜å—çš„æœ€åä½¿ç”¨æ—¶é—´ã€‚è¿™æ ·ï¼Œä½ å¯ä»¥åœ¨ bget ä¸­æ ¹æ®æ—¶é—´æˆ³é€‰æ‹©æœ€è¿‘æœªä½¿ç”¨çš„ç¼“å­˜å—ï¼Œè€Œä¸éœ€è¦éå†å…¨å±€åˆ—è¡¨ã€‚ é˜²æ­¢æ­»é”ï¼š åœ¨ç¼“å­˜æ›¿æ¢å’Œå“ˆå¸Œæ¡¶ç§»åŠ¨æ—¶ï¼Œå¯èƒ½éœ€è¦æŒæœ‰å¤šä¸ªé”ï¼ˆå¦‚å…¨å±€ bcache.lock å’Œå“ˆå¸Œæ¡¶é”ï¼‰ã€‚ä½ éœ€è¦å°å¿ƒé¿å…åœ¨é”çš„é¡ºåºä¸Šå‡ºç°æ­»é”çš„æƒ…å†µï¼Œç‰¹åˆ«æ˜¯åœ¨ç¼“å­˜å—ä»ä¸€ä¸ªå“ˆå¸Œæ¡¶ç§»åŠ¨åˆ°å¦ä¸€ä¸ªæ¡¶æ—¶ã€‚ é€æ­¥è°ƒè¯•ï¼š ä½ å¯ä»¥åœ¨å®ç°å“ˆå¸Œæ¡¶é”åï¼Œå…ˆä¿ç•™ bget å¼€å§‹å’Œç»“æŸæ—¶çš„å…¨å±€é” bcache.lockï¼Œä»¥ç¡®ä¿æ²¡æœ‰ç«äº‰æ¡ä»¶ã€‚ä¸€æ—¦éªŒè¯ä»£ç æ²¡æœ‰ç«æ€æ¡ä»¶åï¼Œå†ç§»é™¤å…¨å±€é”ï¼Œå¤„ç†å¹¶å‘é—®é¢˜ã€‚ å¯ä»¥è¿è¡Œ make CPUS=1 qemu è¿›è¡Œå•æ ¸æµ‹è¯•ï¼Œç¡®ä¿åˆæ­¥å®ç°æ­£ç¡®åï¼Œå†æ‰©å±•åˆ°å¤šæ ¸ç¯å¢ƒã€‚ usertestsä¸é€šè¿‡\n// Buffer cache. // // The buffer cache is a linked list of buf structures holding // cached copies of disk block contents. Caching disk blocks // in memory reduces the number of disk reads and also provides // a synchronization point for disk blocks used by multiple processes. // // Interface: // * To get a buffer for a particular disk block, call bread. // * After changing buffer data, call bwrite to write it to disk. // * When done with the buffer, call brelse. // * Do not use the buffer after calling brelse. // * Only one process at a time can use a buffer, // so do not keep them longer than necessary. #include \u0026#34;types.h\u0026#34; #include \u0026#34;param.h\u0026#34; #include \u0026#34;spinlock.h\u0026#34; #include \u0026#34;sleeplock.h\u0026#34; #include \u0026#34;riscv.h\u0026#34; #include \u0026#34;defs.h\u0026#34; #include \u0026#34;fs.h\u0026#34; #include \u0026#34;buf.h\u0026#34; #define NBUCKETS 23 // å“ˆå¸Œæ¡¶æ•°é‡ï¼Œä½¿ç”¨è´¨æ•°ä»¥å‡å°‘å†²çª struct { struct spinlock lock; struct buf buf[NBUF]; // å®é™…çš„ç¼“å­˜å— struct { struct buf *head; // æ¯ä¸ªæ¡¶çš„ç¼“å­˜å—é“¾è¡¨ struct spinlock lock; // æ¯ä¸ªæ¡¶çš„é” } buckets[NBUCKETS]; } bcache; // è®¡ç®—å—å·å’Œè®¾å¤‡å·çš„å“ˆå¸Œå€¼ static uint hash(uint dev, uint blockno) { return (dev ^ blockno) % NBUCKETS; } void binit(void) { struct buf *b; initlock(\u0026amp;bcache.lock, \u0026#34;bcache\u0026#34;); // åˆå§‹åŒ–æ¯ä¸ªæ¡¶çš„é” for (int i = 0; i \u0026lt; NBUCKETS; i++) { initlock(\u0026amp;bcache.buckets[i].lock, \u0026#34;bcache.bucket\u0026#34;); bcache.buckets[i].head = 0; } // åˆå§‹åŒ–ç¼“å­˜å— for (b = bcache.buf; b \u0026lt; bcache.buf + NBUF; b++) { initsleeplock(\u0026amp;b-\u0026gt;lock, \u0026#34;buffer\u0026#34;); b-\u0026gt;refcnt = 0; } } // ä¿®æ”¹ bget å‡½æ•°è¿›è¡Œå“ˆå¸Œè¡¨æŸ¥æ‰¾ // ä¸ºäº†ä½¿ç”¨å“ˆå¸Œè¡¨ï¼Œbget å‡½æ•°éœ€è¦è¿›è¡Œä»¥ä¸‹ä¿®æ”¹ï¼š // è®¡ç®—å—å·çš„å“ˆå¸Œå€¼ï¼Œç¡®å®šæ‰€åœ¨æ¡¶ã€‚ // è·å–æ¡¶çš„é”ï¼Œå¹¶åœ¨æ¡¶ä¸­æŸ¥æ‰¾å—ã€‚ // å¦‚æœæœªæ‰¾åˆ°å—ï¼Œåˆ™é€‰æ‹©ä¸€ä¸ªæœªä½¿ç”¨æˆ–æœ€è¿‘æœ€å°‘ä½¿ç”¨çš„å—è¿›è¡Œæ›¿æ¢ã€‚ static struct buf * bget(uint dev, uint blockno) { struct buf *b; uint h = hash(dev, blockno); acquire(\u0026amp;bcache.buckets[h].lock); // åœ¨æ¡¶ä¸­æŸ¥æ‰¾å— for (b = bcache.buckets[h].head; b; b = b-\u0026gt;next) { if (b-\u0026gt;dev == dev \u0026amp;\u0026amp; b-\u0026gt;blockno == blockno) { b-\u0026gt;refcnt++; release(\u0026amp;bcache.buckets[h].lock); acquiresleep(\u0026amp;b-\u0026gt;lock); return b; } } // å¦‚æœæœªæ‰¾åˆ°å—ï¼Œå°è¯•æ‰¾åˆ°ä¸€ä¸ªæœªä½¿ç”¨çš„å—æˆ–æ›¿æ¢æœ€è¿‘æœ€å°‘ä½¿ç”¨çš„å— struct buf *lru = 0; for (b = bcache.buf; b \u0026lt; bcache.buf + NBUF; b++) { if (b-\u0026gt;refcnt == 0 \u0026amp;\u0026amp; (lru == 0 || b-\u0026gt;lastuse \u0026lt; lru-\u0026gt;lastuse)) lru = b; } if (lru == 0) panic(\u0026#34;bget: no buffers\u0026#34;); release(\u0026amp;bcache.buckets[h].lock); // ä»æ—§æ¡¶ä¸­ç§»é™¤å— h = hash(lru-\u0026gt;dev, lru-\u0026gt;blockno); acquire(\u0026amp;bcache.buckets[h].lock); struct buf **prev = \u0026amp;bcache.buckets[h].head; for (b = bcache.buckets[h].head; b; prev = \u0026amp;b-\u0026gt;next, b = b-\u0026gt;next) { if (b == lru) { *prev = b-\u0026gt;next; break; } } // å°†æ–°å—æ’å…¥é€‚å½“çš„æ¡¶ lru-\u0026gt;dev = dev; lru-\u0026gt;blockno = blockno; lru-\u0026gt;valid = 0; lru-\u0026gt;refcnt = 1; lru-\u0026gt;lastuse = ticks; release(\u0026amp;bcache.buckets[h].lock); h = hash(dev, blockno); acquire(\u0026amp;bcache.buckets[h].lock); lru-\u0026gt;next = bcache.buckets[h].head; bcache.buckets[h].head = lru; release(\u0026amp;bcache.buckets[h].lock); acquiresleep(\u0026amp;lru-\u0026gt;lock); return lru; } // Return a locked buf with the contents of the indicated block. struct buf * bread(uint dev, uint blockno) { struct buf *b; b = bget(dev, blockno); if (!b-\u0026gt;valid) { virtio_disk_rw(b, 0); b-\u0026gt;valid = 1; } return b; } // Write b\u0026#39;s contents to disk. Must be locked. void bwrite(struct buf *b) { if (!holdingsleep(\u0026amp;b-\u0026gt;lock)) panic(\u0026#34;bwrite\u0026#34;); virtio_disk_rw(b, 1); } // Release a locked buffer. // Move to the head of the most-recently-used list. void brelse(struct buf *b) { if (!holdingsleep(\u0026amp;b-\u0026gt;lock)) panic(\u0026#34;brelse\u0026#34;); releasesleep(\u0026amp;b-\u0026gt;lock); uint h = hash(b-\u0026gt;dev, b-\u0026gt;blockno); acquire(\u0026amp;bcache.buckets[h].lock); b-\u0026gt;refcnt--; if (b-\u0026gt;refcnt == 0) { // å—ä¸å†è¢«ä½¿ç”¨ï¼Œæ›´æ–°æ—¶é—´æˆ³ b-\u0026gt;lastuse = ticks; } release(\u0026amp;bcache.buckets[h].lock); } void bpin(struct buf *b) { uint h = hash(b-\u0026gt;dev, b-\u0026gt;blockno); acquire(\u0026amp;bcache.buckets[h].lock); b-\u0026gt;refcnt++; release(\u0026amp;bcache.buckets[h].lock); } void bunpin(struct buf *b) { uint h = hash(b-\u0026gt;dev, b-\u0026gt;blockno); acquire(\u0026amp;bcache.buckets[h].lock); b-\u0026gt;refcnt--; release(\u0026amp;bcache.buckets[h].lock); } // Buffer cache. // // The buffer cache is a linked list of buf structures holding // cached copies of disk block contents. Caching disk blocks // in memory reduces the number of disk reads and also provides // a synchronization point for disk blocks used by multiple processes. // // Interface: // * To get a buffer for a particular disk block, call bread. // * After changing buffer data, call bwrite to write it to disk. // * When done with the buffer, call brelse. // * Do not use the buffer after calling brelse. // * Only one process at a time can use a buffer, // so do not keep them longer than necessary. #include \u0026#34;types.h\u0026#34; #include \u0026#34;param.h\u0026#34; #include \u0026#34;spinlock.h\u0026#34; #include \u0026#34;sleeplock.h\u0026#34; #include \u0026#34;riscv.h\u0026#34; #include \u0026#34;defs.h\u0026#34; #include \u0026#34;fs.h\u0026#34; #include \u0026#34;buf.h\u0026#34; #define NBUCKET 13 #undef NBUF #define NBUF (NBUCKET * 3) struct { struct spinlock lock; struct buf buf[NBUF]; } bcache; struct bucket { struct spinlock lock; struct buf head; }hashtable[NBUCKET]; int hash(uint dev, uint blockno) { return blockno % NBUCKET; } void binit(void) { struct buf *b; initlock(\u0026amp;bcache.lock, \u0026#34;bcache\u0026#34;); for(b = bcache.buf; b \u0026lt; bcache.buf+NBUF; b++){ initsleeplock(\u0026amp;b-\u0026gt;lock, \u0026#34;buffer\u0026#34;); } b = bcache.buf; for (int i = 0; i \u0026lt; NBUCKET; i++) { initlock(\u0026amp;hashtable[i].lock, \u0026#34;bcache_bucket\u0026#34;); for (int j = 0; j \u0026lt; NBUF / NBUCKET; j++) { b-\u0026gt;blockno = i; b-\u0026gt;next = hashtable[i].head.next; hashtable[i].head.next = b; b++; } } } // Look through buffer cache for block on device dev. // If not found, allocate a buffer. // In either case, return locked buffer. static struct buf* bget(uint dev, uint blockno) { // printf(\u0026#34;dev: %d blockno: %d Status: \u0026#34;, dev, blockno); struct buf *b; int idx = hash(dev, blockno); struct bucket* bucket = hashtable + idx; acquire(\u0026amp;bucket-\u0026gt;lock); // Is the block already cached? for(b = bucket-\u0026gt;head.next; b != 0; b = b-\u0026gt;next){ if(b-\u0026gt;dev == dev \u0026amp;\u0026amp; b-\u0026gt;blockno == blockno){ b-\u0026gt;refcnt++; release(\u0026amp;bucket-\u0026gt;lock); acquiresleep(\u0026amp;b-\u0026gt;lock); // printf(\u0026#34;Cached %p\\n\u0026#34;, b); return b; } } // Not cached. // First try to find in current bucket. int min_time = 0x8fffffff; struct buf* replace_buf = 0; for(b = bucket-\u0026gt;head.next; b != 0; b = b-\u0026gt;next){ if(b-\u0026gt;refcnt == 0 \u0026amp;\u0026amp; b-\u0026gt;timestamp \u0026lt; min_time) { replace_buf = b; min_time = b-\u0026gt;timestamp; } } if(replace_buf) { // printf(\u0026#34;Local %d %p\\n\u0026#34;, idx, replace_buf); goto find; } // Try to find in other bucket. acquire(\u0026amp;bcache.lock); refind: for(b = bcache.buf; b \u0026lt; bcache.buf + NBUF; b++) { if(b-\u0026gt;refcnt == 0 \u0026amp;\u0026amp; b-\u0026gt;timestamp \u0026lt; min_time) { replace_buf = b; min_time = b-\u0026gt;timestamp; } } if (replace_buf) { // remove from old bucket int ridx = hash(replace_buf-\u0026gt;dev, replace_buf-\u0026gt;blockno); acquire(\u0026amp;hashtable[ridx].lock); if(replace_buf-\u0026gt;refcnt != 0) // be used in another bucket\u0026#39;s local find between finded and acquire { release(\u0026amp;hashtable[ridx].lock); goto refind; } struct buf *pre = \u0026amp;hashtable[ridx].head; struct buf *p = hashtable[ridx].head.next; while (p != replace_buf) { pre = pre-\u0026gt;next; p = p-\u0026gt;next; } pre-\u0026gt;next = p-\u0026gt;next; release(\u0026amp;hashtable[ridx].lock); // add to current bucket replace_buf-\u0026gt;next = hashtable[idx].head.next; hashtable[idx].head.next = replace_buf; release(\u0026amp;bcache.lock); // printf(\u0026#34;Global %d -\u0026gt; %d %p\\n\u0026#34;, ridx, idx, replace_buf); goto find; } else { panic(\u0026#34;bget: no buffers\u0026#34;); } find: replace_buf-\u0026gt;dev = dev; replace_buf-\u0026gt;blockno = blockno; replace_buf-\u0026gt;valid = 0; replace_buf-\u0026gt;refcnt = 1; release(\u0026amp;bucket-\u0026gt;lock); acquiresleep(\u0026amp;replace_buf-\u0026gt;lock); return replace_buf; } // Return a locked buf with the contents of the indicated block. struct buf* bread(uint dev, uint blockno) { struct buf *b; b = bget(dev, blockno); if(!b-\u0026gt;valid) { virtio_disk_rw(b, 0); b-\u0026gt;valid = 1; } return b; } // Write b\u0026#39;s contents to disk. Must be locked. void bwrite(struct buf *b) { if(!holdingsleep(\u0026amp;b-\u0026gt;lock)) panic(\u0026#34;bwrite\u0026#34;); virtio_disk_rw(b, 1); } // Release a locked buffer. // Move to the head of the most-recently-used list. void brelse(struct buf *b) { if(!holdingsleep(\u0026amp;b-\u0026gt;lock)) panic(\u0026#34;brelse\u0026#34;); releasesleep(\u0026amp;b-\u0026gt;lock); int idx = hash(b-\u0026gt;dev, b-\u0026gt;blockno); acquire(\u0026amp;hashtable[idx].lock); b-\u0026gt;refcnt--; if (b-\u0026gt;refcnt == 0) { // no one is waiting for it. b-\u0026gt;timestamp = ticks; } release(\u0026amp;hashtable[idx].lock); } void bpin(struct buf *b) { int idx = hash(b-\u0026gt;dev, b-\u0026gt;blockno); acquire(\u0026amp;hashtable[idx].lock); b-\u0026gt;refcnt++; release(\u0026amp;hashtable[idx].lock); } void bunpin(struct buf *b) { int idx = hash(b-\u0026gt;dev, b-\u0026gt;blockno); acquire(\u0026amp;hashtable[idx].lock); b-\u0026gt;refcnt--; release(\u0026amp;hashtable[idx].lock); } å®ç°æ­¥éª¤ 1ã€å®šä¹‰æ¡¶å¤§å°ï¼Œä»¥åŠå…¨å±€çš„bufferå¤§å° 2ã€æ·»åŠ bucketç»“æ„ä½“ 3ã€å®ç°å“ˆå¸Œå‡½æ•° 4ã€åˆå§‹åŒ–å®ç°å…¨å±€bufferåˆå§‹åŒ–ï¼Œä»¥åŠæ¯ä¸ªæ¡¶å†…çš„bufferåˆå§‹åŒ– void binit(void) { struct buf *b; initlock(\u0026amp;bcache.lock, \u0026#34;bcache\u0026#34;); for (b = bcache.buf; b \u0026lt; bcache.buf + NBUF; b++) { initsleeplock(\u0026amp;b-\u0026gt;lock, \u0026#34;buffer\u0026#34;); b-\u0026gt;refcnt = 0; } b = bcache.buf; for (int i = 0; i \u0026lt; NBUCKET; i++) { initlock(\u0026amp;hashtable[i].lock, \u0026#34;bcache_bucket\u0026#34;); for (int j = 0; j \u0026lt; NBUF / NBUCKET; j++) { b-\u0026gt;blockno = i; b-\u0026gt;refcnt = 0; b-\u0026gt;next = hashtable[i].head.next; hashtable[i].head.next = b; b++; } } } 5ã€é‡ç‚¹ï¼Œ é‡æ„bget()ï¼Œæ¡¶å†…å¯»æ‰¾æ˜¯å¦å·²ç»ç¼“å­˜-\u0026gt;æ¡¶å†…å¯»æ‰¾ç©ºç™½ç¼“å­˜ -\u0026gt;å¯»æ‰¾å…¨å±€ç©ºç™½ç¼“å­˜ static struct buf * find_replacement_in_bucket(struct bucket *bucket, uint *min_time) { struct buf *replace_buf = 0; struct buf *b; for (b = bucket-\u0026gt;head.next; b != 0; b = b-\u0026gt;next) { if (b-\u0026gt;refcnt == 0 \u0026amp;\u0026amp; (*min_time == 0 || b-\u0026gt;timestamp \u0026lt; *min_time)) { replace_buf = b; *min_time = b-\u0026gt;timestamp; } } return replace_buf; } static struct buf * find_replacement_in_global(struct buf *replace_buf, uint *min_time) { struct buf *b; for (b = bcache.buf; b \u0026lt; bcache.buf + NBUF; b++) { if (b-\u0026gt;refcnt == 0 \u0026amp;\u0026amp; (*min_time == 0 || b-\u0026gt;timestamp \u0026lt; *min_time)) { replace_buf = b; *min_time = b-\u0026gt;timestamp; } } return replace_buf; } static void move_buf_to_bucket(struct buf *replace_buf, int idx) { int ridx = hash(replace_buf-\u0026gt;dev, replace_buf-\u0026gt;blockno); acquire(\u0026amp;hashtable[ridx].lock); if (replace_buf-\u0026gt;refcnt == 0) { struct buf *pre = \u0026amp;hashtable[ridx].head; struct buf *p = hashtable[ridx].head.next; while (p != replace_buf) { pre = pre-\u0026gt;next; p = p-\u0026gt;next; } pre-\u0026gt;next = p-\u0026gt;next; release(\u0026amp;hashtable[ridx].lock); // Add to current bucket replace_buf-\u0026gt;next = hashtable[idx].head.next; hashtable[idx].head.next = replace_buf; } else { release(\u0026amp;hashtable[ridx].lock); } } static struct buf* bget(uint dev, uint blockno) { struct buf *b; int h = hash(dev, blockno); struct bucket *bucket = \u0026amp;hashtable[h]; acquire(\u0026amp;bucket-\u0026gt;lock); // Check if block is already cached æ¡¶å†…å¯»æ‰¾ for (b = bucket-\u0026gt;head.next; b != 0; b = b-\u0026gt;next) { if (b-\u0026gt;dev == dev \u0026amp;\u0026amp; b-\u0026gt;blockno == blockno) { b-\u0026gt;refcnt++; release(\u0026amp;bucket-\u0026gt;lock); acquiresleep(\u0026amp;b-\u0026gt;lock); return b; } } // Not cached, find replacement buffer æ¡¶å†…çš„ç©ºç™½buf uint min_time = 0; struct buf *replace_buf; replace_buf = find_replacement_in_bucket(bucket, \u0026amp;min_time); if (!replace_buf) { acquire(\u0026amp;bcache.lock); // å¯»æ‰¾æ¡¶å¤–çš„ç©ºç™½buf replace_buf = find_replacement_in_global(replace_buf, \u0026amp;min_time); if (replace_buf) { move_buf_to_bucket(replace_buf, h); } else { release(\u0026amp;bcache.lock); panic(\u0026#34;bget: no buffers\u0026#34;); } release(\u0026amp;bcache.lock); } // Initialize and return the replacement buffer replace_buf-\u0026gt;dev = dev; replace_buf-\u0026gt;blockno = blockno; replace_buf-\u0026gt;valid = 0; replace_buf-\u0026gt;refcnt = 1; release(\u0026amp;bucket-\u0026gt;lock); acquiresleep(\u0026amp;replace_buf-\u0026gt;lock); return replace_buf; } 6ã€é”çš„é‡Šæ”¾ï¼Œæ›´æ–°å¼•ç”¨è®¡æ•°ï¼Œå½“refcnt == 0æ—¶æ›´æ–°æ—¶é—´æˆ³ 7ã€æ›´æ–° bpin() å’Œ bunpin(), åªéœ€è¦æŒæœ‰å¯¹åº”æ¡¶çš„é”å³å¯\n","permalink":"https://kennems.github.io/posts/tech/mit6.s08113-coordination-sleepwakeup/","summary":"MIT6.S081(13)-Coordination (sleep\u0026amp;wakeup) plan Re-emphasize a few points about xv6 thread switching sequence coordination sleep \u0026amp; wakeup lost wakeup problem termination Why hold p-\u0026gt;lock across swtch()? this is an important point and affects many situations in xv6 [diagram: P1, STACK1, swtch, STACK_SCHED] yield: acquire(\u0026amp;p-\u0026gt;lock); p-\u0026gt;state = RUNNABLE; swtch(); scheduler: swtch(); release(\u0026amp;p-\u0026gt;lock); the main point of holding p-\u0026gt;lock across swtch(): prevent another core\u0026rsquo;s scheduler from seeing p-\u0026gt;state == RUNNABLE until after the","title":"MIT6.S081(13)-Coordination (sleep\u0026wakeup)"},{"content":"å‘¨èµ›250922 å°å·ç¬¬ä¸€æ¬¡AKï¼Œ é¢˜æ¯”è¾ƒç®€å•ã€‚\n3295. ä¸¾æŠ¥åƒåœ¾ä¿¡æ¯ é¢˜ç›®å¤§æ„ ç»™å®šä¸¤ä¸ªå­—ç¬¦ä¸²æ•°ç»„ message å’Œ bannedWordsï¼Œä½ éœ€è¦åˆ¤æ–­ message æ˜¯å¦å±äºâ€œåƒåœ¾ä¿¡æ¯â€ã€‚å¦‚æœ message ä¸­è‡³å°‘æœ‰ä¸¤ä¸ªå•è¯å‡ºç°åœ¨ bannedWords ä¸­ï¼Œåˆ™è¯¥æ•°ç»„è¢«è§†ä¸ºåƒåœ¾ä¿¡æ¯ï¼Œè¿”å› trueï¼›å¦åˆ™è¿”å› falseã€‚\nå®ç°æ€è·¯ é›†åˆæ“ä½œä¼˜åŒ–ï¼šä¸ºäº†å¿«é€Ÿåˆ¤æ–­ message ä¸­çš„å•è¯æ˜¯å¦åœ¨ bannedWords ä¸­ï¼Œå°† bannedWords è½¬æ¢ä¸ºä¸€ä¸ª set é›†åˆï¼Œåˆ©ç”¨é›†åˆçš„ O(1) æ—¶é—´å¤æ‚åº¦æ¥å¿«é€ŸæŸ¥æ‰¾å•è¯æ˜¯å¦å­˜åœ¨ã€‚ ç»Ÿè®¡åŒ¹é…æ¬¡æ•°ï¼šéå† message æ•°ç»„ï¼Œå¯¹æ¯ä¸ªå•è¯æ£€æŸ¥å®ƒæ˜¯å¦åœ¨ bannedWords é›†åˆä¸­ï¼Œè®°å½•å‡ºç°åœ¨ bannedWords ä¸­çš„å•è¯æ•°ã€‚ åˆ¤æ–­åƒåœ¾ä¿¡æ¯ï¼šè‹¥åŒ¹é…åˆ°çš„å•è¯æ•°é‡å¤§äºç­‰äº 2ï¼Œåˆ™è¿”å› trueï¼ˆå³è®¤ä¸º message æ˜¯åƒåœ¾ä¿¡æ¯ï¼‰ï¼›å¦åˆ™è¿”å› falseã€‚ class Solution: def reportSpam(self, message: List[str], bannedWords: List[str]) -\u0026gt; bool: bannedWords = set(bannedWords) return sum(m in bannedWords for m in message) \u0026gt;= 2 Q2. ç§»å±±æ‰€éœ€çš„æœ€å°‘ç§’æ•° é¢˜ç›®å¤§æ„ ç»™å®šä¸€ä¸ªæ•´æ•° mountainHeight è¡¨ç¤ºå±±çš„é«˜åº¦å’Œä¸€ä¸ªæ•°ç»„ workerTimesï¼Œè¡¨ç¤ºå·¥äººä»¬é™ä½å±±é«˜åº¦æ‰€éœ€çš„å·¥ä½œæ—¶é—´ã€‚å·¥äººä»¬å¯ä»¥åŒæ—¶å·¥ä½œï¼Œæ¯ä¸ªå·¥äºº i åœ¨é™ä½å±±çš„è¿‡ç¨‹ä¸­ï¼Œå…¶é™ä½ 1 ä¸ªé«˜åº¦éœ€è¦ workerTimes[i] ç§’ï¼Œé™ä½ 2 ä¸ªé«˜åº¦éœ€è¦ workerTimes[i] + 2 * workerTimes[i] ç§’ï¼Œä»¥æ­¤ç±»æ¨ã€‚é¢˜ç›®è¦æ±‚è¿”å›å·¥äººä»¬å°†å±±çš„é«˜åº¦é™ä½åˆ° 0 æ‰€éœ€çš„æœ€å°‘ç§’æ•°ã€‚\nå®ç°æ€è·¯ å·¥äººçš„å·¥ä½œèƒ½åŠ›ï¼šå·¥äºº i é™ä½ x çš„é«˜åº¦éœ€è¦çš„æ—¶é—´æ˜¯ workerTimes[i] * (1 + 2 + ... + x)ï¼Œå³ç­‰å·®æ•°åˆ—æ±‚å’Œå…¬å¼ã€‚æ ¹æ®æ—¶é—´ tï¼Œå·¥äºº i èƒ½é™ä½çš„æœ€å¤§é«˜åº¦å¯ä»¥é€šè¿‡äºŒåˆ†æŸ¥æ‰¾ç¡®å®šã€‚ äºŒåˆ†æŸ¥æ‰¾æœ€å°æ—¶é—´ï¼šæˆ‘ä»¬å¯ä»¥é€šè¿‡äºŒåˆ†æ³•æ¥ç¡®å®šæœ€å°‘éœ€è¦çš„æ—¶é—´ï¼Œè®¾å®šä¸€ä¸ªæ—¶é—´èŒƒå›´ [0, 10^16]ï¼Œæ¯æ¬¡å–ä¸­é—´å€¼ mid ä½œä¸ºå½“å‰æ—¶é—´ï¼Œåˆ¤æ–­åœ¨è¿™æ®µæ—¶é—´å†…ï¼Œæ‰€æœ‰å·¥äººèƒ½å¦æŠŠå±±é™ä½åˆ° 0ã€‚æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ª work å‡½æ•°æ¥è®¡ç®—å·¥äººåœ¨ç»™å®šæ—¶é—´å†…å¯ä»¥é™ä½çš„æœ€å¤§é«˜åº¦ã€‚ è®¡ç®—æ¯ä¸ªå·¥äººèƒ½é™ä½çš„é«˜åº¦ï¼šå¯¹äºæ¯ä¸ªå·¥äººï¼Œæˆ‘ä»¬é€šè¿‡äºŒåˆ†æŸ¥æ‰¾è®¡ç®—å‡ºå½“å‰æ—¶é—´å†…è¯¥å·¥äººèƒ½é™ä½çš„æœ€å¤§é«˜åº¦ï¼Œå¦‚æœæ‰€æœ‰å·¥äººçš„æ€»é™ä½é«˜åº¦è¶…è¿‡äº†å±±çš„é«˜åº¦ï¼Œåˆ™è¯´æ˜å½“å‰æ—¶é—´ mid å¯ä»¥æ»¡è¶³éœ€æ±‚ï¼Œç»§ç»­å‘æ›´å°çš„æ—¶é—´æŸ¥æ‰¾ï¼Œå¦åˆ™å‘æ›´å¤§çš„æ—¶é—´æŸ¥æ‰¾ã€‚ æœ€ç»ˆç»“æœï¼šåœ¨äºŒåˆ†æ³•ä¸­æ‰¾åˆ°çš„æœ€å°æ—¶é—´å³ä¸ºç­”æ¡ˆã€‚ class Solution: def minNumberOfSeconds(self, m: int, w: List[int]) -\u0026gt; int: # æ‰¾åˆ° å½“å‰çš„å·¥ä½œæœ€å¤§æ—¶é—´å†… æ­¤å·¥äººèƒ½é™ä½çš„æœ€å¤§é«˜åº¦ def work(wt, t): lo, hi = 0, t while lo \u0026lt; hi: mid = (lo + hi + 1) // 2 if wt * mid * (mid + 1) // 2 \u0026lt;= t: lo = mid else: hi = mid - 1 return lo # 10^5 * (1 + 10^5) // 2 * 10 ^ 4 = l, r = 0, 10**16 # äºŒåˆ†ç­”æ¡ˆ while l \u0026lt; r: mid = (l + r) // 2 tot = 0 for wt in w: tot += work(wt, mid) if tot \u0026gt;= m: break if tot \u0026gt;= m: r = mid else: l = mid + 1 return l Q3 \u0026amp; Q4 3297. ç»Ÿè®¡é‡æ–°æ’åˆ—ååŒ…å«å¦ä¸€ä¸ªå­—ç¬¦ä¸²çš„å­å­—ç¬¦ä¸²æ•°ç›® I é¢˜ç›®å¤§æ„ ç»™å®šä¸¤ä¸ªå­—ç¬¦ä¸² word1 å’Œ word2ï¼Œå¦‚æœæŸä¸ªå­å­—ç¬¦ä¸² x çš„é‡æ–°æ’åˆ—èƒ½å¤ŸåŒ…å« word2 ä½œä¸ºå…¶å‰ç¼€ï¼Œé‚£ä¹ˆè¿™ä¸ªå­å­—ç¬¦ä¸²æ˜¯åˆæ³•çš„ã€‚é—®é¢˜è¦æ±‚è¿”å› word1 ä¸­åˆæ³•å­å­—ç¬¦ä¸²çš„æ•°ç›®ã€‚\nä¸ºäº†æ»¡è¶³é—®é¢˜ä¸­çš„å†…å­˜é™åˆ¶ï¼Œè¦æ±‚å®ç°ä¸€ä¸ªçº¿æ€§å¤æ‚åº¦çš„è§£æ³•ã€‚\nå®ç°æ€è·¯ å‰ç¼€åŒ¹é…å’Œå­—ç¬¦è®¡æ•°ï¼š ä¸ºäº†åˆ¤æ–­ä¸€ä¸ªå­å­—ç¬¦ä¸²çš„é‡æ–°æ’åˆ—æ˜¯å¦å¯ä»¥åŒ…å« word2 ä½œä¸ºå‰ç¼€ï¼Œéœ€è¦å¯¹ word2 ä¸­çš„å­—ç¬¦è¿›è¡Œç»Ÿè®¡ã€‚ ä½¿ç”¨ Counter å¯¹ word2 ä¸­æ¯ä¸ªå­—ç¬¦å‡ºç°çš„æ¬¡æ•°è¿›è¡Œè®°å½•ï¼Œå¹¶ä½¿ç”¨æ»‘åŠ¨çª—å£æŠ€æœ¯éå† word1 çš„å­å­—ç¬¦ä¸²ã€‚ æ»‘åŠ¨çª—å£æ³•ï¼š ç»´æŠ¤ä¸€ä¸ªçª—å£ï¼Œç”¨æ¥è®°å½•å½“å‰çª—å£å†…çš„å­—ç¬¦è®¡æ•°ï¼Œå¹¶åœ¨çª—å£ç§»åŠ¨çš„è¿‡ç¨‹ä¸­æ£€æŸ¥å½“å‰çª—å£èƒ½å¦é‡æ–°æ’åˆ—æˆ word2 çš„å‰ç¼€ã€‚ çª—å£é€šè¿‡å·¦å³æŒ‡é’ˆæ‰©å±•å’Œæ”¶ç¼©ï¼Œæ¯æ¬¡é‡åˆ°åˆæ³•æƒ…å†µæ—¶ï¼Œè®°å½•å½“å‰çª—å£èƒ½äº§ç”Ÿçš„åˆæ³•å­å­—ç¬¦ä¸²çš„æ•°é‡ã€‚ çª—å£å†…åŒ¹é…å­—ç¬¦æ•°ï¼š å®šä¹‰å˜é‡ mï¼Œç”¨äºè®°å½•å½“å‰çª—å£å†…æœ‰å¤šå°‘å­—ç¬¦å·²ç»å®Œå…¨åŒ¹é…äº† word2 ä¸­å¯¹åº”å­—ç¬¦çš„æ•°é‡ã€‚å½“ m ç­‰äº word2 ä¸­ä¸åŒå­—ç¬¦çš„æ€»æ•°æ—¶ï¼Œæ„å‘³ç€å½“å‰çª—å£å¯ä»¥é‡æ–°æ’åˆ—å‡º word2 çš„å‰ç¼€ã€‚ å…·ä½“æ­¥éª¤ï¼š åˆå§‹åŒ– word2 ä¸­å­—ç¬¦çš„è®¡æ•°å™¨ w2_cntã€‚ ä½¿ç”¨æ»‘åŠ¨çª—å£éå† word1ï¼Œå¯¹æ¯ä¸ªçª—å£å†…çš„å­—ç¬¦è¿›è¡Œè®¡æ•°ã€‚å¦‚æœæŸä¸ªå­—ç¬¦çš„è®¡æ•°è¾¾åˆ° word2 ä¸­ç›¸åº”å­—ç¬¦çš„æ•°é‡ï¼Œå¢åŠ åŒ¹é…å­—ç¬¦æ•° mã€‚ å½“ m è¾¾åˆ° word2 ä¸åŒå­—ç¬¦æ•°çš„æ€»æ•°æ—¶ï¼Œè¡¨ç¤ºçª—å£ä¸­çš„å­å­—ç¬¦ä¸²å¯ä»¥åŒ…å« word2 ä½œä¸ºå‰ç¼€ã€‚ æ¯å½“çª—å£åˆæ³•æ—¶ï¼Œè®¡ç®—ä»å½“å‰çª—å£å³è¾¹ç•Œå¼€å§‹åˆ° word1 æœ«å°¾çš„æ‰€æœ‰å­å­—ç¬¦ä¸²éƒ½å¯ä»¥è¢«é‡æ–°æ’åˆ—æˆåˆæ³•å­å­—ç¬¦ä¸²ã€‚ class Solution: def validSubstringCount(self, w1: str, w2: str) -\u0026gt; int: w2_cnt = Counter(w2) res = 0 win = Counter() m = 0 # the number of matched char l = 0 for r in range(len(w1)): if w1[r] in w2_cnt: win[w1[r]] += 1 if win[w1[r]] == w2_cnt[w1[r]]: m += 1 while m == len(w2_cnt): res += len(w1) - r # (len(w1) - (r + 1) + 1) å› ä¸ºræ˜¯ä¸‹æ ‡ if w1[l] in w2_cnt: if win[w1[l]] == w2_cnt[w1[l]]: m -= 1 win[w1[l]] -= 1 l += 1 return res ","permalink":"https://kennems.github.io/posts/tech/%E5%91%A8%E8%B5%9B240924/","summary":"å‘¨èµ›250922 å°å·ç¬¬ä¸€æ¬¡AKï¼Œ é¢˜æ¯”è¾ƒç®€å•ã€‚ 3295. ä¸¾æŠ¥åƒåœ¾ä¿¡æ¯ é¢˜ç›®å¤§æ„ ç»™å®šä¸¤ä¸ªå­—ç¬¦ä¸²æ•°ç»„ message å’Œ bannedWordsï¼Œä½ éœ€è¦åˆ¤æ–­ message æ˜¯å¦å±äºâ€œåƒåœ¾ä¿¡","title":"LeetCodeå‘¨èµ›416(250922)"},{"content":"MIT6.S081(11)- Thread switching Topic: more \u0026ldquo;under the hood\u0026rdquo; with xv6 Previously: system calls, interrupts, page tables, locks Today: process/thread switching\nWhy support multiple tasks? Time-sharing: many users and/or many running programs. program structure: prime number sieve. parallel speedup on multi-core hardware.\nThreads are an abstraction to simplify programming when there are many tasks. thread = an independent serial execution \u0026ndash; registers, pc, stack the threading system interleaves the execution of multiple threads\nTwo main strategies: â€‹ multiple CPUs, each CPU runs a different thread â€‹ each CPU \u0026ldquo;switches\u0026rdquo; between threads, runs one at a time\nthreads can share memory, or not xv6 kernel threads: they share kernel memory (thus locks) xv6 user processes: one thread per process, so no sharing linux: supports multiple threads sharing a user process\u0026rsquo;s memory\nthere are other techniques for interleaving multiple tasks look up event-driven programming, or state machines threads are not the most efficient, but they are usually the most convenient\nThread design challenges How to interleave many threads on a few CPUs?\nHow to make interleaving transparent?\n\u0026ldquo;scheduling\u0026rdquo; = the process of choosing which thread to run next\nWhat to save while a thread isn\u0026rsquo;t running?\nHow to cope with compute-bound threads?\nHow to cope with compute-bound threads?\neach CPU has timer hardware, which interrupts periodically kernel uses timer interrupts to grab control from looping threads kernel saves thread state, switches, eventually resumes, restores that saved state for transparency\nRUNNING vs RUNNABLE\nthis is \u0026ldquo;pre-emptive\u0026rdquo; scheduling \u0026ndash; a forced yield of unaware code as opposed to cooperative scheduling, in which code yields voluntarily\nWhat to do with a thread that isn\u0026rsquo;t running? We need to set aside its state: registers, stack, memory though no need to worry about memory, it won\u0026rsquo;t go anywhere so implementation provides each thread with a stack and register save area need to track status of each thread RUNNING vs RUNNABLE vs SLEEPING\nin xv6:\n[simple diagram: processes, user stack, trapframe, kernel stack]\neach process has two threads, one user, one kernel a process is either executing its user thread, or in a system call or interrupt in its kernel thread kernel threads share kernel memory / data structures thus the kernel is a parallel program we\u0026rsquo;ll use \u0026ldquo;process\u0026rdquo; and \u0026ldquo;kernel thread\u0026rdquo; and \u0026ldquo;thread\u0026rdquo; as synonyms\noverview of thread switching in xv6 (the point: switch among threads to interleave many threads on each CPU)\n[diagram: P1, TF1, STACK1, swtch(), CTX1; CTXs, swtch(), STACKs, scheduler(), \u0026amp;c]\nTF = trapframe = saved user registers\rCTX = context = saved RISC-V registers getting from one process to another involves multiple transitions:\nâ€‹ user -\u0026gt; kernel; saves user registers in trapframe â€‹ kernel thread -\u0026gt; scheduler thread; saves kernel thread registers in context â€‹ scheduler thread -\u0026gt; kernel thread; restores kernel thread registers from ctx â€‹ kernel -\u0026gt; user; restores user registers from trapframe \u0026ldquo;context switch\u0026rdquo; \u0026ndash; the switch from one thread to another\nscheduler threads There\u0026rsquo;s one per core; each has a stack and a struct context kernel threads (processes) always switch to the current core\u0026rsquo;s scheduler thread which switches to another kernel thread, if one is RUNNABLE there are never direct kernel thread to kernel thread switches the reason: the scheduler\u0026rsquo;s separate stack simplifies cases like switching away from an exiting process the scheduler thread keeps scanning the process table until it finds a RUNNABLE thread (there may not be one!) if there is not RUNNABLE thread, the scheduler is \u0026ldquo;idle\u0026rdquo;\nnote: each core is either running its scheduler thread, or some other thread a given core runs only one thread at a time each thread is either running on exactly one core, or its registers are saved in its context if a thread isn\u0026rsquo;t running, its saved context refers to a call to swtch()\nstruct proc in proc.h p-\u0026gt;trapframe holds saved user thread\u0026rsquo;s registers p-\u0026gt;context holds saved kernel thread\u0026rsquo;s registers p-\u0026gt;kstack points to the thread\u0026rsquo;s kernel stack p-\u0026gt;state is RUNNING, RUNNABLE, SLEEPING, \u0026amp;c p-\u0026gt;lock protects p-\u0026gt;state (and other things\u0026hellip;)\nCode pre-emptive switch demonstration user/spin.c \u0026ndash; two CPU-bound processes my qemu has only one CPU let\u0026rsquo;s watch xv6 switch between them\nmake qemu-gdb gdb (gdb) c show user/spin.c spin you can see that they alternate, despite running continuously. xv6 is switching its one CPU between the two processes. how does the switching work?\nI\u0026rsquo;m going to cause a break-point at the timer interrupt.\n(gdb) b trap.c:207 (gdb) c (gdb) finish (gdb) where we\u0026rsquo;re in usertrap(), handling a device interrupt from the timer (timerinit() in kernel/start.c configures the RISC-V timer hardware).\nwhat was running when the timer interrupt happened?\n(gdb) print p-\u0026gt;name (gdb) print p-\u0026gt;pid (gdb) print/x *(p-\u0026gt;trapframe) (gdb) print/x p-\u0026gt;trapframe-\u0026gt;epc let\u0026rsquo;s look for the saved epc in user/spin.asm timer interrupted user code in the increment loop, no surprise\n(gdb) step ... into yield() in proc.c (gdb) next (gdb) print p-\u0026gt;state change p-\u0026gt;state from RUNNING to RUNNABLE -\u0026gt; give up CPU but want to run again. note: yield() acquires p-\u0026gt;lock since modifying p-\u0026gt;state and to prevent another CPU from running this RUNNABLE thread!\n(gdb) next 2 (gdb) step (into sched()) sched() makes some sanity checks, then calls swtch()\n(gdb) next 7 this is the context switch from a process\u0026rsquo;s kernel thread to the scheduler thread swtch will save the current RISC-V registers in first argument (p-\u0026gt;context) and restore previously-saved registers from 2nd argument (c-\u0026gt;context) let\u0026rsquo;s see what register values swtch() will restore\n(gdb) print/x cpus[0].context where is cpus[0].context.ra? i.e. where will swtch() return to? kernel.asm says it\u0026rsquo;s in the scheduler() function in proc.c\n(gdb) tbreak swtch (gdb) c we\u0026rsquo;re in kernel/swtch.S a0 is the first argument, p-\u0026gt;context a1 is the second argument, cpus[0].context swtch() saves current registers in xx(a0) (p-\u0026gt;context) swtch() then restores registers from xx(a1) (cpus[0].context) then swtch returns\nQ: swtch() neither saves nor restores $pc (program counter)! so how does it know where to start executing in the target thread?\nQ: why does swtch() save only 14 registers (ra, sp, s0..s11)? the RISC-V has 32 registers \u0026ndash; what about the other 18? zero, gp, tp t0-t6, a0-a7 note we\u0026rsquo;re talking about kernel thread registers all 32 user register have already been saved in the trapframe\nregisters at start of swtch:\n(gdb) print $pc -- swtch (gdb) print $ra -- sched (gdb) print $sp registers at end of swtch:\n(gdb) stepi 28 -- until ret (gdb) print $pc -- swtch (gdb) print $ra -- scheduler (gdb) print $sp -- stack0+??? -- entry.S set this up at boot (gdb) where (gdb) stepi we\u0026rsquo;re in scheduler() now, in the \u0026ldquo;scheduler thread\u0026rdquo;, on the scheduler\u0026rsquo;s stack\nscheduler() just returned from a call to swtch() it made that call a while ago, to switch to our process\u0026rsquo;s kernel thread that previous call saved scheduler()\u0026rsquo;s registers our processes\u0026rsquo;s call to swtch() restored scheduler()\u0026rsquo;s saved registers p here refers to the interrupted process\n(gdb) print p-\u0026gt;name (gdb) print p-\u0026gt;pid (gdb) print p-\u0026gt;state remember yield() acquired the process\u0026rsquo;s lock now scheduler releases it the scheduler() code looks like an ordinary acquire/release pair but in fact scheduler acquires, yield releases then yield acquires, scheduler releases unusual: the lock is released by a different thread than acquired it!\nQ: why hold p-\u0026gt;lock across swtch()? yield() acquires scheduler() releases could we release p-\u0026gt;lock just before calling swtch()?\np-\u0026gt;lock protects a few things: makes these steps atomic:\np-\u0026gt;state=RUNNABLE save registers in p-\u0026gt;context stop using p\u0026rsquo;s kernel stack â€‹ so other CPU\u0026rsquo;s scheduler won\u0026rsquo;t start running p until all steps complete\nmakes these steps atomic and uninterruptable:\np-\u0026gt;state=RUNNING move registers from context to RISC-V registers â€‹ so an interrupt won\u0026rsquo;t yield() and save not-yet-initialized\nâ€‹ RISC-V registers in context.\nscheduler()\u0026rsquo;s loop looks at all processes, finds one that\u0026rsquo;s RUNNABLE keeps looping until it finds something \u0026ndash; may be idle for a while in this demo, will find the other spin process let\u0026rsquo;s fast-forward to when scheduler() finds a RUNNABLE process\n(gdb) tbreak proc.c:474 (gdb) c scheduler() locked the new process, then set state to RUNNING now another CPUs\u0026rsquo; scheduler won\u0026rsquo;t run it\nit\u0026rsquo;s the other \u0026ldquo;spin\u0026rdquo; process:\n(gdb) print p-\u0026gt;name (gdb) print p-\u0026gt;pid (gdb) print p-\u0026gt;state let\u0026rsquo;s see where the new thread will start executing after swtch() by looking at $ra (return address) in its context\n(gdb) print/x p-\u0026gt;context (gdb) x/4i p-\u0026gt;context-\u0026gt;ra new thread will return into sched()\nlook at kernel/swtch.S (again)\n(gdb) tbreak swtch (gdb) c (gdb) stepi 28 -- now just about to execute swtch()\u0026#39;s ret (gdb) print $ra (gdb) where now we\u0026rsquo;re in a timer interrupt in the other spin process in the past it was interrupted, called yield() / sched() / swtch() but now it will resume, and return to user space\nnote: only swtch() writes contexts (except for initialization) only sched() and scheduler() call swtch() so for a kernel thread, context.ra always points into sched() and for a scheduler thread, context.ra always points into scheduler()\nnote: sched() calls swtch() \u0026ndash; then swtch() returns to sched() but it\u0026rsquo;s typically a different thread returning\nsched() and scheduler() are \u0026ldquo;co-routines\u0026rdquo; each knows what it is swtch()ing to each knows where swtch() return is coming from e.g. yield() and scheduler() cooperate about p-\u0026gt;lock and p-\u0026gt;state different from ordinary thread switching, where neither party typically knows which thread comes before/after\nQ: what is the \u0026ldquo;scheduling policy\u0026rdquo;?\ni.e. how does xv6 decide what to run next if multiple threads are RUNNABLE? is it a good policy?\nQ: is there pre-emptive scheduling of kernel threads?\nyes \u0026ndash; timer interrupt and yield() can occur while in kernel. yield() called by kerneltrap() in kernel/trap.c where to save registers of interrupted kernel code? not in p-\u0026gt;trapframe, since already has user registers. not in p-\u0026gt;context, since we\u0026rsquo;re about to call yield() and swtch() kernelvec.S pushes them on the kernel stack (since already in kernel). is pre-emption in the kernel useful? not critical in xv6. valuable if some system calls have lots of compute. or if we need a strict notion of thread priority.\nQ: why does scheduler() briefly enable interrupts, with intr_on()?\nThere may be no RUNNABLE threads They may all be waiting for I/O, e.g. disk or console Enable interrupts so device has a chance to signal completion and thus wake up a thread Otherwise, system will freeze\nQ: why does sched() forbid locks from being held when yielding the CPU?\n(other than p-\u0026gt;lock) i.e. sched() checks that noff == 1 suppose process P1 holding lock L1, yields CPU process P2 runs, tries acquire(L1) P2\u0026rsquo;s acquire spins with interrupts turned off so timer interrupts won\u0026rsquo;t occur so P2 won\u0026rsquo;t yield the CPU so P1 can\u0026rsquo;t execute so P1 won\u0026rsquo;t release L1, ever\nQ: can we get rid of the separate per-cpu scheduler thread?\ncould sched() directly swtch() to a new thread? so that sched() looks for next process to run? that would be faster \u0026ndash; avoids one of the swtch() calls yes \u0026ndash; but: scheduling loop would run on a thread\u0026rsquo;s kernel stack what if that thread is exiting? what if another cpu wants to run the thread? what if there are fewer threads than CPUs \u0026ndash; i.e. too few stacks? can be dealt with \u0026ndash; give it a try!\nSummary xv6 provides a convenient thread model for kernel code pre-emptive via timer interrupts transparent via switching registers and stack multi-core requires careful handling of stacks, locks next lecture: mechanisms for threads to wait for each other\nLab: Multithreading Uthread: switching between threads (moderate) è®¾è®¡å¹¶å®ç°ç”¨æˆ·çº§çº¿ç¨‹ç³»ç»Ÿçš„ä¸Šä¸‹æ–‡åˆ‡æ¢æœºåˆ¶ã€‚xv6ç³»ç»Ÿä¸­æä¾›äº†ä¸¤ä¸ªæ–‡ä»¶ï¼šuthread.c å’Œ uthread_switch.Sï¼Œä»¥åŠä¸€ä¸ªç”¨äºæ„å»º uthread ç¨‹åºçš„Makefileè§„åˆ™ã€‚uthread.c åŒ…å«äº†ä¸€ä¸ªåŸºæœ¬çš„ç”¨æˆ·çº§çº¿ç¨‹åŒ…ä»¥åŠä¸‰ä¸ªæµ‹è¯•çº¿ç¨‹çš„ä»£ç ï¼Œä½†ç¼ºå°‘åˆ›å»ºçº¿ç¨‹å’Œçº¿ç¨‹åˆ‡æ¢çš„éƒ¨åˆ†ä»£ç ã€‚\nä»»åŠ¡è¦æ±‚åŒ…æ‹¬ï¼š\nå®ç°çº¿ç¨‹åˆ›å»ºå’Œä¸Šä¸‹æ–‡åˆ‡æ¢çš„ä»£ç ã€‚ åœ¨çº¿ç¨‹ç¬¬ä¸€æ¬¡è¿è¡Œæ—¶ï¼Œç¡®ä¿æ‰§è¡Œåˆ›å»ºæ—¶ä¼ é€’çš„å‡½æ•°ï¼Œå¹¶ä½¿ç”¨è¯¥çº¿ç¨‹çš„æ ˆã€‚ å®ç° thread_switch æ¥ä¿å­˜å½“å‰çº¿ç¨‹çš„å¯„å­˜å™¨ï¼Œå¹¶æ¢å¤ä¸‹ä¸€ä¸ªçº¿ç¨‹çš„å¯„å­˜å™¨ï¼Œä»¥ç»§ç»­å…¶æ‰§è¡Œã€‚ 1.æ·»åŠ utcontextç»“æ„ä½“\n2.æ·»åŠ utcontextå­—æ®µ\nthread_createä¸­ä¿å­˜raå’Œsp 4.è¡¥å…¨uthread_switch.Sï¼Œ å®Œå…¨å‚ç…§swtch.S\n5.è°ƒç”¨thread_switchï¼Œè°ƒç”¨ thread_switch åˆ‡æ¢ä¸Šä¸‹æ–‡ï¼Œä¼ é€’å½“å‰çº¿ç¨‹å’Œä¸‹ä¸€ä¸ªçº¿ç¨‹çš„ä¸Šä¸‹æ–‡ï¼Œ æ³¨æ„è¿™é‡Œä¸Šä¸‹æ–‡åˆ‡æ¢éœ€è¦åœ¨æœ€åå®ç°ï¼Œå› ä¸ºè¿™ä¼šå½±å“next_thread, æ‰€ä»¥ä¸€å®šè¦åœ¨æ›´æ–°current_threadä¹‹åè°ƒç”¨thread_switchã€‚\nUsing threads (moderate) ç›®æ ‡ï¼šå®ç°çº¿ç¨‹å¹¶è¡Œç¼–ç¨‹ï¼Œä½¿ç”¨pthreadåº“åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹æ“ä½œå“ˆå¸Œè¡¨ï¼Œå¹¶ç¡®ä¿å…¶çº¿ç¨‹å®‰å…¨ã€‚\nä»»åŠ¡ç¯å¢ƒï¼šåœ¨æ”¯æŒå¤šæ ¸çš„çœŸå®Linuxæˆ–MacOSè®¡ç®—æœºä¸Šå®Œæˆï¼Œä¸ä½¿ç”¨xv6æˆ–qemuã€‚\nåˆå§‹é—®é¢˜ï¼šæä¾›çš„å“ˆå¸Œè¡¨ä»…åœ¨å•çº¿ç¨‹æƒ…å†µä¸‹æ­£ç¡®ï¼Œå¤šçº¿ç¨‹ç¯å¢ƒä¸‹ä¼šæœ‰ç¼ºå¤±é”®çš„é—®é¢˜ã€‚\næ­¥éª¤ï¼š\nä½¿ç”¨pthreadåº“å¯¹å“ˆå¸Œè¡¨è¿›è¡Œå¹¶å‘æ“ä½œã€‚ è¿è¡Œæµ‹è¯•ph 1å’Œph 2ï¼Œè§‚å¯Ÿä¸åŒçº¿ç¨‹ä¸‹çš„æ’å…¥å’Œè·å–æ€§èƒ½ã€‚ åˆ†æç¼ºå¤±é”®å‡ºç°çš„åŸå› ï¼Œæäº¤è§£é‡Šï¼ˆsequence of eventsï¼‰ã€‚ è§£å†³æ–¹æ¡ˆï¼šåœ¨put()å’Œget()å‡½æ•°ä¸­æ·»åŠ é”æœºåˆ¶ï¼Œç¡®ä¿å¤šçº¿ç¨‹æ“ä½œæ—¶æ²¡æœ‰é”®ä¸¢å¤±ã€‚\nä½¿ç”¨pthread_mutex_tç›¸å…³å‡½æ•°å®ç°åŠ é”å’Œè§£é”ã€‚ ä¿®æ”¹ä»£ç ï¼Œé€šè¿‡æµ‹è¯•ph_safeï¼Œç¡®ä¿ä¸¤çº¿ç¨‹ä¸‹æ— é”®ä¸¢å¤±ã€‚ è¿›ä¸€æ­¥ä¼˜åŒ–ï¼šå°è¯•åœ¨æŸäº›æƒ…å†µä¸‹å…è®¸å¹¶è¡Œæ’å…¥æ“ä½œï¼Œä¾‹å¦‚ä½¿ç”¨æ¯ä¸ªå“ˆå¸Œæ¡¶ï¼ˆbucketï¼‰ä¸€ä¸ªé”ï¼Œä»¥æé«˜æ€§èƒ½ã€‚\nä¿®æ”¹ä»£ç ï¼Œä½¿å…¶é€šè¿‡ph_safeå’Œph_fastæµ‹è¯•ï¼Œè¦æ±‚åŒçº¿ç¨‹è‡³å°‘è¾¾åˆ°å•çº¿ç¨‹1.25å€çš„æ’å…¥é€Ÿåº¦ã€‚ 1.å®šä¹‰é”ï¼Œ å®šä¹‰å…¨å±€é”å¯ä»¥ä¿è¯å¤šçº¿ç¨‹æƒ…å†µä¸‹ä¸ä¼šä¸¢å¤±key, ä¸ºæ¯ä¸€ä¸ªæ¡¶åŠ é”å¯ä»¥åœ¨ä¿è¯ä¸ä¸¢å¤±keyçš„æƒ…å†µä¸‹ä¿è¯æ€§èƒ½\n2.åˆå§‹åŒ–é”\n3.åœ¨put()å’Œget()ä¸­åŠ é”ä»¥åŠè§£é”\nBarrier(moderate) å®ç°ä¸€ä¸ªçº¿ç¨‹å±éšœï¼ˆbarrierï¼‰ï¼Œå³æ‰€æœ‰çº¿ç¨‹åœ¨åŒä¸€ç‚¹ç­‰å¾…ï¼Œç›´åˆ°æ‰€æœ‰çº¿ç¨‹éƒ½åˆ°è¾¾è¯¥ç‚¹åå†ç»§ç»­ã€‚éœ€è¦ä½¿ç”¨ pthread çš„æ¡ä»¶å˜é‡ (pthread_cond_wait å’Œ pthread_cond_broadcast) æ¥åè°ƒçº¿ç¨‹ã€‚ä»»åŠ¡æ˜¯åœ¨ barrier.c ä¸­ä¿®å¤å·²å­˜åœ¨çš„é—®é¢˜ï¼Œç¡®ä¿æ‰€æœ‰çº¿ç¨‹åœ¨è°ƒç”¨ barrier() æ—¶éƒ½è¢«é˜»å¡ï¼Œç›´åˆ°å…¨éƒ¨çº¿ç¨‹åˆ°è¾¾ã€‚\nå…³é”®è¦æ±‚ï¼š\nä½¿ç”¨æ¡ä»¶å˜é‡å®ç°çº¿ç¨‹åŒæ­¥ã€‚ å¤„ç†å¤šæ¬¡å¾ªç¯ä¸­çš„å±éšœè°ƒç”¨ï¼Œæ¯æ¬¡å±éšœéƒ½ä»£è¡¨ä¸€ä¸ªâ€œå›åˆâ€ã€‚ é¿å…ä¸€ä¸ªçº¿ç¨‹å¿«é€Ÿç¦»å¼€å±éšœå¹¶å½±å“å…¶ä»–çº¿ç¨‹ã€‚ ç¡®ä¿è§£å†³æ–­è¨€é”™è¯¯å¹¶é€šè¿‡æµ‹è¯•ã€‚ åœ¨æ¯ä¸€ä¸ªthreadä¸­è°ƒç”¨barrierï¼Œ è®°å½•æ‰€æœ‰åˆ°è¾¾çš„threadæ•°é‡ï¼Œ å¦‚æœæ•°é‡ç­‰äºè®¾ç½®çš„çº¿ç¨‹æ•°ï¼Œåˆ™å¼€å§‹ä¸‹ä¸€roundï¼Œå¦åˆ™å°†æ­¤çº¿ç¨‹æ‰§è¡Œæ­¤æ“ä½œ ï¼š\npthread_cond_wait(\u0026amp;bstate.barrier_cond, \u0026amp;bstate.barrier_mutex); // Release mutex and wait ä¿è¯è¯¥çº¿ç¨‹å¤„äºç­‰å¾…çŠ¶æ€ï¼Œç­‰å¾…æ‰€æœ‰çº¿ç¨‹éƒ½å®Œæˆæ­¤roundã€‚\n","permalink":"https://kennems.github.io/posts/tech/mit6.s08111--thread-switching/","summary":"MIT6.S081(11)- Thread switching Topic: more \u0026ldquo;under the hood\u0026rdquo; with xv6 Previously: system calls, interrupts, page tables, locks Today: process/thread switching Why support multiple tasks? Time-sharing: many users and/or many running programs. program structure: prime number sieve. parallel speedup on multi-core hardware. Threads are an abstraction to simplify programming when there are many tasks. thread = an independent serial execution \u0026ndash; registers, pc, stack the threading system interleaves the execution of","title":"MIT6.S081(11)- Thread switching"},{"content":"MIT6.S081(10)-Locking Why talk about locking? apps want to use multi-core processors for parallel speed-up so kernel must deal with parallel system calls and thus parallel access to kernel data (buffer cache, processes, \u0026amp;c) locks help with correct sharing of data locks can limit parallel speedup\nWhat goes wrong if we don\u0026rsquo;t have locks Case study: delete acquire/release in kalloc.c Boot kernel works! Run usertests all tests pass! except we lose some pages Why do we lose pages? picture of shared-memory multiprocessor race between two cores calling kfree() BUMMER: we need locks for correctness but loose performance (kfree is serialized)\nThe lock abstraction:\nlock l\racquire(l)\rx = x + 1 -- \u0026#34;critical section\u0026#34;\rrelease(l) a lock is itself an object if multiple threads call acquire(l) only one will return right away the others will wait for release() \u0026ndash; \u0026ldquo;block\u0026rdquo; a program typically has lots of data, lots of locks if different threads use different data, then they likely hold different locks, so they can execute in parallel \u0026ndash; get more work done. note that lock l is not specifically tied to data x the programmer has a plan for the correspondence\nWhen to Lock ? A conservative rule to decide when you need to lock: any time two threads use a memory location, and at least one is a write don\u0026rsquo;t touch shared data unless you hold the right lock!\n(too strict: program logic may sometimes rule out sharing; lock-free)\n(too loose: printf(); not always simple lock/data correspondence)\nCould locking be automatic? perhaps the language could associate a lock with every data object compiler adds acquire/release around every use less room for programmer to forget! that idea is often too rigid:\nrename(\u0026#34;d1/x\u0026#34;, \u0026#34;d2/y\u0026#34;):\rlock d1, erase x, unlock d1\rlock d2, add y, unlock d2 â€‹ problem: the file didn\u0026rsquo;t exist for a while! â€‹ rename() should be atomic â€‹ other system calls should see before, or after, not in between â€‹ otherwise too hard to write programs â€‹ we need:\nlock d1 ; lock d2\rerase x, add y\runlock d2; unlock d1 that is, programmer often needs explicit control over the region of code during which a lock is held in order to hide awkward intermediate states\nWays to think about what locks achieve locks help avoid lost updates locks help you create atomic multi-step operations \u0026ndash; hide intermediate states locks help operations maintain invariants on a data structure assume the invariants are true at start of operation operation uses locks to hide temporary violation of invariants operation restores invariants before releasing locks\nProblem: deadlock notice rename() held two locks what if:\ncore A core B\rrename(d1/x, d2/y) rename(d2/a, d1/b)\rlock d1 lock d2\rlock d2 ... lock d1 ... solution: â€‹ programmer works out an order for all locks â€‹ all code must acquire locks in that order â€‹ i.e. predict locks, sort, acquire \u0026ndash; complex!\nLocks versus modularity locks make it hard to hide details inside modules to avoid deadlock, I need to know locks acquired by functions I call and I may need to acquire them before calling, even if I don\u0026rsquo;t use them i.e. locks are often not the private business of individual modules\nLocks and parallelism locks prevent parallel execution to get parallelism, you often need to split up data and locks in a way that lets each core use different data and different locks \u0026ldquo;fine grained locks\u0026rdquo; choosing best split of data/locks is a design challenge whole FS; directory/file; disk block whole kernel; each subsystem; each object you may need to re-design code to make it work well in parallel example: break single free memory list into per-core free lists helps if threads were waiting a lot on lock for single free list such re-writes can require a lot of work!\nLock granularity advice start with big locks, e.g. one lock protecting entire module less deadlock since less opportunity to hold two locks less reasoning about invariants/atomicity required measure to see if there\u0026rsquo;s a problem big locks are often enough \u0026ndash; maybe little time spent in that module re-design for fine-grained locking only if you have to\nLet\u0026rsquo;s look at locking in xv6.\nA typical use of locks: uart.c typical of many O/S\u0026rsquo;s device driver arrangements diagram: user processes, kernel, UART, uartputc, remove from uart_tx_buf, uartintr() sources of concurrency: processes, interrupt only one lock in uart.c: uart_tx_lock \u0026ndash; fairly coarse-grained uartputc() \u0026ndash; what does uart_tx_lock protect? 1. no races in uart_tx_buf operations 2. if queue not empty, UART h/w is executing head of queue 3. no concurrent access to UART write registers uartintr() \u0026ndash; interrupt handler acquires lock \u0026ndash; might have to wait at interrupt level! removes character from uart_tx_buf hands next queued char to UART h/w (2) touches UART h/w registers (3)\nHow to implement locks?\nwhy not:\rstruct lock { int locked; }\racquire(l) {\rwhile(1){\rif(l-\u0026gt;locked == 0){ // A\rl-\u0026gt;locked = 1; // B\rreturn;\r}\r}\r} oops: race between lines A and B how can we do A and B atomically?\nAtomic swap instruction:\na5 = 1\rs1 = \u0026amp;lk-\u0026gt;locked\ramoswap.w.aq a5, a5, (s1) does this in hardware:\nlock addr globally (other cores cannot use it)\rtemp = *s5\r*addr = a5\ra5 = temp\runlock addr RISC-V h/w provides a notion of locking a memory location different CPUs have had different implementations diagram: cores, bus, RAM, lock thing so we are really pushing the problem down to the hardware h/w implements at granularity of cache-line or entire bus memory lock forces concurrent swamp to run one at a time, not interleaved\nLook at xv6 spinlock implementation\nacquire(l){\rwhile(__sync_lock_test_and_set(\u0026amp;lk-\u0026gt;locked, 1) != 0)\r} if l-\u0026gt;locked was already 1, sync_lock_test_and_set sets to 1 (again), returns 1, and the loop continues to spin if l-\u0026gt;locked was 0, at most one lock_test_and_set will see the 0; it will set it to 1 and return 0; other test_an_set will return 1 this is a \u0026ldquo;spin lock\u0026rdquo;, since waiting cores \u0026ldquo;spin\u0026rdquo; in acquire loop\nwhat is the push_off() about? why disable interrupts? release(): sets lk-\u0026gt;locked = 0 and re-enables interrupts\nDetail: memory read/write ordering suppose two cores use a lock to guard a counter, x and we have a naive lock implementation\nCore A: Core B:\rlocked = 1\rx = x + 1 while(locked == 1)\rlocked = 0 ...\rlocked = 1\rx = x + 1\rlocked = 0 the compiler AND the CPU re-order memory accesses i.e. they do not obey the source program\u0026rsquo;s order of memory references e.g. the compiler might generate this code for core A:\nlocked = 1\rlocked = 0\rx = x + 1 â€‹ i.e. move the increment outside the critical section! â€‹ the legal behaviors are called the \u0026ldquo;memory model\u0026rdquo; release()\u0026rsquo;s call to __sync_synchronize() prevents re-order â€‹ compiler won\u0026rsquo;t move a memory reference past a __sync_synchronize() â€‹ and (may) issue \u0026ldquo;memory barrier\u0026rdquo; instruction to tell the CPU acquire()\u0026rsquo;s call to __sync_synchronize() has a similar effect: if you use locks, you don\u0026rsquo;t need to understand the memory ordering rules â€‹ you need them if you want to write exotic \u0026ldquo;lock-free\u0026rdquo; code\nWhy spin locks? don\u0026rsquo;t they waste CPU while waiting? why not give up the CPU and switch to another process, let it run? what if holding thread needs to run; shouldn\u0026rsquo;t waiting thread yield CPU? spin lock guidelines: hold spin locks for very short times don\u0026rsquo;t yield CPU while holding a spin lock systems provide \u0026ldquo;blocking\u0026rdquo; locks for longer critical sections waiting threads yield the CPU but overheads are typically higher you\u0026rsquo;ll see some xv6 blocking schemes later\nAdvice: don\u0026rsquo;t share if you don\u0026rsquo;t have to start with a few coarse-grained locks instrument your code \u0026ndash; which locks are preventing parallelism? use fine-grained locks only as needed for parallel performance use an automated race detector\nLab: Copy-on-Write Fork for xv6 Implement copy-on write(hard) ","permalink":"https://kennems.github.io/posts/tech/mit6.s08110-locks/","summary":"MIT6.S081(10)-Locking Why talk about locking? apps want to use multi-core processors for parallel speed-up so kernel must deal with parallel system calls and thus parallel access to kernel data (buffer cache, processes, \u0026amp;c) locks help with correct sharing of data locks can limit parallel speedup What goes wrong if we don\u0026rsquo;t have locks Case study: delete acquire/release in kalloc.c Boot kernel works! Run usertests all tests pass! except we lose","title":"MIT6.S081(10)-Locking"},{"content":"MIT6.S081(9)-Interrupts 6.S081 2020 Lecture 9: Interrupts\nInterrupts hardware wants attention now! e.g., pkt arrived, clock interrupt software must set aside current work and respond on RISC-V use same trap mechanism as for syscalls and exceptions new issues/complications: asynchronous interrupts running process interrupt handler may not run in context of process who caused interrupt concurrency devices and process run in parallel programming devices device can be difficult to program\nWhere do device interrupts come from? diagram: Fig 1 of SiFive board in FU540-C000-v1.0.pdf CPUs, CLINT, PLIC, devices Fig 3 has more detail for interrupts Section 8 and 9 of FU540-C000-v1.0.pdf UART (universal asynchrnonous receiver/transmitter) See Section 13 of FU540-C000-v1.0.pdf Although the QEMU version is slightly different Follows http://byterunner.com/16550.html the interrupt tells the kernel the device hardware wants attention the driver (in the kernel) knows how to tell the device to do things often the interrupt handler calls the relevant driver but other arrangements are possible (schedule a thread; poll) [diagram: top-half/bottom-half]\nCase study: console output and keyboard input $ ls how does $ show up on console? printing to simulated console: driver puts characters into UART\u0026rsquo;s send FIFO interrupt when character has been sent informs driver that it can send more how are the characters l and s read from keyboard (and echo to console)? reading from simulated keyboard user hits key, which returns in UART interrupt driver gets character from UART\u0026rsquo;s receive FIFO\nhow does kernel know which device interrupted? each device has a unique source/IRQ (interrupt request) number defined by hardware platform UART0 is 10 on qemu (see kernel/memlayout.h) different on SiFive board\nRISC-V interrupt-related registers sie \u0026mdash; supervisor interrupt enabled register one bit per software interrupt, external interrupt, timer interrupt sstatus \u0026mdash; supervisor status register one bit to enable interrupts sip \u0026mdash; supervisor interrupt pending register scause \u0026mdash; supervisor cause register stvec \u0026mdash; supervisor trap vector register mdeleg \u0026mdash; machine delegate register\nLet\u0026rsquo;s look at how xv6 sets up the interrupt machinery start(): w_sie(r_sie() | SIE_SEIE | SIE_STIE | SIE_SSIE); main(): consoleinit(); uartinit() plicinit(); scheduler(); intr_on(); w_sstatus(r_sstatus() | SSTATUS_SIE);\nPrinting \u0026ldquo;$\u0026rdquo; shell is started with fd 0, 1, 2 for \u0026ldquo;console\u0026rdquo; setup by init Unix presents console device as a file!\nprintf() putc() write(2, \u0026ldquo;$\u0026rdquo;, 1)\nsys_write() filewrite() consolewrite() uartputc() add \u0026ldquo;$\u0026rdquo; to buffer uartstart() // kick off sending character put the character in UART fifo return to user space \u0026hellip; while at the same time UART is sending character to console\nshell calls sys_read() to wait for input (see below)\nUART completes sending character and raises interrupt PLIC passes interrupt on to a CPU the CPU performs the following steps on interrupt: - If the trap is a device interrupt, and the SIE bit is clear, don\u0026rsquo;t do any of the following. - Disable interrupts by clearing SIE. Prevents interrupts being interrupted - Copy the pc to sepc - Save the current mode (user or supervisor) in the SPP bit in sstatus. - Set scause to reflect the interrupt\u0026rsquo;s cause. - Set the mode to supervisor. - Copy stvec to the pc. stvec contains kernelvec or usertrap, depending if interrupt happened in user space or kernel space - Start executing at the new pc. same mechanism we have seen before systems calls, pgfaults, etc.\nboth kernelvec/usertrap call devintr() to check for interrupts\rexternal interrupt for UART\rplic_claim()\ruartintr()\rif there are more characters send them\rmay send multiple characters\rplic_complete()\rreturn from kernelvec/usertrap\rresumes interrupted computation\rWhat if several interrupts arrive? The PLIC distributes interrupts among cores Interrupts can be handled in parallel If no CPU claims the interrupt, the interrupt stays pending Eventually each interrupt is delivered to some CPU\nInterrupts expose several forms of concurrency\nBetween device and CPU Producer/consumer parallelism\rInterrupt may interrupt the CPU that is returning to shell (still in kernel) Disable interrupts when code must be atomic\rInterrupt may run on different CPU in parallel with shell (or returning to shell) Locks; topic for Wed\rProducer/consumer parallelism For printing shell is producer device is consumer To decouple the two: a buffer in the driver top-half puts chars into buffer wait if there is no room runs in the context of the calling process bottom half remove chars from buffer interrupt handler wakes up producers may not run the context of the shell Note: bottom half and top half may run in parallel on different CPUs We will get to this in a later lecture\nInterrupts interrupt running code Interrupts run between my code For example, my code is 1. addi sp,sp,-48 2. sd ra,40(sp) Q: Might other code run between 1 and 2? Yes! Interrupt may happen between 1 and 2 e.g., timer interrupt or uart interrupt For user code maybe not that bad Kernel will resume user code in in the same state For kernel code could be difficult Interrupt handler may update state that is observable by my code my code: interrupt: x = 0 if x = 0 then x = 1 f() f() may be executed or may not be executed! To make a block of code \u0026ldquo;atomic\u0026rdquo;, turn off interrupts intr_off(): w_sstatus(r_sstatus() \u0026amp; ~SSTATUS_SIE); RISC-V turns of interrupt on a trap (interrupt/exception) Can kernel handle interrupt in trampoline.S? Our first glimps of \u0026ldquo;concurrency\u0026rdquo; We\u0026rsquo;ll get back to this when discussing locking\n$ shell is in read system call to get input from console usertrap() for system call w_stvec((uint64)kernelvec); consoleread() sleep() scheduler() intr_on()\n$ l user hits l, which causes UART interrupt\nkernelvec: save space on current stack; which stack? save registers on the current stack in our example, the scheduler thread\u0026rsquo;s stack kerneltrap() devintr() uartintr() c = uartgetc() consoleintr(c) handle ctrl characters echo character (\u0026rsquo;l\u0026rsquo;) using uartput_sync() put c in buffer wakeup reader return from devintr() return from kerneltrap() load registers back sret Q: where does sret return too where ever the interrupt happened (in scheduler loop in this case) scheduler runs shell so that it can collect \u0026rsquo;l'\nProducer/consumer parallelism For reading from keyboard opposite from printing shell is consumer device is producer\nInterrupt evolution Interrupts used to be relatively fast; now they are slow old approach: every event causes an interrupt, simple h/w, smart s/w new approach: h/w completes lots of work before interrupting Some devices generate events faster than one per microsecond e.g. gigabit ethernet can deliver 1.5 million small packets / second An interrupt takes on the order of a microsecond save/restore state cache misses what to do if interrupt comes in faster than 1 per microsecond?\nPolling: another way of interacting with devices Processor spins until device wants attention Wastes processor cycles if device is slow One example in xv6: uartputc_sync() But inexpensive if device is fast No saving of registers etc. If events are always waiting, no need to keep alerting the software\nPolling versus interrupts Polling rather than interrupting, for high-rate devices Interrupt for low-rate devices, e.g. keyboard constant polling would waste CPU Switch between polling and interrupting automatically interrupt when rate is low (and polling would waste CPU cycles) poll when rate is high (and interrupting would waste CPU cycles) Faster forwarding of interrupts to user space for page faults and user-handled devices h/w delivers directly to user, w/o kernel intervention? faster forwarding path through kernel? We will be seeing many of these topics later in the course\nhardware wants attention now ! Driver RISC-V support for interrupts SIE : supervisor interrupt enabled register\nSSTATUS ï¼šsupervisor status register one bit to enable interrupts\nSIP : supervisor interrupt pending register\nSCAUSE : supervisor cause register\nSTVEC : supervisor trap vector register\nMDELEG : machine delegate register\nProducer / consumer parallelism For reading from keyboard opposite from printing\nshell is consumer device is producer Interrupt evolution Polling\nPolling versus interrupts Polling rather than interrupting, for high-rate devices\nInterrupt for low-rate devices, e.g. keyboard\n","permalink":"https://kennems.github.io/posts/tech/mit6.s0819-interrupts/","summary":"MIT6.S081(9)-Interrupts 6.S081 2020 Lecture 9: Interrupts Interrupts hardware wants attention now! e.g., pkt arrived, clock interrupt software must set aside current work and respond on RISC-V use same trap mechanism as for syscalls and exceptions new issues/complications: asynchronous interrupts running process interrupt handler may not run in context of process who caused interrupt concurrency devices and process run in parallel programming devices device can be difficult to program Where do","title":"MIT6.S081(9)-Interrupts"},{"content":"MIT6.S081(8)-Page faults plan: cool things you can do with vm\nBetter performance/efficiency e.g., one zero-filled page e.g., copy-on-write fork New features e.g., memory-mapped files virtual memory: several views\nprimary purpose: isolation each process has its own address space Virtual memory provides a level-of-indirection provides kernel with opportunity to do cool stuff already some examples: shared trampoline page guard page but more possible\u0026hellip; Key idea: change page tables on page fault Page fault is a form of a trap (like a system call) Xv6 panics on page fault But you don\u0026rsquo;t have to panic! Instead: update page table instead of panic restart instruction (see userret() from traps lecture) Combination of page faults and updating page table is powerful!\nRISC-V page faults 3 of 16 exceptions are related to paging Exceptions cause controlled transfers to kernel See traps lecture\nInformation we might need at page fault to do something interesting:\nThe virtual address that caused the fault See stval register; page faults set it to the fault address The type of violation that caused the fault See scause register value (instruction, load, and Store page fault) The instruction and mode where the fault occurred User IP: tf-\u0026gt;epc U/K mode: implicit in usertrap/kerneltrap lazy/on-demand page allocation\nsbrk() is old fashioned; applications often ask for memory they need for example, the allocate for the largest possible input but an application will typically use less if they ask for much, sbrk() could be expensive for example, if all memory is in use, have to wait until kernel has evicted some pages to free up memory sbrk allocates memory that may never be used. moderns OSes allocate memory lazily plan: allocate physical memory when application needs it adjust p-\u0026gt;sz on sbrk, but don\u0026rsquo;t allocate when application uses that memory, it will result in page fault on pagefault allocate memory resume at the fault instruction may use less memory if not used, no fault, no allocation spreads the cost of allocation over the page faults instead of upfront in sbrk() demo modify sysproc.c modify trap.c modify vm.c one zero-filled page (zero fill on demand)\napplications often have large part of memory that must zero global arrays, etc. the \u0026ldquo;block starting symbol\u0026rdquo; (bbs) segment thus, kernel must often fill a page with zeros idea: memset one page with zeros map that page copy-on-write when kernel needs zero-filled page on write make copy of page and map it read/write in app address space copy-on-write fork\nobservation: xv6 fork copies all pages from parent (see fork()) but fork is often immediately followed by exec idea: share address space between parent and child modify fork() to map pages copy-on-write use extra available system bits (RSW) in PTEs on page fault, make copy of page and map it read/write demand paging\nobservation: exec loads the complete file into memory (see exec.c) expensive: takes time to do so (e.g., file is stored on a slow disk) unnecessary: maybe not the whole file will be used idea: load pages from the file on demand allocate page table entries, but mark them on-demand on fault, read the page in from the file and update page table entry need to keep some meta information about where a page is located on disk this information is typically in structure called virtual memory area (VMA) challenge: file larger than physical memory (see next idea) use virtual memory larger than physical memory\nobservation: application may need more memory than there is physical memory idea: store less-frequently used parts of the address space on disk page-in and page-out pages of the address address space transparently works when working sets fits in physical memory most popular replacement strategy: least-recently used (LRU) the A(cess) bit in the PTE helps the kernel implementing LRU demo: run top and vmstat on laptop and dialup.athena.mit.edu see VIRT RES MEM SHR columns memory-mapped files\nidea: allow access to files using load and store can easily read and writes part of a file e.g., don\u0026rsquo;t have to change offset using lseek system call Unix systems a new system call for m-mapped files: void *mmap(void *addr, size_t length, int prot, int flags, int fd, off_t offset); kernel page-in pages of a file on demand when memory is full, page-out pages of a file that are not frequently used shared virtual memory\nidea: allow processes on different machines to share virtual memory gives the illusion of physical shared memory, across a network replicate pages that are only read invalidate copies on write TLB management CPUs caches paging translation for speed xv6 flushes entire TLB during user/kernel transitions why? RISC-V allows more sophisticated plans\nPTE_G: global TLB bits what page could use this? ASID numbers TLB entries are tagged with ASID, so kernel can flush selectively SATP takes an ASID number sfence.vma also takes an ASID number Large pages 2MB and 1GB Virtual memory is still evolving Recent changes in Linux PKTI to handle meltdown side-channel (https://en.wikipedia.org/wiki/Kernel_page-table_isolation) xv6 basically implements KPTI Somewhat recent changes Support for 5-level page tables (57 address bits!) Support for ASIDs Less recent changes Support for large pages NX (No eXecute) PTE_X flag\n\u0026mdash; COW in Linux\nhttps://lwn.net/Articles/849876/\nPage faults Virtual Memory Benefits Isolation Level of Indirection Va -\u0026gt; Pa\nInformation Needed the faulting va ( va -\u0026gt; stval register) the type of page fault ( scause ) the va of instruction that cause the page fault (sepc, trapframe) Allocation : sbrk() sbrk() -\u0026gt; eager allocation\napplcations tend to over ask.\nLazy allocation sbrk() do nothing\nonly grow p-\u0026gt;sz\nPgFault : va \u0026lt; p-\u0026gt;sz \u0026gt; stack\nallocate 1 page\nzero the page\nmap the page\nrestart instruction\nCopy-on-Write(Cow) - Fork Zero-fill-on-demand Demand paging Memory-mapped-files shared virtual memory Lab: xv6 lazy page allocation Eliminate allocation from sbrk() (easy) Lazy allocation (moderate) Lazytests and Usertests (moderate) ","permalink":"https://kennems.github.io/posts/tech/mit6.s0818-page-faults/","summary":"MIT6.S081(8)-Page faults plan: cool things you can do with vm Better performance/efficiency e.g., one zero-filled page e.g., copy-on-write fork New features e.g., memory-mapped files virtual memory: several views primary purpose: isolation each process has its own address space Virtual memory provides a level-of-indirection provides kernel with opportunity to do cool stuff already some examples: shared trampoline page guard page but more possible\u0026hellip; Key idea: change page tables on page fault","title":"MIT6.S081(8)-Page faults"},{"content":"å‘¨èµ›250915 æ—¶éš”å¤šæ—¥å†æ‰é‡æ–°å¼€å¯å‘¨èµ›ã€‚è¿™åœºDPå±…å¤šã€‚\nT2-3290. æœ€é«˜ä¹˜æ³•å¾—åˆ† é¢˜ç›®å¤§æ„ï¼š ç»™å®šä¸¤ä¸ªæ•°ç»„ a å’Œ bï¼Œæ•°ç»„ a é•¿åº¦ä¸º 4ï¼Œæ•°ç»„ b é•¿åº¦è‡³å°‘ä¸º 4ã€‚éœ€è¦ä» b ä¸­é€‰æ‹© 4 ä¸ªé€’å¢ä¸‹æ ‡ i0 \u0026lt; i1 \u0026lt; i2 \u0026lt; i3ï¼Œè®¡ç®— a[0] * b[i0] + a[1] * b[i1] + a[2] * b[i2] + a[3] * b[i3]ï¼Œå¹¶è¿”å›æœ€å¤§å¾—åˆ†ã€‚\nä»£ç å®ç°æ€è·¯ï¼š ä½¿ç”¨åŠ¨æ€è§„åˆ’çš„æ€æƒ³è§£å†³é—®é¢˜ã€‚å®šä¹‰ f[i][j] è¡¨ç¤ºåœ¨å‰ i ä¸ªå…ƒç´ ä¸­é€‰æ‹©äº† j ä¸ªæ•°æ—¶çš„æœ€å¤§å¾—åˆ†ã€‚ åˆå§‹åŒ– f[0][0] = 0ï¼Œè¡¨ç¤ºåœ¨æ²¡æœ‰å…ƒç´ çš„æƒ…å†µä¸‹é€‰æ‹© 0 ä¸ªæ•°æ—¶å¾—åˆ†ä¸º 0ï¼Œå…¶ä½™æƒ…å†µåˆå§‹åŒ–ä¸ºè´Ÿæ— ç©·å¤§ã€‚ éå†æ•°ç»„ bï¼Œå¯¹äºæ¯ä¸€ä¸ªä½ç½® iï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©ä¿ç•™å½“å‰çŠ¶æ€ï¼ˆå³ä¸é€‰ç¬¬ i ä¸ªå…ƒç´ ï¼Œç»§æ‰¿ä¸Šä¸€ä¸ªçŠ¶æ€çš„å€¼ï¼‰ï¼Œæˆ–è€…é€‰æ‹©ç¬¬ i ä¸ªå…ƒç´ ï¼ˆæ›´æ–°å½“å‰çŠ¶æ€ï¼Œè®¡ç®—ä¹˜ç§¯å¹¶åŠ åˆ°ä¸Šä¸€ä¸ªçŠ¶æ€ f[i-1][j-1] ä¸­ï¼‰ã€‚ æœ€åï¼Œç»“æœå°±æ˜¯ä»é•¿åº¦ä¸º 4 çš„é€‰æ‹©ä¸­å¾—åˆ°çš„æœ€å¤§å¾—åˆ† max(f[i][4])ã€‚ class Solution: def maxScore(self, a: List[int], b: List[int]) -\u0026gt; int: n = len(b) f = [[-inf]*5 for _ in range(n + 1)] # f[i][j] è¡¨ç¤º b ä¸­ å‰ i ä¸ªæ•°å­—(ä¸åŒ…æ‹¬i)ä¸­é€‰ j ä¸ªå¯ä»¥è·å¾—çš„æœ€å¤§å¾—åˆ† f[0][0] = 0 for i in range(1, n + 1): for j in range(min(4, i) + 1): f[i][j] = f[i-1][j] if j: f[i][j] = max(f[i][j], f[i-1][j-1] + a[j - 1] * b[i - 1]) return max(f[i][4] for i in range(4, n + 1)) T3\u0026amp;4-3291. å½¢æˆç›®æ ‡å­—ç¬¦ä¸²éœ€è¦çš„æœ€å°‘å­—ç¬¦ä¸²æ•° I é¢˜ç›®å¤§æ„ï¼š ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„ words å’Œä¸€ä¸ªç›®æ ‡å­—ç¬¦ä¸² targetï¼Œéœ€è¦é€šè¿‡è¿æ¥ words ä¸­çš„æœ‰æ•ˆå‰ç¼€å­—ç¬¦ä¸²ç»„æˆç›®æ ‡å­—ç¬¦ä¸² targetã€‚è¦æ±‚è®¡ç®—è¿æ¥æœ‰æ•ˆå­—ç¬¦ä¸²å½¢æˆ target æ‰€éœ€çš„æœ€å°‘å­—ç¬¦ä¸²æ•°é‡ã€‚å¦‚æœæ— æ³•ç»„æˆ targetï¼Œè¿”å› -1ã€‚\nä»£ç å®ç°æ€è·¯ï¼š ä½¿ç”¨ Z å‡½æ•° è®¡ç®— words ä¸­æ¯ä¸ªå­—ç¬¦ä¸²ä¸ target å¯¹åº”ä½ç½®çš„æœ€é•¿åŒ¹é…å‰ç¼€ï¼Œå¾—åˆ°æ¯ä¸ªä½ç½®èƒ½åŒ¹é…çš„æœ€å¤§é•¿åº¦ nxt æ•°ç»„ã€‚ åŠ¨æ€è§„åˆ’æ•°ç»„ f[i] è¡¨ç¤ºåˆ°è¾¾ target çš„ç¬¬ i ä¸ªå­—ç¬¦æ‰€éœ€çš„æœ€å°‘å­—ç¬¦ä¸²æ•°é‡ï¼Œåˆå§‹æ—¶ f[0] = 0ï¼Œè¡¨ç¤ºåˆ°è¾¾åˆå§‹ä½ç½®éœ€è¦ 0 ä¸ªå­—ç¬¦ä¸²ã€‚ éå† targetï¼Œå¦‚æœæŸä¸ªä½ç½®æ— æ³•é€šè¿‡å‰é¢çš„ç»„åˆåˆ°è¾¾ï¼Œåˆ™è¿”å› -1ï¼›å¦åˆ™æ ¹æ®å‰é¢çš„åŒ¹é…æƒ…å†µä¸æ–­æ›´æ–° f æ•°ç»„ï¼Œè®°å½•å½“å‰èƒ½å¤Ÿå»¶ä¼¸çš„æœ€é•¿æœ‰æ•ˆå‰ç¼€ lastã€‚ åœ¨éå†è¿‡ç¨‹ä¸­ï¼Œå¦‚æœæ‰¾åˆ°ä¸€ä¸ªä½ç½® iï¼Œå¯ä»¥ç”¨æ›´å°‘çš„å­—ç¬¦ä¸²è¦†ç›–æ›´é•¿çš„å‰ç¼€ï¼Œåˆ™æ›´æ–° f æ•°ç»„å’Œ lastã€‚ æœ€åè¿”å› f[n]ï¼Œå³å®Œæ•´åŒ¹é… target æ‰€éœ€çš„æœ€å°‘å­—ç¬¦ä¸²æ•°ã€‚ def z_function(s): n = len(s) z = [0] * n l, r = 0, 0 for i in range(1, n): if i\u0026lt;=r and z[i - l] \u0026lt; r - i + 1: z[i] = z[i-l] else: z[i] = max(0, r - i + 1) while i + z[i] \u0026lt; n and s[z[i]] == s[i + z[i]]: z[i] += 1 if i + z[i] - 1 \u0026gt; r: l, r = i, i + z[i] - 1 return z class Solution: def minValidStrings(self, words: List[str], target: str) -\u0026gt; int: n = len(target) nxt = [0] * n for w in words: s = w + \u0026#39;#\u0026#39; + target z = z_function(s) for i in range(n): nxt[i] = max(nxt[i], z[i + len(w) + 1]) f = [-1] * (n + 1) f[0] = 0 last = 0 # æ‰€æœ‰ words å¯ä»¥æ‹“å±•åˆ°çš„targetçš„æœ€é•¿é•¿åº¦ for i in range(n): if f[i] == -1: continue if i \u0026gt; last: return -1 nx = nxt[i] if i + nx \u0026gt; last: for j in range(last + 1, i + nx + 1): f[j] = f[i] + 1 last = i + nx if last == n: break return f[n] ","permalink":"https://kennems.github.io/posts/tech/%E5%91%A8%E8%B5%9B240915/","summary":"å‘¨èµ›250915 æ—¶éš”å¤šæ—¥å†æ‰é‡æ–°å¼€å¯å‘¨èµ›ã€‚è¿™åœºDPå±…å¤šã€‚ T2-3290. æœ€é«˜ä¹˜æ³•å¾—åˆ† é¢˜ç›®å¤§æ„ï¼š ç»™å®šä¸¤ä¸ªæ•°ç»„ a å’Œ bï¼Œæ•°ç»„ a é•¿åº¦ä¸º 4ï¼Œæ•°ç»„ b é•¿åº¦è‡³å°‘ä¸º 4ã€‚éœ€è¦","title":"LeetCodeå‘¨èµ›415(250915)"},{"content":"MIT6.S081(7)-Q\u0026amp;A Plan: answering your questions Approach: walk through staff solutions start with pgtbl lab because it was the hardest your questions are at bottom of this file\nPgtbl lab comments few lines of code, but difficult-to-debug bugs\nworst case: qemu/xv6 stops running \u0026ldquo;best\u0026rdquo; case: kernel panic hard to debug for staff too there are so many possible reasons why you discovered once we hadn\u0026rsquo;t seen yet likely to be the most challenging lab historically the first VM lab is hard this year too, even though we made a new lab to provide a gentler intro to VM Part 1 of pgtbl lab Explain vm output in terms of fig 3-4\npage table 0x0000000087f67000 ..0: pte 0x0000000021fd8c01 pa 0x0000000087f63000 fl 0x0000000000000001 .. ..0: pte 0x0000000021fd8801 pa 0x0000000087f62000 fl 0x0000000000000001 .. .. ..0: pte 0x0000000021fd901f pa 0x0000000087f64000 fl 0x000000000000001f .. .. ..1: pte 0x0000000021fd840f pa 0x0000000087f61000 fl 0x000000000000000f .. .. ..2: pte 0x0000000021fd801f pa 0x0000000087f60000 fl 0x000000000000001f ..255: pte 0x0000000021fd9801 pa 0x0000000087f66000 fl 0x0000000000000001 .. ..511: pte 0x0000000021fd9401 pa 0x0000000087f65000 fl 0x0000000000000001 .. .. ..510: pte 0x0000000021fdd807 pa 0x0000000087f76000 fl 0x0000000000000007 .. .. ..511: pte 0x0000000020001c0b pa 0x0000000080007000 fl 0x000000000000000b\nwhat is entry 0, 1, and 2?\rwhat is 510 and 511?\r- 511: trampoline\r- 510: trapframe\rwhy are the protection bits as they are?\r- 510: RWV\r- 511: XV\r- 1: no U\rare the physical addresses contiguous?\rPart 2 of pgtbl lab Add a kernel page table to each process in prep for Part 3\nexact copy of the kernel_pagetable How hard can this be? hard! some reasons:\nxv6 code specialized to one kernel page table no kvmcreate_page_table() kvminit() isn\u0026rsquo;t the full story also mappings in procinit(), and virtio_disk.c cleanup must be done care don\u0026rsquo;t free kernel stacks easy to make a small error even small errors are time consuming Two possible approaches to part II\ngeneralize kvminit() create a new per-process kernel page table\rshare kernel_pagetable make the per-process kernel page table share much with kernel_pagetable\r- my solutions takes approach 2; other staff members too approach 1\r- i took approach 2 mostly out of \u0026quot;laziness\u0026quot;\rdon't have to think too hard what is in the kernel_pagetable\rdidn't want to write much code\r- not sure it is shorter, though\rapproach 2 has some benefits I didn't realize\r- avoided certain class of bugs (e.g., kernel stacks)\rImplementation approach: small incremental baby steps keep existing code working allows comparing old and new easily allows rolling back easily\nApproach 2\nkvmcreate() copy entries 1..512 add a few devices that live in 0 anything below 1G (i.e., all devices) kvmfree() only entry 0 is worth considering just need to free intermediate pages (see 3-level pic) a bit ugly where to call kvmfree() exit()? freeproc()? scheduler() usertrapret() Part 3 of pgtbl lab map user pgtbl of process into bottom of process\u0026rsquo;s kernel page table\ndraw figure why? convenient for kernel programmers can replace copyin with copy_new() copyin_new is just a memmove(), avoid the walkaddr()\u0026rsquo;s hardware can do the walks for us mapping user page tables into kernel page table\nkvmmapuser() copies upte into kpte, adjust permissions Using kvmmapuser():\nuserinit() exec() no need to replace kernel page table fork() sbrk() memmove()\nwhy the checks before the memmove()? what does each case cover Syscall lab systems calls look like functions calls BUT they are not function calls\nU/K boundary transition user/usys.pl generates stubs for stubs kernel/syscall.c demultiplexes system calls trace proc.h fork() sysinfo copyout() Util lab primes\nclose fd\u0026rsquo;s to terminate correctly xargs setting up argv === Questions ===\nHW\n===\nIn the page table lab, the kernel\u0026rsquo;s hardware address translator won\u0026rsquo;t allow kernel to dereference user pages. More specifically, if the page table entry has \u0026ldquo;PTE_U\u0026rdquo; bit set, which means user can access it, then kernel won\u0026rsquo;t be able to access it through the hardware address translator unless we set \u0026ldquo;PTE_U\u0026rdquo; to false in the per-process kernel page table. Is there a specific reason for this?\n===\nWhy is the kernel not allowed to read memory mapped with the PTE_U flag? To prevent malicious memory from being read?\n===\nIn the last lecture, it was mentioned that even the kernel in supervisor mode could not directly edit anything and everything in the memory. The kernel accesses memory through the kernel page table, and thus is limited. However, couldn\u0026rsquo;t the kernel just set the satp register to 0, and then there is no MMU translation, the CPU directly accesses physical addresses. Could that situation not arise? That certainly the case before page tables are set up and paging is enabled.\n===\nA minor question: why the specific order of the trapframe in proc.h (t0..t2, then s0, s1, a0..a7, s2..s11)?\n===\nPGTBL LAB\nI\u0026rsquo;m confused why the kernel can directly dereference the pointer in part 3 of pagetable because we have now mapped the user\u0026rsquo;s virtual address into the user\u0026rsquo;s kernel pagetable. Since it is still a virtual address, doesn\u0026rsquo;t it need to just walk the user\u0026rsquo;s kernel page table? Or is it because the user code now enters the kernel, and the kernel\u0026rsquo;s pagetable directly maps virtual addresses to physical addressses? However, in my implementation, it seems to be that the kernel still maps the same virtual addresses to the same physical addresses as the user\u0026rsquo;s page table, , which is not a direct mapping.\n===\nIn the pgtbl lab, during Part 3 (copyin), I ran into an interesting bug while changing a process\u0026rsquo;s user mappings. In fork(), I was calling my helper function to copy the user mappings from the process\u0026rsquo;s user page table to its kernel page table. When I tried to copy the parent process\u0026rsquo;s user page table, running \u0026ldquo;usertests\u0026rdquo; in the xv6 kernel just caused it to return and none of the tests were run. However, copying the child\u0026rsquo;s user page table worked. Shouldn\u0026rsquo;t either instruction be ok, since the child\u0026rsquo;s user page table was just copied over from the parent?\n===\nFor the page tables lab, what was the correct way to copy and change the process\u0026rsquo;s kernel page table the same way in fork(), exec(), and sbrk()? I tried to copy over a range of entries from the process\u0026rsquo;s page table into the process\u0026rsquo;s kernel page table directly, but my code was panicking when trying to use mappages() after my change to the 3 functions.\n===\nIf xv6 was written with the modifications from the pgtbl lab, we would not need to worry about switching the pagetables in the trampline code, right? Would there even be a need for the trampoline code to be mapped in the user pages? My understanding was that that code can be mapped in the per-process kernel pgtbls and be used from there during the trap handling. I was also curious about why when a PTE has the PTE_U bit is set, code in supervisor mode cannot access that page table. It is confusing to me because I thought that the kernel has the whole memory mapped and it can modify any virtual address even if some user data lives there. In the last lab, we could even know the exact va that the user pgtbl has for each of the pa that it uses and I think maybe be able to corrupt user\u0026rsquo;s data.\n===\nIs there a more efficient way to free each process\u0026rsquo;s kernel pagetable? I basically copied the freewalk function and removed the panic for leaves. Although this seemed fast enough for the tests, it still seemed a little slow. When I tried to optimize it by reducing recursion depth, I ran into troubles. Overall, this seems like a computationally intensive task, especially if all physical memory is mapped in the kernel pagetable for all processes. I was a little worried about breaking something, but could I have stopped mapping all physical memory?\n===\nDo operating systems using hierarchical pagetables ever set up the pagetable pages so that the lower parts of the hierachy are (atleast in part) shared?\n===\nFor the pagetable lab, I was trying to implement copyin/copyinstr. However, I got stuck in an infinite loop with the scheduler because the scheduler seemed to have no process that needs to be run. I am curious as to what could happen to the pagetable so that the OS would stop a process from running (especially the main process). What part of the code does the operating system set the state of a process to not running if the pagetable is broken?\n===\nI don\u0026rsquo;t understand why when I moved\nw_satp(MAKE_SATP(kernel_pagetable)); sfence_vma();\noutside of\nif(found == 0) { intr_on(); asm volatile(\u0026ldquo;wfi\u0026rdquo;); }\nin scheduler that everything in part 2 of the page table lab worked. Because before then, it worked to a certain degree, where sometimes it\u0026rsquo;d pass and sometimes it\u0026rsquo;d fail.\n===\nIn the pagetable lab, is there a significant impact on performance from copying to per-process kernel page tables so frequently? If so, how does this balance out with the improvements that come from being able to directly de-reference user address in kernel space?\n===\nHow are pipes implemented in xv6, and how would the changes to the page tables implemented in the pgtbl lab effect this implementation? Do the per-process page tables hinder each process\u0026rsquo; ability to communicate with each other?\n===\nWhy did uvmfree/freewalk originally panic at a leaf, and why did we need to change that.\nWhy does the inclusion of the user PTE_U bit not allow the kernel to access the PTE?\n===\nThe lab mentioned that \u0026ldquo;the goal of this section and the next is to allow the kernel to directly dereference user pointers.\u0026rdquo; However, I didn\u0026rsquo;t understand how this adds functionality to the kernel, or why this is an important function for the kernel to be able to do.\n===\nFor the page table lab, I had some questions on access rights. If the user bit is set, does that mean in user mode both read/write/execute options can be performed, or can only read/write/execute be done in kernel mode?\nAlso, are there pages in the kernel page table accessible in user mode?\n===\nIn the pgtbl lab, we added kernel pagetables to each process in order to simplify reading userspace pointers. Was there any reason we couldn\u0026rsquo;t do the same for copying data out to userspace? I think you\u0026rsquo;d have to be a little careful in exec(), since copyout is used there while setting up the process, but apart from that?\nAlso, one of the challenge exercises for that lab is to remove the PLIC limit. How would you do that\u0026ndash;set up a new pagetable for PLIC access, and switch to that when trying to access PLIC registers?\n===\nI was talking to some friends who solved the pagetable part 3 by using a modified uvmcopy but they needed to limit the pages they were copying to pass the runtime limit. What\u0026rsquo;s taking so long in that function? Does the walking make the copy function less optimized for the job?\n===\nQuestion: About the page table lab, when I was debugging my code, I realized for reparent test, I sometimes pass it but I sometimes fail. I fixed this issue by realizing I need to switch back to kernel_pagetable in the scheduler after exiting the process\u0026rsquo;s kernal pagetable. I wonder why such mistakes would cause reparent to behave non-deterministaclly? Was there some sort of race condition?\n===\nIn our \u0026ldquo;copy user page table to kernel page table\u0026rdquo; functions in the pagetable lab, why was it necessary to panic when a pagetable entry didn\u0026rsquo;t exist or was not valid for a given virtual address? Why couldn\u0026rsquo;t we have just skipped that virtual address? More broadly, how could we assume that all of the user page table values that we were copying over were present and valid?\n===\nIt really messes with my head that you have to define a C function for allocating memory (kalloc). This is one of the first things xv6 does in main.c, directly after which it creates the kernel page table (using a call to kalloc). Given the way kalloc works, is the kernel page table always going to be at the \u0026ldquo;end\u0026rdquo; address in the kernel\u0026rsquo;s virtual memory space since its the first piece of memory to be allocated? And do you have to be careful about using memory prior to calling kinit in main.c?\n===\nThis question is regarding the pgtbl lab. I had some confusion about the exact motivation for the lab, specifically creating a separate kernel page table for each process. I wasn\u0026rsquo;t sure what the lab meant by \u0026ldquo;directly dereferencing the user address\u0026rdquo;. From my understanding, what the kernel currently does to translate the virtual address of the user process is to \u0026ldquo;walk\u0026rdquo; down the user pagetable.\nSo if you essentially combine the kernel page table and user page tables, wouldn\u0026rsquo;t you still \u0026ldquo;walk\u0026rdquo; down the new per-process kernel page table to get the physical address? I don\u0026rsquo;t understand how this changes anything since the two approaches differ only in which page table the kernel is walking down.\n===\nFor question 1 in the page table lab, was page 1 the guard page? This made sense to me since it has the user flag off so it would cause errors if the user tried to access it. However I believe the textbook said that the guard page will have its valid bit off in which case it would not show up in vmprint.\n====\nWhy does the initial page table ( as printed in vmprint ) have indices 0 and 255?I deduced that these pages should eventually point towards the initial user program data ( text, guard page and stack ) and the trampoline/trapframe respectively. However, the trampoline should be at the very top of the virtual address space, so it should have the highest possible virtual address. Therefore, shouldn\u0026rsquo;t the root page table contain pages 0 and 511 rather than 0 and 255?\n====\nVM IN GENERAL\n====\nHow was copyin with per process kernel pagetables exploited, as mentioned in the pgtbl lab?\n===\nThis is less of a question, but I\u0026rsquo;d love to hear more about how Xv6 compares to various other operating systems that we might use in our day-to-day lives.\nI don\u0026rsquo;t have specific questions, but for example:\nHow does Linux set up its page tables? The lab mentioned this may have changed with Spectre/Meltdown, but what do they do now?\nDo we know how pages/traps are handled in Windows or macOS, or what tradeoffs were made in the design decisions there? I read somewhere that Windows XP source code leaked - did we learn anything interesting from that, or does Microsoft just use standard techniques?\nDoes x86-64 have instructions that significantly simplify or combine or increase performance of particular parts of the pagetable or traps chain of code in interesting ways?\nHow active is the development of OS techniques like syscalls, pagetables, etc.? Are they mostly considered a \u0026ldquo;solved\u0026rdquo; problem by modern operating systems and only really experimented on in research?\n===\nSYSCALL LAB\n===\nCould you possibly walk through the roles of the different places we had to update when we added a new system call? (e.g. user/user.h, user/usys.pl, kernel/syscall.h, and a few others)\nI\u0026rsquo;m mostly wondering (1) in what order these are visited when the code is compiled and (2) why there isn\u0026rsquo;t a more centralized way to do this? For example, in kernel/syscall.c, why do we need to manually edit both the extern list and the syscalls array beneath it?\n===\nUTIL LAB\n===\nOne of the challenges for the first lab was to add history/tab completion. However, one thing that gave me some trouble was being able to parse single keystrokes (namely the arrow keys). Is there a way to read a single character (not having to press enter)?\n","permalink":"https://kennems.github.io/posts/tech/mit6.s0817-qa/","summary":"MIT6.S081(7)-Q\u0026amp;A Plan: answering your questions Approach: walk through staff solutions start with pgtbl lab because it was the hardest your questions are at bottom of this file Pgtbl lab comments few lines of code, but difficult-to-debug bugs worst case: qemu/xv6 stops running \u0026ldquo;best\u0026rdquo; case: kernel panic hard to debug for staff too there are so many possible reasons why you discovered once we hadn\u0026rsquo;t seen yet likely to be the","title":"MIT6.S081(7)-Q\u0026A"},{"content":"MIT6.S081(6)-System Call Entry/Exit Today: user -\u0026gt; kernel transition system calls, faults, interrupts enter the kernel in the same way important for isolation and performance lots of careful design and important detail\nWhat needs to happen when a program makes a system call, e.g. write()? [CPU | user/kernel diagram] CPU resources are set up for user execution (not kernel) 32 registers, sp, pc, privilege mode, satp, stvec, sepc, \u0026hellip; what needs to happen? save 32 user registers and pc switch to supervisor mode switch to kernel page table switch to kernel stack jump to kernel C code high-level goals don\u0026rsquo;t let user code interfere with user-\u0026gt;kernel transition e.g. don\u0026rsquo;t execute user code in supervisor mode! transparent to user code \u0026ndash; resume without disturbing\nToday we\u0026rsquo;re focusing on the user/kernel transition and ignoring what the system call implemenation does once in the kernel but the sys call impl has to be careful and secure also!\nWhat does the CPU\u0026rsquo;s \u0026ldquo;mode\u0026rdquo; protect? i.e. what does switching mode from user to supervisor allow? supervisor can use CPU control registers: satp \u0026ndash; page table physical address stvec \u0026ndash; ecall jumps here in kernel; points to trampoline sepc \u0026ndash; ecall saves user pc here sscratch \u0026ndash; address of trapframe supervisor can use PTEs that have no PTE_U flag but supervisor has no other powers! e.g. can\u0026rsquo;t use addresses that aren\u0026rsquo;t the in page table so kernel has to carefully set things up so it can work\npreview: write() write() returns User uservec() in trampoline.S userret() in trampoline.S Kernel usertrap() in trap.c usertrapret() in trap.c syscall() in syscall.c ^ sys_write() in sysfile.c \u0026mdash;|\nlet\u0026rsquo;s watch an xv6 system call entering/leaving the kernel xv6 shell writing its $ prompt sh.c line 137: write(2, \u0026ldquo;$ \u0026ldquo;, 2); user/usys.S line 29 this is the write() function, still in user space a7 tells the kernel what system call we want \u0026ndash; SYS_write = 16 ecall \u0026ndash; triggers the user/kernel transition\nlet\u0026rsquo;s start by putting a breakpoint on the ecall user/sh.asm says write()\u0026rsquo;s ecall is at address 0xde6\n$ make qemu-gdb (gdb) b *0xde6 (gdb) c (gdb) delete 1 (gdb) x/3i 0xde4\nlet\u0026rsquo;s look at the registers (gdb) print $pc (gdb) info reg\n$pc and $sp are at low addresses \u0026ndash; user memory starts at zero C on RISC-V puts function arguments in a0, a1, a2, \u0026amp;c write() arguments: a0 is fd, a1 is buf, a2 is n\n(gdb) x/2c $a1\nthe shell is printing the $ prompt\nwhat page table is in use? (gdb) print/x $satp not very useful qemu: control-a c, info mem there are mappings for six pages instructions, data, stack guard (no PTE_U), stack, then two high mystery pages: trapframe and trampoline there are no mappings for kernel memory, devices, physical mem\nlet\u0026rsquo;s execute the ecall\n(gdb) stepi\nwhere are we? (gdb) print $pc we\u0026rsquo;re executing at a very high virtual address (gdb) x/6i 0x3ffffff000 these are the instructions we\u0026rsquo;re about to execute see uservec in kernel/trampoline.S it\u0026rsquo;s the start of the kernel\u0026rsquo;s trap handling code (gdb) info reg the registers hold user values (except $pc) qemu: info mem we\u0026rsquo;re still using the user page table note that $pc is in the trampoline page, the very last page\nwe\u0026rsquo;re executing in the \u0026ldquo;trampoline\u0026rdquo; page, which contains the start of the kernel\u0026rsquo;s trap handling code. ecall doesn\u0026rsquo;t switch page tables, so these kernel instructions have to exist somewhere in the user page table. the trampoline page is the answer: the kernel maps it at the top of every user page table. the kernel sets $stvec to the trampoline page\u0026rsquo;s virtual address. the trampoline is protected: no PTE_U flag.\n(gdb) print/x $stvec\ncan we tell that we\u0026rsquo;re in supervisor mode? I don\u0026rsquo;t know a way to find the mode directly but observe $pc is executing in a page with no PTE_U flag lack of crash implies we are in supervisor mode\nhow did we get here? ecall did three things: change mode from user to supervisor save $pc in $sepc (gdb) print/x $sepc jump to $stvec (i.e. set $pc to $stvec) the kernel previously set $stvec, before jumping to user space\nnote: ecall lets user code switch to supervisor mode but the kernel immediately gains control via $stvec so the user program itself can\u0026rsquo;t execute as supervisor\nwhat needs to happen now? save the 32 user register values (for later transparent resume) switch to kernel page table set up stack for kernel C code jump to kernel C code\nwhy didn\u0026rsquo;t the RISC-V designers have ecall do these things for us? ecall does as little as possible: to give O/S designers scope for very fast syscalls / faults / intrs maybe O/S can handle some traps w/o switching page tables maybe we can map BOTH user and kernel into a single page table so no page table switch required maybe some registers do not have to be saved maybe no stack is required for simple system calls\nthere have been many clever schemes invented for kernel entry! different amounts of work by CPU different strategies for handler s/w performance here is often super important\nwhat are our options at this point for saving user registers? can we just write them somewhere convenient in physical memory? no, even supervisor mode is constrained to use the page table can we first set satp to the kernel page table? supervisor mode is allowed to set satp\u0026hellip; but we don\u0026rsquo;t know the address of the kernel page table at this point! and we need a free register to even execute csrw satp, $xx\ntwo parts to the solution for where to save the 32 user registers:\nxv6 maps a 2nd kernel page, the trapframe, into every user page table it has space to hold the saved registers the kernel gives each process a different trapframe page the page at 0x3fffffe000 is the trapframe page see struct trapframe in kernel/proc.h (but we still need a register holding the trapframe\u0026rsquo;s address\u0026hellip;) RISC-V provides the sscratch register the kernel puts a pointer to the trapframe in sscratch before entering user space supervisor code can swap any register with sscratch thus both getting hold of the value in sscratch, and simultaneously saving the register\u0026rsquo;s user value see this at the start of uservec in trapframe.S: csrrw a0, sscratch, a0\nthe csrrw has already been executed due to some gdb quirk\u0026hellip;\n(gdb) print/x $a0 address of the trapframe (gdb\u0026gt; print/x $sscratch 0x2, the old first argument (fd)\nnow uservec() has 32 saves of user registers to the trapframe, via a0 so they can be restored later, when the system call returns let\u0026rsquo;s skip them\n(gdb) b *0x3ffffff076 (gdb) c\nnow we\u0026rsquo;re setting up to be able to run C code in the kernel first a stack previously, kernel put a pointer to top of this process\u0026rsquo;s kernel stack in trapframe look at struct trapframe in kernel/proc.h \u0026ldquo;ld sp, 8(a0)\u0026rdquo; fetches the kernel stack pointer remember a0 points to the trapframe at this point the only kernel data the code can get at is the trapframe, so everything has to be loaded from there.\n(gdb) stepi\nretrieve hart ID into tp\n(gdb) stepi\nwe want to jump to the kernel C function usertrap(), which the kernel previously saved in the trapframe. \u0026ldquo;ld t0, 16(a0)\u0026rdquo; fetches it into t0, we\u0026rsquo;ll use it in a moment, after switching to the kernel page table\n(gdb) stepi\nload a pointer to the kernel pagetable from the trapframe, and load it into satp, and issue an sfence to clear the TLB.\n(gdb) stepi (gdb) stepi (gdb) stepi\nwhy isn\u0026rsquo;t there a crash at this point? after all we just switched page tables while executing! answer: the trampoline page is mapped at the same virtual address in the kernel page table as well as every user page table\n(gdb) print $pc qemu: info mem\nwith the kernel page table we can now use kernel functions and data\nthe jr t0 is a jump to usertrap() (using t0 retrieved from trapframe)\n(gdb) print/x $t0 (gdb) x/4i $t0 (gdb) stepi (gdb) tui enable\nwe\u0026rsquo;re now in usertrap() in kernel/trap.c various traps come here, e.g. errors, device interrupts, and system calls usertrap() looks in the scause register to see the trap cause see Figure 10.3 on page 102 of The RISC-V Reader scause = 8 is a system call\n(gdb) next \u0026hellip; until syscall() (gdb) step (gdb) next\nnow we\u0026rsquo;re in syscall() kernel/syscall.c myproc() uses tp to retrieve current struct proc * p-\u0026gt;xxx is usually a slot in the current process\u0026rsquo;s struct proc\nsyscall() retrieves the system call number from saved register a7 p-\u0026gt;trapframe points to the trapframe, with saved registers p-\u0026gt;trapframe-\u0026gt;a7 holds 16, SYS_write p-\u0026gt;trapframe-\u0026gt;a0 holds write() first argument \u0026ndash; fd p-\u0026gt;trapframe-\u0026gt;a1 holds buf p-\u0026gt;trapframe-\u0026gt;a2 holds n\n(gdb) next \u0026hellip; (gdb) print num\nthen dispatches through syscall[num], a table of functions\n(gdb) next \u0026hellip; (gdb) step\naha, we\u0026rsquo;re in sys_write. at this point system call implementations are fairly ordinary C code. let\u0026rsquo;s skip to the end, to see how a system call returns to user space.\n(gdb) finish\nnotice that write() produced console output (the shell\u0026rsquo;s $ prompt) back to syscall() the p-\u0026gt;tf-\u0026gt;a0 assignment causes (eventually) a0 to hold the return value the C calling convention on RISC-V puts return values in a0\n(gdb) next\nback to usertrap()\n(gdb) print p-\u0026gt;trapframe-\u0026gt;a0\nwrite() returned 2 \u0026ndash; two characters \u0026ndash; $ and space\n(gdb) next (gdb) step\nnow we\u0026rsquo;re in usertrapret(), which starts the process of returning to the user program\nwe need to prepare for the next user-\u0026gt;kernel transition stvec = uservec (the trampoline), for the next ecall traframe satp = kernel page table, for next uservec traframe sp = top of kernel stack trapframe trap = usertrap trapframe hartid = hartid (in tp)\nat the end, we\u0026rsquo;ll use the RISC-V sret instruction we need to prepare a few registers that sret uses sstatus \u0026ndash; set the \u0026ldquo;previous mode\u0026rdquo; bit to user sepc \u0026ndash; the saved user program counter (from trap entry)\nwe\u0026rsquo;re going to switch to the user page table while executing not OK in usertrapret(), since it\u0026rsquo;s not mapped in the user page table. need a page that\u0026rsquo;s mapped in both user and kernel page table \u0026ndash; the trampoline. jump to userret in trampoline.S\n(gdb) tui disable (gdb) step (gdb) x/8i 0x3ffffff090\na0 holds TRAPFRAME a1 holds user page table address the csrw satp switches to the user address space\n(gdb) stepi (gdb) stepi (gdb) stepi\nthe csrw scratch puts the user a0 into sscratch just before sret we\u0026rsquo;ll do a swap, so that a0 holds the user a0 and sscratch holds trapframe pointer. which is what uservec expects.\nnow 32 loads from the trapframe into registers these restore the user registers let\u0026rsquo;s skip over them\n(gdb) b *0x3ffffff10a (gdb) c\nhere\u0026rsquo;s the csrw that swaps a0 with sscratch\n(gdb) stepi (gdb) print/x $a0 \u0026ndash; the return value from write() (gdb) print/x $sscratch \u0026ndash; trapframe address for uservec\nnow we\u0026rsquo;re at the sret instruction\n(gdb) print $pc (gdb) stepi (gdb) print $pc\nnow we\u0026rsquo;re back in the user program ($pc = 0x0xdea) returning 2 from the write() function\n(gdb) print/x $a0\nand we\u0026rsquo;re done with a system call!\nsummary system call entry/exit is far more complex than function call much of the complexity is due to the requirement for isolation and the desire for simple and fast hardware mechanisms a few design questions to ponder: can an evil program abuse the entry mechanism? can you think of ways to make the hardware or software simpler? can you think of ways to make traps faster?\nLab: traps RISC-V assembly (easy) Which registers contain arguments to functions? For example, which register holds 13 in main\u0026rsquo;s call to printf? 13 -\u0026gt; a2\n12 -\u0026gt; a1\nç¬¬ä¸€ä¸ªå‚æ•°-\u0026gt; a0 åœ¨printfä¸­ä»£è¡¨æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„åœ°å€ï¼Œåœ¨exit(0)ä¸­ä»£è¡¨å‚æ•°0\nra(è¿”å›åœ°å€)\ns0(ä¿å­˜å¸§æŒ‡é’ˆ)\nauipc xx, 0x0 é€šè¿‡å°†å½“å‰PCçš„é«˜20ä½åŠ ä¸Šä¸€ä¸ªç«‹å³æ•°ï¼ˆåœ¨è¿™ä¸ªä¾‹å­ä¸­æ˜¯0x0ï¼Œè¡¨ç¤ºæ²¡æœ‰åç§»ï¼‰æ¥å½¢æˆä¸€ä¸ªé«˜åœ°å€éƒ¨åˆ†ã€‚è¿™ä¸ªç»“æœä¼šå­˜å‚¨åœ¨ç›®æ ‡å¯„å­˜å™¨ xx ä¸­ã€‚\nWhere is the call to function f in the assembly code for main? Where is the call to g? (Hint: the compiler may inline functions.) printf(\u0026#34;%d %d\\n\u0026#34;, f(8)+1, 13); 24:\t4635 li\ta2,13 26:\t45b1 li\ta1,12 è¿™é‡Œç›´æ¥å°†è®¡ç®—åçš„å€¼å†™å…¥åˆ°å¯„å­˜å™¨ä¸­ï¼Œé€šè¿‡å†…è”çš„æ–¹å¼è°ƒç”¨å‡½æ•°ã€‚\nAt what address is the function printf located? 34:\t600080e7 jalr\t1536(ra) # 630 \u0026lt;printf\u0026gt; $0x630$ ä½ç½®\nWhat value is in the register ra just after the jalr to printf in main? 30:\t00000097 auipc\tra,0x0 34:\t600080e7 jalr\t1536(ra) # 630 \u0026lt;printf\u0026gt; $0x630 = 0x30(ra) + 1536, ra = 0x30$\nRun the following code. unsigned int i = 0x00646c72; printf(\u0026#34;H%x Wo%s\u0026#34;, 57616, \u0026amp;i); è¾“å‡º ï¼š He110 World\nå…¶ä¸­57616åå…­è¿›åˆ¶æ•°ç»„çš„asciiç ä¸º110\nå› ä¸º RISC-V æ˜¯ little-endian. å†…å­˜ä¸­å­˜å‚¨iä¸ºé€†åºçš„ï¼Œæ‰€ä»¥ä¼šå€’åº ï¼š\n0x72 (ASCII \u0026lsquo;r\u0026rsquo;)\n0x6c (ASCII \u0026rsquo;l')\n0x64 (ASCII \u0026rsquo;d')\n0x00 (null terminator)\nIn the following code, what is going to be printed after 'y='? (note: the answer is not a specific value.) Why does this happen? printf(\u0026#34;x=%d y=%d\u0026#34;, 3); å› ä¸ºprintfä¼šå°è¯•ä»æ ˆæˆ–è€…å†…å­˜ä¸Šè¯»å–è¿™ä¸ªç¼ºå¤±çš„å‚æ•°ï¼Œè¿™ä¼šå¯¼è‡´æœªå®šä¹‰çš„è¡Œä¸ºï¼Œå¯èƒ½ä¼šè·å–åˆ°ä»»æ„çš„å†…å­˜äº§ç”ŸæœªçŸ¥çš„å€¼ï¼Œå…·ä½“å–å†³äºæ ˆå’Œå†…å­˜çš„çš„çŠ¶æ€ï¼Œç¼–è¯‘è¡Œä¸ºå’Œä¼˜åŒ–ï¼Œè¿è¡Œç¯å¢ƒå’Œå†…å­˜çš„ç®¡ç†ã€‚\nBacktrace (moderate) defs.h void backtrace(void); printf.c void backtrace(void) { uint64 p = r_fp(); while (p != PGROUNDUP(p)) { uint64 ra = *(uint64 *)(p - 8); uint64 fp = *(uint64 *)(p - 16); printf(\u0026#34;%p\\n\u0026#34;, ra); p = fp; } } riscv.h Alarm (hard) proc.c p-\u0026gt;alarm_interval = 0; p-\u0026gt;alarm_handler = 0; p-\u0026gt;alarm_tick_count = 0; p-\u0026gt;alarm_handling = 0; if ((p-\u0026gt;alarm_trapframe = (struct trapframe *)kalloc()) == 0) { release(\u0026amp;p-\u0026gt;lock); return 0; } p-\u0026gt;alarm_interval = 0; p-\u0026gt;alarm_handler = 0; p-\u0026gt;alarm_tick_count = 0; p-\u0026gt;alarm_handling = 0; if (p-\u0026gt;alarm_trapframe) kfree((void *)p-\u0026gt;alarm_trapframe); // sys_sigalarm - ç³»ç»Ÿè°ƒç”¨ï¼Œç”¨äºè®¾ç½®ä¸€ä¸ªè¿›ç¨‹çš„å®šæ—¶é—¹é’Ÿä¿¡å·å¤„ç†ç¨‹åº // // å‚æ•°ï¼š // æ— ç›´æ¥å‚æ•°ã€‚ä½¿ç”¨äº†argint()å’Œargaddr()æ¥ä»ç³»ç»Ÿè°ƒç”¨å‚æ•°ä¸­æå–å€¼ã€‚ // è¿”å›å€¼ï¼š // æˆåŠŸè¿”å›0ï¼Œå¤±è´¥è¿”å›-1ã€‚ // // åŠŸèƒ½ï¼š // è¯¥å‡½æ•°è®¾ç½®ä¸€ä¸ªè¿›ç¨‹çš„å®šæ—¶é—¹é’Ÿï¼Œå½“è®¡æ—¶å™¨è¾¾åˆ°æŒ‡å®šçš„tickæ•°æ—¶ï¼Œè§¦å‘ // ç”¨æˆ·å®šä¹‰çš„ä¿¡å·å¤„ç†ç¨‹åºï¼ˆhandlerï¼‰ã€‚ // // å…·ä½“æ¥è¯´ï¼š // 1. ä»ç³»ç»Ÿè°ƒç”¨å‚æ•°ä¸­è·å–æŒ‡å®šçš„tickæ•°å’Œä¿¡å·å¤„ç†ç¨‹åºçš„åœ°å€ã€‚ // 2. åœ¨å¤±è´¥çš„æƒ…å†µä¸‹è¿”å›-1ã€‚ // 3. å¦‚æœæˆåŠŸè·å–åˆ°è¿™äº›å‚æ•°ï¼Œæ›´æ–°å½“å‰è¿›ç¨‹çš„alarm_intervalï¼ˆé—¹é’Ÿé—´éš”ï¼‰ // å’Œalarm_handlerï¼ˆé—¹é’Ÿå¤„ç†ç¨‹åºï¼‰ï¼Œå¹¶é‡ç½®é—¹é’Ÿçš„è®¡æ•°å™¨å’ŒçŠ¶æ€ã€‚ uint64 sys_sigalarm(void) { int ticks; // ç”¨äºå­˜å‚¨ç”¨æˆ·ä¼ å…¥çš„tickæ•°ï¼ˆé—´éš”æ—¶é—´ï¼‰ void (*handler)(); // ç”¨äºå­˜å‚¨ç”¨æˆ·ä¼ å…¥çš„ä¿¡å·å¤„ç†ç¨‹åºçš„æŒ‡é’ˆ // ä»ç¬¬ä¸€ä¸ªå‚æ•°è·å–tickæ•°ï¼Œargintç”¨äºè·å–æ•´æ•°ç±»å‹çš„å‚æ•°ã€‚ if (argint(0, \u0026amp;ticks) \u0026lt; 0) return -1; // è·å–å¤±è´¥ï¼Œè¿”å›-1 // ä»ç¬¬äºŒä¸ªå‚æ•°è·å–ä¿¡å·å¤„ç†ç¨‹åºçš„åœ°å€ï¼Œargaddrç”¨äºè·å–æŒ‡é’ˆç±»å‹çš„å‚æ•°ã€‚ if (argaddr(1, (uint64 *)\u0026amp;handler) \u0026lt; 0) return -1; // è·å–å¤±è´¥ï¼Œè¿”å›-1 // è·å–å½“å‰çš„è¿›ç¨‹ç»“æ„ä½“æŒ‡é’ˆ struct proc *p = myproc(); // è®¾ç½®è¿›ç¨‹çš„é—¹é’Ÿé—´éš” p-\u0026gt;alarm_interval = ticks; // è®¾ç½®è¿›ç¨‹çš„ä¿¡å·å¤„ç†ç¨‹åº p-\u0026gt;alarm_handler = handler; // é‡ç½®é—¹é’Ÿçš„è®¡æ•°å™¨ p-\u0026gt;alarm_tick_count = 0; // åˆå§‹åŒ–é—¹é’Ÿå¤„ç†çŠ¶æ€ä¸ºæœªå¤„ç† p-\u0026gt;alarm_handling = 0; // è®¾ç½®æˆåŠŸï¼Œè¿”å›0 return 0; } // sys_sigreturn - ç³»ç»Ÿè°ƒç”¨ï¼Œç”¨äºä»ä¿¡å·å¤„ç†ç¨‹åºè¿”å›åˆ°ä¸»ç¨‹åº // // å‚æ•°ï¼š // æ— ç›´æ¥å‚æ•°ã€‚ // è¿”å›å€¼ï¼š // æˆåŠŸè¿”å›0ã€‚ // // åŠŸèƒ½ï¼š // è¯¥å‡½æ•°ç”¨äºå½“ä¿¡å·å¤„ç†ç¨‹åºï¼ˆå¦‚é€šè¿‡sys_sigalarmè®¾ç½®çš„å¤„ç†ç¨‹åºï¼‰æ‰§è¡Œå®Œæ¯•æ—¶ï¼Œ // æ¢å¤è¿›ç¨‹çš„ä¸Šä¸‹æ–‡çŠ¶æ€ï¼Œä½¿å…¶è¿”å›åˆ°å¤„ç†ä¿¡å·å‰çš„æ‰§è¡ŒçŠ¶æ€ã€‚å…·ä½“æ­¥éª¤åŒ…æ‹¬ï¼š // 1. æ¢å¤é™·é˜±å¸§ï¼ˆtrapframeï¼‰ï¼Œå°†ä¿å­˜çš„alarm_trapframeå†…å®¹æ¢å¤åˆ°å½“å‰çš„trapframeä¸­ã€‚ // 2. é‡ç½®é—¹é’Ÿçš„è®¡æ•°å™¨å’Œå¤„ç†çŠ¶æ€ï¼Œè¡¨ç¤ºä¿¡å·å¤„ç†å·²ç»å®Œæˆã€‚ uint64 sys_sigreturn(void) { struct proc *p = myproc(); // è·å–å½“å‰è¿›ç¨‹çš„æŒ‡é’ˆ // æ¢å¤è¿›ç¨‹çš„trapframeï¼Œå°†ä¿å­˜çš„alarm_trapframeå†…å®¹å¤åˆ¶å›å½“å‰trapframeã€‚ // trapframeä¿å­˜äº†è¿›ç¨‹åœ¨å¤„ç†ä¿¡å·ä¹‹å‰çš„CPUå¯„å­˜å™¨çŠ¶æ€ã€‚ *(p-\u0026gt;trapframe) = *(p-\u0026gt;alarm_trapframe); // é‡ç½®é—¹é’Ÿçš„è®¡æ•°å™¨ï¼Œè¡¨ç¤ºé—¹é’Ÿä¿¡å·å¤„ç†ç¨‹åºå·²ç»æ‰§è¡Œå®Œæ¯•ã€‚ p-\u0026gt;alarm_tick_count = 0; // é‡ç½®é—¹é’Ÿçš„å¤„ç†çŠ¶æ€ï¼Œè¡¨ç¤ºå½“å‰ä¸åœ¨ä¿¡å·å¤„ç†ç¨‹åºä¸­ã€‚ p-\u0026gt;alarm_handling = 0; // æˆåŠŸè¿”å› return 0; } proc.h int alarm_interval; void (*alarm_handler)(); int alarm_tick_count; int alarm_handling; struct trapframe *alarm_trapframe; riscv.h static inline uint64 r_fp() { uint64 x; asm volatile(\u0026#34;mv %0, s0\u0026#34; : \u0026#34;=r\u0026#34;(x)); return x; } syscall.c syscall.h trap.c // ok if (which_dev == 2) { if (p-\u0026gt;alarm_interval != 0 \u0026amp;\u0026amp; !p-\u0026gt;alarm_handling) { ++p-\u0026gt;alarm_tick_count; if (p-\u0026gt;alarm_tick_count == p-\u0026gt;alarm_interval) { *(p-\u0026gt;alarm_trapframe) = *(p-\u0026gt;trapframe); p-\u0026gt;trapframe-\u0026gt;epc = (uint64)(p-\u0026gt;alarm_handler); p-\u0026gt;alarm_handling = 1; } } } user.h usys.pl ","permalink":"https://kennems.github.io/posts/tech/mit6.s0816-system-call-entryexit/","summary":"MIT6.S081(6)-System Call Entry/Exit Today: user -\u0026gt; kernel transition system calls, faults, interrupts enter the kernel in the same way important for isolation and performance lots of careful design and important detail What needs to happen when a program makes a system call, e.g. write()? [CPU | user/kernel diagram] CPU resources are set up for user execution (not kernel) 32 registers, sp, pc, privilege mode, satp, stvec, sepc, \u0026hellip; what needs","title":"MIT6.S081(6)-System Call Entry/Exit"},{"content":"MIT6.S081(5)-RISC-V calling convention, stack frames, and gdb C code is compiled to machine instructions. How does the machine work at a lower level? How does this translation work? How to interact between C and asm Why this matters: sometimes need to write code not expressible in C And you need this for the syscall lab!\nRISC-V abstract machine No C-like control flow, no concept of variables, types \u0026hellip; Base ISA: Program counter, 32 general-purpose registers (x0\u0026ndash;x31)\nreg | name | saver | description \u0026mdash;\u0026mdash;-+\u0026mdash;\u0026mdash;-+\u0026mdash;\u0026mdash;\u0026ndash;+\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash; x0 | zero | | hardwired zero x1 | ra | caller | return address x2 | sp | callee | stack pointer x3 | gp | | global pointer x4 | tp | | thread pointer x5-7 | t0-2 | caller | temporary registers x8 | s0/fp | callee | saved register / frame pointer x9 | s1 | callee | saved register x10-11 | a0-1 | caller | function arguments / return values x12-17 | a2-7 | caller | function arguments x18-27 | s2-11 | callee | saved registers x28-31 | t3-6 | caller | temporary registers pc | | | program counter\nRunning example: sum_to(n)\nint sum_to(int n) {\rint acc = 0;\rfor (int i = 0; i \u0026lt;= n; i++) {\racc += i;\r}\rreturn acc;\r} What does this look like in assembly code?\nsum_to(n) expects argument in a0 returns result in a0 sum_to:\rmv t0, a0 # t0 \u0026lt;- a0\rli a0, 0 # a0 \u0026lt;- 0\rloop:\radd a0, a0, t0 # a0 \u0026lt;- a0 + t0\raddi t0, t0, -1 # t0 \u0026lt;- t0 - 1\rbnez t0, loop # if t0 != 0: pc \u0026lt;- loop\rret Limited abstractions No typed, positional arguments No local variables Only registers\nMachine doesn\u0026rsquo;t even see assembly code Sees binary encoding of machine instructions Each instruction: 16 bits or 32 bits E.g. mv t0, a0 is encoded as 0x82aa Not quite 1-to-1 encoding from asm, but close\nHow would another function call sum_to?\nmain: li a0, 10 # a0 \u0026lt;- 10 call sum_to\nWhat are the semantics of call?\ncall label := ra \u0026lt;- pc + 4 ; ra \u0026lt;- address of next instruction pc \u0026lt;- label ; jump to label\nMachine doesn\u0026rsquo;t understand labels Translated to either pc-relative or absolute jumps\nWhat are the semantics of return?\nret := pc \u0026lt;- ra\nLet\u0026rsquo;s try it out: demo1.S\n(gdb) file user/_demo1 (gdb) break main (gdb) continue Why does it stop before running demo1?\n(gdb) layout split (gdb) stepi (gdb) info registers (gdb) p $a0 (gdb) advance 18 (gdb) si (gdb) p $a0 What if we wanted a function calling another function?\nsum_then_double(n) expects argument in a0 returns result in a0 sum_then_double: call sum_to li t0, 2 # t0 \u0026lt;- 2 mul a0, a0, t0 # a0 \u0026lt;- a0 * t0 ret\nmain: li a0, 10 call sum_then_double\nLet\u0026rsquo;s try it out: demo2.S We get stuck in an infinite loop Why: overwrote return address (ra)\nHow to fix: save ra somewhere In another register? Won\u0026rsquo;t work, just defers problem. Solution: save on stack\nsum_then_double: addi sp, sp, 16 # function prologue: sd ra, 0(sp) # make space on stack, save registers call sum_to li t0, 2 mul a0, a0, t0 ld ra, 0(sp) # function epilogue: addi sp, sp, -16 # restore registers, restore stack pointer ret\nLet\u0026rsquo;s try it out: demo3.S (gdb) \u0026hellip; (gdb) nexti\nSo far, our functions coordinated with each other This worked because we were writing all the code involved Could have written it any other way E.g. passing arguments in t2, getting return value in t3\nConventions surrounding this: \u0026ldquo;calling convention\u0026rdquo; How are arguments passed? a0, a1, \u0026hellip;, a7, rest on stack How are values returned? a0, a1 Who saves registers? Designated as caller or callee saved Could ra be a callee-saved register? Our assembly code should follow this convention C code generated by GCC follows this convention This means that everyone\u0026rsquo;s code can interop, incl C/asm interop Read: demo4.c / demo4.asm Can see function prologue, body, epilogue Why doesn\u0026rsquo;t it save ra? Leaf function, not needed What is going on with s0/fp? We compiled with -fno-omit-frame-pointer\nStack . . +-\u0026gt; . | +\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;\u0026ndash;+ | | | return address | | | | previous fp \u0026mdash;\u0026mdash;+ | | saved registers | | | local variables | | | \u0026hellip; | \u0026lt;-+ | +\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;\u0026ndash;+ | | | return address | | +\u0026mdash;\u0026mdash; previous fp | | | saved registers | | | local variables | | +-\u0026gt; | \u0026hellip; | | | +\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;\u0026ndash;+ | | | return address | | | | previous fp \u0026mdash;\u0026mdash;+ | | saved registers | | | local variables | | | \u0026hellip; | \u0026lt;-+ | +\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;\u0026ndash;+ | | | return address | | +\u0026mdash;\u0026mdash; previous fp | | | saved registers | | | local variables | | $fp \u0026ndash;\u0026gt; | \u0026hellip; | | +\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;\u0026ndash;+ | | return address | | | previous fp \u0026mdash;\u0026mdash;+ | saved registers | $sp \u0026ndash;\u0026gt; | local variables | +\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;\u0026ndash;+\nDemo program: demo5.c (gdb) break g (gdb) si (gdb) si (gdb) si (gdb) si (gdb) p $sp (gdb) p $fp (gdb) x/g $fp-16 (gdb) x/g 0x0000000000002fd0-16\nStack diagram:\n0x2fe0 |\r0x2fd8 | \u0026lt;garbage ra\u0026gt; \\\r0x2fd0 | \u0026lt;garbage fp\u0026gt; / stack frame for main\r0x2fc8 | ra into main \\\r$fp \u0026ndash;\u0026gt; 0x2fc0 | 0x0000000000002fe0 / stack frame for f 0x2fb8 | ra into f $sp \u0026ndash;\u0026gt; 0x2fb0 | 0x0000000000002fd0 / stack frame for g\nGDB can automate this reasoning for us Plus, it can use debug info to reason about leaf functions, etc. (gdb) backtrace (gdb) info frame (gdb) frame 1 (gdb) info frame (gdb) frame 2 (gdb) info frame\nCalling C from asm / calling asm from C Follow calling convention and everything will work out Write function prototype so C knows how to call assembly Demo: demo6.c / demo6_asm.S Why do we use s0/s1 instead of e.g. t0/t1? (gdb) b sum_squares_to (gdb) si \u0026hellip; (gdb) x/4g $sp (gdb) si \u0026hellip;\nInline assembly\nStructs C struct layout rules Why: misaligned load/store can be slow or unsupported (platform-dependent) attribute((packed)) How to access and manipulate C structs from assembly? Generally passed by reference Need to know struct layout Demo: demo7.c / demo7_asm.S\nDebugging examine: inspect memory contents x/nfu addr n: count f: format u: unit size step/next/finish step: next line of C code next: next line of C code, skipping over function calls finish: continue executing until end of current function call stepi/nexti stepi: next assembly instruction nexti: next assembly instruction, skipping over function calls layout next steps through layouts conditional breakpoints break, only when a condition holds (e.g. variable has a certain value) watchpoints break when a memory location changes value GDB is a very powerful tool Read the manual for more! But you probably don\u0026rsquo;t need all the fancy features for this class\nReferences RISC-V ISA specification: https://riscv.org/specifications/ Contains detailed information RISC-V ISA Reference: https://rv8.io/isa Overview of instructions RISC-V assembly language reference: https://rv8.io/asm Overview of directives, pseudo-instructions, and more\nGDB å•æ­¥æ‰§è¡Œ å½“ç¨‹åºè¿è¡Œåˆ°æ–­ç‚¹æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å•æ­¥è°ƒè¯•ï¼š\nnext (æˆ– n)ï¼šæ‰§è¡Œä¸‹ä¸€è¡Œä»£ç ï¼Œä½†ä¸ä¼šè¿›å…¥å‡½æ•°å†…éƒ¨ã€‚ step (æˆ– s)ï¼šæ‰§è¡Œä¸‹ä¸€è¡Œä»£ç ï¼Œå¦‚æœæ˜¯å‡½æ•°è°ƒç”¨åˆ™è¿›å…¥å‡½æ•°å†…éƒ¨ã€‚ continue (æˆ– c)ï¼šç»§ç»­æ‰§è¡Œç¨‹åºï¼Œç›´åˆ°ä¸‹ä¸€ä¸ªæ–­ç‚¹æˆ–ç¨‹åºç»“æŸã€‚ finishï¼šç»§ç»­è¿è¡Œç›´åˆ°å½“å‰å‡½æ•°è¿”å›ã€‚ info b delete åˆ é™¤breakpoint æŸ¥çœ‹å˜é‡ åœ¨ç¨‹åºä¸­ï¼Œå¯ä»¥æŸ¥çœ‹å˜é‡çš„å€¼ï¼š\n(gdb) print x # æ‰“å°å˜é‡ x çš„å€¼ (gdb) print *p # æ‰“å°æŒ‡é’ˆ p æŒ‡å‘çš„å€¼ ä¿®æ”¹å˜é‡å€¼ å¯ä»¥åœ¨è°ƒè¯•è¿‡ç¨‹ä¸­ä¿®æ”¹å˜é‡çš„å€¼ï¼š\n(gdb) set variable x = 10 # å°†å˜é‡ x çš„å€¼è®¾ç½®ä¸º 10 æŸ¥çœ‹è°ƒç”¨æ ˆ å½“ç¨‹åºæš‚åœæ—¶ï¼Œå¯ä»¥æŸ¥çœ‹å½“å‰çš„è°ƒç”¨æ ˆï¼ˆå³å‡½æ•°è°ƒç”¨çš„å±‚çº§ï¼‰ï¼š\n(gdb) backtrace # æ˜¾ç¤ºè°ƒç”¨æ ˆä¿¡æ¯ åˆ‡æ¢æ ˆå¸§ å¯ä»¥é€šè¿‡ frame å‘½ä»¤åˆ‡æ¢åˆ°ç‰¹å®šçš„æ ˆå¸§ï¼ŒæŸ¥çœ‹ä¸åŒå±‚çº§çš„å‡½æ•°çŠ¶æ€ï¼š\n(gdb) frame 2 # åˆ‡æ¢åˆ°è°ƒç”¨æ ˆä¸­çš„ç¬¬ 2 å±‚ è·³è¿‡æŸè¡Œä»£ç  é€šè¿‡ jump å‘½ä»¤å¯ä»¥ç›´æ¥è·³åˆ°ç‰¹å®šè¡Œï¼š\n(gdb) jump 42 # è·³åˆ°ç¬¬ 42 è¡Œ Traps and system calls traps: ecall : åœ¨RISC-Væ¶æ„ä¸­ï¼Œecallæ˜¯ä¸€ä¸ªç”¨äºå‡ºå‘ç¯å¢ƒè°ƒç”¨ï¼ˆEnvironment Callï¼‰ï¼Œä»ç”¨æˆ·æ€è½¬æ¢æˆæ›´é«˜çº§åˆ«è¯·æ±‚ç³»ç»ŸæœåŠ¡ï¼Œå½“ç¨‹åº exception interrupt é‡è¦çš„å¯„å­˜å™¨åŠå«ä¹‰ stvec (Supervisor Trap Vector Base Address Register) å­˜å‚¨å†…æ ¸çš„é™·é˜±å¤„ç†ç¨‹åºçš„åœ°å€ã€‚å½“å‘ç”Ÿé™·é˜±ï¼ˆtrapï¼‰æ—¶ï¼ŒRISC-Vä¼šè·³è½¬åˆ°stvecæŒ‡å®šçš„åœ°å€æ¥å¤„ç†è¯¥é™·é˜± sepc (Supervisor Exception Program Counter) ç”¨äºä¿å­˜å‘ç”Ÿé™·é˜±æ—¶çš„ç¨‹åºè®¡æ•°å™¨ï¼ˆPCï¼‰çš„å€¼ã€‚å½“é™·é˜±å‘ç”Ÿæ—¶ï¼ŒPCçš„å€¼ä¼šè¢«ä¿å­˜åˆ°sepcä¸­ï¼Œè€ŒPCä¼šè¢«é‡ç½®ä¸ºstvecä¸­çš„åœ°å€ã€‚ä¹‹åå†…æ ¸å¯ä»¥ä½¿ç”¨sretï¼ˆè¿”å›é™·é˜±æŒ‡ä»¤ï¼‰å°†sepcçš„å€¼æ¢å¤åˆ°PCï¼Œä»è€Œè¿”å›åˆ°æ­£ç¡®çš„æ‰§è¡Œä½ç½®ã€‚ scause (Supervisor Cause Register) scauseå¯„å­˜å™¨è®°å½•äº†å¯¼è‡´é™·é˜±å‘ç”Ÿçš„åŸå› ã€‚å®ƒåŒ…å«ä¸€ä¸ªæ•°å€¼ï¼Œè¡¨ç¤ºå‡ºå‘é™·é˜±çš„æ—¶é—´ç±»å‹ï¼Œä¾‹å¦‚è®¾å¤‡ä¸­æ–­ï¼Œç³»ç»Ÿè°ƒç”¨å’Œéæ³•æŒ‡ä»¤ã€‚ sscratch (Supervisor Scratch Register) æ˜¯ä¸€ä¸ªä¸´æ—¶å¯„å­˜å™¨ï¼Œå†…æ ¸å¯ä»¥åœ¨é™·é˜±å¤„ç†ç¨‹åºå¼€å§‹æ—¶ç”¨å®ƒæ¥ä¿å­˜é‡è¦å€¼ï¼Œæ–¹ä¾¿å¤„ç†å™¨å¤„ç†é™·é˜±çš„åˆå§‹é˜¶æ®µã€‚ sstatus(Supervisor Status Register) ç”¨äºæ§åˆ¶å’Œåæ˜ å½“å‰å¤„ç†å™¨çš„çŠ¶æ€ï¼Œå…¶åŒ…å«è‹¥å¹²æ§åˆ¶ä½ï¼š SIEï¼ˆSupervisor Interrupt Enableï¼‰ï¼šæ§åˆ¶è®¾å¤‡ä¸­æ–­æ˜¯å¦å¯ç”¨ã€‚å¦‚æœå†…æ ¸æ¸…é™¤SIEä½ï¼ŒRISC-Vä¼šæ¨è¿Ÿå¤„ç†è®¾å¤‡ä¸­æ–­ï¼Œç›´åˆ°å†…æ ¸é‡æ–°è®¾ç½®è¯¥ä½ã€‚ SPPï¼ˆSupervisor Previous Privilegeï¼‰ï¼šæŒ‡ç¤ºé™·é˜±æ¥è‡ªç”¨æˆ·æ¨¡å¼ï¼ˆUser Modeï¼‰è¿˜æ˜¯ç›‘ç£æ¨¡å¼ï¼ˆSupervisor Modeï¼‰ï¼Œå¹¶æ§åˆ¶sretæŒ‡ä»¤è¿”å›çš„æ¨¡å¼ã€‚ ","permalink":"https://kennems.github.io/posts/tech/mit6.s0815-risc-v-calling-convention-stack-frames-and-gdb/","summary":"MIT6.S081(5)-RISC-V calling convention, stack frames, and gdb C code is compiled to machine instructions. How does the machine work at a lower level? How does this translation work? How to interact between C and asm Why this matters: sometimes need to write code not expressible in C And you need this for the syscall lab! RISC-V abstract machine No C-like control flow, no concept of variables, types \u0026hellip; Base ISA:","title":"MIT6.S081(5)-RISC-V calling convention, stack frames, and gdb"},{"content":"C è¯­è¨€æŒ‡é’ˆ Cè¯­è¨€ä¸­çš„å†…å­˜ é™æ€å†…å­˜ï¼ˆStatic Memory)\nGlobal variables, accessible throughout the whole program. Defined with static keywork, as well as variables defined in global scope. æ ˆå†…å­˜ï¼ˆStack Memory)\nLocal variables with functions. Destroyed after function exits. å †å†…å­˜ï¼ˆHeap Memoryï¼‰\nYou control creation and destruction of these variables: malloc(), free() Can lead to memory leaks, use-after-free issues. æŒ‡é’ˆ ï¼ˆå˜é‡ï¼‰= å†…å­˜åœ°å€\nå®šä¹‰æŒ‡é’ˆçš„ * ï¼š æ ‡è®°\nå®šä¹‰æ ¼å¼ ï¼š\næ•°æ®ç±»å‹ * å˜é‡å int a = 10; int *p1 = \u0026amp;a; double b = 10; double *p2 = \u0026amp;b; æŒ‡é’ˆçš„ä½œç”¨ æŒ‡é’ˆæ˜¯ä¸€ä¸ª 64 ä½æ•´æ•°ï¼Œå…¶å€¼ä¸ºå†…å­˜ä¸­çš„åœ°å€ã€‚\næŸ¥è¯¢æ•°æ® * ï¼š è§£å¼•ç”¨è¿ç®—ç¬¦\nint a = 10; int *p1 = \u0026amp;a; printf(\u0026#34;%d\\n\u0026#34;, *p1); // 10 æŒ‡é’ˆå˜é‡çš„æ•°æ®ç±»å‹è¦å’ŒæŒ‡å‘å˜é‡çš„ç±»å‹ä¿æŒä¸€è‡´\næŒ‡é’ˆå˜é‡å ç”¨çš„å¤§å°ï¼Œè·Ÿæ•°æ®ç±»å‹æ— å…³ï¼Œè·Ÿç¼–è¯‘å™¨æœ‰å…³ï¼ˆ32ä½ ï¼š 4å­—èŠ‚ï¼›64ä½ï¼š8å­—èŠ‚ï¼‰\nç»™æŒ‡é’ˆå˜é‡èµ‹å€¼çš„æ—¶å€™ï¼Œä¸èƒ½æŠŠä¸€ä¸ªæ•°èµ‹å€¼ç»™æŒ‡é’ˆå˜é‡\nint a = 10; int *p1 = \u0026amp;a; // int *p1 = 100; é”™è¯¯ï¼Œå°†100çœ‹æˆå†…å­˜åœ°å€ printf(\u0026#34;%d\\n\u0026#34;, *p1); // 10 *p1 = 20; printf(\u0026#34;%d\\n\u0026#34;, *p1); // 20 æ“ä½œå…¶ä»–å‡½æ•°ä¸­çš„å˜é‡ #include \u0026lt;stdlib.h\u0026gt; #include \u0026lt;stdio.h\u0026gt; void swap(int *p1, int *p2) { int tmp = *p1; *p1 = *p2; *p2 = tmp; } int main(int argc, char const *argv[]) { int a = 10, b = 20; printf(\u0026#34;%d, %d\\n\u0026#34;, a, b); swap(\u0026amp;a, \u0026amp;b); printf(\u0026#34;%d, %d\\n\u0026#34;, a, b); return 0; } å‡½æ•°è¿”å›å¤šä¸ªå€¼ #include \u0026lt;stdio.h\u0026gt; void getMaxAndMin(int arr[], int len, int *max, int *min) { *max = arr[0]; *min = arr[0]; for (int i = 1; i \u0026lt; len; i++) { if (arr[i] \u0026gt; *max) { *max = arr[i]; } } for (int i = 1; i \u0026lt; len; i++) { if (arr[i] \u0026lt; *min) { *min = arr[i]; } } } int main(int argc, char const *argv[]) { int arr[] = {1, 2, 3, 100, 4, 5, 6, 7, 8}; int len = sizeof(arr) / sizeof(arr[0]); int max = arr[0]; int min = arr[0]; getMaxAndMin(arr, len, \u0026amp;max, \u0026amp;min); printf(\u0026#34;Max: %d\\n\u0026#34;, max); printf(\u0026#34;Min: %d\\n\u0026#34;, min); return 0; } å‡½æ•°çš„ç»“æœå’Œè®¡ç®—çŠ¶æ€åˆ†å¼€ #include \u0026lt;stdio.h\u0026gt; int getRemainder(int num1, int num2, int *remainder) { if (num2 == 0) { return 1; } *remainder = num1 % num2; return 0; } int main(int argc, char const *argv[]) { int a = 10; int b = 2; int res = 0; int flag = getRemainder(a, b, \u0026amp;res); if (!flag) { printf(\u0026#34;Quotient: %d\\n\u0026#34;, res); } return 0; } æ–¹ä¾¿çš„æ“ä½œæ•°ç»„å’Œå‡½æ•° #include \u0026lt;stdio.h\u0026gt; int main(int argc, char const *argv[]) { /* æŒ‡é’ˆè¿ç®— æ­¥é•¿ï¼šæŒ‡é’ˆç§»åŠ¨ä¸€æ¬¡ï¼Œèµ°çš„å­—èŠ‚æ•°ç›® char : 1 short : 2 int : 4 long : 4 long long : 8 åŠ æ³•/å‡æ³• */ int a = 10; int *p = \u0026amp;a; printf(\u0026#34;p = %p, *p = %d\\n\u0026#34;, p, *p); printf(\u0026#34;%p\\n\u0026#34;, p + 1); printf(\u0026#34;%p\\n\u0026#34;, p - 1); printf(\u0026#34;%p\\n\u0026#34;, p + 2); long x = 10; int x = 10; return 0; } #include \u0026lt;stdio.h\u0026gt; int main(int argc, char const *argv[]) { /* æŒ‡é’ˆè¿ç®— æ­¥é•¿ï¼šæŒ‡é’ˆç§»åŠ¨ä¸€æ¬¡ï¼Œèµ°çš„å­—èŠ‚æ•°ç›® char : 1 short : 2 int : 4 long : 4 long long : 8 åŠ æ³•/å‡æ³• */ int arr[] = {1, 2, 3, 4, 5, 6, 7, 8, 9}; int *p1 = \u0026amp;arr[0]; printf(\u0026#34;p1 æŒ‡å‘çš„å…ƒç´ : %d\\n\u0026#34;, *p1); printf(\u0026#34;p1 + 1 æŒ‡å‘çš„å…ƒç´ : %d\\n\u0026#34;, *(p1 + 1)); int *p2 = \u0026amp;arr[5]; printf(\u0026#34;%d\\n\u0026#34;, p1); printf(\u0026#34;%d\\n\u0026#34;, p2); printf(\u0026#34;%d\\n\u0026#34;, p2 - p1); return 0; } æŒ‡å‘ä¸æ˜çš„æŒ‡é’ˆ é‡æŒ‡é’ˆï¼šæŒ‡é’ˆæŒ‡å‘çš„ç©ºé—´æœªåˆ†é…\næ‚¬ç©ºæŒ‡é’ˆï¼šæŒ‡é’ˆæŒ‡å‘çš„ç©ºé—´å·²ç»åˆ†é…ï¼Œä½†æ˜¯è¢«é‡Šæ”¾äº†\n#include \u0026lt;stdio.h\u0026gt; int *method() { int num = 13; int *p = \u0026amp;num; return p; } int main(int argc, char const *argv[]) { int a = 10; int *p1 = \u0026amp;a; printf(\u0026#34;%p\\n\u0026#34;, p1); printf(\u0026#34;%d\\n\u0026#34;, *p1); // p2 é‡æŒ‡é’ˆ int *p2 = p1 + 10; printf(\u0026#34;%p\\n\u0026#34;, p2); printf(\u0026#34;%d\\n\u0026#34;, *p2); // æ‚¬ç©ºæŒ‡é’ˆï¼šæŒ‡é’ˆæŒ‡å‘çš„å†…å­˜å·²åˆ†é…ï¼Œä½†æ˜¯è¢«é‡Šæ”¾äº† int *p3 = method(); printf(\u0026#34;delay some time\\n\u0026#34;); printf(\u0026#34;%p\\n\u0026#34;, p3); printf(\u0026#34;%d\\n\u0026#34;, *p3); return 0; } æ²¡æœ‰ç±»å‹çš„æŒ‡é’ˆ ç‰¹ç‚¹ï¼šæ— æ³•è·å–æ•°æ®ï¼Œæ— æ³•è®¡ç®—ï¼Œä½†æ˜¯å¯ä»¥æ¥å—ä»»æ„åœ°å€\n#include \u0026lt;stdio.h\u0026gt; // swap å‡½æ•°ç”¨äºäº¤æ¢ä¸¤ä¸ªå†…å­˜åŒºåŸŸçš„å†…å®¹ // p1 å’Œ p2 æ˜¯æŒ‡å‘è¦äº¤æ¢çš„å†…å­˜åœ°å€çš„æŒ‡é’ˆï¼Œlen æ˜¯è¦äº¤æ¢çš„å­—èŠ‚æ•° void swap(void *p1, void *p2, int len) { // å°† void æŒ‡é’ˆè½¬æ¢ä¸º char æŒ‡é’ˆï¼Œä¾¿äºå­—èŠ‚çº§åˆ«çš„æ“ä½œ char *pc1 = p1; char *pc2 = p2; char temp = 0; // ä¸´æ—¶å˜é‡ï¼Œç”¨äºå­˜å‚¨å­—èŠ‚å†…å®¹ // å¾ªç¯ len æ¬¡ï¼Œé€å­—èŠ‚äº¤æ¢å†…å®¹ for (int i = 0; i \u0026lt; len; i++) { temp = *pc1; // ä¿å­˜ pc1 æŒ‡å‘çš„å­—èŠ‚ *pc1 = *pc2; // å°† pc2 æŒ‡å‘çš„å­—èŠ‚èµ‹å€¼ç»™ pc1 *pc2 = temp; // å°†åŸ pc1 æŒ‡å‘çš„å­—èŠ‚èµ‹å€¼ç»™ pc2 pc1++; // ç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªå­—èŠ‚ pc2++; // ç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªå­—èŠ‚ } } int main(int argc, char const *argv[]) { int a = 10; // æ•´æ•°å˜é‡ a short b = 20; // çŸ­æ•´å‹å˜é‡ b int *p1 = \u0026amp;a; // æŒ‡å‘ a çš„æŒ‡é’ˆ short *p2 = \u0026amp;b; // æŒ‡å‘ b çš„æŒ‡é’ˆ // æ‰“å°å˜é‡ a å’Œ b çš„å€¼ printf(\u0026#34;a = %d, b = %d\\n\u0026#34;, a, b); printf(\u0026#34;*p1 = %d, *p2 = %d\\n\u0026#34;, *p1, *p2); // ä¸åŒç±»å‹çš„æŒ‡é’ˆä¹‹é—´ä¸èƒ½ç›´æ¥èµ‹å€¼ // void æŒ‡é’ˆå¯ä»¥æ¥å—ä»»ä½•ç±»å‹çš„æŒ‡é’ˆ char *p3 = (char *)p1; // å°†æ•´å‹æŒ‡é’ˆ p1 è½¬æ¢ä¸ºå­—ç¬¦å‹æŒ‡é’ˆ // printf(\u0026#34;%c\\n\u0026#34;, *p3); // ä¸å»ºè®®è§£å¼•ç”¨ï¼Œå› ä¸º p3 å¯èƒ½æŒ‡å‘éå­—ç¬¦æ•°æ® void *p4 = p1; // ä½¿ç”¨ void æŒ‡é’ˆ p4 å­˜å‚¨ p1 çš„åœ°å€ printf(\u0026#34;%p\\n\u0026#34;, p4); // æ‰“å° p4 çš„åœ°å€ printf(\u0026#34;%p\\n\u0026#34;, p4 + 1); // è™½ç„¶å¯ä»¥è¿›è¡ŒæŒ‡é’ˆç®—æœ¯è¿ç®—ï¼Œä½†è¿™é‡Œçš„ç»“æœä¸å®‰å…¨ void *p5 = p2; // ä½¿ç”¨ void æŒ‡é’ˆ p5 å­˜å‚¨ p2 çš„åœ°å€ // printf(\u0026#34;%d\\n\u0026#34;, *p5); // ä¸å»ºè®®è§£å¼•ç”¨ï¼Œå› ä¸º p5 æ˜¯ void æŒ‡é’ˆ // ä½¿ç”¨ swap å‡½æ•°äº¤æ¢ä¸¤ä¸ª long long int ç±»å‹çš„å€¼ long long int c = 100; // å£°æ˜ long long int å˜é‡ c long long int d = 200; // å£°æ˜ long long int å˜é‡ d printf(\u0026#34;%lld,%lld\\n\u0026#34;, c, d); // æ‰“å° c å’Œ d çš„å€¼ swap(\u0026amp;c, \u0026amp;d, sizeof(long long int)); // è°ƒç”¨ swap å‡½æ•°è¿›è¡Œäº¤æ¢ printf(\u0026#34;%lld,%lld\\n\u0026#34;, c, d); // æ‰“å°äº¤æ¢åçš„ c å’Œ d çš„å€¼ return 0; } äºŒçº§æŒ‡é’ˆå’Œå¤šçº§æŒ‡é’ˆ æŒ‡é’ˆæ•°æ®ç±»å‹ï¼šè·ŸæŒ‡å‘ç©ºé—´ä¸­ï¼Œæ•°æ®çš„ç±»å‹æ˜¯ä¿æŒä¸€è‡´çš„ã€‚\nä½œç”¨ï¼šäºŒçº§æŒ‡é’ˆå¯ä»¥æ“ä½œä¸€çº§æŒ‡é’ˆè®°å½•çš„åœ°å€\n#include \u0026lt;stdio.h\u0026gt; int main(int argc, char const *argv[]) { int a = 10; int b = 20; int *p = \u0026amp;a; int **pp = \u0026amp;p; // ä½œç”¨ä¸€ï¼šåˆ©ç”¨äºŒçº§æŒ‡é’ˆä¿®æ”¹ä¸€çº§æŒ‡é’ˆé‡Œé¢è®°å½•çš„å†…å­˜åœ°å€ *pp = \u0026amp;b; printf(\u0026#34;%p\\n\u0026#34;, \u0026amp;a); printf(\u0026#34;%p\\n\u0026#34;, \u0026amp;b); printf(\u0026#34;%p\\n\u0026#34;, p); // ä½œç”¨äºŒï¼šåˆ©ç”¨äºŒçº§æŒ‡é’ˆè·å–å˜é‡ä¸­è®°å½•çš„æ•°æ® printf(\u0026#34;%d\\n\u0026#34;, **pp); return 0; } æ•°ç»„æŒ‡é’ˆçš„åŸºæœ¬ç”¨æ³• æ¦‚å¿µï¼šæŒ‡å‘æ•°ç»„çš„æŒ‡é’ˆï¼Œå«åšæ•°ç»„æŒ‡é’ˆ\n#include \u0026lt;stdio.h\u0026gt; int main(int argc, char const *argv[]) { int arr[] = {10, 20, 30, 40, 50}; int len = sizeof(arr) / sizeof(int); int *p1 = arr; int *p2 = \u0026amp;arr[0]; printf(\u0026#34;%p\\n\u0026#34;, p1); printf(\u0026#34;%p\\n\u0026#34;, p2); printf(\u0026#34;%d\\n\u0026#34;, *p1); printf(\u0026#34;%d\\n\u0026#34;, *(p1 + 1)); printf(\u0026#34;%d\\n\u0026#34;, *(p1 + 2)); printf(\u0026#34;%d\\n\u0026#34;, *(p1 + 3)); for (int i = 0; i \u0026lt; len; i++) { printf(\u0026#34;%d\\n\u0026#34;, *p1++); } return 0; } arrå‚ä¸è®¡ç®—çš„æ—¶å€™ï¼Œä¼šé€€åŒ–ä¸ºç¬¬ä¸€ä¸ªå…ƒç´ çš„æŒ‡é’ˆ ç‰¹æ®Šæƒ…å†µï¼š sizeof è¿ç®—çš„æ—¶å€™ï¼Œä¸ä¼šé€€åŒ–ï¼Œarrè¿˜æ˜¯æ•´ä½“ \u0026amp;arrè·å–åœ°å€çš„æ—¶å€™ï¼Œä¸ä¼šé€€åŒ– #include \u0026lt;stdio.h\u0026gt; int main(int argc, char const *argv[]) { int arr[] = {10, 20, 30, 40, 50}; int len = sizeof(arr) / sizeof(int); // sizeof è¿ç®—çš„æ—¶å€™ï¼Œarrè¿˜æ˜¯æ•´ä½“ printf(\u0026#34;%zu\\n\u0026#34;, sizeof(arr)); printf(\u0026#34;%p\\n\u0026#34;, arr); // \u0026amp;arr æ—¶ï¼Œ arrè¿˜æ˜¯æ•´ä½“ printf(\u0026#34;%p\\n\u0026#34;, \u0026amp;arr); printf(\u0026#34;%p\\n\u0026#34;, arr + 1); printf(\u0026#34;%p\\n\u0026#34;, \u0026amp;arr + 1); return 0; } é€šè¿‡æŒ‡é’ˆä¾¿åˆ©æ•°ç»„ #include \u0026lt;stdio.h\u0026gt; int main(int argc, char const *argv[]) { /* äºŒç»´æ•°ç»„çš„å®šä¹‰å’Œéå†æ–¹å¼ å®šä¹‰æ ¼å¼æ–¹å¼ä¸€: int arr[è¡Œæ•°][åˆ—æ•°] = { {å…ƒç´ 1, å…ƒç´ 2, ...}, {å…ƒç´ 1, å…ƒç´ 2, ...}, ... }; */ // å®šä¹‰ä¸€ä¸ª 3x5 çš„äºŒç»´æ•°ç»„å¹¶åˆå§‹åŒ– int arr[3][5] = { {1, 2, 3, 4, 5}, // ç¬¬ä¸€è¡Œ {1, 2, 3, 4, 5}, // ç¬¬äºŒè¡Œ {1, 2, 3, 4, 5} // ç¬¬ä¸‰è¡Œ }; // å®šä¹‰ä¸€ä¸ªæŒ‡å‘åŒ…å« 5 ä¸ªæ•´æ•°çš„æ•°ç»„çš„æŒ‡é’ˆï¼ŒæŒ‡å‘ arr int(*p)[5] = arr; // éå†äºŒç»´æ•°ç»„ for (int i = 0; i \u0026lt; 3; i++) // å¤–å±‚å¾ªç¯éå†è¡Œ { for (int j = 0; j \u0026lt; 5; j++) // å†…å±‚å¾ªç¯éå†åˆ— { // ä½¿ç”¨æŒ‡é’ˆè§£å¼•ç”¨å’Œåç§»æ¥è®¿é—®æ•°ç»„å…ƒç´  printf(\u0026#34;%d \u0026#34;, *(*p + j)); // æ‰“å°å½“å‰è¡Œçš„å…ƒç´  } printf(\u0026#34;\\n\u0026#34;); // æ¢è¡Œä»¥åˆ†éš”ä¸åŒçš„è¡Œ p += 1; // ç§»åŠ¨æŒ‡é’ˆåˆ°ä¸‹ä¸€è¡Œ } return 0; // è¿”å› 0 è¡¨ç¤ºç¨‹åºæ­£å¸¸ç»“æŸ } #include \u0026lt;stdio.h\u0026gt; int main(int argc, char const *argv[]) { /* äºŒç»´æ•°ç»„çš„å®šä¹‰å’Œéå†æ–¹å¼ å®šä¹‰æ ¼å¼æ–¹å¼äºŒ: é€šè¿‡ä¸€ç»´æ•°ç»„çš„æŒ‡é’ˆæ•°ç»„æ¥å®ç°äºŒç»´æ•°ç»„çš„æ•ˆæœã€‚ */ // å®šä¹‰ä¸‰ä¸ªä¸€ç»´æ•°ç»„ int arr1[3] = {1, 2, 3}; // ç¬¬ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å« 3 ä¸ªå…ƒç´  int arr2[5] = {1, 2, 3, 4, 5}; // ç¬¬äºŒä¸ªæ•°ç»„ï¼ŒåŒ…å« 5 ä¸ªå…ƒç´  int arr3[9] = {1, 2, 3, 4, 5, 6, 7, 8, 9}; // ç¬¬ä¸‰ä¸ªæ•°ç»„ï¼ŒåŒ…å« 9 ä¸ªå…ƒç´  // è®¡ç®—æ¯ä¸ªæ•°ç»„çš„é•¿åº¦ int len1 = sizeof(arr1) / sizeof(int); // arr1 çš„é•¿åº¦ int len2 = sizeof(arr2) / sizeof(int); // arr2 çš„é•¿åº¦ int len3 = sizeof(arr3) / sizeof(int); // arr3 çš„é•¿åº¦ // å°†æ•°ç»„é•¿åº¦å­˜å…¥ä¸€ä¸ªä¸€ç»´æ•°ç»„ int len[3] = {len1, len2, len3}; // å­˜å‚¨å„æ•°ç»„çš„é•¿åº¦ // å®šä¹‰ä¸€ä¸ªæŒ‡é’ˆæ•°ç»„ï¼ŒæŒ‡å‘ä¸‰ä¸ªä¸€ç»´æ•°ç»„ int *arr[3] = {arr1, arr2, arr3}; // arr æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½æ˜¯æŒ‡å‘æ•´å‹çš„æŒ‡é’ˆ // å®šä¹‰ä¸€ä¸ªæŒ‡å‘æŒ‡é’ˆæ•°ç»„çš„æŒ‡é’ˆ int **p = arr; // p æ˜¯æŒ‡å‘æŒ‡å‘æ•´å‹çš„æŒ‡é’ˆçš„æŒ‡é’ˆ // éå†æŒ‡é’ˆæ•°ç»„ for (int i = 0; i \u0026lt; 3; i++) // å¤–å±‚å¾ªç¯éå†æŒ‡é’ˆæ•°ç»„çš„è¡Œ { for (int j = 0; j \u0026lt; len[i]; j++) // å†…å±‚å¾ªç¯éå†å½“å‰æ•°ç»„çš„åˆ— { // ä½¿ç”¨æŒ‡é’ˆè§£å¼•ç”¨ï¼Œæ‰“å°å½“å‰æ•°ç»„çš„å…ƒç´  printf(\u0026#34;%d \u0026#34;, *(*p + j)); // æ‰“å°å½“å‰è¡Œçš„ç¬¬ j ä¸ªå…ƒç´  } printf(\u0026#34;\\n\u0026#34;); // æ¢è¡Œä»¥åˆ†éš”ä¸åŒçš„æ•°ç»„ p += 1; // ç§»åŠ¨æŒ‡é’ˆåˆ°ä¸‹ä¸€ä¸ªæ•°ç»„ } return 0; // è¿”å› 0 è¡¨ç¤ºç¨‹åºæ­£å¸¸ç»“æŸ } æ•°ç»„æŒ‡é’ˆå’ŒæŒ‡é’ˆæ•°ç»„ æ•°ç»„æŒ‡é’ˆï¼šæŒ‡å‘æ•°ç»„çš„æŒ‡é’ˆ\nä½œç”¨ï¼šæ–¹ä¾¿çš„æ“ä½œæ•°ç»„ä¸­çš„å„ç§æ•°æ®\nä¸¾ä¾‹ï¼šint* p = arr; ï¼ˆæ­¥é•¿ä¸ºï¼šint 4ä¸ªå­—èŠ‚ï¼‰\nä¸¾ä¾‹ï¼šint (*p)[5] = \u0026amp;arr; ï¼ˆæ­¥é•¿ä¸º ï¼šint ä¹˜5 20ä¸ªå­—èŠ‚ï¼‰\næŒ‡é’ˆæ•°ç»„ï¼šå­˜æ”¾æŒ‡é’ˆçš„æ•°ç»„\nä½œç”¨ï¼šç”¨æ¥å­˜æ”¾æŒ‡é’ˆ\nä¸¾ä¾‹ï¼šint *p[5]ï¼Œ è¿™ä¸ªæ•°ç»„é‡Œé¢å­˜æ”¾ç€intç±»å‹çš„æŒ‡é’ˆ\nå‡½æ•°å’ŒæŒ‡é’ˆ æ ¼å¼ï¼šè¿”å›å€¼ç±»å‹ï¼ˆ*æŒ‡é’ˆåï¼‰ï¼ˆå½¢å‚åˆ—è¡¨ï¼‰\nä½œç”¨ï¼šåˆ©ç”¨å‡½æ•°æŒ‡é’ˆï¼Œå¯ä»¥åŠ¨æ€çš„è°ƒç”¨å‡½æ•°\n#include \u0026lt;stdio.h\u0026gt; // å®šä¹‰ä¸€ä¸ªæ— å‚æ•°æ— è¿”å›å€¼çš„å‡½æ•° void method1() { printf(\u0026#34;method1\\n\u0026#34;); // æ‰“å°å‡½æ•°å } // å®šä¹‰ä¸€ä¸ªæ¥å—ä¸¤ä¸ªæ•´æ•°å¹¶è¿”å›æ•´æ•°çš„å‡½æ•° int method2(int num1, int num2) { printf(\u0026#34;method2\\n\u0026#34;); // æ‰“å°å‡½æ•°å return num1 + num2; // è¿”å›ä¸¤ä¸ªå‚æ•°çš„å’Œ } int main(int argc, char const *argv[]) { // å£°æ˜ä¸€ä¸ªæŒ‡å‘æ— å‚æ•°æ— è¿”å›å€¼å‡½æ•°çš„æŒ‡é’ˆ void (*p1)() = method1; // p1 æŒ‡å‘ method1 å‡½æ•° // å£°æ˜ä¸€ä¸ªæŒ‡å‘æ¥å—ä¸¤ä¸ªæ•´æ•°å¹¶è¿”å›æ•´æ•°çš„å‡½æ•°çš„æŒ‡é’ˆ int (*p2)(int, int) = method2; // p2 æŒ‡å‘ method2 å‡½æ•° // è°ƒç”¨æ— å‚æ•°å‡½æ•° p1(); // é€šè¿‡æŒ‡é’ˆè°ƒç”¨ method1 // è°ƒç”¨æœ‰å‚æ•°çš„å‡½æ•°ï¼Œå¹¶å­˜å‚¨è¿”å›å€¼ int num = p2(1, 2); // é€šè¿‡æŒ‡é’ˆè°ƒç”¨ method2ï¼Œä¼ é€’å‚æ•° 1 å’Œ 2 printf(\u0026#34;%d\\n\u0026#34;, num); // æ‰“å° method2 çš„è¿”å›å€¼ return 0; // è¿”å› 0 è¡¨ç¤ºç¨‹åºæ­£å¸¸ç»“æŸ } å‡½æ•°æŒ‡é’ˆ #include \u0026lt;stdio.h\u0026gt; // å®šä¹‰åŠ æ³•å‡½æ•° int add(int num1, int num2) { return num1 + num2; // è¿”å›ä¸¤ä¸ªæ•°çš„å’Œ } // å®šä¹‰å‡æ³•å‡½æ•° int subtract(int num1, int num2) { return num1 - num2; // è¿”å›ç¬¬ä¸€ä¸ªæ•°å‡å»ç¬¬äºŒä¸ªæ•°çš„ç»“æœ } // å®šä¹‰ä¹˜æ³•å‡½æ•° int multiply(int num1, int num2) { return num1 * num2; // è¿”å›ä¸¤ä¸ªæ•°çš„ç§¯ } // å®šä¹‰é™¤æ³•å‡½æ•° int divide(int num1, int num2) { return num1 / num2; // è¿”å›ç¬¬ä¸€ä¸ªæ•°é™¤ä»¥ç¬¬äºŒä¸ªæ•°çš„ç»“æœ } int main(int argc, char const *argv[]) { int a = 10; // ç¤ºä¾‹å˜é‡ a int b = 20; // ç¤ºä¾‹å˜é‡ b // åˆ›å»ºä¸€ä¸ªå‡½æ•°æŒ‡é’ˆæ•°ç»„ï¼Œå­˜å‚¨å››ä¸ªåŸºæœ¬è¿ç®—å‡½æ•° int (*arr[4])(int, int) = {add, subtract, multiply, divide}; // æç¤ºç”¨æˆ·è¾“å…¥ä¸¤ä¸ªæ•°å­— printf(\u0026#34;please input two number to calculate\\n\u0026#34;); int num1, num2; scanf(\u0026#34;%d%d\u0026#34;, \u0026amp;num1, \u0026amp;num2); // è¯»å–ç”¨æˆ·è¾“å…¥çš„ä¸¤ä¸ªæ•°å­— printf(\u0026#34;%d\\n\u0026#34;, num1); // æ‰“å°ç¬¬ä¸€ä¸ªæ•°å­— printf(\u0026#34;%d\\n\u0026#34;, num2); // æ‰“å°ç¬¬äºŒä¸ªæ•°å­— // æç¤ºç”¨æˆ·é€‰æ‹©è¿ç®— int choose; printf(\u0026#34;please input one number to specify the operation you need\\n\u0026#34;); scanf(\u0026#34;%d\u0026#34;, \u0026amp;choose); // è¯»å–ç”¨æˆ·è¾“å…¥çš„é€‰æ‹© // è°ƒç”¨ç›¸åº”çš„è¿ç®—å‡½æ•°å¹¶å­˜å‚¨ç»“æœ int res = (arr[choose - 1])(num1, num2); // æ ¹æ®é€‰æ‹©è°ƒç”¨å‡½æ•° printf(\u0026#34;%d\\n\u0026#34;, res); // æ‰“å°è¿ç®—ç»“æœ return 0; // è¿”å› 0 è¡¨ç¤ºç¨‹åºæ­£å¸¸ç»“æŸ } ","permalink":"https://kennems.github.io/posts/tech/c-%E8%AF%AD%E8%A8%80%E6%8C%87%E9%92%88/","summary":"C è¯­è¨€æŒ‡é’ˆ Cè¯­è¨€ä¸­çš„å†…å­˜ é™æ€å†…å­˜ï¼ˆStatic Memory) Global variables, accessible throughout the whole program. Defined with static keywork, as well as variables defined in global scope. æ ˆå†…å­˜ï¼ˆStack Memory) Local variables with functions. Destroyed after function exits. å †å†…å­˜ï¼ˆHeap M","title":"C è¯­è¨€æŒ‡é’ˆ"},{"content":"MIT6.S081(4)-Virtual Memory Plan: Address spaces\nPaging hardware\nxv6 VM code\nVirtual memory overview Today\u0026rsquo;s problem: [user/kernel diagram] [memory view: diagram with user processes and kernel in memory]\nSuppose the shell has a bug:\nsometimes it writes to a random memory address how can we keep it from wrecking the kernel? and from wrecking other processes?\nwe want isolated address spaces each process has its own memory it can read and write its own memory it cannot read or write anything else\nchallenge: How to multiplex several memories over one physical memory?\nwhile maintaining isolation between memories\nxv6 uses RISC-V\u0026rsquo;s paging hardware to implement AS(Address Space)\u0026rsquo;s ask questions! this material is important topic of next lab (and shows up in several other labs) paging provides a level of indirection for addressing\nCPU -\u0026gt; MMU -\u0026gt; RAM\rVA PA s/w can only ld/st to virtual addresses, not physical kernel tells MMU how to map each virtual address to a physical address MMUï¼ˆMemory Management Unitï¼‰ essentially has a table, indexed by va, yielding pa called a \u0026ldquo;page table\u0026rdquo; one page table per address space MMU can restrict what virtual addresses user code can use By programming the MMU, the kernel has complete control over va-\u0026gt;pa mapping Allows for many interesting OS features/tricks\nRISC-V maps 4-KB \u0026ldquo;pages\u0026rdquo; and aligned \u0026ndash; start on 4 KB boundaries $4 KB = 12 bits$ the RISC-V used in xv6 has 64-bit for addresses thus page table index is top 64-12 = 52 bits of VA except that the top 25 of the top 52 are unused no RISC-V has that much memory now can grow in future so, index is 27 bits. MMU translation see Figure 3.1 of book use index bits of VA to find a page table entry (PTE) construct physical address using PPN from PTE + offset of VA What is in PTE? each PTE is 64 bits, but only 54 are used top 44 bits of PTE are top bits of physical address \u0026ldquo;physical page number\u0026rdquo; low 10 bits of PTE flags Present, Writeable, \u0026amp;c note: size virtual addresses != size physical addresses\nWhere is the page table stored? in RAM \u0026ndash; MMU loads (and stores) PTEs o/s can read/write PTEs read/write memory location corresponding to PTEs\nWould it be reasonable for page table to just be an array of PTEs? how big is it? 2^27 is roughly 134 million 64 bits per entry 134*8 MB for a full page table wasting roughly 1GB per page table one page table per address space one address space per application would waste lots of memory for small programs! you only need mappings for a few hundred pages so the rest of the million entries would be there but not needed\nRISC-V 64 uses a \u0026ldquo;three-level page table\u0026rdquo; to save space see figure 3.2 from book page directory page (PD) PD has 512 PTEs PTEs point to another PD or is a leaf so 512512512 PTEs in total PD entries can be invalid those PTE pages need not exist so a page table for a small address space can be small\nhow does the mmu know where the page table is located in RAM? satp holds phys address of top PD pages can be anywhere in RAM \u0026ndash; need not be contiguous rewrite satp when switching to another address space/application\nhow does RISC-V paging hardware translate a va? need to find the right PTE satp register points to PA of top/L2 PD top 9 bits index L2 PD to get PA of L1 PD next 9 bits index L1 PD to get PA of L0 PD next 9 bits index L0 PD to get PA of PTE PPN from PTE + low-12 from VA\nflags in PTE V, R, W, X, U xv6 uses all of them\nwhat if V bit not set? or store and W bit not set? \u0026ldquo;page fault\u0026rdquo; forces transfer to kernel trap.c in xv6 source kernel can just produce error, kill process in xv6: \u0026ldquo;usertrap(): unexpected scause \u0026hellip; pid=\u0026hellip; sepc=\u0026hellip; stval=\u0026hellip;\u0026rdquo; or kernel can install a PTE, resume the process e.g. after loading the page of memory from disk\nindirection allows paging h/w to solve many problems e.g. phys memory doesn\u0026rsquo;t have to be contiguous avoids fragmentation e.g. lazy allocation (a lab) e.g. copy-on-write fork (another lab) many more techniques topic of next lecture Q: why use virtual memory in kernel? It is clearly good to have page tables for user processes but why have a page table for the kernel? could the kernel run with using only physical addresses? top-level answer: yes most standard kernels do use virtual addresses why do standard kernels do so? some reasons are lame, some are better, none are fundamental\nthe hardware makes it difficult to turn it off e.g. on entering a system call, one would have to disable VM the kernel itself can benefit from virtual addresses mark text pages X, but data not (helps tracking down bugs) unmap a page below kernel stack (helps tracking down bugs) map a page both in user and kernel (helps user/kernel transition) Virtual memory in xv6 kernel page table See figure 3.3 of book simple maping mostly map virtual to physical one-on-one note double-mapping of trampoline note permissions why map devices? Trampoline çš„ä½œç”¨ ä¸ºå†…æ ¸å’Œç”¨æˆ·æ€ä¹‹é—´çš„åˆ‡æ¢æä¾›ä¸€ä¸ªç»Ÿä¸€çš„å…¥å£ã€‚ç”±äºå…¶åœ¨æ¯ä¸ªè¿›ç¨‹çš„é¡µè¡¨éƒ½æ˜ å°„åˆ°ç›¸åŒçš„ç‰©ç†åœ°å€ï¼Œå†…æ ¸å’Œç”¨æˆ·è¿›ç¨‹éƒ½èƒ½å¤Ÿåœ¨åˆ‡æ¢è¿‡ç¨‹ä¸­ä½¿ç”¨è¿™æ®µä»£ç ï¼Œå¯ä»¥ç¡®ä¿ ï¼š\nä¸Šä¸‹æ–‡çš„ä¿å­˜å’Œæ¢å¤ï¼šä¿å­˜å½“å‰çš„CPUçŠ¶æ€ï¼ˆå¯„å­˜å™¨ï¼Œå †æ ˆç­‰ï¼‰ï¼Œå¹¶åœ¨è¿”å›ç”¨æˆ·æ€æ—¶æ¢å¤ã€‚ åœ°å€ç©ºé—´åˆ‡æ¢ ï¼š åœ¨è¿›ç¨‹åˆ‡æ¢æ—¶ï¼Œä»ç”¨æˆ·åœ°å€ç©ºé—´åˆ‡æ¢åˆ°å†…æ ¸åœ°å€ç©ºé—´ï¼Œå¹¶ç¡®ä¿å®‰å…¨ã€‚ trampolineæˆä¸ºç”¨æˆ·æ€å’Œå†…æ ¸æ€ä¹‹é—´å®‰å…¨ä¸”ä¸€è‡´çš„æ¡¥æ¢ã€‚\nEach process has its own address space and its own page table\nsee figure 3.4 of book\nnote:\ntrampoline and trapframe aren\u0026rsquo;t writable by user process\nkernel switches page tables (i.e. sets satp) when switching processes\nQ: why this address space arrangement? user virtual addresses start at zero of course user va 0 maps to different pa for each process $16,777,216 GB$ for user heap to grow contiguously but needn\u0026rsquo;t have contiguous phys mem \u0026ndash; no fragmentation problem both kernel and user map trampoline and trapframe page eases transition user -\u0026gt; kernel and back kernel doesn\u0026rsquo;t map user applications not easy for kernel to r/w user memory need translate user virtual address to kernel virtual address good for isolation (see spectre attacks) easy for kernel to r/w physical memory pa x mapped at va x\nQ: does the kernel have to map all of phys mem into its virtual address space? Code walk through setup of kernel address space kvmmap()\n// åœ¨å†…æ ¸é¡µè¡¨ä¸­æ·»åŠ ä¸€ä¸ªæ˜ å°„ã€‚ // ä»…åœ¨å¯åŠ¨æ—¶ä½¿ç”¨ã€‚ // è¯¥å‡½æ•°ä¸åˆ·æ–° TLB æˆ–å¯ç”¨åˆ†é¡µã€‚ void kvmmap(uint64 va, uint64 pa, uint64 sz, int perm) { // è°ƒç”¨ mappages å‡½æ•°å°†è™šæ‹Ÿåœ°å€ va æ˜ å°„åˆ°ç‰©ç†åœ°å€ paï¼Œæ˜ å°„å¤§å°ä¸º szï¼Œæƒé™ä¸º perm if(mappages(kernel_pagetable, va, sz, pa, perm) != 0) // å¦‚æœæ˜ å°„å¤±è´¥ï¼Œåˆ™è§¦å‘ç³»ç»Ÿé”™è¯¯ panic(\u0026#34;kvmmap\u0026#34;); } Q: what is address 0x10000000 (256M)\n$ 0x10000000 = 256 MB$\nQ: how much address space does 1 L2 entry cover? (1G)\n$512Ã—2 MB=1 GB$\nQ: how much address space does 1 L1 entry cover? (2MB)\n$512 Ã— 4096B = 2MB$\nQ: how much address space does 1 L0 entry cover? (4096)\næ¯ä¸ª L0 æ¡ç›®æŒ‡å‘ä¸€ä¸ª 4KB çš„é¡µï¼Œå› æ­¤æ¯ä¸ª L0 æ¡ç›®è¦†ç›– 4096 å­—èŠ‚çš„åœ°å€ç©ºé—´\nprint kernel page table\nQ: what is size of address space? (512G)\næ¯ä¸ªL2è¦†ç›– $1GB$, å…±è¦†ç›–$512GB$\nQ: how much memory is used to represent it after 1rst kvmmap()?\n($3 pages$)\nQ: how many entries is CLINT?\n($16 pages$)\nQ: how many entries is PLIC?\n(1024 pages, two level 1 PDs)\nQ: how many pages is kernel text\n$ (8 pages)$\nQ: how many pages is kernel total\n$ (128M = 64 * 2MB)$\nQ: Is trampoline mapped twice?\n(yes, last entry and direct-mapped, entry [2, 3, 7])\nkvminithart(); Q: after executing w_satp() why will the next instruction be sfence_vma()?\nmappages() in vm.c // ä¸ºä» va å¼€å§‹çš„è™šæ‹Ÿåœ°å€åˆ›å»º PTEï¼ˆé¡µè¡¨æ¡ç›®ï¼‰ï¼Œ // è¿™äº›æ¡ç›®å¼•ç”¨ä» pa å¼€å§‹çš„ç‰©ç†åœ°å€ã€‚ // va å’Œ size å¯èƒ½ä¸æ˜¯é¡µé¢å¯¹é½çš„ã€‚ // æˆåŠŸè¿”å› 0ï¼Œå¤±è´¥æ—¶è¿”å› -1ï¼ˆå¦‚æœ walk() æ— æ³•åˆ†é…æ‰€éœ€çš„é¡µè¡¨é¡µé¢ï¼‰ã€‚ int mappages(pagetable_t pagetable, uint64 va, uint64 size, uint64 pa, int perm) { uint64 a, last; // å®šä¹‰å˜é‡ a å’Œ lastï¼Œç”¨äºè·Ÿè¸ªå½“å‰åœ°å€ pte_t *pte; // å®šä¹‰æŒ‡é’ˆ pteï¼Œç”¨äºè®¿é—®é¡µè¡¨æ¡ç›® // å°†è™šæ‹Ÿåœ°å€ va å‘ä¸‹å¯¹é½åˆ°é¡µé¢è¾¹ç•Œ a = PGROUNDDOWN(va); // å°†æœ€åä¸€ä¸ªè™šæ‹Ÿåœ°å€å‘ä¸‹å¯¹é½åˆ°é¡µé¢è¾¹ç•Œ last = PGROUNDDOWN(va + size - 1); // å¾ªç¯åˆ›å»ºé¡µè¡¨æ¡ç›® for(;;){ // è·å–å½“å‰è™šæ‹Ÿåœ°å€ a å¯¹åº”çš„é¡µè¡¨æ¡ç›® if((pte = walk(pagetable, a, 1)) == 0) return -1; // å¦‚æœ walk å¤±è´¥ï¼Œè¿”å› -1 // æ£€æŸ¥å½“å‰é¡µè¡¨æ¡ç›®æ˜¯å¦å·²ç»æœ‰æ•ˆ if(*pte \u0026amp; PTE_V) panic(\u0026#34;remap\u0026#34;); // å¦‚æœå·²ç»æ˜ å°„ï¼Œè§¦å‘é”™è¯¯ // è®¾ç½®é¡µè¡¨æ¡ç›®ï¼Œæ˜ å°„ç‰©ç†åœ°å€ paï¼Œå¹¶è®¾ç½®æƒé™å’Œæœ‰æ•ˆä½ *pte = PA2PTE(pa) | perm | PTE_V; // å¦‚æœå½“å‰åœ°å€ a æ˜¯æœ€åä¸€ä¸ªåœ°å€ï¼Œé€€å‡ºå¾ªç¯ if(a == last) break; // ç»§ç»­åˆ°ä¸‹ä¸€ä¸ªé¡µé¢ a += PGSIZE; // ç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªè™šæ‹Ÿåœ°å€ pa += PGSIZE; // ç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªç‰©ç†åœ°å€ } return 0; // æˆåŠŸåˆ›å»ºæ‰€æœ‰é¡µè¡¨æ¡ç›®ï¼Œè¿”å› 0 } arguments are top PD, va, size, pa, perm adds mappings from a range of va\u0026rsquo;s to corresponding pa\u0026rsquo;s rounds b/c some uses pass in non-page-aligned addresses for each page-aligned address in the range call walkpgdir to find address of PTE need the PTE\u0026rsquo;s address (not just content) b/c we want to modify put the desired pa into the PTE mark PTE as valid w/ PTE_P\nwalk() in vm.c pte_t * walk(pagetable_t pagetable, uint64 va, int alloc) { // æ£€æŸ¥è™šæ‹Ÿåœ°å€æ˜¯å¦è¶…è¿‡æœ€å¤§è™šæ‹Ÿåœ°å€ if(va \u0026gt;= MAXVA) panic(\u0026#34;walk\u0026#34;); // ä»æœ€é«˜çº§åˆ«çš„é¡µè¡¨å¼€å§‹ï¼Œé€çº§å‘ä¸‹æŸ¥æ‰¾ for(int level = 2; level \u0026gt; 0; level--) { // è·å–å½“å‰çº§åˆ«çš„é¡µè¡¨æ¡ç›®æŒ‡é’ˆ pte_t *pte = \u0026amp;pagetable[PX(level, va)]; // å¦‚æœé¡µè¡¨æ¡ç›®æœ‰æ•ˆ if(*pte \u0026amp; PTE_V) { // è·å–ç‰©ç†åœ°å€å¹¶è¿›å…¥ä¸‹ä¸€å±‚é¡µè¡¨ pagetable = (pagetable_t)PTE2PA(*pte); } else { // å¦‚æœä¸åˆ†é…ï¼Œæˆ–è€…åˆ†é…å¤±è´¥ï¼Œè¿”å›0 if(!alloc || (pagetable = (pde_t*)kalloc()) == 0) return 0; // åˆå§‹åŒ–æ–°çš„é¡µè¡¨ä¸º0 memset(pagetable, 0, PGSIZE); // è®¾ç½®é¡µè¡¨æ¡ç›®ä¸ºæ–°åˆ†é…çš„é¡µè¡¨çš„ç‰©ç†åœ°å€ï¼Œæ ‡è®°ä¸ºæœ‰æ•ˆ *pte = PA2PTE(pagetable) | PTE_V; } } // è¿”å›æœ€ä½çº§åˆ«é¡µè¡¨ä¸­å¯¹åº”è™šæ‹Ÿåœ°å€çš„é¡µè¡¨æ¡ç›® return \u0026amp;pagetable[PX(0, va)]; } mimics how the paging h/w finds the PTE for an address PX extracts the 9 bits at Level level \u0026amp;pagetable[PX(level, va)] is the address of the relevant PTE\nif PTE_V\rthe relevant page-table page already exists\rPTE2PA extracts the PPN from the PDE\rif not PTE_V\ralloc a page-table page\rfill in pte with PPN (using PA2PTE) now the PTE we want is in the page-table page\nprocinit() in proc.c // åœ¨å¯åŠ¨æ—¶åˆå§‹åŒ–è¿›ç¨‹è¡¨ã€‚ void procinit(void) { struct proc *p; // åˆå§‹åŒ–è¿›ç¨‹ ID é”ï¼Œä»¥ç¡®ä¿å¯¹è¿›ç¨‹ ID çš„å®‰å…¨è®¿é—®ã€‚ initlock(\u0026amp;pid_lock, \u0026#34;nextpid\u0026#34;); // éå†è¿›ç¨‹è¡¨ä¸­çš„æ¯ä¸ªè¿›ç¨‹ for(p = proc; p \u0026lt; \u0026amp;proc[NPROC]; p++) { // åˆå§‹åŒ–æ¯ä¸ªè¿›ç¨‹çš„é”ï¼Œä»¥ä¿æŠ¤è¿›ç¨‹ç»“æ„çš„å¹¶å‘è®¿é—®ã€‚ initlock(\u0026amp;p-\u0026gt;lock, \u0026#34;proc\u0026#34;); // ä¸ºè¿›ç¨‹çš„å†…æ ¸æ ˆåˆ†é…ä¸€é¡µå†…å­˜ã€‚ // å°†å…¶æ˜ å°„åˆ°é«˜åœ°å€å†…å­˜ï¼Œå¹¶è·Ÿéšä¸€ä¸ªæ— æ•ˆçš„ä¿æŠ¤é¡µã€‚ char *pa = kalloc(); // åˆ†é…ä¸€é¡µå†…å­˜ if(pa == 0) panic(\u0026#34;kalloc\u0026#34;); // å¦‚æœåˆ†é…å¤±è´¥ï¼Œè§¦å‘ç³»ç»Ÿé”™è¯¯ // è®¡ç®—è¯¥è¿›ç¨‹å†…æ ¸æ ˆçš„è™šæ‹Ÿåœ°å€ uint64 va = KSTACK((int) (p - proc)); // åœ¨å†…æ ¸é¡µè¡¨ä¸­æ˜ å°„è™šæ‹Ÿåœ°å€ va åˆ°ç‰©ç†åœ°å€ paï¼Œå¤§å°ä¸º PGSIZEï¼Œæƒé™ä¸ºå¯è¯»å’Œå¯å†™ kvmmap(va, (uint64)pa, PGSIZE, PTE_R | PTE_W); // å°†è®¡ç®—å‡ºçš„è™šæ‹Ÿåœ°å€ä¿å­˜åˆ°è¿›ç¨‹ç»“æ„ä¸­ p-\u0026gt;kstack = va; } // åˆå§‹åŒ–è™šæ‹Ÿå†…å­˜ç®¡ç†ç›¸å…³çš„ç¡¬ä»¶è®¾ç½® kvminithart(); } alloc a page for each kernel stack with a guard page\nsetup user address space allocproc(): allocates empty top-level page table // åœ¨è¿›ç¨‹è¡¨ä¸­æŸ¥æ‰¾ä¸€ä¸ª UNUSED çŠ¶æ€çš„è¿›ç¨‹ã€‚ // å¦‚æœæ‰¾åˆ°ï¼Œåˆå§‹åŒ–æ‰€éœ€çš„çŠ¶æ€ä»¥åœ¨å†…æ ¸ä¸­è¿è¡Œï¼Œå¹¶è¿”å›æ—¶æŒæœ‰ p-\u0026gt;lockã€‚ // å¦‚æœæ²¡æœ‰ç©ºé—²çš„è¿›ç¨‹ï¼Œæˆ–å†…å­˜åˆ†é…å¤±è´¥ï¼Œè¿”å› 0ã€‚ static struct proc* allocproc(void) { struct proc *p; // éå†è¿›ç¨‹è¡¨ä¸­çš„æ¯ä¸ªè¿›ç¨‹ for(p = proc; p \u0026lt; \u0026amp;proc[NPROC]; p++) { acquire(\u0026amp;p-\u0026gt;lock); // è·å–è¿›ç¨‹çš„é”ä»¥å®‰å…¨è®¿é—®å…¶çŠ¶æ€ if(p-\u0026gt;state == UNUSED) { // æ£€æŸ¥è¿›ç¨‹çŠ¶æ€æ˜¯å¦ä¸º UNUSED goto found; // æ‰¾åˆ°ç©ºé—²è¿›ç¨‹ï¼Œè·³è½¬åˆ°åˆå§‹åŒ–éƒ¨åˆ† } else { release(\u0026amp;p-\u0026gt;lock); // å¦‚æœä¸æ˜¯ UNUSEDï¼Œé‡Šæ”¾é”å¹¶ç»§ç»­ä¸‹ä¸€ä¸ªè¿›ç¨‹ } } // å¦‚æœæ²¡æœ‰æ‰¾åˆ°ç©ºé—²è¿›ç¨‹ï¼Œè¿”å› 0 return 0; found: // åˆ†é…ä¸€ä¸ªæ–°çš„è¿›ç¨‹ ID p-\u0026gt;pid = allocpid(); // ä¸ºè¿›ç¨‹åˆ†é…ä¸€ä¸ª trapframe é¡µé¢ï¼Œç”¨äºå¤„ç†ç³»ç»Ÿè°ƒç”¨å’Œä¸­æ–­ if((p-\u0026gt;trapframe = (struct trapframe *)kalloc()) == 0) { release(\u0026amp;p-\u0026gt;lock); // åˆ†é…å¤±è´¥ï¼Œé‡Šæ”¾é” return 0; // è¿”å› 0 è¡¨ç¤ºå¤±è´¥ } // åˆ›å»ºä¸€ä¸ªç©ºçš„ç”¨æˆ·é¡µé¢è¡¨ p-\u0026gt;pagetable = proc_pagetable(p); if(p-\u0026gt;pagetable == 0) { // æ£€æŸ¥é¡µé¢è¡¨åˆ†é…æ˜¯å¦æˆåŠŸ freeproc(p); // å¦‚æœåˆ†é…å¤±è´¥ï¼Œé‡Šæ”¾è¿›ç¨‹èµ„æº release(\u0026amp;p-\u0026gt;lock); // é‡Šæ”¾é” return 0; // è¿”å› 0 è¡¨ç¤ºå¤±è´¥ } // è®¾ç½®æ–°çš„ä¸Šä¸‹æ–‡ï¼Œä»¥åœ¨ forkret å¤„å¼€å§‹æ‰§è¡Œï¼Œ // forkret ä¼šè¿”å›åˆ°ç”¨æˆ·ç©ºé—´ã€‚ memset(\u0026amp;p-\u0026gt;context, 0, sizeof(p-\u0026gt;context)); // æ¸…é›¶ä¸Šä¸‹æ–‡ç»“æ„ p-\u0026gt;context.ra = (uint64)forkret; // è®¾ç½®è¿”å›åœ°å€ä¸º forkret å‡½æ•° p-\u0026gt;context.sp = p-\u0026gt;kstack + PGSIZE; // è®¾ç½®å †æ ˆæŒ‡é’ˆåˆ°å†…æ ¸æ ˆçš„é¡¶éƒ¨ return p; // è¿”å›åˆ†é…å’Œåˆå§‹åŒ–çš„è¿›ç¨‹ } fork(): uvmcopy()\n// æ ¹æ®çˆ¶è¿›ç¨‹çš„é¡µè¡¨ï¼Œå°†å…¶å†…å­˜å¤åˆ¶åˆ°å­è¿›ç¨‹çš„é¡µè¡¨ã€‚ // å¤åˆ¶é¡µè¡¨å’Œç‰©ç†å†…å­˜ã€‚ // æˆåŠŸè¿”å› 0ï¼Œå¤±è´¥è¿”å› -1ã€‚ // åœ¨å¤±è´¥æ—¶é‡Šæ”¾å·²åˆ†é…çš„é¡µé¢ã€‚ int uvmcopy(pagetable_t old, pagetable_t new, uint64 sz) { pte_t *pte; // é¡µè¡¨æ¡ç›®çš„æŒ‡é’ˆ uint64 pa, i; // ç‰©ç†åœ°å€å’Œå¾ªç¯å˜é‡ uint flags; // é¡µè¡¨æ¡ç›®çš„æ ‡å¿—ä½ // éå†ä» 0 åˆ° sz çš„æ‰€æœ‰é¡µé¢ for(i = 0; i \u0026lt; sz; i += PGSIZE){ // è·å–æ—§é¡µè¡¨ä¸­å¯¹åº”è™šæ‹Ÿåœ°å€çš„é¡µè¡¨æ¡ç›® if((pte = walk(old, i, 0)) == 0) panic(\u0026#34;uvmcopy: pte should exist\u0026#34;); // å¦‚æœæœªæ‰¾åˆ°é¡µè¡¨æ¡ç›®ï¼Œè§¦å‘é”™è¯¯ // æ£€æŸ¥é¡µè¡¨æ¡ç›®æ˜¯å¦æœ‰æ•ˆ if((*pte \u0026amp; PTE_V) == 0) panic(\u0026#34;uvmcopy: page not present\u0026#34;); // å¦‚æœé¡µé¢ä¸å­˜åœ¨ï¼Œè§¦å‘é”™è¯¯ // è·å–ç‰©ç†åœ°å€ pa = PTE2PA(*pte); // æ¸…é™¤å†™æƒé™æ ‡å¿—ï¼Œä»¥ä¾¿è¿›è¡Œå†™æ—¶å¤åˆ¶ï¼ˆCopy-On-Writeï¼‰ *pte \u0026amp;= (~PTE_W); // æ¸…é™¤ PTE_W *pte |= (PTE_C); // è®¾ç½® PTE_Cï¼Œæ ‡è®°æ­¤é¡µé¢ä¸º Copy-On-Write // è·å–å½“å‰é¡µè¡¨æ¡ç›®çš„å…¶ä»–æ ‡å¿— flags = PTE_FLAGS(*pte); // åœ¨æ–°é¡µè¡¨ä¸­æ˜ å°„åŸæ¥çš„ç‰©ç†åœ°å€ if (mappages(new, i, PGSIZE, pa, flags) != 0) { goto err; // å¦‚æœæ˜ å°„å¤±è´¥ï¼Œè·³è½¬åˆ°é”™è¯¯å¤„ç† } // å¢åŠ ç‰©ç†é¡µé¢çš„å¼•ç”¨è®¡æ•° kincre((void *)pa); } return 0; // æˆåŠŸå®Œæˆå¤åˆ¶ï¼Œè¿”å› 0 err: // é‡Šæ”¾åœ¨æ–°é¡µè¡¨ä¸­å·²åˆ†é…çš„é¡µé¢ uvmunmap(new, 0, i / PGSIZE, 1); return -1; // è¿”å› -1 è¡¨ç¤ºå¤±è´¥ } exec(): replace proc\u0026rsquo;s page table with a new one\n// æ‰§è¡ŒæŒ‡å®šè·¯å¾„çš„ç¨‹åºï¼Œè®¾ç½®æ–°çš„ç”¨æˆ·æ ˆå¹¶å‡†å¤‡å‚æ•°ã€‚ // æˆåŠŸè¿”å›ç¨‹åºçš„å‚æ•°ä¸ªæ•°ï¼Œå¤±è´¥è¿”å› -1ã€‚ int exec(char *path, char **argv) { char *s, *last; // å­—ç¬¦ä¸²æŒ‡é’ˆï¼Œç”¨äºå¤„ç†è·¯å¾„ int i, off; // å¾ªç¯å˜é‡å’Œåç§»é‡ uint64 argc, sz = 0, sp, ustack[MAXARG+1], stackbase; // å‚æ•°è®¡æ•°ã€å†…å­˜å¤§å°ã€æ ˆæŒ‡é’ˆã€ç”¨æˆ·æ ˆæ•°ç»„å’Œæ ˆåŸºåœ°å€ struct elfhdr elf; // ELF å¤´ç»“æ„ struct inode *ip; // æ–‡ä»¶èŠ‚ç‚¹æŒ‡é’ˆ struct proghdr ph; // ç¨‹åºå¤´ç»“æ„ pagetable_t pagetable = 0, oldpagetable; // æ–°æ—§é¡µè¡¨ struct proc *p = myproc(); // è·å–å½“å‰è¿›ç¨‹ç»“æ„ begin_op(); // å¼€å§‹æ–‡ä»¶æ“ä½œ // æŸ¥æ‰¾ç¨‹åºè·¯å¾„å¯¹åº”çš„ inode if((ip = namei(path)) == 0){ end_op(); // ç»“æŸæ–‡ä»¶æ“ä½œ return -1; // æ‰¾ä¸åˆ°æ–‡ä»¶ï¼Œè¿”å› -1 } ilock(ip); // é”å®š inode // æ£€æŸ¥ ELF å¤´ if(readi(ip, 0, (uint64)\u0026amp;elf, 0, sizeof(elf)) != sizeof(elf)) goto bad; // è¯»å– ELF å¤´å¤±è´¥ï¼Œè·³è½¬åˆ°é”™è¯¯å¤„ç† if(elf.magic != ELF_MAGIC) goto bad; // æ£€æŸ¥ ELF é­”æ³•æ•°ï¼Œè‹¥ä¸åŒ¹é…åˆ™è·³è½¬åˆ°é”™è¯¯å¤„ç† // è·å–å½“å‰è¿›ç¨‹çš„é¡µè¡¨ if((pagetable = proc_pagetable(p)) == 0) goto bad; // è·å–é¡µè¡¨å¤±è´¥ï¼Œè·³è½¬åˆ°é”™è¯¯å¤„ç† // ä» ELF æ–‡ä»¶åŠ è½½ç¨‹åºåˆ°å†…å­˜ for(i = 0, off = elf.phoff; i \u0026lt; elf.phnum; i++, off += sizeof(ph)){ // è¯»å–ç¨‹åºå¤´ if(readi(ip, 0, (uint64)\u0026amp;ph, off, sizeof(ph)) != sizeof(ph)) goto bad; // è¯»å–å¤±è´¥ï¼Œè·³è½¬åˆ°é”™è¯¯å¤„ç† if(ph.type != ELF_PROG_LOAD) continue; // ä»…å¤„ç†åŠ è½½ç±»å‹çš„ç¨‹åºå¤´ if(ph.memsz \u0026lt; ph.filesz) goto bad; // å†…å­˜å¤§å°å°äºæ–‡ä»¶å¤§å°ï¼Œè·³è½¬åˆ°é”™è¯¯å¤„ç† if(ph.vaddr + ph.memsz \u0026lt; ph.vaddr) goto bad; // åœ°å€æº¢å‡ºï¼Œè·³è½¬åˆ°é”™è¯¯å¤„ç† uint64 sz1; // ä¸ºåŠ è½½çš„æ®µåˆ†é…å†…å­˜ if((sz1 = uvmalloc(pagetable, sz, ph.vaddr + ph.memsz)) == 0) goto bad; // å†…å­˜åˆ†é…å¤±è´¥ï¼Œè·³è½¬åˆ°é”™è¯¯å¤„ç† sz = sz1; // æ›´æ–°åˆ†é…å¤§å° // æ£€æŸ¥æ®µçš„è™šæ‹Ÿåœ°å€æ˜¯å¦å¯¹é½ if(ph.vaddr % PGSIZE != 0) goto bad; // è™šæ‹Ÿåœ°å€æœªå¯¹é½ï¼Œè·³è½¬åˆ°é”™è¯¯å¤„ç† // ä»æ–‡ä»¶ä¸­åŠ è½½æ®µåˆ°å†…å­˜ if(loadseg(pagetable, ph.vaddr, ip, ph.off, ph.filesz) \u0026lt; 0) goto bad; // åŠ è½½æ®µå¤±è´¥ï¼Œè·³è½¬åˆ°é”™è¯¯å¤„ç† } iunlockput(ip); // è§£é”å¹¶é‡Šæ”¾ inode end_op(); // ç»“æŸæ–‡ä»¶æ“ä½œ ip = 0; // æ¸…ç©º inode æŒ‡é’ˆ p = myproc(); // å†æ¬¡è·å–å½“å‰è¿›ç¨‹ç»“æ„ uint64 oldsz = p-\u0026gt;sz; // ä¿å­˜æ—§çš„ç¨‹åºå¤§å° // åœ¨ä¸‹ä¸€ä¸ªé¡µè¾¹ç•Œåˆ†é…ä¸¤ä¸ªé¡µé¢ // ä½¿ç”¨ç¬¬äºŒä¸ªé¡µé¢ä½œä¸ºç”¨æˆ·æ ˆ sz = PGROUNDUP(sz); // å°†å¤§å°å‘ä¸Šå¯¹é½åˆ°é¡µè¾¹ç•Œ uint64 sz1; if((sz1 = uvmalloc(pagetable, sz, sz + 2*PGSIZE)) == 0) goto bad; // å†…å­˜åˆ†é…å¤±è´¥ï¼Œè·³è½¬åˆ°é”™è¯¯å¤„ç† sz = sz1; // æ›´æ–°åˆ†é…å¤§å° uvmclear(pagetable, sz - 2 * PGSIZE); // æ¸…é™¤æ ˆåº•çš„é¡µé¢å†…å®¹ sp = sz; // è®¾ç½®æ ˆæŒ‡é’ˆ stackbase = sp - PGSIZE; // è®¾ç½®æ ˆåŸºåœ°å€ // å°†å‚æ•°å­—ç¬¦ä¸²æ¨å…¥æ ˆï¼Œå¹¶å‡†å¤‡æ ˆçš„å…¶ä»–éƒ¨åˆ† for(argc = 0; argv[argc]; argc++) { if(argc \u0026gt;= MAXARG) goto bad; // è¶…è¿‡æœ€å¤§å‚æ•°æ•°é‡ï¼Œè·³è½¬åˆ°é”™è¯¯å¤„ç† sp -= strlen(argv[argc]) + 1; // ä¸ºå‚æ•°å­—ç¬¦ä¸²åˆ†é…ç©ºé—´ sp -= sp % 16; // ç¡®ä¿æ ˆæŒ‡é’ˆæ˜¯ 16 å­—èŠ‚å¯¹é½ if(sp \u0026lt; stackbase) goto bad; // æ ˆæŒ‡é’ˆè¶…å‡ºæ ˆåŸºï¼Œè·³è½¬åˆ°é”™è¯¯å¤„ç† if(copyout(pagetable, sp, argv[argc], strlen(argv[argc]) + 1) \u0026lt; 0) goto bad; // å°†å‚æ•°å­—ç¬¦ä¸²å¤åˆ¶åˆ°ç”¨æˆ·æ ˆå¤±è´¥ï¼Œè·³è½¬åˆ°é”™è¯¯å¤„ç† ustack[argc] = sp; // ä¿å­˜å‚æ•°å­—ç¬¦ä¸²çš„åœ°å€ } ustack[argc] = 0; // ä»¥ 0 ç»“æŸå‚æ•°æ•°ç»„ // å°† argv[] æŒ‡é’ˆæ•°ç»„æ¨å…¥æ ˆ sp -= (argc + 1) * sizeof(uint64); // ä¸º argv æŒ‡é’ˆæ•°ç»„åˆ†é…ç©ºé—´ sp -= sp % 16; // ç¡®ä¿æ ˆæŒ‡é’ˆæ˜¯ 16 å­—èŠ‚å¯¹é½ if(sp \u0026lt; stackbase) goto bad; // æ ˆæŒ‡é’ˆè¶…å‡ºæ ˆåŸºï¼Œè·³è½¬åˆ°é”™è¯¯å¤„ç† if(copyout(pagetable, sp, (char *)ustack, (argc + 1) * sizeof(uint64)) \u0026lt; 0) goto bad; // å¤åˆ¶ argv æŒ‡é’ˆæ•°ç»„å¤±è´¥ï¼Œè·³è½¬åˆ°é”™è¯¯å¤„ç† // å‡†å¤‡ç”¨æˆ·ä¸»å‡½æ•°çš„å‚æ•° (argc, argv) // argc å°†é€šè¿‡ç³»ç»Ÿè°ƒç”¨è¿”å›å€¼æ”¾å…¥ a0 ä¸­ p-\u0026gt;trapframe-\u0026gt;a1 = sp; // å°†æ ˆæŒ‡é’ˆèµ‹å€¼ç»™ trapframe // ä¿å­˜ç¨‹åºåç§°ä»¥ä¾¿è°ƒè¯• for(last = s = path; *s; s++) if(*s == \u0026#39;/\u0026#39;) last = s + 1; // æ‰¾åˆ°è·¯å¾„ä¸­çš„æœ€åä¸€ä¸ªæ–œæ  safestrcpy(p-\u0026gt;name, last, sizeof(p-\u0026gt;name)); // å¤åˆ¶ç¨‹åºåç§° // æäº¤ç”¨æˆ·æ˜ åƒ oldpagetable = p-\u0026gt;pagetable; // ä¿å­˜æ—§çš„é¡µè¡¨ p-\u0026gt;pagetable = pagetable; // æ›´æ–°å½“å‰è¿›ç¨‹çš„é¡µè¡¨ p-\u0026gt;sz = sz; // æ›´æ–°è¿›ç¨‹çš„å†…å­˜å¤§å° p-\u0026gt;trapframe-\u0026gt;epc = elf.entry; // è®¾ç½®åˆå§‹ç¨‹åºè®¡æ•°å™¨ä¸º ELF å…¥å£ç‚¹ p-\u0026gt;trapframe-\u0026gt;sp = sp; // è®¾ç½®åˆå§‹æ ˆæŒ‡é’ˆ proc_freepagetable(oldpagetable, oldsz); // é‡Šæ”¾æ—§çš„é¡µè¡¨ return argc; // è¿”å›å‚æ•°ä¸ªæ•°ï¼Œæ”¾å…¥ a0ï¼Œä½œä¸º main(argc, argv) çš„ç¬¬ä¸€ä¸ªå‚æ•° bad: // é”™è¯¯å¤„ç†éƒ¨åˆ† if(pagetable) proc_freepagetable(pagetable, sz); // é‡Šæ”¾å·²åˆ†é…çš„é¡µè¡¨ if(ip){ iunlockput(ip); // è§£é”å¹¶é‡Šæ”¾ inode end_op(); // ç»“æŸæ–‡ä»¶æ“ä½œ } return -1; // è¿”å› -1 è¡¨ç¤ºå¤±è´¥ } uvmalloc()\nloadseg()\n// å°†ç¨‹åºæ®µåŠ è½½åˆ°æŒ‡å®šçš„é¡µè¡¨ä¸­ï¼Œè™šæ‹Ÿåœ°å€ä¸º vaã€‚ // va å¿…é¡»æ˜¯é¡µå¯¹é½çš„ï¼Œä¸”ä» va åˆ° va+sz çš„é¡µå¿…é¡»å·²ç»æ˜ å°„ã€‚ // æˆåŠŸæ—¶è¿”å› 0ï¼Œå¤±è´¥æ—¶è¿”å› -1ã€‚ static int loadseg(pagetable_t pagetable, uint64 va, struct inode *ip, uint offset, uint sz) { uint i, n; // å¾ªç¯å˜é‡ i å’Œæ¯é¡µè¦è¯»å–çš„å­—èŠ‚æ•° n uint64 pa; // æ˜ å°„åˆ°çš„ç‰©ç†åœ°å€ // æ£€æŸ¥è™šæ‹Ÿåœ°å€æ˜¯å¦æ˜¯é¡µå¯¹é½çš„ if((va % PGSIZE) != 0) panic(\u0026#34;loadseg: va must be page aligned\u0026#34;); // éå†æ¯ä¸ªé¡µï¼Œä»è™šæ‹Ÿåœ°å€ va å¼€å§‹ï¼Œç›´åˆ°åŠ è½½çš„å¤§å° sz for(i = 0; i \u0026lt; sz; i += PGSIZE){ // è·å–å½“å‰è™šæ‹Ÿåœ°å€å¯¹åº”çš„ç‰©ç†åœ°å€ pa = walkaddr(pagetable, va + i); // å¦‚æœç‰©ç†åœ°å€ä¸º 0ï¼Œè¡¨ç¤ºå¯¹åº”çš„é¡µä¸å­˜åœ¨ï¼Œè§¦å‘ panic if(pa == 0) panic(\u0026#34;loadseg: address should exist\u0026#34;); // ç¡®å®šè¦è¯»å–çš„å­—èŠ‚æ•° if(sz - i \u0026lt; PGSIZE) n = sz - i; // å¦‚æœå‰©ä½™çš„å­—èŠ‚æ•°å°äºä¸€é¡µï¼Œåˆ™åªè¯»å–å‰©ä½™çš„å­—èŠ‚ else n = PGSIZE; // å¦åˆ™è¯»å–ä¸€æ•´é¡µ // ä» inode ä¸­è¯»å–æ•°æ®åˆ°ç‰©ç†å†…å­˜ä¸­ if(readi(ip, 0, (uint64)pa, offset+i, n) != n) return -1; // å¦‚æœè¯»å–çš„å­—èŠ‚æ•°ä¸ç­‰äº nï¼Œè¿”å› -1 è¡¨ç¤ºå¤±è´¥ } return 0; // æˆåŠŸåŠ è½½æ‰€æœ‰é¡µï¼Œè¿”å› 0 } print user page table for sh\nQ: what is entry 2?\na process calls sbrk(n) to ask for n more bytes of heap memory user/umalloc.c calls sbrk() to get memory for the allocator each process has a size kernel adds new memory at process\u0026rsquo;s end, increases size sbrk() allocates physical memory (RAM) maps it into the process\u0026rsquo;s page table returns the starting address of the new memory\ngrowproc() in proc.c // å¢åŠ æˆ–å‡å°‘ç”¨æˆ·å†…å­˜ n å­—èŠ‚ã€‚ // æˆåŠŸæ—¶è¿”å› 0ï¼Œå¤±è´¥æ—¶è¿”å› -1ã€‚ int growproc(int n) { uint sz; // å½“å‰è¿›ç¨‹çš„å†…å­˜å¤§å° struct proc *p = myproc(); // è·å–å½“å‰è¿›ç¨‹ç»“æ„ sz = p-\u0026gt;sz; // è·å–å½“å‰è¿›ç¨‹çš„å†…å­˜å¤§å° if(n \u0026gt; 0){ // å¦‚æœ n ä¸ºæ­£ï¼Œè¡¨ç¤ºå¢åŠ å†…å­˜ // å°è¯•åˆ†é…æ–°çš„å†…å­˜ç©ºé—´ if((sz = uvmalloc(p-\u0026gt;pagetable, sz, sz + n)) == 0) { // å¦‚æœå†…å­˜åˆ†é…å¤±è´¥ï¼Œè¿”å› -1 return -1; } } else if(n \u0026lt; 0){ // å¦‚æœ n ä¸ºè´Ÿï¼Œè¡¨ç¤ºå‡å°‘å†…å­˜ // å°è¯•é‡Šæ”¾å†…å­˜ sz = uvmdealloc(p-\u0026gt;pagetable, sz, sz + n); // æ³¨æ„ï¼šæ­¤å¤„æ²¡æœ‰æ£€æŸ¥ uvmdealloc çš„è¿”å›å€¼ï¼Œå‡è®¾å…¶æˆåŠŸ } p-\u0026gt;sz = sz; // æ›´æ–°å½“å‰è¿›ç¨‹çš„å†…å­˜å¤§å° return 0; // è¿”å› 0 è¡¨ç¤ºæˆåŠŸ } proc-\u0026gt;sz is the process\u0026rsquo;s current size uvmalloc() does most of the work when switching to user space satp will be loaded with updated page table\nuvmalloc() in vm.c // ä¸ºè¿›ç¨‹åˆ†é…é¡µè¡¨é¡¹å’Œç‰©ç†å†…å­˜ï¼Œå°†è¿›ç¨‹ä» oldsz æ‰©å±•åˆ° newszã€‚ // newsz ä¸éœ€è¦é¡µå¯¹é½ã€‚æˆåŠŸæ—¶è¿”å›æ–°å¤§å°ï¼Œå¤±è´¥æ—¶è¿”å› 0ã€‚ uint64 uvmalloc(pagetable_t pagetable, uint64 oldsz, uint64 newsz) { char *mem; // ç”¨äºå­˜å‚¨åˆ†é…çš„å†…å­˜æŒ‡é’ˆ uint64 a; // å¾ªç¯å˜é‡ï¼Œç”¨äºéå†åˆ†é…çš„å†…å­˜åœ°å€ // å¦‚æœæ–°çš„å¤§å°å°äºæ—§çš„å¤§å°ï¼Œç›´æ¥è¿”å›æ—§çš„å¤§å° if(newsz \u0026lt; oldsz) return oldsz; // å°†æ—§å¤§å°å‘ä¸Šå¯¹é½åˆ°ä¸‹ä¸€ä¸ªé¡µè¾¹ç•Œ oldsz = PGROUNDUP(oldsz); // ä»æ—§å¤§å°å¼€å§‹ï¼Œé€é¡µåˆ†é…å†…å­˜ç›´åˆ°æ–°çš„å¤§å° for(a = oldsz; a \u0026lt; newsz; a += PGSIZE){ // åˆ†é…ä¸€é¡µç‰©ç†å†…å­˜ mem = kalloc(); if(mem == 0){ // å¦‚æœå†…å­˜åˆ†é…å¤±è´¥ï¼Œé‡Šæ”¾å·²ç»åˆ†é…çš„å†…å­˜å¹¶è¿”å› 0 uvmdealloc(pagetable, a, oldsz); return 0; } // å°†åˆ†é…çš„å†…å­˜åˆå§‹åŒ–ä¸º 0 memset(mem, 0, PGSIZE); // å°†åˆ†é…çš„ç‰©ç†å†…å­˜æ˜ å°„åˆ°è¿›ç¨‹çš„è™šæ‹Ÿåœ°å€ç©ºé—´ if(mappages(pagetable, a, PGSIZE, (uint64)mem, PTE_W|PTE_X|PTE_R|PTE_U) != 0){ // å¦‚æœæ˜ å°„å¤±è´¥ï¼Œé‡Šæ”¾ç‰©ç†å†…å­˜å¹¶é‡Šæ”¾å·²åˆ†é…çš„å†…å­˜ kfree(mem); uvmdealloc(pagetable, a, oldsz); return 0; } } // å¦‚æœæ‰€æœ‰çš„å†…å­˜éƒ½æˆåŠŸåˆ†é…å’Œæ˜ å°„ï¼Œè¿”å›æ–°çš„å¤§å° return newsz; } why PGROUNDUP? arguments to mappages()\u0026hellip;\nLab: page tables Print a page table (easy) Define a function called vmprint(). It should take a pagetable_t argument, and print that pagetable in the format described below. Insert if(p-\u0026gt;pid==1) vmprint(p-\u0026gt;pagetable) in exec.c just before the return argc, to print the first process\u0026rsquo;s page table. You receive full credit for this assignment if you pass the pte printout test of make grade.\nvoid vmprint_rec(pagetable_t pagetable, int level) { for (int i = 0; i \u0026lt; 512; i++) { pte_t pte = pagetable[i]; if (pte \u0026amp; PTE_V) { uint64 pa = PTE2PA(pte); for (int j = 0; j \u0026lt;= level; j++) { if(j \u0026gt; 0){ printf(\u0026#34; \u0026#34;); } printf(\u0026#34;..\u0026#34;); } printf(\u0026#34;%d: pte %p pa %p\\n\u0026#34;, i, pte, pa); if ((pte \u0026amp; (PTE_R | PTE_W | PTE_X)) == 0) { // Recursively print next level page table vmprint_rec((pagetable_t)pa, level + 1); } } } } void vmprint(pagetable_t pagetable) { printf(\u0026#34;page table %p\\n\u0026#34;, pagetable); vmprint_rec(pagetable, 0); } pid = 1ä»£è¡¨initè¿›ç¨‹ï¼Œå³ç¬¬ä¸€ä¸ªå¯åŠ¨çš„ç”¨æˆ·çº§è¿›ç¨‹ï¼Œå®ƒè´Ÿè´£æ´¾ç”Ÿå…¶ä»–è¿›ç¨‹å¹¶ä¸ºç³»ç»Ÿæä¾›åŸºæœ¬æœåŠ¡ã€‚\nA kernel page table per process (hard) proc.h proc.c vm.c defs.h Simplify copyin/copyinstr (hard) defs.h vm.c Q \u0026amp; A ","permalink":"https://kennems.github.io/posts/tech/mit6.s0814-virtual-memory/","summary":"MIT6.S081(4)-Virtual Memory Plan: Address spaces Paging hardware xv6 VM code Virtual memory overview Today\u0026rsquo;s problem: [user/kernel diagram] [memory view: diagram with user processes and kernel in memory] Suppose the shell has a bug: sometimes it writes to a random memory address how can we keep it from wrecking the kernel? and from wrecking other processes? we want isolated address spaces each process has its own memory it can read and","title":"MIT6.S081(4)-Virtual Memory"},{"content":"è‚¡ç¥¨ è‚¡ç¥¨ï¼šè‚¡ç¥¨æ˜¯è‚¡ä»½å…¬å¸åœ¨ç­¹é›†èµ„æœ¬æ—¶å‘å‡ºèµ„äººå…¬å¼€æˆ–ç§ä¸‹å‘è¡Œçš„ã€ç”¨ä»¥è¯æ˜å‡ºèµ„äººçš„è‚¡æœ¬èº«ä»½å’ŒæƒåŠ›ï¼Œå¹¶æ ¹æ®æŒæœ‰äººæ‰€æŒæœ‰çš„è‚¡ä»½æ•°äº«æœ‰æƒç›Šå’Œæ‰¿æ‹…ä¹‰åŠ¡çš„å‡­è¯ã€‚\næ”¶ç›Š ï¼š å·®ä»·å’Œåˆ†çº¢\nè‚¡ç¥¨è½¯ä»¶ï¼›\nåŒèŠ±é¡º ä¸œæ–¹è´¢å¯Œ é€šè¾¾ä¿¡ æŒ‡å—é’ˆ è‚¡å¸‚äº¤æ˜“æ—¶é—´ï¼š å‘¨ä¸€åˆ°å‘¨äº” éèŠ‚å‡æ—¥ 9ï¼š30~11ï¼š30 13ï¼š00~15ï¼š00 äº¤æ˜“è´¹ç”¨ï¼šä½£é‡‘ å°èŠ±ç¨ è¿‡æˆ·è´¹ äº¤æ˜“è§„åˆ™ï¼š é›†åˆç«ä»·ï¼š9ï¼š15~9ï¼š25 æœ€å¤§æˆäº¤é‡çš„ä»·æ ¼ è¯¥å¦‚ä½•æŒ‚å• 9ï¼š15~9ï¼š20 å¯æ’¤å• 20ä¹‹åä¸èƒ½æ’¤å• è¿ç»­ç«ä»· ä»·æ ¼ä¼˜å…ˆï¼Œæ—¶é—´ä¼˜å…ˆ T+1äº¤æ˜“è§„åˆ™ï¼š å½“åœ°ä¹°è¿› å½“æ—¥ä¸èƒ½å–å‡º æ¬¡æ—¥æ‰èƒ½å–å‡º\nå˜ç›¸T+0ï¼ŒåšT\næ­£å‘T\n600/1 ä¸Šè¯ä¸»æ¿\n000 æ·±åœ³ä¸»æ¿\n300 åˆ›ä¸šæ¿\n688 ç§‘åˆ›æ¿\næ¢æ‰‹ç‡ è¡¨ç¤ºè‚¡å¸‚çš„æ´»è·ƒåº¦ï¼Œæ´»è·ƒçš„ä¸€èˆ¬åœ¨3~4%å·¦å³\næˆäº¤é‡: ä»£è¡¨äº†å¤šç©ºåŒæ–¹çœ‹æ³•çš„åˆ†æ­§ç¨‹åº¦\né‡ä»·é½å‡ï¼Œé‡å¢ä»·ç¨³ï¼Œé‡ç¼©ä»·æ¶¨ï¼ˆé‡ä»·èƒŒç¦»ï¼‰ç­‰ç­‰\nå‡çº¿MA è¶‹åŠ¿äº¤æ˜“æ³•\nè‚¡ç¥¨æŠ€æœ¯åˆ†æ æŠ€æœ¯åˆ†æ å’Œ åŸºæœ¬é¢åˆ†æ\nKçº¿åˆ†æ çº¢æ¶¨ç»¿è·Œ\nå¸¸ç”¨Kçº¿ï¼š å½¢æ€åˆ†æ ç”¨ä¸€è¿ä¸²çš„Kçº¿ç»„åˆåœ¨ä¸€èµ·å½¢æˆå„ç§ä¸åŒçš„å½¢æ€æˆ–è€…å½¢çŠ¶ï¼Œå¹¶åŠ ä»¥åˆ†æã€‚ åˆ‡çº¿åˆ†æ æŒ‡æ ‡åˆ†æ RSIï¼ˆRelative Strength Indexï¼Œç›¸å¯¹å¼ºå¼±æŒ‡æ•°ï¼‰æŒ‡æ ‡èƒ½å¤Ÿåæ˜ å¸‚åœºå¼ºå¼±ï¼Œæˆäº¤é‡èƒ½å¤Ÿåæ˜ å¸‚åœºèƒ½é‡ã€‚\nä»»ä½•æŠ€æœ¯æŒ‡æ ‡éƒ½æ˜¯å¯¹å½“å‰æˆ–è¿‡å»å¸‚åœºèµ°åŠ¿çš„æ»åç‰¹å¾ååº”\nå‡çº¿ç³»ç»Ÿ ç§»åŠ¨å¹³å‡çº¿æŒ‡æ ‡\nå‡çº¿ç³»ç»Ÿå°±æ˜¯è®¡ç®—è¿‡å»æŸä¸€æ®µæ—¶é—´çš„å¹³å‡æ”¶ç›˜ä»·ï¼Œç„¶åè¿æ¥èµ·æ¥\nå‡çº¿çš„æœ¬è´¨æ˜¯ååº”è¿‡å»ä¸€æ®µæ—¶é—´å¸‚åœºæ•´ä½“çš„æŒä»“æˆæœ¬ï¼Œæ˜¯å¾ˆé‡è¦çš„æ”¯æ’‘å’Œé˜»åŠ›æŒ‡æ ‡ é“æ°ç†è®º æ³¢æµªç†è®º æ±Ÿæ©ç†è®º æŠ€æœ¯åˆ†æçš„ä¸‰å¤§å‰ææ¡ä»¶å’Œå››ä¸ªåˆ†æè¦ç´  ä¸‰å¤§å‰æ 1ã€å¸‚åœºè¡Œä¸ºåŒ…å®¹å’Œæ¶ˆåŒ–ä¸€åˆ‡ä¿¡æ¯ è‚¡ä»·çš„æ³¢åŠ¨å’Œæ¶¨è·Œæ˜¯ä¸€åˆ‡å½±å“è‚¡ä»·çš„å› ç´ å’Œé›†ä¸­ä½“ç° è¿™äº›å› ç´ åŒ…æ‹¬å…¬å¸ç»è¥çŠ¶å†µï¼Œè¡Œä¸šç”šè‡³æ”¿æ²»ï¼Œå¿ƒç†ç­‰ å½±å“è‚¡ä»·å˜åŠ¨çš„æ ¹æœ¬åŸå› æ˜¯åŸºæœ¬é¢å› ç´  2ã€ä»·æ ¼ä»¥è¶‹åŠ¿çš„æ–¹å¼æ¼”å˜ è‚¡ä»·çš„è¶‹åŠ¿å˜åŒ–æ˜¯æŠ€æœ¯åˆ†æçš„æ ¸å¿ƒ\nä»·æ ¼æ³¢åŠ¨è¦ä¹ˆä¸Šæ¶¨è¶‹åŠ¿ï¼Œè¦ä¹ˆä¸‹è·Œè¶‹åŠ¿ï¼Œè¦ä¹ˆæ¨ªç›˜éœ‡è¡\næŠ€æœ¯åˆ†æçš„æ„ä¹‰åœ¨äºå°½æ—©åœ°åˆ¤æ–­å‡ºè¶‹åŠ¿è½¬æŠ˜ç‚¹ï¼Œä¹°è¿›å–å‡º\nè¶‹åŠ¿ä¸€æ—¦ç¡®ç«‹ï¼Œä¸ä¼šè½»æ˜“æ”¹å˜æˆ–è€…ç»ˆæ­¢\né€šè¿‡æŠ€æœ¯åˆ†æå·¥å…·æ‰¾åˆ°å¸‚åœºè¶‹åŠ¿ï¼Œç„¶åâ€œé¡ºåŠ¿è€Œä¸ºâ€\n3ã€å†å²ä¼šé‡æ¼” å„ç§â€œå›¾æ ‡â€ç»™å‡ºçš„æ¶¨è·Œä¿¡å·æ€»ä¼šä¸æ–­é‡æ¼”\nåŒæ ·çš„æŠ€æœ¯åˆ†æä¿¡å·ï¼Œè¿‡å»æœ‰æ•ˆï¼Œå°†æ¥ä¸€æ ·ä¼šæœ‰æ•ˆ\näººæ€§çš„è´ªå©ªå’Œææ…Œä¸å˜ï¼Œâ€œå†å²â€å°†ä¸æ–­é‡æ¼”\nâ€œå›¾æ ‡â€ç»™å‡ºçš„æŠ€æœ¯ä¿¡å·ä¸ä¼šå®Œå…¨é›·åŒï¼Œä½†ä¼šéå¸¸ç›¸ä¼¼\nä¸­å›½è‚¡å¸‚ä¸­ç›¸é‚»çš„ä¸¤ä¸ªé¡¶éƒ¨æˆ–ç›¸é‚»ä¸¤ä¸ªåº•éƒ¨ï¼Œå½¢æ€éå¸¸ç±»ä¼¼ï¼Œç›¸éš”æ—¶é—´è¶Šé•¿ï¼Œå½¢æ€å·®åˆ«è¶Šå¤§\nå››ä¸ªåˆ†æè¦ç´  ä»·æ ¼ ä»·æ ¼åº”è¯¥æ˜¯æˆ‘ä»¬ç ”ç©¶æŠ€æœ¯åˆ†æçš„é¦–è¦å› ç´  ä»·æ ¼æ˜¯æŒ‡è‚¡ç¥¨è¿‡å»å’Œå½“å‰çš„æˆäº¤ä»·ï¼Œå…·ä½“çš„è¿˜æœ‰å¼€ç›˜ä»·ï¼Œæ”¶ç›˜ä»·ï¼Œæœ€é«˜ä»·å’Œæœ€ä½ä»·ã€‚ æ”¶ç›˜ä»·æœ€é‡è¦ï¼š æ¯ä¸€å¤©æ—¥å†…ä»·æ ¼æ³¢åŠ¨æ˜¯å¸‚åœºæ‰€æœ‰å¤šç©ºåŒæ–¹çš„åšå¼ˆç»“æœï¼Œå®ƒç›´æ¥åæ˜ åœ¨å½“æ—¥æ”¶ç›˜ä»·ä¸Šã€‚ è‚¡ä»·è¿ç»­ä¸‰å¤©æ”¶ç›˜ä»·çªç ´é‡è¦å…³å£ï¼Œæ‰ç®—æ˜¯çœŸçš„çªç ´äº†ã€‚ æˆäº¤é‡ æˆäº¤é‡æ˜¯åæ˜ å¸‚åœºäººæ°”å’ŒåŠ¨åŠ›çš„æŒ‡æ ‡ï¼Œå’Œä»·æ ¼ä¹‹é—´å­˜åœ¨ä¸€å®šçš„æ¨ç†å…³ç³»\né‡ä»·é½å‡ï¼Œé‡ä»·èƒŒç¦»ï¼Œç¼©é‡ä¸Šæ¶¨ï¼Œæ”¾é‡ä¸‹è·Œ\nä¸Šæ¶¨éœ€è¦æ”¾é‡ï¼Œå¦åˆ™æŒä¹…ä¸äº†ï¼›ä¸‹è·Œåˆ™ä¸éœ€è¦ï¼Œ å¯ä»¥ç¼©é‡ä¸‹è·Œ\né€šå¸¸å…ˆçœ‹åˆ°æˆäº¤é‡çš„å˜åŒ–ï¼Œç„¶åå†çœ‹åˆ°ä»·æ ¼çš„å˜åŠ¨\næ—¶é—´ æ—¶é—´æŒ‡çš„æ˜¯æ—¶é—´å‘¨æœŸ\nç‰›å¸‚å’Œç†Šå¸‚æ˜¯å­˜åœ¨å‘¨æœŸæ€§çš„äº¤æ›¿\nè‚¡ä»·å­˜åœ¨å‘¨æœŸæ€§å˜åŒ–ï¼Œå› ä¸ºè‚¡ä»·ååº”ç»æµï¼Œç»æµæœ¬èº«æ˜¯å­˜åœ¨å‘¨æœŸæ€§\næŒ‰å‘¨æœŸKçº¿å›¾å¯åˆ†ä¸ºæ—¥çº¿ï¼Œå‘¨çº¿ï¼Œæœˆçº¿ï¼Œ10åˆ†é’Ÿï¼Œ30åˆ†é’Ÿï¼Œå°æ—¶å›¾ç­‰\nç ”ç©¶æ—¶é—´çš„ç›®çš„åœ¨äºå¯»æ‰¾å¸‚åœºçš„è¶‹åŠ¿è½¬æŠ˜ç‚¹\næ±Ÿæ©è®¤ä¸ºæ—¶é—´æ‰æ˜¯å¸‚åœºå…è®¸çš„æœ€é‡è¦å› ç´ ï¼Œç”šè‡³è¶…è¿‡ä»·æ ¼\nç©ºé—´ ç©ºé—´å°±æ˜¯è‚¡ä»·ä¸Šä¸‹æ³¢åŠ¨èŒƒå›´ é¢„æµ‹ä»·æ ¼å°±æ˜¯é¢„æµ‹è‚¡ä»·æ³¢åŠ¨çš„æ—¶é—´èŒƒå›´ï¼Œè¦ç²¾ç¡®é¢„æµ‹å¾ˆéš¾ ä»¥æ—¶é—´æ¢ç©ºé—´æ˜¯æŒ‡è‚¡ä»·ä¸Šçš„ç©ºé—´å’Œæ—¶é—´ç›¸äº’è½¬åŒ– å•æ ¹Kçº¿åˆ†æä»¥åŠæ“ä½œæ„ä¹‰ å¤§é˜³çº¿ å…‰å¤´å…‰è„šå¤§é˜³çº¿è¯´æ˜å½“å¤©çš„å¼€ç›˜ä»·å°±æ˜¯æœ€ä½ä»·ï¼Œæ”¶ç›˜ä»·å°±æ˜¯æœ€é«˜ä»·ï¼Œåå¸‚ç»§ç»­çœ‹å¥½\nå¤§é˜´çº¿è¯´æ˜å½“å¤©å‡ ä¹æœ€é«˜ç‚¹å¼€ç›˜ï¼Œç„¶åæœ€ä½ç‚¹æ”¶ç›˜ï¼Œè¯´æ˜ç©ºæ–¹åŠ›é‡æ˜æ˜¾å ä¼˜\nå°é˜³çº¿è¡¨ç¤ºä¸Šæ¶¨å¹…åº¦ä¸å¤§ï¼Œå¤šæ–¹ç•¥å¾®å ä¼˜\nå°é˜´çº¿æ„å‘³ç€è·Œå¹…ä¸å¤§ï¼Œç©ºå¤´ç¨å¾®å ä¼˜\nä¸€èˆ¬å‡ºç°åœ¨å¤šç©ºåŠ›é‡ç›¸å½“çš„æƒ…å†µï¼Œå¦‚éœ‡è¡å¸‚è¡Œæƒ…\nä¸­é˜´çº¿å’Œä¸­é˜³çº¿ï¼šæ¯”å°é˜³çº¿å’Œå°é˜´çº¿å®ä½“æ›´å¤§ä¸€ç‚¹çš„å°±æ˜¯ä¸­é˜³çº¿å’Œä¸­é˜´çº¿\nä¸€èˆ¬æ¶¨è·Œå¹…åº¦å°äº$3%$è¢«ç§°ä¸ºå°é˜³çº¿å’Œå°é˜´çº¿ï¼›è¶…è¿‡$3%$å°äº$6%$è¢«ç§°ä¹‹ä¸ºä¸­é˜³çº¿å’Œä¸­é˜´çº¿\nè¶…è¿‡$6%$å°±æ˜¯å¤§é˜³çº¿å’Œå¤§é˜´çº¿\né•¿å½±Kçº¿\né•¿ä¸Šå½±Kçº¿è¯´æ˜å½“å¤©å¤šæ–¹ä¸€åº¦å ä¼˜è¾ƒå¤§ï¼Œä½†å› ç©ºæ–¹æ‰“å‹æˆ–åˆ©ç©ºæ¶ˆæ¯è€Œåœ¨å°¾ç›˜æœ‰æ‰€å›è½\né•¿ä¸Šå½±Kçº¿æŠ€æœ¯ä¿¡å·ä¸æ˜ç¡®ï¼Œåå¸‚ä¸ä¸€å®šçœ‹è·Œ\né•¿ä¸Šå½±Kçº¿åœ¨ç‰¹å®šé˜¶æ®µè¢«ç§°ä¸ºâ€œä»™äººæŒ‡è·¯â€\nä¸‹å½±çº¿è¶Šé•¿ï¼Œä¸‹æ–¹æ”¯æŒè¶Šå¼ºï¼›ä¸Šå½±çº¿è¶Šé•¿ï¼Œä¸Šæ–¹é˜»åŠ›è¶Šå¤§\nè¿ç»­å‡ å¤©å‡ºç°é•¿ä¸‹å½±Kçº¿ï¼Œæ˜¯çœ‹å¤šä¿¡å·ï¼Œåå¸‚æ›´åŠ çœ‹å¥½\né«˜ä½çš„é•¿ä¸‹å½±Kçº¿æ›´å¯èƒ½æ˜¯ç©ºå¤´è¯•æ¢çš„æ‰“å‹è¡Œä¸º\nåå­—æ˜Ÿï¼š\né«˜ä½å’Œä½ä½åå­—æ˜Ÿéƒ½æ˜¯è¡Œæƒ…é€†è½¬çš„ä¿¡å· è¡Œæƒ…ä¸­é€”å‡ºç°çš„åå­—æ˜Ÿä¸€èˆ¬æ˜¯è°ƒæ•´æˆ–åå¼¹ç»“æŸçš„ä¿¡å· éœ‡è¡è¡Œæƒ…ä¸­å‡ºç°åå­—æ˜Ÿå°±æ˜¯è¦çªç ´éœ‡è¡å¸‚çš„ä¿¡å· Tå­—å½¢å’Œå€’Tå½¢\nTå­—å½¢Kçº¿å¯¹åå¸‚å¤šæ–¹æœ‰åˆ© Tå­—å½¢Kçº¿å‡ºç°åœ¨è‚¡ä»·çš„ç›¸å¯¹ä½ä½ï¼Œæ˜¯æ˜æ˜¾çš„çœ‹å¤šä¿¡å· å€’Tå½¢Kçº¿è¯´æ˜è‚¡ä»·å†²é«˜å›è½ï¼Œæ”¶ç›˜ä»·å’Œå¼€ç›˜ä»·ä¸€æ ·ï¼Œæ˜¯æ˜æ˜¾çš„çœ‹ç©ºä¿¡å· ä¸€å­—å‹ï¼š\nä¸€å­—æ¶¨åœæ˜¯çªç„¶å‡ºç°åˆ©å¥½æ¶ˆæ¯ï¼Œä¹°ä¹Ÿä¹°ä¸åˆ°ï¼›ä¸€å­—è·Œåœæ˜¯çªç„¶å‡ºç°åˆ©ç©ºæ¶ˆæ¯ï¼Œå–ä¹Ÿå–ä¸æ‰ å¸¸ç”¨ã€é‡è¦çš„Kçº¿ç»„åˆ ä¸‰é˜³å¼€æ³° è¿ç»­å‡ºç°ä¸‰æ ¹ä¸­é˜³æˆ–å¤§é˜³çº¿ï¼Œè‚¡ä»·åœ¨çŸ­æ—¶é—´å†…å¿«è¯»çˆ†å‘ä¸Šæ¶¨ï¼Œå‘ˆç°åŠ é€Ÿä¸Šæ¶¨æ€åŠ¿ è‚¡ä»·è¿ç»­ä¸‰å¤©å¤§æ¶¨ï¼Œè‚¡ä»·ä¸Šæ¶¨åŠ¨åŠ›å¾ˆå¤§ï¼Œæ˜¯å¼ºçƒˆçš„çœ‹å¤šä¿¡å· ä¸‹è·Œè¶‹åŠ¿ç»“æŸï¼Œä¸Šå‡è¶‹åŠ¿å¼€å§‹ ä¸‰ä¸ªç™½æ­¦å£« Kçº¿æ”¶ç›˜ä»·ä¸€å¤©æ¯”ä¸€å¤©é«˜ æ¯å¤©çš„å¼€ç›˜ä»·åœ¨æ˜¨å¤©é˜³çº¿çš„å®ä½“ä¹‹å†… ä¸‰æ ¹é˜³çº¿çš„ä¸Šä¸‹å½±çº¿æ¯”è¾ƒçŸ­ï¼Œæ”¶ç›˜ä»·å‡ ä¹æ˜¯å½“å¤©æœ€é«˜ä»· é€šå¸¸å‡ºç°åœ¨è§åº•å›å‡çš„åˆæœŸ ä¸‰ä¸ªç™½æ­¦å£«çš„ä¸‰æ ¹é˜³çº¿å¾ˆå¤§éƒ¨åˆ†æ˜¯é‡å åœ¨ä¸€èµ·çš„ ä¸‰åªä¹Œé¸¦ ä¸‰åªä¹Œé¸¦æŒ‡è¿ç»­å‡ºç°ä¸‰æ ¹ä¸­é˜´çº¿æˆ–è€…å¤§é˜´çº¿ ä¸‰åªä¹Œé¸¦æ˜¯å¼ºçƒˆçš„çœ‹ç©ºä¿¡å· å®¹æ˜“å‡ºç°åœ¨å¸‚åœºå¤´éƒ¨æˆ–è€…é«˜ä½ï¼Œå°¤å…¶æ˜¯ä»ç‰›è½¬ç†Šçš„è¿‡ç¨‹ å‡ºæ°´èŠ™è“‰ å‡ºæ°´èŠ™è“‰æ˜¯Kçº¿å’Œå‡çº¿ç»„åˆçš„æŠ€æœ¯å›¾å½¢\nè‚¡ä»·ç»è¿‡ä¸€æ®µæ—¶é—´çš„æ¨ªç›˜æ•´ç† å‡ä»·ç³»ç»Ÿæœ€åä¹Ÿç²˜åˆåœ¨ä¸€èµ· ä¸€æ ¹å¤§é˜³çº¿æ”¾é‡çªç ´æ‰€æœ‰çš„å‡çº¿ç³»ç»Ÿ ä¸Šæ¶¨è¡Œæƒ…å°±æ­¤å±•å¼€ æ–­å¤´é“¡åˆ€ æ–­å¤´é“¡åˆ€å’Œå‡ºæ°´èŠ™è“‰ç›¸åï¼Œæ˜¯é«˜ä½æ”¾é‡é˜´çº¿è·Œç ´å‡çº¿ç³»ç»Ÿ æ–­å¤´é“¡åˆ€å®¹æ˜“å‡ºç°åœ¨å¸‚åœºå¤´éƒ¨å’Œé«˜ä½æ¨ªç›˜ å¦‚æœä¸‰å¤©ä¹‹å†…ä¸èƒ½æ”¶å¤è¿™æ ¹å¤§é˜´çº¿ï¼Œæœ€å¥½å–å‡ºï¼Œå› ä¸ºåå¼¹ä¹‹åæ˜¯æ›´å¤§çš„ä¸‹è·Œ æ—­æ—¥ä¸œå‡ å­•è‚²çº¿ å­•è‚²çº¿é¢„ç¤ºç€ä¸Šæ¶¨æˆ–è€…ä¸‹è·ŒåŠ›é‡å·²ç»è¡°ç«­ï¼Œè‚¡ä»·å³å°†è¦è½¬åŠ¿ å­•è‚²çº¿å¯¹è¶‹åŠ¿è½¬æŠ˜çš„ä¿¡å·å¹¶ä¸å¼ºçƒˆï¼Œè¿˜éœ€é€šè¿‡å…¶ä»–æŠ€æœ¯æŒ‡æ ‡æ¥ç¡®è®¤ ä¹Œäº‘ç›–é¡¶ å¤„åœ¨ä¸Šæ¶¨è¡Œæƒ… å‡ºç°ä¸€æ ¹ä¸­é˜³çº¿æˆ–è€…å¤§é˜³çº¿ä¹‹å ç¬¬äºŒå¤©æ”¶åˆ°ä¸€æ ¹ä¸­é˜´çº¿æˆ–å¤§é˜´çº¿ï¼Œå½¢æˆé˜´ç›–é˜³èµ°åŠ¿ æ˜¯ç»å…¸çš„çœ‹ç©ºKçº¿ç»„åˆï¼Œé¢„ç¤ºç€ç©ºå¤´çš„çŒ›çƒˆåå‡» å¤šæ–¹ç‚®å’Œç©ºæ–¹ç‚® å¤šæ–¹ç‚®\nå¤šæ–¹ç‚®æŒ‡çš„æ˜¯åº•éƒ¨åå¤ç›˜æ•´ï¼Œå…·æœ‰ç­‘åº•åŠŸèƒ½ï¼Œä»¥å¤¯å®åº•éƒ¨ ä¸Šæ¶¨è¡Œæƒ…ä¸­é€”ä¹Ÿå¯èƒ½å‡ºç°ï¼Œæ˜¯å¤šæ–¹ä¸ºäº†ç»§ç»­å‘ä¸Šå‘åŠ¨è¡Œæƒ…è¿›è¡Œä¸­é€”éœ‡è¡æ´—ç›˜ æ˜¯è¾ƒå¼ºçš„çœ‹æ¶¨ä¿¡å· ç©ºæ–¹ç‚®\nç©ºæ–¹ç‚®çš„å‡ºç°æ˜¾ç¤ºç©ºå¤´åŠ›é‡è¶Šæ¥è¶Šå¼ºï¼Œè€Œä¸”åšå†³ä¸é€€è®©ï¼Œåå¸‚ä¸çœ‹å¥½ æ—©æ™¨ä¹‹æ˜Ÿ ç¬¬ä¸€å¤© ï¼š ä¸€æ ¹å¤§é˜´çº¿ ç¬¬äºŒå¤©ï¼šè·³ç©ºä¸‹è¡Œçš„å°é˜´çº¿æˆ–å°é˜³çº¿ ç¬¬ä¸‰å¤©ï¼šä¸€æ ¹å¤§é˜³çº¿ï¼Œè‚¡ä»·æ”¶å¤ç¬¬ä¸€å¤©çš„å¤§éƒ¨åˆ†å¤±åœ° é»„æ˜ä¹‹æ˜Ÿ ä»·æ ¼å½¢æ€çš„åŸºæœ¬æ“ä½œè¦é¢† ä»·æ ¼å½¢æ€æ˜¯æŒ‡è‚¡ä»·åœ¨ä¸€æ®µæ—¶é—´å†…å½¢æˆçš„å„ç§â€å‡ ä½•å›¾å½¢â€œ\nä»·æ ¼å½¢æ€ä¹Ÿè¢«ç§°ä¸ºæŠ€æœ¯å½¢æ€\nä»·æ ¼å½¢æ€æ˜¯ç»éªŒæ€»ç»“ï¼Œä¸æ–­é‡å¤å‡ºç°ï¼Œè€Œä¸”æœ‰è§„å¾‹ï¼Œåœ¨æ“ä½œæ–¹é¢å…·æœ‰æŒ‡å¯¼æ„ä¹‰\nåè½¬å½¢æ€ å¤´è‚©é¡¶å½¢æ€ å¤´è‚©åº• åŒé‡é¡¶ åŒé‡åº• ä¸‰é‡é¡¶ å¤šå‡ºç°åœ¨å¤šå¤´è¡Œæƒ…çš„æœ«ç«¯ å‘¨çº¿å›¾ä¸­å°±å®¹æ˜“å‡ºç°ä¸‰é‡é¡¶ å‘ä¸‹è·Œç ´é¢ˆçº¿ä½ç½®åçš„è°ƒæ•´æ—¶é—´æ¯”è¾ƒé•¿ ä¸‰é‡åº• V å‹åè½¬ è‚¡ä»·èµ°åŠ¿å‘ˆç°å‡ºVå­—å½¢æˆ–å€’Vï¼Œæ‰€ä»¥ä¹Ÿè¢«ç§°ä¸ºå°–é¡¶æˆ–è€…å°–åº•\nå¿…è¦æ¡ä»¶æ˜¯å¸‚åœºå‡ºç°çŒ›çƒˆçš„ä¸Šæ¶¨æˆ–ä¸‹è·Œï¼Œä¸Šæ¶¨æˆ–è€…ä¸‹è·Œçš„ç©ºé—´è¶³å¤Ÿå¤§\nåœ†å¼§é¡¶ åœ†å¼§é¡¶çš„æˆäº¤é‡ä¸å¤ªè§„åˆ™ åœ†å¼§å·¦ä¾§æˆäº¤é‡æ˜æ˜¾å¤§äºå³ä¾§æ—¶ï¼Œåœ†é¡¶å½¢æˆæ¦‚ç‡å¾ˆé«˜ã€‚ è·Œç ´é¢ˆçº¿ä½ç½®$3%$æ—¶ï¼Œå°±éœ€è¦å–å‡ºè‚¡ç¥¨æˆ–è€…åšç©ºæ“ä½œ åœ†å¼§åº• æ•´ç†ï¼ˆæŒç»­ï¼‰å½¢æ€ ä¸‰è§’å½¢å½¢æ€ ä¸Šå‡å’Œä¸‹é™ä¸‰è§’å½¢ æŒ‰ç…§æ¦‚ç‡ï¼Œä¸‰è§’å½¢å½¢æ€å¤§å¤šæ•°æ˜¯è‚¡ä»·çš„ä¸­é€”æ•´ç† æ‰©æ•£ä¸‰è§’å½¢ æ——å½¢å’Œä¸‰è§’æ——å½¢å½¢æ€ çŸ©å½¢å½¢æ€ è¶‹åŠ¿å’Œè¶‹åŠ¿çº¿ ","permalink":"https://kennems.github.io/posts/read/%E8%82%A1%E7%A5%A8/","summary":"è‚¡ç¥¨ è‚¡ç¥¨ï¼šè‚¡ç¥¨æ˜¯è‚¡ä»½å…¬å¸åœ¨ç­¹é›†èµ„æœ¬æ—¶å‘å‡ºèµ„äººå…¬å¼€æˆ–ç§ä¸‹å‘è¡Œçš„ã€ç”¨ä»¥è¯æ˜å‡ºèµ„äººçš„è‚¡æœ¬èº«ä»½å’ŒæƒåŠ›ï¼Œå¹¶æ ¹æ®æŒæœ‰äººæ‰€æŒæœ‰çš„è‚¡ä»½æ•°äº«æœ‰æƒç›Šå’Œæ‰¿æ‹…ä¹‰åŠ¡çš„","title":"è‚¡ç¥¨"},{"content":"MIT6.S081(1)-O/S overview Class Page Overview 6.S081 goals Understand operating system (O/S) design and implementation Hands-on experience extending a small O/S Hands-on experience writing systems software What is the purpose of an O/S? Abstract the hardware for convenience and portability Multiplex the hardware among many applications Isolate applications in order to contain bugs Allow sharing among cooperating applications Control sharing for security Don\u0026rsquo;t get in the way of high performance Support a wide range of applications Organization: layered picture user applications: vi, gcc, DB, \u0026amp;c kernel services h/w: CPU, RAM, disk, net, \u0026amp;c we care a lot about the interfaces and internal kernel structure What services does an O/S kernel typically provide? process (a running program) memory allocation file contents file names, directories access control (security) many others: users, IPCï¼ˆInter-Process Communicationï¼‰, network, time, terminals What\u0026rsquo;s the application / kernel interface? \u0026ldquo;System calls\u0026rdquo;\nExamples, in C, from UNIX (e.g. Linux, macOS, FreeBSD):\nfd = open(\u0026#34;out\u0026#34;, 1); write(fd, \u0026#34;hello\\n\u0026#34;, 6); pid = fork(); These look like function calls but they aren\u0026rsquo;t\nSystem Calls å‡½æ•°å åŠŸèƒ½æè¿° int fork() åˆ›å»ºä¸€ä¸ªè¿›ç¨‹ï¼Œè¿”å›å­è¿›ç¨‹çš„ PIDã€‚ int exit(int status) ç»ˆæ­¢å½“å‰è¿›ç¨‹ï¼Œstatus è¿”å›ç»™ wait()ï¼Œä¸è¿”å›ã€‚ int wait(int *status) ç­‰å¾…å­è¿›ç¨‹é€€å‡ºï¼Œé€€å‡ºçŠ¶æ€å­˜å…¥ *statusï¼Œè¿”å›å­è¿›ç¨‹çš„ PIDã€‚ int kill(int pid) ç»ˆæ­¢è¿›ç¨‹ PIDã€‚è¿”å› 0 æˆ– -1ï¼ˆè¡¨ç¤ºé”™è¯¯ï¼‰ã€‚ int getpid() è¿”å›å½“å‰è¿›ç¨‹çš„ PIDã€‚ int sleep(int n) æš‚åœ n ä¸ªæ—¶é’Ÿå‘¨æœŸã€‚ int exec(char *file, char *argv[]) åŠ è½½å¹¶æ‰§è¡Œæ–‡ä»¶ fileï¼Œä¼ å…¥å‚æ•° argv[]ï¼Œä»…åœ¨å‘ç”Ÿé”™è¯¯æ—¶è¿”å›ã€‚ char *sbrk(int n) å¢åŠ  n å­—èŠ‚çš„è¿›ç¨‹å†…å­˜ï¼Œè¿”å›æ–°å†…å­˜çš„èµ·å§‹åœ°å€ã€‚ int open(char *file, int flags) æ‰“å¼€æ–‡ä»¶ï¼Œflags æŒ‡ç¤ºè¯»/å†™æ¨¡å¼ï¼Œè¿”å›æ–‡ä»¶æè¿°ç¬¦ã€‚ int write(int fd, char *buf, int n) ä» buf ä¸­å‘æ–‡ä»¶æè¿°ç¬¦ fd å†™å…¥ n å­—èŠ‚ï¼Œè¿”å›å†™å…¥çš„å­—èŠ‚æ•°ã€‚ int read(int fd, char *buf, int n) ä»æ–‡ä»¶æè¿°ç¬¦ fd ä¸­è¯»å– n å­—èŠ‚åˆ° bufï¼Œè¿”å›è¯»å–çš„å­—èŠ‚æ•°æˆ– 0ï¼ˆæ–‡ä»¶ç»“æŸï¼‰ã€‚ int close(int fd) å…³é—­æ–‡ä»¶æè¿°ç¬¦ fdã€‚ int dup(int fd) è¿”å›ä¸€ä¸ªæ–°çš„æ–‡ä»¶æè¿°ç¬¦ï¼ŒæŒ‡å‘ä¸ fd ç›¸åŒçš„æ–‡ä»¶ã€‚ int pipe(int p[]) åˆ›å»ºä¸€ä¸ªç®¡é“ï¼Œå°†è¯»/å†™æ–‡ä»¶æè¿°ç¬¦æ”¾å…¥ p[0] å’Œ p[1]ã€‚ int chdir(char *dir) æ›´æ”¹å½“å‰ç›®å½•ä¸º dirã€‚ int mkdir(char *dir) åˆ›å»ºä¸€ä¸ªæ–°ç›®å½• dirã€‚ int mknod(char *file, int, int) åˆ›å»ºä¸€ä¸ªè®¾å¤‡æ–‡ä»¶ã€‚ int fstat(int fd, struct stat *st) å°†å…³äºæ‰“å¼€æ–‡ä»¶çš„ä¿¡æ¯æ”¾å…¥ *stã€‚ int stat(char *file, struct stat *st) å°†å…³äºæ–‡ä»¶ file çš„ä¿¡æ¯æ”¾å…¥ *stã€‚ int link(char *file1, char *file2) ä¸ºæ–‡ä»¶ file1 åˆ›å»ºå¦ä¸€ä¸ªåç§° file2ã€‚ int unlink(char *file) åˆ é™¤æ–‡ä»¶ fileã€‚ Why is O/S design + implementation hard and interesting? unforgiving environment: quirky h/w, hard to debug\nmany design tensions:\nefficient vs abstract / portable / general-purpose powerful vs simple interfaces flexible vs secure features interact: fd = open(); fork()\nuses are varied: laptops, smart-phones, cloud, virtual machines, embedded\nevolving hardware: NVRAM, multi-core, fast networks\nYou\u0026rsquo;ll be glad you took this course if you\u0026hellip;\ncare about what goes on under the hood like infrastructure need to track down bugs or security problems care about high performance Class structure Online course information: https://pdos.csail.mit.edu/6.S081/2020 \u0026ndash; schedule, assignments, labs Piazza \u0026ndash; announcements, discussion, lab help\nLectures\nO/S ideas case study of xv6, a small O/S, via code and xv6 book lab background O/S papers submit a question about each reading, before lecture. Labs: The point: hands-on experience Mostly one week each. Three kinds: Systems programming (due next week\u0026hellip;) O/S primitives, e.g. thread switching. O/S kernel extensions to xv6, e.g. network. Use piazza to ask/answer lab questions. Discussion is great, but please do not look at others\u0026rsquo; solutions!\nGrading: 70% labs, based on tests (the same tests you run). 20% lab check-off meetings: we\u0026rsquo;ll ask you about randomly-selected labs. 10% home-work and class/piazza discussion. No exams, no quizzes. Note that most of the grade is from labs. Start them early!\nIntroduction to UNIX system calls I\u0026rsquo;ll show some examples, and run them on xv6. xv6 has similar structure to UNIX systems such as Linux. but much simpler \u0026ndash; you\u0026rsquo;ll be able to digest all of xv6 accompanying book explains how xv6 works, and why Why UNIX? open source, well documented, clean design, widely used studying xv6 will help if you ever need to look inside Linux xv6 has two roles in 6.S081: example of core functions: virtual memory, multi-core, interrupts, \u0026amp;c starting point for most of the labs xv6 runs on RISC-V, as in current 6.004 you\u0026rsquo;ll run xv6 under the qemu machine emulator\nExample: copy.c, copy input to output read bytes from input, write them to the output\n$ copy copy.c is written in C Kernighan and Ritchie (K\u0026amp;R) book is good for learning C you can find these example programs via the schedule on the web site\ncopy.c // copy.c: å¤åˆ¶è¾“å…¥åˆ°è¾“å‡º #include \u0026#34;kernel/types.h\u0026#34; // åŒ…å«ç³»ç»Ÿè°ƒç”¨ç›¸å…³çš„ç±»å‹å®šä¹‰ #include \u0026#34;user/user.h\u0026#34; // åŒ…å«ç”¨æˆ·æ€å‡½æ•°çš„å£°æ˜ï¼ˆå¦‚ read, write, exitï¼‰ int main() { char buf[64]; // å®šä¹‰ä¸€ä¸ªç¼“å†²åŒºï¼Œç”¨äºå­˜å‚¨è¯»å–çš„æ•°æ® // æ— é™å¾ªç¯ï¼Œç›´åˆ°è¯»å–åˆ°æ–‡ä»¶ç»“æŸæ ‡å¿—æˆ–å‡ºç°é”™è¯¯ while(1){ // ä»æ ‡å‡†è¾“å…¥ï¼ˆæ–‡ä»¶æè¿°ç¬¦ 0ï¼‰ä¸­è¯»å–æ•°æ®åˆ° buf ä¸­ int n = read(0, buf, sizeof(buf)); // å¦‚æœè¯»å–åˆ°çš„æ•°æ®é‡å°äºç­‰äº 0ï¼Œåˆ™è¡¨ç¤ºè¾“å…¥ç»“æŸæˆ–å‘ç”Ÿäº†é”™è¯¯ if(n \u0026lt;= 0) break; // é€€å‡ºå¾ªç¯ // å°†è¯»å–çš„æ•°æ®å†™å…¥æ ‡å‡†è¾“å‡ºï¼ˆæ–‡ä»¶æè¿°ç¬¦ 1ï¼‰ write(1, buf, n); } // æ­£å¸¸é€€å‡ºç¨‹åº exit(0); } read() and write() are system calls first read()/write() argument is a \u0026quot;file descriptor\u0026quot; (fd) passed to kernel to tell it which \u0026ldquo;open file\u0026rdquo; to read/write must previously have been opened\nan FD connects to a file/device/socket/\u0026amp;c a process can open many files, have many FDs\nUNIX convention: fd 0 is \u0026ldquo;standard input\u0026rdquo;, 1 is \u0026ldquo;standard output\u0026rdquo;\nsecond read() argument is a pointer to some memory into which to read\nthird argument is the maximum number of bytes to read read() may read less, but not more return value: number of bytes actually read, or -1 for error\nnote: copy.c does not care about the format of the data UNIX I/O is 8-bit bytes interpretation is application-specific, e.g. database records, C source, \u0026amp;c\nWhere do file descriptors come from? example: open.c, create a file\n$ open $ cat output.txt open() creates a file, returns a file descriptor (or -1 for error) FD is a small integer FD indexes into a per-process table maintained by kernel [user/kernel diagram] different processes have different FD name-spaces i.e. FD 1 often means different things to different processes these examples ignore errors \u0026ndash; don\u0026rsquo;t be this sloppy! Figure 1.2 in the xv6 book lists system call arguments/return or look at UNIX man pages, e.g. \u0026ldquo;man 2 open\u0026rdquo;\nWhat happens when a program calls a system call like open()? looks like a function call, but it\u0026rsquo;s actually a special instruction hardware saves some user registers hardware increases privilege level hardware jumps to a known \u0026ldquo;entry point\u0026rdquo; in the kernel now running C code in the kernel kernel calls system call implementation open() looks up name in file system it might wait for the disk it updates kernel data structures (cache, FD table) restore user registers reduce privilege level jump back to calling point in the program, which resumes we\u0026rsquo;ll see more detail later in the course\nI\u0026rsquo;ve been typing to UNIX\u0026rsquo;s command-line interface, the shell. the shell prints the \u0026ldquo;$\u0026rdquo; prompts. the shell lets you run UNIX command-line utilities useful for system management, messing with files, development, scripting\n$ ls $ ls \u0026gt; out $ grep x \u0026lt; out UNIX supports other styles of interaction too window systems, GUIs, servers, routers, \u0026amp;c. but time-sharing via the shell was the original focus of UNIX. we can exercise many system calls via the shell.\nexample: fork.c, create a new process\nâ€‹\tthe shell creates a new process for each command you type, e.g. for\n$ echo hello the fork() system call creates a new process\n$ fork the kernel makes a copy of the calling process instructions, data, registers, file descriptors, current directory \u0026ldquo;parent\u0026rdquo; and \u0026ldquo;child\u0026rdquo; processes only difference: fork() returns a pid in parent, 0 in child a pid (process ID) is an integer, kernel gives each process a different pid thus: fork.c\u0026rsquo;s \u0026ldquo;fork() returned\u0026rdquo; executes in both processes the \u0026ldquo;if(pid == 0)\u0026rdquo; allows code to distinguish ok, fork lets us create a new process how can we run a program in that process?\nexample: exec.c, replace calling process with an executable file how does the shell run a program, e.g.\n$ echo a b c a program is stored in a file: instructions and initial memory created by the compiler and linker so there\u0026rsquo;s a file called echo, containing instructions\n$ exec exec() replaces current process with an executable file discards instruction and data memory loads instructions and memory from the file preserves file descriptors exec(filename, argument-array) argument-array holds command-line arguments; exec passes to main() cat user/echo.c echo.c shows how a program looks at its command-line arguments\nexample: forkexec.c, fork() a new process, exec() a program\n$ forkexec forkexec.c contains a common UNIX idiom: fork() : a child process exec() : a command in the child parent wait()s for child to finish the shell does fork/exec/wait for every command you type after wait(), the shell prints the next prompt to run in the background \u0026ndash; \u0026amp; \u0026ndash; the shell skips the wait() exit(status) -\u0026gt; wait(\u0026amp;status) status convention: 0 = success, 1 = command encountered an error note: the fork() copies, but exec() discards the copied memory this may seem wasteful you\u0026rsquo;ll transparently eliminate the copy in the \u0026ldquo;copy-on-write\u0026rdquo; lab\nfork å’Œ exec çš„åŒºåˆ« fork ç”¨äºåˆ›å»ºæ–°è¿›ç¨‹ï¼Œçˆ¶å­è¿›ç¨‹å¹¶å‘æ‰§è¡Œã€‚\nexec ç”¨äºåœ¨ç°æœ‰è¿›ç¨‹ä¸­åŠ è½½å¹¶è¿è¡Œæ–°ç¨‹åºã€‚\nfork ç³»ç»Ÿè°ƒç”¨ åŠŸèƒ½ï¼šfork ç”¨äºåˆ›å»ºä¸€ä¸ªæ–°è¿›ç¨‹ï¼Œç§°ä¸ºå­è¿›ç¨‹ã€‚å­è¿›ç¨‹æ˜¯é€šè¿‡å¤åˆ¶å½“å‰è¿›ç¨‹ï¼ˆçˆ¶è¿›ç¨‹ï¼‰çš„åœ°å€ç©ºé—´åˆ›å»ºçš„ï¼Œå› æ­¤å­è¿›ç¨‹å’Œçˆ¶è¿›ç¨‹å‡ ä¹å®Œå…¨ç›¸åŒï¼Œæ‹¥æœ‰ç›¸åŒçš„ä»£ç ã€æ•°æ®å’Œæ‰“å¼€çš„æ–‡ä»¶æè¿°ç¬¦ã€‚ æ‰§è¡Œç»“æœï¼š çˆ¶è¿›ç¨‹è°ƒç”¨ fork åï¼Œè¿”å›å€¼æ˜¯å­è¿›ç¨‹çš„ PIDã€‚ å­è¿›ç¨‹ä» fork è¿”å›æ—¶ï¼Œè¿”å›å€¼æ˜¯ 0ã€‚ ç‰¹ç‚¹ï¼š å­è¿›ç¨‹æ˜¯çˆ¶è¿›ç¨‹çš„å‡ ä¹ç²¾ç¡®å‰¯æœ¬ï¼ŒåŒ…æ‹¬æ–‡ä»¶æè¿°ç¬¦ã€å˜é‡ã€ä»£ç æ®µç­‰ï¼Œä½†å…¶ PIDï¼ˆè¿›ç¨‹ IDï¼‰ä¸åŒã€‚ å¹¶å‘æ‰§è¡Œï¼šfork ä¹‹åï¼Œçˆ¶è¿›ç¨‹å’Œå­è¿›ç¨‹å¯ä»¥å¹¶å‘æ‰§è¡Œå„è‡ªçš„ä»£ç ã€‚ å¤šæ¬¡è¿”å›ï¼šfork ä¼šè¿”å›ä¸¤æ¬¡ï¼Œä¸€æ¬¡åœ¨çˆ¶è¿›ç¨‹ä¸­ï¼Œä¸€æ¬¡åœ¨å­è¿›ç¨‹ä¸­ã€‚ exec ç³»ç»Ÿè°ƒç”¨ åŠŸèƒ½ï¼šexec ç”¨äºæ›¿æ¢å½“å‰è¿›ç¨‹çš„ä»£ç å’Œæ•°æ®æ®µï¼ŒåŠ è½½ä¸€ä¸ªæ–°ç¨‹åºå¹¶æ‰§è¡Œè¯¥ç¨‹åºã€‚å½“ exec è¢«è°ƒç”¨æ—¶ï¼Œå½“å‰è¿›ç¨‹çš„æ‰€æœ‰å†…å®¹ï¼ˆå¦‚ä»£ç ã€æ•°æ®ã€å †æ ˆï¼‰éƒ½è¢«æ–°ç¨‹åºæ›¿æ¢ï¼Œä½†è¿›ç¨‹çš„ PID ä¸å˜ã€‚ æ‰§è¡Œç»“æœï¼š exec ä¸è¿”å›ï¼Œé™¤éè°ƒç”¨å¤±è´¥ã€‚æˆåŠŸè°ƒç”¨ exec åï¼Œæ—§çš„ç¨‹åºä»£ç å®Œå…¨è¢«æ–°ç¨‹åºæ›¿æ¢ã€‚ æ–‡ä»¶æè¿°ç¬¦ä¸ä¼šè¢«å…³é—­ï¼ˆé™¤éè®¾ç½®äº† close-on-exec æ ‡å¿—ï¼‰ã€‚ ç‰¹ç‚¹ï¼š exec åªä¼šæ”¹å˜è¿›ç¨‹çš„æ‰§è¡Œä»£ç ï¼Œä¸ä¼šåˆ›å»ºæ–°çš„è¿›ç¨‹ã€‚ æ–°ç¨‹åºç»§æ‰¿äº†è°ƒç”¨è¿›ç¨‹çš„ PID å’Œæ–‡ä»¶æè¿°ç¬¦ï¼Œä½†åŸæœ‰çš„å†…å­˜æ•°æ®ã€å †æ ˆã€ä»£ç ç­‰éƒ½ä¼šè¢«æ–°ç¨‹åºæ›¿æ¢æ‰ã€‚ example: redirect.c, redirect the output of a command what does the shell do for this?\n$ echo hello \u0026gt; out answer: fork, change FD 1 in child, exec echo\n$ redirect $ cat output.txt note: open() always chooses lowest unused FD; 1 due to close(1). fork, FDs, and exec interact nicely to implement I/O redirection separate fork-then-exec give child a chance to change FDs before exec FDs provide indirection commands just use FDs 0 and 1, don\u0026rsquo;t have to know where they go exec preserves the FDs that sh set up thus: only sh has to know about I/O redirection, not each program\nIt\u0026rsquo;s worth asking \u0026ldquo;why\u0026rdquo; about design decisions: Why these I/O and process abstractions? Why not something else? Why provide a file system? Why not let programs use the disk their own way? Why FDs? Why not pass a filename to write()? Why are files streams of bytes, not disk blocks or formatted records? Why not combine fork() and exec()? The UNIX design works well, but we will see other designs!\nexample: pipe1.c, communicate through a pipe how does the shell implement\n$ ls | grep x $ pipe1 an FD can refer to a \u0026ldquo;pipe\u0026rdquo;, as well as a file the pipe() system call creates two FDs read from the first FD write to the second FD the kernel maintains a buffer for each pipe [u/k diagram] write() appends to the buffer read() waits until there is data\nexample: pipe2.c, communicate between processes pipes combine well with fork() to implement ls | grep x shell creates a pipe, then forks (twice), then connects ls\u0026rsquo;s FD 1 to pipe\u0026rsquo;s write FD, and grep\u0026rsquo;s FD 0 to the pipe [diagram]\n$ pipe2 -- a simplified version pipes are a separate abstraction, but combine well w/ fork()\nexample: list.c, list files in a directory how does ls get a list of the files in a directory? you can open a directory and read it -\u0026gt; file names \u0026ldquo;.\u0026rdquo; is a pseudo-name for a process\u0026rsquo;s current directory see ls.c for more details\nSummary We\u0026rsquo;ve looked at UNIX\u0026rsquo;s I/O, file system, and process abstractions. The interfaces are simple \u0026ndash; just integers and I/O buffers. The abstractions combine well, e.g. for I/O redirection. You\u0026rsquo;ll use these system calls in the first lab, due next week.\nCode Pipes int pipeFd[2]; // ç®¡é“æ–‡ä»¶æè¿°ç¬¦æ•°ç»„ï¼ŒpipeFd[0]ä¸ºè¯»å–ç«¯ï¼ŒpipeFd[1]ä¸ºå†™å…¥ç«¯ char *arguments[2]; // å­˜å‚¨ä¼ é€’ç»™execçš„å‚æ•° int main() { // è®¾ç½®è¦æ‰§è¡Œçš„å‘½ä»¤å’Œå‚æ•° arguments[0] = \u0026#34;wc\u0026#34;; // å°† \u0026#34;wc\u0026#34; å‘½ä»¤ä½œä¸ºå‚æ•°ä¼ é€’ç»™execï¼Œç”¨äºç»Ÿè®¡è¾“å…¥çš„è¡Œã€å•è¯å’Œå­—ç¬¦æ•° arguments[1] = 0; // ä»¥NULLè¡¨ç¤ºå‚æ•°ç»“æŸ // åˆ›å»ºç®¡é“ pipe(pipeFd); // pipeFd[0]ç”¨äºè¯»å–ï¼ŒpipeFd[1]ç”¨äºå†™å…¥ // åˆ›å»ºå­è¿›ç¨‹ if(fork() == 0) { // å­è¿›ç¨‹ä»£ç ï¼Œfork()è¿”å›0è¡¨ç¤ºå½“å‰æ˜¯å­è¿›ç¨‹ close(0); // å…³é—­æ ‡å‡†è¾“å…¥ï¼ˆæ–‡ä»¶æè¿°ç¬¦0ï¼‰ dup(pipeFd[0]); // å°†ç®¡é“çš„è¯»å–ç«¯å¤åˆ¶åˆ°æ–‡ä»¶æè¿°ç¬¦0ï¼Œä½¿æ ‡å‡†è¾“å…¥é‡å®šå‘åˆ°ç®¡é“çš„è¯»å–ç«¯ close(pipeFd[0]); // å…³é—­ç®¡é“çš„è¯»å–ç«¯ï¼Œå·²é‡å®šå‘åˆ°æ ‡å‡†è¾“å…¥ï¼Œä¸å†éœ€è¦ close(pipeFd[1]); // å…³é—­ç®¡é“çš„å†™å…¥ç«¯ï¼Œå­è¿›ç¨‹ä¸è´Ÿè´£å†™å…¥æ•°æ® exec(\u0026#34;/bin/wc\u0026#34;, arguments); // æ‰§è¡Œwcå‘½ä»¤ï¼Œè¯»å–æ ‡å‡†è¾“å…¥ï¼ˆä»ç®¡é“ä¸­è¯»å–ï¼‰ï¼Œè®¡ç®—è¡Œã€å•è¯å’Œå­—ç¬¦æ•° } else { // çˆ¶è¿›ç¨‹ä»£ç  close(pipeFd[0]); // å…³é—­ç®¡é“çš„è¯»å–ç«¯ï¼Œçˆ¶è¿›ç¨‹ä¸è´Ÿè´£è¯»å–æ•°æ® // å‘ç®¡é“å†™å…¥æ•°æ® write(pipeFd[1], \u0026#34;hello world\\n\u0026#34;, 12); // å°† \u0026#34;hello world\\n\u0026#34; å†™å…¥ç®¡é“ï¼Œä¾›å­è¿›ç¨‹è¯»å– close(pipeFd[1]); // å…³é—­ç®¡é“çš„å†™å…¥ç«¯ï¼Œè¡¨ç¤ºæ•°æ®å†™å…¥å®Œæˆ } return 0; } cat.c #include \u0026#34;kernel/types.h\u0026#34; // åŒ…å«ç³»ç»Ÿè°ƒç”¨ç›¸å…³çš„ç±»å‹å®šä¹‰ #include \u0026#34;kernel/stat.h\u0026#34; // åŒ…å«æ–‡ä»¶çŠ¶æ€ç›¸å…³çš„å®šä¹‰ #include \u0026#34;user/user.h\u0026#34; // åŒ…å«ç”¨æˆ·æ€å‡½æ•°çš„å£°æ˜ï¼ˆå¦‚ read, write, open, close, fprintf, exitï¼‰ char buf[512]; // å®šä¹‰ä¸€ä¸ªç¼“å†²åŒºï¼Œç”¨äºå­˜å‚¨è¯»å–çš„æ•°æ® // å‡½æ•°ï¼šcat // å‚æ•°ï¼šint fd - æ–‡ä»¶æè¿°ç¬¦ // åŠŸèƒ½ï¼šä»æ–‡ä»¶æè¿°ç¬¦ fd ä¸­è¯»å–æ•°æ®ï¼Œå¹¶å°†å…¶å†™å…¥æ ‡å‡†è¾“å‡ºï¼ˆæ–‡ä»¶æè¿°ç¬¦ 1ï¼‰ void cat(int fd) { int n; // ä»æ–‡ä»¶æè¿°ç¬¦ fd ä¸­è¯»å–æ•°æ®åˆ° buf ä¸­ï¼Œè¯»å–çš„å­—èŠ‚æ•°å­˜å‚¨åœ¨ n ä¸­ while((n = read(fd, buf, sizeof(buf))) \u0026gt; 0) { // å°†è¯»å–çš„æ•°æ®å†™å…¥æ ‡å‡†è¾“å‡º if (write(1, buf, n) != n) { // å¦‚æœå†™å…¥çš„å­—èŠ‚æ•°ä¸ç­‰äºè¯»å–çš„å­—èŠ‚æ•°ï¼ŒæŠ¥å‘Šå†™å…¥é”™è¯¯ fprintf(2, \u0026#34;cat: write error\\n\u0026#34;); exit(1); } } // å¦‚æœè¯»å–è¿‡ç¨‹ä¸­å‡ºç°é”™è¯¯ï¼ŒæŠ¥å‘Šè¯»å–é”™è¯¯å¹¶é€€å‡º if(n \u0026lt; 0){ fprintf(2, \u0026#34;cat: read error\\n\u0026#34;); exit(1); } } // ä¸»å‡½æ•° int main(int argc, char *argv[]) { int fd, i; // å¦‚æœæ²¡æœ‰æä¾›æ–‡ä»¶å‚æ•°ï¼Œé»˜è®¤è¯»å–æ ‡å‡†è¾“å…¥ï¼ˆæ–‡ä»¶æè¿°ç¬¦ 0ï¼‰ if(argc \u0026lt;= 1){ cat(0); exit(0); } // éå†å‘½ä»¤è¡Œå‚æ•°ä¸­çš„æ–‡ä»¶å for(i = 1; i \u0026lt; argc; i++){ // æ‰“å¼€æ–‡ä»¶ï¼Œè·å–æ–‡ä»¶æè¿°ç¬¦ if((fd = open(argv[i], 0)) \u0026lt; 0){ // å¦‚æœæ–‡ä»¶æ— æ³•æ‰“å¼€ï¼ŒæŠ¥å‘Šé”™è¯¯å¹¶é€€å‡º fprintf(2, \u0026#34;cat: cannot open %s\\n\u0026#34;, argv[i]); exit(1); } // è°ƒç”¨ cat å‡½æ•°ï¼Œå°†æ–‡ä»¶å†…å®¹è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡º cat(fd); // å…³é—­æ–‡ä»¶æè¿°ç¬¦ close(fd); } // æ­£å¸¸é€€å‡º exit(0); } echo.c #include \u0026#34;kernel/types.h\u0026#34; // åŒ…å«ç³»ç»Ÿè°ƒç”¨ç›¸å…³çš„ç±»å‹å®šä¹‰ #include \u0026#34;kernel/stat.h\u0026#34; // åŒ…å«æ–‡ä»¶çŠ¶æ€ç›¸å…³çš„å®šä¹‰ #include \u0026#34;user/user.h\u0026#34; // åŒ…å«ç”¨æˆ·æ€å‡½æ•°çš„å£°æ˜ï¼ˆå¦‚ write, exit, strlenï¼‰ int main(int argc, char *argv[]) { int i; // éå†å‘½ä»¤è¡Œå‚æ•°ï¼Œä»ç¬¬ä¸€ä¸ªå‚æ•°ï¼ˆargv[1]ï¼‰å¼€å§‹ for(i = 1; i \u0026lt; argc; i++){ // å°†å½“å‰å‚æ•° argv[i] å†™å…¥æ ‡å‡†è¾“å‡ºï¼ˆæ–‡ä»¶æè¿°ç¬¦ 1ï¼‰ write(1, argv[i], strlen(argv[i])); // å¦‚æœä¸æ˜¯æœ€åä¸€ä¸ªå‚æ•°ï¼Œåœ¨å…¶åå†™å…¥ä¸€ä¸ªç©ºæ ¼ if(i + 1 \u0026lt; argc){ write(1, \u0026#34; \u0026#34;, 1); } else { // å¦‚æœæ˜¯æœ€åä¸€ä¸ªå‚æ•°ï¼Œåœ¨å…¶åå†™å…¥ä¸€ä¸ªæ¢è¡Œç¬¦ write(1, \u0026#34;\\n\u0026#34;, 1); } } // æ­£å¸¸é€€å‡ºç¨‹åº exit(0); } forktest.c // æµ‹è¯• fork æ˜¯å¦èƒ½åœ¨è¿›ç¨‹è¡¨æ»¡æ—¶ä¼˜é›…åœ°å¤±è´¥ã€‚ // è¿™ä¸ªç¨‹åºæ˜¯ä¸€ä¸ªå°çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œç”¨äºå¡«å……è¿›ç¨‹è¡¨ä»¥æµ‹è¯• fork çš„è¡Œä¸ºã€‚ #include \u0026#34;kernel/types.h\u0026#34; // åŒ…å«ç³»ç»Ÿè°ƒç”¨ç›¸å…³çš„ç±»å‹å®šä¹‰ #include \u0026#34;kernel/stat.h\u0026#34; // åŒ…å«æ–‡ä»¶çŠ¶æ€ç›¸å…³çš„å®šä¹‰ #include \u0026#34;user/user.h\u0026#34; // åŒ…å«ç”¨æˆ·æ€å‡½æ•°çš„å£°æ˜ï¼ˆå¦‚ write, exit, fork, wait, strlenï¼‰ #define N 1000 // å®šä¹‰æµ‹è¯•çš„ fork æœ€å¤§æ¬¡æ•° // å‡½æ•°ï¼šprint // å‚æ•°ï¼šconst char *s - è¦è¾“å‡ºçš„å­—ç¬¦ä¸² // åŠŸèƒ½ï¼šå°†å­—ç¬¦ä¸² s å†™å…¥æ ‡å‡†è¾“å‡ºï¼ˆæ–‡ä»¶æè¿°ç¬¦ 1ï¼‰ void print(const char *s) { write(1, s, strlen(s)); // ä½¿ç”¨ write ç³»ç»Ÿè°ƒç”¨å°†å­—ç¬¦ä¸²å†™å…¥æ ‡å‡†è¾“å‡º } // å‡½æ•°ï¼šforktest // åŠŸèƒ½ï¼šæµ‹è¯• fork ç³»ç»Ÿè°ƒç”¨çš„è¡Œä¸ºï¼Œç‰¹åˆ«æ˜¯åœ¨è¿›ç¨‹è¡¨æ»¡æ—¶ void forktest(void) { int n, pid; // è¾“å‡ºå¼€å§‹æµ‹è¯•çš„ä¿¡æ¯ print(\u0026#34;fork test\\n\u0026#34;); // å¾ªç¯å°è¯•åˆ›å»º N ä¸ªå­è¿›ç¨‹ for(n = 0; n \u0026lt; N; n++){ pid = fork(); // åˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹ if(pid \u0026lt; 0) break; // å¦‚æœ fork å¤±è´¥ï¼Œé€€å‡ºå¾ªç¯ if(pid == 0) exit(0); // å­è¿›ç¨‹é€€å‡º } // å¦‚æœæˆåŠŸåˆ›å»ºäº† N ä¸ªå­è¿›ç¨‹ï¼Œè¡¨ç¤º fork è¡Œä¸ºå¼‚å¸¸ if(n == N){ print(\u0026#34;fork claimed to work N times!\\n\u0026#34;); exit(1); } // ç­‰å¾…æ‰€æœ‰å­è¿›ç¨‹ç»“æŸ for(; n \u0026gt; 0; n--){ if(wait(0) \u0026lt; 0){ // ç­‰å¾…å­è¿›ç¨‹ç»“æŸ print(\u0026#34;wait stopped early\\n\u0026#34;); exit(1); // å¦‚æœ wait å¤±è´¥ï¼ŒæŠ¥å‘Šé”™è¯¯å¹¶é€€å‡º } } // å¦‚æœ wait æ²¡æœ‰è¿”å› -1ï¼Œè¡¨ç¤ºè¿˜æœ‰å¤šä½™çš„å­è¿›ç¨‹ if(wait(0) != -1){ print(\u0026#34;wait got too many\\n\u0026#34;); exit(1); } // è¾“å‡ºæµ‹è¯•æˆåŠŸçš„ä¿¡æ¯ print(\u0026#34;fork test OK\\n\u0026#34;); } // ä¸»å‡½æ•° int main(void) { forktest(); // æ‰§è¡Œ fork æµ‹è¯• exit(0); // æ­£å¸¸é€€å‡ºç¨‹åº } stressfs.c // Demonstrate that moving the \u0026#34;acquire\u0026#34; in iderw after the loop that // appends to the idequeue results in a race. // For this to work, you should also add a spin within iderw\u0026#39;s // idequeue traversal loop. Adding the following demonstrated a panic // after about 5 runs of stressfs in QEMU on a 2.1GHz CPU: // for (i = 0; i \u0026lt; 40000; i++) // asm volatile(\u0026#34;\u0026#34;); #include \u0026#34;kernel/types.h\u0026#34; #include \u0026#34;kernel/stat.h\u0026#34; #include \u0026#34;user/user.h\u0026#34; #include \u0026#34;kernel/fs.h\u0026#34; #include \u0026#34;kernel/fcntl.h\u0026#34; int main(int argc, char *argv[]) { int fd, i; char path[] = \u0026#34;stressfs0\u0026#34;; char data[512]; printf(\u0026#34;stressfs starting\\n\u0026#34;); memset(data, \u0026#39;a\u0026#39;, sizeof(data)); for(i = 0; i \u0026lt; 4; i++) if(fork() \u0026gt; 0) break; printf(\u0026#34;write %d\\n\u0026#34;, i); path[8] += i; fd = open(path, O_CREATE | O_RDWR); for(i = 0; i \u0026lt; 20; i++) // printf(fd, \u0026#34;%d\\n\u0026#34;, i); write(fd, data, sizeof(data)); close(fd); printf(\u0026#34;read\\n\u0026#34;); fd = open(path, O_RDONLY); for (i = 0; i \u0026lt; 20; i++) read(fd, data, sizeof(data)); close(fd); wait(0); exit(0); } Lab - Util sleep (easy) #include \u0026#34;kernel/types.h\u0026#34; #include \u0026#34;kernel/stat.h\u0026#34; #include \u0026#34;user/user.h\u0026#34; int main(int argc, char *argv[]) { if(argc != 2){ fprintf(2, \u0026#34;Usage: sleep [the times of ticks]...\\n\u0026#34;); exit(1); } int times = atoi(argv[1]); sleep(times); exit(0); } pingpong (easy) #include \u0026#34;kernel/types.h\u0026#34; #include \u0026#34;kernel/stat.h\u0026#34; #include \u0026#34;user/user.h\u0026#34; int main(int argc, char *argv[]) { if (argc \u0026gt; 1) { fprintf(2, \u0026#34;Usage: pingpong (without any parameters)\\n\u0026#34;); exit(1); } int pipe_fd[2]; if (pipe(pipe_fd) \u0026lt; 0) { fprintf(2, \u0026#34;pipe error\\n\u0026#34;); exit(1); } int pid = fork(); if (pid \u0026gt; 0) { // çˆ¶è¿›ç¨‹å…³é—­ç®¡é“çš„å†™ç«¯ close(pipe_fd[1]); // çˆ¶è¿›ç¨‹ç­‰å¾…å­è¿›ç¨‹çš„ä¿¡å· char buf[1]; read(pipe_fd[0], buf, 1); pid = wait((int *)0); printf(\u0026#34;%d: received pong\\n\u0026#34;, getpid()); // çˆ¶è¿›ç¨‹å…³é—­ç®¡é“çš„è¯»ç«¯ close(pipe_fd[0]); } else if (pid == 0) { // å­è¿›ç¨‹å…³é—­ç®¡é“çš„è¯»ç«¯ close(pipe_fd[0]); printf(\u0026#34;%d: received ping\\n\u0026#34;, getpid()); // å­è¿›ç¨‹é€šè¿‡ç®¡é“å‘çˆ¶è¿›ç¨‹å‘é€ä¿¡å· write(pipe_fd[1], \u0026#34;x\u0026#34;, 1); // å­è¿›ç¨‹å…³é—­ç®¡é“çš„å†™ç«¯ close(pipe_fd[1]); exit(0); } else { printf(\u0026#34;fork error\\n\u0026#34;); exit(1); } exit(0); } primes (moderate)/(hard) #include \u0026#34;kernel/types.h\u0026#34; #include \u0026#34;kernel/stat.h\u0026#34; #include \u0026#34;user/user.h\u0026#34; void sieve(int p_left) { int p_right[2]; int prime; // ä»å·¦ä¾§ç®¡é“è¯»å–ç¬¬ä¸€ä¸ªæ•°å­— if (read(p_left, \u0026amp;prime, sizeof(int)) == 0) { close(p_left); exit(0); } // è¾“å‡ºè¯¥ç´ æ•° printf(\u0026#34;prime %d\\n\u0026#34;, prime); // åˆ›å»ºä¸€ä¸ªæ–°çš„ç®¡é“ if (pipe(p_right) \u0026lt; 0) { fprintf(2, \u0026#34;pipe error\\n\u0026#34;); exit(1); } if (fork() == 0) { // å­è¿›ç¨‹é€’å½’å¤„ç† close(p_right[1]); sieve(p_right[0]); } else { // çˆ¶è¿›ç¨‹ç»§ç»­è¯»å–å¹¶ç­›é€‰ close(p_right[0]); int num; while (read(p_left, \u0026amp;num, sizeof(int)) != 0) { if (num % prime != 0) { write(p_right[1], \u0026amp;num, sizeof(int)); } } // å…³é—­ç®¡é“ï¼Œç­‰å¾…å­è¿›ç¨‹ç»“æŸ close(p_left); close(p_right[1]); wait(0); exit(0); } } int main(int argc, char *argv[]) { int p[2]; if (pipe(p) \u0026lt; 0) { fprintf(2, \u0026#34;pipe error\\n\u0026#34;); exit(1); } if (fork() == 0) { close(p[1]); sieve(p[0]); } else { close(p[0]); // å°† 2 åˆ° 35 çš„æ•°å­—å†™å…¥ç®¡é“ for (int i = 2; i \u0026lt;= 35; i++) { write(p[1], \u0026amp;i, sizeof(int)); } close(p[1]); wait(0); exit(0); } return 0; } find (moderate) #include \u0026#34;kernel/types.h\u0026#34; #include \u0026#34;kernel/stat.h\u0026#34; #include \u0026#34;user/user.h\u0026#34; #include \u0026#34;kernel/fs.h\u0026#34; #include \u0026#34;kernel/fcntl.h\u0026#34; #define MAXBUF 512 // å®šä¹‰ç¼“å†²åŒºå¤§å° /** * find - é€’å½’æŸ¥æ‰¾ç›®å½•æ ‘ä¸­ä¸æŒ‡å®šæ–‡ä»¶ååŒ¹é…çš„æ–‡ä»¶ã€‚ * @path: è¦æœç´¢çš„ç›®å½•è·¯å¾„ã€‚ * @filename: è¦æŸ¥æ‰¾çš„æ–‡ä»¶åã€‚ * * è¯¥å‡½æ•°é€šè¿‡é€’å½’éå†ç›®å½•æ ‘ï¼Œæ‰“å°å‡ºä¸æŒ‡å®šæ–‡ä»¶ååŒ¹é…çš„æ–‡ä»¶çš„è·¯å¾„ã€‚ * å®ƒä¼šå¿½ç•¥ç‰¹æ®Šç›®å½•é¡¹ `.` å’Œ `..` ä»¥é¿å…é€’å½’å›åˆ°å½“å‰æˆ–çˆ¶ç›®å½•ã€‚ */ void find(char *path, char *filename) { char buf[512], *p; int fd; struct dirent de; struct stat st; // æ‰“å¼€æŒ‡å®šçš„ç›®å½•è·¯å¾„ if ((fd = open(path, 0)) \u0026lt; 0) { fprintf(2, \u0026#34;find: cannot open %s\\n\u0026#34;, path); return; } // è·å–æ–‡ä»¶çŠ¶æ€ï¼ˆä¾‹å¦‚ç¡®å®šæ˜¯æ–‡ä»¶è¿˜æ˜¯ç›®å½•ï¼‰ if (fstat(fd, \u0026amp;st) \u0026lt; 0) { fprintf(2, \u0026#34;find: cannot stat %s\\n\u0026#34;, path); close(fd); return; } // åˆ¤æ–­æ–‡ä»¶ç±»å‹ï¼Œå¤„ç†ä¸åŒçš„æƒ…å†µ switch (st.type) { case T_FILE: // å¦‚æœæ˜¯æ™®é€šæ–‡ä»¶ // æ£€æŸ¥æ–‡ä»¶åæ˜¯å¦ä¸ç›®æ ‡æ–‡ä»¶ååŒ¹é… if (strcmp(path + strlen(path) - strlen(filename), filename) == 0) { // å¦‚æœåŒ¹é…ï¼Œæ‰“å°æ–‡ä»¶è·¯å¾„ printf(\u0026#34;%s\\n\u0026#34;, path); // æ³¨æ„è¿™é‡Œæ¯ä¸ªåŒ¹é…çš„æ–‡ä»¶éƒ½åº”è¯¥åœ¨æ–°è¡Œæ‰“å° } break; case T_DIR: // å¦‚æœæ˜¯ç›®å½• // æ£€æŸ¥è·¯å¾„é•¿åº¦æ˜¯å¦è¶…å‡ºç¼“å†²åŒºå¤§å° if (strlen(path) + 1 + DIRSIZ + 1 \u0026gt; sizeof(buf)) { printf(\u0026#34;find: path too long\\n\u0026#34;); break; } // å°†å½“å‰è·¯å¾„å¤åˆ¶åˆ°ç¼“å†²åŒºä¸­ strcpy(buf, path); p = buf + strlen(buf); *p++ = \u0026#39;/\u0026#39;; // è¯»å–ç›®å½•ä¸­çš„æ¯ä¸ªç›®å½•é¡¹ while (read(fd, \u0026amp;de, sizeof(de)) == sizeof(de)) { if (de.inum == 0) continue; // è·³è¿‡æ— æ•ˆçš„ç›®å½•é¡¹ // å°†ç›®å½•é¡¹åç§°å¤åˆ¶åˆ°è·¯å¾„ç¼“å†²åŒº memmove(p, de.name, DIRSIZ); p[DIRSIZ] = 0; // å¿½ç•¥ç‰¹æ®Šç›®å½•é¡¹ `.` å’Œ `..` if (strcmp(de.name, \u0026#34;.\u0026#34;) == 0 || strcmp(de.name, \u0026#34;..\u0026#34;) == 0) continue; // é€’å½’è°ƒç”¨ find å‡½æ•°å¤„ç†å­ç›®å½•æˆ–æ–‡ä»¶ find(buf, filename); } break; } // å…³é—­æ–‡ä»¶æè¿°ç¬¦ä»¥é‡Šæ”¾èµ„æº close(fd); } /** * main - ç¨‹åºçš„å…¥å£ç‚¹ï¼Œè§£æå‘½ä»¤è¡Œå‚æ•°å¹¶è°ƒç”¨ find å‡½æ•°ã€‚ * @argc: å‚æ•°ä¸ªæ•°ã€‚ * @argv: å‚æ•°å€¼æ•°ç»„ã€‚ * * è¯¥å‡½æ•°éªŒè¯å‚æ•°çš„æ­£ç¡®æ€§ï¼Œå¹¶è°ƒç”¨ find å‡½æ•°å¼€å§‹é€’å½’æŸ¥æ‰¾ã€‚ */ int main(int argc, char *argv[]) { // æ£€æŸ¥å‘½ä»¤è¡Œå‚æ•°æ˜¯å¦æ­£ç¡® if (argc \u0026lt; 3) { // å¦‚æœå‚æ•°ä¸è¶³ï¼Œæ‰“å°ä½¿ç”¨è¯´æ˜å¹¶é€€å‡º fprintf(2, \u0026#34;Usage: find \u0026lt;directory\u0026gt; \u0026lt;filename\u0026gt;\\n\u0026#34;); exit(1); } // è°ƒç”¨ find å‡½æ•°ï¼Œå¼€å§‹æŸ¥æ‰¾æ–‡ä»¶ find(argv[1], argv[2]); exit(0); } xargs (moderate) #include \u0026#34;kernel/types.h\u0026#34; #include \u0026#34;kernel/stat.h\u0026#34; #include \u0026#34;user/user.h\u0026#34; #define MAXARG 32 // æœ€å¤§å‚æ•°æ•°é‡ #define MAXBUF 1024 // æœ€å¤§è¾“å…¥ç¼“å†²åŒºå¤§å° // ä»æ ‡å‡†è¾“å…¥è¯»å–ä¸€è¡Œ int read_line(char *buf, int size) { int i = 0; // å½“å‰å­—ç¬¦ç´¢å¼• char c; // å­˜å‚¨è¯»å–çš„å­—ç¬¦ // ä»æ ‡å‡†è¾“å…¥é€å­—ç¬¦è¯»å–ï¼Œç›´åˆ°é‡åˆ°æ¢è¡Œç¬¦æˆ–ç¼“å†²åŒºå·²æ»¡ while (i \u0026lt; size - 1) { if (read(0, \u0026amp;c, 1) != 1) { return i; // åˆ°è¾¾è¾“å…¥ç»“æŸæˆ–å‘ç”Ÿé”™è¯¯ } if (c == \u0026#39;\\n\u0026#39;) { break; // é‡åˆ°æ¢è¡Œç¬¦ï¼Œåœæ­¢è¯»å– } buf[i++] = c; // å°†è¯»å–çš„å­—ç¬¦å­˜å…¥ç¼“å†²åŒº } buf[i] = \u0026#39;\\0\u0026#39;; // åœ¨å­—ç¬¦ä¸²æœ«å°¾æ·»åŠ  null ç»ˆæ­¢ç¬¦ return i; } int main(int argc, char *argv[]) { if (argc \u0026lt; 2) { fprintf(2, \u0026#34;Usage: xargs command [initial-args]\\n\u0026#34;); // å¦‚æœæ²¡æœ‰æä¾›å‘½ä»¤å‚æ•°ï¼Œè¾“å‡ºç”¨æ³•æç¤º exit(1); // é€€å‡ºç¨‹åº } char buf[MAXBUF]; // ç”¨äºå­˜å‚¨è¾“å…¥è¡Œçš„ç¼“å†²åŒº // ä»æ ‡å‡†è¾“å…¥è¯»å–æ¯ä¸€è¡Œ while (read_line(buf, sizeof(buf)) \u0026gt; 0) { // åˆ›å»ºå‘½ä»¤è¡Œå‚æ•°æ•°ç»„ char *cmd_argv[MAXARG + 2]; // +2: ä¸€ä¸ªå­˜æ”¾å‘½ä»¤åï¼Œä¸€ä¸ªå­˜æ”¾æ‹¼æ¥åçš„å‚æ•° cmd_argv[0] = argv[1]; // å‘½ä»¤åç§° int i; // å¤åˆ¶ç”¨æˆ·æä¾›çš„åˆå§‹å‚æ•°ï¼ˆå¦‚æœæœ‰ï¼‰ for (i = 1; i \u0026lt; argc - 1 \u0026amp;\u0026amp; i \u0026lt; MAXARG; i++) { cmd_argv[i] = argv[i + 1]; } // å°†è¯»å–çš„è¡Œä½œä¸ºæœ€åä¸€ä¸ªå‚æ•° cmd_argv[i++] = buf; cmd_argv[i] = 0; // å‚æ•°åˆ—è¡¨ä»¥ null ç»ˆæ­¢ int pid = fork(); // åˆ›å»ºå­è¿›ç¨‹ if (pid \u0026lt; 0) { fprintf(2, \u0026#34;xargs: fork failed\\n\u0026#34;); // å¦‚æœåˆ›å»ºå­è¿›ç¨‹å¤±è´¥ï¼Œè¾“å‡ºé”™è¯¯ä¿¡æ¯ exit(1); // é€€å‡ºç¨‹åº } else if (pid == 0) { exec(cmd_argv[0], cmd_argv); // æ‰§è¡Œå‘½ä»¤ fprintf(2, \u0026#34;xargs: exec failed\\n\u0026#34;); // å¦‚æœæ‰§è¡Œå‘½ä»¤å¤±è´¥ï¼Œè¾“å‡ºé”™è¯¯ä¿¡æ¯ exit(1); // é€€å‡ºå­è¿›ç¨‹ } else { // çˆ¶è¿›ç¨‹ä¸­ wait(0); // ç­‰å¾…å­è¿›ç¨‹å®Œæˆ } } exit(0); // æ­£å¸¸é€€å‡ºç¨‹åº } ","permalink":"https://kennems.github.io/posts/tech/mit6.s0811-os-overview/","summary":"MIT6.S081(1)-O/S overview Class Page Overview 6.S081 goals Understand operating system (O/S) design and implementation Hands-on experience extending a small O/S Hands-on experience writing systems software What is the purpose of an O/S? Abstract the hardware for convenience and portability Multiplex the hardware among many applications Isolate applications in order to contain bugs Allow sharing among cooperating applications Control sharing for security Don\u0026rsquo;t get in the way of high performance Support","title":"MIT6.S081(1)-O/S overview"},{"content":"MIT6.S081(3)-OS organization Lecture Topic: OS design â€‹ system calls â€‹ micro/monolithic kernel First system call in xv6\nOS picture apps: sh, echo, \u0026hellip; system call interface (open, close,\u0026hellip;) OS\nGoal of OS run multiple applications isolate them multiplex them share\nStrawman design: No OS Application directly interacts with hardware CPU cores \u0026amp; registers DRAM chips Disk blocks \u0026hellip; OS library perhaps abstracts some of it\nStrawman design not conducive to multiplexing each app periodically must give up hardware BUT, weak isolation app forgets to give up, no other app runs apps has end-less loop, no other app runs you cannot even kill the badly app from another app but used by real-time OSes \u0026ldquo;cooperative scheduling\u0026rdquo;\nStrawman design not conducive to memory isolation all apps share physical memory one app can overwrites another apps memory one app can overwrite OS library\nUnix interface conducive to OS goals abstracts the hardware in way that achieves goals processes (instead of cores): fork OS transparently allocates cores to processes Saves and restore registers Enforces that processes give them up Periodically re-allocates cores memory (instead of physical memory): exec Each process has its \u0026ldquo;own\u0026rdquo; memory OS can decide where to place app in memory OS can enforce isolation between memory of different apps OS allows storing image in file system files (instead of disk blocks) OS can provide convenient names OS can allow sharing of files between processes/users pipes (instead of shared physical mem) OS can stop sender/receiver\nOS must be defensive an application shouldn\u0026rsquo;t be able to crash OS an application shouldn\u0026rsquo;t be able to break out of its isolation =\u0026gt; need strong isolation between apps and OS approach: hardware support\nuser/kernel mode virtual memory Processors provide user/kernel mode kernel mode: can execute \u0026ldquo;privileged\u0026rdquo; instructions e.g., setting kernel/user bit e.g., reprogramming timer chip user mode: cannot execute privileged instructions Run OS in kernel mode, applications in user mode [RISC-V has also an M mode, which we mostly ignore]\nProcessors provide virtual memory Hardware provides page tables that translate virtual address to physical Define what physical memory an application can access OS sets up page tables so that each application can access only its memory\nApps must be able to communicate with kernel Write to storage device, which is shared =\u0026gt; must be protected =\u0026gt; in kernel Exit app \u0026hellip;\nSolution: add instruction to change mode in controlled way ecall enters kernel mode at a pre-agreed entry point\nModify OS picture user / kernel (redline) app -\u0026gt; printf() -\u0026gt; write() -\u0026gt; SYSTEM CALL -\u0026gt; sys_write() -\u0026gt; \u0026hellip; user-level libraries are app\u0026rsquo;s private business kernel internal functions are not callable by user\nother way of drawing picture: syscall 1 -\u0026gt; system call stub -\u0026gt; kernel entry -\u0026gt; syscall -\u0026gt; fs syscall 2 -\u0026gt; proc\nsystem call stub executes special instruction to enter kernel hardware switches to kernel mode but only at an entry point specified by the kernel\nsyscall need some way to get at arguments of syscall\n[syscalls the topic of this week\u0026rsquo;s lab]\nKernel is the Trusted Computing Base (TCB) Kernel must be \u0026ldquo;correct\u0026rdquo; Bugs in kernel could allow user apps to circumvent kernel/user Happens often in practice, because kernels are complex See CVEs Kernel must treat user apps as suspect User app may trick kernel to do the wrong thing Kernel must check arguments carefully Setup user/kernel correctly Etc. Kernel in charge of separating applications too One app may try to read/write another app\u0026rsquo;s memory =\u0026gt; Requires a security mindset Any bug in kernel may be a security exploit\nAside: can one have process isolation WITHOUT h/w-supported kernel/user mode and virtual memory? yes! use a strongly-typed programming language\nFor example, see Singularity O/S the compiler is then the trust computing base (TCB) but h/w user/kernel mode is the most popular plan Monolothic kernel OS runs in kernel space Xv6 does this. Linux etc. too. kernel interface == system call interface one big program with file system, drivers, \u0026amp;c\ngood: easy for subsystems to cooperate one cache shared by file system and virtual memory bad: interactions are complex leads to bugs no isolation within Microkernel design many OS services run as ordinary user programs file system in a file server kernel implements minimal mechanism to run services in user space processes with memory inter-process communication (IPC) kernel interface != system call interface\ngood: more isolation bad: may be hard to get good performance both monolithic and microkernel designs widely used Xv6 case study Monolithic kernel Unix system calls == kernel interface Source code reflects OS organization (by convention) user/ apps in user mode kernel/ code in kernel mode Kernel has several parts kernel/defs.h proc fs .. Goal: read source code and understand it (without consulting book)\nUsing xv6 Makefile builds kernel program user programs mkfs $ make qemu runs xv6 on qemu emulates a RISC-V computer\nBuilding kernel\n.c -\u0026gt; gcc -\u0026gt; .s -\u0026gt; .o \\\r.... ld -\u0026gt; a.out\r.c -\u0026gt; gcc -\u0026gt; .s -\u0026gt; .o / makefile keeps .asm file around for binary see for example, kernel/kernel.asm\nThe RISC-V computer A very simple board (e.g., no display)\nRISC-V processor with 4 cores RAM (128 MB) support for interrupts (PLIC, CLINT) support for UART allows xv6 to talk to console allows xv6 to read from keyboard support for e1000 network card (through PCIe) Development using Qemu More convenient than using the real hardware Qemu emulates several RISC-V computers\nwe use the \u0026ldquo;virt\u0026rdquo; one https://github.com/riscv/riscv-qemu/wiki close to the SiFive board (https://www.sifive.com/boards) but with virtio for disk What is \u0026ldquo;to emulate\u0026rdquo;? Qemu is a C program that faithfully implements a RISC-V processor\nfor (;;) {\rread next instructions\rdecode instruction\rexecute instruction (updating processor state)\r} [big idea: software = hardware]\nBoot xv6 (under gdb)\n$ make CPUS=1 qemu-gdb â€‹ runs xv6 under gdb (with 1 core) Qemu starts xv6 in kernel/entry.S (see kernel/kernel.ld) â€‹ set breakpoint at _entry â€‹ look at instruction â€‹ info reg â€‹ set breakpoint at main â€‹ Walk through main â€‹ single step into userinit â€‹ Walk through userinit â€‹ show proc.h â€‹ show allocproc() â€‹ show initcode.S/initcode.asm â€‹ break forkret() â€‹ walk to userret â€‹ break syscall â€‹ print num â€‹ syscalls[num] â€‹ exec \u0026ldquo;/init\u0026rdquo;\nOperating system organization æ–‡ä»¶å æè¿° bio.c æ–‡ä»¶ç³»ç»Ÿçš„ç£ç›˜å—ç¼“å­˜ã€‚ console.c è¿æ¥ç”¨æˆ·é”®ç›˜å’Œå±å¹•ã€‚ entry.S æœ€æ—©çš„å¼•å¯¼æŒ‡ä»¤ã€‚ exec.c exec() ç³»ç»Ÿè°ƒç”¨ã€‚ file.c æ–‡ä»¶æè¿°ç¬¦æ”¯æŒã€‚ fs.c æ–‡ä»¶ç³»ç»Ÿã€‚ kalloc.c ç‰©ç†é¡µé¢åˆ†é…å™¨ã€‚ kernelvec.S å¤„ç†æ¥è‡ªå†…æ ¸çš„é™·é˜±å’Œå®šæ—¶å™¨ä¸­æ–­ã€‚ log.c æ–‡ä»¶ç³»ç»Ÿæ—¥å¿—å’Œå´©æºƒæ¢å¤ã€‚ main.c æ§åˆ¶å¯åŠ¨æ—¶å…¶ä»–æ¨¡å—çš„åˆå§‹åŒ–ã€‚ pipe.c ç®¡é“ã€‚ plic.c RISC-V ä¸­æ–­æ§åˆ¶å™¨ã€‚ printf.c æ ¼å¼åŒ–è¾“å‡ºåˆ°æ§åˆ¶å°ã€‚ proc.c è¿›ç¨‹å’Œè°ƒåº¦ã€‚ sleeplock.c è®©å‡º CPU çš„é”ã€‚ spinlock.c ä¸è®©å‡º CPU çš„é”ã€‚ start.c æœºå™¨æ¨¡å¼çš„æ—©æœŸå¼•å¯¼ä»£ç ã€‚ string.c C å­—ç¬¦ä¸²å’Œå­—èŠ‚æ•°ç»„åº“ã€‚ swtch.S çº¿ç¨‹åˆ‡æ¢ã€‚ syscall.c å°†ç³»ç»Ÿè°ƒç”¨åˆ†æ´¾ç»™å¤„ç†å‡½æ•°ã€‚ sysfile.c ä¸æ–‡ä»¶ç›¸å…³çš„ç³»ç»Ÿè°ƒç”¨ã€‚ sysproc.c ä¸è¿›ç¨‹ç›¸å…³çš„ç³»ç»Ÿè°ƒç”¨ã€‚ trampoline.S ç”¨æˆ·å’Œå†…æ ¸ä¹‹é—´åˆ‡æ¢çš„æ±‡ç¼–ä»£ç ã€‚ trap.c å¤„ç†å¹¶è¿”å›é™·é˜±å’Œä¸­æ–­çš„ C ä»£ç ã€‚ uart.c ä¸²è¡Œç«¯å£æ§åˆ¶å°è®¾å¤‡é©±åŠ¨ç¨‹åºã€‚ virtio_disk.c ç£ç›˜è®¾å¤‡é©±åŠ¨ç¨‹åºã€‚ vm.c ç®¡ç†é¡µè¡¨å’Œåœ°å€ç©ºé—´ã€‚ Lab: system calls System call tracing (moderate) /home/topeet/project/xv6-labs-2020/Makefile $U/_wc\\ $U/_zombie\\ $U/_trace\\ /home/topeet/project/xv6-labs-2020/user/usys.pl entry(\u0026#34;trace\u0026#34;); ~/project/xv6-labs-2020/kernel/proc.c åœ¨fork()å‡½æ•°å†…éƒ¨æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š\n// copy saved user registers. *(np-\u0026gt;trapframe) = *(p-\u0026gt;trapframe); np-\u0026gt;tracemask = p-\u0026gt;tracemask; // Cause fork to return 0 in the child. np-\u0026gt;trapframe-\u0026gt;a0 = 0; ~/project/xv6-labs-2020/kernel/proc.h åœ¨ç»“æ„ä½“procä¸­æ·»åŠ tracemaskå±æ€§\nchar name[16]; // Process name (debugging) int tracemask; // Trace Mask }; ~/project/xv6-labs-2020/kernel/syscall.c å¤„ç†ç³»ç»Ÿè°ƒç”¨ï¼ˆsystem call)çš„æ ¸å¿ƒä»£ç ï¼Œ ä¸»è¦ä½œç”¨æ˜¯å®ç°ç³»ç»Ÿè°ƒç”¨çš„å‚æ•°æå–ï¼Œå¤„ç†å’Œç»“æœè¿”å›ã€‚\n[SYS_mkdir] sys_mkdir, [SYS_close] sys_close, [SYS_trace] sys_trace}; æŒ‰ç…§å‚æ•°é¡ºåºä¿å­˜æ¯ä¸ªç³»ç»Ÿè°ƒç”¨çš„åç§°ï¼Œä¾¿äºè°ƒè¯•å’Œè¾“å‡ºã€‚\nchar *sys_name[] = { \u0026#34;fork\u0026#34;, \u0026#34;exit\u0026#34;, \u0026#34;wait\u0026#34;, \u0026#34;pipe\u0026#34;, \u0026#34;read\u0026#34;, \u0026#34;kill\u0026#34;, \u0026#34;exec\u0026#34;, \u0026#34;fstat\u0026#34;, \u0026#34;chdir\u0026#34;, \u0026#34;dup\u0026#34;, \u0026#34;getpid\u0026#34;, \u0026#34;sbrk\u0026#34;, \u0026#34;sleep\u0026#34;, \u0026#34;uptime\u0026#34;, \u0026#34;open\u0026#34;, \u0026#34;write\u0026#34;, \u0026#34;mknod\u0026#34;, \u0026#34;unlink\u0026#34;, \u0026#34;link\u0026#34;, \u0026#34;mkdir\u0026#34;, \u0026#34;close\u0026#34;, \u0026#34;trace\u0026#34;}; åœ¨syscallå‡½æ•°ä¸­æ·»åŠ å¯¹åº”çš„é€»è¾‘ï¼šå¦‚æœtracemaskå‚æ•°å¯¹åº”éœ€è¦è¾“å‡ºå¯¹åº”çš„system callï¼Œ åˆ™åœ¨è°ƒç”¨ä¹‹åæ ¹æ®tracemaskæ‰“å°è¾“å‡ºã€‚\nif (num \u0026gt; 0 \u0026amp;\u0026amp; num \u0026lt; NELEM(syscalls) \u0026amp;\u0026amp; syscalls[num]) { p-\u0026gt;trapframe-\u0026gt;a0 = syscalls[num](); if (p-\u0026gt;tracemask \u0026gt;\u0026gt; (num) \u0026amp; 0x01 == 1) { printf(\u0026#34;%d: syscall %s -\u0026gt; %d\\n\u0026#34;, p-\u0026gt;pid, sys_name[num - 1], p-\u0026gt;trapframe-\u0026gt;a0); } } ~/project/xv6-labs-2020/kernel/syscall.h #define SYS_mkdir 20 #define SYS_close 21 #define SYS_trace 22 ~/project/xv6-labs-2020/kernel/sysproc.c å½“å‘½ä»¤è¡Œè¾“å…¥å‘½ä»¤åæ‰§è¡Œæ­¤å‡½æ•°\nuint64 sys_trace(void) { int n; argint(0, \u0026amp;n); myproc()-\u0026gt;tracemask = n; return 0; } ~/project/xv6-labs-2020/user/user.h int sleep(int); int uptime(void); int trace(int); Sysinfo (moderate) å®ç°sysinfoï¼ŒåŒæ—¶é‡æ„ä¸Šé¢çš„ trace\n~/project/xv6-labs-2020/Makefile $U/_sysinfotest\\ ~/project/xv6-labs-2020/kernel/defs.h // sysinfo.c int process_number(); int amount_free_memory(void); ~/project/xv6-labs-2020/kernel/kalloc.c // get free memory int amount_free_memory(void){ struct run *r; r = kmem.freelist; int cnt = 0; for (; r; r = r-\u0026gt;next) { cnt++; } return cnt*PGSIZE; } ~/project/xv6-labs-2020/kernel/proc.c #include \u0026#34;sysinfo.h\u0026#34; ~/project/xv6-labs-2020/kernel/proc.h char name[16]; // Process name (debugging) int tracemask; // Trace memory }; struct sysinfo; int trace(int mask); void gather_sysinfo(struct sysinfo *info); ~/project/xv6-labs-2020/kernel/syscall.c [SYS_trace] sys_trace, [SYS_sysinfo] sys_sysinfo }; \u0026#34;close\u0026#34;, \u0026#34;trace\u0026#34;, \u0026#34;sysinfo\u0026#34; }; extern uint64 sys_uptime(void); extern uint64 sys_trace(void); extern uint64 sys_sysinfo(void); ~/project/xv6-labs-2020/kernel/syscall.h #define SYS_close 21 #define SYS_trace 22 #define SYS_sysinfo 23 ~/project/xv6-labs-2020/kernel/sysproc.c #include \u0026#34;sysinfo.h\u0026#34; ~/project/xv6-labs-2020/user/user.h struct rtcdate; struct sysinfo; ~/project/xv6-labs-2020/user/usys.pl entry(\u0026#34;uptime\u0026#34;); entry(\u0026#34;trace\u0026#34;); entry(\u0026#34;sysinfo\u0026#34;); ","permalink":"https://kennems.github.io/posts/tech/mit6.s0813-os-organization/","summary":"MIT6.S081(3)-OS organization Lecture Topic: OS design â€‹ system calls â€‹ micro/monolithic kernel First system call in xv6 OS picture apps: sh, echo, \u0026hellip; system call interface (open, close,\u0026hellip;) OS Goal of OS run multiple applications isolate them multiplex them share Strawman design: No OS Application directly interacts with hardware CPU cores \u0026amp; registers DRAM chips Disk blocks \u0026hellip; OS library perhaps abstracts some of it Strawman design not conducive to","title":"MIT6.S081(3)-OS organization"},{"content":"Kotlinåç¨‹(4) Kotlinå®è·µéƒ¨åˆ†\nFlowä¸æ–‡ä»¶ä¸‹è½½åº”ç”¨ DownloadFragment.kt // DownloadFragment æ˜¯ä¸€ä¸ª Fragment ç±»ï¼Œç”¨äºå¤„ç†æ–‡ä»¶ä¸‹è½½ä»»åŠ¡ class DownloadFragment : Fragment() { // å®šä¹‰ä¸‹è½½æ–‡ä»¶çš„ URL åœ°å€ï¼Œè¿™æ˜¯ä¸€ä¸ªé™æ€çš„å¸¸é‡ val URL = \u0026#34;https://ts1.cn.mm.bing.net/th/id/R-C.56ab5704680b6574c1b3c0a52643d8b5?rik=P8OAzrJEZS%2biuw\u0026amp;riu=http%3a%2f%2fjourneyz.co%2fwp-content%2fuploads%2f2019%2f09%2fGolden-Gate-Bridge.jpg\u0026amp;ehk=WX9eb2rUUjWBLLrsG2MQZLOMk2wtreV%2bT1Qq1tARk4s%3d\u0026amp;risl=\u0026amp;pid=ImgRaw\u0026amp;r=0\u0026#34; // å»¶è¿Ÿåˆå§‹åŒ– mBindingï¼Œè¿™æ˜¯ä¸€ä¸ª FragmentDownloadBinding å¯¹è±¡ï¼Œç”¨äºç»‘å®š XML å¸ƒå±€æ–‡ä»¶ private val mBinding: FragmentDownloadBinding by lazy { FragmentDownloadBinding.inflate(layoutInflater) } // é‡å†™ onCreateView æ–¹æ³•ï¼Œåœ¨ Fragment åˆ›å»ºè§†å›¾æ—¶è°ƒç”¨ override fun onCreateView( inflater: LayoutInflater, container: ViewGroup?, savedInstanceState: Bundle? ): View? { // è¿”å›ç»‘å®šçš„æ ¹è§†å›¾ä½œä¸º Fragment çš„ç•Œé¢ return mBinding.root } // é‡å†™ onActivityCreated æ–¹æ³•ï¼Œå½“ä¸ Fragment ç›¸å…³çš„æ´»åŠ¨çš„ onCreate æ–¹æ³•å®Œæˆæ—¶è°ƒç”¨ @RequiresApi(Build.VERSION_CODES.UPSIDE_DOWN_CAKE) override fun onActivityCreated(savedInstanceState: Bundle?) { super.onActivityCreated(savedInstanceState) // ä½¿ç”¨ lifecycleScope å¯åŠ¨åç¨‹ï¼Œå½“ Fragment çš„ç”Ÿå‘½å‘¨æœŸå¤„äº Created çŠ¶æ€æ—¶æ‰§è¡Œ lifecycleScope.launchWhenCreated { // è·å–ä¸Šä¸‹æ–‡å¹¶æ‰§è¡Œä¸‹è½½æ“ä½œ context?.apply { // æŒ‡å®šä¸‹è½½æ–‡ä»¶çš„å­˜å‚¨ä½ç½®ï¼Œä¿å­˜åœ¨åº”ç”¨çš„å¤–éƒ¨æ–‡ä»¶ç›®å½•ä¸‹ val file = File(getExternalFilesDir(null)?.path, \u0026#34;pic.jpg\u0026#34;) // å¼€å§‹ä¸‹è½½æ–‡ä»¶ï¼Œå¹¶æ”¶é›†ä¸‹è½½çŠ¶æ€ DownloadManager.download(URL, file).collect { status -\u0026gt; when (status) { // å¦‚æœä¸‹è½½è¿‡ç¨‹ä¸­æœ‰è¿›åº¦æ›´æ–° is DownloadStatus.Progress -\u0026gt; { mBinding.apply { // æ›´æ–°è¿›åº¦æ¡å’Œè¿›åº¦æ–‡æœ¬ progressBar.progress = status.value tvProgress.text = \u0026#34;${status.value}%\u0026#34; } } // å¦‚æœä¸‹è½½è¿‡ç¨‹ä¸­å‡ºç°é”™è¯¯ is DownloadStatus.Error -\u0026gt; { Toast.makeText(context, \u0026#34;ä¸‹è½½é”™è¯¯\u0026#34;, Toast.LENGTH_SHORT).show() } // å¦‚æœä¸‹è½½å®Œæˆ is DownloadStatus.Done -\u0026gt; { mBinding.apply { // è®¾ç½®è¿›åº¦æ¡åˆ° 100%ï¼Œå¹¶æ›´æ–°æ–‡æœ¬ä¸º 100% progressBar.progress = 100 tvProgress.text = \u0026#34;100%\u0026#34; } Toast.makeText(context, \u0026#34;ä¸‹è½½å®Œæˆ\u0026#34;, Toast.LENGTH_SHORT).show() } // å¤„ç†å…¶ä»–å¯èƒ½çš„ä¸‹è½½çŠ¶æ€ else -\u0026gt; { Log.d(\u0026#34;Kennem\u0026#34;, \u0026#34;ä¸‹è½½å¤±è´¥\u0026#34;) } } } } } } } DownloadManager.kt object DownloadManager { /** * ä¸‹è½½æŒ‡å®šçš„æ–‡ä»¶å¹¶è¿”å›ä¸‹è½½çŠ¶æ€çš„æµï¼ˆFlowï¼‰ã€‚ * * @param url æ–‡ä»¶ä¸‹è½½çš„ URL åœ°å€ã€‚ * @param file ä¸‹è½½åä¿å­˜çš„æœ¬åœ°æ–‡ä»¶ã€‚ * @return ä¸‹è½½çŠ¶æ€çš„ Flowï¼ŒåŒ…å«ä¸‹è½½è¿›åº¦ã€å®ŒæˆçŠ¶æ€æˆ–é”™è¯¯ä¿¡æ¯ã€‚ */ @RequiresApi(Build.VERSION_CODES.UPSIDE_DOWN_CAKE) fun download(url: String, file: File): Flow\u0026lt;DownloadStatus\u0026gt; { return flow { // æ„å»º HTTP è¯·æ±‚å¯¹è±¡ val request = Request.Builder().url(url).get().build() // æ‰§è¡Œ HTTP è¯·æ±‚ï¼Œè·å–å“åº” val response = OkHttpClient.Builder().build().newCall(request).execute() // æ£€æŸ¥å“åº”æ˜¯å¦æˆåŠŸ if (response.isSuccessful) { response.body()!!.let { body -\u0026gt; // è·å–å†…å®¹çš„æ€»é•¿åº¦ï¼ˆå­—èŠ‚æ•°ï¼‰ val total = body.contentLength() // ä½¿ç”¨è¾“å‡ºæµå°†ä¸‹è½½çš„æ•°æ®å†™å…¥æœ¬åœ°æ–‡ä»¶ file.outputStream().use { output -\u0026gt; val input = body.byteStream() // è·å–è¾“å…¥æµ var emittedProgress = 0L // è®°å½•å·²å‘å‡ºçš„è¿›åº¦ // å°†è¾“å…¥æµä¸­çš„æ•°æ®å¤åˆ¶åˆ°è¾“å‡ºæµï¼ŒåŒæ—¶è·Ÿè¸ªå¤åˆ¶çš„å­—èŠ‚æ•° input.copyTo(output) { bytesCopied -\u0026gt; // è®¡ç®—å½“å‰è¿›åº¦ç™¾åˆ†æ¯” val progress = bytesCopied * 100 / total // æ¯å½“è¿›åº¦æ¯”ä¸Šæ¬¡æ›´æ–°å¤š5%ä»¥ä¸Šæ—¶ï¼Œå‘å‡ºè¿›åº¦æ›´æ–° if (progress - emittedProgress \u0026gt; 5) { delay(100) // æ¨¡æ‹Ÿç½‘ç»œå»¶è¿Ÿï¼ˆå¯é€‰ï¼‰ emit(DownloadStatus.Progress(progress.toInt())) // å‘å‡ºè¿›åº¦çŠ¶æ€ emittedProgress = progress // æ›´æ–°å·²å‘å‡ºçš„è¿›åº¦ } } } } // ä¸‹è½½å®Œæˆï¼Œå‘å‡ºå®ŒæˆçŠ¶æ€ emit(DownloadStatus.Done(file)) } else { // å¦‚æœå“åº”å¤±è´¥ï¼ŒæŠ›å‡ºå¼‚å¸¸ throw IOException(response.toString()) } }.catch { // å¦‚æœå‘ç”Ÿé”™è¯¯ï¼Œåˆ é™¤éƒ¨åˆ†ä¸‹è½½çš„æ–‡ä»¶å¹¶å‘å‡ºé”™è¯¯çŠ¶æ€ file.delete() emit(DownloadStatus.Error(it)) }.flowOn(Dispatchers.IO) // åœ¨ IO çº¿ç¨‹ä¸Šè¿è¡Œä¸‹è½½æµç¨‹ } } DownloadStatus.kt /** * å°é—­ç±»ï¼Œç”¨äºè¡¨ç¤ºä¸‹è½½è¿‡ç¨‹ä¸­çš„ä¸åŒçŠ¶æ€ã€‚ * å°é—­ç±»å…è®¸å®šä¹‰ä¸€ä¸ªæœ‰é™çš„ç±»å‹é›†åˆï¼Œåœ¨ä½¿ç”¨ `when` è¡¨è¾¾å¼æ—¶æä¾›å…¨é¢çš„ç±»å‹æ£€æŸ¥ã€‚ */ sealed class DownloadStatus { /** * è¡¨ç¤ºåˆå§‹çŠ¶æ€ï¼Œå³å°šæœªå¼€å§‹ä¸‹è½½ã€‚ * å¯ä»¥ç”¨äºåˆå§‹åŒ–æˆ–é‡ç½®çŠ¶æ€ã€‚ */ object None : DownloadStatus() /** * è¡¨ç¤ºæ­£åœ¨è¿›è¡Œçš„ä¸‹è½½çš„è¿›åº¦ã€‚ * @param value ä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºå½“å‰çš„è¿›åº¦ç™¾åˆ†æ¯”ï¼ˆ0-100ï¼‰ã€‚ */ data class Progress(val value: Int) : DownloadStatus() /** * è¡¨ç¤ºä¸‹è½½è¿‡ç¨‹ä¸­å‘ç”Ÿçš„é”™è¯¯ã€‚ * @param throwable å¼•å‘å¤±è´¥çš„å¼‚å¸¸æˆ–é”™è¯¯ã€‚ */ data class Error(val throwable: Throwable) : DownloadStatus() /** * è¡¨ç¤ºä¸‹è½½æˆåŠŸå®Œæˆã€‚ * @param file ä¸‹è½½å®Œæˆçš„æ–‡ä»¶ã€‚ */ data class Done(val file: File) : DownloadStatus() } Flowä¸Roomçš„åº”ç”¨ UserFragment.kt /** * `UserViewModel` ç»§æ‰¿è‡ª `AndroidViewModel`ï¼Œç”¨äºç®¡ç†ç”¨æˆ·æ•°æ®çš„è§†å›¾æ¨¡å‹ã€‚ * `AndroidViewModel` æä¾›äº†å¯¹åº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡çš„è®¿é—®ã€‚ * * @param app åº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡ã€‚ */ class UserViewModel(app: Application) : AndroidViewModel(app) { /** * æ’å…¥ä¸€ä¸ªæ–°çš„ç”¨æˆ·åˆ°æ•°æ®åº“ä¸­ã€‚ * è¿™ä¸ªæ–¹æ³•ä¼šåœ¨ `viewModelScope` ä¸­å¼‚æ­¥æ‰§è¡Œã€‚ * `viewModelScope` æ˜¯ `ViewModel` æä¾›çš„åç¨‹ä½œç”¨åŸŸï¼Œå¯ä»¥è‡ªåŠ¨å–æ¶ˆä»»åŠ¡ã€‚ * * @param uid ç”¨æˆ· IDã€‚ * @param firstName ç”¨æˆ·çš„åå­—ã€‚ * @param lastName ç”¨æˆ·çš„å§“æ°ã€‚ */ fun insert(uid: String, firstName: String, lastName: String) { viewModelScope.launch { // è·å–åº”ç”¨æ•°æ®åº“å®ä¾‹å¹¶æ‰§è¡Œæ’å…¥æ“ä½œ AppDatabase.getInstance(getApplication()) .userDao() .insert(User(uid.toInt(), firstName, lastName)) // æ‰“å°æ—¥å¿—ï¼Œä¾¿äºè°ƒè¯• Log.d(\u0026#34;Kennem\u0026#34;, \u0026#34;insert user: $uid\u0026#34;) } } /** * è·å–æ‰€æœ‰ç”¨æˆ·çš„æµã€‚ * è¿”å›ä¸€ä¸ª `Flow` å¯¹è±¡ï¼Œå®ƒå…è®¸å¼‚æ­¥åœ°è·å–æ•°æ®å¹¶è§‚å¯Ÿæ•°æ®å˜åŒ–ã€‚ * * @return è¿”å›ä¸€ä¸ª `Flow` å¯¹è±¡ï¼Œå…¶ä¸­åŒ…å«ç”¨æˆ·åˆ—è¡¨ã€‚ */ fun getAll(): Flow\u0026lt;List\u0026lt;User\u0026gt;\u0026gt; { return AppDatabase.getInstance(getApplication()) .userDao() .getAll() .catch { e -\u0026gt; // æ•è·å¹¶æ‰“å°æµä¸­çš„å¼‚å¸¸ e.printStackTrace() } .flowOn(Dispatchers.IO) // åœ¨ IO çº¿ç¨‹ä¸­æ‰§è¡Œæ•°æ®åº“æ“ä½œ } } User.kt @Entity(tableName = \u0026#34;user\u0026#34;) data class User( @PrimaryKey(autoGenerate = true) val uid: Int = 0, @ColumnInfo(name = \u0026#34;first_name\u0026#34;) val firstName: String, @ColumnInfo(name = \u0026#34;last_name\u0026#34;) val lastName: String ) UserDao.kt @Dao interface UserDao{ @Insert(onConflict = OnConflictStrategy.REPLACE) suspend fun insert(user: User) @Query(\u0026#34;SELECT * FROM user\u0026#34;) fun getAll(): Flow\u0026lt;List\u0026lt;User\u0026gt;\u0026gt; } AppDatabase.kt /** * Room æ•°æ®åº“ç±»ï¼Œç”¨äºå®šä¹‰æ•°æ®åº“åŠå…¶ç‰ˆæœ¬ã€‚ * Room æ˜¯ Android çš„æŒä¹…æ€§åº“ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªæŠ½è±¡å±‚ï¼Œæ–¹ä¾¿ä½¿ç”¨ SQLite æ•°æ®åº“ã€‚ * * @param entities æ•°æ®åº“ä¸­çš„å®ä½“ç±»ã€‚è¿™é‡Œå®šä¹‰äº† `User` å®ä½“ç±»ã€‚ * @param version æ•°æ®åº“çš„ç‰ˆæœ¬å·ã€‚å½“å®ä½“ç±»ç»“æ„å‘ç”Ÿå˜åŒ–æ—¶ï¼Œç‰ˆæœ¬å·éœ€è¦é€’å¢ã€‚ * @param exportSchema æ˜¯å¦å¯¼å‡ºæ•°æ®åº“æ¨¡å¼åˆ°ä¸€ä¸ª JSON æ–‡ä»¶ã€‚è¿™é‡Œè®¾ç½®ä¸º falseï¼Œè¡¨ç¤ºä¸å¯¼å‡ºã€‚ */ @Database(entities = [User::class], version = 1, exportSchema = false) abstract class AppDatabase : RoomDatabase() { /** * è·å– UserDao çš„å®ä¾‹ã€‚ * DAOï¼ˆæ•°æ®è®¿é—®å¯¹è±¡ï¼‰ç”¨äºå®šä¹‰å¯¹æ•°æ®åº“çš„æ“ä½œã€‚ * * @return UserDao å®ä¾‹ï¼Œç”¨äºæ‰§è¡Œæ•°æ®åº“æ“ä½œã€‚ */ abstract fun userDao(): UserDao companion object { @Volatile private var instance: AppDatabase? = null /** * è·å–æ•°æ®åº“å®ä¾‹çš„æ–¹æ³•ã€‚ * å¦‚æœå®ä¾‹ä¸å­˜åœ¨ï¼Œåˆ™åŒæ­¥åˆ›å»ºä¸€ä¸ªæ–°å®ä¾‹ï¼Œå¹¶è¿›è¡Œåˆå§‹åŒ–ã€‚ * * @param context åº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡ï¼Œç”¨äºåˆ›å»ºæ•°æ®åº“ã€‚ * @return AppDatabase çš„å•ä¾‹å®ä¾‹ã€‚ */ fun getInstance(context: Context): AppDatabase { // æ£€æŸ¥ç°æœ‰çš„å®ä¾‹ return instance ?: synchronized(this) { // åŒé‡æ£€æŸ¥é”å®šï¼ˆDouble-Checked Lockingï¼‰ val newInstance = Room.databaseBuilder( context.applicationContext, AppDatabase::class.java, \u0026#34;app_database\u0026#34; ).build() instance = newInstance newInstance } } } } UserAdapter.kt // UserAdapter æ˜¯ä¸€ä¸ªç»§æ‰¿è‡ª RecyclerView.Adapter çš„é€‚é…å™¨ç±»ï¼Œç”¨äºåœ¨ RecyclerView ä¸­æ˜¾ç¤º User æ•°æ®ã€‚ class UserAdapter(private val context: Context) : RecyclerView.Adapter\u0026lt;BindingViewHolder\u0026gt;() { // data ç”¨äºå­˜å‚¨è¦æ˜¾ç¤ºçš„ User æ•°æ®çš„ ArrayListã€‚ private val data = ArrayList\u0026lt;User\u0026gt;() /** * ç”¨äºæ›´æ–°é€‚é…å™¨çš„æ•°æ®ã€‚ * @param data è¦è®¾ç½®çš„æ–°æ•°æ®åˆ—è¡¨ã€‚ */ @SuppressLint(\u0026#34;NotifyDataSetChanged\u0026#34;) fun setData(data: List\u0026lt;User\u0026gt;) { // æ‰“å°æ—¥å¿—ä»¥æŸ¥çœ‹ setData æ–¹æ³•è°ƒç”¨æ—¶ä¼ é€’çš„æ•°æ®ã€‚ Log.d(\u0026#34;Kennem\u0026#34;, \u0026#34;setData called with data: $data\u0026#34;) // æ¸…ç©ºå½“å‰æ•°æ®å¹¶æ·»åŠ æ–°çš„æ•°æ®ã€‚ this.data.clear() this.data.addAll(data) // é€šçŸ¥é€‚é…å™¨æ•°æ®å·²æ›´æ”¹ï¼Œåˆ·æ–°è§†å›¾ã€‚ notifyDataSetChanged() } /** * åˆ›å»ºæ–°çš„ ViewHolder å¯¹è±¡ã€‚ * @param parent ViewGroup çˆ¶è§†å›¾ï¼Œç”¨äºåœ¨å…¶ä¸­æ·»åŠ æ–°è§†å›¾ã€‚ * @param viewType è§†å›¾ç±»å‹ã€‚ * @return è¿”å›ä¸€ä¸ªæ–°çš„ BindingViewHolder å¯¹è±¡ã€‚ */ override fun onCreateViewHolder(parent: ViewGroup, viewType: Int): BindingViewHolder { // ä½¿ç”¨æŒ‡å®šçš„ä¸Šä¸‹æ–‡å¯¹è±¡é€šè¿‡å¸ƒå±€è§£æå™¨åŠ è½½å¸ƒå±€å¹¶ç»‘å®šåˆ° ViewHolderã€‚ val binding = ItemUserBinding.inflate(LayoutInflater.from(context), parent, false) return BindingViewHolder(binding = binding) } /** * è¿”å› RecyclerView ä¸­æ•°æ®é¡¹çš„æ€»æ•°ã€‚ * @return æ•°æ®é¡¹çš„æ€»æ•°ã€‚ */ override fun getItemCount() = data.size /** * ç»‘å®š ViewHolder ä¸­çš„è§†å›¾æ•°æ®ã€‚ * @param holder BindingViewHolder å½“å‰ ViewHolderã€‚ * @param position å½“å‰æ•°æ®é¡¹çš„ä½ç½®ã€‚ */ @SuppressLint(\u0026#34;SetTextI18n\u0026#34;) override fun onBindViewHolder(holder: BindingViewHolder, position: Int) { // æ ¹æ®å½“å‰çš„ position è·å–å¯¹åº”çš„ User å¯¹è±¡ã€‚ val item = data[position] // å°† ViewHolder çš„ç»‘å®šå¯¹è±¡è½¬æ¢ä¸º ItemUserBinding ç±»å‹ã€‚ val binding = holder.binding as ItemUserBinding // è®¾ç½®æ–‡æœ¬è§†å›¾ï¼Œæ˜¾ç¤ºç”¨æˆ·çš„ idã€åå­—å’Œå§“æ°ã€‚ binding.text.text = \u0026#34;id: ${item.uid}, Name: ${item.firstName}, ${item.lastName}\u0026#34; } } Flowä¸Retrofitçš„åº”ç”¨ ArticleFragment.kt class ArticleFragment : Fragment() { // ä½¿ç”¨ viewModels å§”æ‰˜å±æ€§è·å– ArticleViewModel å®ä¾‹ private val viewModel by viewModels\u0026lt;ArticleViewModel\u0026gt;() // å»¶è¿Ÿåˆå§‹åŒ– FragmentArticleBinding å®ä¾‹ï¼Œç”¨äºç»‘å®šå¸ƒå±€ private val mBinding: FragmentArticleBinding by lazy { FragmentArticleBinding.inflate(layoutInflater) } // åˆ›å»ºè§†å›¾æ—¶è¿”å›ç»‘å®šçš„æ ¹è§†å›¾ override fun onCreateView( inflater: LayoutInflater, container: ViewGroup?, savedInstanceState: Bundle? ): View? { return mBinding.root } // æ‰©å±•å‡½æ•°ï¼šä¸º TextView åˆ›å»ºä¸€ä¸ª Flow ä»¥å“åº”æ–‡æœ¬å˜åŒ– private fun TextView.textWatcherFlow(): Flow\u0026lt;String\u0026gt; = callbackFlow { // åˆ›å»ºä¸€ä¸ª TextWatcher å¯¹è±¡ä»¥ç›‘å¬æ–‡æœ¬å˜åŒ– val textWatcher = object : TextWatcher { override fun beforeTextChanged( s: CharSequence?, start: Int, count: Int, after: Int ) { // åœ¨æ–‡æœ¬å˜åŒ–ä¹‹å‰çš„å›è°ƒï¼Œè¿™é‡Œæ— éœ€å¤„ç† } override fun onTextChanged(s: CharSequence?, start: Int, before: Int, count: Int) { // åœ¨æ–‡æœ¬å˜åŒ–æ—¶çš„å›è°ƒï¼Œè¿™é‡Œæ— éœ€å¤„ç† } override fun afterTextChanged(s: Editable?) { // åœ¨æ–‡æœ¬å˜åŒ–åå‘é€æ–°æ–‡æœ¬åˆ° Flow this@callbackFlow.trySend(s.toString()).isSuccess } } // å°† TextWatcher æ·»åŠ åˆ° TextView addTextChangedListener(textWatcher) // å½“ Flow å…³é—­æ—¶ï¼Œç§»é™¤ TextWatcher awaitClose { removeTextChangedListener(textWatcher) } } // åœ¨ Activity åˆ›å»ºæ—¶æ‰§è¡Œçš„æ“ä½œ override fun onActivityCreated(savedInstanceState: Bundle?) { super.onActivityCreated(savedInstanceState) // å¯åŠ¨ä¸€ä¸ªåç¨‹æ¥æ”¶é›†æ–‡æœ¬å˜åŒ–å¹¶æœç´¢æ–‡ç«  lifecycleScope.launchWhenCreated { mBinding.etSearch.textWatcherFlow().collect { Log.d(\u0026#34;Kennem\u0026#34;, \u0026#34;onActivityCreated: æ”¶åˆ°æ–‡æœ¬å˜åŒ–ï¼š$it\u0026#34;) viewModel.searchArticles(it) } } // é…ç½® RecyclerView é€‚é…å™¨å’Œå¸ƒå±€ç®¡ç†å™¨ context?.let { val adapter = ArticleAdapter(it) mBinding.recyclerView.adapter = adapter mBinding.recyclerView.layoutManager = LinearLayoutManager(context) // è§‚å¯Ÿæ–‡ç« åˆ—è¡¨å˜åŒ–å¹¶æ›´æ–°é€‚é…å™¨çš„æ•°æ® viewModel.articles.observe(viewLifecycleOwner) { articles -\u0026gt; adapter.setData(articles) } } } } ArticleViewModel.kt /** * `ArticleViewModel` ç»§æ‰¿è‡ª `AndroidViewModel`ï¼Œç”¨äºç®¡ç†ä¸æ–‡ç« ç›¸å…³çš„è§†å›¾æ¨¡å‹ã€‚ * `AndroidViewModel` æä¾›äº†å¯¹åº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡çš„è®¿é—®ã€‚ * * @param app åº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡ã€‚ */ class ArticleViewModel(app: Application) : AndroidViewModel(app) { /** * ä½¿ç”¨ `MutableLiveData` æ¥ä¿å­˜å’Œè§‚å¯Ÿæ–‡ç« æ•°æ®ã€‚ * `MutableLiveData` å…è®¸å¯¹æ•°æ®è¿›è¡Œä¿®æ”¹ï¼Œå¹¶é€šçŸ¥è§‚å¯Ÿè€…æ•°æ®å˜åŒ–ã€‚ */ val articles = MutableLiveData\u0026lt;ResponseBody\u0026gt;() /** * æ ¹æ®ç»™å®šçš„å…³é”®å­—æœç´¢æ–‡ç« ã€‚ * ä½¿ç”¨åç¨‹å’Œæµæ¥è¿›è¡Œå¼‚æ­¥ç½‘ç»œè¯·æ±‚å¹¶å¤„ç†ç»“æœã€‚ * * @param key æœç´¢å…³é”®å­—ã€‚ */ fun searchArticles(key: String) { viewModelScope.launch { flow { // å‘èµ·ç½‘ç»œè¯·æ±‚è·å–æ–‡ç« æ•°æ® val list = RetrofitClient.articleApi.searchArticles(key) // å°†è·å–çš„ç»“æœå‘å°„åˆ°æµä¸­ emit(list) } .flowOn(Dispatchers.IO) // åœ¨ IO çº¿ç¨‹ä¸­æ‰§è¡Œç½‘ç»œè¯·æ±‚ .catch { e -\u0026gt; // æ•è·å¹¶æ‰“å°æµä¸­çš„å¼‚å¸¸ e.printStackTrace() } .collect { // æ›´æ–° LiveData çš„å€¼ï¼Œä»¥ä¾¿ UI å¯ä»¥è§‚å¯Ÿåˆ°å˜åŒ– articles.value = it } } } } RetrofitClient.kt object RetrofitClient { private val instance: Retrofit by lazy { Retrofit .Builder() .client(OkHttpClient.Builder().build()) .baseUrl(\u0026#34;https://www.bing.com/\u0026#34;) .build() } val articleApi: ArticleApi by lazy { instance.create(ArticleApi::class.java) } } ArticleApi.kt interface ArticleApi { @GET(\u0026#34;search\u0026#34;) suspend fun searchArticles( @Query(\u0026#34;q\u0026#34;) key : String ): ResponseBody } ArticleAdapter.kt class ArticleAdapter(private val context: Context) : RecyclerView.Adapter\u0026lt;BindingViewHolder\u0026gt;() { // ç”¨äºå­˜å‚¨ ResponseBody å¯¹è±¡åˆ—è¡¨ private val data = ArrayList\u0026lt;String\u0026gt;() // è®¾ç½®æ•°æ®æ—¶ï¼Œå°† ResponseBody è½¬æ¢ä¸ºå­—ç¬¦ä¸² @SuppressLint(\u0026#34;NotifyDataSetChanged\u0026#34;) fun setData(responseBody: ResponseBody) { Log.d(\u0026#34;Kennem\u0026#34;, \u0026#34;setData called with data: $responseBody\u0026#34;) this.data.clear() // å°† ResponseBody è½¬æ¢ä¸ºå­—ç¬¦ä¸²å¹¶æ·»åŠ åˆ°æ•°æ®åˆ—è¡¨ä¸­ this.data.add(responseBody.string()) notifyDataSetChanged() } override fun onCreateViewHolder(parent: ViewGroup, viewType: Int): BindingViewHolder { val binding = ItemUserBinding.inflate(LayoutInflater.from(context), parent, false) return BindingViewHolder(binding = binding) } override fun getItemCount() = data.size @SuppressLint(\u0026#34;SetTextI18n\u0026#34;) override fun onBindViewHolder(holder: BindingViewHolder, position: Int) { val item = data[position] val binding = holder.binding as ItemUserBinding // å°†å­—ç¬¦ä¸²å½¢å¼çš„åŸå§‹å“åº”å†…å®¹æ˜¾ç¤ºåœ¨ TextView ä¸­ binding.text.text = item } } StateFlow ç±»ä¼¼LiveData, å…·æœ‰LiveDatçš„å±æ€§åˆæœ‰Flowçš„æ”¯æŒ\nclass NumberFragment : Fragment() { // ä½¿ç”¨ viewModels å§”æ‰˜å±æ€§è·å– ArticleViewModel å®ä¾‹ private val viewModel by viewModels\u0026lt;NumberViewModel\u0026gt;() // å»¶è¿Ÿåˆå§‹åŒ– FragmentArticleBinding å®ä¾‹ï¼Œç”¨äºç»‘å®šå¸ƒå±€ private val mBinding: FragmentNumberBinding by lazy { FragmentNumberBinding.inflate(layoutInflater) } // Fragmentçš„å¸ƒå±€ç”Ÿæˆå’Œè§†å›¾åˆ›å»º override fun onCreateView( inflater: LayoutInflater, container: ViewGroup?, savedInstanceState: Bundle? ): View? { // è¿”å›ç»‘å®šçš„æ ¹è§†å›¾ return mBinding.root } // åœ¨Activityåˆ›å»ºåè°ƒç”¨ï¼Œç”¨äºåˆå§‹åŒ–è§†å›¾å’Œæ•°æ® override fun onActivityCreated(savedInstanceState: Bundle?) { super.onActivityCreated(savedInstanceState) // ä½¿ç”¨applyä½œç”¨åŸŸå‡½æ•°æ¥ç®€åŒ–ä»£ç  mBinding.apply { // ä¸ºå¢åŠ æŒ‰é’®è®¾ç½®ç‚¹å‡»äº‹ä»¶ç›‘å¬å™¨ btnAdd.setOnClickListener{ // è°ƒç”¨ViewModelçš„incrementå‡½æ•°ï¼Œå¢åŠ è®¡æ•°å€¼ viewModel.increment() } // ä¸ºå‡å°‘æŒ‰é’®è®¾ç½®ç‚¹å‡»äº‹ä»¶ç›‘å¬å™¨ btnMinus.setOnClickListener{ // è°ƒç”¨ViewModelçš„decrementå‡½æ•°ï¼Œå‡å°‘è®¡æ•°å€¼ viewModel.decrement() } } // ä½¿ç”¨lifecycleScopeæ¥ç¡®ä¿åœ¨è§†å›¾åˆ›å»ºæ—¶æ”¶é›†æ•°æ®æµ lifecycleScope.launchWhenCreated { // æ”¶é›†ViewModelä¸­numberçš„çŠ¶æ€æµï¼Œå¹¶åœ¨UIä¸­æ˜¾ç¤º viewModel.number.collect { value -\u0026gt; // å°†å½“å‰çš„æ•°å€¼æ›´æ–°åˆ°TextViewä¸­ mBinding.tvNumber.text = \u0026#34;$value\u0026#34; } } } } ShareFlow ShareFlowä¸ºçƒ­æµï¼Œä¸€ç›´å‘é€ï¼Œå¯ä»¥åœ¨å¤šä¸ªä½ç½®æ¥å—åˆ°å‘é€çš„æµ\nLocalEventBus.kt object LocalEventBus { val events = MutableSharedFlow\u0026lt;Event\u0026gt;() suspend fun postEvent(event: Event){ events.emit(event) } } data class Event(val timestamp: Long) SharedFlowViewModel.kt class SharedFlowViewModel : ViewModel() { private var job: Job? = null fun startRefresh() { // æ£€æŸ¥æ˜¯å¦å·²æœ‰æ­£åœ¨è¿è¡Œçš„ Job if (job?.isActive == true) { return // å¦‚æœå·²å­˜åœ¨ï¼Œç›´æ¥è¿”å› } // å¯åŠ¨æ–°çš„ Job job = viewModelScope.launch(Dispatchers.IO) { while (isActive) { LocalEventBus.postEvent(Event(System.currentTimeMillis())) } } } fun stopRefresh() { job?.cancel() // å–æ¶ˆå½“å‰çš„ Job job = null // å°† job ç½®ä¸ºç©ºï¼Œè¡¨ç¤ºæ²¡æœ‰è¿è¡Œçš„ Job } } SharedFlowFragment.kt class SharedFlowFragment : Fragment() { private val viewModel by viewModels\u0026lt;SharedFlowViewModel\u0026gt;() private val mBinding: FragmentSharedFlowBinding by lazy { FragmentSharedFlowBinding.inflate(layoutInflater) } override fun onCreateView( inflater: LayoutInflater, container: ViewGroup?, savedInstanceState: Bundle? ): View? { return mBinding.root } override fun onActivityCreated(savedInstanceState: Bundle?) { super.onActivityCreated(savedInstanceState) mBinding.apply { btnStart.setOnClickListener { viewModel.startRefresh() } btnEnd.setOnClickListener { viewModel.stopRefresh() } } } } Flowä¸Jetpack Paging3 Paging3 åŠ è½½æ•°æ®æµç¨‹ PageConfig pageSize: æ¯é¡µæ˜¾ç¤ºçš„æ•°æ®çš„å¤§å° prefetchDistanceï¼Œé¢„åˆ·æ–°çš„è·ç¦»ï¼Œè·ç¦»æœ€åä¸€ä¸ªitemå¤šè¿œæ—¶åŠ è½½æ•°æ®ï¼Œé»˜è®¤ä¸ºpageSizeã€‚ initialLoadSizeï¼Œåˆå§‹åŒ–åŠ è½½æ•°é‡ï¼Œé»˜è®¤ä½pageSize * 3 Paging3éƒ¨åˆ† MoviePagingSource.kt // MoviePagingSource ç»§æ‰¿è‡ª PagingSourceï¼Œç”¨äºå®šä¹‰å¦‚ä½•ä»æ•°æ®æºåŠ è½½åˆ†é¡µæ•°æ® class MoviePagingSource : PagingSource\u0026lt;Int, Movie\u0026gt;() { // ç”¨äºè·å–åˆ·æ–°æ•°æ®æ—¶çš„é”®å€¼ override fun getRefreshKey(state: PagingState\u0026lt;Int, Movie\u0026gt;): Int? { // è·å–å½“å‰é”šå®šä½ç½®çš„ç´¢å¼•ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™è¿”å› null val anchorPosition = state.anchorPosition ?: return null // è·å–ä¸é”šå®šä½ç½®æœ€è¿‘çš„ä¸€é¡µ val anchorPage = state.closestPageToPosition(anchorPosition) // å¦‚æœé”šå®šé¡µå­˜åœ¨ä¸”å‰ä¸€é¡µçš„ key å­˜åœ¨ï¼Œåˆ™è¿”å›å‰ä¸€é¡µçš„ key åŠ  1 // å¦åˆ™ï¼Œå¦‚æœä¸‹ä¸€é¡µçš„ key å­˜åœ¨ï¼Œåˆ™è¿”å›ä¸‹ä¸€é¡µçš„ key å‡ 1 return anchorPage?.prevKey?.plus(1) ?: anchorPage?.nextKey?.minus(1) } // å®šä¹‰å¦‚ä½•åŠ è½½æ•°æ® override suspend fun load(params: LoadParams\u0026lt;Int\u0026gt;): LoadResult\u0026lt;Int, Movie\u0026gt; { // å½“å‰è¦åŠ è½½çš„é¡µç ï¼Œå¦‚æœä¸º null åˆ™åŠ è½½ç¬¬ä¸€é¡µ val currentPage = params.key ?: 1 // éœ€è¦åŠ è½½çš„é¡¹ç›®æ•° val pageSize = params.loadSize return try { // ä½¿ç”¨ Retrofit å‘é€ç½‘ç»œè¯·æ±‚è·å–ç”µå½±æ•°æ®ï¼Œä¼ å…¥å½“å‰é¡µç å’Œæ¯é¡µåŠ è½½çš„æ•°é‡ val response = RetrofitClient.createApi(MovieApi::class.java) .getMovies(currentPage, pageSize) // æ‰“å°æ—¥å¿—ï¼Œæ˜¾ç¤ºåŠ è½½çš„é¡µç å’Œè·å–çš„ç”µå½±æ•°é‡ Log.d(\u0026#34;PagingSource\u0026#34;, \u0026#34;Loaded page $currentPage with ${response.movieList.size} items\u0026#34;) // è·å–ç”µå½±åˆ—è¡¨ï¼Œå¦‚æœä¸ºç©ºåˆ™è¿”å›ç©ºåˆ—è¡¨ val movies = response.movieList ?: emptyList() // å¦‚æœå½“å‰é¡µæ˜¯ç¬¬ä¸€é¡µï¼Œåˆ™å‰ä¸€é¡µçš„ key ä¸º nullï¼Œå¦åˆ™ä¸ºå½“å‰é¡µç å‡ 1 val prevKey = if (currentPage == 1) null else currentPage - 1 // å¦‚æœè¿˜æœ‰æ›´å¤šæ•°æ®ï¼Œåˆ™ä¸‹ä¸€é¡µçš„ key ä¸ºå½“å‰é¡µç åŠ  1ï¼Œå¦åˆ™ä¸º null val nextKey = if (response.hasMore) currentPage + 1 else null // è¿”å›åŠ è½½çš„ç»“æœï¼ŒåŒ…æ‹¬æ•°æ®ã€å‰ä¸€é¡µçš„ key å’Œä¸‹ä¸€é¡µçš„ key LoadResult.Page( data = movies, prevKey = prevKey, nextKey = nextKey ) } catch (e: Exception) { // æ•è·å¼‚å¸¸å¹¶æ‰“å°é”™è¯¯æ—¥å¿— Log.e(\u0026#34;PagingSource\u0026#34;, \u0026#34;Error loading page $currentPage\u0026#34;, e) // è¿”å›é”™è¯¯ç»“æœï¼Œä¼ é€’å¼‚å¸¸ä¿¡æ¯ return LoadResult.Error(e) } } } MovieViewModel.kt è´Ÿè´£åˆ†é¡µçš„é…ç½®ä»¥åŠåˆ†é¡µçš„åŠ è½½\n// MovieViewModel ç»§æ‰¿è‡ª ViewModelï¼Œè´Ÿè´£ç®¡ç† UI ç›¸å…³çš„æ•°æ® class MovieViewModel : ViewModel() { // å®šä¹‰ movies å˜é‡ï¼Œä½¿ç”¨ lazy åˆå§‹åŒ–ï¼Œå³åœ¨é¦–æ¬¡è®¿é—®æ—¶æ‰ä¼šåˆå§‹åŒ– // Pager æ˜¯ Paging åº“ä¸­ç”¨äºåˆ†é¡µåŠ è½½æ•°æ®çš„æ ¸å¿ƒç»„ä»¶ private val movies by lazy { Pager( config = PagingConfig( pageSize = 8, // æ¯é¡µåŠ è½½çš„æ•°æ®é‡å¤§å° prefetchDistance = 1, // æå‰é¢„åŠ è½½ä¸‹ä¸€é¡µæ•°æ®çš„è§¦å‘è·ç¦» initialLoadSize = 8 // é¦–æ¬¡åŠ è½½æ—¶åŠ è½½çš„æ•°æ®é‡å¤§å° ), // å®šä¹‰æ•°æ®æºå·¥å‚ï¼Œåˆ›å»º MoviePagingSource å®ä¾‹ï¼Œç”¨äºä»æ•°æ®æºåŠ è½½æ•°æ® pagingSourceFactory = { MoviePagingSource() } ) // flow æ˜¯ä¸€ç§å¼‚æ­¥æ•°æ®æµï¼ŒcachedIn(viewModelScope) å°†æµæ•°æ®ç¼“å­˜åˆ° ViewModel çš„ä½œç”¨åŸŸä¸­ // è¿™æ ·å³ä½¿å±å¹•æ—‹è½¬ï¼Œæ•°æ®ä¹Ÿèƒ½ä¿ç•™ï¼Œä¸éœ€è¦é‡æ–°åŠ è½½ .flow.cachedIn(viewModelScope) } // æš´éœ²ä¸€ä¸ªå…¬å…±æ–¹æ³•ç”¨äºåŠ è½½ç”µå½±æ•°æ®ï¼Œå¹¶è¿”å› Flow\u0026lt;PagingData\u0026lt;Movie\u0026gt;\u0026gt; ç±»å‹çš„æµ fun loadMovie(): Flow\u0026lt;PagingData\u0026lt;Movie\u0026gt;\u0026gt; = movies } NetWrokéƒ¨åˆ† RetrofitClient.kt object RetrofitClient { private val instance: Retrofit by lazy { val interceptor = HttpLoggingInterceptor { Log.d(\u0026#34;Kennem\u0026#34;, \u0026#34;$it\u0026#34;) } interceptor.level = HttpLoggingInterceptor.Level.BODY Retrofit.Builder() .client(OkHttpClient.Builder().addInterceptor(interceptor).build()) .baseUrl(\u0026#34;https://apifoxmock.com/m1/4944163-4601795-default/\u0026#34;) .addConverterFactory(GsonConverterFactory.create()) .build() } fun \u0026lt;T\u0026gt; createApi(clazz: Class\u0026lt;T\u0026gt;): T { // è°ƒç”¨å®ä¾‹çš„ create æ–¹æ³•ï¼Œä¼ å…¥ clazz å‚æ•°ä»¥åˆ›å»ºæ¥å£çš„å®ä¾‹ return instance.create(clazz) as T } } ","permalink":"https://kennems.github.io/posts/tech/kotlin%E5%8D%8F%E7%A8%8B4/","summary":"Kotlinåç¨‹(4) Kotlinå®è·µéƒ¨åˆ† Flowä¸æ–‡ä»¶ä¸‹è½½åº”ç”¨ DownloadFragment.kt // DownloadFragment æ˜¯ä¸€ä¸ª Fragment ç±»ï¼Œç”¨äºå¤„ç†æ–‡ä»¶ä¸‹è½½ä»»åŠ¡ class DownloadFragment : Fragment() { // å®šä¹‰ä¸‹è½½æ–‡ä»¶çš„ URL åœ°å€ï¼Œè¿™æ˜¯","title":"Kotlinåç¨‹(4)"},{"content":"20240823 æ˜ŸæœŸäº” é’å²›å¸‚åŒº Created: 2024/8/25/17:49 Tags: Daily, Personal\nç¾å¥½çš„ä¸€å¤©ï¼\nä»Šå¤©ä¸Šåˆå»ä¿®ç”µè„‘ï¼Œ é”®ç›˜å‡ºäº†äº›é—®é¢˜ï¼Œå¿ƒé‡Œæ²¡æœ‰åº•ï¼Œåˆé€å»çœ‹äº†çœ‹ï¼Œæ—¶é—´è¿˜æ—©ï¼Œè¿˜æ²¡åˆ°åäºŒç‚¹ï¼Œæ­£å¥½å¸¦äº†å­¦ç”Ÿè¯ï¼Œæ‰“ç®—ç©ç©å†å›å»ã€‚\nå°é’å²›â€”â€”ç´å¥³\n","permalink":"https://kennems.github.io/posts/life/20240823-%E6%98%9F%E6%9C%9F%E4%BA%94-%E9%9D%92%E5%B2%9B%E5%B8%82%E5%8C%BA/","summary":"20240823 æ˜ŸæœŸäº” é’å²›å¸‚åŒº Created: 2024/8/25/17:49 Tags: Daily, Personal ç¾å¥½çš„ä¸€å¤©ï¼ ä»Šå¤©ä¸Šåˆå»ä¿®ç”µè„‘ï¼Œ é”®ç›˜å‡ºäº†äº›é—®é¢˜ï¼Œå¿ƒé‡Œæ²¡æœ‰åº•ï¼Œåˆé€å»çœ‹äº†çœ‹ï¼Œæ—¶é—´è¿˜æ—©ï¼Œè¿˜æ²¡åˆ°åäºŒç‚¹ï¼Œæ­£å¥½å¸¦äº†å­¦ç”Ÿè¯ï¼Œæ‰“","title":"20240823 æ˜ŸæœŸäº” é’å²›å¸‚åŒº"},{"content":"Git git ç”± linus å¼€å‘ã€‚\nGitæµç¨‹å›¾ cloneï¼ˆå…‹éš†)ï¼‰ï¼š ä»è¿œç¨‹ä»“åº“ä¸­å…‹éš†ä»£ç åˆ°æœ¬åœ°ä»“åº“ checkoutï¼ˆæ£€å‡ºï¼‰ï¼šä»æœ¬åœ°ä»“åº“ä¸­æ£€å‡ºä¸€ä¸ªä»“åº“åˆ†æ”¯ç„¶åè¿›è¡Œä¿®è®¢ addï¼ˆæ·»åŠ ï¼‰ï¼šåœ¨æäº¤å‰å…ˆå°†ä»£ç æäº¤åˆ°æš‚å­˜åŒº commitï¼ˆæäº¤ï¼‰ï¼šæäº¤åˆ°æœ¬åœ°ä»“åº“ï¼Œæœ¬åœ°ä»“åº“ä¸­ä¿å­˜ä¿®æ”¹çš„å„ä¸ªå†å²ç‰ˆæœ¬ fetchï¼ˆæŠ“å–ï¼‰ï¼šä»è¿œç¨‹åº“ï¼ŒæŠ“å–åˆ°æœ¬åœ°ä»“åº“ï¼Œä¸è¿›è¡Œä»»ä½•çš„åˆå¹¶åŠ¨ä½œï¼Œä¸€èˆ¬æ“ä½œæ¯”è¾ƒå°‘ã€‚ pullï¼ˆæ‹‰å–ï¼‰ï¼šä»è¿œç¨‹åº“æ‹‰åˆ°æœ¬åœ°åº“ï¼Œè‡ªåŠ¨è¿›è¡Œåˆå¹¶ï¼ˆmergeï¼‰ï¼Œç„¶åæ”¾åˆ°å·¥ä½œåŒºï¼Œç›¸å½“äºfetch + merge pushï¼ˆæ¨é€ï¼‰ï¼šä¿®æ”¹å®Œæˆåï¼Œéœ€è¦å’Œå›¢é˜Ÿæˆå‘˜å…±äº«ä»£ç æ—¶ï¼Œå°†ä»£ç æ¨é€åˆ°è¿œç¨‹ä»“åº“ GitåŸºæœ¬é…ç½® git config --global user.name \u0026#34;xxx\u0026#34; git config --global user.email \u0026#34;xxx@gmail.com\u0026#34; git config --global user.name git config --global user.email ç»™ä¸€äº›é•¿å‘½ä»¤èµ·åˆ«åï¼š\nåœ¨ ~/.bashrc ä¸­æ·»åŠ ï¼š\nalias git-log=\u0026#39;git log --pretty=oneline --all --graph --abbrev-commit\u0026#39; alias ll=\u0026#39;ls -al\u0026#39; ä¹‹å source ~/.bashrc ä½¿å…¶ç”Ÿæ•ˆã€‚\nç‰ˆæœ¬åˆ‡æ¢ï¼š git reset --hard commitId æŸ¥çœ‹æ‰€æœ‰æ—¥å¿—ï¼š\ngit reflog åˆ†æ”¯ æŸ¥çœ‹æœ¬åœ°åˆ†æ”¯\ngit branch åˆ›å»ºæœ¬åœ°åˆ†æ”¯\ngit branch åˆ†æ”¯å åˆ‡æ¢åˆ†æ”¯\ngit checkout åˆ†æ”¯å åˆ‡æ¢å¹¶åˆ›å»ºåˆ†æ”¯\ngit checkout -b åˆ†æ”¯å åˆå¹¶åˆ†æ”¯ git merge åˆ é™¤åˆ†æ”¯ åˆ é™¤åˆ†æ”¯æ—¶ï¼Œéœ€è¦åšå„ç§æ£€æŸ¥\ngit branch -d b1 ä¸åšä»»ä½•æ£€æŸ¥ï¼Œå¼ºåˆ¶åˆ é™¤\ngit branch -D b1 è§£å†³å†²çª git merge éœ€è¦åˆå¹¶çš„å·¥ä½œåŒº è¿œç¨‹ä»“åº“ git push -f --set-upstream [è¿œç«¯åç§°[æœ¬åœ°åˆ†æ”¯å][:è¿œç«¯åˆ†æ”¯å]] git remote add origin æº æŸ¥çœ‹æº\ngit remote -v åªæŸ¥çœ‹ origin çš„ URL\ngit remote get-url origin æ›´æ¢æº\ngit remote set-url origin æ–°çš„ä»“åº“åœ°å€ è®¾ç½®æœ¬åœ°åˆ†æ”¯ä¸è¿œç«¯åˆ†æ”¯ç»‘å®š git push --set-upstream origin main è®¾ç½®å¥½ä¹‹åï¼Œç›´æ¥\ngit push å…‹éš† git clone åœ°å€ ä»è¿œç¨‹ä»“åº“æŠ“å–å’Œæ‹‰å– æŠ“å–ï¼Œå°†ä»“åº“é‡Œçš„æ›´æ–°éƒ½æŠ“å–åˆ°æœ¬åœ°ï¼Œä½†ä¸ä¼šè¿›è¡Œåˆå¹¶\ngit fetch [remote name] [branch name] æ‹‰å–ï¼Œå°±æ˜¯å°†è¿œç«¯ä»“åº“çš„ä¿®æ”¹æ‹‰åˆ°æœ¬åœ°å¹¶è‡ªåŠ¨è¿›è¡Œåˆå¹¶ï¼Œç­‰åŒäº fetch + merge\ngit pull [remote name] [branch name] è§£å†³åˆå¹¶å†²çª æ¢å¤ 1. æ¢å¤åˆ°ç‰¹å®šæäº¤ å¦‚æœä½ æƒ³å°†åˆ†æ”¯æ¢å¤åˆ°æŸä¸ªç‰¹å®šçš„æäº¤ï¼ˆå¦‚ abc1234ï¼‰ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š\ngit reset --hard abc1234 è¿™å°†é‡ç½®å½“å‰åˆ†æ”¯åˆ°è¯¥æäº¤ï¼Œå¹¶ä¸”ä¼šä¸¢å¤±è¯¥æäº¤ä¹‹åçš„æ‰€æœ‰æ›´æ”¹ã€‚\n2. è¿˜åŸæœ€è¿‘çš„æäº¤ï¼ˆä½†ä¿ç•™æ›´æ”¹ï¼‰ å¦‚æœä½ æƒ³æ’¤é”€æœ€è¿‘çš„æäº¤ï¼Œä½†ä¿ç•™å·¥ä½œåŒºçš„æ›´æ”¹ï¼Œå¯ä»¥ä½¿ç”¨ï¼š\ngit reset --soft HEAD~1 è¿™ä¼šå°† HEAD ç§»åŠ¨åˆ°ä¸Šä¸€ä¸ªæäº¤ï¼ŒåŒæ—¶ä¿ç•™ä½ çš„æ›´æ”¹åœ¨æš‚å­˜åŒºã€‚\n3. æ¢å¤è¢«åˆ é™¤çš„æäº¤ å¦‚æœä½ éœ€è¦æ¢å¤ä¸€ä¸ªå·²ç»è¢«åˆ é™¤çš„æäº¤ï¼Œå¯ä»¥ä½¿ç”¨ git reflog æŸ¥æ‰¾å¹¶æ¢å¤å®ƒï¼š\ngit reflog æ‰¾åˆ°éœ€è¦æ¢å¤çš„æäº¤å“ˆå¸Œï¼ˆå¦‚ abc1234ï¼‰ï¼Œç„¶åä½¿ç”¨ï¼š\ngit checkout abc1234 æˆ–è€…ï¼Œå¦‚æœä½ æƒ³å°†å½“å‰åˆ†æ”¯ç§»åŠ¨åˆ°è¯¥æäº¤ï¼š\ngit reset --hard abc1234 4. æ’¤é”€æœ€è¿‘çš„æäº¤ï¼ˆä¿æŒæ›´æ”¹ï¼‰ å¦‚æœä½ æƒ³æ’¤é”€æœ€è¿‘çš„æäº¤ï¼Œä½†æƒ³ä¿ç•™æ›´æ”¹åœ¨å·¥ä½œç›®å½•ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ï¼š\ngit revert HEAD è¿™å°†åˆ›å»ºä¸€ä¸ªæ–°çš„æäº¤ï¼Œæ’¤é”€æœ€åä¸€æ¬¡æäº¤çš„æ›´æ”¹ã€‚\nä¿®æ”¹ commit çš„ message 1. ä¿®æ”¹æœ€è¿‘ä¸€æ¬¡çš„ commit message ä½¿ç”¨ --amendï¼š\ngit commit --amend -m \u0026#34;æ–°çš„æäº¤ä¿¡æ¯\u0026#34; è¿™æ¡å‘½ä»¤ä¼šæ›¿æ¢æœ€è¿‘ä¸€æ¬¡çš„ commit messageã€‚\n2. ä¿®æ”¹æ›´æ—©çš„ commit message å¦‚æœéœ€è¦ä¿®æ”¹æ›´æ—©çš„ commit messageï¼Œå¯ä»¥ä½¿ç”¨ rebase å‘½ä»¤ï¼š\nå¯åŠ¨äº¤äº’å¼ rebaseï¼š\ngit rebase -i HEAD~n å…¶ä¸­ n æ˜¯ä½ æƒ³è¦å›æº¯çš„æäº¤æ•°é‡ã€‚\nåœ¨æ‰“å¼€çš„æ–‡æœ¬ç¼–è¾‘å™¨ä¸­æ‰¾åˆ°è¦ä¿®æ”¹çš„ commitï¼Œå°† pick æ”¹ä¸º rewordï¼ˆæˆ– rï¼‰ã€‚\nä¿å­˜å¹¶é€€å‡ºç¼–è¾‘å™¨ï¼Œæ¥ç€ä¼šå¼¹å‡ºä¸€ä¸ªæ–°çš„ç¼–è¾‘å™¨çª—å£ï¼Œä½ å¯ä»¥åœ¨è¿™é‡Œä¿®æ”¹ commit messageã€‚\nä¿å­˜å¹¶å…³é—­ç¼–è¾‘å™¨ï¼Œå®Œæˆå Git å°†ä¼šåº”ç”¨ä¿®æ”¹ã€‚\n","permalink":"https://kennems.github.io/posts/tech/git/","summary":"Git git ç”± linus å¼€å‘ã€‚ Gitæµç¨‹å›¾ cloneï¼ˆå…‹éš†)ï¼‰ï¼š ä»è¿œç¨‹ä»“åº“ä¸­å…‹éš†ä»£ç åˆ°æœ¬åœ°ä»“åº“ checkoutï¼ˆæ£€å‡ºï¼‰ï¼šä»æœ¬åœ°ä»“åº“ä¸­æ£€å‡ºä¸€ä¸ªä»“åº“åˆ†æ”¯ç„¶åè¿›è¡Œ","title":"Git"},{"content":"Kotlinåç¨‹(3) æ“ä½œç¬¦ è¿‡æ¸¡æµæ“ä½œç¬¦ å¯ä»¥ä½¿ç”¨æ“ä½œç¬¦è½¬æ¢ç¬¦ï¼Œå°±åƒä½¿ç”¨é›†åˆä¸åºåˆ—ä¸€æ · è¿‡æ¸¡æ“ä½œç¬¦åº”ç”¨äºä¸Šæ¸¸æµï¼Œå¹¶è¿”å›ä¸‹æ¸¸æµã€‚ è¿™äº›æ“ä½œç¬¦ä¹Ÿæ˜¯å†·æ“ä½œç¬¦ï¼Œå°±åƒæµä¸€æ ·ã€‚è¿™ç±»æ“ä½œç¬¦æœ¬èº«ä¸æ˜¯æŒ‚èµ·å‡½æ•°ã€‚ å®ƒè¿è¡Œçš„é€Ÿåº¦å¾ˆå¿«ï¼Œè¿”å›æ–°çš„è½¬æ¢æµçš„å®šä¹‰ã€‚ transform() // å®šä¹‰ä¸€ä¸ªæŒ‚èµ·å‡½æ•°ï¼Œæ¨¡æ‹Ÿå‘é€è¯·æ±‚å¹¶è¿”å›å“åº” suspend fun performRequest(request: Int): String { delay(1000) // æ¨¡æ‹Ÿç½‘ç»œå»¶è¿Ÿï¼Œå»¶è¿Ÿ 1000 æ¯«ç§’ï¼ˆ1 ç§’ï¼‰ return \u0026#34;response $request\u0026#34; // è¿”å›ä¸€ä¸ªå“åº”å­—ç¬¦ä¸² } // æµ‹è¯•å‡½æ•°ï¼Œä½¿ç”¨ JUnit æµ‹è¯•æ¡†æ¶ @Test fun `test transform flow operator`() = runBlocking { // å°†æ•´æ•°èŒƒå›´è½¬æ¢ä¸º Flow (1..3).asFlow() .transform { request -\u0026gt; // ä½¿ç”¨ transform è¿ç®—ç¬¦è½¬æ¢æµçš„å…ƒç´  emit(\u0026#34;Making request $request\u0026#34;) // å‘å°„ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºæ­£åœ¨å‘é€è¯·æ±‚ emit(performRequest(request)) // å‘å°„ performRequest çš„è¿”å›å€¼ } .collect { v -\u0026gt; // æ”¶é›†æµçš„å…ƒç´  println(v) // æ‰“å°æ”¶é›†åˆ°çš„å…ƒç´  } } take() // å®šä¹‰ä¸€ä¸ªç®€å•çš„ Flowï¼Œäº§ç”Ÿ Int ç±»å‹çš„å€¼ fun numbers() = flow\u0026lt;Int\u0026gt; { try { emit(1) // å‘å°„ç¬¬ä¸€ä¸ªæ•´æ•° 1 emit(2) // å‘å°„ç¬¬äºŒä¸ªæ•´æ•° 2 println(\u0026#34;This line will not execute\u0026#34;) // è¿™ä¸€è¡Œä»£ç ä¸ä¼šè¢«æ‰§è¡Œï¼Œå› ä¸º collect æ“ä½œä¼šæå‰ä¸­æ­¢ Flow emit(3) // å‘å°„ç¬¬ä¸‰ä¸ªæ•´æ•° 3ï¼ˆä¸ä¼šæ‰§è¡Œï¼‰ } finally { // åœ¨ Flow è¢«æ”¶é›†å®Œæˆæˆ–å–æ¶ˆæ—¶æ‰§è¡Œ println(\u0026#34;Finally in numbers\u0026#34;) // æ‰“å° \u0026#34;Finally in numbers\u0026#34;ï¼Œè¡¨ç¤º finally å—çš„æ‰§è¡Œ } } // æµ‹è¯•å‡½æ•°ï¼Œä½¿ç”¨ JUnit æµ‹è¯•æ¡†æ¶ @Test fun `test limit length operator`() = runBlocking { // è°ƒç”¨ numbers å‡½æ•°ï¼Œé™åˆ¶æ”¶é›†çš„å…ƒç´ æ•°é‡ä¸º 2 numbers() .take(2) // ä½¿ç”¨ take è¿ç®—ç¬¦ï¼Œåªæ”¶é›†å‰ 2 ä¸ªå…ƒç´  .collect { v -\u0026gt; // æ”¶é›† Flow ä¸­çš„å…ƒç´  println(v) // æ‰“å°æ¯ä¸ªæ”¶é›†åˆ°çš„å…ƒç´  } } æœ«ç«¯æ“ä½œç¬¦ æœ«ç«¯æ“ä½œç¬¦æ˜¯åœ¨æµä¸Šç”¨äºå¯åŠ¨æµæ”¶é›†çš„æŒ‚èµ·å‡½æ•°ã€‚collectæ˜¯æœ€åŸºç¡€çš„æœ«ç«¯æ“ä½œç¬¦ï¼Œä½†æ˜¯è¿˜æœ‰å¦å¤–ä¸€äº›æ›´æ–¹ä¾¿ä½¿ç”¨çš„æœ«ç«¯æ“ä½œç¬¦ è½¬åŒ–ä¸ºå„ç§é›†åˆï¼Œä¾‹å¦‚toListå’ŒtoSet è·å–ç¬¬ä¸€ä¸ªï¼ˆfirstï¼‰å€¼ä¸ç¡®ä¿æµå‘å°„å•ä¸ªï¼ˆsingleï¼‰å€¼çš„æ“ä½œç¬¦ ä½¿ç”¨reduceä¸foldå°†æµè§„çº¦åˆ°å•ä¸ªå€¼ ç»„åˆå¤šä¸ªæµ å°±åƒKotlinæ ‡å‡†åº“ä¸­çš„Sequence.zipæ‹“å±•å‡½æ•°ä¸€æ ·ï¼Œæµæ‹¥æœ‰ä¸€ä¸ªzipæ“ä½œç¬¦ç”¨äºç»„åˆä¸¤ä¸ªæµä¸­çš„ç›¸å…³å€¼ @Test fun `test zip2`() = runBlocking { // åˆ›å»ºä¸€ä¸ªæ•´æ•°æµï¼Œå‘å°„ 1 åˆ° 3 çš„æ•°å­—ï¼Œæ¯ä¸ªæ•°å­—å‘å°„ä¹‹é—´å»¶è¿Ÿ 300 æ¯«ç§’ val numbs = (1..3).asFlow().onEach { delay(300) // æ¨¡æ‹Ÿå»¶è¿Ÿ } // åˆ›å»ºä¸€ä¸ªå­—ç¬¦ä¸²æµï¼Œå‘å°„ \u0026#34;one\u0026#34;ã€\u0026#34;two\u0026#34; å’Œ \u0026#34;three\u0026#34; çš„å­—ç¬¦ä¸²ï¼Œæ¯ä¸ªå­—ç¬¦ä¸²å‘å°„ä¹‹é—´å»¶è¿Ÿ 400 æ¯«ç§’ val strs = flowOf(\u0026#34;one\u0026#34;, \u0026#34;two\u0026#34;, \u0026#34;three\u0026#34;).onEach { delay(400) // æ¨¡æ‹Ÿå»¶è¿Ÿ } // è®°å½•æµ‹è¯•å¼€å§‹æ—¶é—´ val startTime = System.currentTimeMillis() // ä½¿ç”¨ zip æ“ä½œç¬¦å°†ä¸¤ä¸ªæµçš„å…ƒç´ é…å¯¹ numbs.zip(strs) { a, b -\u0026gt; \u0026#34;$a -\u0026gt; $b\u0026#34; } // å°† numbs å’Œ strs çš„æ¯å¯¹å…ƒç´ ç»„åˆæˆå­—ç¬¦ä¸² .collect { v -\u0026gt; // æ”¶é›†é…å¯¹åçš„å…ƒç´  // æ‰“å°é…å¯¹åçš„å…ƒç´ å’Œä»æµ‹è¯•å¼€å§‹åˆ°å½“å‰æ—¶é—´çš„æ—¶é—´å·® println(\u0026#34;$v, consume time : ${System.currentTimeMillis() - startTime} ms \u0026#34;) } } å±•å¹³æµ æµè¡¨ç¤ºå¼‚æ­¥æ¥æ”¶çš„å€¼åºåˆ—ï¼Œæ‰€ä»¥å¾ˆå®¹æ˜“é‡åˆ°è¿™æ ·çš„æƒ…å†µï¼šæ¯ä¸ªå€¼éƒ½ä¼šè§¦å‘å¯¹å¦ä¸€ä¸ªå€¼åºåˆ—çš„è¯·æ±‚ï¼Œç„¶è€Œï¼Œç”±äºæµå…·æœ‰å¼‚æ­¥çš„æ€§è´¨ï¼Œå› æ­¤éœ€è¦ä¸åŒçš„å±•å¹³æ¨¡å¼ï¼Œä¸ºæ­¤ï¼Œå­˜åœ¨ä¸€ç³»åˆ—çš„æµå±•å¹³æ“ä½œç¬¦ï¼š flatMapConcat è¿æ¥æ¨¡å¼ flatMapMerge åˆå¹¶æ¨¡å¼ flatMapLatest æœ€æ–°å±•å¹³æ¨¡å¼ // ä½¿ç”¨ flatMapConcat æ“ä½œç¬¦çš„æµ‹è¯•å‡½æ•° @Test fun `test flatMapConcat`() = runBlocking\u0026lt;Unit\u0026gt; { val startTime = System.currentTimeMillis() // è®°å½•å¼€å§‹æ—¶é—´ // åˆ›å»ºä¸€ä¸ªæµï¼ŒåŒ…å«æ•°å­— 1 åˆ° 3 (1..3) .asFlow() // å°†æ•°å­—è½¬æ¢ä¸ºæµ .onEach { delay(100) } // åœ¨æ¯ä¸ªå…ƒç´ ä¸Šæ–½åŠ  100 æ¯«ç§’çš„å»¶è¿Ÿ // ä½¿ç”¨ flatMapConcat å°†æ¯ä¸ªå…ƒç´ è½¬æ¢ä¸ºæ–°çš„æµå¹¶ä¸²è” .flatMapConcat { requestFlow(it) } .collect { v -\u0026gt; // æ”¶é›†å¹¶æ‰“å°æ¯ä¸ªå…ƒç´ çš„å€¼ä»¥åŠä»å¼€å§‹åˆ°ç°åœ¨çš„æ¶ˆè€—æ—¶é—´ println(\u0026#34;$v, consume time : ${System.currentTimeMillis() - startTime} ms \u0026#34;) } } // ä½¿ç”¨ flatMapMerge æ“ä½œç¬¦çš„æµ‹è¯•å‡½æ•° @Test fun `test flatMapMerge`() = runBlocking\u0026lt;Unit\u0026gt; { val startTime = System.currentTimeMillis() // è®°å½•å¼€å§‹æ—¶é—´ // åˆ›å»ºä¸€ä¸ªæµï¼ŒåŒ…å«æ•°å­— 1 åˆ° 3 (1..3) .asFlow() // å°†æ•°å­—è½¬æ¢ä¸ºæµ .onEach { delay(100) } // åœ¨æ¯ä¸ªå…ƒç´ ä¸Šæ–½åŠ  100 æ¯«ç§’çš„å»¶è¿Ÿ // ä½¿ç”¨ flatMapMerge å°†æ¯ä¸ªå…ƒç´ è½¬æ¢ä¸ºæ–°çš„æµå¹¶å¹¶å‘æ‰§è¡Œ .flatMapMerge { requestFlow(it) } .collect { v -\u0026gt; // æ”¶é›†å¹¶æ‰“å°æ¯ä¸ªå…ƒç´ çš„å€¼ä»¥åŠä»å¼€å§‹åˆ°ç°åœ¨çš„æ¶ˆè€—æ—¶é—´ println(\u0026#34;$v, consume time : ${System.currentTimeMillis() - startTime} ms \u0026#34;) } } // ä½¿ç”¨ flatMapLatest æ“ä½œç¬¦çš„æµ‹è¯•å‡½æ•° @Test fun `test flatMapLatest`() = runBlocking\u0026lt;Unit\u0026gt; { val startTime = System.currentTimeMillis() // è®°å½•å¼€å§‹æ—¶é—´ // åˆ›å»ºä¸€ä¸ªæµï¼ŒåŒ…å«æ•°å­— 1 åˆ° 3 (1..3) .asFlow() // å°†æ•°å­—è½¬æ¢ä¸ºæµ .onEach { delay(100) } // åœ¨æ¯ä¸ªå…ƒç´ ä¸Šæ–½åŠ  100 æ¯«ç§’çš„å»¶è¿Ÿ // ä½¿ç”¨ flatMapLatest å°†æ¯ä¸ªå…ƒç´ è½¬æ¢ä¸ºæ–°çš„æµï¼Œä»…ä¿ç•™æœ€æ–°æµ .flatMapLatest { requestFlow(it) } .collect { v -\u0026gt; // æ”¶é›†å¹¶æ‰“å°æ¯ä¸ªå…ƒç´ çš„å€¼ä»¥åŠä»å¼€å§‹åˆ°ç°åœ¨çš„æ¶ˆè€—æ—¶é—´ println(\u0026#34;$v, consume time : ${System.currentTimeMillis() - startTime} ms \u0026#34;) } } æµçš„å¼‚å¸¸å¤„ç† å½“è¿ç®—ç¬¦ä¸­çš„å‘å°„å™¨æˆ–ä»£ç æŠ›å‡ºå¼‚å¸¸æ—¶ï¼Œæœ‰å‡ ç§å¤„ç†å¼‚å¸¸çš„æ–¹æ³•ï¼š try/catchå— catchå‡½æ•° /** * æµ‹è¯•ç”¨ä¾‹ `test exception1`ï¼š * ä½¿ç”¨ runBlocking å¯åŠ¨åç¨‹ï¼Œæ”¶é›† simpleFlow çš„å€¼ã€‚ * å¦‚æœå€¼å¤§äº 1ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸å¹¶æ•è·ã€‚ */ @Test fun `test exception1`() = runBlocking\u0026lt;Unit\u0026gt; { try { simpleFlow().collect { v -\u0026gt; println(v) check(v \u0026lt;= 1) { \u0026#34;Collected $v\u0026#34; } } } catch (e: Throwable) { println(\u0026#34;Caught $e\u0026#34;) } } /** * æµ‹è¯•ç”¨ä¾‹ `test exception2`ï¼š * åˆ›å»ºä¸€ä¸ªæµï¼Œå‘å°„ä¸€ä¸ªå€¼åæŠ›å‡ºå¼‚å¸¸ã€‚ * ä½¿ç”¨ catch æ“ä½œç¬¦å¤„ç†å¼‚å¸¸ã€‚ */ @Test fun `test exception2`() = runBlocking\u0026lt;Unit\u0026gt; { flow { emit(1) throw ArithmeticException(\u0026#34;Div 0\u0026#34;) } .catch { e: Throwable -\u0026gt; println(\u0026#34;Caught: $e\u0026#34;) } .flowOn(Dispatchers.IO) .collect { println(it) } } æµçš„å®Œæˆ å½“æµæ”¶é›†å®Œæˆæ—¶ï¼ˆæ™®é€šæƒ…å†µæˆ–å¼‚å¸¸æƒ…å†µï¼‰ï¼Œå®ƒå¯èƒ½éœ€è¦æ‰§è¡Œä¸€ä¸ªåŠ¨ä½œ å‘½ä»¤æ˜¯finallyå— onCompletionå£°æ˜å¼å¤„ç† // å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œè¿”å›1åˆ°3çš„å€¼ä½œä¸º Flow fun simpleFlow2() = (1..3).asFlow() @Test // æµ‹è¯•åœ¨ finally å—ä¸­å®Œæˆæµçš„å¤„ç† fun `test flow complete in finally`() = runBlocking { try { // æ”¶é›† simpleFlow2 æµä¸­çš„æ¯ä¸ªå€¼ simpleFlow2().collect { println(it) } } finally { // æ— è®ºæµçš„æ”¶é›†è¿‡ç¨‹æ˜¯å¦æˆåŠŸï¼Œè¿™æ¡æ¶ˆæ¯éƒ½ä¼šåœ¨æœ€åæ‰“å° println(\u0026#34;Done!\u0026#34;) } } // å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œè¿”å›ä¸€ä¸ª Flow\u0026lt;Int\u0026gt; ç±»å‹çš„æµ fun simpleFlow3() = flow\u0026lt;Int\u0026gt; { // å‘å°„ï¼ˆemitï¼‰ç¬¬ä¸€ä¸ªå€¼ emit(1) // å‘å°„ä¸€ä¸ªå¼‚å¸¸æ¥ä¸­æ–­æµ throw RuntimeException() } @Test // æµ‹è¯•ä½¿ç”¨ onCompletion æ“ä½œç¬¦å¤„ç†æµå®Œæˆ fun `test flow complete in onCompletion`() = runBlocking { simpleFlow3() // åœ¨æµå®Œæˆæ—¶è°ƒç”¨çš„æ“ä½œç¬¦ .onCompletion { exception -\u0026gt; if (exception != null) { // å¦‚æœæœ‰å¼‚å¸¸ï¼Œæ‰“å°æµä»¥å¼‚å¸¸æ–¹å¼å®Œæˆ println(\u0026#34;Flow completed exceptionally\u0026#34;) } } // æ•è·æµä¸­çš„å¼‚å¸¸ .catch { exception -\u0026gt; println(\u0026#34;Caught $exception\u0026#34;) } // æ”¶é›† simpleFlow3 æµä¸­çš„æ¯ä¸ªå€¼ .collect { println(it) } } é€šé“-å¤šè·¯å¤ç”¨-å¹¶å‘å®‰å…¨ Channel Channelæ˜¯ä¸€ä¸ªå¹¶å‘å®‰å…¨çš„é˜Ÿåˆ—ï¼Œå®ƒå¯ä»¥ç”¨æ¥è¿æ¥åç¨‹ï¼Œå®ç°ä¸åŒåç¨‹çš„é€šä¿¡ã€‚ @Test fun `test know channel`() = runBlocking\u0026lt;Unit\u0026gt; { // åˆ›å»ºä¸€ä¸ªæ•´æ•°ç±»å‹çš„é€šé“ï¼Œç”¨äºåœ¨ä¸åŒçš„åç¨‹ä¹‹é—´ä¼ é€’æ•°æ® val channel = Channel\u0026lt;Int\u0026gt;() // åœ¨å…¨å±€èŒƒå›´å†…å¯åŠ¨ä¸€ä¸ªç”Ÿäº§è€…åç¨‹ï¼Œè´Ÿè´£å‘é€šé“å‘é€æ•°æ® val producer = GlobalScope.launch { var i = 0 while (true) { // æ¯æ¬¡å‘é€å‰æš‚åœ1ç§’é’Ÿ delay(1000) // é€’å¢è®¡æ•°å™¨å¹¶å°†å€¼å‘é€åˆ°é€šé“ channel.send(++i) println(\u0026#34;send $i\u0026#34;) } } // åœ¨å…¨å±€èŒƒå›´å†…å¯åŠ¨ä¸€ä¸ªæ¶ˆè´¹è€…åç¨‹ï¼Œè´Ÿè´£ä»é€šé“æ¥æ”¶æ•°æ® val consumer = GlobalScope.launch { while (true) { // æ¥æ”¶é€šé“ä¸­çš„æ•°æ® val element = channel.receive() println(\u0026#34;receive $element\u0026#34;) } } // ç­‰å¾…ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…åç¨‹ç»“æŸ joinAll(producer, consumer) } Channelçš„å®¹é‡ Channelå®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªé˜Ÿåˆ—ï¼Œé˜Ÿåˆ—ä¸­ä¸€å®šå­˜åœ¨ç¼“å†²åŒºï¼Œä¸€æ—¦è¿™ä¸ªç¼“å†²åŒºæ»¡äº†ï¼Œå¹¶ä¸”ä¸€ç›´æ²¡æœ‰äººè°ƒç”¨receiveå¹¶å–èµ°å‡½æ•°ï¼Œsendå°±éœ€è¦æŒ‚èµ·ã€‚æ•…æ„è®©æ¥æ”¶ç«¯çš„èŠ‚å¥æ”¾æ…¢ï¼Œå‘ç°sendæ€»æ˜¯ä¼šæŒ‚èµ·ï¼Œç›´åˆ°receiveä¹‹åæ‰ä¼šç»§ç»­å¾€ä¸‹æ‰§è¡Œã€‚ è¿­ä»£channel produce ä¸ actor æ„é€ ç”Ÿäº§è€…ä¸æ¶ˆè´¹è€…çš„ä¾¿æ·æ–¹æ³• å¯ä»¥é€šè¿‡produceæ–¹æ³•å¯åŠ¨ä¸€ä¸ªç”Ÿäº§è€…åç¨‹ï¼Œå¹¶è¿”å›ä¸€ä¸ªReceiveChannelï¼Œ å…¶ä»–åç¨‹å°±å¯ä»¥ç”¨è¿™ä¸ªChannelæ¥æ¥æ”¶æ•°æ®äº†ã€‚åä¹‹ï¼Œå¯ä»¥ç”¨actorå¯åŠ¨ä¸€ä¸ªæ¶ˆè´¹è€…åç¨‹ã€‚ @OptIn(DelicateCoroutinesApi::class) @Test fun `test fast consumer channel`() = runBlocking { // åˆ›å»ºä¸€ä¸ªå‘é€é€šé“ï¼Œå®ƒé€šè¿‡actoråç¨‹è¿›è¡Œæ•°æ®æ¥æ”¶å’Œå¤„ç† val sendChannel: SendChannel\u0026lt;Int\u0026gt; = GlobalScope.actor { while (true) { // æ¥æ”¶å¹¶å¤„ç†é€šé“ä¸­çš„æ•°æ® val element = receive() println(element) } } // åœ¨å…¨å±€èŒƒå›´å†…å¯åŠ¨ä¸€ä¸ªç”Ÿäº§è€…åç¨‹ï¼Œè´Ÿè´£å‘é€šé“å‘é€æ•°æ® val producer = GlobalScope.launch { for (i in 0..3) { // å‘é€šé“å‘é€æ•°æ® sendChannel.send(i) } } // ç­‰å¾…ç”Ÿäº§è€…åç¨‹å®Œæˆ producer.join() } Channelçš„å…³é—­ produceå’Œactorè¿”å›çš„Channeléƒ½ä¼šéšç€å¯¹åº”çš„åç¨‹æ‰§è¡Œå®Œæ¯•è€Œå…³é—­ï¼Œä¹Ÿæ­£æ˜¯è¿™æ ·ï¼ŒChannelæ‰è¢«ç§°ä¸ºçƒ­æ•°æ®æµã€‚ å¯¹äºChannelï¼Œå¦‚æœæˆ‘ä»¬è°ƒç”¨äº†å®ƒçš„closeæ–¹æ³•ï¼Œå®ƒä¼šç«‹å³åœæ­¢æ¥æ”¶æ–°å…ƒç´ ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™æ˜¯å®ƒçš„isClosedForSendä¼šç«‹å³è¿”å›trueã€‚è€Œç”±äºChannelç¼“å†²åŒºçš„å­˜åœ¨ï¼Œè¿™æ—¶å€™å¯èƒ½è¿˜æœ‰ä¸€äº›å…ƒç´ æ²¡æœ‰è¢«å¤„ç†å®Œï¼Œå› æ­¤è¦ç­‰æ‰€æœ‰çš„å…ƒç´ éƒ½è¢«è¯»å–ä¹‹åisClosedForSendæ‰ä¼šè¿”å›trueã€‚ Channelçš„ç”Ÿå‘½å‘¨æœŸæœ€å¥½ç”±ä¸»å¯¼æ–¹æ¥ç»´æŠ¤ï¼Œå»ºè®®ç”±ä¸»å¯¼çš„ä¸€æ–¹å®ç°å…³é—­ã€‚ @Test fun `test close channel`() = runBlocking { // åˆ›å»ºä¸€ä¸ªæ— ç•Œé™çš„æ•´æ•°ç±»å‹çš„é€šé“ï¼Œç”¨äºåœ¨ä¸åŒçš„åç¨‹ä¹‹é—´ä¼ é€’æ•°æ® val channel = Channel\u0026lt;Int\u0026gt;(Channel.UNLIMITED) // åœ¨å…¨å±€èŒƒå›´å†…å¯åŠ¨ä¸€ä¸ªç”Ÿäº§è€…åç¨‹ï¼Œè´Ÿè´£å‘é€šé“å‘é€æ•°æ® val producer = GlobalScope.launch { List(3) { channel.send(it) println(\u0026#34;send $it\u0026#34;) } // å‘é€å®Œæˆåå…³é—­é€šé“ channel.close() // æ‰“å°é€šé“çš„å…³é—­çŠ¶æ€ println( \u0026#34;\u0026#34;\u0026#34;close channel. | -ClosedForSend : ${channel.isClosedForSend} | -ClosedForReceive: ${channel.isClosedForReceive} \u0026#34;\u0026#34;\u0026#34;.trimMargin() ) } // åœ¨å…¨å±€èŒƒå›´å†…å¯åŠ¨ä¸€ä¸ªæ¶ˆè´¹è€…åç¨‹ï¼Œè´Ÿè´£ä»é€šé“æ¥æ”¶æ•°æ® val consumer = GlobalScope.launch { for (element in channel) { println(\u0026#34;receive $element\u0026#34;) delay(1000) } // æ¶ˆè´¹å®Œæˆåæ‰“å°é€šé“çš„å…³é—­çŠ¶æ€ println( \u0026#34;\u0026#34;\u0026#34;close channel. | -ClosedForSend : ${channel.isClosedForSend} | -ClosedForReceive: ${channel.isClosedForReceive} \u0026#34;\u0026#34;\u0026#34;.trimMargin() ) } // ç­‰å¾…ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…åç¨‹ç»“æŸ joinAll(producer, consumer) } BroadcastChannel å‘é€ç«¯å’Œæ¥æ”¶ç«¯åœ¨Channelä¸­å­˜åœ¨ä¸€å¯¹å¤šçš„æƒ…å½¢ï¼Œä»æ•°æ®å¤„ç†æœ¬èº«æ¥è®²ï¼Œè™½ç„¶æœ‰å¤šä¸ªæ¥æ”¶ç«¯ï¼Œä½†æ˜¯åŒä¸€ä¸ªå…ƒç´ åªä¼šè¢«ä¸€ä¸ªæ¥æ”¶ç«¯è¯»åˆ°ã€‚å¹¿æ’­åˆ™ä¸ç„¶ï¼Œå¤šä¸ªæ¥æ”¶ç«¯ä¸å­˜åœ¨äº’æ–¥è¡Œä¸ºã€‚\n// é€‰æ‹©ä½¿ç”¨è¿‡æ—¶å’Œç²¾ç»†çš„åç¨‹ API @OptIn(ObsoleteCoroutinesApi::class, DelicateCoroutinesApi::class) @Test fun `test broadcastChannel`() = runBlocking\u0026lt;Unit\u0026gt; { // åˆ›å»ºä¸€ä¸ªæ–°çš„é€šé“ï¼Œä½¿ç”¨æ— é™ç¼“å†²åŒºå®¹é‡ val channel = Channel\u0026lt;Int\u0026gt;() // å°†é€šé“è½¬æ¢ä¸ºå¹¿æ’­é€šé“ï¼Œå¯ä»¥æœ‰å¤šä¸ªè®¢é˜…è€… val broadcastChannel = channel.broadcast(3) // ç”Ÿäº§è€…åç¨‹ï¼Œå°†ä¸€ç³»åˆ—æ•´æ•°å‘é€åˆ°å¹¿æ’­é€šé“ val producer = GlobalScope.launch { // å‘é€ 3 ä¸ªæ•´æ•°åˆ°å¹¿æ’­é€šé“ï¼Œæ¯æ¬¡å‘é€ä¹‹é—´æœ‰å»¶è¿Ÿ List(3) { delay(100) broadcastChannel.send(it) } // åœ¨å‘é€å®Œæ‰€æœ‰æ•´æ•°åå…³é—­å¹¿æ’­é€šé“ broadcastChannel.close() } // å¯åŠ¨ 3 ä¸ªåç¨‹ï¼Œæ¯ä¸ªåç¨‹è®¢é˜…å¹¿æ’­é€šé“ List(3) { index: Int -\u0026gt; GlobalScope.launch { // æ¯ä¸ªåç¨‹æ‰“å¼€å¹¿æ’­é€šé“çš„ä¸€ä¸ªè®¢é˜… val receiveChannel = broadcastChannel.openSubscription() // è¿­ä»£æ¥æ”¶çš„å¹¿æ’­é€šé“ä¸­çš„å€¼ for (i in receiveChannel) { println(\u0026#34;[#$index] received : $i\u0026#34;) } } }.joinAll() // ç­‰å¾…æ‰€æœ‰åç¨‹å®Œæˆ } å¤šè·¯å¤ç”¨ æ•°æ®é€šä¿¡ç³»ç»Ÿæˆ–è®¡ç®—æœºç½‘ç»œç³»ç»Ÿä¸­ï¼Œä¼ è¾“åª’ä½“çš„å¸¦å®½æˆ–å®¹é‡å¾€å¾€ä¼šå¤§äºä¼ è¾“å•ä¸€ä¿¡å·çš„éœ€æ±‚ï¼Œä¸ºäº†æœ‰æ•ˆåœ°åˆ©ç”¨é€šä¿¡çº¿è·¯ï¼Œå¸Œæœ›ä¸€ä¸ªä¿¡é“åŒæ—¶ä¼ è¾“å¤šè·¯ä¿¡å·ï¼Œè¿™å°±æ˜¯å¤šè·¯å¤ç”¨æŠ€æœ¯ï¼ˆMultiplexingï¼‰ å¤ç”¨å¤šä¸ªawait ä¸¤ä¸ªAPIåˆ†åˆ«ä»ç½‘ç»œå’Œæœ¬åœ°ç¼“å­˜è·å–æ•°æ®ï¼ŒæœŸæœ›å“ªä¸ªå…ˆè¿”å›å°±å…ˆç”¨å“ªä¸ªåšå±•ç¤º @Test fun `test select channel`() = runBlocking\u0026lt;Unit\u0026gt; { // åˆ›å»ºä¸€ä¸ªåŒ…å«ä¸¤ä¸ªæ•´å‹é€šé“çš„åˆ—è¡¨ val channels = listOf(Channel\u0026lt;Int\u0026gt;(), Channel\u0026lt;Int\u0026gt;()) // ç¬¬ä¸€ä¸ªå…¨å±€åç¨‹ï¼Œåœ¨å»¶è¿Ÿ100æ¯«ç§’åå‘ç¬¬ä¸€ä¸ªé€šé“å‘é€200 GlobalScope.launch { delay(100) channels[0].send(200) } // ç¬¬äºŒä¸ªå…¨å±€åç¨‹ï¼Œåœ¨å»¶è¿Ÿ50æ¯«ç§’åå‘ç¬¬äºŒä¸ªé€šé“å‘é€100 GlobalScope.launch { delay(50) channels[1].send(100) } // ä½¿ç”¨selectè¡¨è¾¾å¼ä»é€šé“ä¸­æ¥æ”¶ä¸€ä¸ªå€¼ val result = select\u0026lt;Int?\u0026gt; { // å¯¹æ¯ä¸ªé€šé“åº”ç”¨onReceiveå­å¥ channels.forEach { channel -\u0026gt; channel.onReceive { value -\u0026gt; value // è¿”å›æ¥æ”¶åˆ°çš„å€¼ } } } // æ‰“å°ä»é€šé“ä¸­æ¥æ”¶åˆ°çš„å€¼ println(result) } SelectClause SelectClause0 : å¯¹åº”äº‹ä»¶æ²¡æœ‰è¿”å›å€¼ï¼Œä¾‹å¦‚ join æ²¡æœ‰è¿”å›å€¼ï¼Œé‚£ä¹ˆonJoinå°±æ˜¯SelectClauseNç±»å‹ã€‚ä½¿ç”¨æ—¶ï¼ŒonJoinçš„å‚æ•°æ˜¯ä¸€ä¸ªæ— å‚å‡½æ•°ã€‚\nSelectClause1ï¼šå¯¹åº”äº‹ä»¶æœ‰è¿”å›å€¼ï¼Œå‰é¢çš„onAwaitå’ŒonReceiveéƒ½æ˜¯æ­¤ç±»æƒ…å†µã€‚\nSelectClause2ï¼šå¯¹åº”äº‹ä»¶æœ‰è¿”å›å€¼ï¼Œæ­¤å¤–è¿˜éœ€è¦ä¸€ä¸ªé¢å¤–çš„å‚æ•°ï¼Œä¾‹å¦‚Channel.onSendæœ‰ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯Channelæ•°æ®ç±»å‹çš„å€¼ï¼Œè¡¨ç¤ºå³å°†å‘é€çš„å€¼ï¼Œç¬¬äºŒä¸ªæ˜¯å‘é€æˆåŠŸæ—¶çš„å›è°ƒå‚æ•°ã€‚\nå¦‚æœæƒ³è¦ç¡®è®¤æŒ‚èµ·å‡½æ•°æ˜¯å¦æ”¯æŒselectï¼Œåªéœ€è¦æŸ¥çœ‹å…¶æ˜¯å¦å­˜åœ¨å¯¹åº”çš„SelectClauseNç±»å‹å¯å›è°ƒå³å¯ã€‚\nä½¿ç”¨Flowå®ç°å¤šè·¯å¤ç”¨ @Test fun `test select flow`() = runBlocking\u0026lt;Unit\u0026gt; { // å®šä¹‰ç”¨æˆ·å val name = \u0026#34;guest\u0026#34; // åœ¨åç¨‹ä½œç”¨åŸŸå†…è¿è¡Œ coroutineScope { // åˆ›å»ºä¸€ä¸ªåŒ…å«ä¸¤ä¸ªå‡½æ•°å¼•ç”¨çš„åˆ—è¡¨ listOf(::getUserFromLocal, ::getUserFromRemote) .map { function -\u0026gt; // è°ƒç”¨æ¯ä¸ªå‡½æ•°ï¼Œä¼ å…¥ç”¨æˆ·åå’Œå½“å‰åç¨‹ä½œç”¨åŸŸ function.call(name, this) } .map { deferred -\u0026gt; // å°†æ¯ä¸ª Deferred è½¬æ¢ä¸º Flowï¼Œå¹¶å‘å°„å…¶ç»“æœ flow { emit(deferred.await()) } } // åˆå¹¶æ‰€æœ‰çš„ Flow .merge() // æ”¶é›†ç»“æœå¹¶æ‰“å°æ¯ä¸ªç”¨æˆ·å¯¹è±¡ .collect { user -\u0026gt; println(user) } } } åç¨‹çš„å¹¶å‘å·¥å…· é™¤äº†åœ¨çº¿ç¨‹ä¸­å¸¸ç”¨çš„è§£å†³å¹¶å‘é—®é¢˜çš„æ‰‹æ®µä¹‹å¤–ï¼Œåç¨‹æ¡†æ¶ä¹Ÿæä¾›äº†ä¸€äº›å®‰å…¨çš„å·¥å…·ï¼ŒåŒ…æ‹¬ï¼š Channelï¼šå¹¶å‘å®‰å…¨çš„æ¶ˆæ¯é€šé“ Mutexï¼šè½»é‡çº§é”ï¼Œå®ƒçš„lockå’Œunlockä»è¯­ä¹‰ä¸Šä¸çº¿ç¨‹é”æ¯”è¾ƒç±»ä¼¼ï¼Œä¹‹æ‰€ä»¥è½»é‡æ˜¯å› ä¸ºå®ƒåœ¨è·å–ä¸åˆ°é”æ—¶ä¸ä¼šé˜»å¡çº¿ç¨‹ï¼Œè€Œæ˜¯æŒ‚èµ·ç­‰å¾…é”çš„é‡Šæ”¾ Semaphoreï¼šè½»é‡çº§ä¿¡å·é‡ï¼Œä¿¡å·é‡å¯ä»¥æœ‰å¤šä¸ªï¼Œåç¨‹åœ¨è·å–åˆ°ä¿¡å·é‡åå³å¯æ‰§è¡Œå¹¶å‘æ“ä½œã€‚å½“Semaphoreçš„å‚æ•°ä¸º1æ—¶ï¼Œæ•ˆæœç­‰ä»·äºMutexã€‚ @Test fun `test not concurrent tools`() = runBlocking { // åˆå§‹åŒ–è®¡æ•°å™¨ var count = 0 // åˆå§‹åŒ–ä¸€ä¸ªäº’æ–¥é” var mutex = Mutex() // åˆ›å»º 1000 ä¸ªåç¨‹ï¼Œæ¯ä¸ªåç¨‹éƒ½å°è¯•å¢åŠ è®¡æ•°å™¨ List(1000) { GlobalScope.launch { // åœ¨äº’æ–¥é”ä¿æŠ¤ä¸‹å¢åŠ è®¡æ•°å™¨ï¼Œç¡®ä¿çº¿ç¨‹å®‰å…¨ mutex.withLock { count += 1 } } }.joinAll() // ç­‰å¾…æ‰€æœ‰åç¨‹å®Œæˆ // æ‰“å°è®¡æ•°å™¨çš„æœ€ç»ˆå€¼ println(count) } @Test fun `test not concurrent tools2`() = runBlocking { // åˆå§‹åŒ–è®¡æ•°å™¨ var count = 0 // åˆå§‹åŒ–ä¸€ä¸ªä¿¡å·é‡ï¼Œå…è®¸åŒæ—¶åªæœ‰ä¸€ä¸ªåç¨‹è¿›å…¥ä¸´ç•ŒåŒº var semaphore = Semaphore(1) // åˆ›å»º 1000 ä¸ªåç¨‹ï¼Œæ¯ä¸ªåç¨‹éƒ½å°è¯•å¢åŠ è®¡æ•°å™¨ List(1000) { GlobalScope.launch { // åœ¨ä¿¡å·é‡ä¿æŠ¤ä¸‹å¢åŠ è®¡æ•°å™¨ï¼Œç¡®ä¿çº¿ç¨‹å®‰å…¨ semaphore.withPermit { count += 1 } } }.joinAll() // ç­‰å¾…æ‰€æœ‰åç¨‹å®Œæˆ // æ‰“å°è®¡æ•°å™¨çš„æœ€ç»ˆå€¼ println(count) } é¿å…è®¿é—®å¤–éƒ¨å¯å˜çŠ¶æ€ ç¼–å†™å‡½æ•°æ—¶è¦æ±‚å®ƒä¸å¾—è®¿é—®å¤–éƒ¨çŠ¶æ€ï¼Œåªèƒ½åŸºäºå‚æ•°åšè¿ç®—ï¼Œé€šè¿‡è¿”å›å€¼æä¾›è¿ç®—ç»“æœ @Test fun `test avoid access outer variable`() = runBlocking { var count = 0 var result = count + List(1000){ GlobalScope.async { 1 } }.map { it.await() }.sum() println(result) } ","permalink":"https://kennems.github.io/posts/tech/kotlin%E5%8D%8F%E7%A8%8B3/","summary":"Kotlinåç¨‹(3) æ“ä½œç¬¦ è¿‡æ¸¡æµæ“ä½œç¬¦ å¯ä»¥ä½¿ç”¨æ“ä½œç¬¦è½¬æ¢ç¬¦ï¼Œå°±åƒä½¿ç”¨é›†åˆä¸åºåˆ—ä¸€æ · è¿‡æ¸¡æ“ä½œç¬¦åº”ç”¨äºä¸Šæ¸¸æµï¼Œå¹¶è¿”å›ä¸‹æ¸¸æµã€‚ è¿™äº›æ“ä½œç¬¦ä¹Ÿæ˜¯å†·æ“","title":"Kotlinåç¨‹(3)"},{"content":"Kotlinåç¨‹(2) å¼‚å¸¸å¤„ç†çš„å¿…è¦æ€§ @OptIn(ExperimentalStdlibApi::class) // æ ‡è®°è¯¥ä»£ç ä½¿ç”¨äº†å®éªŒæ€§æ ‡å‡†åº“ API @Test // è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªæµ‹è¯•å‡½æ•° fun `test CoroutineContext extend2`() = runBlocking { // ä½¿ç”¨ runBlocking å¯åŠ¨åç¨‹ // åˆ›å»ºä¸€ä¸ªåç¨‹å¼‚å¸¸å¤„ç†å™¨ï¼Œç”¨äºæ•è·åç¨‹ä¸­çš„å¼‚å¸¸ val coroutineExceptionHandler = CoroutineExceptionHandler { _, exception -\u0026gt; println(\u0026#34;Caught : $exception\u0026#34;) // æ‰“å°æ•è·åˆ°çš„å¼‚å¸¸ } // åˆ›å»ºä¸€ä¸ªåç¨‹ä½œç”¨åŸŸï¼ŒåŒ…å«ä¸€ä¸ª Jobï¼Œä½¿ç”¨ä¸»çº¿ç¨‹è°ƒåº¦å™¨å’Œå¼‚å¸¸å¤„ç†å™¨ val scope = CoroutineScope( Job() + Dispatchers.Main + coroutineExceptionHandler // Job() ç”¨äºç®¡ç†åç¨‹çš„ç”Ÿå‘½å‘¨æœŸ ) // åœ¨ IO çº¿ç¨‹ä¸Šå¯åŠ¨ä¸€ä¸ªæ–°çš„åç¨‹ val job = scope.launch(Dispatchers.IO) { // è·å–å½“å‰åç¨‹ä¸Šä¸‹æ–‡ä¸­çš„è°ƒåº¦å™¨ val dispatcher = coroutineContext[CoroutineDispatcher] // æ‰“å°å½“å‰ä½¿ç”¨çš„è°ƒåº¦å™¨ println(\u0026#34;Current dispatcher: $dispatcher\u0026#34;) } // ç­‰å¾…åç¨‹å®Œæˆ job.join() // ç¡®ä¿ä¸»åç¨‹åœ¨å­åç¨‹å®Œæˆåå†ç»§ç»­ } å¼‚å¸¸çš„ä¼ æ’­ åç¨‹æ„å»ºå™¨æœ‰ä¸¤ç§å½¢å¼ï¼š1ã€è‡ªåŠ¨ä¼ æ’­å¼‚å¸¸ï¼ˆlaunchä¸actorï¼‰2ã€å‘ç”¨æˆ·æš´éœ²å¼‚å¸¸ï¼ˆasyncä¸produceï¼‰ï¼Œ å½“è¿™äº›æ„å»ºå™¨ç”¨äºåˆ›å»ºä¸€ä¸ªæ ¹åç¨‹æ—¶ï¼ˆè¯¥åç¨‹ä¸æ˜¯å¦ä¸€ä¸ªåç¨‹çš„å­åç¨‹ï¼‰ï¼Œå‰è€…è¿™ç±»æ„å»ºå™¨ï¼Œå¼‚å¸¸ä¼šåœ¨å®ƒå‘ç”Ÿçš„ç¬¬ä¸€æ—¶é—´è¢«æŠ›å‡ºï¼Œè€Œåè€…åˆ™ä¾èµ–ç”¨æˆ·æ¥æœ€ç»ˆæ¶ˆè´¹å¼‚å¸¸ï¼Œä¾‹å¦‚é€šè¿‡awaitæˆ–receiveã€‚ // æ ¹åç¨‹ @Test @OptIn(DelicateCoroutinesApi::class) fun `test exception propagation`() = runBlocking\u0026lt;Unit\u0026gt; { // åœ¨ GlobalScope ä¸­å¯åŠ¨ä¸€ä¸ªæ–°åç¨‹ï¼Œè¿”å›ä¸€ä¸ª Job å¯¹è±¡ val job = GlobalScope.launch { try { // åœ¨åç¨‹ä¸­æŠ›å‡ºä¸€ä¸ª IndexOutOfBoundsException throw IndexOutOfBoundsException() } catch (e: Exception) { // æ•è·å¼‚å¸¸å¹¶æ‰“å°ä¸€æ¡æ¶ˆæ¯ï¼ŒæŒ‡ç¤ºæ•è·äº† IndexOutOfBoundsException println(\u0026#34;IndexOutOfBoundsException\u0026#34;) // å¦‚æœéœ€è¦å¯ä»¥é€‰æ‹©æ‰“å°å †æ ˆè½¨è¿¹ // e.printStackTrace() } } // ç­‰å¾…åç¨‹å®Œæˆ job.join() // åœ¨ GlobalScope ä¸­å¯åŠ¨ä¸€ä¸ªæ–°åç¨‹ï¼Œå¹¶è¿”å›ä¸€ä¸ª Deferred å¯¹è±¡ val deffer = GlobalScope.async { // åœ¨åç¨‹ä¸­æŠ›å‡ºä¸€ä¸ª ArithmeticException throw ArithmeticException() } try { // ç­‰å¾…å¼‚æ­¥ä»»åŠ¡å®Œæˆå¹¶è·å–ç»“æœï¼Œå¦‚æœä»»åŠ¡æŠ›å‡ºå¼‚å¸¸ï¼Œè¿™é‡Œä¼šé‡æ–°æŠ›å‡ºå¼‚å¸¸ deffer.await() } catch (e: Exception) { // æ•è·å¼‚å¸¸å¹¶æ‰“å°ä¸€æ¡æ¶ˆæ¯ï¼ŒæŒ‡ç¤ºæ•è·äº† ArithmeticException println(\u0026#34;ArithmeticException\u0026#34;) // å¦‚æœéœ€è¦å¯ä»¥é€‰æ‹©æ‰“å°å †æ ˆè½¨è¿¹ // e.printStackTrace() } } éæ ¹åç¨‹çš„å¼‚å¸¸ å…¶ä»–åç¨‹æ‰€åˆ›å»ºçš„åç¨‹ä¸­ï¼Œäº§ç”Ÿçš„å¼‚å¸¸æ€»æ˜¯ä¼šè¢«ä¼ æ’­ /* éæ ¹åç¨‹ï¼Œjobæ˜¯scopeå†…çš„å­åç¨‹ï¼Œæ‰€ä»¥ä¼šç›´æ¥æ¶ˆè´¹æ‰å¼‚å¸¸ */ @Test fun `test exception propagation2`() = runBlocking { // åˆ›å»ºä¸€ä¸ªæ–°çš„ CoroutineScopeï¼Œä½¿ç”¨ Job ä½œä¸ºå…¶ä¸Šä¸‹æ–‡å…ƒç´  val scope = CoroutineScope(Job()) // åœ¨ scope ä¸­å¯åŠ¨ä¸€ä¸ªæ–°åç¨‹ï¼Œè¿”å›ä¸€ä¸ª Job å¯¹è±¡ val job = scope.launch { // åœ¨åç¨‹ä¸­å¯åŠ¨ä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡ async { // åœ¨å¼‚æ­¥ä»»åŠ¡ä¸­æŠ›å‡ºä¸€ä¸ª IllegalArgumentException throw IllegalArgumentException() } } // ç­‰å¾… launch å¯åŠ¨çš„åç¨‹å®Œæˆ job.join() } å¼‚å¸¸çš„ä¼ æ’­ç‰¹æ€§ å½“ä¸€ä¸ªåç¨‹ç”±äºä¸€ä¸ªå¼‚å¸¸è€Œè¿è¡Œå¤±è´¥æ—¶ï¼Œå®ƒä¼šä¼ æ’­è¿™ä¸ªå¼‚å¸¸å¹¶ä¼ é€’ç»™å®ƒçš„çˆ¶çº§ã€‚æ¥ä¸‹æ¥ï¼Œçˆ¶çº§ä¼šè¿›è¡Œä¸‹é¢å‡ æ­¥æ“ä½œï¼š å–æ¶ˆå®ƒè‡ªå·±çš„å­çº§ å–æ¶ˆå®ƒè‡ªå·± å°†å¼‚å¸¸ä¼ æ’­å¹¶ä¼ é€’ç»™å®ƒçš„çˆ¶çº§ SupervisorJob ä½¿ç”¨SupervisorJobæ—¶ï¼Œä¸€ä¸ªå­åç¨‹çš„è¿è¡Œå¤±è´¥ä¸ä¼šå½±å“å…¶ä»–å­åç¨‹ï¼ŒSupervisorJobä¸ä¼šä¼ æ’­å¼‚å¸¸ç»™å®ƒçš„çˆ¶çº§ï¼Œå®ƒä¼šè®©å­åç¨‹è‡ªå·±å¤„ç†å¼‚å¸¸ã€‚ éœ€æ±‚ï¼šåœ¨ä½œç”¨åŸŸå†…å®šä¹‰ä½œä¸šçš„UIç»„ä»¶ï¼Œå¦‚æœä»»ä½•ä¸€ä¸ªUIçš„å­ä½œä¸šæ‰§è¡Œå¤±è´¥äº†ï¼Œå®ƒå¹¶ä¸æ€»æ˜¯æœ‰å¿…è¦å–æ¶ˆæ•´ä¸ªUIç»„ä»¶ï¼Œä½†æ˜¯å¦‚æœUIç»„ä»¶è¢«é”€æ¯äº†ï¼Œç”±äºå®ƒçš„ç»“æœä¸å†è¢«éœ€è¦äº†ï¼Œå®ƒå°±æœ‰å¿…è¦ä½¿æ‰€æœ‰çš„å­ä½œä¸šæ‰§è¡Œå¤±è´¥ã€‚ @Test fun `test supervisorJob`() = runBlocking\u0026lt;Unit\u0026gt; { // åˆ›å»ºä¸€ä¸ªæ–°çš„ CoroutineScopeï¼Œä½¿ç”¨ SupervisorJob ä½œä¸ºå…¶ä¸Šä¸‹æ–‡å…ƒç´  val supervisor = CoroutineScope(SupervisorJob()) // å¦‚æœä½¿ç”¨æ™®é€šçš„ Jobï¼Œæ³¨é‡Šæ‰ä¸Šä¸€è¡Œå¹¶å¯ç”¨ä»¥ä¸‹è¡Œ // val supervisor = CoroutineScope(Job()) // åœ¨ supervisor ä½œç”¨åŸŸä¸­å¯åŠ¨ç¬¬ä¸€ä¸ªå­åç¨‹ï¼Œè¿”å›ä¸€ä¸ª Job å¯¹è±¡ val job1 = supervisor.launch { // å»¶è¿Ÿ 100 æ¯«ç§’ä»¥æ¨¡æ‹Ÿä¸€äº›å·¥ä½œ delay(100) println(\u0026#34;child 1\u0026#34;) // åœ¨ç¬¬ä¸€ä¸ªå­åç¨‹ä¸­æŠ›å‡ºä¸€ä¸ª IllegalArgumentException throw IllegalArgumentException() } // åœ¨ supervisor ä½œç”¨åŸŸä¸­å¯åŠ¨ç¬¬äºŒä¸ªå­åç¨‹ï¼Œè¿”å›ä¸€ä¸ª Job å¯¹è±¡ val job2 = supervisor.launch { try { // æ— é™å»¶è¿Ÿä»¥æ¨¡æ‹Ÿé•¿æ—¶é—´è¿è¡Œçš„ä»»åŠ¡ delay(Long.MAX_VALUE) } finally { // å½“åç¨‹å–æ¶ˆæ—¶ï¼Œæœ€ç»ˆä¼šæ‰“å° \u0026#34;child 2 finished\u0026#34; println(\u0026#34;child 2 finished\u0026#34;) } } // ä»¥ä¸‹æ˜¯å¯é€‰éƒ¨åˆ†ï¼Œå¦‚æœéœ€è¦ï¼Œå¯ä»¥å–æ¶ˆæ³¨é‡Š // å»¶è¿Ÿ 200 æ¯«ç§’åå–æ¶ˆ supervisor ä½œç”¨åŸŸå†…çš„æ‰€æœ‰åç¨‹ // delay(200) // supervisor.cancel() // ç­‰å¾… job1 å’Œ job2 éƒ½å®Œæˆ joinAll(job1, job2) } SupervisorScope å½“ä½œä¸šè‡ªèº«æ‰§è¡Œå¤±è´¥çš„æ—¶å€™ï¼Œæ‰€ä»¥å­ä½œä¸šå°†ä¼šè¢«å…¨éƒ¨å–æ¶ˆ @Test fun `test supervisorScope`() = runBlocking\u0026lt;Unit\u0026gt; { // ä½¿ç”¨ supervisorScope å¯åŠ¨ä¸€ä¸ªæ–°çš„åç¨‹ä½œç”¨åŸŸ supervisorScope { // åœ¨ supervisorScope ä¸­å¯åŠ¨ä¸€ä¸ªå­åç¨‹ï¼Œè¿”å›ä¸€ä¸ª Job å¯¹è±¡ launch { // å»¶è¿Ÿ 100 æ¯«ç§’ä»¥æ¨¡æ‹Ÿä¸€äº›å·¥ä½œ delay(100) // è¾“å‡º \u0026#34;child 1\u0026#34;ï¼Œè¡¨ç¤ºå­åç¨‹å·²å®Œæˆå…¶ä»»åŠ¡ println(\u0026#34;child 1\u0026#34;) // åœ¨åç¨‹ä¸­æŠ›å‡ºä¸€ä¸ª IllegalArgumentExceptionï¼Œä»¥æµ‹è¯•å¼‚å¸¸ä¼ æ’­ throw IllegalArgumentException() } // åœ¨ supervisorScope ä¸­å¯åŠ¨å¦ä¸€ä¸ªåç¨‹ try { // å»¶è¿Ÿä¸€ä¸ªéå¸¸é•¿çš„æ—¶é—´ï¼Œæ¨¡æ‹Ÿé•¿æ—¶é—´è¿è¡Œçš„ä»»åŠ¡ delay(Long.MAX_VALUE) } finally { // å½“ supervisorScope è¢«å–æ¶ˆæ—¶ï¼ˆç”±äºå¼‚å¸¸ï¼‰ï¼Œæœ€ç»ˆä¼šæ‰“å° \u0026#34;child 2 finished.\u0026#34; println(\u0026#34;child 2 finished.\u0026#34;) } } } @Test fun `test supervisorScope2`() = runBlocking\u0026lt;Unit\u0026gt; { // ä½¿ç”¨ supervisorScope æ¥å¯åŠ¨ä¸€ä¸ªåç¨‹ä½œç”¨åŸŸ supervisorScope { // åœ¨ supervisorScope ä¸­å¯åŠ¨ä¸€ä¸ªå­åç¨‹ val child = launch { try { // è¾“å‡º \u0026#34;The child is sleeping\u0026#34; è¡¨ç¤ºå­åç¨‹è¿›å…¥ç¡çœ çŠ¶æ€ println(\u0026#34;The child is sleeping\u0026#34;) // å»¶è¿Ÿæ— é™é•¿çš„æ—¶é—´ï¼Œæ¨¡æ‹Ÿé•¿æ—¶é—´è¿è¡Œçš„ä»»åŠ¡ delay(Long.MAX_VALUE) } finally { // å½“å­åç¨‹è¢«å–æ¶ˆæ—¶ï¼Œæœ€ç»ˆä¼šæ‰“å° \u0026#34;The child is cancelled\u0026#34; println(\u0026#34;The child is cancelled\u0026#34;) } } // è®©å‡ºçº¿ç¨‹ä»¥ç¡®ä¿å­åç¨‹å¯åŠ¨å¹¶è¿›å…¥å»¶è¿ŸçŠ¶æ€ yield() // åœ¨ supervisorScope ä¸­æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ println(\u0026#34;Throwing an exception from the scope\u0026#34;) throw AssertionError() // æŠ›å‡ºä¸€ä¸ªæ–­è¨€é”™è¯¯ï¼Œç”¨äºæµ‹è¯•ä½œç”¨åŸŸçš„å¼‚å¸¸å¤„ç† } } å¼‚å¸¸çš„æ•è· ä½¿ç”¨CoroutineExcepitonHandlerå¯¹åç¨‹çš„å¼‚å¸¸è¿›è¡Œæ•è· ä»¥ä¸‹çš„æ¡ä»¶è¢«æ»¡è¶³æ—¶ï¼Œå¼‚å¸¸å°±ä¼šè¢«æ•è·ï¼š æ—¶æœºï¼šå¼‚å¸¸æ˜¯è¢«è‡ªåŠ¨æŠ›å‡ºå¼‚å¸¸çš„åç¨‹æ‰€æŠ›å‡ºçš„ï¼ˆä½¿ç”¨launchï¼Œè€Œä¸æ˜¯asyncæ—¶ï¼‰ï¼› ä½ç½®ï¼šåœ¨CoroutineScopeçš„CoroutineContextä¸­æˆ–åœ¨ä¸€ä¸ªæ ¹åç¨‹ï¼ˆCoroutineScopeæˆ–è€…supervisorScopeçš„ç›´æ¥å­åç¨‹ï¼‰ä¸­ã€‚ Androidä¸­å…¨å±€å¼‚å¸¸å¤„ç† å…¨å±€å¼‚å¸¸å¤„ç†å™¨å¯ä»¥è·å–åˆ°æ‰€æœ‰åç¨‹æœªå¤„ç†çš„æœªæ•è·å¼‚å¸¸ï¼Œä¸è¿‡å®ƒå¹¶ä¸èƒ½å¯¹å¼‚å¸¸è¿›è¡Œæ•è·ï¼Œè™½ç„¶ä¸èƒ½é˜»æ­¢ç¨‹åºå´©æºƒï¼Œå…¨å±€å¼‚å¸¸å¤„ç†å™¨åœ¨ç¨‹åºè°ƒè¯•å’Œå¼‚å¸¸ä¸ŠæŠ¥ç­‰åœºæ™¯ä¸­ä»ç„¶æœ‰éå¸¸å¤§çš„ç”¨å¤„ã€‚ æˆ‘ä»¬éœ€è¦åœ¨classpathä¸‹é¢åˆ›å»ºMETA-INF/servicesç›®å½•ï¼Œå¹¶åœ¨å…¶ä¸­åˆ›å»ºä¸€ä¸ªåä¸ºkotlinx.coroutines.CoroutineExceptionHandlerçš„æ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹å°±æ˜¯æˆ‘ä»¬çš„å…¨å±€å¼‚å¸¸å¤„ç†å™¨çš„å…¨ç±»åã€‚ å–æ¶ˆä¸å¼‚å¸¸ å–æ¶ˆä¸å¼‚å¸¸ç´§å¯†ç›¸å…³ï¼Œåç¨‹å†…éƒ¨ä½¿ç”¨CancellationExcepitonæ¥è¿›è¡Œå–æ¶ˆï¼Œè¿™ä¸ªå¼‚å¸¸ä¼šè¢«å¿½ç•¥ã€‚ å½“å­åç¨‹è¢«å–æ¶ˆæ—¶ï¼Œä¸ä¼šå–æ¶ˆå®ƒçš„çˆ¶åç¨‹ å¦‚æœä¸€ä¸ªåç¨‹é‡åˆ°äº†CancellationExcepitonä»¥å¤–çš„å¼‚å¸¸ï¼Œå®ƒå°†ä½¿ç”¨è¯¥å¼‚å¸¸å–æ¶ˆå®ƒçš„çˆ¶åç¨‹ã€‚å½“çˆ¶åç¨‹çš„æ‰€æœ‰å­åç¨‹éƒ½ç»“æŸåï¼Œå¼‚å¸¸æ‰ä¼šè¢«çˆ¶åç¨‹å¤„ç†ã€‚ @Test fun `test cancel and exception`() = runBlocking\u0026lt;Unit\u0026gt; { // å¯åŠ¨ä¸€ä¸ªåç¨‹ä½œä¸ºçˆ¶åç¨‹ val job = launch { // åœ¨çˆ¶åç¨‹ä¸­å¯åŠ¨ä¸€ä¸ªå­åç¨‹ val child = launch { try { // å­åç¨‹å°è¯•å»¶è¿Ÿæ‰§è¡Œï¼Œæ¨¡æ‹Ÿé•¿æ—¶é—´è¿è¡Œçš„ä»»åŠ¡ delay(Long.MAX_VALUE) } finally { // å½“å­åç¨‹è¢«å–æ¶ˆæ—¶ï¼Œæ‰§è¡Œæ­¤å— println(\u0026#34;Child is cancelled\u0026#34;) } } // è®©çˆ¶åç¨‹æš‚æ—¶è®©å‡ºçº¿ç¨‹ï¼Œç»™å…¶ä»–åç¨‹æ‰§è¡Œçš„æœºä¼š yield() println(\u0026#34;Cancelling child\u0026#34;) // å–æ¶ˆå­åç¨‹ï¼Œå¹¶ç­‰å¾…å…¶æ‰§è¡Œå®Œ finally å— child.cancelAndJoin() // å†æ¬¡è®©å‡ºçº¿ç¨‹ yield() println(\u0026#34;Parent is not cancelled\u0026#34;) } // ç­‰å¾…çˆ¶åç¨‹å®Œæˆæ‰§è¡Œ job.join() } @Test fun `test cancel and exception2`() = runBlocking\u0026lt;Unit\u0026gt; { // å®šä¹‰ä¸€ä¸ª CoroutineExceptionHandler æ¥å¤„ç†æœªæ•è·çš„å¼‚å¸¸ val handler = CoroutineExceptionHandler { _, exception -\u0026gt; println(\u0026#34;Caught: $exception\u0026#34;) } // ä½¿ç”¨ GlobalScope å¯åŠ¨ä¸€ä¸ªé¡¶å±‚åç¨‹ï¼Œå¹¶åº”ç”¨å¼‚å¸¸å¤„ç†å™¨ val job = GlobalScope.launch(handler) { // ç¬¬ä¸€ä¸ªå­åç¨‹ï¼Œæ¨¡æ‹Ÿä¸€ä¸ªéœ€è¦å¾ˆé•¿æ—¶é—´çš„ä»»åŠ¡ launch { try { // ä½¿ç”¨ä¸€ä¸ªå¾ˆé•¿çš„å»¶è¿Ÿæ¥æ¨¡æ‹Ÿé•¿æ—¶é—´è¿è¡Œçš„ä»»åŠ¡ delay(Long.MAX_VALUE) } finally { // ç¡®ä¿åœ¨åç¨‹è¢«å–æ¶ˆæ—¶ï¼Œæ‰§è¡Œä»¥ä¸‹ä»£ç  withContext(NonCancellable) { println(\u0026#34;Children are cancelled, but exceptions are not handled\u0026#34;) delay(100) // ç¡®ä¿è¾“å‡ºè¯­å¥æœ‰æœºä¼šæ‰§è¡Œ println(\u0026#34;The first child finished its non cancellable block\u0026#34;) } } } // ç¬¬äºŒä¸ªå­åç¨‹ï¼Œåœ¨çŸ­æš‚å»¶è¿ŸåæŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ launch { delay(10) println(\u0026#34;Second child throws an exception\u0026#34;) throw ArithmeticException() // æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸æ¥æµ‹è¯•å¼‚å¸¸å¤„ç† } } // ç­‰å¾…çˆ¶åç¨‹å®Œæˆ job.join() } å¼‚å¸¸èšåˆ å½“åç¨‹çš„å¤šä¸ªå­åç¨‹å› ä¸ºå¼‚å¸¸è€Œå¤±è´¥æ—¶ï¼Œä¸€èˆ¬æƒ…å†µä¸‹å–ç¬¬ä¸€ä¸ªå¼‚å¸¸è¿›è¡Œå¤„ç†ã€‚åœ¨ç¬¬ä¸€å¼‚å¸¸ä¹‹åå‘ç”Ÿçš„æ‰€æœ‰å…¶ä»–å¼‚å¸¸ï¼Œéƒ½å°†ç»‘å®šåˆ°ç¬¬ä¸€ä¸ªå¼‚å¸¸ä¹‹ä¸Šã€‚ @Test fun `test exception aggregation`() = runBlocking\u0026lt;Unit\u0026gt; { // å®šä¹‰ä¸€ä¸ª CoroutineExceptionHandler æ¥å¤„ç†æœªæ•è·çš„å¼‚å¸¸ val handler = CoroutineExceptionHandler { _, exception -\u0026gt; // è¾“å‡ºè¢«æ•è·çš„ä¸»å¼‚å¸¸å’ŒæŠ‘åˆ¶çš„å¼‚å¸¸ï¼ˆå¦‚æœæœ‰ï¼‰ println(\u0026#34;Caught: $exception, Suppressed: ${exception.suppressed.contentToString()}\u0026#34;) } // ä½¿ç”¨ GlobalScope å¯åŠ¨ä¸€ä¸ªé¡¶å±‚åç¨‹ï¼Œå¹¶åº”ç”¨å¼‚å¸¸å¤„ç†å™¨ val job = GlobalScope.launch(handler) { // ç¬¬ä¸€ä¸ªå­åç¨‹ launch { try { // æ¨¡æ‹Ÿé•¿æ—¶é—´è¿è¡Œçš„ä»»åŠ¡ delay(Long.MAX_VALUE) } finally { // åœ¨å–æ¶ˆæ—¶æŠ›å‡º ArithmeticException throw ArithmeticException() } } // ç¬¬äºŒä¸ªå­åç¨‹ launch { try { // è¿›è¡ŒçŸ­æš‚çš„å»¶è¿Ÿ delay(100) } finally { // åœ¨å–æ¶ˆæ—¶æŠ›å‡º IOException throw IOException() } } // ç¬¬ä¸‰ä¸ªå­åç¨‹ launch { try { // è¿›è¡Œæ›´çŸ­æš‚çš„å»¶è¿Ÿ delay(10) } finally { // åœ¨å–æ¶ˆæ—¶æŠ›å‡º IndexOutOfBoundsException throw IndexOutOfBoundsException() } } } // ç­‰å¾…çˆ¶åç¨‹å®Œæˆï¼Œç¡®ä¿æ‰€æœ‰å­åç¨‹çš„å¼‚å¸¸éƒ½è¢«å¤„ç† job.join() } Flow-å¼‚æ­¥æµ // å®šä¹‰ä¸€ä¸ªåä¸º simpleFlow çš„æŒ‚èµ·å‡½æ•°ï¼Œè¿”å›ä¸€ä¸ª Flow\u0026lt;Int\u0026gt; suspend fun simpleFlow() = flow\u0026lt;Int\u0026gt; { // ä½¿ç”¨ for å¾ªç¯éå†ä» 1 åˆ° 100 çš„æ•´æ•° for (i in 1..100) { delay(1000) // å»¶è¿Ÿ 1 ç§’é’Ÿï¼Œæ¨¡æ‹Ÿå¼‚æ­¥ä»»åŠ¡çš„å»¶è¿Ÿ emit(i) // å‘ä¸‹æ¸¸å‘å°„å½“å‰æ•´æ•° } } // è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•å‡½æ•°ï¼Œæ¼”ç¤ºäº†å¼‚æ­¥ã€éé˜»å¡å¼çš„è¡Œä¸º @Test fun `test multiple values3`() = runBlocking\u0026lt;Unit\u0026gt; { // å¯åŠ¨ä¸€ä¸ªæ–°çš„åç¨‹ï¼Œä¸é˜»å¡ä¸»çº¿ç¨‹ launch { // ä½¿ç”¨ for å¾ªç¯æ‰“å°ä¿¡æ¯ï¼Œå±•ç¤ºä¸»çº¿ç¨‹æ²¡æœ‰è¢«é˜»å¡ for (k in 1..3) { println(\u0026#34;I am not blocked $k\u0026#34;) delay(1500) // å»¶è¿Ÿ 1.5 ç§’é’Ÿ } } // æ”¶é›† simpleFlow() å‘å°„çš„å€¼ simpleFlow().collect { value -\u0026gt; println(value) // æ‰“å°æ¯ä¸ªæ”¶é›†åˆ°çš„å€¼ } } å†·æµ Flowæ˜¯ä¸€ç§ç±»ä¼¼äºåºåˆ—çš„å†·æµï¼Œflowæ„å»ºå™¨ä¸­çš„ä»£ç ç›´åˆ°æµè¢«æ”¶é›†çš„æ—¶å€™æ‰è¿è¡Œ // æµ‹è¯•å‡½æ•°ï¼Œæ¼”ç¤º Flow æ˜¯å†·æµçš„æ¦‚å¿µ @Test fun `test flow is cold`() = runBlocking { // åˆ›å»ºä¸€ä¸ªæ–°çš„ Flow å®ä¾‹ val flow = simpleFlow2() // é¦–æ¬¡è°ƒç”¨ collectï¼Œå¼€å§‹æ”¶é›† Flow å‘å°„çš„å€¼ println(\u0026#34;Calling collect...\u0026#34;) flow.collect { value -\u0026gt; println(value) // æ‰“å°æ¯ä¸ªæ”¶é›†åˆ°çš„å€¼ } // å†æ¬¡è°ƒç”¨ collectï¼Œé‡æ–°æ”¶é›† Flow å‘å°„çš„å€¼ println(\u0026#34;Calling collect again...\u0026#34;) flow.collect { value -\u0026gt; println(value) // æ‰“å°æ¯ä¸ªæ”¶é›†åˆ°çš„å€¼ } } æµçš„è¿ç»­æ€§ æµçš„æ¯æ¬¡å•ç‹¬æ”¶é›†éƒ½æ˜¯æŒ‰é¡ºåºæ‰§è¡Œçš„ï¼Œé™¤éä½¿ç”¨ç‰¹æ®Šæ“ä½œç¬¦ ä»ä¸Šæ¸¸åˆ°ä¸‹æ¸¸æ¯ä¸ªè¿‡æ¸¡æ“ä½œç¬¦éƒ½ä¼šå¤„ç†æ¯ä¸ªå‘å°„å‡ºçš„å€¼ï¼Œç„¶åå†äº¤ç»™æœ«ç«¯æ“ä½œç¬¦ã€‚ // æµ‹è¯•å‡½æ•°ï¼Œæ¼”ç¤ºæµçš„è¿ç»­æ“ä½œ @Test fun `test flow continuation`() = runBlocking { // å°† 1 åˆ° 5 çš„æ•´æ•°è½¬æ¢æˆæµ (1..5).asFlow() // è¿‡æ»¤æµï¼Œåªä¿ç•™å¶æ•° .filter { it % 2 == 0 } // å°†æ¯ä¸ªæ•´æ•°è½¬æ¢ä¸ºå­—ç¬¦ä¸² .map { \u0026#34;String $it\u0026#34; } // æ”¶é›†æµä¸­çš„æ¯ä¸ªå…ƒç´  .collect { value -\u0026gt; println(\u0026#34;Collect $value\u0026#34;) // æ‰“å°æ”¶é›†åˆ°çš„æ¯ä¸ªå…ƒç´  } } æµæ„å»ºå™¨ flowOfæ„å»ºå™¨å®šä¹‰äº†ä¸€ä¸ªå‘å°„å›ºå®šå€¼é›†çš„æµã€‚ @Test fun `test flow continuation`() = runBlocking { // å°† 1 åˆ° 5 çš„æ•´æ•°è½¬æ¢æˆæµ (1..5).asFlow() // è¿‡æ»¤æµï¼Œåªä¿ç•™å¶æ•° .filter { it % 2 == 0 } // å°†æ¯ä¸ªæ•´æ•°è½¬æ¢ä¸ºå­—ç¬¦ä¸² .map { \u0026#34;String $it\u0026#34; } // æ”¶é›†æµä¸­çš„æ¯ä¸ªå…ƒç´  .collect { value -\u0026gt; println(\u0026#34;Collect $value\u0026#34;) // æ‰“å°æ”¶é›†åˆ°çš„æ¯ä¸ªå…ƒç´  } } ä½¿ç”¨.asFlow()æ‰©å±•å‡½æ•°ï¼Œå¯ä»¥å°†å„ç§é›†åˆä¸åºåˆ—è½¬æ¢ä¸ºæµã€‚ @Test fun `test flow builder2`() = runBlocking\u0026lt;Unit\u0026gt; { // åˆ›å»ºä¸€ä¸ªåŒ…å«ä¸‰ä¸ªå­—ç¬¦ä¸²å…ƒç´ çš„ Flowï¼š\u0026#34;one\u0026#34;ã€\u0026#34;two\u0026#34; å’Œ \u0026#34;three\u0026#34; flowOf(\u0026#34;one\u0026#34;, \u0026#34;two\u0026#34;, \u0026#34;three\u0026#34;) // å¯¹ Flow ä¸­çš„æ¯ä¸ªå…ƒç´ ï¼Œåº”ç”¨ 1000 æ¯«ç§’ï¼ˆ1 ç§’ï¼‰çš„å»¶è¿Ÿ .onEach { delay(1000) } // æ”¶é›† Flow ä¸­çš„æ¯ä¸ªå…ƒç´ ï¼Œå¹¶å°†å…¶æ‰“å°åˆ°æ§åˆ¶å° .collect { v -\u0026gt; println(v) } // å°†æ•´æ•°èŒƒå›´ä» 1 åˆ° 3 è½¬æ¢ä¸º Flow å¹¶æ”¶é›†æ¯ä¸ªå…ƒç´  (1..3).asFlow() .collect { println(it) // å°†æ¯ä¸ªæ”¶é›†åˆ°çš„æ•´æ•°æ‰“å°åˆ°æ§åˆ¶å° } } æµçš„ä¸Šä¸‹æ–‡ æµçš„æ”¶é›†æ€»æ˜¯åœ¨è°ƒç”¨åç¨‹çš„ä¸Šä¸‹æ–‡ä¸­å‘ç”Ÿï¼Œæµçš„è¯¥å±æ€§ç§°ä¸ºä¸Šä¸‹æ–‡ä¿å­˜ flow{...}æ„å»ºå™¨ä¸­çš„ä»£ç å¿…é¡»éµå¾ªä¸Šä¸‹æ–‡ä¿å­˜å±æ€§ï¼Œå¹¶ä¸”ä¸å…è®¸ä»å…¶ä»–ä¸Šä¸‹æ–‡ä¸­å‘å°„ï¼ˆemitï¼‰ flowOnæ“ä½œç¬¦ï¼Œè¯¥å‡½æ•°ç”¨äºæ›´æ”¹æµå‘å°„çš„ä¸Šä¸‹æ–‡ã€‚ // å®šä¹‰ä¸€ä¸ªç®€å•çš„ Flowï¼Œè¿”å› Int ç±»å‹çš„å€¼ fun simpleFlow5() = flow\u0026lt;Int\u0026gt; { // æ‰“å°å½“å‰çº¿ç¨‹çš„åç§°ï¼Œè¡¨æ˜ Flow å¼€å§‹æ‰§è¡Œ println(\u0026#34;Flow started ${Thread.currentThread().name}\u0026#34;) // ç”Ÿæˆä» 1 åˆ° 3 çš„æ•´æ•° for (i in 1..3) { // å»¶è¿Ÿ 1000 æ¯«ç§’ï¼ˆ1 ç§’ï¼‰æ¨¡æ‹Ÿè€—æ—¶æ“ä½œ delay(1000) // å‘å°„ï¼ˆemitï¼‰å½“å‰æ•´æ•° emit(i) } // è®¾ç½® Flow åœ¨é»˜è®¤çš„è°ƒåº¦å™¨ï¼ˆDispatcherï¼‰ä¸Šè¿è¡Œ }.flowOn(Dispatchers.Default) // æµ‹è¯•å‡½æ•°ï¼Œä½¿ç”¨ JUnit æµ‹è¯•æ¡†æ¶ @Test fun `test flow context3`() = runBlocking\u0026lt;Unit\u0026gt; { // æ”¶é›† Flow ä¸­å‘å°„çš„å€¼ simpleFlow5().collect { v -\u0026gt; // æ‰“å°å½“å‰çº¿ç¨‹çš„åç§°å’Œæ”¶é›†åˆ°çš„å€¼ println(\u0026#34;Collected $v ${Thread.currentThread().name}\u0026#34;) } } å¯åŠ¨æµ ä½¿ç”¨launchInæ›¿æ¢collectï¼Œå¯ä»¥åœ¨å•ç‹¬çš„åç¨‹ä¸­å¯åŠ¨æµçš„æ”¶é›†\n// å®šä¹‰ä¸€ä¸ª Flowï¼Œäº§ç”Ÿæ•´æ•° 1 åˆ° 3 fun events() = (1..3) .asFlow() // å°†æ•´æ•°èŒƒå›´è½¬æ¢ä¸º Flow .onEach { delay(100) } // å¯¹äºæ¯ä¸ªå…ƒç´ ï¼Œå»¶è¿Ÿ 100 æ¯«ç§’ .flowOn(Dispatchers.Default) // åœ¨é»˜è®¤çš„è°ƒåº¦å™¨ï¼ˆDispatcherï¼‰ä¸Šæ‰§è¡Œä¸Šè¿°æ“ä½œ // æµ‹è¯•å‡½æ•°ï¼Œä½¿ç”¨ JUnit æµ‹è¯•æ¡†æ¶ @Test fun `test flow launch`() = runBlocking { // ä½¿ç”¨ `launchIn` åœ¨æ–°çš„åç¨‹ä¸­æ”¶é›† Flow events() .onEach { event -\u0026gt; // æ‰“å°å½“å‰æ”¶åˆ°çš„å…ƒç´  println(event) } .launchIn(CoroutineScope(Dispatchers.IO)) // åœ¨ IO è°ƒåº¦å™¨ä¸Šå¯åŠ¨åç¨‹æ¥æ”¶é›† Flow .join() // ç­‰å¾…åç¨‹å®Œæˆ } æµçš„å–æ¶ˆ æµé‡‡ç”¨ä¸åç¨‹åŒæ ·çš„åä½œå–æ¶ˆã€‚åƒå¾€å¸¸ä¸€æ ·ï¼Œæµçš„æ”¶é›†å¯ä»¥æ˜¯å½“æµåœ¨ä¸€ä¸ªå¯å–æ¶ˆçš„æŒ‚èµ·å‡½æ•°ï¼ˆä¾‹å¦‚delayï¼‰ä¸­æŒ‚èµ·çš„æ—¶å€™å–æ¶ˆ fun simpleFlow6() = flow\u0026lt;Int\u0026gt; { // ç”Ÿæˆä» 1 åˆ° 3 çš„æ•´æ•° for (i in 1..3) { delay(1000) // å»¶è¿Ÿ 1000 æ¯«ç§’ï¼ˆ1 ç§’ï¼‰ï¼Œæ¨¡æ‹Ÿè€—æ—¶æ“ä½œ emit(i) // å‘å°„ï¼ˆemitï¼‰å½“å‰æ•´æ•° println(\u0026#34;Emitting $i\u0026#34;) // æ‰“å°å½“å‰å‘å°„çš„å€¼ï¼Œæ˜¾ç¤ºå‘å°„è¿‡ç¨‹ } } // æµ‹è¯•å‡½æ•°ï¼Œä½¿ç”¨ JUnit æµ‹è¯•æ¡†æ¶ @Test fun `test cancel flow`() = runBlocking\u0026lt;Unit\u0026gt; { // ä½¿ç”¨ withTimeoutOrNull æ¥å–æ¶ˆåç¨‹ï¼Œåœ¨è¶…æ—¶åè¿”å› null withTimeoutOrNull(2500) { // æ”¶é›† Flow ä¸­å‘å°„çš„å€¼ simpleFlow6().collect { v -\u0026gt; println(v) // æ‰“å°æ”¶é›†åˆ°çš„å€¼ } } // æ‰“å° \u0026#34;Done\u0026#34; è¡¨ç¤ºåç¨‹å·²å–æ¶ˆæˆ–æ­£å¸¸å®Œæˆ println(\u0026#34;Done!\u0026#34;) } æµçš„å–æ¶ˆæ£€æµ‹ ä¸ºæ–¹ä¾¿èµ·è§ï¼Œæµæ„å»ºå™¨å¯¹æ¯ä¸ªå‘å°„å€¼æ‰§è¡Œé™„åŠ çš„ensureActiveæ£€æµ‹ä»¥è¿›è¡Œå–æ¶ˆï¼Œè¿™æ„å‘³ç€ä»flow{...}å‘å‡ºçš„ç¹å¿™å¾ªç¯æ˜¯å¯ä»¥å–æ¶ˆçš„ã€‚ å‡ºäºæ€§èƒ½åŸå› ï¼Œå¤§å¤šæ•°å…¶ä»–æµæ“ä½œä¸ä¼šè‡ªåŠ¨æ‰§è¡Œå…¶ä»–å–æ¶ˆæ£€æµ‹ï¼Œåœ¨åç¨‹å¤„äºç¹å¿™å¾ªç¯çš„æƒ…å†µä¸‹ï¼Œå¿…é¡»æ˜ç¡®æ£€æµ‹æ˜¯å¦å–æ¶ˆã€‚ é€šè¿‡cancellableæ“ä½œç¬¦æ¥æ‰§è¡Œæ­¤æ“ä½œ fun simpleFlow7() = flow\u0026lt;Int\u0026gt; { for (i in 1..5) { emit(i) println(\u0026#34;Emitting $i\u0026#34;) } } @Test fun `test cancel flow check`() = runBlocking\u0026lt;Unit\u0026gt; { // å–æ¶ˆæˆåŠŸï¼Œå› ä¸ºemitä¼šsuspendå‡½æ•°ï¼Œæœ‰ensureActiveæ£€æµ‹ï¼Œæ‰€ä»¥cancelåä¼šå–æ¶ˆ simpleFlow7().collect { v -\u0026gt; println(v) if (v == 3) { cancel() // å½“å€¼ç­‰äº3æ—¶ï¼Œå–æ¶ˆæ”¶é›†è¿‡ç¨‹ println(\u0026#34;cancelled\u0026#34;) // æ‰“å° \u0026#34;cancelled\u0026#34; è¡¨ç¤ºæµå·²å–æ¶ˆ } } // å–æ¶ˆå¤±è´¥ï¼Œå…¶ä»–æµæ²¡æœ‰å–æ¶ˆæ£€æµ‹ // (1..5).asFlow().collect { v -\u0026gt; // println(v) // if (v == 3) { // cancel() // å½“å€¼ç­‰äº3æ—¶ï¼Œå–æ¶ˆæ”¶é›†è¿‡ç¨‹ // } // } // å–æ¶ˆæˆåŠŸï¼Œå› ä¸ºæ·»åŠ äº†.cancellable() // ä½¿ç”¨ cancellable() æ–¹æ³•å…è®¸æµåœ¨æ”¶é›†è¿‡ç¨‹ä¸­è¢«å–æ¶ˆ (1..5) .asFlow() .cancellable() .collect { v -\u0026gt; println(v) // æ‰“å°å½“å‰æ”¶é›†åˆ°çš„å€¼ if (v == 3) { cancel() // å½“å€¼ç­‰äº3æ—¶ï¼Œå–æ¶ˆæ”¶é›†è¿‡ç¨‹ } } // simpleFlow7() // .cancellable() // .collect { v -\u0026gt; // println(v) // æ‰“å°å½“å‰æ”¶é›†åˆ°çš„å€¼ // if (v == 3) { // cancel() // å½“å€¼ç­‰äº3æ—¶ï¼Œå–æ¶ˆæ”¶é›†è¿‡ç¨‹ // println(\u0026#34;cancelled\u0026#34;) // æ‰“å° \u0026#34;cancelled\u0026#34; è¡¨ç¤ºæµå·²å–æ¶ˆ // } // } } èƒŒå‹ buffer()ï¼Œå¹¶å‘è¿è¡Œæµä¸­å‘å°„å…ƒç´ çš„ä»£ç ã€‚\nconflate()ï¼Œåˆå¹¶å‘å°„é¡¹ç›®ï¼Œä¸å¯¹æ¯ä¸ªå€¼è¿›è¡Œå¤„ç†\ncollectLatest()ï¼Œå–æ¶ˆå¹¶é‡æ–°å‘å°„æœ€åä¸€ä¸ªå€¼\nå½“å¿…é¡»æ›´æ”¹CoroutineDispatcheræ—¶ï¼ŒflowOnæ“ä½œç¬¦ä½¿ç”¨äº†ç›¸åŒçš„ç¼“å†²æœºåˆ¶ï¼Œä½†æ˜¯bufferå‡½æ•°æ˜¾å¼åœ°è¯·æ±‚ç¼“å†²è€Œä¸æ”¹å˜æ‰§è¡Œä¸Šä¸‹æ–‡ã€‚\n@Test fun `test flow back pressure`() = runBlocking { // ä½¿ç”¨ measureTimeMillis è®¡ç®—æµçš„æ”¶é›†æ—¶é—´ val time = measureTimeMillis { simpleFlow8() // è°ƒç”¨å®šä¹‰çš„ç®€å•æµ // .flowOn(Dispatchers.Default) // ï¼ˆå¯é€‰ï¼‰ä½¿ç”¨ Default è°ƒåº¦å™¨åœ¨åå°çº¿ç¨‹ä¸Šæ‰§è¡Œæµ // .buffer(100) // ï¼ˆå¯é€‰ï¼‰ä½¿ç”¨ç¼“å†²ç­–ç•¥ä»¥åœ¨ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ä¹‹é—´æä¾› 100 ä¸ªå€¼çš„ç¼“å†²åŒº // .conflate() // ï¼ˆå¯é€‰ï¼‰åœ¨ä¸‹æ¸¸ç¹å¿™æ—¶åˆå¹¶æµçš„å€¼ï¼Œåªå¤„ç†æœ€æ–°çš„å€¼ .collectLatest { v -\u0026gt; // ä½¿ç”¨ collectLatest æ”¶é›†æµçš„æœ€æ–°å€¼ delay(300) // æ¨¡æ‹Ÿè€—æ—¶æ“ä½œï¼Œå»¶è¿Ÿ 300 æ¯«ç§’ println(\u0026#34;Collected $v ${Thread.currentThread().name}\u0026#34;) // æ‰“å°æ”¶é›†åˆ°çš„å€¼å’Œçº¿ç¨‹åç§° } } println(\u0026#34;Collected in $time ms\u0026#34;) // æ‰“å°æ€»å…±èŠ±è´¹çš„æ—¶é—´ } ","permalink":"https://kennems.github.io/posts/tech/kotlin%E5%8D%8F%E7%A8%8B2/","summary":"Kotlinåç¨‹(2) å¼‚å¸¸å¤„ç†çš„å¿…è¦æ€§ @OptIn(ExperimentalStdlibApi::class) // æ ‡è®°è¯¥ä»£ç ä½¿ç”¨äº†å®éªŒæ€§æ ‡å‡†åº“ API @Test // è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªæµ‹è¯•å‡½æ•° fun `test CoroutineContext extend2`() = runBlocking { // ä½¿ç”¨ runBlocking å¯åŠ¨åç¨‹ // åˆ›å»ºä¸€ä¸ªåç¨‹","title":"Kotlinåç¨‹(2)"},{"content":"Kotlinåç¨‹(1) çœ‹æ˜ç™½ï¼Œè®²æ¸…æ¥šã€‚\nåç¨‹å¤„ç†çš„é—®é¢˜ï¼š\nå¤„ç†è€—æ—¶ä»»åŠ¡ï¼Œ è¿™ç§ä»»åŠ¡å¸¸å¸¸ä¼šé˜»å¡ä¸»çº¿ç¨‹ ä¿è¯ä¸»çº¿ç¨‹å®‰å…¨ï¼Œå³ç¡®ä¿å®‰å…¨çš„ä»ä¸»çº¿ç¨‹è°ƒç”¨ä»»ä½•suspendå‡½æ•° å¼‚æ­¥ä»»åŠ¡ åç¨‹è®©å¼‚æ­¥é€»è¾‘åŒæ­¥åŒ–ï¼Œæœç»å›è°ƒåœ°ç‹± åç¨‹æœ€æ ¸å¿ƒçš„ç‚¹å°±æ˜¯ï¼šå‡½æ•°æˆ–ä¸€æ®µç¨‹åºèƒ½å¤Ÿè¢«æŒ‚èµ·ï¼Œç¨åå†åœ¨æŒ‚èµ·çš„ä½ç½®æ¢å¤ åç¨‹çš„æŒ‚èµ·ä¸æ¢å¤ å¸¸è§„å‡½æ•°åŸºç¡€æ“ä½œåŒ…æ‹¬ ï¼š invoke(call) å’Œ return, åç¨‹æ–°å¢äº† suspend å’Œ resume ï¼› suspend â€”â€” ä¹Ÿç§°ä¸ºæŒ‚èµ·æˆ–æš‚åœï¼Œç”¨äºæš‚åœæ‰§è¡Œå½“å‰åç¨‹ï¼Œå¹¶ä¿å­˜æ‰€æœ‰å±€éƒ¨å˜é‡ resumeâ€”â€”ç”¨äºè®©å·²æš‚åœçš„åç¨‹ä»å…¶æš‚åœå¤„ç»§ç»­æ‰§è¡Œ æŒ‚èµ·å‡½æ•° ä½¿ç”¨suspendå…³é”®å­—ä¿®é¥°çš„å‡½æ•°å«åšæŒ‚èµ·å‡½æ•° æŒ‚èµ·å‡½æ•°åªèƒ½åœ¨åç¨‹ä½“å†…æˆ–å…¶ä»–æŒ‚èµ·å‡½æ•°å†…è°ƒç”¨ Kotlinåç¨‹çš„ä¸¤éƒ¨åˆ† åŸºç¡€è®¾æ–½å±‚æ¬¡ï¼Œæ ‡å‡†åº“çš„åç¨‹APIï¼Œ ä¸»è¦å¯¹åç¨‹æä¾›äº†æ¦‚å¿µå’Œè¯­ä¹‰ä¸Šæœ€åŸºæœ¬çš„æ”¯æŒ ä¸šåŠ¡æ¡†æ¶å±‚ï¼Œåç¨‹çš„ä¸Šå±‚æ¡†æ¶æ”¯æŒ è°ƒåº¦å™¨ æ‰€æœ‰åç¨‹å¿…é¡»åœ¨è°ƒåº¦å™¨ä¸­è¿è¡Œï¼Œå³ä½¿å®ƒä»¬åœ¨ä¸»çº¿ç¨‹ä¸Šè¿è¡Œä¹Ÿæ˜¯å¦‚æ­¤ã€‚\nDispatchers.Main Androidä¸Šçš„ä¸»çº¿ç¨‹ï¼Œç”¨æ¥å¤„ç†UIäº¤äº’å’Œä¸€äº›è½»é‡çº§ä»»åŠ¡\nè°ƒç”¨suspendå‡½æ•° è°ƒç”¨UIå‡½æ•° æ›´æ–°LiveData Dispatchers.IO ä¸“ä¸ºç£ç›˜å’Œç½‘ç»œIOè¿›è¡Œäº†ä¼˜åŒ–\næ•°æ®åº“ æ–‡ä»¶è¯»å†™ ç½‘ç»œå¤„ç† Dispatchers.Default éä¸»çº¿ç¨‹ï¼Œä¸“ä¸ºCPUå¯†é›†å‹ä»»åŠ¡è¿›è¡Œäº†ä¼˜åŒ–\næ•°ç»„æ’åº JSONæ•°æ®è§£æ å¤„ç†å·®å¼‚åˆ¤æ–­ ä»»åŠ¡æ³„æ¼ ç±»ä¼¼å†…å­˜æ³„æ¼\nç»“æ„åŒ–å¹¶å‘ï¼š\nå–æ¶ˆä»»åŠ¡ï¼šå½“æŸé¡¹ä»»åŠ¡ä¸å†éœ€è¦æ—¶å–æ¶ˆå®ƒ\nè¿½è¸ªä»»åŠ¡ï¼Œå½“ä»»åŠ¡æ­£åœ¨æ‰§è¡Œæ—¶ï¼Œè¿½è¸ªå®ƒ å‘å‡ºé”™è¯¯ä¿¡å·ï¼Œå½“åç¨‹å¤±è´¥æ—¶ï¼Œ å‘å‡ºé”™è¯¯ä¿¡å·è¡¨æ˜æœ‰é”™è¯¯å‘ç”Ÿ Coroutine Scope å®šä¹‰åç¨‹å¿…é¡»æŒ‡å®šå…¶CoroutineScopeï¼Œ å®ƒä¼šè·Ÿè¸ªæ‰€æœ‰åç¨‹ï¼ŒåŒæ ·å®ƒè¿˜å¯ä»¥å–æ¶ˆç”±å®ƒå¯åŠ¨çš„æ‰€æœ‰åç¨‹\né‡ç”¨çš„ç›¸å…³APIæœ‰ï¼š\nGlobalScopeï¼šç”Ÿå‘½å‘¨æœŸæ˜¯processçº§åˆ«çš„ï¼Œå³ä½¿Activityï¼Œ Fragment å·²ç»è¢«é”€æ¯ï¼Œåç¨‹ä»ç„¶åœ¨æ‰§è¡Œ MainScopeï¼Œåœ¨Activityä¸­ä½¿ç”¨ï¼Œå¯ä»¥åœ¨onDestroy()ä¸­å–æ¶ˆåç¨‹ viewModelScopeï¼Œåªèƒ½åœ¨ViewModelä¸­ä½¿ç”¨ï¼Œç»‘å®šViewModelçš„å£°æ˜å‘¨æœŸ lifecycleScopeï¼Œåªèƒ½åœ¨Activityï¼ŒFragmentä¸­ä½¿ç”¨ï¼Œä¼šç»‘å®šActivity å’Œ Fragmentçš„ç”Ÿå‘½å‘¨æœŸ åç¨‹ä½¿ç”¨ retrofit API // å®šä¹‰ UserServiceApi æ¥å£ï¼Œç”¨äºå£°æ˜ä¸ç”¨æˆ·ç›¸å…³çš„APIè¯·æ±‚ interface UserServiceApi { // å£°æ˜ä¸€ä¸ª GET è¯·æ±‚ï¼Œç”¨äºåŠ è½½æŒ‡å®šåç§°çš„ç”¨æˆ·ä¿¡æ¯ // @Query æ³¨è§£è¡¨ç¤ºè¯·æ±‚ä¸­çš„æŸ¥è¯¢å‚æ•° \u0026#34;name\u0026#34;ï¼Œä¼šé™„åŠ åˆ°URLä¸­ // è¿”å›ç±»å‹æ˜¯ Call\u0026lt;User\u0026gt;ï¼Œè¡¨ç¤ºä¸€ä¸ªå¼‚æ­¥çš„ HTTP è¯·æ±‚ï¼Œå¯ä»¥é€šè¿‡ enqueue æ–¹æ³•æ‰§è¡Œ @GET(\u0026#34;user\u0026#34;) fun loadUser(@Query(\u0026#34;name\u0026#34;) name: String): Call\u0026lt;User\u0026gt; // å£°æ˜ä¸€ä¸ª GET è¯·æ±‚ï¼Œä½¿ç”¨ Kotlin çš„åç¨‹æœºåˆ¶ // suspend å…³é”®å­—è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªæŒ‚èµ·å‡½æ•°ï¼Œå¯ä»¥åœ¨åç¨‹ä¸­è¢«è°ƒç”¨ // è¿”å›ç±»å‹æ˜¯ Userï¼Œè¡¨ç¤ºç›´æ¥è¿”å›è§£æåçš„ç”¨æˆ·å¯¹è±¡ @GET(\u0026#34;user\u0026#34;) suspend fun getUser(@Query(\u0026#34;name\u0026#34;) name: String): User } // åˆ›å»ºä¸€ä¸ªæ‡’åŠ è½½çš„ userServiceApi å®ä¾‹ï¼Œä½¿ç”¨ Retrofit æ„å»ºå™¨ val userServiceApi: UserServiceApi by lazy { // ä½¿ç”¨ Retrofit.Builder æ„å»º Retrofit å®ä¾‹ val retrofit = retrofit2.Retrofit.Builder() // è®¾ç½® API è¯·æ±‚çš„åŸºç¡€ URL .baseUrl(\u0026#34;https://apifoxmock.com/m1/4944163-4601795-default/kotlinstudyserver/\u0026#34;) // æ·»åŠ ä¸€ä¸ªè½¬æ¢å·¥å‚ï¼Œè¿™é‡Œä½¿ç”¨ MoshiConverterFactory æ¥è§£æ JSON æ•°æ® .addConverterFactory(MoshiConverterFactory.create()) // æ„å»º Retrofit å®ä¾‹ .build() // åˆ›å»ºå¹¶è¿”å› UserServiceApi çš„å…·ä½“å®ç° retrofit.create(UserServiceApi::class.java) } User data class User(val name: String, val address: String) UserRepository.kt class UserRepository { // å£°æ˜ä¸€ä¸ªæŒ‚èµ·å‡½æ•° getUserï¼Œç”¨äºè·å–ç”¨æˆ·ä¿¡æ¯ // è¯¥å‡½æ•°åœ¨åç¨‹ä¸­æ‰§è¡Œ suspend fun getUser(name: String): User { // è°ƒç”¨ userServiceApi çš„ getUser æ–¹æ³•ï¼Œä¼ é€’ç”¨æˆ·åç§°ä½œä¸ºå‚æ•° // userServiceApi æ˜¯ä¸€ä¸ª API æ¥å£å®ä¾‹ï¼Œè¿”å›çš„ User å¯¹è±¡è¡¨ç¤ºç”¨æˆ·ä¿¡æ¯ return userServiceApi.getUser(name) } } MainViewModel.kt // MainViewModel ç»§æ‰¿è‡ª ViewModelï¼Œç”¨äºç®¡ç†ä¸ç”¨æˆ·ç›¸å…³çš„ UI æ•°æ®å’Œä¸šåŠ¡é€»è¾‘ class MainViewModel : ViewModel() { // MutableLiveData ç”¨äºå­˜å‚¨å’Œè§‚å¯Ÿç”¨æˆ·æ•°æ®çš„ LiveData // å¯ä»¥åœ¨ UI ç»„ä»¶ä¸­è§‚å¯Ÿ userLiveDataï¼Œå½“æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶æ›´æ–° UI val userLiveData = MutableLiveData\u0026lt;User\u0026gt;() // åˆ›å»º UserRepository å®ä¾‹ï¼Œç”¨äºè·å–ç”¨æˆ·æ•°æ® private val userRepository = UserRepository() // getUser å‡½æ•°ç”¨äºä» UserRepository è·å–ç”¨æˆ·æ•°æ®ï¼Œå¹¶å°†å…¶å­˜å‚¨åˆ° userLiveData ä¸­ fun getUser(name: String) { // ä½¿ç”¨ viewModelScope å¯åŠ¨åç¨‹ï¼ŒviewModelScope æ˜¯ä¸€ä¸ªä¸ ViewModel ç”Ÿå‘½å‘¨æœŸç›¸å…³è”çš„åç¨‹èŒƒå›´ viewModelScope.launch { // è°ƒç”¨ UserRepository çš„ getUser æ–¹æ³•ï¼Œè·å–ç”¨æˆ·ä¿¡æ¯ // å°†è·å–çš„ç”¨æˆ·ä¿¡æ¯è®¾ç½®åˆ° userLiveData ä¸­ï¼Œè§¦å‘è§‚å¯Ÿè€…æ›´æ–° UI userLiveData.value = userRepository.getUser(name) } } } Activity // MainActivity7 ç»§æ‰¿è‡ª AppCompatActivityï¼Œç”¨äºæ˜¾ç¤ºä¸»ç•Œé¢ class MainActivity7 : AppCompatActivity() { // ä½¿ç”¨ viewModels å§”æ‰˜æ¥è·å– MainViewModel å®ä¾‹ private val mainViewModel: MainViewModel by viewModels() // å­˜å‚¨å¯¹ TextView çš„å¼•ç”¨ï¼ˆå¯é€‰ï¼Œåç»­å¯ä»¥ç”¨æ¥æ›´æ–° UIï¼‰ private var nameTextView: TextView? = null // åˆ›å»ºä¸€ä¸ª MainScope å®ä¾‹ï¼Œç”¨äºç®¡ç†åç¨‹ç”Ÿå‘½å‘¨æœŸ // å·¥å‚è®¾è®¡æ¨¡å¼å®ä¾‹åŒ– MainScope private val mainScope = MainScope() @SuppressLint(\u0026#34;StaticFieldLeak\u0026#34;) // SuppressLint æ³¨è§£ç”¨äºå¿½ç•¥é™æ€å­—æ®µæ³„æ¼è­¦å‘Š override fun onCreate(savedInstanceState: Bundle?) { super.onCreate(savedInstanceState) // å¯ç”¨è¾¹ç¼˜åˆ°è¾¹ç¼˜æ¨¡å¼ï¼Œä»¥ä½¿å¸ƒå±€å¡«å……æ•´ä¸ªå±å¹• enableEdgeToEdge() // è®¾ç½®æ´»åŠ¨çš„å¸ƒå±€ setContentView(R.layout.activity_main7) // ä½¿ç”¨ ViewCompat å’Œ WindowInsetsCompat å¤„ç†ç³»ç»Ÿçª—å£çš„å†…è¾¹è· ViewCompat.setOnApplyWindowInsetsListener(findViewById(R.id.main)) { v, insets -\u0026gt; // è·å–ç³»ç»Ÿçª—å£çš„å†…è¾¹è· val systemBars = insets.getInsets(WindowInsetsCompat.Type.systemBars()) // è®¾ç½®è§†å›¾çš„å†…è¾¹è·ï¼Œé¿å…è¢«ç³»ç»Ÿçª—å£é®æŒ¡ v.setPadding(systemBars.left, systemBars.top, systemBars.right, systemBars.bottom) // è¿”å›å¤„ç†åçš„ insets insets } // ä½¿ç”¨ DataBindingUtil ç»‘å®šå¸ƒå±€æ–‡ä»¶ä¸è§†å›¾æ¨¡å‹ val binding = DataBindingUtil.setContentView\u0026lt;ActivityMain7Binding\u0026gt;(this, R.layout.activity_main7) // å°† ViewModel ç»‘å®šåˆ°å¸ƒå±€ binding.viewModel = mainViewModel // è®¾ç½®ç”Ÿå‘½å‘¨æœŸæ‰€æœ‰è€…ï¼Œä½¿æ•°æ®ç»‘å®šå¯ä»¥è§‚å¯Ÿ LiveData binding.lifecycleOwner = this // è®¾ç½®æäº¤æŒ‰é’®çš„ç‚¹å‡»ç›‘å¬å™¨ binding.submitButton.setOnClickListener(View.OnClickListener { // å½“æŒ‰é’®è¢«ç‚¹å‡»æ—¶ï¼Œè°ƒç”¨ ViewModel çš„ getUser æ–¹æ³• // è¿™é‡Œä½¿ç”¨ \u0026#34;ken\u0026#34; ä½œä¸ºæŸ¥è¯¢å‚æ•° mainViewModel.getUser(\u0026#34;ken\u0026#34;) }) } // æ´»åŠ¨é”€æ¯æ—¶å–æ¶ˆåç¨‹ï¼Œé‡Šæ”¾èµ„æº override fun onDestroy() { super.onDestroy() // å–æ¶ˆæ‰€æœ‰åœ¨ MainScope ä¸­å¯åŠ¨çš„åç¨‹ mainScope.cancel() } } åç¨‹æ„å»ºå™¨ launchä¸asyncæ„å»ºå™¨éƒ½ç”¨æ¥å¯åŠ¨æ–°åç¨‹ launchï¼Œè¿”å› Job å¹¶ä¸”ä¸é™„å¸¦ä»»ä½•ç»“æœå€¼ asyncï¼Œè¿”å›ä¸€ä¸ªDeferredï¼ŒDeferredä¹Ÿæ˜¯ä¸€ä¸ªJobï¼Œå¯ä»¥ä½¿ç”¨.await()åœ¨ä¸€ä¸ªå»¶æœŸçš„å€¼ä¸Šå¾—åˆ°å®ƒçš„æœ€ç»ˆç»“æœ ç­‰å¾…ä¸€ä¸ªä½œä¸š joinå’Œawait ç»„åˆå¹¶å‘ åç¨‹çš„å¯åŠ¨æ¨¡å¼ DEFAULTï¼šåç¨‹åˆ›å»ºåï¼Œç«‹å³å¼€å§‹è°ƒåº¦ï¼Œåœ¨è°ƒåº¦å‰å¦‚æœåç¨‹è¢«å–æ¶ˆï¼Œå…¶å°†ç›´æ¥è¿›å…¥å–æ¶ˆå“åº”çš„çŠ¶æ€ ATOMICï¼šåç¨‹åˆ›å»ºåï¼Œç«‹å³å¼€å§‹è°ƒåº¦ï¼Œåç¨‹æ‰§è¡Œåˆ°ç¬¬ä¸€ä¸ªæŒ‚èµ·ç‚¹ä¹‹å‰ä¸å“åº”å–æ¶ˆ LAZYï¼šåªæœ‰åç¨‹è¢«éœ€è¦æ—¶ï¼ŒåŒ…æ‹¬ä¸»åŠ¨è°ƒç”¨åç¨‹çš„startï¼Œjoinæˆ–è€…awaitç­‰å‡½æ•°æ—¶æ‰ä¼šå¼€å§‹è°ƒåº¦ï¼Œå¦‚æœè°ƒåº¦å‰å°±è¢«å–æ¶ˆï¼Œé‚£ä¹ˆè¯¥åç¨‹å°†ç›´æ¥è¿›å…¥å¼‚å¸¸ç»“æŸçŠ¶æ€ UNDISPATCHEDï¼šåç¨‹åˆ›å»ºåç«‹å³åœ¨å½“å‰å‡½æ•°è°ƒç”¨æ ˆä¸­æ‰§è¡Œï¼Œç›´åˆ°é‡åˆ°ç¬¬ä¸€ä¸ªçœŸæ­£æŒ‚èµ·çš„ç‚¹ coroutineScope ä¸ runBlocking runBlockingæ˜¯å¸¸è§„å‡½æ•°ï¼Œè€ŒcoroutineScopeæ˜¯æŒ‚èµ·å‡½æ•° å®ƒä»¬éƒ½ä¼šç­‰å¾…å…¶åç¨‹ä½“ä»¥åŠæ‰€æœ‰å­åç¨‹ç»“æŸï¼Œä¸»è¦åŒºåˆ«åœ¨äºrunBlockingæ–¹æ³•ä¼šé˜»å¡å½“å‰çº¿ç¨‹æ¥ç­‰å¾…ï¼Œè€ŒcoroutineScopeåªæ˜¯æŒ‚èµ·ï¼Œä¼šé‡Šæ”¾åº•å±‚çº¿ç¨‹ç”¨äºå…¶ä»–ç”¨é€” åŒºåˆ«ï¼š\ncoroutineScopeï¼šä¸€ä¸ªåç¨‹å¤±è´¥äº†ï¼Œæ‰€æœ‰å…¶ä»–å…„å¼Ÿåç¨‹ä¹Ÿä¼šè¢«å–æ¶ˆ supervisorScopeï¼šä¸€ä¸ªåç¨‹å¤±è´¥äº†ï¼Œä¸ä¼šå½±å“å…¶ä»–å…„å¼Ÿåç¨‹ Jobå¯¹è±¡ å¯¹äºæ¯ä¸€ä¸ªåˆ›å»ºçš„åç¨‹ï¼ˆé€šè¿‡launchæˆ–è€…asyncï¼‰ï¼Œä¼šè¿”å›ä¸€ä¸ªJobå®ä¾‹ï¼Œè¯¥å®ä¾‹æ˜¯åç¨‹çš„å”¯ä¸€æ ‡è¯†ï¼Œå¹¶ä¸”è´Ÿè´£ç®¡ç†åç¨‹çš„ç”Ÿå‘½å‘¨æœŸ ä¸€ä¸ªä»»åŠ¡å¯ä»¥åŒ…å«ä¸€ç³»åˆ—çŠ¶æ€ï¼Œæ–°åˆ›å»ºï¼ˆNewï¼‰ã€æ´»è·ƒï¼ˆActiveï¼‰ã€å®Œæˆä¸­ï¼ˆCompletingï¼‰ã€å·²å®Œæˆï¼ˆCompletedï¼‰ã€å–æ¶ˆä¸­ï¼ˆCancellingï¼‰å’Œå·²å–æ¶ˆï¼ˆCancelledï¼‰ã€‚å¯ä»¥è®¿é—®Jobçš„å±æ€§ï¼šisActiveï¼ŒisCancelledå’ŒisCompletedã€‚ Jobçš„ç”Ÿå‘½å‘¨æœŸ å¦‚æœåç¨‹å¤„äºæ´»è·ƒçŠ¶æ€ï¼Œåç¨‹è¿è¡Œå‡ºé”™æˆ–è€…è°ƒç”¨ job.cancel() éƒ½ä¼šå°†å½“å‰ä»»åŠ¡ç½®ä¸ºå–æ¶ˆä¸­ï¼ˆCancellingï¼‰çŠ¶æ€ï¼ˆisActive = false, isCancelled = trueï¼‰ã€‚å½“æ‰€æœ‰çš„å­åç¨‹éƒ½å®Œæˆåï¼Œåç¨‹ä¼šè¿›å…¥å·²å–æ¶ˆï¼ˆCancelledï¼‰ã€‚\n@Test fun `test scope cancel`() = runBlocking\u0026lt;Unit\u0026gt; { // åˆ›å»ºä¸€ä¸ª CoroutineScopeï¼ŒæŒ‡å®šä½¿ç”¨ Default è°ƒåº¦å™¨ val scope = CoroutineScope(Dispatchers.Default) // å¯åŠ¨ç¬¬ä¸€ä¸ªåç¨‹ï¼Œå»¶è¿Ÿ 1000 æ¯«ç§’åæ‰“å° \u0026#34;job 1\u0026#34; scope.launch { delay(1000) println(\u0026#34;job 1\u0026#34;) } // å¯åŠ¨ç¬¬äºŒä¸ªåç¨‹ï¼Œå»¶è¿Ÿ 1000 æ¯«ç§’åæ‰“å° \u0026#34;job 2\u0026#34; scope.launch { delay(1000) println(\u0026#34;job 2\u0026#34;) } // å»¶è¿Ÿ 100 æ¯«ç§’ï¼Œç¡®ä¿å‰é¢ä¸¤ä¸ªåç¨‹æœ‰æ—¶é—´å¯åŠ¨ // delay(100) // å–æ¶ˆ scope ä¸­çš„æ‰€æœ‰åç¨‹ // scope.cancel() // ä¸¤ä¸ªå‡ä¸æ‰“å° // å»¶è¿Ÿ 1500 æ¯«ç§’ï¼Œç¡®ä¿å¯ä»¥çœ‹åˆ°åç¨‹çš„è¾“å‡ºï¼ˆå¦‚æœå®ƒä»¬æ²¡æœ‰è¢«å–æ¶ˆçš„è¯ï¼‰ delay(1500) // ä¸¤ä¸ªå¯ä»¥æ­£å¸¸æ‰“å° } @Test fun `test brother cancel`() = runBlocking\u0026lt;Unit\u0026gt; { // åˆ›å»ºä¸€ä¸ª CoroutineScopeï¼ŒæŒ‡å®šä½¿ç”¨ Default è°ƒåº¦å™¨ val scope = CoroutineScope(Dispatchers.Default) // å¯åŠ¨ç¬¬ä¸€ä¸ªåç¨‹ï¼Œå»¶è¿Ÿ 1000 æ¯«ç§’åæ‰“å° \u0026#34;job 1\u0026#34; val job1 = scope.launch { delay(1000) println(\u0026#34;job 1\u0026#34;) } // å¯åŠ¨ç¬¬äºŒä¸ªåç¨‹ï¼Œå»¶è¿Ÿ 1000 æ¯«ç§’åæ‰“å° \u0026#34;job 2\u0026#34; val job2 = scope.launch { delay(1000) println(\u0026#34;job 2\u0026#34;) } // å»¶è¿Ÿ 100 æ¯«ç§’ï¼Œç¡®ä¿å‰é¢ä¸¤ä¸ªåç¨‹æœ‰æ—¶é—´å¯åŠ¨ delay(100) // å–æ¶ˆ job1ï¼Œä½†ä¸å–æ¶ˆ job2 job1.cancel() // å»¶è¿Ÿ 1500 æ¯«ç§’ï¼Œç¡®ä¿å¯ä»¥çœ‹åˆ° job2 çš„è¾“å‡º delay(1500) } å–æ¶ˆåç¨‹ åœ¨cancel()åä¿è¯åç¨‹è¢«å–æ¶ˆ\n@Test fun `test cancel cpu task by isActive`() = runBlocking\u0026lt;Unit\u0026gt; { // è·å–å½“å‰æ—¶é—´çš„æ¯«ç§’æ•°ï¼Œç”¨äºè®¡ç®—ä»»åŠ¡æ‰§è¡Œçš„æ—¶é—´ç‚¹ val startTime = System.currentTimeMillis() // å¯åŠ¨ä¸€ä¸ªåç¨‹ï¼Œè¿è¡Œåœ¨é»˜è®¤è°ƒåº¦å™¨ä¸Šï¼ˆé€šå¸¸æ˜¯åå°çº¿ç¨‹ï¼‰ val job = launch(Dispatchers.Default) { var nextPrintTime = startTime // ä¸‹æ¬¡æ‰“å°ä¿¡æ¯çš„æ—¶é—´ var i = 0 // è®¡æ•°å™¨ï¼Œç”¨äºé™åˆ¶ä»»åŠ¡æ‰§è¡Œæ¬¡æ•° // å¾ªç¯æ‰§è¡Œï¼Œç›´åˆ°è¾¾åˆ°5æ¬¡æˆ–åç¨‹è¢«å–æ¶ˆ while (i \u0026lt; 5 \u0026amp;\u0026amp; isActive) { // æ£€æŸ¥æ˜¯å¦åˆ°è¾¾ä¸‹ä¸€ä¸ªæ‰“å°æ—¶é—´ç‚¹ if (System.currentTimeMillis() \u0026gt;= nextPrintTime) { // æ‰“å°å½“å‰çŠ¶æ€å’Œè®¡æ•°å™¨ println(\u0026#34;job: I\u0026#39;m sleeping ${i++}\u0026#34;) nextPrintTime += 500 // æ›´æ–°ä¸‹æ¬¡æ‰“å°çš„æ—¶é—´ } } } // å»¶è¿Ÿ 1300 æ¯«ç§’ï¼Œæ¨¡æ‹Ÿä¸»çº¿ç¨‹çš„ç­‰å¾…æ—¶é—´ delay(1300) // ä¸»çº¿ç¨‹è¾“å‡ºï¼Œè¡¨ç¤ºç­‰å¾…çš„æ—¶é—´ç»“æŸ println(\u0026#34;main : I\u0026#39;m tired of waiting\u0026#34;) // å–æ¶ˆ job åç¨‹å¹¶ç­‰å¾…å…¶å®Œå…¨ç»“æŸ job.cancelAndJoin() // ä¸»çº¿ç¨‹è¾“å‡ºï¼Œè¡¨ç¤ºå¯ä»¥é€€å‡ºäº† println(\u0026#34;main : Now I can quit.\u0026#34;) } @Test fun `test cancel cpu task by ensureActive`() = runBlocking\u0026lt;Unit\u0026gt; { // è·å–å½“å‰æ—¶é—´çš„æ¯«ç§’æ•°ï¼Œç”¨äºè®¡ç®—ä»»åŠ¡æ‰§è¡Œçš„æ—¶é—´ç‚¹ val startTime = System.currentTimeMillis() // å¯åŠ¨ä¸€ä¸ªåç¨‹ï¼Œè¿è¡Œåœ¨é»˜è®¤è°ƒåº¦å™¨ä¸Šï¼ˆé€šå¸¸æ˜¯åå°çº¿ç¨‹ï¼‰ val job = launch(Dispatchers.Default) { var nextPrintTime = startTime // ä¸‹æ¬¡æ‰“å°ä¿¡æ¯çš„æ—¶é—´ var i = 0 // è®¡æ•°å™¨ï¼Œç”¨äºé™åˆ¶ä»»åŠ¡æ‰§è¡Œæ¬¡æ•° // å¾ªç¯æ‰§è¡Œï¼Œç›´åˆ°è¾¾åˆ°5æ¬¡ while (i \u0026lt; 5) { // ç¡®ä¿åç¨‹å¤„äºæ´»è·ƒçŠ¶æ€ï¼Œå¦‚æœåç¨‹å·²å–æ¶ˆåˆ™ä¼šæŠ›å‡º CancellationException ensureActive() // æ£€æŸ¥æ˜¯å¦åˆ°è¾¾ä¸‹ä¸€ä¸ªæ‰“å°æ—¶é—´ç‚¹ if (System.currentTimeMillis() \u0026gt;= nextPrintTime) { // æ‰“å°å½“å‰çŠ¶æ€å’Œè®¡æ•°å™¨ println(\u0026#34;job: I\u0026#39;m sleeping ${i++}\u0026#34;) nextPrintTime += 500 // æ›´æ–°ä¸‹æ¬¡æ‰“å°çš„æ—¶é—´ } } } // å»¶è¿Ÿ 1300 æ¯«ç§’ï¼Œæ¨¡æ‹Ÿä¸»çº¿ç¨‹çš„ç­‰å¾…æ—¶é—´ delay(1300) // ä¸»çº¿ç¨‹è¾“å‡ºï¼Œè¡¨ç¤ºç­‰å¾…çš„æ—¶é—´ç»“æŸ println(\u0026#34;main : I\u0026#39;m tired of waiting\u0026#34;) // å–æ¶ˆ job åç¨‹å¹¶ç­‰å¾…å…¶å®Œå…¨ç»“æŸ job.cancelAndJoin() // ä¸»çº¿ç¨‹è¾“å‡ºï¼Œè¡¨ç¤ºå¯ä»¥é€€å‡ºäº† println(\u0026#34;main : Now I can quit.\u0026#34;) } CPUå¯†é›†å‹ä»»åŠ¡å–æ¶ˆ isActiveæ˜¯ä¸€ä¸ªå¯ä»¥è¢«ä½¿ç”¨åœ¨CoroutineScopeä¸­çš„æ‰©å±•å±æ€§ï¼Œæ£€æŸ¥Jobæ˜¯å¦å¤„äºæ´»è·ƒçŠ¶æ€\nensureActive()ï¼Œ å¦‚æœjobå¤„äºéæ´»è·ƒçŠ¶æ€ï¼Œè¿™ä¸ªæ–¹æ³•ä¼šç«‹å³æŠ›å‡ºå¼‚å¸¸\nyieldå‡½æ•°ä¼šæ£€æŸ¥æ‰€åœ¨åç¨‹çš„çŠ¶æ€ï¼Œå¦‚æœå·²ç»å–æ¶ˆï¼Œåˆ™æŠ›å‡ºCancellationExcepitonäºˆä»¥ç›¸åº”ã€‚æ­¤å¤–ï¼Œå®ƒè¿˜ä¼šå°è¯•è®©å‡ºçº¿ç¨‹çš„æ‰§è¡Œæƒï¼Œç»™å…¶ä»–åç¨‹æä¾›æ‰§è¡Œæœºä¼šã€‚\nåç¨‹å–æ¶ˆçš„å‰¯ä½œç”¨ åœ¨finallyä¸­é‡Šæ”¾èµ„æºã€‚\n@Test fun `test release resources`() = runBlocking\u0026lt;Unit\u0026gt; { val job = launch { try { repeat(1000){ it-\u0026gt; println(\u0026#34;job : I\u0026#39;m sleeping $it ...\u0026#34;) delay(500L) } } catch (e: Exception) { println(\u0026#34;Job: I\u0026#39;m running finally\u0026#34;) // é‡Šæ”¾èµ„æº } } delay(1300) println(\u0026#34;main : I\u0026#39;m tired of waiting\u0026#34;) job.cancelAndJoin() println(\u0026#34;main : Now I can quit.\u0026#34;) } useå‡½æ•°ï¼šè¯¥å‡½æ•°åªèƒ½è¢«å®ç°äº†Closeableçš„å¯¹è±¡ä½¿ç”¨ï¼Œç¨‹åºç»“æŸçš„æ—¶å€™ä¼šè‡ªåŠ¨è°ƒç”¨closeæ–¹æ³•ï¼Œé€‚åˆæ–‡ä»¶å¯¹è±¡ã€‚\n@Test fun `test use function`() = runBlocking\u0026lt;Unit\u0026gt; { // ä½¿ç”¨ use å‡½æ•°è‡ªåŠ¨ç®¡ç†èµ„æº // use å‡½æ•°ä¼šè‡ªåŠ¨å…³é—­èµ„æºï¼Œæ— éœ€æ‰‹åŠ¨è°ƒç”¨ close BufferedReader(FileReader(\u0026#34;D:\\\\test\\\\test.txt\u0026#34;)).use { var line: String? // æ— é™å¾ªç¯è¯»å–æ–‡ä»¶å†…å®¹ï¼Œç›´åˆ°æ–‡ä»¶æœ«å°¾ while (true) { // è¯»å–ä¸€è¡Œå†…å®¹ï¼Œå¦‚æœä¸º nullï¼ˆæ–‡ä»¶æœ«å°¾ï¼‰ï¼Œåˆ™é€€å‡ºå¾ªç¯ line = it.readLine() ?: break println(line) // æ‰“å°æ¯ä¸€è¡Œå†…å®¹ } } } ä¸èƒ½è¢«å–æ¶ˆçš„ä»»åŠ¡ @Test fun `test cancel with NonCancellable`() = runBlocking\u0026lt;Unit\u0026gt; { // å¯åŠ¨ä¸€ä¸ªæ–°çš„åç¨‹ val job = launch { try { // åœ¨åç¨‹ä¸­é‡å¤æ‰§è¡Œä»»åŠ¡1000æ¬¡ repeat(1000) { it -\u0026gt; println(\u0026#34;job : I\u0026#39;m sleeping $it ...\u0026#34;) // æ‰“å°å½“å‰ä»»åŠ¡çš„çŠ¶æ€ delay(500L) // æš‚åœ500æ¯«ç§’ } } finally { // è¿™é‡Œçš„ä»£ç å—åœ¨åç¨‹å–æ¶ˆæ—¶æ‰§è¡Œ // ä½¿ç”¨ NonCancellable ä¸Šä¸‹æ–‡ï¼Œç¡®ä¿è¿™ä¸ªä»£ç å—ä¸­çš„ä»»åŠ¡ä¸ä¼šè¢«å–æ¶ˆ withContext(NonCancellable) { println(\u0026#34;job: I\u0026#39;m running finally\u0026#34;) // æ‰“å°æ¶ˆæ¯ï¼Œè¡¨ç¤ºè¿›å…¥äº† finally éƒ¨åˆ† delay(1000L) // è¿™é‡Œçš„å»¶è¿Ÿä¸ä¼šè¢«å–æ¶ˆï¼Œå³ä½¿åç¨‹å·²ç»è¢«å–æ¶ˆ println(\u0026#34;job: And I\u0026#39;ve just delayed for 1 sec \u0026#34;) // æ‰“å°å»¶è¿Ÿåçš„æ¶ˆæ¯ } } } // ä¸»åç¨‹å»¶è¿Ÿ1300æ¯«ç§’ï¼Œç»™å­åç¨‹è¶³å¤Ÿçš„æ—¶é—´è¿è¡Œ delay(1300) println(\u0026#34;main: I\u0026#39;m tired of waiting!\u0026#34;) // æ‰“å°ä¸»åç¨‹ç­‰å¾…çš„æ¶ˆæ¯ // å–æ¶ˆå­åç¨‹å¹¶ç­‰å¾…å®ƒå®Œæˆ job.cancelAndJoin() println(\u0026#34;main: Now I can quit.\u0026#34;) // æ‰“å°ä¸»åç¨‹å®Œæˆåçš„æ¶ˆæ¯ } è¶…æ—¶ä»»åŠ¡ å–æ¶ˆåç¨‹çš„ç†ç”±æ˜¯æœ‰å¯èƒ½è¶…æ—¶ withTimeoutOrNull é€šè¿‡è¿”å›nullæ¥è¿›è¡Œè¶…æ—¶æ“ä½œï¼Œä»è€Œæ›¿ä»£æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ @Test fun `test deal with timeout`() = runBlocking { // ä½¿ç”¨ withTimeout å‡½æ•°è®¾ç½®è¶…æ—¶æ—¶é—´ withTimeout(1300L) { // è®¾ç½®æœ€å¤§æ‰§è¡Œæ—¶é—´ä¸º1300æ¯«ç§’ repeat(1000) { i -\u0026gt; // è®¡åˆ’æ‰§è¡Œ1000æ¬¡ä»»åŠ¡ println(\u0026#34;job: I\u0026#39;m sleeping $i ...\u0026#34;) // æ‰“å°å½“å‰ä»»åŠ¡çš„çŠ¶æ€ delay(500L) // æ¯ä¸ªä»»åŠ¡æš‚åœ500æ¯«ç§’ } } } @Test fun `test deal with timeout return null`() = runBlocking { // ä½¿ç”¨ withTimeoutOrNull å‡½æ•°è®¾ç½®è¶…æ—¶æ—¶é—´å¹¶å¤„ç†è¶…æ—¶è¿”å› null val result = withTimeoutOrNull(1300L) { // è®¾ç½®æœ€å¤§æ‰§è¡Œæ—¶é—´ä¸º1300æ¯«ç§’ repeat(1000) { i -\u0026gt; // è®¡åˆ’æ‰§è¡Œ1000æ¬¡ä»»åŠ¡ println(\u0026#34;job: I\u0026#39;m sleeping $i ...\u0026#34;) // æ‰“å°å½“å‰ä»»åŠ¡çš„çŠ¶æ€ delay(500L) // æ¯ä¸ªä»»åŠ¡æš‚åœ500æ¯«ç§’ } \u0026#34;Done\u0026#34; // å¦‚æœåœ¨1300æ¯«ç§’å†…å®Œæˆæ‰€æœ‰ä»»åŠ¡ï¼Œå°†è¿”å› \u0026#34;Done\u0026#34; } // æ‰“å° result ç»“æœï¼Œå¦‚æœä»»åŠ¡åœ¨è¶…æ—¶æ—¶é—´å†…å®Œæˆï¼Œåˆ™ result ä¸º \u0026#34;Done\u0026#34;ï¼Œå¦åˆ™ä¸º null println(\u0026#34;Result is $result\u0026#34;) } åç¨‹ä¸Šä¸‹æ–‡ CoroutineContextæ˜¯ä¸€ç»„ç”¨äºå®šä¹‰åç¨‹è¡Œä¸ºçš„å…ƒç´ ï¼Œå®ƒç”±å¦‚ä¸‹å‡ é¡¹æ„æˆï¼š\nJobï¼šæ§åˆ¶åç¨‹çš„ç”Ÿå‘½å‘¨æœŸ CoroutineDispatcherï¼šå‘åˆé€‚çš„çº¿ç¨‹åˆ†å‘ä»»åŠ¡ CoroutineNameï¼šåç¨‹çš„åç§°ï¼Œè°ƒè¯•çš„æ—¶å€™å¾ˆæœ‰ç”¨ CoroutineExceptionHandlerï¼šå¤„ç†æœªè¢«æ•æ‰çš„å¼‚å¸¸ ç»„åˆä¸Šä¸‹æ–‡ä¸­çš„å…ƒç´  æœ‰æ—¶æˆ‘ä»¬éœ€è¦åœ¨åç¨‹ä¸Šä¸‹æ–‡ä¸­å®šä¹‰å¤šä¸ªå…ƒç´ ã€‚å¯ä»¥ä½¿ç”¨ + æ“ä½œç¬¦æ¥å®ç°ã€‚ @Test fun `test CoroutineContext`() = runBlocking\u0026lt;Unit\u0026gt; { launch(Dispatchers.Default + CoroutineName(\u0026#34;test\u0026#34;)) { println(\u0026#34;I\u0026#39;m working in thread ${Thread.currentThread().name}\u0026#34;) } } åç¨‹ä¸Šä¸‹æ–‡çš„ç»§æ‰¿ åç¨‹çš„ä¸Šä¸‹æ–‡ = é»˜è®¤å€¼ + ç»§æ‰¿çš„CoroutineContext + å‚æ•°\n","permalink":"https://kennems.github.io/posts/tech/kotlin%E5%8D%8F%E7%A8%8B1/","summary":"Kotlinåç¨‹(1) çœ‹æ˜ç™½ï¼Œè®²æ¸…æ¥šã€‚ åç¨‹å¤„ç†çš„é—®é¢˜ï¼š å¤„ç†è€—æ—¶ä»»åŠ¡ï¼Œ è¿™ç§ä»»åŠ¡å¸¸å¸¸ä¼šé˜»å¡ä¸»çº¿ç¨‹ ä¿è¯ä¸»çº¿ç¨‹å®‰å…¨ï¼Œå³ç¡®ä¿å®‰å…¨çš„ä»ä¸»çº¿ç¨‹è°ƒç”¨ä»»ä½•su","title":"Kotlinåç¨‹(1)"},{"content":"Kotlinåç¨‹(5) Binding è§†å›¾ç»‘å®š\nView Binding: é€šè¿‡View Bindingï¼Œ Android ä¼šä¸ºæ¯ä¸ªXMLå¸ƒå±€æ–‡ä»¶è‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªç»‘å®šç±»ã€‚åœ¨è¿™ä¸ªç±»ä¸­ï¼Œæ¯ä¸ªViewéƒ½æœ‰ä¸€ä¸ªç›´æ¥å¯¹åº”çš„å±æ€§ï¼Œå¯ä»¥é¿å…findViewByIdçš„ä½¿ç”¨ï¼Œä»è€Œå‡å°‘äº†æ‰‹åŠ¨æŸ¥æ‰¾è§†å›¾å’Œç±»å‹è½¬æ¢çš„å·¥ä½œã€‚æé«˜ä»£ç çš„å®‰å…¨æ€§å’Œå¯è¯»æ€§ã€‚ val binding = ActivityMainBinding.inflate(layoutInflater) setContentView(binding.root) binding.textView.text = \u0026#34;Hello World\u0026#34; Data Binding: åŠŸèƒ½æ¯”View Binding æ›´ä¸ºå¼ºå¤§ï¼Œå…è®¸åœ¨å¸ƒå±€æ–‡ä»¶ä¸­ç›´æ¥ç»‘å®šUIç»„ä»¶åˆ°æ•°æ®æºï¼ˆå¦‚ViewModelï¼‰ï¼Œè¿™æ ·ï¼Œæ•°æ®çš„å˜åŒ–ä¼šè‡ªåŠ¨æ›´æ–°UI \u0026lt;data\u0026gt; \u0026lt;variable name=\u0026#34;user\u0026#34; type=\u0026#34;com.example.User\u0026#34;/\u0026gt; \u0026lt;/data\u0026gt; \u0026lt;TextView android:text=\u0026#34;@{user.name}\u0026#34;/\u0026gt; Activityä¸­ï¼š\nval binding: ActivityMainBinding = DataBindingUtil.setContentView(this, R.layout.activity_main) binding.user = userObject Holder Holderé€šå¸¸æŒ‡çš„æ˜¯ViewHolderï¼Œç”¨äºåœ¨RecyclerViewä¸­å¤ç”¨è§†å›¾çš„ä¸€ç§è®¾è®¡æ¨¡å¼ã€‚ViewHolderä¸»è¦ç”¨äºå­˜å‚¨è§†å›¾å¼•ç”¨ï¼Œä»è€Œé¿å…é¢‘ç¹è°ƒç”¨findViewByIdï¼Œæé«˜RecyclerViewçš„æ€§èƒ½ã€‚\nViewHolderçš„ä½œç”¨ ç¼“å­˜è§†å›¾ï¼šåœ¨ ViewHolderä¸­ç¼“å­˜äº†æ¯ä¸ªå­é¡¹çš„è§†å›¾å¼•ç”¨ï¼Œå‡å°‘ä¸å¿…è¦çš„è§†å›¾æŸ¥æ‰¾ã€‚ æœç”¨è§†å›¾ï¼šé€šè¿‡å¤ç”¨ ViewHolderå¯¹è±¡ï¼Œé¿å…åœ¨æ»šåŠ¨æ—¶é‡å¤åˆ›å»ºå’Œé”€æ¯è§†å›¾ï¼Œæé«˜æ€§èƒ½ã€‚ class MyViewHolder(itemView: View) : RecyclerView.ViewHolder(itemView) { val textView: TextView = itemView.findViewById(R.id.text_view) } override fun onBindViewHolder(holder: MyViewHolder, position: Int) { holder.textView.text = data[position] } åœ¨RecyclerViewä¸­ï¼Œå½“ä¸€ä¸ªæ–°çš„å­é¡¹éœ€è¦æ˜¾ç¤ºæ—¶ï¼Œç³»ç»Ÿä¼šä½¿ç”¨å·²ç»åˆ›å»ºå¥½çš„ViewHolderï¼Œå¹¶é€šè¿‡onBindViewHolderæ–¹æ³•ç»‘å®šæ•°æ®åˆ°è§†å›¾ä¸Šï¼Œä»è€Œé¿å…é‡å¤åˆ›å»ºè§†å›¾ã€‚\nHilt è´Ÿè´£æ‰˜ç®¡å¯¹è±¡ä¸å¯¹è±¡ä¹‹é—´çš„æ³¨å…¥å…³ç³»\næ³¨è§£ @HiltAndroidAppï¼šè§¦å‘ Hilt çš„ä»£ç ç”Ÿæˆã€‚ @AndroidEntryPointï¼šåˆ›å»ºä¸€ä¸ªä¾èµ–å®¹å™¨ï¼Œè¯¥å®¹å™¨éµå¾ª Android ç±»çš„ç”Ÿå‘½å‘¨æœŸã€‚ @Moduleï¼šå‘Šè¯‰ Hilt å¦‚ä½•æä¾›ä¸åŒç±»å‹çš„å®ä¾‹ã€‚ @InstallInï¼šInstall ç”¨æ¥å‘Šè¯‰ Hilt è¿™ä¸ªæ¨¡å—ä¼šè¢«è£…é…åˆ°å“ªä¸ªç»„ä»¶ä¸Šã€‚ @Providesï¼šå‘Šè¯‰ Hilt å¦‚ä½•è·å¾—å…·ä½“å®ä¾‹ã€‚ @Singletonï¼šå•ä¾‹ã€‚ @ViewModelInjectï¼šé€šè¿‡æ„é€ å‡½æ•°ï¼Œç»™ ViewModel æ³¨å…¥å®ä¾‹ã€‚ Data Mapper ä½¿ç”¨Data Mapper åˆ†ç¦»æ•°æ®æºçš„Modelå’Œé¡µé¢æ˜¾ç¤ºçš„Modelï¼Œ ä¸è¦å› ä¸ºæ•°æ®æºçš„å¢åŠ ï¼Œä¿®æ”¹æˆ–è€…åˆ é™¤ï¼Œå¯¼è‡´ä¸Šå±‚é¡µé¢ä¹Ÿè¦è·Ÿç€ä¸€èµ·ä¿®æ”¹ã€‚\nCoil Coil æ˜¯ä¸€ä¸ªç”¨äº Android çš„å›¾åƒåŠ è½½åº“ï¼Œå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š\næ€§èƒ½ä¼˜è¶Šï¼šåœ¨æ€§èƒ½ä¸Šè¡¨ç°å‡ºè‰²ã€‚ ä½“ç§¯è¾ƒå°ï¼šä¸ Picasso ç›¸æ¯”ï¼Œä½“ç§¯å°ï¼Œä¸”ä½äº Glide å’Œ Frescoã€‚ ç®€å•æ˜“ç”¨ï¼šä¸ Kotlin å…¼å®¹ï¼ŒAPI ç®€å•ç›´è§‚ã€‚ æŠ€æœ¯å…ˆè¿›ï¼šåŸºäº Coroutineã€OkHttpã€Okio ç­‰ç°ä»£æŠ€æœ¯ï¼Œç¡®ä¿æŠ€æœ¯çš„å…ˆè¿›æ€§ã€‚ ä¸°å¯ŒåŠŸèƒ½ï¼šæ”¯æŒç¼“å­˜ç®¡ç†ï¼ˆå†…å­˜å’Œç£ç›˜ç¼“å­˜ï¼‰ã€åŠ¨æ€å›¾åƒé‡‡æ ·ç­‰ï¼Œæå‡å›¾åƒåŠ è½½æ•ˆç‡ã€‚ Coil æ—¨åœ¨æä¾›é«˜æ•ˆçš„å›¾åƒåŠ è½½è§£å†³æ–¹æ¡ˆï¼Œç‰¹åˆ«é€‚åˆ Kotlin å¼€å‘è€…ã€‚\nLoadType PagingState pages: List\u0026lt;Page\u0026lt;Key, Value\u0026raquo; è¿”å›çš„ä¸Šä¸€é¡µçš„æ•°æ®ï¼Œä¸»è¦ç”¨äºè·å–ä¸Šä¸€é¡µæœ€åä¸€æ¡æ•°æ®ä½œä¸ºä¸‹ä¸€é¡µçš„å¼€å§‹ä½ç½®ã€‚ configï¼šPagingConfigè¿”å›çš„åˆå§‹åŒ–ä½ç½®çš„PagingConfigåŒ…å«äº†pageSizeï¼ŒprefetchDistanceï¼Œ initialLoadSizeç­‰ç­‰ã€‚ MediatorResult è¯·æ±‚å‡ºç°é”™è¯¯ï¼Œè¿”å›MediatorResult.Error(e) è¯·æ±‚æˆåŠŸä¸”æœ‰æ•°æ®ï¼Œè¿”å›MediatorResult.Success(endOfPaginationReached = true)ã€‚ è¯·æ±‚æˆåŠŸä½†æ˜¯æ²¡æœ‰æ•°æ®ï¼Œè¿”å›MediatorResult.Success(endOfPaginationReached = false)ã€‚ CarBrandRemoteMediator.kt @OptIn(ExperimentalPagingApi::class) class CarBrandRemoteMediator( private val api: CarBrandService, // ä¾èµ–æ³¨å…¥çš„APIæœåŠ¡ï¼Œç”¨äºè¯·æ±‚ç½‘ç»œæ•°æ® private val database: AppDatabase // ä¾èµ–æ³¨å…¥çš„æ•°æ®åº“å®ä¾‹ï¼Œç”¨äºæ•°æ®å­˜å‚¨ ) : RemoteMediator\u0026lt;Int, CarBrandEntity\u0026gt;() { // è´Ÿè´£åŠ è½½åˆ†é¡µæ•°æ®çš„æ ¸å¿ƒæ–¹æ³• override suspend fun load( loadType: LoadType, // åŠ è½½ç±»å‹ï¼Œå¯èƒ½æ˜¯REFRESHã€PREPENDæˆ–APPEND state: PagingState\u0026lt;Int, CarBrandEntity\u0026gt; // ç”¨äºè·å–å½“å‰åˆ†é¡µçŠ¶æ€ ): MediatorResult { try { Log.d(\u0026#34;Kennem\u0026#34;, \u0026#34;loadType = ${loadType}\u0026#34;) // ç¡®å®šå½“å‰è¯·æ±‚çš„é¡µç  val pageKey = when (loadType) { // é¦–æ¬¡åŠ è½½æˆ–æ‰‹åŠ¨åˆ·æ–°æ—¶ï¼Œä¸éœ€è¦é¡µç ï¼Œè®¾ä¸ºnull LoadType.REFRESH -\u0026gt; null // å‘å‰åŠ è½½æ•°æ®æ—¶ï¼Œç›´æ¥è¿”å›ï¼Œä¸ç»§ç»­è¯·æ±‚ï¼Œæ ‡è®°ä¸ºåˆ†é¡µç»“æŸ LoadType.PREPEND -\u0026gt; return MediatorResult.Success(endOfPaginationReached = true) // å‘ååŠ è½½æ›´å¤šæ•°æ®æ—¶ï¼Œè·å–æœ€åä¸€é¡¹çš„æ•°æ®é¡µç ä½œä¸ºæ–°çš„é¡µç  LoadType.APPEND -\u0026gt; { val lastItem: CarBrandEntity = state.lastItemOrNull() ?: return MediatorResult.Success(endOfPaginationReached = true) lastItem.page } } // æ— ç½‘ç»œï¼ŒåŠ è½½æœ¬åœ°æ•°æ® if (!AppHelper.mContext.isConnectedNetWork()){ MediatorResult.Success(endOfPaginationReached = true) } // è¯·æ±‚ç½‘ç»œåˆ†é¡µæ•°æ®ï¼ŒpageKeyä¸ºnullæ—¶é»˜è®¤è¯·æ±‚ç¬¬ä¸€é¡µæ•°æ® val page = pageKey ?: 0 val result = api.fetchCarBrandList( page * state.config.pageSize, // æ ¹æ®é¡µç å’Œé¡µé¢å¤§å°è®¡ç®—è¯·æ±‚çš„åç§»é‡ state.config.pageSize // é¡µé¢å¤§å° ) // å°†ç½‘ç»œæ•°æ®æ˜ å°„ä¸ºæ•°æ®åº“å®ä½“ val item = result.map { CarBrandEntity( id = it.id, name = it.name, icon = it.icon, page = page + 1 // å°†é¡µç åŠ ä¸€ï¼Œæ ‡è®°ä¸ºä¸‹ä¸€æ¬¡è¯·æ±‚çš„é¡µç  ) } // åˆ¤æ–­æ˜¯å¦åˆ°è¾¾åˆ†é¡µæœ«ç«¯ val endOfPaginationReached = result.isEmpty() // è·å–DAOæ“ä½œå¯¹è±¡ val carBrandDao = database.carBrandDao() // ä½¿ç”¨äº‹åŠ¡æ’å…¥æ•°æ®ï¼Œä¿è¯æ•°æ®ä¸€è‡´æ€§ database.withTransaction { if (loadType == LoadType.REFRESH) { // å¦‚æœæ˜¯åˆ·æ–°æ“ä½œï¼Œæ¸…ç©ºå·²æœ‰çš„æ•°æ® carBrandDao.clearCarBrand() } // æ’å…¥æ–°æ•°æ® carBrandDao.insertCarBrand(item) } // è¿”å›åŠ è½½ç»“æœï¼Œæ ‡è®°æ˜¯å¦åˆ°è¾¾åˆ†é¡µæœ«ç«¯ return MediatorResult.Success(endOfPaginationReached = endOfPaginationReached) } catch (e: Exception) { e.printStackTrace() // æ•è·å¼‚å¸¸ï¼Œè¿”å›é”™è¯¯ç»“æœ return MediatorResult.Error(e) } } } App Startup App Startup æ˜¯ Android Jetpack æœ€æ–°æˆå‘˜ï¼Œæä¾›äº†åœ¨Appå¯åŠ¨æ—¶åˆå§‹åŒ–ç»„ä»¶ç®€å•ã€é«˜æ•ˆçš„æ–¹æ³•ï¼Œæ— è®ºæ˜¯libraryå¼€å‘äººå‘˜è¿˜æ˜¯Appå¼€å‘äººå‘˜éƒ½å¯ä»¥ä½¿ç”¨App Startupæ˜¾å¼çš„è®¾ç½®åˆå§‹åŒ–é¡ºåºã€‚ /** * AppInitializer æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰çš„åº”ç”¨åˆå§‹åŒ–ç±»ï¼Œç”¨äºåœ¨åº”ç”¨å¯åŠ¨æ—¶è¿›è¡Œå¿…è¦çš„åˆå§‹åŒ–æ“ä½œã€‚ * å®ƒå®ç°äº† androidx.startup.Initializer æ¥å£ã€‚ */ class AppInitializer : Initializer\u0026lt;Unit\u0026gt; { /** * create æ–¹æ³•åœ¨åº”ç”¨å¯åŠ¨æ—¶è¢«è°ƒç”¨ï¼Œç”¨äºæ‰§è¡Œåˆå§‹åŒ–é€»è¾‘ã€‚ * * @param context åº”ç”¨ç¨‹åºçš„ä¸Šä¸‹æ–‡ï¼Œç”¨äºåˆå§‹åŒ–æ“ä½œ */ override fun create(context: Context) { // è°ƒç”¨ AppHelper çš„ init æ–¹æ³•è¿›è¡Œåˆå§‹åŒ–æ“ä½œ AppHelper.init(context) } /** * dependencies æ–¹æ³•ç”¨äºå£°æ˜å½“å‰ Initializer æ‰€ä¾èµ–çš„å…¶ä»– Initializerã€‚ * è¿™é‡Œè¿”å›ä¸€ä¸ªç©ºçš„åˆ—è¡¨ï¼Œè¡¨ç¤ºæ²¡æœ‰ä¾èµ–é¡¹ã€‚ * * @return MutableList\u0026lt;Class\u0026lt;out Initializer\u0026lt;*\u0026gt;\u0026gt;\u0026gt; å½“å‰åˆå§‹åŒ–å™¨çš„ä¾èµ–é¡¹åˆ—è¡¨ */ override fun dependencies(): MutableList\u0026lt;Class\u0026lt;out Initializer\u0026lt;*\u0026gt;\u0026gt;\u0026gt; = mutableListOf() } AndroidManifest.xml æ·»åŠ provideréƒ¨åˆ†\n\u0026lt;provider android:name=\u0026#34;androidx.startup.InitializationProvider\u0026#34; android:authorities=\u0026#34;${applicationId}.androidx-startup\u0026#34; android:exported=\u0026#34;false\u0026#34; tools:node=\u0026#34;merge\u0026#34;\u0026gt; \u0026lt;meta-data android:name=\u0026#34;com.show.carhome.init.AppInitializer\u0026#34; android:value=\u0026#34;androidx.startup\u0026#34; /\u0026gt; \u0026lt;/provider\u0026gt; ","permalink":"https://kennems.github.io/posts/tech/kotlin%E5%8D%8F%E7%A8%8B5/","summary":"Kotlinåç¨‹(5) Binding è§†å›¾ç»‘å®š View Binding: é€šè¿‡View Bindingï¼Œ Android ä¼šä¸ºæ¯ä¸ªXMLå¸ƒå±€æ–‡ä»¶è‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªç»‘å®šç±»ã€‚åœ¨è¿™ä¸ªç±»ä¸­ï¼Œæ¯ä¸ªViewéƒ½æœ‰ä¸€ä¸ª","title":"Kotlinåç¨‹(5)"},{"content":"Hugoé…ç½®ä¸ä½¿ç”¨ ä¸‹è½½PaperModä¸»é¢˜ï¼š\ngit clone https://github.com/adityatelange/hugo-PaperMod themes/PaperMod --depth=1 ç”Ÿæˆpublicå†…å®¹æ—¶æ¸…ç©ºæ–‡ä»¶å¤¹\nhugo -F --cleanDestinationDir æ–°å»ºpost\nhugo new content posts/my-first-post.md å®ŒæˆGit pushæµç¨‹\necho \u0026#34;# showguan.github.io\u0026#34; \u0026gt;\u0026gt; README.md git init git add README.md git commit -m \u0026#34;first commit\u0026#34; git branch -M main git remote add origin https://github.com/showguan/showguan.github.io.git git push -u origin main git remote add origin https://github.com/showguan/showguan.github.io.git git branch -M main git push -u origin main å¼ºåˆ¶pushåˆ°ä»“åº“\ngit push -f -u origin main git remote add origin \u0026lt;è¿œç¨‹ä»£ç åº“çš„URL\u0026gt; ç¬¬å…­æ­¥ï¼šåœ¨ä¸Šé¢åˆ›å»ºçš„githubæ–‡ä»¶ä¸­ï¼Œæ”¾å…¥è¦ä¸Šä¼ çš„ä»£ç ï¼Œç„¶åæŒ‰ç…§ä¸Šé¢çš„æŒ‡ä»¤å¼€å§‹æ“ä½œï¼Œæ‰§è¡ŒæŒ‡ä»¤ 1ã€git init ï¼ˆå»ºç«‹æœ¬åœ°ä»“åº“ï¼‰ 2ã€git add * (å°†ä»£ç æ·»åŠ åˆ°æœ¬åœ°ä»“åº“ï¼Œã€Š*æ˜¯æ·»åŠ å…¨éƒ¨ä»£ç ï¼Œä»£ç å…¨éƒ¨æ›´æ–°ã€‹) 3ã€git commit -m \u0026#34;first commit\u0026#34; (æäº¤åˆ°æœ¬åœ°ç¼“å†²ï¼Œã€Šå¼•å·é‡Œè¯´æ˜æäº¤äº†ä»€ä¹ˆä¸œè¥¿ï¼Œè¯´ç™½äº†å°±æ˜¯æ³¨é‡Šã€‹ï¼‰ Gitä»£ç†ç®¡ç† //http || https git config --global http.proxy 127.0.0.1:10809 git config --global https.proxy 127.0.0.1:10809 //sock5ä»£ç† git config --global http.proxy socks5 127.0.0.1:10808 git config --global https.proxy socks5 127.0.0.1:10808 git config --global --unset http.proxy git config --global --unset https.proxy æœ€ç»ˆçš„åŸå› ï¼š å®ƒæ§åˆ¶ç€åœ¨æäº¤å’Œæ£€å‡ºæ–‡ä»¶æ—¶æ˜¯å¦è‡ªåŠ¨åœ°å°†è¡Œç»“æŸç¬¦è½¬æ¢ä¸ºä¸åŒçš„æ ¼å¼ã€‚\ngit config --global core.autocrlf false Front Matter --- title: \u0026#34;æˆ‘çš„ç¬¬ä¸€ç¯‡æ–‡ç« \u0026#34; subtitle: \u0026#34;\u0026#34; date: 2020-03-04T15:58:26+08:00 lastmod: 2020-03-04T15:58:26+08:00 draft: true author: \u0026#34;\u0026#34; authorLink: \u0026#34;\u0026#34; description: \u0026#34;\u0026#34; license: \u0026#34;\u0026#34; tags: [] categories: [] hiddenFromHomePage: false featured_image: \u0026#34;\u0026#34; featured_image_preview: \u0026#34;\u0026#34; toc: false autoCollapseToc: true math: true mapbox: accessToken: \u0026#34;\u0026#34; lightStyle: \u0026#34;\u0026#34; darkStyle: \u0026#34;\u0026#34; navigation: true geolocate: true scale: true fullscreen: true lightgallery: true linkToMarkdown: true share: enable: true comment: true --- --- title: \u0026#34;My 1st post\u0026#34; date: 2020-09-15T11:30:03+00:00 # weight: 1 # aliases: [\u0026#34;/first\u0026#34;] tags: [\u0026#34;first\u0026#34;] author: \u0026#34;Me\u0026#34; # author: [\u0026#34;Me\u0026#34;, \u0026#34;You\u0026#34;] # multiple authors showToc: true TocOpen: false draft: false hidemeta: false comments: false description: \u0026#34;Desc Text.\u0026#34; canonicalURL: \u0026#34;https://canonical.url/to/page\u0026#34; disableHLJS: true # to disable highlightjs disableShare: false disableHLJS: false hideSummary: false searchHidden: true ShowReadingTime: true ShowBreadCrumbs: true ShowPostNavLinks: true ShowWordCount: true ShowRssButtonInSectionTermList: true UseHugoToc: true cover: image: \u0026#34;\u0026lt;image path/url\u0026gt;\u0026#34; # image path/url alt: \u0026#34;\u0026lt;alt text\u0026gt;\u0026#34; # alt text caption: \u0026#34;\u0026lt;text\u0026gt;\u0026#34; # display caption under cover relative: false # when using page bundles set this to true hidden: true # only hide on current single page editPost: URL: \u0026#34;https://github.com/\u0026lt;path_to_repo\u0026gt;/content\u0026#34; Text: \u0026#34;Suggest Changes\u0026#34; # edit text appendFilePath: true # to append file path to Edit link --- ä¸è’œå­æµé‡ç»Ÿè®¡ \u0026lt;script async src=\u0026#34;https://cdn.dusays.com/bsz.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt;\ræœ¬æ–‡æ€»é˜…è¯»é‡ \u0026lt;span id=\u0026#34;busuanzi_value_page_pv\u0026#34;\u0026gt;\u0026lt;/span\u0026gt; æ¬¡\ræœ¬æ–‡æ€»è®¿å®¢é‡ \u0026lt;span id=\u0026#34;busuanzi_value_page_uv\u0026#34;\u0026gt;\u0026lt;/span\u0026gt; äºº\ræœ¬ç«™æ€»è®¿é—®é‡ \u0026lt;span id=\u0026#34;busuanzi_value_site_pv\u0026#34;\u0026gt;\u0026lt;/span\u0026gt; æ¬¡\ræœ¬ç«™æ€»è®¿å®¢æ•° \u0026lt;span id=\u0026#34;busuanzi_value_site_uv\u0026#34;\u0026gt;\u0026lt;/span\u0026gt; äºº config.yaml baseURL: https://kyxie.github.io/ languageCode: en-ca # zh-cn title: Kunyang\u0026#39;s Blog theme: PaperMod enableInlineShortcodes: true enableEmoji: true # allowing using emoji enableRobotsTXT: true hasCJKLanguage: true buildDrafts: false buildFuture: false buildExpired: false #googleAnalytics: UA-123-45 paginate: 15 # articles per page minify: disableXML: true # minifyOutput: true permalinks: post: \u0026#34;/:title/\u0026#34; # post: \u0026#34;/:year/:month/:day/:title/\u0026#34; defaultContentLanguage: en # prefer language defaultContentLanguageInSubdir: true languages: en: languageName: \u0026#34;EnglishğŸ‡¨ğŸ‡¦\u0026#34; contentDir: content/English weight: 1 profileMode: enabled: true title: Kyrie Xie subtitle: \u0026#34;Welcome to my site!\u0026#34; # imageUrl: \u0026#34;Avatar.png\u0026#34; imageUrl: \u0026#34;Selfie.png\u0026#34; imageTitle: Selfie imageWidth: 150 imageHeight: 150 buttons: - name: About url: about - name: Project url: projects - name: Resume url: resume.pdf menu: main: - identifier: About name: About url: about weight: 1 - identifier: Projects name: Project url: projects weight: 2 - identifier: Resume name: Resume url: resume.pdf weight: 3 - identifier: Blog name: Blogs url: blog weight: 4 - identifier: Search name: Search url: search weight: 5 zh: languageName: \u0026#34;ä¸­æ–‡ğŸ‡¨ğŸ‡³\u0026#34; contentDir: content/Chinese weight: 2 profileMode: enabled: true title: è°¢å¤æ´‹ subtitle: \u0026#34;æ¬¢è¿æ¥åˆ°æˆ‘çš„ç½‘ç«™ï¼\u0026#34; # imageUrl: \u0026#34;Avatar.png\u0026#34; imageUrl: \u0026#34;Selfie.png\u0026#34; imageTitle: Selfie imageWidth: 150 imageHeight: 150 buttons: - name: å…³äº url: about - name: åšå®¢ url: blog - name: ç®€å† url: resume.pdf menu: main: - identifier: About name: å…³äº url: about weight: 1 - identifier: Projects name: é¡¹ç›® url: projects weight: 2 - identifier: Resume name: ç®€å† url: resume.pdf weight: 3 - identifier: Blog name: åšå®¢ url: blog weight: 4 - identifier: Comments name: ç•™è¨€æ¿ url: comment/comments weight: 5 - identifier: Links name: å‹é“¾ url: links weight: 6 - identifier: Search name: æœç´¢ url: search weight: 7 outputs: home: - HTML - RSS - JSON params: env: production # to enable google analytics, opengraph, twitter-cards and schema. title: Kyrie author: Kyrie defaultTheme: dark # defaultTheme: light or dark disableThemeToggle: false DateFormat: \u0026#34;2006-01-02\u0026#34; ShowShareButtons: true ShowReadingTime: true # disableSpecialistPost: true disableScrollToTop: false displayFullLangName: true ShowPostNavLinks: true ShowBreadCrumbs: true ShowCodeCopyButtons: true hideFooter: false # hide foot ShowWordCounts: true VisitCount: true ShowLastMod: true ShowToc: true TocOpen: true comments: true socialIcons: - name: instagram url: \u0026#34;https://www.instagram.com/_kyxie/\u0026#34; - name: github url: \u0026#34;https://github.com/kyxie\u0026#34; - name: linkedin url: \u0026#34;https://www.linkedin.com/in/kunyang-kyrie-xie-557270194/\u0026#34; # - name: qq # url: \u0026#34;qq.jpg\u0026#34; - name: wechat url: \u0026#34;wechat.jpg\u0026#34; - name: weibo url: \u0026#34;https://weibo.com/u/5687393723\u0026#34; - name: bilibili url: \u0026#34;https://space.bilibili.com/156752850?spm_id_from=333.1007.0.0\u0026#34; - name: strava url: \u0026#34;https://www.strava.com/athletes/62343657\u0026#34; - name: email url: \u0026#34;mailto:kyriexie@outlook.com\u0026#34; assets: favicon: \u0026#34;k-48.png\u0026#34; favicon16x16: \u0026#34;k-48.png\u0026#34; favicon32x32: \u0026#34;k-48.png\u0026#34; apple_touch_icon: \u0026#34;k-48.png\u0026#34; safari_pinned_tab: \u0026#34;k-48.png\u0026#34; label: text: \u0026#34;Home\u0026#34; fuseOpts: isCaseSensitive: false shouldSort: true location: 0 distance: 1000 threshold: 1 minMatchCharLength: 0 keys: [\u0026#34;title\u0026#34;, \u0026#34;permalink\u0026#34;, \u0026#34;summary\u0026#34;] twikoo: version: 1.4.11 taxonomies: category: categories tag: tags series: series markup: goldmark: renderer: unsafe: true highlight: # anchorLineNos: true codeFences: true guessSyntax: true lineNos: true # noClasses: false style: monokai lineNos: false privacy: vimeo: disabled: false simple: true twitter: disabled: false enableDNT: true simple: true instagram: disabled: false simple: true youtube: disabled: false privacyEnhanced: true services: instagram: disableInlineCSS: true twitter: disableInlineCSS: true languages: en: languageName: \u0026#34;English\u0026#34; # contentDir: content/english weight: 1 profileMode: enabled: true title: (ã€ƒ\u0026#39;â–½\u0026#39;ã€ƒ) subtitle: \u0026#34;ğŸ§¨å­¦è€Œæ—¶ä¹ ä¹‹ï¼Œä¸äº¦è¯´ä¹ï¼Ÿæœ‰æœ‹è‡ªè¿œæ–¹æ¥ï¼Œä¸äº¦ä¹ä¹ï¼Ÿ\u0026lt;br/\u0026gt;ğŸ‘ğŸ¼æ¬¢è¿å…‰ä¸´ç´ å±¥(Sulv)çš„åšå®¢\u0026lt;br/\u0026gt;ğŸ‘‡è”ç³»æ–¹å¼\u0026#34; imageUrl: \u0026#34;img/Q.gif\u0026#34; #å›¾ç‰‡æ”¾åœ¨static/img/Q.gif imageTitle: imageWidth: 150 imageHeight: 150 buttons: - name: ğŸ‘¨ğŸ»â€ğŸ’»æŠ€æœ¯ url: posts/tech - name: ğŸ“•é˜…è¯» url: posts/read - name: ğŸ–ç”Ÿæ´» url: posts/life menu: main: - identifier: search name: ğŸ”æœç´¢ url: search weight: 1 - identifier: home name: ğŸ ä¸»é¡µ url: / weight: 2 - identifier: posts name: ğŸ“šæ–‡ç«  url: posts weight: 3 - identifier: archives name: â±æ—¶é—´è½´ url: archives/ weight: 20 - identifier: tags name: ğŸ”–æ ‡ç­¾ url: tags weight: 40 - identifier: about name: ğŸ™‹ğŸ»â€â™‚ï¸å…³äº url: about weight: 50 - identifier: links name: ğŸ¤å‹é“¾ url: links weight: 60 enableInlineShortcodes: true #å…è®¸å†…è”çŸ­ç  enableEmoji: true # å…è®¸ä½¿ç”¨ Emoji è¡¨æƒ…ï¼Œå»ºè®® true enableRobotsTXT: true # å…è®¸çˆ¬è™«æŠ“å–åˆ°æœç´¢å¼•æ“ï¼Œå»ºè®® true hasCJKLanguage: true # è‡ªåŠ¨æ£€æµ‹æ˜¯å¦åŒ…å« ä¸­æ–‡æ—¥æ–‡éŸ©æ–‡ å¦‚æœæ–‡ç« ä¸­ä½¿ç”¨äº†å¾ˆå¤šä¸­æ–‡å¼•å·çš„è¯å¯ä»¥å¼€å¯ buildDrafts: false buildFuture: false buildExpired: false #googleAnalytics: UA-123-45 # è°·æ­Œç»Ÿè®¡ # Copyright: Sulv paginate: 15 # æ¯é¡µæ˜¾ç¤ºçš„æ–‡ç« æ•° minify: disableXML: true # minifyOutput: true permalinks: #æµè§ˆå™¨é“¾æ¥æ˜¾ç¤ºæ–¹å¼ post: \u0026#34;/:title/\u0026#34; # post: \u0026#34;/:year/:month/:day/:title/\u0026#34; defaultContentLanguage: en # æœ€é¡¶éƒ¨é¦–å…ˆå±•ç¤ºçš„è¯­è¨€é¡µé¢ defaultContentLanguageInSubdir: true outputs: home: - HTML - RSS - JSON params: env: production # to enable google analytics, opengraph, twitter-cards and schema. # description: \u0026#34;è¿™æ˜¯ä¸€ä¸ªçº¯ç²¹çš„åšå®¢......\u0026#34; author: Sulv # author: [\u0026#34;Me\u0026#34;, \u0026#34;You\u0026#34;] # multiple authors defaultTheme: auto # defaultTheme: light or dark disableThemeToggle: false DateFormat: \u0026#34;2006-01-02\u0026#34; ShowShareButtons: true ShowReadingTime: true # disableSpecialistPost: true displayFullLangName: true ShowPostNavLinks: true ShowBreadCrumbs: true ShowCodeCopyButtons: true hideFooter: false # éšè—é¡µè„š ShowWordCounts: true VisitCount: true ShowLastMod: true #æ˜¾ç¤ºæ–‡ç« æ›´æ–°æ—¶é—´ ShowToc: true # æ˜¾ç¤ºç›®å½• TocOpen: true # è‡ªåŠ¨å±•å¼€ç›®å½• comments: true socialIcons: - name: github url: \u0026#34;https://github.com/xyming108\u0026#34; - name: twitter url: \u0026#34;img/twitter.png\u0026#34; - name: facebook url: \u0026#34;https://www.facebook.com/profile.php?id=100027782410997\u0026#34; - name: instagram url: \u0026#34;img/instagram.png\u0026#34; - name: QQ url: \u0026#34;img/qq.png\u0026#34; - name: WeChat url: \u0026#34;img/wechat.png\u0026#34; - name: email url: \u0026#34;mailto:1931559710@qq.com\u0026#34; - name: RSS url: \u0026#34;index.xml\u0026#34; # editPost: # URL: \u0026#34;https://github.com/adityatelange/hugo-PaperMod/tree/exampleSite/content\u0026#34; # Text: \u0026#34;Suggest Changes\u0026#34; # edit text # appendFilePath: true # to append file path to Edit link label: text: \u0026#34;Sulv\u0026#39;s Blog\u0026#34; #icon: \u0026#34;img/Q.gif\u0026#34; icon: \u0026#34;https://www.sulvblog.cn/Q.gif\u0026#34; iconHeight: 35 # analytics: #è°·æ­Œåˆ†æ # google: # SiteVerificationTag: \u0026#34;XYZabc\u0026#34; assets: favicon: \u0026#34;img/Q.gif\u0026#34; favicon16x16: \u0026#34;img/Q.gif\u0026#34; favicon32x32: \u0026#34;img/Q.gif\u0026#34; apple_touch_icon: \u0026#34;Q.gif\u0026#34; safari_pinned_tab: \u0026#34;Q.gif\u0026#34; # cover: # hidden: true # hide everywhere but not in structured data # hiddenInList: true # hide on list pages and home # hiddenInSingle: true # hide on single page fuseOpts: isCaseSensitive: false shouldSort: true location: 0 distance: 1000 threshold: 1 minMatchCharLength: 0 keys: [\u0026#34;title\u0026#34;, \u0026#34;permalink\u0026#34;, \u0026#34;summary\u0026#34;] twikoo: version: 1.4.11 taxonomies: category: categories tag: tags series: series markup: goldmark: renderer: unsafe: true # HUGO é»˜è®¤è½¬ä¹‰ Markdown æ–‡ä»¶ä¸­çš„ HTML ä»£ç ï¼Œå¦‚éœ€å¼€å¯çš„è¯ highlight: # anchorLineNos: true codeFences: true guessSyntax: true lineNos: true # noClasses: false # style: monokai style: darcula # codeFencesï¼šä»£ç å›´æ åŠŸèƒ½ï¼Œè¿™ä¸ªåŠŸèƒ½ä¸€èˆ¬éƒ½è¦è®¾ä¸º true çš„ï¼Œä¸ç„¶å¾ˆéš¾çœ‹ï¼Œå°±æ˜¯å¹²å·´å·´çš„-ä»£ç æ–‡å­—ï¼Œæ²¡æœ‰é¢œè‰²ã€‚ # guessSyntaxï¼šçŒœæµ‹è¯­æ³•ï¼Œè¿™ä¸ªåŠŸèƒ½å»ºè®®è®¾ç½®ä¸º true, å¦‚æœä½ æ²¡æœ‰è®¾ç½®è¦æ˜¾ç¤ºçš„è¯­è¨€åˆ™ä¼šè‡ªåŠ¨åŒ¹é…ã€‚ # hl_Linesï¼šé«˜äº®çš„è¡Œå·ï¼Œä¸€èˆ¬è¿™ä¸ªä¸è®¾ç½®ï¼Œå› ä¸ºæ¯ä¸ªä»£ç å—æˆ‘ä»¬å¯èƒ½å¸Œæœ›è®©é«˜äº®çš„åœ°æ–¹ä¸ä¸€æ ·ã€‚ # lineNoStartï¼šè¡Œå·ä»ç¼–å·å‡ å¼€å§‹ï¼Œä¸€èˆ¬ä» 1 å¼€å§‹ã€‚ # lineNosï¼šæ˜¯å¦æ˜¾ç¤ºè¡Œå·ï¼Œæˆ‘æ¯”è¾ƒå–œæ¬¢æ˜¾ç¤ºï¼Œæ‰€ä»¥æˆ‘è®¾ç½®çš„ä¸º true. # lineNumbersInTableï¼šä½¿ç”¨è¡¨æ¥æ ¼å¼åŒ–è¡Œå·å’Œä»£ç ,è€Œä¸æ˜¯ æ ‡ç­¾ã€‚è¿™ä¸ªå±æ€§ä¸€èˆ¬è®¾ç½®ä¸º true. # noClassesï¼šä½¿ç”¨ class æ ‡ç­¾ï¼Œè€Œä¸æ˜¯å†…åµŒçš„å†…è”æ ·å¼ privacy: vimeo: disabled: false simple: true twitter: disabled: false enableDNT: true simple: true instagram: disabled: false simple: true youtube: disabled: false privacyEnhanced: true services: instagram: disableInlineCSS: true twitter: disableInlineCSS: true å®Œæ•´å‘å¸ƒæµç¨‹ hugo -F --cleanDestinationDir å°†å¤‡ä»½æ–‡ä»¶å¤¹å†…çš„æ–‡ä»¶å¤åˆ¶åˆ°å‘å¸ƒæ–‡ä»¶å¤¹å†…\nCopy-Item -Path AddFile -Destination ../kennems/public -Recurse å°†å¤‡ä»½æ–‡ä»¶å¤åˆ¶åˆ°å‘å¸ƒæ–‡ä»¶å¤¹å†…ï¼š\nCopy-Item -Path \u0026#34;AddFile\\*\u0026#34; -Destination \u0026#34;.\u0026#34; -Recurse postæ–‡ä»¶å¤¹ è¿™é‡Œæ˜¯ ä¸»é¡µ -ã€‹ğŸ“šæ–‡ç«  ä¸‹é¢çš„åˆ†ç±»\nè‡ªå®šä¹‰CSS è¿™ä¸ªæ–‡ä»¶å¤¹æ”¾ç½®å„ç§è‡ªå®šä¹‰CSSæ ·å¼ï¼Œåˆ†å¼€æ”¾ä¸ä¼šæœ‰ä¼˜å…ˆçº§é—®é¢˜ã€‚\né…ç½®å°é¢å›¾ cover: image: img/cat.jpg # è®¾ç½®å›¾ç‰‡çš„å°æ ‡é¢˜ alt: \u0026#34;å›¾ç‰‡\u0026#34; #caption: \u0026#34;å›¾ç‰‡\u0026#34; hidden: true # æ–‡ç« é¡µé¢éšè—å°é¢å›¾ç‰‡ è‡ªå®šä¹‰åº•éƒ¨categories ","permalink":"https://kennems.github.io/posts/tech/hugo/","summary":"Hugoé…ç½®ä¸ä½¿ç”¨ ä¸‹è½½PaperModä¸»é¢˜ï¼š git clone https://github.com/adityatelange/hugo-PaperMod themes/PaperMod --depth=1 ç”Ÿæˆpublicå†…å®¹æ—¶æ¸…ç©ºæ–‡ä»¶å¤¹ hugo -F --cleanDestinationDir æ–°å»ºpost hugo new content posts/my-first-post.md å®ŒæˆGit pushæµç¨‹ echo \u0026#34;# showguan.github.io\u0026#34;","title":"Hugoé…ç½®ä¸ä½¿ç”¨"},{"content":"KotlinåŸºç¡€ val \u0026amp; var const ç¼–è¯‘æ—¶å¸¸é‡åªèƒ½åœ¨å‡½æ•°ä¹‹å¤–å®šä¹‰ï¼Œå› ä¸ºç¼–è¯‘æ—¶å¸¸é‡å¿…é¡»åœ¨ç¼–è¯‘æ—¶èµ‹å€¼ï¼Œ è€Œå‡½æ•°éƒ½æ˜¯åœ¨è¿è¡Œæ—¶æ‰è°ƒç”¨ï¼Œ å‡½æ•°å†…çš„å˜é‡ä¹Ÿæ˜¯åœ¨è¿è¡Œæ—¶èµ‹å€¼ï¼Œç¼–è¯‘æ—¶å¸¸é‡è¦åœ¨è¿™äº›å˜é‡èµ‹å€¼å‰å°±å·²ç»å­˜åœ¨ã€‚ å‡½æ•°å‚æ•° fun main(){ println(doSomething(1, false)) println(fix(\u0026#34;Jack\u0026#34;)) println(fix(age=10, name=\u0026#34;Rose\u0026#34;)) } private fun doSomething(age:Int, flag:Boolean):String{ return \u0026#34;result\u0026#34; } fun fix(name:String, age:Int = 2){ println(name + \u0026#34; \u0026#34; + age) } å‡½æ•°æ²¡æœ‰è¿”å›ç±»å‹æ—¶é»˜è®¤è¿”å›Unit\nåŒ¿åå‡½æ•° å®šä¹‰æ—¶ä¸å–åå­—çš„å‡½æ•°ï¼Œç§°ä¹‹ä¸ºåŒ¿åå‡½æ•°ï¼Œ åŒ¿åå‡½æ•°é€šå¸¸æ•´ä½“ä¼ é€’ç»™å…¶ä»–å‡½æ•°ï¼Œ æˆ–è€…ä»å…¶ä»–å‡½æ•°è¿”å›ã€‚ åŒ¿åå‡½æ•°å¯¹Kotlinæ¥è¯´å¾ˆé‡è¦ï¼Œå¯ä»¥æ ¹æ®éœ€è¦æŒ‡å®šç‰¹æ®Šè§„åˆ™ï¼Œè½»æ¾å®šåˆ¶æ ‡å‡†åº“é‡Œé¢çš„å†…ç½®å‡½æ•°ã€‚ val blessingFunction:()-\u0026gt;String blessingFunction = { val holiday = \u0026#34;New Year.\u0026#34; \u0026#34;Happy $holiday\u0026#34; // éšå¼è¿”å›ï¼šé»˜è®¤è¿”å›æœ€åä¸€å¥ } println(blessingFunction()) val blessingFunction:(String)-\u0026gt;String = { name -\u0026gt; val holiday = \u0026#34;New Year.\u0026#34; \u0026#34;$name, Happy $holiday\u0026#34; } println(blessingFunction(\u0026#34;Jack\u0026#34;)) itå…³é”®å­— å®šä¹‰åªæœ‰ä¸€ä¸ªå‚æ•°çš„åŒ¿åå‡½æ•°æ—¶ï¼Œ å¯ä»¥ä½¿ç”¨itå…³é”®å­—æ¥æ ‡è¯†å‚æ•°åã€‚å½“éœ€è¦ä¼ å…¥ä¸¤ä¸ªå€¼å‚ï¼Œ itå…³é”®å­—å°±ä¸èƒ½ç”¨äº†\nå®šä¹‰å‚æ•°æ˜¯å‡½æ•°çš„å‡½æ•° fun main(){ val getDiscountWords = { goodsName:String, hour:Int -\u0026gt; val currentYear = 2024 \u0026#34;${currentYear}å¹´ï¼Œ åŒ11${goodsName}ä¿ƒé”€å€’è®¡æ—¶ï¼š$hour å°æ—¶\u0026#34; } showOnBoard(\u0026#34;å«ç”Ÿçº¸\u0026#34;, getDiscountWords) } fun showOnBoard(goodsName:String, getDiscountWords:(String, Int) -\u0026gt; String){ val hour = (1..24).random() println(getDiscountWords(goodsName, hour)) } fun main() { showOnBoard(\u0026#34;å«ç”Ÿçº¸\u0026#34;) { goodsName: String, hour: Int -\u0026gt; val currentYear = 2024 \u0026#34;${currentYear}å¹´ï¼Œ åŒ11${goodsName}ä¿ƒé”€å€’è®¡æ—¶ï¼š$hour å°æ—¶\u0026#34; } } private fun showOnBoard(goodsName: String, getDiscountWords: (String, Int) -\u0026gt; String) { val hour = (1..24).random() println(getDiscountWords(goodsName, hour)) } å‡½æ•°å†…è” æ·»åŠ inlineï¼Œ é¿å…å¤šä¸ªlambdaè¡¨è¾¾å¼çš„å†…å­˜æ¶ˆè€—\né—­åŒ… åœ¨Kotlinä¸­ï¼ŒåŒ¿åå‡½æ•°èƒ½ä¿®æ”¹å¹¶å¼•ç”¨å®šä¹‰åœ¨è‡ªå·±çš„ä½œç”¨åŸŸä¹‹å¤–çš„å˜é‡ï¼Œ åŒ¿åå‡½æ•°å¼•ç”¨ç€å®šä¹‰è‡ªèº«çš„å‡½æ•°é‡Œçš„å˜é‡ï¼ŒKotlinçš„lambdaå°±æ˜¯é—­åŒ…ã€‚ èƒ½æ¥æ”¶å‡½æ•°æˆ–è€…è¿”å›å‡½æ•°çš„å‡½æ•°åˆå«åšé«˜çº§å‡½æ•°ï¼Œ é«˜çº§å‡½æ•°å¹¿æ³›åº”ç”¨äºå‡½æ•°å¼ç¼–ç¨‹å½“ä¸­ã€‚ ç±»å‹æ¨æ–­ var str:String? = \u0026#34;strawberry\u0026#34; // å¯ç©ºç±»å‹ str = null ä½¿ç”¨å¸¦letçš„å®‰å…¨è°ƒç”¨ var str: String? = \u0026#34;strawberry\u0026#34; // å¯ç©ºç±»å‹ str = str?.let { // letè¿”å›æœ€åä¸€è¡Œæ‰§è¡Œçš„ç»“æœ if (it.isNotBlank()) { it.capitalize() } else { \u0026#34;strawberry\u0026#34; } } println(str) ä½¿ç”¨éç©ºæ–­è¨€æ“ä½œç¬¦ !!åˆç§°ä¸ºæ„Ÿå¹å·æ“ä½œç¬¦ï¼Œ å½“å˜é‡å€¼ä¸ºnullæ—¶ï¼Œ ä¼šæŠ›å‡ºKotlinNullPointerException ç©ºåˆå¹¶æ“ä½œç¬¦ å­—ç¬¦ä¸²æ“ä½œ subString val index = NAME.indexOf(\u0026#39;\\\u0026#39;\u0026#39;) val str = NAME.substring(0 until index) println(str) split const val NAMES = \u0026#34;Jack, jacky, jason\u0026#34; val (origin, dest, proxy) = NAMES.split(\u0026#34;,\u0026#34;) println(origin) println(dest) println(proxy) replace val str1 = \u0026#34;The United states of American\u0026#34; val str2 = str1.replace(Regex(\u0026#34;[aeiou]\u0026#34;)) { when (it.value) { \u0026#34;a\u0026#34; -\u0026gt; \u0026#34;8\u0026#34; \u0026#34;e\u0026#34; -\u0026gt; \u0026#34;6\u0026#34; \u0026#34;i\u0026#34; -\u0026gt; \u0026#34;9\u0026#34; \u0026#34;o\u0026#34; -\u0026gt; \u0026#34;1\u0026#34; \u0026#34;u\u0026#34; -\u0026gt; \u0026#34;3\u0026#34; else -\u0026gt; it.value } } println(str1) println(str2) å­—ç¬¦ä¸²æ¯”è¾ƒ val str1 = \u0026#34;Jason\u0026#34; val str2 = \u0026#34;jason\u0026#34;.capitalize() println(str1 == str2) // å†…å®¹ println(str1 === str2) // æ˜¯å¦æ˜¯åŒä¸€ä¸ªå¼•ç”¨ å­—ç¬¦ä¸²éå† \u0026#34;The people\u0026#39;s Reputation of the Jones\u0026#34;.forEach { print(\u0026#34;$it \u0026#34;) } æ•°å­—ç±»å‹ // val number1:Int = \u0026#34;8.98\u0026#34;.toInt() val number1: Int? = \u0026#34;8.98\u0026#34;.toIntOrNull() println(number1) println(8.63413423.toInt()) println(8.63413423.roundToInt()) println(\u0026#34;%.4f\u0026#34;.format(8.63413423)) apply val file1 = File(\u0026#34;D://test//test.txt\u0026#34;) file1.setReadable(true) file1.setWritable(true) file1.setExecutable(true) val file2 = File(\u0026#34;D://test//test.txt\u0026#34;).apply { setReadable(true) setWritable(true) setExecutable(true) } run fun main() { val file = File(\u0026#34;d://test//test.txt\u0026#34;) val result = file.run { readText().contains(\u0026#34;has\u0026#34;) // è¿”å›æ‰§è¡Œç»“æœï¼Œ å¹¶ä¸”åŒ…å« file.readText() è¿™æ ·çš„éšå¼è°ƒç”¨ } println(result) val result2 = \u0026#34;The quick brown fox jumps over the lazy dog\u0026#34; .run(::isLong) .run(::showMessage) // é“¾å¼è°ƒç”¨ï¼Œ å°†ä¸Šä¸€ä¸ªè¿”å›çš„ç»“æœåšä¸ºè¾“å…¥ .run(::println) } fun isLong(name:String) = name.length \u0026gt;= 10 fun showMessage(isLong: Boolean):String{ return if(isLong){ \u0026#34;Name is not suitable\u0026#34; }else{ \u0026#34;Name is suitable\u0026#34; } } with val result1 = \u0026#34;The people of world\u0026#34;.run { length \u0026gt;= 10 } val result2 = with(\u0026#34;The people of world\u0026#34;) { length \u0026gt;= 10 } val result3 = with(\u0026#34;The people of world\u0026#34;) { length \u0026gt;= 100 } println(result1) println(result2) println(result3) also val fileConents:List\u0026lt;String\u0026gt; File(\u0026#34;D:\\\\test\\\\test.txt\u0026#34;) .also { println(it.name) // æŠŠæ¥æ”¶è€…ä½œä¸ºå€¼å‚ä¼ ç»™lambdaï¼Œ è¿”å›æ¥æ”¶è€…å¯¹è±¡ } .also { fileConents = it.readLines() println(fileConents) } takeIf val result = File(\u0026#34;D:\\\\test\\\\test.txt\u0026#34;) .takeIf { it.exists() \u0026amp;\u0026amp; it.canRead() }?.readText() println(result) takeUnless val result = File(\u0026#34;D:\\\\test\\\\test.txt\u0026#34;) .takeUnless { it.isHidden }?.readText() println(result) é›†åˆç±»å‹ list val list = listOf(\u0026#34;Jason\u0026#34;, \u0026#34;Jack\u0026#34;, \u0026#34;Jacky\u0026#34;) println(list.getOrElse(3){\u0026#34;what?\u0026#34;}) println(list.getOrNull(3)?: \u0026#34;it is null\u0026#34;) mutableListOfå¯å˜åˆ—è¡¨ val mutableList = mutableListOf(\u0026#34;Java\u0026#34;,\u0026#34;Kotlin\u0026#34;,\u0026#34;C**\u0026#34;) mutableList.add(\u0026#34;Go\u0026#34;) mutableList.remove(\u0026#34;Kotlin\u0026#34;) println(mutableList) val toMutableList = listOf(\u0026#34;Java\u0026#34;, \u0026#34;Kotlin\u0026#34;, \u0026#34;C**\u0026#34;).toMutableList() val toList = mutableListOf(\u0026#34;Java\u0026#34;, \u0026#34;Python\u0026#34;, \u0026#34;ls\u0026#34;).toList() mutatorå‡½æ•° // mutatorå‡½æ•° mutableList += \u0026#34;Jimmy\u0026#34; println(mutableList) mutableList -= \u0026#34;Jimmy\u0026#34; println(mutableList) mutableList.removeIf{ it.contains(\u0026#34;Jack\u0026#34;) } println(mutableList) éå† val list = listOf(\u0026#34;Java\u0026#34;, \u0026#34;Kotlin\u0026#34;, \u0026#34;C**\u0026#34;, \u0026#34;Jack\u0026#34;, \u0026#34;Jacky\u0026#34;) for (s in list) { println(s) } list.forEach { println(it) } list.forEachIndexed{ index, item -\u0026gt; println(\u0026#34;$index $item\u0026#34;) } Set \u0026amp; mutableSet val set = setOf(\u0026#34;Jason\u0026#34;, \u0026#34;Jack\u0026#34;, \u0026#34;Jacky\u0026#34;, \u0026#34;Jimmy\u0026#34;) println(set.elementAt(2)) println(set.elementAt(3)) val mutableSet = mutableSetOf(\u0026#34;Jason\u0026#34;, \u0026#34;Java\u0026#34;, \u0026#34;Kotlin\u0026#34;) mutableSet += \u0026#34;Jimmy\u0026#34; mutableSet -= \u0026#34;Jason\u0026#34; println(mutableSet) æ•°ç»„ç±»å‹ Kotlinæä¾›å„ç§Arrayï¼Œ è™½ç„¶æ˜¯å¼•ç”¨ç±»å‹ï¼Œä½†å¯ä»¥ç¼–è¯‘æˆJavaåŸºæœ¬æ•°æ®ç±»å‹ã€‚\nval intArrayOf = intArrayOf(10, 20, 30) val toIntArray = listOf(10, 20, 30).toIntArray() arrayOf(File(\u0026#34;xxx\u0026#34;), File(\u0026#34;yyy\u0026#34;)) Mapé›†åˆ val map = mapOf(\u0026#34;Jack\u0026#34; to 20, 1 to \u0026#34;bag\u0026#34;) println(map[\u0026#34;1\u0026#34;]) println(map.get(\u0026#34;Jack\u0026#34;)) println(map.getOrElse(\u0026#34;Rose\u0026#34;) { \u0026#34;Unknown key\u0026#34; }) println(map.getOrDefault(\u0026#34;Rost\u0026#34;, 0)) map.forEach { println(\u0026#34;${it.key} -\u0026gt; ${it.value}\u0026#34;) } map.forEach { t, u -\u0026gt; println(\u0026#34;$t -\u0026gt; $u\u0026#34;) } ç±» class Player{ var name = \u0026#34;jack\u0026#34; get() = field.capitalize() set(value){ field = value.trim() } } fun main() { var p = Player() p.name = \u0026#34;rose\u0026#34; // setName println(p.name) } ç±»çš„åˆå§‹åŒ– æ„é€ å‡½æ•°çš„ä½¿ç”¨\nclass Player ( // åªç”¨ä¸€æ¬¡çš„å˜é‡ç”¨ä¸‹åˆ’çº¿å¼€å¤´ _name:String, _age:Int, _isNormal:Boolean ){ var name = _name get() = field.capitalize() set(value){ field = value.trim() } var age = _age get() = field.absoluteValue set(value){ field = value.absoluteValue } var isNormal = _isNormal override fun toString(): String { return \u0026#34;Player(isNormal=$isNormal, age=$age, name=\u0026#39;$name\u0026#39;)\u0026#34; } } fun main() { val p = Player(\u0026#34;Jack\u0026#34;, 10, false) p.name = \u0026#34;Rose\u0026#34; println(p.toString()) } æ„é€ å‡½æ•°ï¼šå£°æ˜æ—¶å³åˆå§‹åŒ– class Player2 ( // åªç”¨ä¸€æ¬¡çš„å˜é‡ç”¨ä¸‹åˆ’çº¿å¼€å¤´ _name:String, var age:Int, var isNormal:Boolean ){ var name = _name get() = field.capitalize() set(value){ field = value.trim() } override fun toString(): String { return \u0026#34;Player2(age=$age, isNormal=$isNormal, name=\u0026#39;$name\u0026#39;)\u0026#34; } } fun main() { val p = Player(\u0026#34;Jack\u0026#34;, 10, false) p.name = \u0026#34;Rose\u0026#34; println(p.toString()) } æ¬¡æ„é€ å‡½æ•° class Player2 ( // åªç”¨ä¸€æ¬¡çš„å˜é‡ç”¨ä¸‹åˆ’çº¿å¼€å¤´ _name:String, var age:Int, var isNormal:Boolean ){ var name = _name get() = field.capitalize() set(value){ field = value.trim() } override fun toString(): String { return \u0026#34;Player2(age=$age, isNormal=$isNormal, name=\u0026#39;$name\u0026#39;)\u0026#34; } // æ¬¡æ„é€ å‡½æ•°ï¼Œ å¯ä»¥å®šä¹‰å¤šä¸ªæ¬¡æ„é€ å‡½æ•°æ¥é…ç½®ä¸åŒçš„å‚æ•°ç»„åˆ constructor(name:String):this(name,0,false) constructor(name:String, age:Int):this(name,0,false){ this.name = name.toUpperCase() } } fun main() { val p = Player(\u0026#34;Jack\u0026#34;, 10, false) p.name = \u0026#34;Rose\u0026#34; println(p.toString()) //Player(isNormal=false, age=10, name=\u0026#39;Rose\u0026#39;) val player2 = Player2(\u0026#34;Rose\u0026#34;) println(player2.toString()) //Player2(age=0, isNormal=false, name=\u0026#39;Rose\u0026#39;) val player3 = Player2(\u0026#34;Rose\u0026#34;, 10) println(player3.toString()) //Player2(age=0, isNormal=false, name=\u0026#39;ROSE\u0026#39;) } åˆå§‹åŒ–å— init{ require(age \u0026gt; 10){ \u0026#34;age must greater than 10!\u0026#34; } require(name.isNotBlank()){ \u0026#34;name must not blank!\u0026#34; } } åˆå§‹åŒ–é¡ºåº ä¸»æ„é€ å‡½æ•°é‡Œå£°æ˜çš„å±æ€§ ç±»çº§åˆ«çš„å±æ€§èµ‹å€¼ initåˆå§‹åŒ–å—é‡Œçš„å±æ€§èµ‹å€¼å’Œå‡½æ•°è°ƒç”¨ æ¬¡æ„é€ å‡½æ•°é‡Œçš„å±æ€§èµ‹å€¼å’Œå‡½æ•°è°ƒç”¨ å»¶è¿Ÿåˆå§‹åŒ– lazy class Player5 ( _name:String ){ var name = _name val config by lazy { // å»¶è¿Ÿåˆå§‹åŒ– loadConfig() } private fun loadConfig():String{ println(\u0026#34;loading...\u0026#34;) return \u0026#34;xxx\u0026#34; } } fun main() { val p = Player5(\u0026#34;test\u0026#34;) Thread.sleep(1000) println(p.config) } ç»§æ‰¿ ç±»é»˜è®¤éƒ½æ˜¯å°é—­çš„ï¼Œ è¦è®©æŸä¸ªç±»å¼€æ”¾ç»§æ‰¿ï¼Œå¿…é¡»ä½¿ç”¨openå…³é”®å­—ä¿®æ”¹å®ƒã€‚ open class Product( val name: String ) { fun description() = \u0026#34;Product : $name\\n\u0026#34; open fun load() = \u0026#34;Nothing\u0026#34; } class LuxuryProduct : Product( \u0026#34;Luxury product name\u0026#34; ) { override fun load() = \u0026#34;Luxury product load\u0026#34; fun special() = \u0026#34;LuxuryProduct special function\u0026#34; } kotlinè¶…ç±»Any\nprintln(p is Any) å¯¹è±¡ å¯¹è±¡å£°æ˜ open class Player{ open fun load() = \u0026#34;load nothing...\u0026#34; } fun main() { val p = object : Player(){ override fun load(): String { return \u0026#34;anonymous nothing...\u0026#34; } } println(p.load()) } ä¼´ç”Ÿå¯¹è±¡ open class ConfigMap { // ä¼´ç”Ÿå¯¹è±¡ companion object{ private const val PATH = \u0026#34;path.txt\u0026#34; fun load() = File(PATH).readBytes() } } fun main() { // static // ä¸è°ƒç”¨ä¸ä¼šå®ä¾‹åŒ–ï¼Œä¸€æ—¦è°ƒç”¨åˆ™å®ä¾‹åŒ–ï¼Œå¹¶ä¸”ä»…å®ä¾‹åŒ–ä¸€æ¬¡ ConfigMap.load() } åµŒå¥—ç±» class Player2{ // å†…éƒ¨ç±» class Equipment(var name:String){ fun show() = println(\u0026#34;Equipment : ${name}\u0026#34;) } fun battle(){ } } fun main() { val p = Player2() p.battle() Player2.Equipment(\u0026#34;Sharp knife\u0026#34;).show() } æ•°æ®ç±» ç”¨dataå£°æ˜çš„ç±»ï¼Œä¼šé‡å†™ equals å’Œ hashCode æ–¹æ³•\ndata class Coordinate( var x: Int = 10, var y: Int = 1 ) { val isInBounds = x \u0026gt; 0 \u0026amp;\u0026amp; y \u0026gt; 0 } fun main() { println(Coordinate(1, 2).isInBounds) println(Coordinate(10, 20) == Coordinate(10, 20)) println(Coordinate(10, 20) === Coordinate(10, 20)) } copy data class Student( var _name: String, val age: Int ) { var name = _name var score = 0 private val hobby = \u0026#34;music\u0026#34; val subject: String init { println(\u0026#34;initializing Student $name\u0026#34;) subject = \u0026#34;math\u0026#34; } constructor(_name: String) : this(_name, 10) { score = 10 } override fun toString(): String { return \u0026#34;Student(age=$age, name=\u0026#39;$name\u0026#39;, score=$score, hobby=\u0026#39;$hobby\u0026#39;, subject=\u0026#39;$subject\u0026#39;)\u0026#34; } } fun main() { val student = Student(\u0026#34;John\u0026#34;) val copy = student.copy(\u0026#34;Rose\u0026#34;) println(student) // Student(age=10, name=\u0026#39;John\u0026#39;, score=10, hobby=\u0026#39;music\u0026#39;, subject=\u0026#39;math\u0026#39;) println(copy) // Student(age=10, name=\u0026#39;Rose\u0026#39;, score=0, hobby=\u0026#39;music\u0026#39;, subject=\u0026#39;math\u0026#39;) } è§£æ„å£°æ˜ class PlayerScore( val experience:Int, val level:Int ){ operator fun component1():Int = experience operator fun component2():Int = level } fun main() { // æ•°æ®ç±»å¤©ç„¶æ”¯æŒcomponent1, component2 val (x, y) = PlayerScore(10, 20) println(\u0026#34;${x}, $y\u0026#34;) } è¿ç®—ç¬¦é‡è½½ å¦‚æœè¦å°†å†…ç½®è¿ç®—ç¬¦åº”ç”¨åœ¨è‡ªå®šä¹‰ç±»èº«ä¸Šï¼Œ å¿…é¡»é‡å†™è¿ç®—ç¬¦å‡½æ•°ï¼Œå‘Šè¯‰ç¼–è¯‘å™¨è¯¥å¦‚ä½•æ“ä½œè‡ªå®šä¹‰ç±»ã€‚ data class Coordinate2( var x: Int = 10, var y: Int = 1 ) { val isInBounds = x \u0026gt; 0 \u0026amp;\u0026amp; y \u0026gt; 0 operator fun plus(coordinate: Coordinate2): Coordinate2 = Coordinate2(x + coordinate.x, y + coordinate.y) } fun main() { var c1 = Coordinate2(1, 2) val c2 = Coordinate2(3, 4) c1 += c2 println(c1) // Coordinate2(x=4, y=6) } æšä¸¾ç±» enum class Direction(){ EAST, WEST, SOUTH, NORTH } fun main(){ println(Direction.NORTH) //NORTH println(Direction.EAST is Direction) //true } å¯†å°ç±» å¯¹äºæ›´å¤æ‚çš„ADTï¼Œ å¯ä»¥ä½¿ç”¨Kotlinçš„å¯†å°ç±»ï¼ˆsealed classï¼‰æ¥å®ç°å¤æ‚çš„å®šä¹‰ï¼Œå¯†å°ç±»å¯ä»¥ç”¨æ¥å®šä¹‰ä¸€ä¸ªç±»ä¼¼äºæšä¸¾ç±»çš„ADT // å¯†å°ç±» sealed class LicenseStatus2 { // object å•ä¾‹å¯¹è±¡ï¼Œåªæœ‰ä¸€ä¸ªå®ä¾‹ object UNQUALIFIED : LicenseStatus2() object LEARNING : LicenseStatus2() class QUALIFIED(val licenseId: String) : LicenseStatus2() } private class Driver2(var status: LicenseStatus2) { fun checkLicense(): String { return when (status) { is LicenseStatus2.UNQUALIFIED -\u0026gt; \u0026#34;æ²¡èµ„æ ¼\u0026#34; is LicenseStatus2.LEARNING -\u0026gt; \u0026#34;åœ¨å­¦\u0026#34; is LicenseStatus2.QUALIFIED -\u0026gt; \u0026#34;æœ‰èµ„æ ¼, é©¾é©¶è¯ç¼–å·ï¼š ${(this.status as LicenseStatus2.QUALIFIED).licenseId}\u0026#34; } } } fun main() { println(Driver2(LicenseStatus2.QUALIFIED(\u0026#34;100\u0026#34;)).run { checkLicense() }) } æ¥å£ interface Movable { var maxSpeed: Int var wheels: Int fun move(movable: Movable): String } class Car( _name: String, override var wheels: Int = 4 ) : Movable { override var maxSpeed: Int get() = TODO(\u0026#34;Not yet implemented\u0026#34;) set(value) { 1 } override fun move(movable: Movable): String { TODO(\u0026#34;Not yet implemented\u0026#34;) } } fun main() { } æŠ½è±¡ç±» abstract class Gun(val range:Int){ abstract fun pullTrigger():String } class AK47(val price:Int):Gun(range = 100){ override fun pullTrigger(): String { return \u0026#34;Shot\u0026#34; } } fun main() { } å®šä¹‰æ³›å‹ç±» T (type)\nclass MagicBox\u0026lt;T\u0026gt;(item:T) { private var subject: T = item } class Boy(val name: String, val age: Int) class Dog(val weight: Int) fun main() { val box1 = MagicBox(Boy(\u0026#34;Cute dog\u0026#34;, 1)) val box2 = MagicBox(Dog(1)) } æ³›å‹çº¦æŸç±» class MagicBox\u0026lt;T:Human\u0026gt;(item: T) { var available = false var subject: T = item fun fetch(): T? { return subject.takeIf { available } } // æŠŠå…ƒç´ è¿›è¡Œä¿®æ”¹ // é­”ç›’é‡Œé¢æ˜¯ç”·å­©ï¼Œç¼–ç¨‹ç”·äºº fun \u0026lt;R\u0026gt; fetch(subjectModFunction: (T) -\u0026gt; R): R? { return subjectModFunction(subject).takeIf { available } } } open class Human(val age:Int) class Boy(val name: String, age: Int):Human(age) class Man(private val name: String, age: Int):Human(age) { override fun toString(): String { return \u0026#34;Man(name=\u0026#39;$name\u0026#39;, age=$age)\u0026#34; } } class Dog(val weight: Int) fun main() { val box1 = MagicBox(Boy(\u0026#34;Cute Boy\u0026#34;, 1)) // val box2 = MagicBox(Dog(1)) // box2.available = false // box2.fetch()?.run { // println(\u0026#34;Your find it\u0026#34;) // } box1.available = true box1.fetch()?.run { println(\u0026#34;you find $name\u0026#34;) } val man = box1.fetch { Man(it.name, it.age.plus(10)) } println(man) } varargå…³é”®å­—ä¸getå‡½æ•° MagicBoxèƒ½å­˜æ”¾ä»»ä½•ç±»å‹çš„Humanç±»å‹ï¼Œ ä½†ä¸€æ¬¡åªèƒ½ä¸€ä¸ªã€‚ class MagicBox\u0026lt;T : Human\u0026gt;(vararg item: T) { var available = false // itmeæ˜¯å¯å˜å‚æ•°, æœ‰å¤šä¸ª // æ³›å‹æ˜¯å¯å˜å‚æ•°ï¼Œ å¿…é¡»å†™out var subject: Array\u0026lt;out T\u0026gt; = item fun fetch(index: Int): T? { return subject[index].takeIf { available } } // æŠŠå…ƒç´ è¿›è¡Œä¿®æ”¹ // é­”ç›’é‡Œé¢æ˜¯ç”·å­©ï¼Œç¼–ç¨‹ç”·äºº fun \u0026lt;R\u0026gt; fetch(index: Int, subjectModFunction: (T) -\u0026gt; R): R? { return subjectModFunction(subject[index]).takeIf { available } } // å¯å˜å‚æ•° fun a(vararg a: Int) { } operator fun get(index: Int): T? = subject[index] } open class Human(val age: Int) class Boy(val name: String, age: Int) : Human(age) class Man(private val name: String, age: Int) : Human(age) { override fun toString(): String { return \u0026#34;Man(name=\u0026#39;$name\u0026#39;, age=$age)\u0026#34; } } class Dog(val weight: Int) fun main() { val box1 = MagicBox( Boy(\u0026#34;Cute Boy\u0026#34;, 1), Boy(\u0026#34;Kennem\u0026#34;, 10) ) box1.available = true; box1.fetch(1)?.run { println(\u0026#34;Your find $name\u0026#34;) } val man = box1.fetch(0) { Man(it.name, it.age.plus(10)) } } out outï¼ˆåå˜ï¼‰ï¼Œå¦‚æœæ³›å‹ç±»åªå°†æ³›å‹ç±»ä½œä¸ºå‡½æ•°çš„è¿”å›ï¼ˆè¾“å‡ºï¼‰ï¼Œ é‚£ä¹ˆä½¿ç”¨outï¼Œ å¯ä»¥ç§°ä¹‹ä¸ºç”Ÿäº§ç±»/æ¥å£ï¼Œå› ä¸ºå®ƒä¸»è¦ç”¨æ¥ç”Ÿäº§ï¼ˆproduceï¼‰æŒ‡å®šçš„æ³›å‹å¯¹è±¡\nå­ç±»æ³›å‹çš„å¯¹è±¡å¯ä»¥èµ‹å€¼ç»™çˆ¶ç±»æ³›å‹çš„å¯¹è±¡ï¼Œ ç”¨out inï¼ˆé€†å˜ï¼‰ï¼Œ å¦‚æœæ³›å‹ç±»åªå°†æ³›å‹ç±»å‹ä½œä¸ºå‡½æ•°çš„å…¥å‚ï¼ˆè¾“å…¥ï¼‰ï¼Œé‚£ä¹ˆä½¿ç”¨inï¼Œå¯ä»¥ç§°ä¹‹ä¸ºæ¶ˆè´¹è€…ç±»/æ¥å£ï¼Œå› ä¸ºå®ƒä¸»è¦æ˜¯ç”¨æ¥æ¶ˆè´¹ï¼ˆconsumeï¼‰æŒ‡å®šçš„æ³›å‹å¯¹è±¡ã€‚\nçˆ¶ç±»æ³›å‹å¯¹è±¡å¯ä»¥èµ‹å€¼ç»™å­ç±»æ³›å‹å¯¹è±¡ï¼Œç”¨in invariantï¼ˆä¸å˜ï¼‰ï¼Œå¦‚æœæ³›å‹ç±»æ—¢å°†æ³›å‹ç±»å‹ä½œä¸ºå‡½æ•°å‚æ•°ï¼Œåˆå°†æ³›å‹ç±»å‹ä½œä¸ºå‡½æ•°çš„è¾“å‡ºï¼Œé‚£ä¹ˆæ—¢ä¸ç”¨outä¹Ÿä¸ç”¨inã€‚\n//out interface Production\u0026lt;out T\u0026gt; { fun product(): T } //in interface Consumer\u0026lt;in T\u0026gt; { fun consume(item: T) } // ä¸å˜ interface ProductionConsumer\u0026lt;T\u0026gt; { fun produce(item: T) fun consume(item: T) } open class Food open class FastFood : Food() class Burger : FastFood() class FoodStore : Production\u0026lt;Food\u0026gt; { override fun product(): Food { println(\u0026#34;Produce food.\u0026#34;) return Food() } } class FastFoodStore : Production\u0026lt;FastFood\u0026gt; { override fun product(): FastFood { println(\u0026#34;Produce FastFood.\u0026#34;) return FastFood() } } class BurgerStore : Production\u0026lt;Burger\u0026gt; { override fun product(): Burger { println(\u0026#34;Produce FastFood.\u0026#34;) return Burger() } } // æ¶ˆè´¹è€… class Everybody : Consumer\u0026lt;Food\u0026gt; { override fun consume(item: Food) { println(\u0026#34;Eat food.\u0026#34;) } } class ModernPeople : Consumer\u0026lt;FastFood\u0026gt; { override fun consume(item: FastFood) { println(\u0026#34;Eat fastFood.\u0026#34;) } } class American : Consumer\u0026lt;Burger\u0026gt; { override fun consume(item: Burger) { println(\u0026#34;Eat burger food.\u0026#34;) } } fun main() { // å­ç±»æ³›å‹çš„å¯¹è±¡å¯ä»¥èµ‹å€¼ç»™çˆ¶ç±»æ³›å‹çš„å¯¹è±¡ï¼Œ ç”¨out val production1: Production\u0026lt;Food\u0026gt; = FoodStore() val production2: Production\u0026lt;Food\u0026gt; = FastFoodStore() val production3: Production\u0026lt;Food\u0026gt; = BurgerStore() // çˆ¶ç±»æ³›å‹å¯¹è±¡å¯ä»¥èµ‹å€¼ç»™å­ç±»æ³›å‹å¯¹è±¡ï¼Œç”¨in val consumer1: Consumer\u0026lt;Burger\u0026gt; = Everybody() // è¿™é‡ŒEverybody : Consumer\u0026lt;Food\u0026gt; å¯ä»¥èµ‹å€¼ä¸º Consumer\u0026lt;Burger\u0026gt; consumer1.consume(Burger()) val consumer2: Consumer\u0026lt;Burger\u0026gt; = ModernPeople() val consumer3: Consumer\u0026lt;Burger\u0026gt; = American() } reified reifiedå…³é”®å­—èƒ½å¤Ÿæ£€æŸ¥æ³›å‹å‚æ•°ç±»å‹ class MagicBox\u0026lt;T : Human\u0026gt;(vararg item: T) { // éšæœºäº§ç”Ÿä¸€ä¸ªå¯¹è±¡ï¼Œå¦‚æœä¸æ˜¯æŒ‡å®šç±»å‹çš„å¯¹è±¡ï¼Œå°±é€šè¿‡backupå‡½æ•°ç”Ÿæˆä¸€ä¸ªæŒ‡å®šç±»å‹çš„å¯¹è±¡ // fun \u0026lt;T\u0026gt; randomOrBackup(backup: () -\u0026gt; T): T { // val items = listOf( // Boy(\u0026#34;Jack\u0026#34;, 20), // Man(\u0026#34;John\u0026#34;, 20) // ) // val random = items.shuffled().first() // return if(random is T){ // random // }else{ // backup() // } // } inline fun \u0026lt;reified T\u0026gt; randomOrBackup(backup: () -\u0026gt; T): T { val items = listOf( Boy(\u0026#34;Jack\u0026#34;, 20), Man(\u0026#34;John\u0026#34;, 20) ) val random = items.shuffled().first() return if(random is T){ println(random) random }else{ backup() } } } open class Human(val age: Int) class Boy(val name: String, age: Int) : Human(age){ override fun toString(): String { return \u0026#34;Boy(name=\u0026#39;$name\u0026#39;)\u0026#34; } } class Man(private val name: String, age: Int) : Human(age) { override fun toString(): String { return \u0026#34;Man(name=\u0026#39;$name\u0026#39;, age=$age)\u0026#34; } } class Dog(val weight: Int) fun main() { val box1 = MagicBox\u0026lt;Human\u0026gt;() // ç”±backupå‡½æ•°æ¨æ–­å‡ºTçš„ç±»å‹ val subject = box1.randomOrBackup { Boy(\u0026#34;Jimmy\u0026#34;, 29) } println(subject) } æ‰©å±•å‡½æ•° å®šä¹‰æ‰©å±•å‡½æ•° æ‰©å±•å¯ä»¥åœ¨ä¸ç›´æ¥ä¿®æ”¹ç±»å®šä¹‰çš„æƒ…å†µä¸‹å¢åŠ ç±»åŠŸèƒ½ï¼Œ æ‰©å±•å¯ä»¥ç”¨äºè‡ªå®šä¹‰ç±»ï¼Œä¹Ÿå¯ä»¥ç”¨äºå¦‚Listï¼Œ Stringï¼Œ ä»¥åŠKotlinæ ‡å‡†åº“é‡Œçš„å…¶ä»–ç±»ã€‚ fun String.addExt(amount:Int = 1) = this + \u0026#34;!\u0026#34;.repeat(amount) fun String.easyPrint():String{ println(this) return this } fun main() { println(\u0026#34;abc\u0026#34;.addExt(10)) //abc!!!!!!!!!! \u0026#34;abc\u0026#34;.easyPrint() \u0026#34;abc\u0026#34;.easyPrint().addExt(3).easyPrint() } æ³›å‹æ‰©å±•å‡½æ•° fun String.addExt(amount: Int = 1) = this + \u0026#34;!\u0026#34;.repeat(amount) fun \u0026lt;T\u0026gt; T.easyPrint(): T { println(this) return this } fun main() { println(\u0026#34;abc\u0026#34;.addExt(10)) //abc!!!!!!!!!! \u0026#34;abc\u0026#34;.easyPrint() \u0026#34;abc\u0026#34;.easyPrint().addExt(3).easyPrint() 3.14.easyPrint() } æ‰©å±•å±æ€§ ç»™Stringæ·»åŠ ä¸€ä¸ªç»Ÿè®¡å…ƒéŸ³å­—æ¯ä¸ªæ•°çš„å±æ€§\nval String.numVowels get() = count{ \u0026#34;aeiou\u0026#34;.contains(it) } private fun \u0026lt;T\u0026gt; T.easyPrint():T{ println(this) return this } fun main() { println(\u0026#34;The people\u0026#39;s Republic of China\u0026#34;.numVowels) } å¯ç©ºç±»æ‰©å±• fun String?.printWithDefault(default:String) = print(this ?: default) fun main() { // val nullableString:String? = null val nullableString:String? = \u0026#34;null\u0026#34; nullableString.printWithDefault(\u0026#34;xxx\u0026#34;) } infixå…³é”®å­— infix fun String?.printWithDefault(default:String) = print(this ?: default) fun main() { val nullableString:String? = \u0026#34;null\u0026#34; nullableString printWithDefault(\u0026#34;xxx\u0026#34;) // å®ç°æ•ˆæœ \u0026#34;jack\u0026#34;.to(18) \u0026#34;jack\u0026#34; to 10 } æ‰©å±•æ–‡ä»¶ fun \u0026lt;T\u0026gt; Iterable\u0026lt;T\u0026gt;.randomTake(): T = this.shuffled().first() åœ¨å…¶ä»–æ–‡ä»¶ä¸­å¯ä»¥ä½¿ç”¨è¿™ä¸ªæ‰©å±•æ–‡ä»¶å†…çš„å‡½æ•°ï¼Œå¹¶ä¸”å¯ä»¥èµ·åˆ«å\nimport com.showguan.extension.randomTake as randomizer fun main() { val list = listOf(\u0026#34;Jason\u0026#34;, \u0026#34;Jack\u0026#34;, \u0026#34;Tom\u0026#34;) val set = list.toSet() println(list.randomizer()) } å¸¦æ¥æ”¶è€…çš„å‡½æ•°å­—é¢é‡ apply å®ç°\n@kotlin.internal.InlineOnly public inline fun \u0026lt;T\u0026gt; T.apply(block: T.() -\u0026gt; Unit): T { contract { callsInPlace(block, InvocationKind.EXACTLY_ONCE) } block() return this } public inline fun File.apply(block: File.() -\u0026gt; Unit): File { block() return this } fun main() { val file = File(\u0026#34;xx\u0026#34;).apply { setReadable(true) setWritable(true) } // è¯¦ç»†å®ç°è¿‡ç¨‹ fun File.ext(): Unit { setReadable(true) } val block = File::ext File(\u0026#34;xx\u0026#34;).apply(block) } DSLï¼ˆDomain-Specific Languageï¼Œé¢†åŸŸç‰¹å®šè¯­è¨€ï¼‰ interface Element class HTML { private val elements = mutableListOf\u0026lt;Element\u0026gt;() fun body(init: Body.() -\u0026gt; Unit) { val body = Body() body.init() elements.add(body) } override fun toString(): String { return elements.joinToString(\u0026#34;\u0026#34;) } } class TextElement(val tag: String, val text: String) : Element { override fun toString() = \u0026#34;\u0026lt;$tag\u0026gt;$text\u0026lt;/$tag\u0026gt;\u0026#34; } class Body : Element { private val elements = mutableListOf\u0026lt;Element\u0026gt;() fun h1(text: String) { elements.add(TextElement(\u0026#34;h1\u0026#34;, text)) } fun h2(text: String) { elements.add(TextElement(\u0026#34;h2\u0026#34;, text)) } fun h3(text: String) { elements.add(TextElement(\u0026#34;h2\u0026#34;, text)) } fun p(text: String) { elements.add(TextElement(\u0026#34;p\u0026#34;, text)) } override fun toString(): String { return TextElement(\u0026#34;body\u0026#34;, elements.joinToString(\u0026#34;\u0026#34;)).toString() // return \u0026#34;\u0026lt;body\u0026gt;${elements.joinToString(\u0026#34;\u0026#34;)}\u0026lt;/body\u0026gt;\u0026#34; } } fun html(init: HTML.() -\u0026gt; Unit): HTML { val html = HTML() html.init() return html } fun main() { // ä½¿ç”¨DSLåˆ›å»ºHTMLç»“æ„ // val document = html { // body { // h1(\u0026#34;Kotlin DSL\u0026#34;) // p(\u0026#34;This is a paragraph.\u0026#34;) // } // } val document = html { body { h1(\u0026#34;è¿™é‡Œæ˜¯ä¸€çº§æ ‡é¢˜\u0026#34;) h2(\u0026#34;è¿™é‡Œæ˜¯äºŒçº§æ ‡é¢˜\u0026#34;) p(\u0026#34;è¿™é‡Œæ˜¯ç¬¬ä¸€æ®µ\u0026#34;) p(\u0026#34;è¿™é‡Œæ˜¯ç¬¬äºŒæ®µ\u0026#34;) } } println(document) } å‡½æ•°å¼ç¼–ç¨‹ ç¼–ç¨‹èŒƒå¼\nä¸€ä¸ªå‡½æ•°å¼åº”ç”¨é€šå¸¸ç”±ä¸‰å¤§ç±»å‡½æ•°æ„æˆï¼šå˜æ¢transform, è¿‡æ»¤filter, åˆå¹¶combineã€‚æ¯ç±»å‡½æ•°éƒ½é’ˆå¯¹é›†åˆæ•°æ®ç±»å‹ï¼Œç›®æ ‡æ˜¯äº§ç”Ÿä¸€ä¸ªæœ€ç»ˆç»“æœã€‚\nå‡½æ•°å¼ç¼–ç¨‹èŒƒå¼æ”¯æŒçš„è®¾è®¡ç†å¿µå°±æ˜¯ä¸å¯å˜æ•°æ®çš„å‰¯æœ¬åœ¨é“¾ä¸Šçš„å‡½æ•°é—´ä¼ é€’\nmap fun main() { val animals = listOf(\u0026#34;zebra\u0026#34;, \u0026#34;pig\u0026#34;, \u0026#34;tiger\u0026#34;, \u0026#34;giraffe\u0026#34;, \u0026#34;rat\u0026#34;, \u0026#34;cat\u0026#34;) val map = animals .map { animal -\u0026gt; \u0026#34;A baby $animal\u0026#34; } .map { baby -\u0026gt; \u0026#34;$baby, with the cutest little tail ever!\u0026#34; } var animalsLength = animals.map { it.length } println(animals) println(map) println(animalsLength) } flatMap fun main() { val list = listOf(listOf(1, 2, 3), listOf(4, 5, 6), listOf(7, 8, 9)).flatMap { it } println(list) //[1, 2, 3, 4, 5, 6, 7, 8, 9] } filter fun main() { val list = List(100) { Random.nextInt(0, 1001) } println(list) val primes = list.filter { number -\u0026gt; (2 until number).map { number % it } .none { it == 0 } // æ²¡æœ‰ä¸€ä¸ªç»“æœæ˜¯ç­‰äº0çš„ } println(primes) } zip åˆå¹¶å‡½æ•°æ¥åˆå¹¶ä¸¤ä¸ªé›†åˆï¼Œ è¿”å›ä¸€ä¸ªåŒ…å«é”®å€¼å¯¹çš„æ–°é›†åˆ\nfun main() { val employees = listOf(\u0026#34;Jack\u0026#34;, \u0026#34;Jason\u0026#34;, \u0026#34;Tommy\u0026#34;) val shirtSize = listOf(\u0026#34;large\u0026#34;, \u0026#34;xl-large\u0026#34;, \u0026#34;medium\u0026#34;) val employeesSizes = employees.zip(shirtSize).toMap() println(employeesSizes) } fold æ¥æ”¶ä¸€ä¸ªåˆå§‹ç´¯åŠ å™¨å€¼ï¼Œéšåä¼šæ ¹æ®åŒ¿åå‡½æ•°çš„ç»“æœæ›´æ–°\nfun main() { val employees = listOf(\u0026#34;Jack\u0026#34;, \u0026#34;Jason\u0026#34;, \u0026#34;Tommy\u0026#34;) val shirtSize = listOf(\u0026#34;large\u0026#34;, \u0026#34;xl-large\u0026#34;, \u0026#34;medium\u0026#34;) val fold = listOf(1, 2, 34, 4).fold(0) { accumulator, number -\u0026gt; println(\u0026#34;Accumulator value : \u0026#34; + accumulator) accumulator + (number * 3) } /** * Accumulator value : 0 * Accumulator value : 3 * Accumulator value : 9 * Accumulator value : 111 */ println(\u0026#34;Final value : \u0026#34; + fold) //Final value : 123 } å‡½æ•°å¼ç¼–ç¨‹çš„ä¼˜ç‚¹ï¼š\nç´¯åŠ å˜é‡éƒ½æ˜¯éšå¼å®šä¹‰çš„ å‡½æ•°è¿ç®—ç»“æœä¼šè‡ªåŠ¨èµ‹å€¼ç»™ç´¯åŠ å˜é‡ï¼Œé™ä½äº†ä»£ç å‡ºé”™çš„æœºä¼š æ‰§è¡Œæ–°ä»»åŠ¡çš„å‡½æ•°å¾ˆå®¹æ˜“æ·»åŠ åˆ°å‡½æ•°è°ƒç”¨é“¾ä¸Šï¼Œå› ä¸ºä»–ä»¬éƒ½å…¼å®¹Iterableç±»å‹ åºåˆ— Kotlinå†…æœ‰ä¸€ä¸ªå†…ç½®æƒ°æ€§é›†åˆç±»å‹å«åºåˆ—ï¼ˆSequenceï¼‰ï¼Œ åºåˆ—ä¸ä¼šç´¢å¼•æ’åºå®ƒçš„å†…å®¹ï¼Œä¹Ÿä¸è®°å½•å…ƒç´ æ•°ç›®ï¼Œåœ¨ä½¿ç”¨ä¸€ä¸ªåºåˆ—æ—¶ï¼Œåºåˆ—é‡Œçš„å€¼å¯èƒ½æœ‰æ— é™å¤šï¼Œå› ä¸ºæŸä¸ªæ•°æ®æºèƒ½äº§ç”Ÿæ— é™å¤šä¸ªå…ƒç´ ã€‚\nfun Int.isPrime():Boolean{ (2 until this).map { if(this % it == 0){ return false } } return true } fun main() { val filter = (2..10000).toList().filter { it.isPrime() }.take(1000) println(filter) val take = generateSequence(2) { value -\u0026gt; value + 1 }.filter { it.isPrime() }.take(1000) println(take.toList()) } äº’æ“ä½œæ€§ä¸å¯ç©ºæ€§ Javaæ–‡ä»¶ Jhava.java public class Jhava { public String utterGreeting(){ return \u0026#34;HELLO!\u0026#34;; } @Nullable public String determineFriendshipLevel(){ return null; } } Hello.kt fun main() { val adversary = Jhava() println((adversary.utterGreeting())) val level = adversary.determineFriendshipLevel() // é˜²æ­¢ä¸ºç©º println(level?.toLowerCase()) } ç±»å‹æ˜ å°„ ä»£ç è¿è¡Œæ—¶ï¼Œæ‰€æœ‰çš„æ˜ å°„ç±»å‹éƒ½ä¼šé‡æ–°æ˜ å°„å›å¯¹åº”çš„Javaç±»å‹\nç”¨kotlinè·å–javaä¸­å˜é‡çš„ç±»å‹\njava:\npublic Integer x = 100; kotlin:\nprintln(adversary.x.javaClass) //class java.lang.Integer å±æ€§è®¿é—® ç›´æ¥è®¿é—®å³å¯ï¼Œå®é™…ä¸Šä½¿ç”¨çš„è¿˜æ˜¯get/setæ–¹æ³•\n@JvmName é€šè¿‡ @file:JvmName(name = \u0026quot;Hero\u0026quot;)æ¥è‡ªå®šä¹‰éœ€è¦å¼•ç”¨çš„åç§°\nkotlin:\n@file:JvmName(name = \u0026#34;Hero\u0026#34;) // é¡¶éƒ¨ fun makeProclamation() = \u0026#34;Greeting, beast!\u0026#34; javaï¼š\nSystem.out.println(Hero.makeProclamation()); @JvmField kotlin:\nclass Spellbook { @JvmField val spells = listOf(\u0026#34;Magic Ms. L\u0026#34;, \u0026#34;Lay on Hans\u0026#34;) } Java:\nSpellbook spellbook = new Spellbook(); System.out.println(spellbook); //com.showguan.Spellbook@4edde6e5 for (String spell : spellbook.spells) { System.out.println(spell); } /* Magic Ms. L Lay on Hans */ @JvmOverloads è‡ªåŠ¨é‡è½½\n@JvmOverloads fun handOverFood(leftHand:String = \u0026#34;berries\u0026#34;, rightHand:String = \u0026#34;beef\u0026#34;){ println(\u0026#34;Your right hand is ${rightHand}, left hand is $leftHand\u0026#34;) } Hero.handOverFood(\u0026#34;apple\u0026#34;); Hero.handOverFood(\u0026#34;apple\u0026#34;, \u0026#34;banana\u0026#34;); @JvmStatic class Spellbook { @JvmField val spells = listOf(\u0026#34;Magic Ms. L\u0026#34;, \u0026#34;Lay on Hans\u0026#34;) companion object { @JvmField val MAX_SPELL_COUNT = 5 @JvmStatic fun getSpellbookGreeting() = \u0026#34;I am the Great Grimoire\u0026#34; } } // int maxSpellCount = Spellbook.Companion.getMAX_SPELL_COUNT(); //é™æ€è°ƒç”¨ int maxSpellCount = Spellbook.MAX_SPELL_COUNT; // String spellbookGreeting = Spellbook.Companion.getSpellbookGreeting(); //é™æ€è°ƒç”¨ String spellbookGreeting = Spellbook.getSpellbookGreeting(); @Throws kotlinä¸­æŠ›å‡ºå¼‚å¸¸\n@Throws(IOException::class) fun acceptApology(){ throw IOException() } Javaä¸­å¤„ç†å¼‚å¸¸\ntry { Hero.acceptApology(); } catch (IOException e) { System.out.println(\u0026#34;Caught!\u0026#34;); } å‡½æ•°ç±»å‹æ“ä½œ kotlin:\nval translator = { utterance:String -\u0026gt; println(utterance.toLowerCase().capitalize()) } Java:\nFunction1\u0026lt;String, Unit\u0026gt; translator = Hero.getTranslator(); translator.invoke(\u0026#34;true\u0026#34;); Function1 ä»£è¡¨æœ‰1ä¸ªå‚æ•°ï¼Œ åŒç†Function2ä»£è¡¨æœ‰2ä¸ªå‚æ•°ã€‚\n","permalink":"https://kennems.github.io/posts/tech/kotlin%E5%9F%BA%E7%A1%80/","summary":"KotlinåŸºç¡€ val \u0026amp; var const ç¼–è¯‘æ—¶å¸¸é‡åªèƒ½åœ¨å‡½æ•°ä¹‹å¤–å®šä¹‰ï¼Œå› ä¸ºç¼–è¯‘æ—¶å¸¸é‡å¿…é¡»åœ¨ç¼–è¯‘æ—¶èµ‹å€¼ï¼Œ è€Œå‡½æ•°éƒ½æ˜¯åœ¨è¿è¡Œæ—¶æ‰è°ƒç”¨ï¼Œ å‡½æ•°å†…çš„å˜é‡ä¹Ÿæ˜¯åœ¨è¿è¡Œæ—¶èµ‹å€¼","title":"KotlinåŸºç¡€"},{"content":"ç¬¬åäºŒå¤©ç¬”è®° SW å±å¹•é€‚é…\nHandlerå®ç°é€šä¿¡ã€‚\nä»£ç å¯ç»´æŠ¤ï¼Œç²¾ç®€\n","permalink":"https://kennems.github.io/posts/tech/%E7%AC%AC%E5%8D%81%E4%BA%8C%E5%A4%A9%E7%AC%94%E8%AE%B0/","summary":"ç¬¬åäºŒå¤©ç¬”è®° SW å±å¹•é€‚é… Handlerå®ç°é€šä¿¡ã€‚ ä»£ç å¯ç»´æŠ¤ï¼Œç²¾ç®€","title":"è®­ç»ƒè¥ç¬¬åäºŒå¤©ç¬”è®°"},{"content":"ç¬¬åä¸€å¤©ç¬”è®° Kotlin è®²ä¹‰æ€»ç»“ 1. åŒ…çš„å®šä¹‰ä¸å¯¼å…¥ 1) åŒ…çš„å£°æ˜\nåŒ…çš„å£°æ˜åœ¨ä»£ç æ–‡ä»¶çš„å¼€å¤´ï¼Œæ ¼å¼ä¸º package åŒ…åã€‚ åŒ…åæ˜¯å·¥ç¨‹æ ¹ç›®å½•ä¸‹çš„å­ç›®å½•ï¼Œå¦‚ com.jetbrainsã€‚ åœ¨æ ¹ç›®å½•ä¸‹åˆ›å»º com.jetbrains åŒ…ï¼Œå¹¶åœ¨æ­¤åŒ…ä¸‹åˆ›å»º Demo1.kt æ–‡ä»¶ï¼Œæ–‡ä»¶ç¬¬ä¸€è¡Œå£°æ˜åŒ…åï¼špackage com.jetbrainsã€‚ 2) åŒ…çš„å¯¼å…¥\nåŒ…çš„å¯¼å…¥æ ¼å¼ä¸º import èµ„æºå…¨åã€‚ åœ¨ Demo1.kt æ–‡ä»¶ä¸­æ·»åŠ  demo1 å‡½æ•°ï¼Œå‡½æ•°å…¨åä¸º com.jetbrains.demo1ã€‚ åœ¨ Main.kt æ–‡ä»¶ä¸­å¯¼å…¥å¹¶ä½¿ç”¨ com.jetbrains.demo1ï¼š import com.jetbrains.demo1 fun main(args: Array\u0026lt;String\u0026gt;) { demo1() } Kotlin é»˜è®¤å¯¼å…¥ä¸€äº›åŒ…ï¼Œæ— éœ€æ‰‹åŠ¨å¯¼å…¥ï¼š kotlin.* kotlin.annotation.* kotlin.collections.* kotlin.comparisons.* kotlin.io.* kotlin.ranges.* kotlin.sequences.* kotlin.text.* 2. ç¨‹åºå…¥å£ æ¯ä¸ª Kotlin ç¨‹åºéƒ½æœ‰ä¸€ä¸ªæ‰§è¡Œå…¥å£ï¼Œåœ¨æ¯ä¸ª Kotlin æ–‡ä»¶ä¸­ï¼Œmain å‡½æ•°æ˜¯æ‰§è¡Œå…¥å£ï¼š fun main() { println(\u0026#34;Hello world!\u0026#34;) } main å‡½æ•°å¯ä»¥æ¥æ”¶å¯å˜æ•°é‡çš„å­—ç¬¦ä¸²å‚æ•°ï¼š fun main(args: Array\u0026lt;String\u0026gt;) { println(args.contentToString()) } åœ¨å‘½ä»¤è¡Œä¸­è¿è¡Œç¨‹åºå¹¶ä¼ é€’å‚æ•°ï¼š $ kotlin MainKt a b c åœ¨ IDEA ä¸­ç›´æ¥è¿è¡Œæ—¶å¯ä»¥åœ¨è¾“å‡ºç›®å½•ä¸‹æ‰¾åˆ°ç¼–è¯‘åçš„ MainKt.class æ–‡ä»¶ï¼Œå¹¶æ‰‹åŠ¨æ‰§è¡Œã€‚ 3. æ ‡å‡†è¾“å…¥è¾“å‡º æ ‡å‡†è¾“å‡º\nprint æ‰“å°å†…å®¹åˆ°æ ‡å‡†è¾“å‡ºï¼Œä¸æ¢è¡Œã€‚ println æ‰“å°å†…å®¹åˆ°æ ‡å‡†è¾“å‡ºå¹¶æ¢è¡Œã€‚ print(\u0026#34;Hello, \u0026#34;) print(\u0026#34;World!\u0026#34;) println(\u0026#34;Hello, World!\u0026#34;) println(123) println(3.14) æ ‡å‡†è¾“å…¥\nreadln() è¯»å–ä¸€è¡Œè¾“å…¥ï¼Œè¿”å› String ç±»å‹ã€‚ val value = readln() ä½¿ç”¨ toInt() ç­‰æ–¹æ³•å°†è¾“å…¥è½¬æ¢ä¸ºå…¶ä»–åŸºæœ¬æ•°æ®ç±»å‹ï¼š val intValue = readln().toInt() val longValue = readln().toLong() val doubleValue = readln().toDouble() å¦‚æœä½¿ç”¨ Kotlin 1.6 ä¹‹å‰çš„ç‰ˆæœ¬ï¼Œéœ€ä½¿ç”¨ readLine()!!ï¼š val value = readLine()!! ä½¿ç”¨ split æ–¹æ³•è¯»å–å¤šä¸ªè¾“å…¥æ•°æ®ï¼Œä¾‹å¦‚ç©ºæ ¼åˆ†å‰²ï¼š val (a, b) = readln().split(\u0026#34; \u0026#34;) 4. å‡½æ•° å‡½æ•°å®šä¹‰\nä½¿ç”¨å…³é”®å­— fun å®šä¹‰å‡½æ•°ï¼š fun sum(a: Int, b: Int): Int { return a + b } Kotlin æ”¯æŒå‡½æ•°çš„è¡¨è¾¾å¼å½¢å¼ï¼Œè¿”å›å€¼å¯ä»¥è‡ªåŠ¨æ¨æ–­ï¼š fun sum(a: Int, b: Int) = a + b è¿”å› Unit ç±»å‹\nå¦‚æœå‡½æ•°ä¸è¿”å›ä»»ä½•æœ‰æ„ä¹‰çš„å€¼ï¼Œå¯ä»¥ç”¨ Unit å…³é”®å­—ï¼š fun printSum(a: Int, b: Int): Unit { println(\u0026#34;$a ä¸ $b çš„å’Œä¸º: ${a + b}\u0026#34;) } Unit ç±»å‹å¯ä»¥çœç•¥ï¼š fun printSum(a: Int, b: Int) { println(\u0026#34;$a ä¸ $b çš„å’Œä¸º: ${a + b}\u0026#34;) } å‚æ•°é»˜è®¤å€¼\nå‡½æ•°å‚æ•°å¯ä»¥æœ‰é»˜è®¤å€¼ï¼š fun sum(a: Int, b: Int = 0): Int { return a + b } 4. å‡½æ•° å‡½æ•°è°ƒç”¨\nå¯ä»¥åœ¨å…¶ä»–å‡½æ•°ä¸­è°ƒç”¨å‡½æ•°ï¼Œä¾‹å¦‚åœ¨ main å‡½æ•°ä¸­è°ƒç”¨ sum å‡½æ•°ï¼š\nfun main() { val res = sum(1, 2) println(res) } åŒºåˆ«ä¸åŒå‡½æ•°å¯ä»¥ä½¿ç”¨å‡½æ•°åå’Œå‚æ•°åˆ—è¡¨æ¥ç¡®å®šï¼š\nfun sum(a: Int): Int { return a } fun sum(a: Int, b: Int): Int { return a + b } fun printSum(a: Int, b: Int): Unit { println(a + b) } å‡½æ•°è°ƒç”¨ç¤ºä¾‹ï¼š\nfun main() { val a = sum(1) println(a) val b = sum(1, 2) println(b) printSum(1, 2) } å‡½æ•°çš„è°ƒç”¨ä¼šæ¶‰åŠåˆ°å…¥æ ˆã€å‡ºæ ˆæ“ä½œï¼Œéµå¾ªå…ˆå…¥åå‡ºçš„åŸåˆ™ã€‚\n5. å˜é‡ ä½¿ç”¨ val å…³é”®å­—å®šä¹‰åªè¯»å˜é‡\nåªè¯»å˜é‡èµ‹å€¼åä¸å¯æ›´æ”¹ï¼Œä½†å¯ä»¥å»¶è¿Ÿåˆå§‹åŒ–ï¼š\nfun main() { val a: Int = 1 // ç«‹å³èµ‹å€¼ val b = 2 // è‡ªåŠ¨æ¨æ–­ç±»å‹ val c: Int // æä¾›åˆå§‹å€¼å‰ï¼Œå…ˆå£°æ˜ç±»å‹ c = 3 // å»¶ååˆå§‹åŒ– println(\u0026#34;a = $a, b = $b, c = $c\u0026#34;) } ä½¿ç”¨ var å…³é”®å­—å®šä¹‰å¯å˜å˜é‡\nå¯å˜å˜é‡å¯ä»¥é‡æ–°èµ‹å€¼ï¼š\nfun main() { var a = 1 a = 2 println(\u0026#34;a = $a\u0026#34;) } val ç­‰ä»·äº Java çš„ private final å˜é‡ï¼Œvar ç­‰ä»·äº private å˜é‡ã€‚\nå®˜æ–¹æ¨èä¼˜å…ˆä½¿ç”¨ val å®šä¹‰å˜é‡ï¼Œé¿å…å‰¯ä½œç”¨ã€‚\n6. åŸºæœ¬æ•°æ®ç±»å‹ æ•°å€¼ç±»å‹ (Number)\nKotlin çš„æ•°å€¼ç±»å‹åˆ†ä¸ºä¸¤ç§ï¼šæ•´æ•°ç±»å‹ (Integer types) å’Œæµ®ç‚¹ç±»å‹ (Floating-point types)ã€‚ ç±»å‹ å¤§å° æœ€å°å€¼ æœ€å¤§å€¼ Byte 8bits(1Byte) -128 127 Short 16bits(2Byte) -32768 32767 Int 32bits(4Byte) -2,147,483,648 (-2^31) 2,147,483,647 (2^31-1) Long 64bits(8Byte) -9,223,372,036,854,775,808 (-2^63) 9,223,372,036,854,775,807 (2^63-1) æµ®ç‚¹ç±»å‹ Kotlin æä¾›ä¸¤ç§æµ®ç‚¹ç±»å‹ï¼šFloat å’Œ Doubleã€‚\nç±»å‹ å¤§å° æœ‰æ•ˆä½ æŒ‡æ•°ä½ å°æ•°ä½æ•° Float 32bits(4Byte) 24 8 6-7 Double 64bits(8Byte) 53 11 15-16 è¿™äº›ç±»å‹éƒ½ç»§æ‰¿è‡ª Number ç±»ã€‚\næ•´æ•°ç±»å‹ åœ¨ Kotlin ä¸­ï¼Œæ•´æ•°ç±»å‹çš„å˜é‡åˆå§‹åŒ–æ—¶ï¼Œå¦‚æœæ˜¾å¼æŒ‡å®šæ•°æ®ç±»å‹ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨æ¨æ–­ï¼š\nå¦‚æœå€¼åœ¨ Int ç±»å‹èŒƒå›´å†…ï¼Œé»˜è®¤ä¸º Int ç±»å‹ã€‚ å¦‚æœè¶…è¿‡ Int ç±»å‹èŒƒå›´ï¼Œè‡ªåŠ¨è½¬æ¢ä¸º Long ç±»å‹ã€‚ ä¾‹å¦‚ï¼š\nval int = 1 // Intç±»å‹ val long = 2147483648 // Longç±»å‹ println(long is Long) // true å¯ä»¥é€šè¿‡æ·»åŠ åç¼€ L æ˜¾å¼æŒ‡å®š Long ç±»å‹ï¼š\nval long = 2147483648L // Longç±»å‹ é»˜è®¤æƒ…å†µä¸‹ï¼Œå˜é‡ç±»å‹ä¸º Intï¼Œå¯ä»¥é€šè¿‡æ˜¾å¼å£°æ˜æŒ‡å®šå…¶ä»–ç±»å‹ï¼š\nval byte: Byte = 1 // Byteç±»å‹ å¦‚æœå˜é‡å€¼è¶…å‡ºç±»å‹é™åˆ¶ï¼Œç¼–è¯‘å™¨ä¼šæŠ¥é”™ã€‚\næ— ç¬¦å·æ•´å‹ Kotlin æä¾›äº†æ— ç¬¦å·æ•´æ•°ç±»å‹ï¼š\nç±»å‹ æ•°æ®èŒƒå›´ UByte 0-255 UShort 0-65535 UInt 0-2^32-1 ULong 0-2^64-1 æµ®ç‚¹å‹å˜é‡ åˆå§‹åŒ–æµ®ç‚¹å‹å˜é‡æ—¶ï¼Œæœªæ˜¾å¼æŒ‡å®šç±»å‹é»˜è®¤ä¸º Doubleã€‚å¯ä»¥é€šè¿‡æ·»åŠ åç¼€ F æŒ‡å®šä¸º Floatï¼š\nval double = 1.0 // Doubleç±»å‹ val float = 1.0f // Floatç±»å‹ å¦‚æœæ˜¾å¼æŒ‡å®šæµ®ç‚¹ç±»å‹å´èµ‹å€¼ä¸ºæ•´æ•°ï¼Œç¼–è¯‘å™¨ä¼šæŠ¥é”™ã€‚\nJVM ä¸­çš„æ•°å­—è¡¨ç¤º åœ¨ Kotlin ä¸­ï¼Œ== ç”¨äºæ¯”è¾ƒæ•°å€¼ï¼Œ=== ç”¨äºæ¯”è¾ƒå¯¹è±¡å¼•ç”¨ã€‚\nå¯¹äºå¯ç©ºçš„æ•°å­—å¼•ç”¨ï¼š\nval a = 128 val b: Int? = a val c: Int? = a println(b == c) // true println(b === c) // false å½“å€¼åœ¨ -128 åˆ° 127 èŒƒå›´å†…æ—¶ï¼Œå¯¹è±¡å¼•ç”¨ç›¸åŒï¼š\nval a = 127 val b: Int? = a val c: Int? = a println(b === c) // true ç±»å‹è½¬æ¢ Kotlin æä¾›ç±»å‹è½¬æ¢å‡½æ•°å¦‚ toInt(), toDouble() ç­‰ï¼Œå¦‚ sqrt() å‡½æ•°éœ€è¦ä¼ å…¥æµ®ç‚¹å‹ï¼š\nval num = 16.toDouble() println(sqrt(num)) 2. å¸ƒå°”ç±»å‹ å¸ƒå°”ç±»å‹çš„å€¼åªæœ‰ true å’Œ false ä¸¤ç§ï¼Œå¸ƒå°”å€¼å¯ä»¥ä¸ºç©ºã€‚\nval a: Boolean = true val b = false val c: Boolean? = null println(a \u0026amp;\u0026amp; b) // false println(a || b) // true 3. å­—ç¬¦ç±»å‹ ä¸ Java ä¸åŒï¼ŒKotlin ä¸­å­—ç¬¦ç±»å‹ä¸å±äºæ•°å€¼ç±»å‹ï¼Œä¸èƒ½ä¸æ•°å­—è¿›è¡Œæ“ä½œã€‚\nval a: Char = \u0026#39;a\u0026#39; val b = \u0026#39;b\u0026#39; val c = \u0026#39;\\n\u0026#39; print(a) print(c) print(b) å¯ä»¥é€šè¿‡ code å±æ€§è·å–å­—ç¬¦çš„ ASCII ç¼–ç ã€‚\nval a = \u0026#39;a\u0026#39; println(a.code) // 97 4. å­—ç¬¦ä¸²ç±»å‹ å­—ç¬¦ä¸²ç±»å‹ç”¨ \u0026quot;\u0026quot; è¡¨ç¤ºã€‚\nval s: String = \u0026#34;I\u0026#39;m a coder\u0026#34; println(s) å¯ä»¥ç”¨ in å…³é”®å­—åˆ¤æ–­å­—ç¬¦æ˜¯å¦å‡ºç°åœ¨å­—ç¬¦ä¸²ä¸­ï¼Œä¹Ÿå¯ä»¥é€šè¿‡è¯¥å…³é”®å­—éå†å­—ç¬¦ä¸²ã€‚\nval c = \u0026#39;I\u0026#39; val s: String = \u0026#34;I\u0026#39;m a coder\u0026#34; println(c in s) // true for (c in s) { println(c) } å¯ä»¥é€šè¿‡ uppercase() æ–¹æ³•å°†å­—ç¬¦ä¸²å…¨è½¬æ¢ä¸ºå¤§å†™ã€‚\nprintln(\u0026#34;abcd\u0026#34;.uppercase()) // ABCD å¯ä»¥é€šè¿‡ + æ¥è¿æ¥å­—ç¬¦ä¸²ã€‚\nval a = \u0026#34;abc\u0026#34; val b = a + \u0026#34;def\u0026#34; println(b) å¯ä»¥é€šè¿‡ \u0026quot;\u0026quot;\u0026quot; \u0026quot;\u0026quot;\u0026quot; æ¥ä½¿ç”¨åŸå§‹å­—ç¬¦ä¸²ï¼Œå®ƒä¸ä¼šå¤„ç†è½¬ä¹‰ç¬¦ï¼Œå¯ä»¥åŒ…å«æ¢è¡Œç¬¦å’Œä»»æ„å­—ç¬¦ï¼Œå¯ä»¥é€šè¿‡ trimMargin() å»æ‰å‰å¯¼ç©ºæ ¼ã€‚\nval s = \u0026#34;\u0026#34;\u0026#34; #include \u0026lt;iostream\u0026gt; using namespace std; int main() { cout \u0026lt;\u0026lt; \u0026#34;Hello, World!\u0026#34; } \u0026#34;\u0026#34;\u0026#34;.trimMargin() println(s) å­—ç¬¦ä¸²æ¨¡æ¿ï¼š\nval i = 1 println(\u0026#34;i = $i\u0026#34;) // i = 1 val s = \u0026#34;abc\u0026#34; println(\u0026#34;s.length = ${s.length}\u0026#34;) // s.length = 3 5. æ•°ç»„ç±»å‹ åœ¨ Kotlin ä¸­ï¼Œæ•°ç»„ç”± Array ç±»è¡¨ç¤ºã€‚\næ•°ç»„çš„å®šä¹‰å¯ä»¥é€šè¿‡ arrayOf() æˆ–è€… Array æ„é€ å‡½æ•°æ–¹å¼ã€‚\nval a: Array\u0026lt;String\u0026gt; = arrayOf(\u0026#34;a\u0026#34;, \u0026#34;b\u0026#34;, \u0026#34;c\u0026#34;) val b: Array\u0026lt;Int\u0026gt; = arrayOf(1, 2, 3) å¯ä»¥é€šè¿‡ forEach() æ–¹æ³•éå†æ•°ç»„ã€‚\na.forEach { println(it) } æ•°ç»„ç±»æœ‰ size å±æ€§ï¼Œå¯ä»¥é€šè¿‡å®ƒå¾—åˆ°æ•°ç»„çš„é•¿åº¦ã€‚\n6. ä»»æ„ç±»å‹ Kotlin ä¸­çš„ Any ç±»æ˜¯æ‰€æœ‰éç©ºç±»å‹çš„è¶…ç±»ï¼Œä¸ Java ä¸­çš„ Object ç±»ç›¸ä¼¼ã€‚\n7. ç±»å‹çš„æ£€æŸ¥å’Œå¼ºåˆ¶è½¬æ¢ ç±»å‹æ£€æŸ¥ï¼šä½¿ç”¨ is å…³é”®å­—è¿›è¡Œç±»å‹æ£€æŸ¥ã€‚\nval s = \u0026#34;Hello\u0026#34; println(s is String) // true ä¸å®‰å…¨ç±»å‹è½¬æ¢ï¼šä½¿ç”¨ as å…³é”®å­—è¿›è¡Œå¼ºåˆ¶è½¬æ¢ï¼Œå¦‚æœè½¬æ¢å¤±è´¥ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚\nval y = null val x: String = y as String // æŠ›å‡ºå¼‚å¸¸ å®‰å…¨ç±»å‹è½¬æ¢ï¼šä½¿ç”¨ as? å…³é”®å­—è¿›è¡Œå®‰å…¨ç±»å‹è½¬æ¢ï¼Œè½¬æ¢å¤±è´¥æ—¶è¿”å› null è€Œä¸ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚\nval y = null val x: String? = y as? String println(x) // null 8. æ¡ä»¶åˆ¤æ–­ã€å¾ªç¯è¯­å¥ if åˆ¤æ–­æ¡ä»¶ åŸºæœ¬å½¢å¼ï¼š\nval a = 1 val b = 2 var max = a if (a \u0026gt; b) { max = a } else { max = b } è¡¨è¾¾å¼å½¢å¼ï¼š\nval a = 1 val b = 2 val max = if (a \u0026gt; b) a else b å—ä¸­çš„è¡¨è¾¾å¼ï¼š\nval a = 1 val b = 2 val max = if (a \u0026gt; b) { println(a) a } else { println(b) b } ä¸ in å…³é”®å­—æ­é…ä½¿ç”¨ï¼š\nif (1 in 1..10) { println(\u0026#34;Yes\u0026#34;) } else { println(\u0026#34;No\u0026#34;) } when è¡¨è¾¾å¼ åŸºæœ¬ç”¨æ³•ï¼šç±»ä¼¼äº switchï¼Œä½†åŠŸèƒ½æ›´å¼ºå¤§ã€‚\nval x: Int = 1 when (x) { 1 -\u0026gt; println(1) 2 -\u0026gt; println(2) else -\u0026gt; println(\u0026#34;No condition matched\u0026#34;) } å¤šå€¼åŒ¹é…ï¼š\nwhen (x) { 0, 1 -\u0026gt; println(\u0026#34;x is 0 or 1\u0026#34;) else -\u0026gt; println(\u0026#34;x is neither 0 nor 1\u0026#34;) } when è¡¨è¾¾å¼ ç®€å•åŒ¹é…ï¼š\nval x: Int = 1 when (x) { 1, 2 -\u0026gt; println(\u0026#34;1 or 2\u0026#34;) else -\u0026gt; println(\u0026#34;No conditions matched\u0026#34;) } ä¼ å…¥å‡½æ•°ï¼ŒåŒ¹é…å‡½æ•°çš„è¿”å›å€¼ï¼š\nfun getNum(x: Int) = x * 2 fun main() { when (getNum(2)) { 2 -\u0026gt; println(2) 4 -\u0026gt; println(4) } } ä½¿ç”¨ is å’Œ in å…³é”®å­—ï¼š\nfun getNum(x: Int) = x * 2 fun main() { when (getNum(2)) { in 1..2 -\u0026gt; println(\u0026#34;1..2\u0026#34;) } } å¾ªç¯è¯­å¥ for å¾ªç¯ï¼š\nfor (i in 1..10) { println(i) // 1 åˆ° 10 } for (i in 0..6 step 2) { println(i) // 0, 2, 4, 6 } for (i in 6 downTo 0 step 2) { println(i) // 6, 4, 2, 0 } éå† Array å¯¹è±¡ï¼š\nval array: Array\u0026lt;Int\u0026gt; = arrayOf(1, 2, 3, 4) for (i in array) { println(i) } é€šè¿‡ç´¢å¼•éå†ï¼š\nval array: Array\u0026lt;Int\u0026gt; = arrayOf(1, 2, 3, 4) for (i in array.indices) { println(array[i]) } ä½¿ç”¨ withIndexï¼š\nval array: Array\u0026lt;Int\u0026gt; = arrayOf(1, 2, 3, 4) for ((index, value) in array.withIndex()) { println(\u0026#34;index: $index, value: $value\u0026#34;) } ä½¿ç”¨ break å’Œ continueï¼š\nfor (i in array.withIndex()) { if (i == 2) break // ç»ˆæ­¢å¾ªç¯ if (i == 1) continue // è·³è¿‡æœ¬æ¬¡å¾ªç¯ } while å¾ªç¯ åŸºæœ¬ç”¨æ³•ï¼š\nvar x = 3 while (x \u0026gt; 0) { println(x) x-- } var y = 3 do { println(y) y-- } while (y \u0026gt; 0) é¢å‘å¯¹è±¡ ç‰¹æ®Šè¯­æ³•ç³– class DetailActivity : AppCompatActivity() { companion object { const val EXTRA_POSITION = \u0026#34;position\u0026#34; } override fun onCreate(savedInstanceState: Bundle?) { super.onCreate(savedInstanceState) setContentView(R.layout.activity_detail) val pos = intent.getIntExtra(EXTRA_POSITION, -1) val textView = findViewById\u0026lt;TextView\u0026gt;(R.id.text) val imageView = findViewById\u0026lt;ImageView\u0026gt;(R.id.image) val likeView = findViewById\u0026lt;View\u0026gt;(R.id.like) when (val item = ItemDataManager.items[pos]) { is Item.TextItem -\u0026gt; { textView.text = item.text textView.visibility = View.VISIBLE imageView.visibility = View.GONE likeView.run { isSelected = item.like setOnClickListener { item.like = !item.like isSelected = item.like } } } is Item.ImageItem -\u0026gt; { imageView.setImageResource(item.imageResId) imageView.visibility = View.VISIBLE textView.visibility = View.GONE likeView.run { isSelected = item.like setOnClickListener { item.like = !item.like isSelected = item.like } } } } } } class MyAdapter( private val items: List\u0026lt;Item\u0026gt;, private val onClick: (Int) -\u0026gt; Unit ) : RecyclerView.Adapter\u0026lt;RecyclerView.ViewHolder\u0026gt;() { class TextViewHolder(itemView: View) : RecyclerView.ViewHolder(itemView) { val textView: TextView? = itemView.findViewById(R.id.text) val likeView: View? = itemView.findViewById(R.id.like) } class ImageViewHolder(itemView: View) : RecyclerView.ViewHolder(itemView) { val imageView: ImageView? = itemView.findViewById(R.id.image) val likeView: View? = itemView.findViewById(R.id.like) } override fun onCreateViewHolder(parent: ViewGroup, viewType: Int): RecyclerView.ViewHolder { return when (viewType) { TEXT_TYPE -\u0026gt; { val view = LayoutInflater.from(parent.context).inflate(R.layout.item_text, parent, false) TextViewHolder(view) } IMAGE_TYPE -\u0026gt; { val view = LayoutInflater.from(parent.context).inflate(R.layout.item_image, parent, false) ImageViewHolder(view) } else -\u0026gt; { val view = LayoutInflater.from(parent.context).inflate(R.layout.item_text, parent, false) TextViewHolder(view) } } } override fun onBindViewHolder(holder: RecyclerView.ViewHolder, position: Int) { holder.itemView.setOnClickListener { onClick(position) } when (val item = items[position]) { is Item.TextItem -\u0026gt; { val textHolder = holder as TextViewHolder textHolder.textView?.text = item.text textHolder.likeView?.run { isSelected = item.like setOnClickListener { item.like = !item.like isSelected = item.like } } } is Item.ImageItem -\u0026gt; { val imageHolder = holder as ImageViewHolder imageHolder.imageView?.setImageResource(item.imageResId) imageHolder.likeView?.run { isSelected = item.like setOnClickListener { item.like = !item.like isSelected = item.like } } } } } override fun getItemCount() = items.size override fun getItemViewType(position: Int) = when (items[position]) { is Item.TextItem -\u0026gt; TEXT_TYPE is Item.ImageItem -\u0026gt; IMAGE_TYPE } companion object { private const val TEXT_TYPE = 1 private const val IMAGE_TYPE = 2 } } ","permalink":"https://kennems.github.io/posts/tech/%E7%AC%AC%E5%8D%81%E4%B8%80%E5%A4%A9%E7%AC%94%E8%AE%B0/","summary":"ç¬¬åä¸€å¤©ç¬”è®° Kotlin è®²ä¹‰æ€»ç»“ 1. åŒ…çš„å®šä¹‰ä¸å¯¼å…¥ 1) åŒ…çš„å£°æ˜ åŒ…çš„å£°æ˜åœ¨ä»£ç æ–‡ä»¶çš„å¼€å¤´ï¼Œæ ¼å¼ä¸º package åŒ…åã€‚ åŒ…åæ˜¯å·¥ç¨‹æ ¹ç›®å½•ä¸‹çš„å­ç›®å½•ï¼Œå¦‚ com.jetbrai","title":"è®­ç»ƒè¥ç¬¬åä¸€å¤©ç¬”è®°"},{"content":"ç¬¬åå¤©ç¬”è®° å†…å­˜æ³„æ¼ 1. Javaåƒåœ¾å›æ”¶æœºåˆ¶ 1.1 ä»€ä¹ˆæ˜¯åƒåœ¾å›æ”¶ åƒåœ¾å›æ”¶ï¼ˆGCï¼‰æ˜¯ç”±Javaè™šæ‹Ÿæœºï¼ˆJVMï¼‰åƒåœ¾å›æ”¶å™¨æä¾›çš„ä¸€ç§å†…å­˜å›æ”¶æœºåˆ¶ã€‚ å½“å†…å­˜ç©ºé—´æˆ–å†…å­˜å ç”¨è¿‡é«˜æ—¶ï¼Œç³»ç»Ÿä¼šå›æ”¶é‚£äº›æ²¡æœ‰å¼•ç”¨çš„å¯¹è±¡ã€‚ JVMå†…å­˜æ¨¡å‹ è¿è¡Œæ—¶æ•°æ®åŒºåŸŸï¼šåŒ…æ‹¬æ–¹æ³•åŒºã€å †ã€æ ˆã€æœ¬åœ°æ–¹æ³•æ ˆå’Œç¨‹åºè®¡æ•°å™¨ç­‰ã€‚ å †å†…å­˜ï¼š æ–°ç”Ÿä»£ï¼ˆYoung Generationï¼‰ï¼šåˆ†ä¸ºEdenåŒºå’Œä¸¤ä¸ªSurvivoråŒºï¼ˆS0ã€S1ï¼‰ã€‚ è€å¹´ä»£ï¼ˆOld Generationï¼‰ã€‚ æ–¹æ³•åŒºï¼ˆMetaSpaceï¼‰ï¼šå­˜å‚¨ç±»å…ƒæ•°æ®ã€æ–¹æ³•ä¿¡æ¯ç­‰ã€‚ 1.2 åˆ¤æ–­å¯¹è±¡æ˜¯å¦æ˜¯åƒåœ¾çš„ç®—æ³• 1.2.1 å¼•ç”¨è®¡æ•°ç®—æ³• å¯¹è±¡è¢«åˆ›å»ºåï¼Œç³»ç»Ÿä¸ºå…¶åˆå§‹åŒ–å¼•ç”¨è®¡æ•°å™¨ã€‚ æ¯å½“å¯¹è±¡è¢«å¼•ç”¨æ—¶ï¼Œè®¡æ•°å™¨åŠ 1ï¼Œå¼•ç”¨å¤±æ•ˆæ—¶ï¼Œè®¡æ•°å™¨å‡1ã€‚ å½“è®¡æ•°å™¨ä¸º0æ—¶ï¼Œå¯¹è±¡ä¸å†è¢«å¼•ç”¨ï¼Œå¯ä»¥è¿›è¡Œå›æ”¶ã€‚ ä¼˜ç‚¹ï¼šåˆ¤æ–­ç®€å•ï¼Œæ•ˆç‡é«˜ã€‚ ç¼ºç‚¹ï¼šæ— æ³•é¿å…å¾ªç¯å¼•ç”¨ã€‚ 1.2.2 å¯è¾¾æ€§åˆ†ææ³• ä»GC Rootså‡ºå‘ï¼Œé€æ­¥éå†åˆ°æ‰€æœ‰å¯è¾¾çš„å¯¹è±¡ã€‚ è¿™äº›å¯¹è±¡ç§°ä¸ºå¯è¾¾å¯¹è±¡ï¼Œä¸å¯è¾¾çš„å¯¹è±¡åˆ™è¢«æ ‡è®°ä¸ºåƒåœ¾ï¼Œéœ€è¦å›æ”¶ã€‚ GC RootsåŒ…æ‹¬çš„å¯¹è±¡ï¼š è™šæ‹Ÿæœºæ ˆä¸­å¼•ç”¨çš„å¯¹è±¡ï¼ˆæ ˆå¸§ä¸­çš„æœ¬åœ°å˜é‡è¡¨ï¼‰ã€‚ æ–¹æ³•åŒºä¸­ç±»é™æ€å±æ€§å¼•ç”¨çš„å¯¹è±¡ã€‚ æ–¹æ³•åŒºä¸­å¸¸é‡å¼•ç”¨çš„å¯¹è±¡ã€‚ æœ¬åœ°æ–¹æ³•æ ˆä¸­JNIï¼ˆNativeæ–¹æ³•ï¼‰å¼•ç”¨çš„å¯¹è±¡ã€‚ Javaä¸­çš„å¯¹è±¡å¼•ç”¨ Javaä¸­çš„å¯¹è±¡å¼•ç”¨ä¸»è¦åˆ†ä¸ºå››ç§ç±»å‹ï¼š\n1. å¼ºå¼•ç”¨ (Strong Reference) å®šä¹‰: ä¾‹å¦‚ Object obj = new Object()ï¼Œè¿™æ˜¯Javaç¨‹åºä¸­æœ€å¸¸è§çš„å¼•ç”¨ç±»å‹ã€‚ ç‰¹ç‚¹: å¼ºå¼•ç”¨æ˜¯ä¸å¯å›æ”¶çš„èµ„æºï¼Œåƒåœ¾å›æ”¶å™¨ä¸ä¼šå›æ”¶å®ƒã€‚å½“å†…å­˜ç©ºé—´ä¸è¶³æ—¶ï¼ŒJVMå®æ„¿æŠ›å‡º OutOfMemoryError é”™è¯¯ï¼Œä¹Ÿä¸ä¼šå›æ”¶å¼ºå¼•ç”¨çš„å¯¹è±¡ã€‚ 2. è½¯å¼•ç”¨ (Soft Reference) å®šä¹‰: è½¯å¼•ç”¨æ˜¯ä¸€ç§ç›¸å¯¹å¼ºå¼•ç”¨æœ‰æ‰€å¼±åŒ–çš„å¼•ç”¨ã€‚ ç‰¹ç‚¹: å¯ä»¥è®©å¯¹è±¡é¿å…ä¸€äº›åƒåœ¾æ”¶é›†ã€‚åªæœ‰å½“JVMè®¤ä¸ºå†…å­˜ä¸è¶³æ—¶ï¼Œæ‰ä¼šå°è¯•å›æ”¶è½¯å¼•ç”¨æŒ‡å‘çš„å¯¹è±¡ã€‚åœ¨æŠ›å‡º OutOfMemoryError ä¹‹å‰ï¼ŒJVMä¼šç¡®ä¿å›æ”¶è½¯å¼•ç”¨çš„å¯¹è±¡ã€‚è½¯å¼•ç”¨é€šå¸¸ç”¨äºå®ç°å†…å­˜æ•æ„Ÿçš„ç¼“å­˜ï¼Œå¦‚æœæœ‰è¶³å¤Ÿå†…å­˜ï¼Œè½¯å¼•ç”¨å¯¹è±¡ä¼šè¢«ä¿ç•™ã€‚ 3. å¼±å¼•ç”¨ (Weak Reference) å®šä¹‰: å¼±å¼•ç”¨çš„å¼ºåº¦æ¯”è½¯å¼•ç”¨æ›´å¼±ã€‚ ç‰¹ç‚¹: æ— è®ºå†…å­˜æ˜¯å¦å……è¶³ï¼Œå½“JVMè¿›è¡Œåƒåœ¾å›æ”¶æ—¶ï¼Œéƒ½ä¼šå›æ”¶è¢«å¼±å¼•ç”¨å…³è”çš„å¯¹è±¡ã€‚ 4. è™šå¼•ç”¨ (Phantom Reference) å®šä¹‰: è™šå¼•ç”¨ä¹Ÿç§°ä¸ºå¹½çµå¼•ç”¨æˆ–å¹»è±¡å¼•ç”¨ï¼Œæ˜¯æœ€å¼±çš„ä¸€ç§å¼•ç”¨å…³ç³»ã€‚ ç‰¹ç‚¹: è™šå¼•ç”¨çš„å­˜åœ¨ä¸ä¼šå¯¹å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸæ„æˆå½±å“ï¼Œæ— æ³•é€šè¿‡è™šå¼•ç”¨è·å¾—å¯¹è±¡å®ä¾‹ã€‚å”¯ä¸€çš„ç›®çš„æ˜¯åœ¨å¯¹è±¡è¢«åƒåœ¾å›æ”¶å™¨å›æ”¶æ—¶æ”¶åˆ°ç³»ç»Ÿé€šçŸ¥ã€‚ å›¾ç¤ºæ€»ç»“ å¼ºå¼•ç”¨: åªæœ‰åœ¨æ²¡æœ‰ç©ºé—²å†…å­˜æ—¶æ‰ä¼šè¢«å›æ”¶ã€‚ è½¯å¼•ç”¨: åœ¨å†…å­˜ä¸è¶³æ—¶ä¼šè¢«å›æ”¶ã€‚ å¼±å¼•ç”¨: åœ¨åƒåœ¾å›æ”¶æ£€æµ‹æ—¶ç«‹å³å›æ”¶ã€‚ è™šå¼•ç”¨: ä¸ä¼šç›´æ¥å½±å“å¯¹è±¡ç”Ÿå‘½å‘¨æœŸï¼Œä½†èƒ½åœ¨å¯¹è±¡è¢«å›æ”¶æ—¶æ”¶åˆ°é€šçŸ¥ã€‚ è¿™ä¸ªå›¾ç¤ºå±•ç¤ºäº†ä¸åŒå¼•ç”¨ç±»å‹å¦‚ä½•ä¸åƒåœ¾å›æ”¶å™¨äº¤äº’ï¼Œä»¥åŠåœ¨åƒåœ¾å›æ”¶åçš„ç»“æœã€‚\nåˆè¯†ANR ä¸»çº¿ç¨‹æ‰§è¡Œè€—æ—¶æ“ä½œ å½“ä¸»çº¿ç¨‹æ‰§è¡Œè€—æ—¶æ“ä½œï¼ˆå¦‚å¤§é‡è®¡ç®—ã€å¾ªç¯ã€é€’å½’ã€IOæ“ä½œç­‰ï¼‰ä¼šå¯¼è‡´ANRã€‚\nç¤ºä¾‹ä»£ç :\nmBind.textView.setOnClickListener(new View.OnClickListener() { @Override public void onClick(View v) { while (true) { Log.i(\u0026#34;TAG\u0026#34;, \u0026#34;ä¸»çº¿ç¨‹æ‰§è¡Œè€—æ—¶æ“ä½œ\u0026#34;); try { // æ‰§è¡Œè€—æ—¶æ“ä½œ Thread.sleep(500); } catch (Exception e) { e.printStackTrace(); } } } }); æ­»é” å½“å¯¹è±¡é”è¢«å…¶ä»–çº¿ç¨‹æŒæœ‰ï¼Œä¸»çº¿ç¨‹é•¿æ—¶é—´æ— æ³•è·å–å½“å‰å¯¹è±¡é”ï¼Œä¼šå¯¼è‡´ANRã€‚\nç¤ºä¾‹ä»£ç :\npublic class MainThreadAnrActivity extends BaseActivity\u0026lt;ActivityHandlerBinding\u0026gt; { private final Object object = new Object(); private final String TAG = MainThreadAnrActivity.class.getSimpleName(); private boolean taskComplete = false; @Override protected void bindListener() { super.bindListener(); mBind.textView.setOnClickListener(new View.OnClickListener() { @Override public void onClick(View v) { // éœ€è¦ä½¿ç”¨å­çº¿ç¨‹æ‰§è¡Œçš„ç»“æœ synchronized (object) { Log.i(TAG, \u0026#34;æ­»é”å¯¼è‡´ANR \u0026#34; + taskComplete); } } }); new Thread(new Runnable() { @Override public void run() { synchronized (object) { try { Thread.sleep(30 * 1000); taskComplete = true; } catch (Exception e) { e.printStackTrace(); } } } }).start(); } } è§£å†³æ–¹æ³• ä½¿ç”¨ReentrantLockä»£æ›¿synchronizedï¼ŒåŒæ—¶tryLock()å¢åŠ æœ€å¤§ç­‰å¾…æ—¶é—´ï¼Œè¶…è¿‡æœ€å¤§ç­‰å¾…æ—¶é—´ä¸»åŠ¨é‡Šæ”¾é”ï¼Œé¿å…å‡ºç°ANRã€‚ ç¤ºä¾‹ä»£ç :\nReentrantLock lock = new ReentrantLock(); lock.tryLock(3000, TimeUnit.MICROSECONDS); androidé•¿ç”Ÿå‘½å‘¨æœŸï¼šapplicationï¼Œ service content provider\nä½œä¸š ","permalink":"https://kennems.github.io/posts/tech/%E7%AC%AC%E5%8D%81%E5%A4%A9%E7%AC%94%E8%AE%B0/","summary":"ç¬¬åå¤©ç¬”è®° å†…å­˜æ³„æ¼ 1. Javaåƒåœ¾å›æ”¶æœºåˆ¶ 1.1 ä»€ä¹ˆæ˜¯åƒåœ¾å›æ”¶ åƒåœ¾å›æ”¶ï¼ˆGCï¼‰æ˜¯ç”±Javaè™šæ‹Ÿæœºï¼ˆJVMï¼‰åƒåœ¾å›æ”¶å™¨æä¾›çš„ä¸€ç§å†…å­˜å›æ”¶æœºåˆ¶ã€‚ å½“å†…å­˜","title":"è®­ç»ƒè¥ç¬¬åå¤©ç¬”è®°"},{"content":"ç¬¬ä¹å¤©ç¬”è®° æƒé™ä¸ç½‘ç»œè¯·æ±‚è¯¾ç¨‹é¢„ä¹  1. æœ‰å“ªäº›æƒé™ï¼Œå…·ä½“æƒé™çš„ä»‹ç» æ™®é€šæƒé™ ç½‘ç»œæƒé™ï¼šå…è®¸è®¾å¤‡è®¿é—®ç½‘ç»œ\n\u0026lt;uses-permission android:name=\u0026#34;android.permission.INTERNET\u0026#34; /\u0026gt; è·å–ç½‘ç»œçš„çŠ¶æ€ï¼šå¦‚æ˜¯å¦æœ‰ç½‘\n\u0026lt;uses-permission android:name=\u0026#34;android.permission.ACCESS_NETWORK_STATE\u0026#34; /\u0026gt; è¯»å–æ‰‹æœºçŠ¶æ€ï¼šå¦‚IMEIç­‰ä¿¡æ¯\n\u0026lt;uses-permission android:name=\u0026#34;android.permission.READ_PHONE_STATE\u0026#34; /\u0026gt; è·å–WiFiçš„çŠ¶æ€\n\u0026lt;uses-permission android:name=\u0026#34;android.permission.ACCESS_WIFI_STATE\u0026#34; /\u0026gt; æ•æ„Ÿæƒé™ å†™å…¥SDKæƒé™ï¼šæ–‡ä»¶ä¸‹è½½ã€å›¾ç‰‡ä¸‹è½½\n\u0026lt;uses-permission android:name=\u0026#34;android.permission.WRITE_EXTERNAL_STORAGE\u0026#34; /\u0026gt; è¯»å–SDKçš„æƒé™ï¼šè¯»å–ç›¸å†Œã€æ–‡ä»¶\n\u0026lt;uses-permission android:name=\u0026#34;android.permission.READ_EXTERNAL_STORAGE\u0026#34; /\u0026gt; æ‹æ‘„ç…§ç‰‡å’Œè§†é¢‘\n\u0026lt;uses-permission android:name=\u0026#34;android.permission.CAMERA\u0026#34; /\u0026gt; å½•éŸ³\n\u0026lt;uses-permission android:name=\u0026#34;android.permission.RECORD_AUDIO\u0026#34; /\u0026gt; æ‹¨æ‰“ç”µè¯\n\u0026lt;uses-permission android:name=\u0026#34;android.permission.CALL_PHONE\u0026#34; /\u0026gt; è¯»å–æ‰‹æœºè”ç³»äºº\n\u0026lt;uses-permission android:name=\u0026#34;android.permission.READ_CONTACTS\u0026#34; /\u0026gt; å¾€æ‰‹æœºå†™å…¥è”ç³»äºº\n\u0026lt;uses-permission android:name=\u0026#34;android.permission.WRITE_CONTACTS\u0026#34; /\u0026gt; æƒé™ä¸ç½‘ç»œè¯·æ±‚è¯¾ç¨‹é¢„ä¹ ç¬”è®° 1. æƒé™ç”³è¯·æ–¹æ³• æ£€æŸ¥æ˜¯å¦æˆæƒ // æ£€æŸ¥æ˜¯å¦æˆæƒ checkSelfPermission(Manifest.permission.WRITE_EXTERNAL_STORAGE); ContextCompat.checkSelfPermission(this, Manifest.permission.WRITE_EXTERNAL_STORAGE); æƒé™ç”³è¯· requestPermissions(new String[]{Manifest.permission.CAMERA}, 200); æƒé™ç”³è¯·ç»“æœå¤„ç† public void onRequestPermissionsResult(int requestCode, @NonNull String[] permissions, @NonNull int[] grantResults) { // å¤„ç†æƒé™ç”³è¯·ç»“æœ } 2. OkHttpä»‹ç» OkHttp æ˜¯ Square å…¬å¸å¼€æºçš„ï¼Œä¸“æ³¨äºè¿æ¥æ•ˆç‡çš„ HTTP å®¢æˆ·ç«¯ã€‚OkHttp æä¾›äº†å¯¹ HTTP/2 å’Œ SPDY çš„æ”¯æŒï¼Œå¹¶æä¾›äº†è¿æ¥æ± ã€GZIP å‹ç¼©å’Œ HTTP å“åº”ç¼“å­˜åŠŸèƒ½ã€‚\nä½¿ç”¨ OkHttp è¿›è¡ŒåŒæ­¥è¯·æ±‚ implementation(\u0026#34;com.squareup.okhttp3:okhttp:4.12.0\u0026#34;); // 1. åˆ›å»º OkHttpClient private final OkHttpClient okHttpClient = new OkHttpClient.Builder().build(); // 2. åˆ›å»º Request Request request = new Request.Builder() .get() .url(\u0026#34;https://hotfix-service-prod.g.mi.com/quick-game/game/109\u0026#34;) .build(); // 3. åŒæ­¥è¯·æ±‚ Response response = okHttpClient.newCall(request).execute(); é€šè¿‡ä»¥ä¸Šæ­¥éª¤å¯ä»¥å®ç° OkHttp çš„åŒæ­¥è¯·æ±‚ï¼Œåˆ†åˆ«åˆ›å»º OkHttpClient å®ä¾‹å’Œ Request å®ä¾‹ï¼Œç„¶åé€šè¿‡ newCall æ–¹æ³•æ‰§è¡Œè¯·æ±‚ã€‚\nå¼‚æ­¥è¯·æ±‚ä¸Handler 1. ä½¿ç”¨ OkHttp è¿›è¡Œå¼‚æ­¥è¯·æ±‚ ä»¥ä¸‹æ˜¯ä½¿ç”¨ OkHttp è¿›è¡Œå¼‚æ­¥è¯·æ±‚çš„æ­¥éª¤ï¼š\n// 1. åˆ›å»º Request Request request = new Request.Builder() .get() .url(\u0026#34;https://hotfix-service-prod.g.mi.com/quick-game/game/109\u0026#34;) .build(); // 2. å¼‚æ­¥è¯·æ±‚ okHttpClient.newCall(request).enqueue(new Callback() { @Override public void onFailure(@NonNull Call call, @NonNull IOException e) { Log.i(TAG, \u0026#34;ç½‘ç»œè¯·æ±‚å¤±è´¥\u0026#34;); } @Override public void onResponse(@NonNull Call call, @NonNull Response response) throws IOException { Log.i(TAG, \u0026#34;ç½‘ç»œè¯·æ±‚æˆåŠŸ, code \u0026#34; + response.code()); } }); åˆ›å»º Request å¯¹è±¡ï¼ŒæŒ‡å®šè¯·æ±‚æ–¹å¼å’ŒURLã€‚\nä½¿ç”¨\nenqueue æ–¹æ³•è¿›è¡Œå¼‚æ­¥è¯·æ±‚ï¼Œå¹¶å®ç°\nCallback æ¥å£å¤„ç†è¯·æ±‚ç»“æœã€‚\nonFailure æ–¹æ³•å¤„ç†è¯·æ±‚å¤±è´¥æƒ…å†µã€‚ onResponse æ–¹æ³•å¤„ç†è¯·æ±‚æˆåŠŸæƒ…å†µã€‚ 2. ä»€ä¹ˆæ˜¯ Handler Handler æ˜¯ Android ä¸­çš„æ¶ˆæ¯ä¼ é€’æœºåˆ¶ï¼Œä¸»è¦ç”¨äºçº¿ç¨‹é—´é€šä¿¡ã€‚å…¶ä¸»è¦åŠŸèƒ½åŒ…æ‹¬ï¼š\nåœ¨å­çº¿ç¨‹é€šè¿‡ Handler å°†æ›´æ–° UI çš„æ“ä½œä¼ é€’ç»™ä¸»çº¿ç¨‹ï¼Œä»è€Œå®Œæˆ UI åˆ·æ–°ã€‚ åœ¨å¤šçº¿ç¨‹åº”ç”¨åœºæ™¯ä¸­ï¼Œå°†å·¥ä½œçº¿ç¨‹ä¸­éœ€æ›´æ–° UI çš„æ“ä½œä¿¡æ¯ä¼ é€’åˆ° UI ä¸»çº¿ç¨‹ï¼Œä»è€Œå®ç°å·¥ä½œçº¿ç¨‹å¯¹ UI çš„æ›´æ–°å¤„ç†ï¼Œæœ€ç»ˆå®ç°å¼‚æ­¥æ¶ˆæ¯çš„å¤„ç†ã€‚ Handler çš„ä¸»è¦æ–¹æ³• æ–¹æ³•åç§° è¯´æ˜ sendMessage() ç³»åˆ— å‘é€æ™®é€šæ¶ˆæ¯ã€å»¶è¿Ÿæ¶ˆæ¯ï¼Œæœ€ç»ˆè°ƒç”¨ queue.enqueueMessage() æ–¹æ³•å°†æ¶ˆæ¯å­˜å…¥æ¶ˆæ¯é˜Ÿåˆ—ã€‚ post() ç³»åˆ— æäº¤æ™®é€š/å»¶è¿Ÿ Runnableï¼Œéšåå°è£…æˆ Messageï¼Œè°ƒç”¨ sendMessage() æ–¹æ³•å°†æ¶ˆæ¯å­˜å…¥æ¶ˆæ¯é˜Ÿåˆ—ã€‚ dispatchMessage(Message msg) åˆ†å‘æ¶ˆæ¯ï¼Œä¼˜å…ˆæ‰§è¡Œ msg.callbackï¼ˆä¹Ÿå°±æ˜¯ runnableï¼‰ï¼Œå…¶æ¬¡è°ƒç”¨ handleMessage()ã€‚ é€šè¿‡è¿™äº›æ–¹æ³•ï¼ŒHandler å¯ä»¥åœ¨ä¸åŒçº¿ç¨‹ä¹‹é—´ä¼ é€’æ¶ˆæ¯å’Œæ“ä½œï¼Œå®ç°å¼‚æ­¥ä»»åŠ¡çš„å¤„ç†å’Œ UI æ›´æ–°ã€‚\nHandler ç¤ºä¾‹ ä¸åœ¨ä¸»çº¿ç¨‹ä¸­ç»˜åˆ¶UIçš„åŸå› ï¼›é¿å…ä¸åŒçº¿ç¨‹æ··ä¹±ã€‚\nUIçº¿ç¨‹ ï¼š ä¸»çº¿ç¨‹ã€‚\nä»¥ä¸‹æ˜¯ä¸€ä¸ªè¯¦ç»†çš„ Handler ç¤ºä¾‹ï¼Œæ¶µç›–äº†å¦‚ä½•åœ¨ Android ä¸­ä½¿ç”¨ Handler è¿›è¡Œçº¿ç¨‹é—´é€šä¿¡ï¼Œæ›´æ–° UI å…ƒç´ ï¼Œä»¥åŠå¤„ç†å»¶è¿Ÿä»»åŠ¡ç­‰ã€‚\nHandlerå®ç°ä¿¡æ¯å€’è®¡æ—¶60s 1. åˆ›å»º Handler é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦åœ¨ä¸»çº¿ç¨‹ä¸­åˆ›å»ºä¸€ä¸ª Handler å®ä¾‹ã€‚\npublic class MainActivity extends AppCompatActivity { private TextView textView; private Handler handler; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_main); textView = findViewById(R.id.textView); // åˆ›å»º Handler å®ä¾‹ï¼Œå¹¶é‡å†™ handleMessage æ–¹æ³• handler = new Handler(Looper.getMainLooper()) { @Override public void handleMessage(@NonNull Message msg) { super.handleMessage(msg); // å¤„ç†æ¶ˆæ¯ switch (msg.what) { case 1: textView.setText(\u0026#34;Message received: \u0026#34; + msg.obj); break; case 2: textView.setText(\u0026#34;Delayed message received: \u0026#34; + msg.obj); break; default: break; } } }; // å¯åŠ¨ä¸€ä¸ªåå°çº¿ç¨‹ new Thread(new Runnable() { @Override public void run() { // æ¨¡æ‹Ÿä¸€äº›è€—æ—¶æ“ä½œ try { Thread.sleep(2000); } catch (InterruptedException e) { e.printStackTrace(); } // å‘é€æ¶ˆæ¯åˆ°ä¸»çº¿ç¨‹ Message msg = handler.obtainMessage(1, \u0026#34;Hello from background thread\u0026#34;); handler.sendMessage(msg); // å‘é€å»¶è¿Ÿæ¶ˆæ¯ Message delayedMsg = handler.obtainMessage(2, \u0026#34;This message is delayed\u0026#34;); handler.sendMessageDelayed(delayedMsg, 3000); } }).start(); } } 2. å‘é€å’Œå¤„ç†æ¶ˆæ¯ åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼ŒHandler è¢«ç”¨æ¥åœ¨ä¸»çº¿ç¨‹ä¸­å¤„ç†æ¥è‡ªåå°çº¿ç¨‹çš„æ¶ˆæ¯ã€‚\nhandler.obtainMessage(int what, Object obj)ï¼šåˆ›å»ºä¸€ä¸ªæ¶ˆæ¯å®ä¾‹ã€‚ handler.sendMessage(Message msg)ï¼šç«‹å³å‘é€æ¶ˆæ¯ã€‚ handler.sendMessageDelayed(Message msg, long delayMillis)ï¼šå»¶è¿Ÿå‘é€æ¶ˆæ¯ã€‚ 3. ä½¿ç”¨ post() æ–¹æ³• é™¤äº†å‘é€æ¶ˆæ¯ï¼ŒHandler è¿˜å¯ä»¥ç›´æ¥æ‰§è¡Œ Runnable å¯¹è±¡ã€‚\n@Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_main); textView = findViewById(R.id.textView); handler = new Handler(Looper.getMainLooper()); // ä½¿ç”¨ post æ–¹æ³•åœ¨ä¸»çº¿ç¨‹ä¸­æ‰§è¡Œ Runnable handler.post(new Runnable() { @Override public void run() { textView.setText(\u0026#34;Runnable executed immediately\u0026#34;); } }); // ä½¿ç”¨ postDelayed æ–¹æ³•å»¶è¿Ÿæ‰§è¡Œ Runnable handler.postDelayed(new Runnable() { @Override public void run() { textView.setText(\u0026#34;Runnable executed after delay\u0026#34;); } }, 2000); } 4. ä½¿ç”¨ sendMessageAtTime() æ–¹æ³• å¯ä»¥æŒ‡å®šä¸€ä¸ªç»å¯¹æ—¶é—´æ¥å‘é€æ¶ˆæ¯ã€‚\n@Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_main); textView = findViewById(R.id.textView); handler = new Handler(Looper.getMainLooper()); // å‘é€å®šæ—¶æ¶ˆæ¯ long uptimeMillis = SystemClock.uptimeMillis() + 5000; // 5ç§’åæ‰§è¡Œ Message msg = handler.obtainMessage(3, \u0026#34;Message at specific time\u0026#34;); handler.sendMessageAtTime(msg, uptimeMillis); } 5. ä½¿ç”¨ removeCallbacksAndMessages() å¯ä»¥ç§»é™¤æ‰€æœ‰çš„å›è°ƒå’Œæ¶ˆæ¯ã€‚\n@Override protected void onDestroy() { super.onDestroy(); // ç§»é™¤ Handler ä¸­æ‰€æœ‰çš„å›è°ƒå’Œæ¶ˆæ¯ handler.removeCallbacksAndMessages(null); } æ€»ç»“ é€šè¿‡ Handlerï¼Œå¯ä»¥å®ç°ä»¥ä¸‹åŠŸèƒ½ï¼š\nçº¿ç¨‹é—´é€šä¿¡ï¼šä»å­çº¿ç¨‹å‘é€æ¶ˆæ¯åˆ°ä¸»çº¿ç¨‹ã€‚ UI æ›´æ–°ï¼šåœ¨ä¸»çº¿ç¨‹ä¸­æ›´æ–° UI å…ƒç´ ã€‚ å»¶è¿Ÿä»»åŠ¡ï¼šå»¶è¿Ÿæ‰§è¡Œä»»åŠ¡ã€‚ å®šæ—¶ä»»åŠ¡ï¼šåœ¨æŒ‡å®šæ—¶é—´ç‚¹æ‰§è¡Œä»»åŠ¡ã€‚ ç§»é™¤ä»»åŠ¡ï¼šæ¸…é™¤æœªæ‰§è¡Œçš„ä»»åŠ¡å’Œæ¶ˆæ¯ã€‚ è¿™äº›åŠŸèƒ½ä½¿å¾— Handler æˆä¸º Android å¼€å‘ä¸­å¤„ç†çº¿ç¨‹å’Œä»»åŠ¡è°ƒåº¦çš„å¼ºå¤§å·¥å…·ã€‚\nRetrofit ç®€ä»‹åŠå·¥ä½œæµç¨‹ 1. ä»€ä¹ˆæ˜¯ Retrofit Retrofit æ˜¯ä¸€ç§æµè¡Œçš„ç½‘ç»œè¯·æ±‚æ¡†æ¶ï¼Œå¯ä»¥ç†è§£ä¸º OkHttp çš„å¢å¼ºç‰ˆã€‚ åº•å±‚å°è£…äº† OkHttpï¼Œå®é™…æ˜¯ä¸€ä¸ª RESTful çš„ HTTP ç½‘ç»œè¯·æ±‚æ¡†æ¶çš„å°è£…ã€‚ Retrofit ä¸»è¦è´Ÿè´£ç½‘ç»œè¯·æ±‚æ¥å£çš„å°è£…ï¼Œè€Œç½‘ç»œè¯·æ±‚çš„å®é™…å·¥ä½œç”± OkHttp å®Œæˆã€‚ 2. å·¥ä½œæµç¨‹ App åº”ç”¨ç¨‹åº é€šè¿‡ Retrofit è¿›è¡Œç½‘ç»œè¯·æ±‚ã€‚ Retrofit æ¥å£å±‚å°è£…è¯·æ±‚å‚æ•°ã€Headerã€URL ç­‰ä¿¡æ¯ï¼Œç„¶åäº¤ç»™ OkHttp ç»§ç»­å®Œæˆè¯·æ±‚å·¥ä½œã€‚ æœåŠ¡ç«¯è¿”å›æ•°æ®åï¼ŒOkHttp å°†åŸå§‹æ•°æ®äº¤ç»™ Retrofitã€‚ Retrofit æ ¹æ®ç”¨æˆ·éœ€æ±‚è§£ææ•°æ®ã€‚ 3. æ€»ç»“ Retrofit ç®€åŒ–äº†ç½‘ç»œè¯·æ±‚çš„æ¥å£å®šä¹‰å’Œè°ƒç”¨ï¼Œå¢å¼ºäº† OkHttp çš„åŠŸèƒ½ã€‚ é«˜æ•ˆã€ç®€æ´åœ°å¤„ç†ç½‘ç»œè¯·æ±‚å’Œå“åº”æ•°æ®çš„è§£æã€‚ é€šè¿‡è¿™ä¸€æµç¨‹ï¼Œå¼€å‘è€…å¯ä»¥æ›´åŠ ä¾¿æ·ã€é«˜æ•ˆåœ°è¿›è¡Œç½‘ç»œè¯·æ±‚æ“ä½œã€‚\nRetrofitç½‘ç»œè¯·æ±‚: https://hotfix-service-prod.g.mi.com/quick-game/game/{id} å‚æ•°: id=109\nhttps://hotfix-service-prod.g.mi.com/quick-game/api/auth/sendCode å‚æ•°: phone\n110å®¤\nè¿™ä¸ªå›¾ç‰‡å±•ç¤ºäº†ä¸¤ä¸ªRetrofitç½‘ç»œè¯·æ±‚çš„URLå’Œå‚æ•°ä¿¡æ¯ã€‚ç¬¬ä¸€ä¸ªè¯·æ±‚URLåŒ…å«ä¸€ä¸ªIDå‚æ•°,ç¬¬äºŒä¸ªè¯·æ±‚URLåŒ…å«ä¸€ä¸ªphoneå‚æ•°ã€‚è¿™äº›ä¿¡æ¯å¯èƒ½æ˜¯ç”¨äºåœ¨Androidåº”ç”¨ç¨‹åºä¸­è®¿é—®ä¸€äº›æ¸¸æˆç›¸å…³çš„æœåŠ¡æ¥å£ã€‚\nRetrofit ç¤ºä¾‹ ä»¥ä¸‹æ˜¯ä¸€ä¸ªè¯¦ç»†çš„ Retrofit ç¤ºä¾‹ï¼Œå±•ç¤ºäº†å¦‚ä½•åœ¨ Android åº”ç”¨ä¸­ä½¿ç”¨ Retrofit è¿›è¡Œç½‘ç»œè¯·æ±‚ï¼ŒåŒ…æ‹¬æ¥å£å®šä¹‰ã€è¯·æ±‚å‚æ•°ã€å“åº”è§£æç­‰ã€‚\n1. æ·»åŠ ä¾èµ– é¦–å…ˆï¼Œåœ¨ä½ çš„ build.gradle æ–‡ä»¶ä¸­æ·»åŠ  Retrofit å’Œ OkHttp çš„ä¾èµ–ï¼š\ndependencies { implementation \u0026#39;com.squareup.retrofit2:retrofit:2.9.0\u0026#39; implementation \u0026#39;com.squareup.retrofit2:converter-gson:2.9.0\u0026#39; implementation \u0026#39;com.squareup.okhttp3:logging-interceptor:4.9.0\u0026#39; } 2. åˆ›å»ºæ•°æ®æ¨¡å‹ å‡è®¾æˆ‘ä»¬è¦è¯·æ±‚ä¸€ä¸ªç”¨æˆ·ä¿¡æ¯æ¥å£ï¼Œè¿”å›ä¸€ä¸ªç”¨æˆ·å¯¹è±¡ã€‚é¦–å…ˆå®šä¹‰ç”¨æˆ·æ•°æ®æ¨¡å‹ï¼š\npublic class User { private int id; private String name; private String email; // Getters and setters public int getId() { return id; } public void setId(int id) { this.id = id; } public String getName() { return name; } public void setName(String name) { this.name = name; } public String getEmail() { return email; } public void setEmail(String email) { this.email = email; } } 3. å®šä¹‰ API æ¥å£ ä½¿ç”¨ Retrofit çš„æ³¨è§£æ¥å®šä¹‰ API æ¥å£ï¼š\npublic interface ApiService { @GET(\u0026#34;users/{id}\u0026#34;) Call\u0026lt;User\u0026gt; getUserById(@Path(\u0026#34;id\u0026#34;) int id); @POST(\u0026#34;users\u0026#34;) Call\u0026lt;User\u0026gt; createUser(@Body User user); @PUT(\u0026#34;users/{id}\u0026#34;) Call\u0026lt;User\u0026gt; updateUser(@Path(\u0026#34;id\u0026#34;) int id, @Body User user); @DELETE(\u0026#34;users/{id}\u0026#34;) Call\u0026lt;Void\u0026gt; deleteUser(@Path(\u0026#34;id\u0026#34;) int id); } 4. åˆ›å»º Retrofit å®ä¾‹ åœ¨åº”ç”¨ä¸­åˆ›å»ºä¸€ä¸ª Retrofit å®ä¾‹ï¼Œå¹¶é…ç½® OkHttp å’Œ Gson è½¬æ¢å™¨ï¼š\nimport retrofit2.Retrofit; import retrofit2.converter.gson.GsonConverterFactory; import okhttp3.OkHttpClient; import okhttp3.logging.HttpLoggingInterceptor; public class RetrofitClient { private static final String BASE_URL = \u0026#34;https://api.example.com/\u0026#34;; private static Retrofit retrofit; public static Retrofit getRetrofitInstance() { if (retrofit == null) { HttpLoggingInterceptor logging = new HttpLoggingInterceptor(); logging.setLevel(HttpLoggingInterceptor.Level.BODY); OkHttpClient client = new OkHttpClient.Builder() .addInterceptor(logging) .build(); retrofit = new Retrofit.Builder() .baseUrl(BASE_URL) .client(client) .addConverterFactory(GsonConverterFactory.create()) .build(); } return retrofit; } } 5. ä½¿ç”¨ Retrofit è¿›è¡Œç½‘ç»œè¯·æ±‚ åœ¨ä½ çš„ Activity æˆ– Fragment ä¸­è°ƒç”¨ Retrofit æ¥å£ï¼š\npublic class MainActivity extends AppCompatActivity { private ApiService apiService; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_main); Retrofit retrofit = RetrofitClient.getRetrofitInstance(); apiService = retrofit.create(ApiService.class); getUserById(1); createUser(new User()); updateUser(1, new User()); deleteUser(1); } private void getUserById(int id) { Call\u0026lt;User\u0026gt; call = apiService.getUserById(id); call.enqueue(new Callback\u0026lt;User\u0026gt;() { @Override public void onResponse(Call\u0026lt;User\u0026gt; call, Response\u0026lt;User\u0026gt; response) { if (response.isSuccessful()) { User user = response.body(); // å¤„ç†ç”¨æˆ·å¯¹è±¡ } } @Override public void onFailure(Call\u0026lt;User\u0026gt; call, Throwable t) { t.printStackTrace(); } }); } private void createUser(User user) { user.setName(\u0026#34;John Doe\u0026#34;); user.setEmail(\u0026#34;john@example.com\u0026#34;); Call\u0026lt;User\u0026gt; call = apiService.createUser(user); call.enqueue(new Callback\u0026lt;User\u0026gt;() { @Override public void onResponse(Call\u0026lt;User\u0026gt; call, Response\u0026lt;User\u0026gt; response) { if (response.isSuccessful()) { User createdUser = response.body(); // å¤„ç†åˆ›å»ºçš„ç”¨æˆ·å¯¹è±¡ } } @Override public void onFailure(Call\u0026lt;User\u0026gt; call, Throwable t) { t.printStackTrace(); } }); } private void updateUser(int id, User user) { user.setName(\u0026#34;Jane Doe\u0026#34;); user.setEmail(\u0026#34;jane@example.com\u0026#34;); Call\u0026lt;User\u0026gt; call = apiService.updateUser(id, user); call.enqueue(new Callback\u0026lt;User\u0026gt;() { @Override public void onResponse(Call\u0026lt;User\u0026gt; call, Response\u0026lt;User\u0026gt; response) { if (response.isSuccessful()) { User updatedUser = response.body(); // å¤„ç†æ›´æ–°çš„ç”¨æˆ·å¯¹è±¡ } } @Override public void onFailure(Call\u0026lt;User\u0026gt; call, Throwable t) { t.printStackTrace(); } }); } private void deleteUser(int id) { Call\u0026lt;Void\u0026gt; call = apiService.deleteUser(id); call.enqueue(new Callback\u0026lt;Void\u0026gt;() { @Override public void onResponse(Call\u0026lt;Void\u0026gt; call, Response\u0026lt;Void\u0026gt; response) { if (response.isSuccessful()) { // å¤„ç†åˆ é™¤æˆåŠŸ } } @Override public void onFailure(Call\u0026lt;Void\u0026gt; call, Throwable t) { t.printStackTrace(); } }); } } package com.showguan.study_day09; import android.os.Bundle; import android.util.Log; import android.view.View; import android.widget.Button; import android.widget.TextView; import androidx.appcompat.app.AppCompatActivity; import com.google.gson.Gson; import com.showguan.study_day09.Bean.GameBean; import com.showguan.study_day09.Bean.HttpBean; import okhttp3.MediaType; import okhttp3.RequestBody; import retrofit2.Call; import retrofit2.Callback; import retrofit2.Response; public class RetrofitActivity extends AppCompatActivity { private static final String TAG = \u0026#34;RetrofitActivity\u0026#34;; private Gson mGson = new Gson(); private ApiServiceModule apiService; private TextView tvMsg; private Button btnSendId; private Button btnSendPhone; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_retrofit); tvMsg = findViewById(R.id.tv_msg); btnSendId = findViewById(R.id.btn_send_id); btnSendPhone = findViewById(R.id.btn_send_phone); btnSendId.setOnClickListener(v -\u0026gt; sendRequestById()); btnSendPhone.setOnClickListener(v -\u0026gt; sendRequestByPhone(\u0026#34;15610456605\u0026#34;)); } private void sendRequestById() { ApiServiceModule.getInstance().getGameService().queryGame(\u0026#34;109\u0026#34;).enqueue(new Callback\u0026lt;HttpBean\u0026lt;GameBean\u0026gt;\u0026gt;() { @Override public void onResponse(Call\u0026lt;HttpBean\u0026lt;GameBean\u0026gt;\u0026gt; call, Response\u0026lt;HttpBean\u0026lt;GameBean\u0026gt;\u0026gt; response) { if (response.isSuccessful() \u0026amp;\u0026amp; response.body() != null) { Log.i(TAG, \u0026#34;http success: \u0026#34; + response.body().getMsg()); Log.i(TAG, \u0026#34;result: \u0026#34; + mGson.toJson(response.body())); tvMsg.setText(\u0026#34;Result (ID): \u0026#34; + mGson.toJson(response.body())); } // else { // Log.i(TAG, \u0026#34;http failed: \u0026#34; + response.errorBody()); // tvMsg.setText(\u0026#34;Request failed (ID)\u0026#34;); // } } @Override public void onFailure(Call\u0026lt;HttpBean\u0026lt;GameBean\u0026gt;\u0026gt; call, Throwable t) { Log.i(TAG, \u0026#34;http failure\u0026#34;, t); tvMsg.setText(\u0026#34;Request failed (ID)\u0026#34;); } }); } private void sendRequestByPhone(String phone) { // ç¤ºä¾‹ï¼šåˆ›å»º RequestBody å¹¶å‘é€ POST è¯·æ±‚ RequestBody requestBody = RequestBody.create(MediaType.parse(\u0026#34;application/json\u0026#34;), \u0026#34;{\\\u0026#34;phone\\\u0026#34;:\\\u0026#34;\u0026#34; + phone + \u0026#34;\\\u0026#34;}\u0026#34;); ApiServiceModule.getInstance().getGameService().sendCode(requestBody).enqueue(new Callback\u0026lt;HttpBean\u0026lt;String\u0026gt;\u0026gt;() { @Override public void onResponse(Call\u0026lt;HttpBean\u0026lt;String\u0026gt;\u0026gt; call, Response\u0026lt;HttpBean\u0026lt;String\u0026gt;\u0026gt; response) { if (response.isSuccessful() \u0026amp;\u0026amp; response.body() != null) { Log.i(TAG, \u0026#34;http success: \u0026#34; + response.body().getMsg()); Log.i(TAG, \u0026#34;result: \u0026#34; + mGson.toJson(response.body())); tvMsg.setText(\u0026#34;Result (Phone): \u0026#34; + mGson.toJson(response.body())); } else { Log.i(TAG, \u0026#34;http failed: \u0026#34; + response.errorBody()); tvMsg.setText(\u0026#34;Request failed (Phone)\u0026#34;); } } @Override public void onFailure(Call\u0026lt;HttpBean\u0026lt;String\u0026gt;\u0026gt; call, Throwable t) { Log.i(TAG, \u0026#34;http failure\u0026#34;, t); tvMsg.setText(\u0026#34;Request failed (Phone)\u0026#34;); } }); } } æ€»ç»“ é€šè¿‡ä»¥ä¸Šç¤ºä¾‹ï¼Œæˆ‘ä»¬å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ Retrofit è¿›è¡Œç½‘ç»œè¯·æ±‚ï¼Œå¹¶å®ç°äº† GETã€POSTã€PUT å’Œ DELETE è¯·æ±‚ã€‚Retrofit çš„ä¼˜åŠ¿åœ¨äºç®€åŒ–äº†ç½‘ç»œè¯·æ±‚çš„æ¥å£å®šä¹‰å’Œè°ƒç”¨ï¼Œå¹¶ä¸”ä¸ OkHttp ç»“åˆä½¿ç”¨ï¼Œå¢å¼ºäº†åŠŸèƒ½å’Œçµæ´»æ€§ã€‚\næµç¨‹\nMMKV ä½¿ç”¨æµ‹è¯•URL\nç«æŸ´äºº\rhttps://hotfix-service-prod.g.mi.com/quick-game/game/search?search=%E7%81%AB%E6%9F%B4%E4%BA%BA\u0026amp;current=2 ä¸Šæ‹‰åˆ·æ–°ï¼š\nä½¿ç”¨RecyclerViewï¼Œ ä¸æ”¹å˜æ•°é‡ï¼Œ ä½†æ”¹å˜é¡ºåº\nä¸‹æ‹‰åŠ è½½ï¼Œé¦–å…ˆ\nIntent çº¿ç¨‹é€šä¿¡\nEventbus ç¬¬ä¸‰æ–¹åº“ï¼Œ æ¶ˆæ¯ä¼ é€’ï¼Œçº¿ç¨‹åˆ‡æ¢ï¼Œ æœ¬è¿›ç¨‹ï¼Œ å…¶ä¸­çº¿ç¨‹åˆ‡æ¢åŒæ ·ä½¿ç”¨äº†Handler\nHandler çº¿ç¨‹åˆ‡æ¢ï¼Œ åœ¨æœ¬è¿›ç¨‹ä¸­ä½¿ç”¨\n","permalink":"https://kennems.github.io/posts/tech/%E7%AC%AC%E4%B9%9D%E5%A4%A9%E7%AC%94%E8%AE%B0/","summary":"ç¬¬ä¹å¤©ç¬”è®° æƒé™ä¸ç½‘ç»œè¯·æ±‚è¯¾ç¨‹é¢„ä¹  1. æœ‰å“ªäº›æƒé™ï¼Œå…·ä½“æƒé™çš„ä»‹ç» æ™®é€šæƒé™ ç½‘ç»œæƒé™ï¼šå…è®¸è®¾å¤‡è®¿é—®ç½‘ç»œ \u0026lt;uses-permission android:name=\u0026#34;android.permission.INTERNET\u0026#34; /\u0026gt; è·å–ç½‘ç»œçš„çŠ¶æ€ï¼šå¦‚æ˜¯å¦æœ‰ç½‘ \u0026lt;uses-permission android:name=\u0026#34;android.permission.ACCESS_NETWORK_STATE\u0026#34; /\u0026gt; è¯»å–æ‰‹æœº","title":"è®­ç»ƒè¥ç¬¬ä¹å¤©ç¬”è®°"},{"content":"ç¬¬å…«å¤©ç¬”è®° è‡ªå®šä¹‰æ§ä»¶çš„å®ç° View ç»˜åˆ¶è¿‡ç¨‹ Activity å’Œ View çš„å…³ç³» Window ç±»ï¼šè´Ÿè´£åœ¨ Activity ä¸­å±•ç¤ºå†…å®¹ï¼ˆå…·ä½“å®ç°ä¸º PhoneWindow ç±»ï¼‰ DecorViewï¼šWindow åˆ›å»ºå‡ºæ ¹å¸ƒå±€ DecorViewï¼ˆç»§æ‰¿è‡ª FrameLayoutï¼‰ å•ä¸ª View çš„ç»˜åˆ¶æ­¥éª¤ ç³»ç»Ÿæ ¹æ®å¸ƒå±€æ ‘å®Œæˆç•Œé¢ç»˜åˆ¶ï¼Œå•ä¸ª View éœ€è¦ç»è¿‡ä¸‰ä¸ªæ­¥éª¤ï¼š\nè®¡ç®— View çš„å®½é«˜ï¼šmeasure è®¡ç®— View çš„ä½ç½®ï¼šlayout ç»˜åˆ¶ View çš„å†…å®¹ï¼šdraw å¸ƒå±€æ ‘é€çº§å‘ä¸‹è°ƒç”¨ å¸ƒå±€æ ‘çš„ç»˜åˆ¶è¿‡ç¨‹ä»ä¸Šåˆ°ä¸‹é€çº§è°ƒç”¨ï¼Œå…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š\næµ‹é‡ï¼š performMeasure() measure() onMeasure() å¸ƒå±€ï¼š performLayout() layout() onLayout() ç»˜åˆ¶ï¼š performDraw() draw() onDraw() è§†å›¾æ ‘è°ƒç”¨æµç¨‹å›¾ ä½ç½®çš„æè¿°ä¾èµ–åæ ‡ç³» Android çš„åæ ‡ç³»å®šä¹‰ä¸ºï¼š å±å¹•çš„å·¦ä¸Šè§’ä¸ºåæ ‡åŸç‚¹ å‘å³ä¸º x è½´å¢å¤§æ–¹å‘ å‘ä¸‹ä¸º y è½´å¢å¤§æ–¹å‘ è‡ªå®šä¹‰ View draw å‡½æ•° ä½œç”¨ï¼šç»˜åˆ¶å†…å®¹åœ¨ç»™å®šçš„ Canvas ä¸Š\nè°ƒç”¨æ—¶æœºï¼šè¦ä¿è¯ layout ä¹‹åå†è°ƒç”¨è¿™ä¸ªæ–¹æ³•\næ³¨æ„äº‹é¡¹ï¼šè‡ªå®šä¹‰ View æ—¶è€ƒè™‘ä¼˜å…ˆé‡å†™ onDraw æ–¹æ³•è€Œä¸æ˜¯è¿™ä¸ªæ–¹æ³•\nç»§æ‰¿å…³ç³»ï¼šå¦‚æœä¸€å®šè¦é‡å†™ draw æ–¹æ³•ï¼Œè¦è®°å¾—è°ƒç”¨çˆ¶ç±»æ–¹æ³•\nå®ç°æ­¥éª¤ï¼šæœ‰ 7 ä¸ªç»˜åˆ¶æ­¥éª¤ï¼š\nç»˜åˆ¶èƒŒæ™¯ å…¶ä½™æ­¥éª¤ä¾æ¬¡ç±»æ¨ ä½ç½®çš„æè¿°ä¾èµ–åæ ‡ç³» Android çš„åæ ‡ç³»å®šä¹‰ä¸ºï¼š å±å¹•çš„å·¦ä¸Šè§’ä¸ºåæ ‡åŸç‚¹ å‘å³ä¸º x è½´å¢å¤§æ–¹å‘ å‘ä¸‹ä¸º y è½´å¢å¤§æ–¹å‘ draw å‡½æ•° ä½œç”¨ï¼šç»˜åˆ¶å†…å®¹åœ¨ç»™å®šçš„ Canvas ä¸Šã€‚\nè°ƒç”¨æ—¶æœºï¼šè¦ä¿è¯ layout ä¹‹åå†è°ƒç”¨è¿™ä¸ªæ–¹æ³•ã€‚\næ³¨æ„äº‹é¡¹ï¼šè‡ªå®šä¹‰ View æ—¶è€ƒè™‘ä¼˜å…ˆé‡å†™ onDraw æ–¹æ³•è€Œä¸æ˜¯è¿™ä¸ªæ–¹æ³•ã€‚\nç»§æ‰¿å…³ç³»ï¼šå¦‚æœä¸€å®šè¦é‡å†™ draw æ–¹æ³•ï¼Œè¦è®°å¾—è°ƒç”¨çˆ¶ç±»æ–¹æ³•ã€‚\nå®ç°æ­¥éª¤ï¼šæœ‰ 7 ä¸ªç»˜åˆ¶æ­¥éª¤ï¼š\nç»˜åˆ¶èƒŒæ™¯ å¦‚æœ‰å¿…è¦ï¼Œä¿å­˜ç”»å¸ƒå›¾å±‚ä»¥å‡†å¤‡æ·¡å…¥æ·¡å‡ºåŠ¨ç”» ç»˜åˆ¶å†…å®¹ ç»˜åˆ¶å­ Viewï¼ˆå³è°ƒç”¨ childView.drawï¼‰ å¦‚æœ‰å¿…è¦ï¼Œç»˜åˆ¶æ·¡å…¥æ·¡å‡ºå¹¶æ¢å¤å›¾å±‚ ç»˜åˆ¶è£…é¥°ï¼ˆä¾‹å¦‚æ»šåŠ¨æ¡ï¼‰ å¦‚æœ‰å¿…è¦ï¼Œç»˜åˆ¶é»˜è®¤ç„¦ç‚¹é«˜äº® /** * Manually render this view (and all of its children) to the given Canvas. * The view must have already done a full layout before this function is * called. When implementing a view, implement * {@link #onDraw(android.graphics.Canvas)} instead of overriding this method. * If you do need to override this method, call the superclass version. * * @param canvas The Canvas to which the View is rendered. */ @CallSuper public void draw(Canvas canvas) { final int privateFlags = mPrivateFlags; mPrivateFlags = (privateFlags \u0026amp; ~PFLAG_DIRTY_MASK) | PFLAG_DRAWN; /* * Draw traversal performs several drawing steps which must be executed * in the appropriate order: * * 1. Draw the background * 2. If necessary, save the canvas\u0026#39; layers to prepare for fading * 3. Draw view\u0026#39;s content * 4. Draw children * 5. If necessary, draw the fading edges and restore layers * 6. Draw decorations (scrollbars for instance) * 7. If necessary, draw the default focus highlight */ } onDraw å‡½æ•° è°ƒç”¨æ—¶æœºï¼šåœ¨ 7 ä¸ªç»˜åˆ¶æ­¥éª¤ä¸­çš„ç¬¬ä¸‰æ­¥ã€‚ å®ç°ï¼šç»˜åˆ¶å†…å®¹ã€‚ protected void onDraw(Canvas canvas) { // Step 1, draw the background, if needed int saveCount; drawBackground(canvas); // skip step 2 \u0026amp; 5 if possible (common case) final int viewFlags = mViewFlags; boolean horizontalEdges = (viewFlags \u0026amp; FADING_EDGE_HORIZONTAL) != 0; boolean verticalEdges = (viewFlags \u0026amp; FADING_EDGE_VERTICAL) != 0; if (!verticalEdges \u0026amp;\u0026amp; !horizontalEdges) { // Step 3, draw the content onDraw(canvas); } } ç»˜åˆ¶å†…å®¹åœ¨ç»™å®šçš„ Canvas ä¸Š Canvas ç±»ï¼šAndroid ä¸­ç”¨äºç»˜åˆ¶å›¾å½¢çš„é‡è¦ç±»ã€‚å®ƒåŒ…å«äº†è®¸å¤šç»˜å›¾æ–¹æ³•ï¼Œä¸»è¦å¯ä»¥åˆ†ä¸ºä»¥ä¸‹å‡ ç±»ï¼š\nç»˜åˆ¶åŸºæœ¬çš„å‡ ä½•å½¢çŠ¶ï¼Œå¦‚çŸ©å½¢ã€åœ†å½¢ã€æ¤­åœ†ç­‰ ä½¿ç”¨è·¯å¾„ï¼ˆPathï¼‰å®šä¹‰å¤æ‚çš„å›¾å½¢ drawRect(RectF rect, Paint paint) drawPath(Path path, Paint paint) drawCircle(float cx, float cy, float radius, Paint paint) drawOval(RectF oval, Paint paint) ç”¨äºåœ¨ç”»å¸ƒä¸Šç»˜åˆ¶æ–‡æœ¬ ç»˜åˆ¶ä½å›¾å›¾åƒ drawText(String text, float x, float y, Paint paint) drawBitmap(Bitmap bitmap, float left, float top, Paint paint) è®¾ç½®ç»˜åˆ¶çš„é¢œè‰²å’Œæ ·å¼ drawColor(int color): è®¾ç½®ç»˜åˆ¶çš„é¢œè‰² drawPaint(Paint paint): è®¾ç½®ç»˜åˆ¶çš„æ ·å¼ å¯¹ç”»å¸ƒè¿›è¡Œå˜æ¢ translate(float dx, float dy): å¹³ç§»å˜æ¢ rotate(float degrees): æ—‹è½¬å˜æ¢ åœ¨ç”»å¸ƒä¸Šåˆ›å»ºå’Œæ“ä½œå›¾å±‚ï¼Œå®ç°å›¾å±‚æ•ˆæœ save(): ä¿å­˜å½“å‰ç”»å¸ƒçš„çŠ¶æ€ restore(): æ¢å¤ä¹‹å‰ä¿å­˜çš„ç”»å¸ƒçŠ¶æ€ Paint ç±»é…åˆæä¾›ç»˜åˆ¶å‚æ•° Paint paint = new Paint(); paint.setColor(Color.RED); // è®¾ç½®é¢œè‰² paint.setTextSize(24); // è®¾ç½®æ–‡å­—å¤§å° paint.setTypeface(Typeface.create(Typeface.DEFAULT, Typeface.BOLD)); // è®¾ç½®å­—ä½“æ ·å¼ paint.setStrokeWidth(2); // è®¾ç½®ç»˜åˆ¶çº¿æ¡å®½åº¦ paint.setAntiAlias(true); // å¯ç”¨æŠ—é”¯é½¿ Path ç±»é…åˆæè¿°å¤æ‚å›¾å½¢ Path path = new Path(); path.moveTo(x: 100, y: 200); // ä»å½“å‰ä½ç½®ç§»åŠ¨åˆ°æŒ‡å®šä½ç½®ï¼ˆä¸ç”»çº¿ï¼‰ path.lineTo(x: 100, y: 200); // ä»å‰ç‚¹ç»˜åˆ¶ä¸€æ¡çº¿åˆ°æŒ‡å®šç‚¹ RectF oval = new RectF(left: 100, top: 100, right: 300, bottom: 600); // ç»˜åˆ¶åœ†çº¿ path.arcTo(oval, startAngle: 100, sweepAngle: 180, forceMoveTo: true); // ç»˜åˆ¶å¼§çº¿ path.close(); // è¿æ¥å½“å‰ç‚¹å’Œèµ·å§‹ç‚¹ è‡ªå®šä¹‰ ViewGroup measure å‡½æ•° ä½œç”¨: è®¡ç®— View çš„å®½é«˜ è°ƒç”¨ onMeasure å®ŒæˆçœŸæ­£çš„è®¡ç®—å·¥ä½œï¼Œä¸”å­ç±»åº”è¯¥é‡å†™ onMeasure final ä¿®é¥°è¯¥æ–¹æ³•ï¼Œä¸å¯é‡å†™ public final void measure(int widthMeasureSpec, int heightMeasureSpec) { boolean optical = isLayoutModeOptical() != this; if (optical != isLayoutModeOptical(mParent)) { // ... ç›¸å…³ä»£ç  } } onMeasure å‡½æ•°\nä½œç”¨: è®¡ç®— View çš„å®½é«˜ï¼Œåº”ç”±å­ç±»é‡å†™ï¼Œä»¥æä¾›å¯¹å…¶å†…å®¹çš„å‡†ç¡®æœ‰æ•ˆçš„æµ‹é‡ã€‚ çº¦å®š: é‡å†™æ­¤æ–¹æ³•æ—¶ï¼Œå¿…é¡»è°ƒç”¨ setMeasuredDimension(width, height) æ¥å­˜å‚¨æµ‹é‡å¥½çš„å®½åº¦å’Œé«˜åº¦ã€‚ æ²¡æœ‰ final ä¿®é¥°ç¬¦ï¼Œå¯é‡å†™ protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) { setMeasuredDimension(getDefaultSize(getSuggestedMinimumWidth(), widthMeasureSpec), getDefaultSize(getSuggestedMinimumHeight(), heightMeasureSpec)); } MeasureSpec ç±» MeasureSpec åŒ…å«ä¸¤éƒ¨åˆ†ä¿¡æ¯ï¼š\nä½ 30 ä½ä¸º SpecSizeï¼Œå³å°ºå¯¸ é«˜ 2 ä½ä¸º SpecModeï¼Œå³æµ‹é‡æ¨¡å¼ @Override protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) { int widthSpecMode = MeasureSpec.getMode(widthMeasureSpec); int widthSpecSize = MeasureSpec.getSize(widthMeasureSpec); int heightSpecMode = MeasureSpec.getMode(heightMeasureSpec); int heightSpecSize = MeasureSpec.getSize(heightMeasureSpec); int newWidthSpec = MeasureSpec.makeMeasureSpec(1, MeasureSpec.AT_MOST); } MeasureSpec é«˜ 2 ä½ä¸º SpecModeï¼Œå³æµ‹é‡æ¨¡å¼ æµ‹é‡æ¨¡å¼ è¯´æ˜ UNSPECIFIED çˆ¶ View å¯¹å­ View çš„å¤§å°ä¸åšé™åˆ¶ EXACTLY çˆ¶ View è®¡ç®—å¥½äº†å­ View å…·ä½“çš„å®½é«˜ï¼Œå­ View çš„æœ€ç»ˆå¤§å°å°±æ˜¯ SpecSize æŒ‡å®šçš„å€¼ AT_MOST çˆ¶ View æŒ‡å®šäº†ä¸€ä¸ªå¯ç”¨å¤§å° SpecSizeï¼Œå­ View çš„å¤§å°ä¸èƒ½å¤§äºè¿™ä¸ªå€¼ onMeasure å‡½æ•°\nä½œç”¨: è®¡ç®— View çš„å®½é«˜ï¼Œåº”ç”±å­ç±»é‡å†™ï¼Œä»¥æä¾›å¯¹å…¶å†…å®¹çš„å‡†ç¡®æœ‰æ•ˆçš„æµ‹é‡ã€‚ çº¦å®š: é‡å†™æ­¤æ–¹æ³•æ—¶ï¼Œå¿…é¡»è°ƒç”¨ setMeasuredDimension(width, height) æ¥å­˜å‚¨æµ‹é‡å¥½çš„å®½åº¦å’Œé«˜åº¦ã€‚ æ²¡æœ‰ final ä¿®é¥°ç¬¦ï¼Œå¯é‡å†™ protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) { setMeasuredDimension(getDefaultSize(getSuggestedMinimumWidth(), widthMeasureSpec), getDefaultSize(getSuggestedMinimumHeight(), heightMeasureSpec)); } MeasureSpec ç±» MeasureSpec åŒ…å«ä¸¤éƒ¨åˆ†ä¿¡æ¯ï¼š\nä½ 30 ä½ä¸º SpecSizeï¼Œå³å°ºå¯¸ é«˜ 2 ä½ä¸º SpecModeï¼Œå³æµ‹é‡æ¨¡å¼ @Override protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) { int widthSpecMode = MeasureSpec.getMode(widthMeasureSpec); int widthSpecSize = MeasureSpec.getSize(widthMeasureSpec); int heightSpecMode = MeasureSpec.getMode(heightMeasureSpec); int heightSpecSize = MeasureSpec.getSize(heightMeasureSpec); int newWidthSpec = MeasureSpec.makeMeasureSpec(1, MeasureSpec.AT_MOST); } MeasureSpec é«˜ 2 ä½ä¸º SpecModeï¼Œå³æµ‹é‡æ¨¡å¼ æµ‹é‡æ¨¡å¼ è¯´æ˜ UNSPECIFIED çˆ¶ View å¯¹å­ View çš„å¤§å°ä¸åšé™åˆ¶ EXACTLY çˆ¶ View è®¡ç®—å¥½äº†å­ View å…·ä½“çš„å®½é«˜ï¼Œå­ View çš„æœ€ç»ˆå¤§å°å°±æ˜¯ SpecSize æŒ‡å®šçš„å€¼ AT_MOST çˆ¶ View æŒ‡å®šäº†ä¸€ä¸ªå¯ç”¨å¤§å° SpecSizeï¼Œå­ View çš„å¤§å°ä¸èƒ½å¤§äºè¿™ä¸ªå€¼ ViewGroup ä¸­ MeasureSpec è®¡ç®—å…¬å¼ å­ View çš„å¸ƒå±€å‚æ•°ï¼ˆé€šè¿‡ childView.getLayoutParams() è·å–ï¼‰ + çˆ¶ View çš„æµ‹é‡è¦æ±‚ = å­ View çš„ MeasureSpec\næµ‹é‡æ¨¡å¼ ç²¾ç¡®å€¼ MATCH_PARENT WRAP_CONTENT EXACTLY SpecSize: View Group SizeSpecMode: EXACTLY SpecSize: View Group SizeSpecMode: EXACTLY SpecSize: View Group SizeSpecMode: AT_MOST AT_MOST SpecSize: View Group SizeSpecMode: AT_MOST SpecSize: View Group SizeSpecMode: AT_MOST SpecSize: View Group SizeSpecMode: AT_MOST UNSPECIFIED SpecSize: 0SpecMode: UNSPECIFIED SpecSize: 0SpecMode: UNSPECIFIED SpecSize: 0SpecMode: UNSPECIFIED onMeasure å‡½æ•°å®ç° çˆ¶ View æµ‹é‡è¦æ±‚ï¼ˆMeasureSpecï¼‰ä½œä¸º onMeasure çš„å…¥å‚ä¼ å…¥ï¼šUNSPECIFIED, EXACTLY, AT_MOST å®ç°ï¼š æ ¹æ®å…¬å¼ï¼šå­ View å¸ƒå±€å‚æ•°ï¼ˆ+ çˆ¶ View æµ‹é‡è¦æ±‚ï¼‰= å­ View æµ‹é‡è¦æ±‚ å°†å­ View æµ‹é‡è¦æ±‚ä½œä¸ºå‚æ•°ï¼Œè°ƒç”¨å­ View çš„ measure æ–¹æ³• æ ¹æ®å½“å‰ ViewGroup å¸ƒå±€ç­–ç•¥è®¡ç®—è‡ªå·±çš„å®½é«˜ è°ƒç”¨ setMeasuredDimension(int, int) ä¿å­˜è®¡ç®—å¥½çš„å®½é«˜ layout å‡½æ•° å¸ƒå±€æœºåˆ¶çš„ç¬¬äºŒé˜¶æ®µï¼ˆç¬¬ä¸€é˜¶æ®µæ˜¯æµ‹é‡ï¼‰ ä½œç”¨: ç»™æ‰€æœ‰å­ View åˆ†é…ä½ç½® å®ç°: åœ¨è¿™ä¸ªé˜¶æ®µï¼Œæ¯ä¸ªçˆ¶ View è°ƒç”¨å…¶æ‰€æœ‰å­ View çš„ layout æ–¹æ³•æ¥ç¡®å®šå®ƒä»¬çš„ä½ç½®ã€‚ æ´¾ç”Ÿç±»ä¸åº”è¦†ç›–æ­¤æ–¹æ³•ï¼Œå­ View çš„æ´¾ç”Ÿç±»åº”è¦†ç›– onLayout æ–¹æ³•ã€‚ public void layout(int l, int t, int r, int b) { if ((mPrivateFlags \u0026amp; PFLAG3_MEASURE_NEEDED_BEFORE_LAYOUT) != 0) { onMeasure(mOldWidthMeasureSpec, mOldHeightMeasureSpec); mPrivateFlags3 \u0026amp;= ~PFLAG3_MEASURE_NEEDED_BEFORE_LAYOUT; } ... } onLayout å‡½æ•° è¢« layout æ–¹æ³•è°ƒç”¨ ä½œç”¨: ä¸ºè¯¥ View çš„å­ View åˆ†é…ä½ç½® æœ‰å­ View çš„æ´¾ç”Ÿç±»åº”é‡å†™è¯¥æ–¹æ³•ï¼Œå¹¶å¯¹æ¯ä¸ªå­ View è°ƒç”¨ layout æ–¹æ³•ï¼Œé€šå¸¸æ˜¯ä½¿ç”¨åœ¨æµ‹é‡è¿‡ç¨‹ä¸­å­˜å‚¨çš„å­ View å°ºå¯¸æ¥å®Œæˆçš„ã€‚ . onLayout æ–¹æ³• å®šä¹‰ï¼šåœ¨ layout è¢«è°ƒç”¨æ—¶ï¼Œåˆ†é…æ¯ä¸ªå­ View çš„ä½ç½®å’Œå°ºå¯¸ã€‚ å‚æ•°ï¼š changedï¼šæ­¤è§†å›¾çš„å°ºå¯¸æˆ–ä½ç½®æ˜¯å¦å‘ç”Ÿå˜åŒ–ã€‚ leftï¼šç›¸å¯¹äºçˆ¶è§†å›¾çš„å·¦è¾¹ä½ç½®ã€‚ topï¼šç›¸å¯¹äºçˆ¶è§†å›¾çš„é¡¶éƒ¨ä½ç½®ã€‚ rightï¼šç›¸å¯¹äºçˆ¶è§†å›¾çš„å³è¾¹ä½ç½®ã€‚ bottomï¼šç›¸å¯¹äºçˆ¶è§†å›¾çš„åº•éƒ¨ä½ç½®ã€‚ 2. ä½¿ç”¨åœ¨æµ‹é‡è¿‡ç¨‹ä¸­å­˜å‚¨çš„å­ View å°ºå¯¸æ¥å®Œæˆå¸ƒå±€ åœ¨ onLayout æ–¹æ³•ä¸­è°ƒç”¨å­è§†å›¾çš„ layout æ–¹æ³•ï¼Œä½¿ç”¨ getMeasuredWidth å’Œ getMeasuredHeight è·å–å­è§†å›¾çš„å®½åº¦å’Œé«˜åº¦ã€‚ 3. getMeasuredHeight å’Œ getHeight çš„åŒºåˆ« getMeasuredWidth / getMeasuredHeightï¼š ä½œç”¨ï¼šè·å– View æµ‹é‡çš„å®½é«˜ã€‚ èµ‹å€¼æ—¶æœºï¼šmeasure è¿‡ç¨‹ä¸­ã€‚ èµ‹å€¼æ–¹æ³•ï¼šsetMeasuredDimensionã€‚ å€¼å¤§å°ï¼šä¸€èˆ¬æƒ…å†µä¸‹äºŒè€…è·å–çš„å®½é«˜å€¼ç›¸ç­‰ã€‚ getWidth / getHeightï¼šgtcg ä½œç”¨ï¼šè·å– View æœ€ç»ˆçš„å®½é«˜ã€‚ èµ‹å€¼æ—¶æœºï¼šlayout è¿‡ç¨‹ä¸­ã€‚ èµ‹å€¼æ–¹æ³•ï¼šlayout ä¸­ä¼ é€’çš„ 4 ä¸ªå‚æ•°ä¹‹é—´çš„è¿ç®—ã€‚ 4. å¦‚ä½•å®šä¹‰æ ‡ç­¾é—´è·ï¼Ÿ è‡ªå®šä¹‰å±æ€§ï¼š\nåœ¨ res/values/ æ–°å»º attrs.xml æ–‡ä»¶ï¼Œå®šä¹‰æ ‡ç­¾é—´è·çš„å±æ€§ã€‚\nç¤ºä¾‹ä»£ç ï¼š\n\u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;resources\u0026gt; \u0026lt;declare-styleable name=\u0026#34;TagCloud\u0026#34;\u0026gt; \u0026lt;attr name=\u0026#34;hMargin\u0026#34; format=\u0026#34;dimension\u0026#34;/\u0026gt; \u0026lt;attr name=\u0026#34;vMargin\u0026#34; format=\u0026#34;dimension\u0026#34;/\u0026gt; \u0026lt;/declare-styleable\u0026gt; \u0026lt;/resources\u0026gt; 1. è‡ªå®šä¹‰å±æ€§ä¸æ ‡ç­¾é—´è· å®šä¹‰è‡ªå®šä¹‰å±æ€§ gravityï¼š\n\u0026lt;attr name=\u0026#34;gravity\u0026#34;\u0026gt; \u0026lt;flag name=\u0026#34;top\u0026#34; value=\u0026#34;0x30\u0026#34; /\u0026gt; \u0026lt;flag name=\u0026#34;bottom\u0026#34; value=\u0026#34;0x50\u0026#34; /\u0026gt; \u0026lt;flag name=\u0026#34;left\u0026#34; value=\u0026#34;0x03\u0026#34; /\u0026gt; \u0026lt;flag name=\u0026#34;right\u0026#34; value=\u0026#34;0x05\u0026#34; /\u0026gt; \u0026lt;flag name=\u0026#34;center_vertical\u0026#34; value=\u0026#34;0x10\u0026#34; /\u0026gt; \u0026lt;/attr\u0026gt; å®šä¹‰æ··åˆç±»å‹å±æ€§ backgroundï¼š\n\u0026lt;attr name=\u0026#34;background\u0026#34; format=\u0026#34;reference|color\u0026#34; /\u0026gt; 2. åœ¨ XML ä¸­ä½¿ç”¨å±æ€§ ç¤ºä¾‹ä»£ç ï¼š\n\u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;LinearLayout xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34; android:id=\u0026#34;@+id/parent\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34;\u0026gt; \u0026lt;com.xiaomi.customview.TagCloud xmlns:app=\u0026#34;http://schemas.android.com/apk/res-auto\u0026#34; android:id=\u0026#34;@+id/cloud\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34; app:hMargin=\u0026#34;40dp\u0026#34; app:vMargin=\u0026#34;20dp\u0026#34; /\u0026gt; \u0026lt;/LinearLayout\u0026gt; åœ¨ Java ä»£ç ä¸­è·å–å±æ€§ï¼š\npublic TagCloud(@NonNull Context context, @Nullable AttributeSet attrs) { super(context, attrs); TypedArray a = context.obtainStyledAttributes(attrs, R.styleable.TagCloud); horizontalMargin = a.getDimension(R.styleable.TagCloud_hMargin, 20); verticalMargin = a.getDimension(R.styleable.TagCloud_vMargin, 10); a.recycle(); } 3. å“åº”æ‰‹åŠ¿æ“ä½œ MotionEvent ç±»ï¼ˆè¿åŠ¨äº‹ä»¶ï¼‰åŒ…å«ï¼šACTIONï¼ˆäº‹ä»¶ç±»å‹ï¼‰+ äº‹ä»¶ä½ç½®\nonInterceptTouchEvent:\n**ç”¨é€”:**å½“å…ˆåˆ†å‘ç»™å­Viewå¤„ç†,ä¸”å­Viewçš„dispatchTouchEventè¿”å›true(å­Viewè¡¨ç¤ºä¼šæ¶ˆè´¹è¿™ä¸ªäº‹ä»¶),å½“å‰ViewGroupä¾ç„¶æœ‰æ•è·çš„èƒ½åŠ›\nåœºæ™¯:æ”¯æŒæ»‘åŠ¨çš„ViewGroupä¸­çš„å­Viewåšäº†äº‹ä»¶æ¶ˆè´¹,ç¬¬ä¸€ä¸ªäº‹ä»¶action_downå‘ç”Ÿåœ¨è¯¥å­ViewèŒƒå›´å†…,è¯¥å­Viewçš„dispatchTouchEventæ–¹æ³•è¿”å›true\nç¬¬äºŒä¸ªäº‹ä»¶æ˜¯action_move,æ­¤æ—¶å½“å‰ViewGroupåˆ¤æ–­ä¸ºæ»‘åŠ¨æ‰‹åŠ¿,ç”±è‡ªå·±å¼€å§‹æ¶ˆè´¹(onInterceptTouchEventè¿”å›trueæ§åˆ¶è¿™äº‹ä»¶),å¹¶ä¸”ç»™å­Viewåˆ†å‘action_canceläº‹ä»¶(å¸®åŠ©å­Viewç»“æŸæ­¤ç»„æ‰‹åŠ¿)\näº‹ä»¶ç±»å‹ï¼š\nACTION_DOWNï¼šæŒ‰ä¸‹ ACTION_POINTER_DOWNï¼šç¬¬ n ä¸ªæ‰‹æŒ‡æŒ‰ä¸‹ ACTION_MOVEï¼šç§»åŠ¨ ACTION_UPï¼šæŠ¬èµ· ACTION_POINTER_UPï¼šå¤šæŒ‡æŒ‰ä¸‹çš„å‰æä¸‹ï¼ŒæŠ¬èµ·ä¸€ä¸ªæ‰‹æŒ‡ ACTION_CANCELï¼šå–æ¶ˆ äº‹ä»¶ä½ç½®ï¼š\n(x, y) åæ ‡ ç¤ºä¾‹ä»£ç ï¼š\n@Override public boolean onTouchEvent(MotionEvent event) { switch (event.getAction()) { case MotionEvent.ACTION_DOWN: // å¤„ç†æŒ‰ä¸‹äº‹ä»¶ break; case MotionEvent.ACTION_MOVE: // å¤„ç†ç§»åŠ¨äº‹ä»¶ break; case MotionEvent.ACTION_UP: // å¤„ç†æŠ¬èµ·äº‹ä»¶ break; case MotionEvent.ACTION_CANCEL: // å¤„ç†å–æ¶ˆäº‹ä»¶ break; } return true; } ç”¨æˆ·çš„çœŸå®æœ‰æ„ä¹‰çš„æ‰‹åŠ¿æ˜¯ç”±å¤šä¸ª MotionEventï¼ˆè¿åŠ¨äº‹ä»¶ï¼‰ç»„åˆè€Œæˆ\nä¾‹å¦‚ï¼š\nç”¨æˆ·æ»‘åŠ¨æ‰‹åŠ¿ï¼š DOWNäº‹ä»¶ MOVEäº‹ä»¶ï¼ˆè‹¥å¹²ä¸ªï¼‰ UPäº‹ä»¶ è¿›å…¥å¦ä¸€ä¸ªè§†å›¾æ—¶çš„CANCELäº‹ä»¶ ç¤ºä¾‹æµç¨‹å›¾ï¼š\nrequirementDiagram\rrequirement test_req {\rid: 1\rtext: the test text.\rrisk: high\rverifymethod: test\r}\relement test_entity {\rtype: simulation\r}\rtest_entity - satisfies -\u0026gt; test_req GestureDetector ç±»åŠå…¶å›è°ƒæ–¹æ³• onDown(MotionEvent e): ç”¨æˆ·æŒ‰ä¸‹å±å¹•æ—¶è°ƒç”¨ï¼Œè¡¨ç¤ºå±å¹•å·²ç»è¢«è§¦æ‘¸ã€‚ è¿”å› falseã€‚ onShowPress(MotionEvent e): ç”¨æˆ·æŒ‰ä¸‹å±å¹•ä¸€æ®µæ—¶é—´åï¼Œä½†æœªå®Œæˆå…¶ä»–æ‰‹åŠ¿æ—¶è°ƒç”¨ã€‚ æ— è¿”å›å€¼ã€‚ onSingleTapUp(MotionEvent e): ç”¨æˆ·è½»è§¦å±å¹•æ—¶è°ƒç”¨ï¼Œä¸”æœªå‘ç”Ÿæ»‘åŠ¨æˆ–é•¿æŒ‰ã€‚ è¿”å› falseã€‚ onScroll(MotionEvent e1, MotionEvent e2, float distanceX, float distanceY): ç”¨æˆ·åœ¨å±å¹•ä¸Šæ»‘åŠ¨æ—¶è°ƒç”¨ï¼Œæä¾›èµ·å§‹äº‹ä»¶å’Œå½“å‰äº‹ä»¶ä¹‹é—´çš„æ»‘åŠ¨è·ç¦»ã€‚ è¿”å› falseã€‚ onLongPress(MotionEvent e): ç”¨æˆ·é•¿æŒ‰å±å¹•æ—¶è°ƒç”¨ï¼Œç”¨äºå¤„ç†é•¿æŒ‰äº‹ä»¶ã€‚ æ— è¿”å›å€¼ã€‚ onFling(MotionEvent e1, MotionEvent e2, float velocityX, float velocityY): ç”¨æˆ·å¿«é€Ÿæ»‘åŠ¨åæ¾å¼€æ—¶è°ƒç”¨ï¼Œæä¾›èµ·å§‹äº‹ä»¶ã€å½“å‰äº‹ä»¶ä»¥åŠæ»‘åŠ¨é€Ÿåº¦ã€‚ è¿”å› falseã€‚ MotionEvent äº‹ä»¶ç±»å‹ ACTION_UP: æŠ¬èµ· ACTION_POINTER_UP: å¤šæŒ‡æŒ‰ä¸‹çš„å‰æä¸‹ï¼ŒæŠ¬èµ·ä¸€ä¸ªæ‰‹æŒ‡ ACTION_CANCEL: å–æ¶ˆ äº‹ä»¶ä½ç½® äº‹ä»¶ä½ç½®ä¸º (x, y) åæ ‡ç³»ã€‚ æ‰‹åŠ¿çš„ç»„åˆ ç”¨æˆ·çš„çœŸå®æ‰‹åŠ¿æ˜¯ç”±å¤šä¸ª MotionEventï¼ˆè¿åŠ¨äº‹ä»¶ï¼‰ç»„åˆè€Œæˆã€‚ä¾‹å¦‚ï¼š\nDOWNäº‹ä»¶ -\u0026gt; MOVEäº‹ä»¶ -\u0026gt; UPäº‹ä»¶ -\u0026gt; CANCELäº‹ä»¶ å¸¸è§æ‰‹åŠ¿çš„äº‹ä»¶ç»„åˆ ç‚¹å‡»: down + up é•¿æŒ‰: downï¼ˆæŒç»­ä¸€æ®µæ—¶é—´æ²¡æœ‰ move å’Œ up äº‹ä»¶ï¼‰ æ»‘åŠ¨: down + move + up åŒå‡»: down + up + down + up åŒæŒ‡æ”¾å¤§/ç¼©å°: down + pointer_down + move + pointer_up + up é•¿æŒ‰æ‹–åŠ¨: down + move + upï¼ˆæ»¡è¶³è§¦å‘é•¿æŒ‰çš„é˜ˆå€¼ï¼‰ è¾¹ç¼˜æ»‘åŠ¨: down + move + upï¼ˆåŒºåˆ«åœ¨äºäº‹ä»¶ä½ç½®åœ¨è¾¹ç¼˜ï¼‰ GestureDetector ç±» ä½œç”¨: æä¾›å°è£…å¥½çš„æ‰‹åŠ¿åˆ¤æ–­ç»“æœã€‚ ä½¿ç”¨ onTouchEvent æ–¹æ³•æˆ– onTouchListener å¤„ç†æ‰‹åŠ¿ é€šè¿‡é‡å†™ onTouchEvent æ–¹æ³•æˆ–æ³¨å†Œ onTouchListenerï¼Œå¯ä»¥å°† MotionEvent äº¤ç»™ GestureDetector è¿›è¡Œå¤„ç†ã€‚\né‡å†™ onTouchEvent æ–¹æ³•: @Override public boolean onTouchEvent(MotionEvent event) { return mDetector.onTouchEvent(event); } æ³¨å†Œ onTouchListener: findViewById(R.id.parent).setOnTouchListener(new View.OnTouchListener() { @Override public boolean onTouch(View v, MotionEvent event) { return mDetector.onTouchEvent(event); } }); æ‰‹åŠ¿åˆ†å‘åŠå“åº”è¿‡ç¨‹ï¼šView å¤„ç†æµç¨‹ æµç¨‹å›¾: å¼€å§‹ â””â”€â”€ View.dispatchTouchEvent()ï¼ˆåˆ†å‘äº‹ä»¶ï¼‰ â”œâ”€â”€ æ˜¯å¦æ³¨å†Œäº†Touchäº‹ä»¶ç›‘å¬ â”‚ â”œâ”€â”€ trueï¼šView.onTouch() â”‚ â”‚ â”œâ”€â”€ trueï¼šäº‹ä»¶æ¶ˆè´¹ï¼Œä¸å†å‘ä¸‹åˆ†å‘ â”‚ â”‚ â””â”€â”€ falseï¼šäº‹ä»¶æ— æ³•æ¶ˆè´¹ï¼Œç»§ç»­å‘ä¸‹åˆ†å‘ â”‚ â””â”€â”€ falseï¼šonTouchEvent() â”‚ â”œâ”€â”€ æ˜¯å¦æ³¨å†Œäº†ç‚¹å‡»äº‹ä»¶ â”‚ â”‚ â”œâ”€â”€ trueï¼šperformClick() -\u0026gt; onClick() â”‚ â”‚ â””â”€â”€ falseï¼šäº‹ä»¶ç»“æŸ â””â”€â”€ ç»“æœ äº‹ä»¶å¤„ç†: å¦‚æœæˆ‘ä»¬è®¤ä¸ºä¸€ä¸ªæœ‰æ„ä¹‰çš„æ‰‹åŠ¿æ˜¯ç”± ACTION_DOWN å¼€å§‹çš„ä¸€ç»„ MotionEvent äº‹ä»¶ç»„æˆï¼Œæ‰€ä»¥å¦‚æœéœ€è¦å“åº”æ‰‹åŠ¿ï¼Œç¬¬ä¸€ä¸ª ACTION_DOWN å°±åº”è¯¥å¼€å§‹æ¶ˆè´¹ï¼Œå³ onTouch è¿”å› trueï¼ˆä¸”æ•´ä¸ªæ‰‹åŠ¿éƒ½åº”è¯¥æŒç»­è¿”å› trueï¼‰ã€‚å¦‚æœè¿”å› falseï¼Œé‚£ä¹ˆåç»­çˆ¶ View å°†ä¸ä¼šæŠŠè¯¥ç»„äº‹ä»¶åˆ†å‘åˆ°å½“å‰ Viewã€‚ æ‰‹åŠ¿åˆ†å‘åŠå“åº”è¿‡ç¨‹ï¼šViewGroup å¤„ç†æµç¨‹ æµç¨‹å›¾: å¼€å§‹ â””â”€â”€ ViewGroup.dispatchTouchEvent()ï¼ˆæ¥æ”¶ä¼ é€’çš„äº‹ä»¶ï¼‰ â”œâ”€â”€ ViewGroup.onInterceptTouchEvent()ï¼ˆæ‹¦æˆªäº‹ä»¶ï¼‰ â”‚ â”œâ”€â”€ trueï¼šä¸å…è®¸äº‹ä»¶ç»§ç»­å‘å­Viewä¼ é€’ â”‚ â”‚ â””â”€â”€ ViewGroupäº¤ç»™dispatchTouchEvent()ï¼ˆå³View.dispatchTouchEvent()ï¼‰ â”‚ â”‚ â”œâ”€â”€ è‡ªå·±å¤„ç†è¯¥äº‹ä»¶ -\u0026gt; onTouchEvent() -\u0026gt; performClick() -\u0026gt; onClick() â”‚ â””â”€â”€ falseï¼šå…è®¸äº‹ä»¶ç»§ç»­å‘å­Viewä¼ é€’ â”‚ â”œâ”€â”€ æ‰¾åˆ°è¢«ç‚¹å‡»çš„å­Viewï¼ˆéå†æ‰€æœ‰å­Viewï¼‰ â”‚ â”‚ â”œâ”€â”€ æ‰¾åˆ°è¢«ç‚¹å‡»çš„å­View â”‚ â”‚ â”‚ â””â”€â”€ è°ƒç”¨å­Viewçš„dispatchTouchEvent()ï¼ˆå®ç°äº†äº‹ä»¶ä¼ é€’ï¼šViewGroup -\u0026gt; Viewï¼‰ â”‚ â”‚ â””â”€â”€ æ‰¾ä¸åˆ°è¢«ç‚¹å‡»çš„å­Viewï¼ˆå¦‚ç‚¹å‡»äº†ç©ºç™½å¤„ï¼‰ â””â”€â”€ ç»“æœ äº‹ä»¶å¤„ç†: ViewGroup é€šè¿‡ dispatchTouchEvent() åˆ†å‘äº‹ä»¶ï¼Œäº‹ä»¶åˆ†å‘åˆ°å­ View æ—¶ï¼Œä¼šè°ƒç”¨ onInterceptTouchEvent() åˆ¤æ–­æ˜¯å¦æ‹¦æˆªäº‹ä»¶ã€‚ å¦‚æœæ‹¦æˆªäº‹ä»¶ï¼ŒViewGroup è‡ªå·±å¤„ç†äº‹ä»¶ï¼›å¦‚æœä¸æ‹¦æˆªï¼Œç»§ç»­å‘å­ View ä¼ é€’ï¼Œæ‰¾åˆ°è¢«ç‚¹å‡»çš„å­ View å¹¶è°ƒç”¨å…¶ dispatchTouchEvent() è¿›è¡Œäº‹ä»¶ä¼ é€’å’Œå¤„ç†ã€‚ onInterceptTouchEvent ä½œç”¨: å³ä½¿äº‹ä»¶æ˜¯æ— åˆ†å‘ç»™å­ View å¤„ç†ï¼Œä¸”å­ View çš„ dispatchTouchEvent è¿”å› trueï¼ˆå­ View è¡¨ç¤ºä¼šæ¶ˆè´¹è¿™ä¸ªäº‹ä»¶ï¼‰ï¼Œå½“å‰ ViewGroup ä¾ç„¶æœ‰æ‹¦æˆªçš„èƒ½åŠ›ã€‚ åœºæ™¯: æ”¯æŒè¯¥åŠŸèƒ½çš„ ViewGroup ä¸­çš„å­ View åšäº†äº‹ä»¶æ¶ˆè´¹ï¼Œç¬¬ä¸€ä¸ªäº‹ä»¶ action_down å‘ç”Ÿåœ¨è¯¥å­ View èŒƒå›´å†…ï¼Œè¯¥å­ View çš„ dispatchTouchEvent æ–¹æ³•è¿”å› trueã€‚ç¬¬äºŒä¸ªäº‹ä»¶æ˜¯ action_moveï¼Œæ­¤æ—¶å½“å‰ ViewGroup åˆ¤æ–­ä¸ºæ»‘åŠ¨æ‰‹åŠ¿ï¼Œç”±è‡ªå·±å¼€å§‹æ¶ˆè´¹ï¼ˆonInterceptTouchEvent è¿”å› true æ‹¦æˆªè¯¥äº‹ä»¶ï¼‰ï¼Œå¹¶ä¸”ç»™å­ View åˆ†å‘ action_cancel äº‹ä»¶ï¼ˆå¸®åŠ©å­ View ç»“æŸæ­¤ç»„æ‰‹åŠ¿å“åº”ï¼‰ã€‚ æ‰©å±•å†…å®¹ GestureDetector#OnDoubleTapListener\nä½œç”¨: æ£€æµ‹åŒå‡»æ‰‹åŠ¿ã€‚ ä½¿ç”¨: ä½¿ç”¨æ–¹å¼åŒ GestureDetectorã€‚ ScaleGestureDetector ç±»\nä½œç”¨: æ£€æµ‹åŒæŒ‡ç¼©æ”¾æ‰‹åŠ¿ã€‚ ä½¿ç”¨: ä½¿ç”¨æ–¹å¼åŒ GestureDetectorã€‚ ViewDragHelper / DragShadowBuilder ç±»\nç›¸åŒçš„ä½œç”¨: éƒ½æ˜¯å¸®åŠ©å®ç°æ‹–æ‹½é€»è¾‘çš„è¾…åŠ©ç±»ã€‚\nä¸åŒçš„èƒ½åŠ›å’Œåœºæ™¯:\nViewDragHelper DragShadowBuilder åœºæ™¯ é’ˆå¯¹ ViewGroup ä¸­æ‹–æ‹½å­ View çš„åœºæ™¯ é€‚ç”¨äºæ›´å¤šåœºæ™¯ï¼Œç”šè‡³æ”¯æŒè·¨è¿›ç¨‹æ‹–åŠ¨ä¼ é€’æ•°æ® ä½¿ç”¨éš¾æ˜“ ç®€å• å¤æ‚ è¯¾åé˜…è¯» Android å¼€å‘è€…æŒ‡å—: è‡ªå®šä¹‰è§†å›¾ç»„ä»¶ j\n","permalink":"https://kennems.github.io/posts/tech/%E7%AC%AC%E5%85%AB%E5%A4%A9%E7%AC%94%E8%AE%B0/","summary":"ç¬¬å…«å¤©ç¬”è®° è‡ªå®šä¹‰æ§ä»¶çš„å®ç° View ç»˜åˆ¶è¿‡ç¨‹ Activity å’Œ View çš„å…³ç³» Window ç±»ï¼šè´Ÿè´£åœ¨ Activity ä¸­å±•ç¤ºå†…å®¹ï¼ˆå…·ä½“å®ç°ä¸º PhoneWindow ç±»ï¼‰ DecorViewï¼šWindow åˆ›å»ºå‡ºæ ¹å¸ƒå±€ Dec","title":"è®­ç»ƒè¥ç¬¬å…«å¤©ç¬”è®°"},{"content":"ç¬¬ä¸ƒå¤©ç¬”è®° Android åŠ¨ç”» å¸§åŠ¨ç”» ä½œç”¨å¯¹è±¡ è§†å›¾æ§ä»¶ (View) ä¾‹å¦‚ Android çš„ TextViewã€Button ç­‰ç­‰ ä¸å¯ä½œç”¨äº View ç»„ä»¶çš„å±æ€§ï¼Œå¦‚ï¼šé¢œè‰²ã€èƒŒæ™¯ã€é•¿åº¦ç­‰ç­‰ ä½¿ç”¨ èµ„æºæ–‡ä»¶æ–¹å¼ ä»£ç æ–¹å¼ èµ„æºæ–‡ä»¶æ–¹å¼ åŸºæœ¬ä¿¡æ¯ä»‹ç» èµ„æºæ–‡ä»¶æ–¹å¼ä½¿ç”¨ï¼Œéœ€è¦å…ˆå®šä¹‰åŠ¨ç”»çš„ XML æ–‡ä»¶ï¼Œè¿™ç§åŠ¨ç”»çš„ XML æ–‡ä»¶ä¸€èˆ¬æ”¾åœ¨ res/drawable/ ç›®å½•ä¸‹ã€‚ç¤ºä¾‹ XML å†…å®¹ï¼š\n\u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;animation-list xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34; android:oneshot=\u0026#34;true\u0026#34;\u0026gt; \u0026lt;item android:drawable=\u0026#34;@drawable/run1\u0026#34; android:duration=\u0026#34;100\u0026#34;/\u0026gt; \u0026lt;item android:drawable=\u0026#34;@drawable/run2\u0026#34; android:duration=\u0026#34;100\u0026#34;/\u0026gt; \u0026lt;item android:drawable=\u0026#34;@drawable/run3\u0026#34; android:duration=\u0026#34;100\u0026#34;/\u0026gt; \u0026lt;item android:drawable=\u0026#34;@drawable/run4\u0026#34; android:duration=\u0026#34;100\u0026#34;/\u0026gt; \u0026lt;item android:drawable=\u0026#34;@drawable/run5\u0026#34; android:duration=\u0026#34;100\u0026#34;/\u0026gt; \u0026lt;item android:drawable=\u0026#34;@drawable/run6\u0026#34; android:duration=\u0026#34;100\u0026#34;/\u0026gt; \u0026lt;item android:drawable=\u0026#34;@drawable/run7\u0026#34; android:duration=\u0026#34;100\u0026#34;/\u0026gt; \u0026lt;/animation-list\u0026gt; ä½¿ç”¨ XML å±•ç¤ºåŠ¨ç”» æ–°å»º Activity å¸ƒå±€æ–‡ä»¶ï¼š\n\u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;FrameLayout xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34; xmlns:tools=\u0026#34;http://schemas.android.com/tools\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34; tools:context=\u0026#34;.frameanim.FrameAnimXmlSampleLetActivity\u0026#34;\u0026gt; \u0026lt;ImageView android:id=\u0026#34;@+id/iv_run_anim\u0026#34; android:layout_width=\u0026#34;90dp\u0026#34; android:layout_height=\u0026#34;160dp\u0026#34; android:layout_gravity=\u0026#34;center\u0026#34;/\u0026gt; \u0026lt;/FrameLayout\u0026gt; å¸§åŠ¨ç”» ä½œç”¨å¯¹è±¡ è§†å›¾æ§ä»¶ (View) ä¾‹å¦‚ Android çš„ TextViewã€Button ç­‰ç­‰ ä¸å¯ä½œç”¨äº View ç»„ä»¶çš„å±æ€§ï¼Œå¦‚ï¼šé¢œè‰²ã€èƒŒæ™¯ã€é•¿åº¦ç­‰ç­‰ ä½¿ç”¨ èµ„æºæ–‡ä»¶æ–¹å¼ ä»£ç æ–¹å¼ èµ„æºæ–‡ä»¶æ–¹å¼ åŸºæœ¬ä¿¡æ¯ä»‹ç» èµ„æºæ–‡ä»¶æ–¹å¼ä½¿ç”¨ï¼Œéœ€è¦å…ˆå®šä¹‰åŠ¨ç”»çš„ XML æ–‡ä»¶ï¼Œè¿™ç§åŠ¨ç”»çš„ XML æ–‡ä»¶ä¸€èˆ¬æ”¾åœ¨ res/drawable/ ç›®å½•ä¸‹ã€‚ç¤ºä¾‹ XML å†…å®¹ï¼š\n\u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;animation-list xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34; android:oneshot=\u0026#34;true\u0026#34;\u0026gt; \u0026lt;item android:drawable=\u0026#34;@drawable/run1\u0026#34; android:duration=\u0026#34;100\u0026#34;/\u0026gt; \u0026lt;item android:drawable=\u0026#34;@drawable/run2\u0026#34; android:duration=\u0026#34;100\u0026#34;/\u0026gt; \u0026lt;item android:drawable=\u0026#34;@drawable/run3\u0026#34; android:duration=\u0026#34;100\u0026#34;/\u0026gt; \u0026lt;item android:drawable=\u0026#34;@drawable/run4\u0026#34; android:duration=\u0026#34;100\u0026#34;/\u0026gt; \u0026lt;item android:drawable=\u0026#34;@drawable/run5\u0026#34; android:duration=\u0026#34;100\u0026#34;/\u0026gt; \u0026lt;item android:drawable=\u0026#34;@drawable/run6\u0026#34; android:duration=\u0026#34;100\u0026#34;/\u0026gt; \u0026lt;item android:drawable=\u0026#34;@drawable/run7\u0026#34; android:duration=\u0026#34;100\u0026#34;/\u0026gt; \u0026lt;/animation-list\u0026gt; ä½¿ç”¨ XML å±•ç¤ºåŠ¨ç”» æ–°å»º Activity å¸ƒå±€æ–‡ä»¶ï¼š\n\u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;FrameLayout xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34; xmlns:tools=\u0026#34;http://schemas.android.com/tools\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34; tools:context=\u0026#34;.frameanim.FrameAnimXmlSampleLetActivity\u0026#34;\u0026gt; \u0026lt;ImageView android:id=\u0026#34;@+id/iv_run_anim\u0026#34; android:layout_width=\u0026#34;90dp\u0026#34; android:layout_height=\u0026#34;160dp\u0026#34; android:layout_gravity=\u0026#34;center\u0026#34;/\u0026gt; \u0026lt;/FrameLayout\u0026gt; ä»£ç æ–¹å¼ åŸºç¡€ä¿¡æ¯ä»‹ç» åœ¨ä»£ç ä¸­ä½¿ç”¨æˆ‘ä»¬åˆšæ‰å®šä¹‰å¥½çš„åŠ¨ç”» XML æ–‡ä»¶ï¼š\npackage com.xiaomi.anim.animationsample.frameanim; import ... public class FrameAnimXmlSampleLetActivity extends AppCompatActivity { @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_frame_anim_xml_sample); ImageView runImageView = findViewById(R.id.iv_run_anim); runImageView.setImageResource(R.drawable.drawable_run_anim); AnimationDrawable animationDrawable = (AnimationDrawable) runImageView.getDrawable(); animationDrawable.start(); } } èµ„æºæ–‡ä»¶æ–¹å¼ åŸºæœ¬ä¿¡æ¯ä»‹ç» èµ„æºæ–‡ä»¶æ–¹å¼ä½¿ç”¨ï¼Œéœ€è¦å…ˆå®šä¹‰åŠ¨ç”»çš„ XML æ–‡ä»¶ï¼Œè¿™ç§åŠ¨ç”»çš„ XML æ–‡ä»¶ä¸€èˆ¬æ”¾åœ¨ res/drawable/ ç›®å½•ä¸‹ã€‚ç¤ºä¾‹ XML å†…å®¹ï¼š\n\u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;animation-list xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34; android:oneshot=\u0026#34;true\u0026#34;\u0026gt; \u0026lt;item android:drawable=\u0026#34;@drawable/run1\u0026#34; android:duration=\u0026#34;100\u0026#34;/\u0026gt; \u0026lt;item android:drawable=\u0026#34;@drawable/run2\u0026#34; android:duration=\u0026#34;100\u0026#34;/\u0026gt; \u0026lt;item android:drawable=\u0026#34;@drawable/run3\u0026#34; android:duration=\u0026#34;100\u0026#34;/\u0026gt; \u0026lt;item android:drawable=\u0026#34;@drawable/run4\u0026#34; android:duration=\u0026#34;100\u0026#34;/\u0026gt; \u0026lt;item android:drawable=\u0026#34;@drawable/run5\u0026#34; android:duration=\u0026#34;100\u0026#34;/\u0026gt; \u0026lt;item android:drawable=\u0026#34;@drawable/run6\u0026#34; android:duration=\u0026#34;100\u0026#34;/\u0026gt; \u0026lt;item android:drawable=\u0026#34;@drawable/run7\u0026#34; android:duration=\u0026#34;100\u0026#34;/\u0026gt; \u0026lt;/animation-list\u0026gt; ä½¿ç”¨ XML å±•ç¤ºåŠ¨ç”» æ–°å»º Activity å¸ƒå±€æ–‡ä»¶ï¼š\n\u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;FrameLayout xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34; xmlns:tools=\u0026#34;http://schemas.android.com/tools\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34; tools:context=\u0026#34;.frameanim.FrameAnimXmlSampleLetActivity\u0026#34;\u0026gt; \u0026lt;ImageView android:id=\u0026#34;@+id/iv_run_anim\u0026#34; android:layout_width=\u0026#34;90dp\u0026#34; android:layout_height=\u0026#34;160dp\u0026#34; android:layout_gravity=\u0026#34;center\u0026#34;/\u0026gt; \u0026lt;/FrameLayout\u0026gt; ä»£ç æ–¹å¼ åŸºç¡€ä¿¡æ¯ä»‹ç» åœ¨ä»£ç ä¸­ä½¿ç”¨æˆ‘ä»¬åˆšæ‰å®šä¹‰å¥½çš„åŠ¨ç”» XML æ–‡ä»¶ï¼š\npackage com.xiaomi.anim.animationsample.frameanim; import android.graphics.drawable.AnimationDrawable; import android.os.Bundle; import android.widget.ImageView; import androidx.appcompat.app.AppCompatActivity; import androidx.core.content.ContextCompat; public class FrameAnimCodeSampleActivity extends AppCompatActivity { @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_frame_anim_code_sample); ImageView runImageView = findViewById(R.id.iv_run_anim); AnimationDrawable animationDrawable = new AnimationDrawable(); animationDrawable.setOneShot(false); animationDrawable.addFrame(ContextCompat.getDrawable(this, R.drawable.run1), 100); animationDrawable.addFrame(ContextCompat.getDrawable(this, R.drawable.run2), 100); animationDrawable.addFrame(ContextCompat.getDrawable(this, R.drawable.run3), 100); animationDrawable.addFrame(ContextCompat.getDrawable(this, R.drawable.run4), 100); animationDrawable.addFrame(ContextCompat.getDrawable(this, R.drawable.run5), 100); animationDrawable.addFrame(ContextCompat.getDrawable(this, R.drawable.run6), 100); animationDrawable.addFrame(ContextCompat.getDrawable(this, R.drawable.run7), 100); runImageView.setImageDrawable(animationDrawable); animationDrawable.start(); } } è¡¥é—´åŠ¨ç”» åŠ¨ç”»ç±»å‹ å¹³ç§»åŠ¨ç”» (Translate) ç¼©æ”¾åŠ¨ç”» (Scale) æ—‹è½¬åŠ¨ç”» (Rotate) é€æ˜åº¦åŠ¨ç”» (Alpha) åŸºæœ¬ä½¿ç”¨ è¡¥é—´åŠ¨ç”»å¯ä»¥é€šè¿‡ XML æˆ– Android ä»£ç ä¸¤ç§æ–¹å¼ä½¿ç”¨ï¼Œä¸€èˆ¬æƒ…å†µå»ºè®®ä½¿ç”¨ XML æ–‡ä»¶å®šä¹‰ï¼Œå› ä¸ºå®ƒæ›´å…·å¯è¯»æ€§ã€å¯é‡ç”¨æ€§ã€‚XML æ”¾åœ¨ res/anim/ ç›®å½•ä¸‹ã€‚\nåŸºç¡€æ ‡ç­¾å’Œç±» XML æ ‡ç­¾ \u0026lt;translate\u0026gt; æ ‡ç­¾ï¼šè¡¨ç¤ºå¹³ç§»åŠ¨ç”» \u0026lt;scale\u0026gt; æ ‡ç­¾ï¼šè¡¨ç¤ºç¼©æ”¾åŠ¨ç”» \u0026lt;rotate\u0026gt; æ ‡ç­¾ï¼šè¡¨ç¤ºæ—‹è½¬åŠ¨ç”» \u0026lt;alpha\u0026gt; æ ‡ç­¾ï¼šè¡¨ç¤ºé€æ˜åº¦åŠ¨ç”» \u0026lt;set\u0026gt; æ ‡ç­¾ï¼šè¡¨ç¤ºç»„åˆåŠ¨ç”» åŠ¨ç”»æ•ˆæœ ä»å½“å‰ View å·¦ä¸Šè§’ç§»åŠ¨åˆ°å®½é«˜çš„ 50%ï¼ŒæŒç»­ 1000msã€‚\nXML æ–¹å¼å®ç° åœ¨ res/anim/ ç›®å½•ä¸‹åˆ›å»º anim_translate.xml æ–‡ä»¶ï¼š\n\u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;translate xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34; android:duration=\u0026#34;1000\u0026#34; android:fromXDelta=\u0026#34;0%\u0026#34; android:fromYDelta=\u0026#34;0%\u0026#34; android:toXDelta=\u0026#34;50%\u0026#34; android:toYDelta=\u0026#34;50%\u0026#34;\u0026gt; \u0026lt;/translate\u0026gt; åœ¨ Activity ä¸­ä½¿ç”¨ XML åŠ¨ç”» åœ¨ Activity ä¸­åŠ è½½å¹¶åº”ç”¨åŠ¨ç”»ï¼š\npackage com.xiaomi.anim.animationsample.tweenanim; import android.os.Bundle; import android.view.animation.Animation; import android.view.animation.AnimationUtils; import android.widget.ImageView; import androidx.appcompat.app.AppCompatActivity; public class TweenAnimTranslateXmlActivity extends AppCompatActivity { @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_tween_anim_translate_xml); ImageView robotImageView = findViewById(R.id.iv_robot); Animation animation = AnimationUtils.loadAnimation(this, R.anim.anim_translate); robotImageView.startAnimation(animation); } } ç¼©æ”¾åŠ¨ç”» (Scale) åŠ¨ç”»æ•ˆæœ åŸºäºå½“å‰ View ä¸­å¿ƒç‚¹æ‰©å¤§ 1.2 å€ï¼ŒæŒç»­ 1000msã€‚\nXML æ–¹å¼å®ç° åœ¨ res/anim/ ç›®å½•ä¸‹åˆ›å»º anim_scale.xml æ–‡ä»¶ï¼š\n\u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;scale xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34; android:duration=\u0026#34;1000\u0026#34; android:fromXScale=\u0026#34;1.0\u0026#34; android:fromYScale=\u0026#34;1.0\u0026#34; android:toXScale=\u0026#34;1.2\u0026#34; android:toYScale=\u0026#34;1.2\u0026#34; android:pivotX=\u0026#34;50%\u0026#34; android:pivotY=\u0026#34;50%\u0026#34;\u0026gt; \u0026lt;/scale\u0026gt; åœ¨ Activity ä¸­ä½¿ç”¨ XML åŠ¨ç”» åœ¨ Activity ä¸­åŠ è½½å¹¶åº”ç”¨åŠ¨ç”»ï¼š\npackage com.xiaomi.anim.animationsample.tweenanim; import android.os.Bundle; import android.view.animation.Animation; import android.view.animation.AnimationUtils; import android.widget.ImageView; import androidx.appcompat.app.AppCompatActivity; public class TweenAnimScaleXmlActivity extends AppCompatActivity { @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_tween_anim_scale_xml); ImageView robotImageView = findViewById(R.id.iv_robot); Animation animation = AnimationUtils.loadAnimation(this, R.anim.anim_scale); robotImageView.startAnimation(animation); } } ä»£ç æ–¹å¼å®ç° é€šè¿‡ä»£ç å®ç°ç¼©æ”¾åŠ¨ç”»ï¼š\npackage com.xiaomi.anim.animationsample.tweenanim; import android.os.Bundle; import android.view.animation.ScaleAnimation; import android.widget.ImageView; import androidx.appcompat.app.AppCompatActivity; public class TweenAnimScaleCodeActivity extends AppCompatActivity { @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_tween_anim_scale_code); ImageView robotImageView = findViewById(R.id.iv_robot); ScaleAnimation animation = new ScaleAnimation( 1f, 1.2f, // fromX, toX 1f, 1.2f, // fromY, toY Animation.RELATIVE_TO_SELF, 0.5f, // pivotX Animation.RELATIVE_TO_SELF, 0.5f // pivotY ); animation.setDuration(1000); robotImageView.startAnimation(animation); } } æ—‹è½¬åŠ¨ç”» (Rotate) åŠ¨ç”»æ•ˆæœ åŸºäºå½“å‰ View ä¸­å¿ƒç‚¹é¡ºæ—¶é’ˆæ—‹è½¬180åº¦ï¼ŒæŒç»­1000msã€‚\nXML æ–¹å¼å®ç° åœ¨ res/anim/ ç›®å½•ä¸‹åˆ›å»º anim_rotation.xml æ–‡ä»¶ï¼š\n\u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;rotate xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34; android:duration=\u0026#34;1000\u0026#34; android:fromDegrees=\u0026#34;0\u0026#34; android:toDegrees=\u0026#34;180\u0026#34; android:pivotX=\u0026#34;50%\u0026#34; android:pivotY=\u0026#34;50%\u0026#34;\u0026gt; \u0026lt;/rotate\u0026gt; åœ¨ Activity ä¸­ä½¿ç”¨ XML åŠ¨ç”» åœ¨ Activity ä¸­åŠ è½½å¹¶åº”ç”¨åŠ¨ç”»ï¼š\npackage com.xiaomi.anim.animationsample.tweenanim; import android.os.Bundle; import android.view.animation.Animation; import android.view.animation.AnimationUtils; import android.widget.ImageView; import androidx.appcompat.app.AppCompatActivity; public class TweenAnimRotationXmlActivity extends AppCompatActivity { @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_tween_anim_rotation_xml); ImageView robotImageView = findViewById(R.id.iv_robot); Animation animation = AnimationUtils.loadAnimation(this, R.anim.anim_rotation); robotImageView.startAnimation(animation); } } é€æ˜åº¦åŠ¨ç”» (Alpha) åŠ¨ç”»æ•ˆæœ å½“å‰ View ä»ä¸é€æ˜å˜ä¸ºé€æ˜ï¼ŒæŒç»­1000msã€‚\nXML æ–¹å¼å®ç° åœ¨ res/anim/ ç›®å½•ä¸‹åˆ›å»º anim_alpha.xml æ–‡ä»¶ï¼š\n\u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;alpha xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34; android:duration=\u0026#34;@integer/anim_1000\u0026#34; android:fromAlpha=\u0026#34;1\u0026#34; android:toAlpha=\u0026#34;0\u0026#34;\u0026gt; \u0026lt;/alpha\u0026gt; åœ¨ Activity ä¸­ä½¿ç”¨ XML åŠ¨ç”» åœ¨ Activity ä¸­åŠ è½½å¹¶åº”ç”¨é€æ˜åº¦åŠ¨ç”»ï¼š\npackage com.xiaomi.anim.animationsample.tweenanim; import android.os.Bundle; import android.view.animation.Animation; import android.view.animation.AnimationUtils; import android.widget.ImageView; import androidx.appcompat.app.AppCompatActivity; public class TweenAnimAlphaXmlActivity extends AppCompatActivity { @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_tween_anim_alpha_xml); ImageView robotImageView = findViewById(R.id.iv_robot); Animation animation = AnimationUtils.loadAnimation(this, R.anim.anim_alpha); robotImageView.startAnimation(animation); } } 1. åŠ¨ç”»çš„ XML å®ç°æ–¹å¼ ä»£ç ç¤ºä¾‹\npublic class TweenAnimSetXmlActivity extends AppCompatActivity { @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_tween_anim_set_xml); ImageView robotImageView = findViewById(R.id.iv_robot); Animation animation = AnimationUtils.loadAnimation(this, R.anim.anim_set); robotImageView.startAnimation(animation); } } 2. åŠ¨ç”»çš„ä»£ç å®ç°æ–¹å¼ ä»£ç ç¤ºä¾‹\npublic class TweenAnimSetCodeActivity extends AppCompatActivity { @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_tween_anim_set_code); ImageView robotImageView = findViewById(R.id.iv_robot); AnimationSet animationSet = new AnimationSet(true); ScaleAnimation scaleAnimation = new ScaleAnimation(1f, 1.2f, 1f, 1.2f, Animation.RELATIVE_TO_SELF, 0.5f, Animation.RELATIVE_TO_SELF, 0.5f); RotateAnimation rotateAnimation = new RotateAnimation(0f, 180f, Animation.RELATIVE_TO_SELF, 0.5f, Animation.RELATIVE_TO_SELF, 0.5f); AlphaAnimation alphaAnimation = new AlphaAnimation(1f, 0f); animationSet.addAnimation(scaleAnimation); animationSet.addAnimation(rotateAnimation); animationSet.addAnimation(alphaAnimation); animationSet.setDuration(1000); robotImageView.startAnimation(animationSet); } } 3. åŠ¨ç”»ç›‘å¬ æ¦‚è¿°\nAnimation ç±»å¯ä»¥é€šè¿‡è®¾ç½®åŠ¨ç”»ç›‘å¬å™¨æ¥ç›‘å¬åŠ¨ç”»çš„å¼€å§‹ã€ç»“æŸå’Œé‡å¤æ—¶åˆ»ï¼Œä»¥æ‰§è¡Œä¸€ç³»åˆ—æ“ä½œã€‚ ä»£ç ç¤ºä¾‹\nanimation.setAnimationListener(new Animation.AnimationListener() { @Override public void onAnimationStart(Animation animation) { // åŠ¨ç”»å¼€å§‹æ—¶å›è°ƒ } @Override public void onAnimationEnd(Animation animation) { // åŠ¨ç”»ç»“æŸæ—¶å›è°ƒ } @Override public void onAnimationRepeat(Animation animation) { // åŠ¨ç”»é‡å¤æ‰§è¡Œæ—¶å›è°ƒ } }); å±æ€§åŠ¨ç”» ä½œä¸šï¼Œ è¯¾å ‚è¡¨ç°ï¼Œ å¤§ä½œä¸šé¡¹ç›®ã€‚\nç°åœ¨å¼€å¤´è¿˜ç®—ä¸­ç­‰ï¼Œ åšæŒä¸‹å»æœ‰æœºä¼šã€‚\nè‡ªå®šä¹‰Interpolator è‡ªå®šä¹‰View ","permalink":"https://kennems.github.io/posts/tech/%E7%AC%AC%E4%B8%83%E5%A4%A9%E7%AC%94%E8%AE%B0/","summary":"ç¬¬ä¸ƒå¤©ç¬”è®° Android åŠ¨ç”» å¸§åŠ¨ç”» ä½œç”¨å¯¹è±¡ è§†å›¾æ§ä»¶ (View) ä¾‹å¦‚ Android çš„ TextViewã€Button ç­‰ç­‰ ä¸å¯ä½œç”¨äº View ç»„ä»¶çš„å±æ€§ï¼Œå¦‚ï¼šé¢œè‰²ã€èƒŒæ™¯ã€é•¿åº¦ç­‰ç­‰ ä½¿ç”¨ èµ„æºæ–‡","title":"è®­ç»ƒè¥ç¬¬ä¸ƒå¤©ç¬”è®°"},{"content":"ç¬¬å…­å¤©ç¬”è®° ç»„ä»¶åº“ç¬”è®° 1. ç»„ä»¶åº“ä¾èµ–ã€å‘å¸ƒå’Œä½¿ç”¨ ä¾èµ–æ–¹å¼å¯¹æ¯” 2.xç‰ˆæœ¬ 3.xç‰ˆæœ¬ è¯´æ˜ apk runtimeOnly apk åŠŸèƒ½åŒ runtimeOnlyã€‚åªåœ¨ç”Ÿæˆ apk æ—¶å‚ä¸æ‰“åŒ…ï¼Œç¼–è¯‘æ—¶ä¸ä¼šå‚ä¸ã€‚Gradle åªä¼šå°†ä¾èµ–é¡¹æ·»åŠ åˆ°æ„å»ºè¾“å‡ºï¼Œä»¥ä¾¿åœ¨è¿è¡Œæ—¶ä½¿ç”¨ã€‚ provided compileOnly provided åŠŸèƒ½åŒ compileOnlyã€‚åªåœ¨ç¼–è¯‘æ—¶æœ‰æ•ˆï¼Œä¸ä¼šå‚ä¸æ‰“åŒ…è‡³ apkã€‚ compile api compile åŠŸèƒ½åŒ apiã€‚è¯¥ä¾èµ–æ–¹å¼ä¼šä¼ é€’æ‰€ä¾èµ–çš„åº“ï¼Œå½“å…¶ä»– module ä¾èµ–äº†è¯¥ module æ—¶ï¼Œå¯ä»¥ä½¿ç”¨è¯¥ module ä¸‹ä½¿ç”¨ api ä¾èµ–çš„åº“ã€‚ - implementation è¯¥ä¾èµ–æ–¹å¼æ‰€ä¾èµ–çš„åº“ä¸ä¼šä¼ é€’ï¼Œåªä¼šåœ¨å½“å‰ module ä¸­ç”Ÿæ•ˆã€‚ æ ¼å¼ä»‹ç» æ ¼å¼ ä»‹ç» å·®å¼‚ AAR AAR æ–‡ä»¶åŒ…å«äº† Android åº“é¡¹ç›®çš„ä»£ç ã€èµ„æºæ–‡ä»¶å’Œæ¸…å•æ–‡ä»¶ç­‰ä¿¡æ¯ï¼Œå¯ä»¥è¢«å…¶ä»– Android åº”ç”¨ç¨‹åºå¼•ç”¨å’Œä½¿ç”¨ã€‚ Android ç‰¹æœ‰çš„å½’æ¡£æ–‡ä»¶æ ¼å¼ï¼Œä¸»è¦ç”¨äºæ‰“åŒ… Android åº“é¡¹ç›®ã€‚ JAR JAR æ–‡ä»¶åŒ…å«äº† Java ç±»æ–‡ä»¶ã€èµ„æºæ–‡ä»¶å’Œæ¸…å•æ–‡ä»¶ç­‰ä¿¡æ¯ï¼Œå¯ä»¥è¢«å…¶ä»– Java åº”ç”¨ç¨‹åºå¼•ç”¨å’Œä½¿ç”¨ã€‚ Java ä¸­å¸¸ç”¨çš„å½’æ¡£æ–‡ä»¶æ ¼å¼ï¼Œç”¨äºæ‰“åŒ… Java ç±»åº“å’Œåº”ç”¨ç¨‹åºã€‚ ä¾èµ–æ·»åŠ æ–¹å¼ æœ¬åœ°ä¾èµ–\nå°† Jar æ–‡ä»¶æ”¾ç½®åœ¨é¡¹ç›®çš„ libs ç›®å½•ä¸‹ï¼Œå¹¶åœ¨é¡¹ç›®çš„ build.gradle æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹ä¾èµ–ï¼š\ndependencies { implementation files(\u0026#39;libs/library_name.jar\u0026#39;) } å…¶ä¸­ï¼Œlibrary_name.jar æ˜¯ Jar æ–‡ä»¶çš„åç§°ã€‚\nä»“åº“ä¾èµ–\nJar æ–‡ä»¶å‘å¸ƒåˆ° Maven ä»“åº“æˆ– JCenter ç­‰å…¬å…±ä»“åº“ä¸­ï¼Œå¹¶åœ¨é¡¹ç›®çš„ build.gradle æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹ä¾èµ–ï¼š\ndependencies { implementation \u0026#39;group_id:artifact_id:version\u0026#39; } å…¶ä¸­ï¼Œgroup_id æ˜¯ Jar æ–‡ä»¶æ‰€å±çš„ç»„ç»‡æˆ–å…¬å¸çš„ IDï¼Œartifact_id æ˜¯ Jar æ–‡ä»¶çš„åç§°ï¼Œversion æ˜¯ Jar æ–‡ä»¶çš„ç‰ˆæœ¬å·ã€‚\nMaven ä»“åº“åœ°å€: https://repo.maven.apache.org/maven2/ JCenter ä»“åº“: https://jcenter.bintray.com/ 3. è‡ªå®šä¹‰ä»“åº“ a. é…ç½® mavenDeployer { // æœ¬åœ° maven ä»“åº“çš„è·¯å¾„ repository(url: uri(\u0026#34;$rootDir/maven\u0026#34;)) // ç”Ÿæˆ maven ä¾èµ–çš„ç»„å pom.groupId = \u0026#39;com.xiaomi.lib\u0026#39; // ç”Ÿæˆ maven ä¾èµ–çš„æ¨¡å—åç§° pom.artifactId = \u0026#39;image\u0026#39; // ç”Ÿæˆ maven ä¾èµ–çš„ç‰ˆæœ¬å· pom.version = \u0026#39;1.0.0\u0026#39; } b. å‘å¸ƒ åœ¨ Android Studio ä¸­ Gradle é¢æ¿å·¥ç¨‹çš„æ ¹ç›®å½•æ‰¾åˆ°åŠŸèƒ½èœå•:\nCircleImageLib -\u0026gt; Task -\u0026gt; upload -\u0026gt; uploadArchives åŒå‡» uploadArchives å¼€å§‹æ‰“åŒ…å‘å¸ƒæˆ–åœ¨ Terminal å‘½ä»¤è¡Œä¸­æ‰§è¡Œ:\n./gradlew uploadArchives c. å¼•ç”¨ åœ¨å·¥ç¨‹æ ¹ç›®å½•çš„ä¸­çš„\nrepositories ä¸­æ·»åŠ ä»“åº“åœ°å€:\nmaven { url uri(\u0026#34;$rootDir/maven\u0026#34;) } åœ¨ App Module ç›®å½•çš„ build.gradle ä¸­æ·»åŠ ä¾èµ–ã€‚\n2. åŸºç¡€ç»„ä»¶åº“ 2.1 å›¾ç‰‡åº“ å›¾ç‰‡åº“ Glide ç»„ä»¶æºç åœ°å€: https://github.com/bumptech/glide Glide Transformations æºç åœ°å€: https://github.com/wasabeef/glide-transformations Glide å›¾ç‰‡åŸç† æ›´å¤šç»„ä»¶ Glide å›¾ç‰‡åŠ è½½ç¼“å­˜æœºåˆ¶ 2.2 äº‹ä»¶ä¼ é€’åº“ a. EventBus é›†æˆä½¿ç”¨ é¡¹ç›®åœ°å€: https://github.com/greenrobot/EventBus\nä¾èµ–é›†æˆ:\nimplementation(\u0026#34;org.greenrobot:eventbus:3.3.1\u0026#34;) b. EventBusåŸç† 2.3 é€‚é…å™¨ç»„ä»¶åº“ a. BaseRecyclerViewAdapterHelperä½¿ç”¨ é¡¹ç›®åœ°å€: https://github.com/CymChad/BaseRecyclerViewAdapterHelper\nä¾èµ–é›†æˆ:\nimplementation \u0026#34;io.github.cymchad:BaseRecyclerViewAdapterHelper:2.9.50\u0026#34; é¡¹ç›®æ ¹ç›®å½•çš„ä¸­æ·»åŠ :\nmaven { url \u0026#34;https://jitpack.io\u0026#34; } b. BaseRecyclerViewAdapterHelperåŸºæœ¬åŸç† 2.4 åˆ·æ–°åº“ SwipeRefreshLayoutç»„ä»¶ä½¿ç”¨ æºç åœ°å€: https://developer.android.google.cn/reference/androidx/swiperefreshlayout/widget/SwipeRefreshLayout PullToRefreshç»„ä»¶åŸç†è§£æ 2.5 æ›´å¤šç»„ä»¶åº“ UIç»„ä»¶ æè¿° UIç»„ä»¶ æè¿° SmartRefreshLayout æ”¯æŒä¸‹æ‹‰åˆ·æ–°ã€ä¸Šæ‹‰åŠ è½½ BaseRecyclerViewAdapterHelper çµæ´»çš„RecyclerAdapter TwinklingRefreshLayout æ”¯æŒä¸‹æ‹‰åˆ·æ–°å’Œä¸Šæ‹‰åŠ è½½ Android-PickerView é€‰æ‹©å™¨ SwipeBackLayout æ”¯æŒæ‰‹æ»‘æ»‘åŠ¨è¿”å› TitleBar æ ‡é¢˜æ æ¡†æ¶ CoordinatorTabLayout é…åˆTabLayoutæŠ˜å æ§ä»¶ ToastUtils å„ç§èšé›†æ‚é¡¹ FlowLayout Android Androidæµå¼å¸ƒå±€ Toasty è‡ªå®šä¹‰Toaståº“ ShimmerRecyclerView æ•°æ®åŠ è½½é—ªçƒæ•ˆæœ banner è½®æ’­å›¾ åŠ¨ç”» åŠ¨ç”»åº“ æè¿° lottie jsonåŠ¨ç”»åº“ AVLoadingIndicatorView loadåŠ¨ç”»åº“ æ•°æ®åº“ æ•°æ®åº“åº“ æè¿° greendao å°†å¯¹è±¡æ˜ å°„çš„SQLiteçš„ORMè§£å†³æ–¹æ¡ˆåº“ litepal å¯¹è±¡å…³ç³»æ˜ å°„ (ORM) æ¨¡å‹ afinal å¼€æºçš„androidçš„Ormå’ŒIocåº”ç”¨å¼€å‘æ¡†æ¶ï¼Œå°å·§çµæ´»ï¼Œä»£ç ä¼˜é›… objectbox åŸºäºIoTä¸ºåµŒå…¥å’Œç§»åŠ¨è®¾å¤‡æ‰“é€ å‡ºçš„éå¸¸å¿«é€Ÿçš„é¢å‘å¯¹è±¡çš„æ•°æ®åº“åº“ Room Googleæ¨å‡ºçš„å®˜æ–¹æ•°æ®åº“æ¡†æ¶ realm ç§»åŠ¨ç«¯æ•°æ®åº“ï¼Œæ›¿ä»£SQLite \u0026amp; ORMs äº‹ä»¶ä¼ é€’ äº‹ä»¶ä¼ é€’åº“ æè¿° eventbus åœ¨activities, fragments, threads, servicesä¹‹é—´ä¼ é€’æ¶ˆæ¯ rxbus ç®€æ˜“çš„éåå°„çš„äº‹ä»¶æ€»çº¿åº“ ç½‘ç»œè¯·æ±‚ ç½‘ç»œè¯·æ±‚åº“ æè¿° okhttp å®‰å“ç«¯æœ€ç«çƒ­çš„ç½‘ç»œè¯·æ±‚åº“ï¼Œä½¿ç”¨ç®€å•ï¼ŒåŠŸèƒ½å®Œå¤‡ volley ç½‘ç»œè¯·æ±‚åº“ï¼Œé€‚åˆæ•°æ®é‡ä¸å¤§ï¼Œé€šä¿¡é¢‘ç¹çš„ç½‘ç»œæ“ä½œ retrofit åŸºäºokhttpå°è£…çš„ç½‘ç»œåº“ JSONè§£æ JSONè§£æåº“ æè¿° fastjson Javaè¯­è¨€ç¼–å†™çš„é«˜æ€§èƒ½åŠŸèƒ½å®Œå–„çš„JSONåº“ gson Javaåºåˆ—åŒ–ååºåˆ—åŒ–åº“ç”¨äºJSONå’ŒJavaå¯¹è±¡è½¬åŒ– moshi é¢å‘Android, Java å’ŒKotlinçš„ç°ä»£JSONåº“ Jackson Java JSONåº“ çƒ­ä¿®å¤ çƒ­ä¿®å¤åº“ æè¿° tinker è…¾è®¯çƒ­ä¿®å¤è§£å†³æ–¹æ¡ˆåº“ robust ç¾å›¢çƒ­ä¿®å¤æ¡†æ¶ æ³¨è§£æ¡†æ¶ æ³¨è§£æ¡†æ¶åº“ æè¿° butterknife View, Resourceæ³¨å…¥æ¡†æ¶ dagger ä¾èµ–æ³¨å…¥åº“ æ€§èƒ½ä¼˜åŒ– æ€§èƒ½ä¼˜åŒ–åº“ æè¿° leakcanary å†…å­˜æ³„æ¼æ£€æµ‹åº“ blockcanary å¡é¡¿æ£€æµ‹ arca åº”ç”¨å´©æºƒæŠ¥å‘Š ç»„ä»¶åŒ– ç»„ä»¶åŒ–åº“ æè¿° arouter Appè¿›è¡Œç»„ä»¶åŒ–æ”¹é€ çš„è·¯ç”±æ¡†æ¶ å“åº”å¼ å“åº”å¼åº“ æè¿° rxjava å“åº”å¼ç¼–ç¨‹ï¼Œåˆ›å»ºåŸºäºäº‹ä»¶çš„å¼‚æ­¥æ“ä½œåº“ rxandroid RxJavaçš„Androidç»‘å®š åŠ¨ç”» é—®: Lottie åŠ¨ç”»åº“çš„ä¼˜ç‚¹æ˜¯ä»€ä¹ˆï¼Ÿå®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ\nç­”: Lottie æ˜¯ä¸€ä¸ªå¼ºå¤§çš„åŠ¨ç”»åº“ï¼Œæ”¯æŒåœ¨ Androidã€iOS å’Œ Web ä¸Šæ¸²æŸ“ Adobe After Effects åŠ¨ç”»ã€‚å®ƒçš„ä¸»è¦ä¼˜ç‚¹åŒ…æ‹¬ï¼š è·¨å¹³å°æ”¯æŒ: ä¸€æ¬¡åˆ›å»ºï¼Œéšå¤„ä½¿ç”¨ã€‚ é«˜æ€§èƒ½: é€šè¿‡ JSON æ–‡ä»¶æ¸²æŸ“åŠ¨ç”»ï¼Œæ¯”ä¼ ç»Ÿå¸§åŠ¨ç”»æ›´é«˜æ•ˆã€‚ æ˜“äºä½¿ç”¨: åªéœ€å‡ è¡Œä»£ç å³å¯åŠ è½½å¹¶æ’­æ”¾åŠ¨ç”»ã€‚ Lottie å·¥ä½œåŸç†æ˜¯é€šè¿‡è§£æç”± Bodymovin å¯¼å‡ºçš„ JSON æ–‡ä»¶ï¼Œå¹¶å°†å…¶è½¬æ¢ä¸ºåŸç”Ÿçš„åŠ¨ç”»æ•ˆæœã€‚ é—®: å¦‚ä½•åœ¨ Android é¡¹ç›®ä¸­é›†æˆ AVLoadingIndicatorViewï¼Ÿ\nç­”: åœ¨ Android é¡¹ç›®ä¸­é›†æˆ AVLoadingIndicatorView å¯ä»¥æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤è¿›è¡Œï¼š\nåœ¨é¡¹ç›®çš„\næ–‡ä»¶ä¸­æ·»åŠ ä¾èµ–ï¼š\nimplementation \u0026#39;com.wang.avi:library:2.1.3\u0026#39; åœ¨å¸ƒå±€æ–‡ä»¶ä¸­æ·»åŠ  AVLoadingIndicatorViewï¼š\n\u0026lt;com.wang.avi.AVLoadingIndicatorView android:id=\u0026#34;@+id/avi\u0026#34; android:layout_width=\u0026#34;wrap_content\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; app:indicatorName=\u0026#34;BallPulseIndicator\u0026#34;/\u0026gt; åœ¨ä»£ç ä¸­å¯åŠ¨æˆ–åœæ­¢åŠ¨ç”»ï¼š\nAVLoadingIndicatorView avi = findViewById(R.id.avi); avi.show(); // To start animation avi.hide(); // To stop animation æ•°æ®åº“ é—®: Room æ•°æ®åº“æœ‰å“ªäº›ä¸»è¦ç‰¹æ€§ï¼Ÿ ç­”: Room æ˜¯ Google æ¨å‡ºçš„å®˜æ–¹æ•°æ®åº“åº“ï¼Œä¸»è¦ç‰¹æ€§åŒ…æ‹¬ï¼š ç®€å•æ˜“ç”¨: ä½¿ç”¨æ³¨è§£æ¥å®šä¹‰æ•°æ®åº“è¡¨å’ŒæŸ¥è¯¢ã€‚ ç¼–è¯‘æ—¶éªŒè¯: Room åœ¨ç¼–è¯‘æ—¶éªŒè¯ SQL æŸ¥è¯¢è¯­å¥çš„æ­£ç¡®æ€§ã€‚ ä¸ LiveData å’Œ RxJava é›†æˆ: æ”¯æŒä¸ LiveData å’Œ RxJava é›†æˆï¼Œå®ç°æ•°æ®çš„å¼‚æ­¥å¤„ç†å’Œå“åº”å¼ç¼–ç¨‹ã€‚ è¿ç§»æ”¯æŒ: æä¾›äº†æ–¹ä¾¿çš„æ•°æ®åº“è¿ç§»æœºåˆ¶ã€‚ é—®: å¯¹æ¯” SQLiteã€Realm å’Œ ObjectBoxï¼Œæœ‰å“ªäº›ä¸åŒç‚¹ï¼Ÿ ç­”: SQLite: åŸç”Ÿæ”¯æŒï¼Œè½»é‡çº§ï¼Œå¹¿æ³›åº”ç”¨ï¼Œä½†éœ€è¦æ‰‹åŠ¨ç®¡ç†æ•°æ®åº“å’ŒæŸ¥è¯¢ã€‚ Realm: é«˜æ€§èƒ½ï¼Œç®€å•æ˜“ç”¨ï¼Œæ”¯æŒå®æ—¶æ›´æ–°ï¼Œä½†åº“ä½“ç§¯è¾ƒå¤§ï¼Œä½¿ç”¨æ—¶éœ€è¦æ³¨æ„è®¸å¯è¯é—®é¢˜ã€‚ ObjectBox: é«˜æ€§èƒ½ï¼Œç®€æ˜“çš„å¯¹è±¡å…³ç³»æ˜ å°„ï¼Œé€‚ç”¨äºç‰©è”ç½‘å’Œç§»åŠ¨è®¾å¤‡ï¼Œä½†ç›¸å¯¹è¾ƒæ–°ï¼Œç¤¾åŒºæ”¯æŒå¯èƒ½ä¸å¦‚å‰ä¸¤è€…ã€‚ äº‹ä»¶ä¼ é€’ é—®: EventBus å’Œ RxBus æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ ç­”: EventBus: ç®€å•æ˜“ç”¨ï¼ŒåŸºäºå‘å¸ƒ-è®¢é˜…æ¨¡å¼ï¼Œé€‚ç”¨äºç»„ä»¶é—´çš„ç®€å•é€šä¿¡ã€‚ RxBus: åŸºäº RxJava å®ç°çš„äº‹ä»¶æ€»çº¿ï¼Œæ”¯æŒå¤æ‚çš„äº‹ä»¶æµå¤„ç†å’Œå¼‚æ­¥æ“ä½œï¼Œé€‚åˆéœ€è¦å“åº”å¼ç¼–ç¨‹çš„åœºæ™¯ã€‚ ç½‘ç»œè¯·æ±‚ é—®: Retrofit æ˜¯å¦‚ä½•ç®€åŒ–ç½‘ç»œè¯·æ±‚çš„ï¼Ÿ ç­”: Retrofit æ˜¯ä¸€ä¸ªåŸºäº OkHttp çš„ç½‘ç»œè¯·æ±‚åº“ï¼Œé€šè¿‡æ³¨è§£å’Œæ¥å£å®šä¹‰ APIï¼Œç®€åŒ–äº†ç½‘ç»œè¯·æ±‚çš„å¤„ç†ã€‚ä¸»è¦ä¼˜ç‚¹åŒ…æ‹¬ï¼š ç±»å‹å®‰å…¨: è‡ªåŠ¨å°† JSON å“åº”è§£æä¸ºæŒ‡å®šçš„ Java å¯¹è±¡ã€‚ ç®€æ´çš„ API å®šä¹‰: é€šè¿‡æ³¨è§£å®šä¹‰è¯·æ±‚æ–¹æ³•å’Œå‚æ•°ã€‚ ä¸ OkHttp é›†æˆ: æ”¯æŒ OkHttp çš„æ‰€æœ‰ç‰¹æ€§ï¼Œå¦‚æ‹¦æˆªå™¨å’Œç¼“å­˜ã€‚ æ‰©å±•æ€§å¼º: æ”¯æŒè‡ªå®šä¹‰è½¬æ¢å™¨å’Œé€‚é…å™¨ï¼Œå¦‚ Gsonã€Moshi å’Œ RxJavaã€‚ JSONè§£æ é—®: Gson å’Œ Moshi æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ ç­”: Gson: ç”± Google å¼€å‘ï¼Œç¨³å®šä¸”å¹¿æ³›ä½¿ç”¨ï¼Œæ”¯æŒå¤æ‚çš„æ•°æ®ç»“æ„å’Œè‡ªå®šä¹‰åºåˆ—åŒ–/ååºåˆ—åŒ–ã€‚ Moshi: ç”± Square å¼€å‘ï¼Œç°ä»£åŒ–è®¾è®¡ï¼Œæ”¯æŒ Kotlin ç‰¹æ€§ï¼ˆå¦‚ Kotlin ç±»å‹å’Œä¸å¯å˜æ•°æ®ç±»ï¼‰ï¼Œæ€§èƒ½æ›´é«˜ï¼Œé”™è¯¯å¤„ç†æ›´å‹å¥½ã€‚ æ€§èƒ½ä¼˜åŒ– é—®: LeakCanary æ˜¯å¦‚ä½•å¸®åŠ©æ£€æµ‹å†…å­˜æ³„æ¼çš„ï¼Ÿ ç­”: LeakCanary æ˜¯ä¸€ä¸ªå†…å­˜æ³„æ¼æ£€æµ‹åº“ï¼Œé€šè¿‡ç›‘æ§å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸæ¥æ£€æµ‹å†…å­˜æ³„æ¼ã€‚å½“æ£€æµ‹åˆ°å†…å­˜æ³„æ¼æ—¶ï¼Œä¼šç”Ÿæˆè¯¦ç»†çš„æ³„æ¼è·¯å¾„æŠ¥å‘Šï¼Œå¸®åŠ©å¼€å‘è€…å¿«é€Ÿå®šä½å’Œä¿®å¤å†…å­˜æ³„æ¼é—®é¢˜ã€‚ å“åº”å¼ é—®: RxJava çš„æ ¸å¿ƒæ€æƒ³æ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•åœ¨ Android ä¸­ä½¿ç”¨ RxJavaï¼Ÿ\nç­”: RxJava çš„æ ¸å¿ƒæ€æƒ³æ˜¯å“åº”å¼ç¼–ç¨‹ï¼Œé€šè¿‡ Observable å’Œ Observer è¿›è¡Œäº‹ä»¶æµå¤„ç†ã€‚å®ƒå…è®¸å¼€å‘è€…ä»¥å£°æ˜æ€§æ–¹å¼å¤„ç†å¼‚æ­¥äº‹ä»¶å’Œæ•°æ®æµã€‚ä½¿ç”¨ RxJava å¯ä»¥ç®€åŒ–å¼‚æ­¥æ“ä½œï¼Œé¿å…å›è°ƒåœ°ç‹±ã€‚åœ¨ Android ä¸­ä½¿ç”¨ RxJavaï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ­¥éª¤ï¼š\næ·»åŠ ä¾èµ–ï¼š\nimplementation \u0026#39;io.reactivex.rxjava3:rxjava:3.0.0\u0026#39;\rimplementation \u0026#39;io.reactivex.rxjava3:rxandroid:3.0.0\u0026#39; åˆ›å»º Observable å’Œ Observerï¼š\nObservable\u0026lt;String\u0026gt; observable = Observable.just(\u0026#34;Hello, RxJava\u0026#34;); Observer\u0026lt;String\u0026gt; observer = new Observer\u0026lt;String\u0026gt;() { @Override public void onSubscribe(Disposable d) {} @Override public void onNext(String s) { Log.d(\u0026#34;RxJava\u0026#34;, s); } @Override public void onError(Throwable e) {} @Override public void onComplete() {} }; observable.subscribe(observer); v\nå¯¹æ–¹æ­£åœ¨è¾“å…¥â€¦ 2024/7/11 14:43:38\rimplementation \u0026#39;io.github.cymchad:BaseRecyclerViewAdapterHelper:3.0.14\u0026#39;\rå¯¹æ–¹æ­£åœ¨è¾“å…¥â€¦ 2024/7/11 15:52:47\rimplementation(\u0026#34;androidx.swiperefreshlayout:swiperefreshlayout:1.0.0\u0026#34;)\rå¯¹æ–¹æ­£åœ¨è¾“å…¥â€¦ 2024/7/11 16:55:18\rBaseMultiItemQuickAdapter\rå¯¹æ–¹æ­£åœ¨è¾“å…¥â€¦ 2024/7/11 16:55:33\rSwipeRefreshLayout\rå¯¹æ–¹æ­£åœ¨è¾“å…¥â€¦ 2024/7/11 16:56:01\rEventBus.getDefault().post\rå¯¹æ–¹æ­£åœ¨è¾“å…¥â€¦ 2024/7/11 16:56:14\rGlide.with ","permalink":"https://kennems.github.io/posts/tech/%E7%AC%AC%E5%85%AD%E5%A4%A9%E7%AC%94%E8%AE%B0/","summary":"ç¬¬å…­å¤©ç¬”è®° ç»„ä»¶åº“ç¬”è®° 1. ç»„ä»¶åº“ä¾èµ–ã€å‘å¸ƒå’Œä½¿ç”¨ ä¾èµ–æ–¹å¼å¯¹æ¯” 2.xç‰ˆæœ¬ 3.xç‰ˆæœ¬ è¯´æ˜ apk runtimeOnly apk åŠŸèƒ½åŒ runtimeOnlyã€‚åªåœ¨ç”Ÿæˆ apk æ—¶å‚ä¸æ‰“åŒ…ï¼Œç¼–","title":"è®­ç»ƒè¥ç¬¬å…­å¤©å­¦ä¹ ç¬”è®°"},{"content":"ç¬¬å››å¤©ç¬”è®° Android UI è¯¾ç¨‹é‡ç‚¹çŸ¥è¯†ç¬”è®° 1. äº†è§£Androidæ§ä»¶å¸¸ç”¨å±æ€§ Android:id ä»»ä½• View å¯¹è±¡å‡å¯æ‹¥æœ‰ä¸ä¹‹å…³è”çš„æ•´å‹ IDï¼Œç”¨äºåœ¨ç»“æ„æ ‘ä¸­å¯¹ View å¯¹è±¡è¿›è¡Œå”¯ä¸€æ ‡è¯†ã€‚ ç³»ç»Ÿä¼šä»¥æ•´å‹å½¢å¼å¼•ç”¨æ­¤ IDã€‚ åœ¨å¸ƒå±€ XML æ–‡ä»¶ä¸­ï¼Œç³»ç»Ÿé€šå¸¸ä»¥å­—ç¬¦ä¸²çš„å½¢å¼åœ¨ android:id å±æ€§ä¸­æŒ‡å®šè¯¥ IDã€‚ // ä½¿ç”¨ç³»ç»Ÿèµ„æº android:id=\u0026#34;@android:id/androidView\u0026#34; // ä½¿ç”¨è‡ªå·±åˆ›å»ºçš„èµ„æº android:id=\u0026#34;@+id/myView\u0026#34; // æ ‡è¯†åˆ›å»ºä¸€ä¸ªæ–°èµ„æº android:id=\u0026#34;@id/myView\u0026#34; // ä½¿ç”¨ç°æœ‰èµ„æº android:layout_width å’Œ android:layout_height android:layout_width å’Œ android:layout_height åˆ†åˆ«è¡¨ç¤ºæ§ä»¶çš„å®½åº¦å’Œé«˜åº¦ã€‚ å–å€¼ä¸º wrap_contentã€match_parent å’Œå…·ä½“çš„æ•°å€¼ï¼ˆå¦‚ 40dpï¼‰ã€‚ wrap_contentï¼šè¡¨ç¤ºæ§ä»¶å®½åº¦/é«˜åº¦ç”±å†…å®¹å†³å®šã€‚ match_parentï¼šè¡¨ç¤ºæ§ä»¶å®½åº¦/é«˜åº¦ä¸ºçˆ¶viewå…è®¸çš„æœ€å¤§å€¼ã€‚ \u0026lt;View android:layout_width=\u0026#34;wrap_content\u0026#34; // è®¾ç½®å®½ android:layout_height=\u0026#34;wrap_content\u0026#34; // è®¾ç½®é«˜ /\u0026gt; 2. äº†è§£æ–‡æœ¬æ¡† TextView TextView ä»‹ç» \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;LinearLayout xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34; android:gravity=\u0026#34;center\u0026#34;\u0026gt; \u0026lt;TextView android:layout_width=\u0026#34;wrap_content\u0026#34; // è®¾ç½®æ–‡å­— android:layout_height=\u0026#34;wrap_content\u0026#34; android:background=\u0026#34;@color/teal_200\u0026#34; // è®¾ç½®èƒŒæ™¯é¢œè‰² android:text=\u0026#34;Hello World\u0026#34; // è®¾ç½®æ–‡æœ¬å†…å®¹ android:textSize=\u0026#34;20dp\u0026#34; // è®¾ç½®æ–‡å­—å¤§å° android:textColor=\u0026#34;#FAFA02\u0026#34; // è®¾ç½®æ–‡å­—é¢œè‰² android:textStyle=\u0026#34;bold\u0026#34;/\u0026gt; // è®¾ç½®æ–‡å­—æ ·å¼ï¼ˆnormal, bold, italicï¼‰ \u0026lt;/LinearLayout\u0026gt; 3. äº†è§£æŒ‰é’® Button Button ä»‹ç» Buttonï¼šåœ¨ UI ä¸Šç”Ÿæˆä¸€ä¸ªæŒ‰é’®ï¼Œç”¨æˆ·ç‚¹å‡»æ—¶è§¦å‘ onclick äº‹ä»¶ã€‚\nButton æ˜¯ TextView çš„å­ç±»ï¼Œæ‰€ä»¥ TextView ä¸Šçš„è®¸å¤šå±æ€§ä¹Ÿå¯ä»¥åº”ç”¨åˆ° Button ä¸Šã€‚\nå®é™…å¼€å‘ä¸­å¯¹ Button çš„ä½¿ç”¨ï¼šä¸»è¦å¯¹æŒ‰é’®çš„å‡ ä¸ªçŠ¶æ€åšç›¸åº”çš„æ“ä½œï¼Œä¾‹å¦‚ï¼š\næŒ‰é’®æŒ‰ä¸‹æ—¶çš„ä¸€ç§æ ·å¼ æ¾å¼€æ—¶çš„å¦ä¸€ç§æ ·å¼ æŒ‰é’®ä¸å¯ç”¨æ—¶çš„æ ·å¼ç­‰ ç¤ºä¾‹ä»£ç  \u0026lt;LinearLayout xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34; android:gravity=\u0026#34;center\u0026#34;\u0026gt; \u0026lt;Button android:id=\u0026#34;@+id/button\u0026#34; android:layout_width=\u0026#34;wrap_content\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:text=\u0026#34;button\u0026#34; /\u0026gt; \u0026lt;/LinearLayout\u0026gt; 4. äº†è§£è¾“å…¥æ¡† EditText EditText ä»‹ç» EditTextï¼šè¾“å…¥æ¡†ï¼Œæ˜¯ç”¨æˆ·å’Œ Android åº”ç”¨è¿›è¡Œæ•°æ®ä¼ é€’çš„é€šé“ã€‚é€šè¿‡å®ƒï¼Œå¯ä»¥è·å–åˆ°ç”¨æˆ·è¾“å…¥çš„æ•°æ®ã€‚\nEditText æ˜¯ä¸€ä¸ªè¾“å…¥æ¡†ï¼Œå¼€å‘ä¸­ç»å¸¸ä½¿ç”¨çš„æ§ä»¶ï¼Œå¸¸ç”¨äºéœ€è¦è·å–ç”¨æˆ·è¾“å…¥çš„åœºæ™¯ï¼Œä¾‹å¦‚ï¼š\nç™»å½•æ³¨å†ŒåŠŸèƒ½\næœç´¢åŠŸèƒ½ åé¦ˆåŠŸèƒ½ç­‰\nç¤ºä¾‹ä»£ç  \u0026lt;LinearLayout xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34; android:gravity=\u0026#34;center\u0026#34; android:orientation=\u0026#34;vertical\u0026#34;\u0026gt; \u0026lt;EditText android:layout_width=\u0026#34;wrap_content\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:hint=\u0026#34;è¯·è¾“å…¥å†…å®¹\u0026#34; android:textColorHint=\u0026#34;@color/teal_200\u0026#34; /\u0026gt; \u0026lt;/LinearLayout\u0026gt; 5. äº†è§£å›¾ç‰‡æ§ä»¶ ImageView ImageView ä»‹ç» ImageViewï¼šç”¨äºæ˜¾ç¤ºå›¾åƒçš„ View æˆ–æ§ä»¶ï¼Œè®© App ç•Œé¢æ›´ç¾è§‚ç”ŸåŠ¨ã€‚å¯ä»¥ç›´æ¥æ˜¾ç¤º drawable é‡Œçš„å›¾ç‰‡èµ„æºã€‚ ç¤ºä¾‹ä»£ç  \u0026lt;LinearLayout xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34; android:gravity=\u0026#34;center\u0026#34;\u0026gt; \u0026lt;ImageView android:id=\u0026#34;@+id/image\u0026#34; android:layout_width=\u0026#34;150dp\u0026#34; android:layout_height=\u0026#34;150dp\u0026#34; android:background=\u0026#34;@drawable/icon1\u0026#34; /\u0026gt; \u0026lt;/LinearLayout\u0026gt; Viewå¸¸ç”¨å±æ€§ TextView å¸ƒå±€marginå’Œpadding Viewå¸¸ç”¨å±æ€§\nå¤æ‚XML\n\u0026lt;RelativeLayout xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34; xmlns:tools=\u0026#34;http://schemas.android.com/tools\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34; tools:context=\u0026#34;.MainActivity\u0026#34;\u0026gt; \u0026lt;!-- é¡¶éƒ¨å¯¼èˆªæ  --\u0026gt; \u0026lt;LinearLayout android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:orientation=\u0026#34;horizontal\u0026#34; android:padding=\u0026#34;10dp\u0026#34; android:background=\u0026#34;#000000\u0026#34; android:gravity=\u0026#34;center_vertical\u0026#34;\u0026gt; \u0026lt;ImageView android:layout_width=\u0026#34;40dp\u0026#34; android:layout_height=\u0026#34;40dp\u0026#34; android:src=\u0026#34;@drawable/ic_mi_logo\u0026#34; /\u0026gt; \u0026lt;EditText android:layout_width=\u0026#34;0dp\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:layout_weight=\u0026#34;1\u0026#34; android:hint=\u0026#34;å¹³æ¿\u0026#34; android:padding=\u0026#34;10dp\u0026#34; android:background=\u0026#34;@drawable/search_bar_shape\u0026#34; android:layout_marginLeft=\u0026#34;10dp\u0026#34; android:layout_marginRight=\u0026#34;10dp\u0026#34;/\u0026gt; \u0026lt;ImageView android:layout_width=\u0026#34;40dp\u0026#34; android:layout_height=\u0026#34;40dp\u0026#34; android:src=\u0026#34;@drawable/ic_scan\u0026#34; /\u0026gt; \u0026lt;ImageView android:layout_width=\u0026#34;40dp\u0026#34; android:layout_height=\u0026#34;40dp\u0026#34; android:src=\u0026#34;@drawable/ic_cart\u0026#34; /\u0026gt; \u0026lt;/LinearLayout\u0026gt; \u0026lt;!-- ä¸»å†…å®¹åŒºåŸŸ --\u0026gt; \u0026lt;ScrollView android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34; android:layout_below=\u0026#34;@id/top_nav_bar\u0026#34;\u0026gt; \u0026lt;LinearLayout android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:orientation=\u0026#34;vertical\u0026#34;\u0026gt; \u0026lt;!-- å¹¿å‘Šå›¾ç‰‡ --\u0026gt; \u0026lt;ImageView android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;200dp\u0026#34; android:src=\u0026#34;@drawable/ad_image\u0026#34; android:scaleType=\u0026#34;centerCrop\u0026#34; /\u0026gt; \u0026lt;!-- äº§å“ä¿¡æ¯ --\u0026gt; \u0026lt;LinearLayout android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:orientation=\u0026#34;vertical\u0026#34; android:padding=\u0026#34;10dp\u0026#34;\u0026gt; \u0026lt;TextView android:layout_width=\u0026#34;wrap_content\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:text=\u0026#34;xiaomi CIVI 3\u0026#34; android:textSize=\u0026#34;24sp\u0026#34; android:textColor=\u0026#34;#000000\u0026#34; /\u0026gt; \u0026lt;TextView android:layout_width=\u0026#34;wrap_content\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:text=\u0026#34;è¿ªå£«å°¼100å‘¨å¹´é™å®šç‰ˆ\u0026#34; android:textSize=\u0026#34;16sp\u0026#34; android:textColor=\u0026#34;#888888\u0026#34; /\u0026gt; \u0026lt;TextView android:layout_width=\u0026#34;wrap_content\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:text=\u0026#34;å½±å¸ˆToy Story ä¸“å±é™å®šæ¬¾\u0026#34; android:textSize=\u0026#34;16sp\u0026#34; android:textColor=\u0026#34;#888888\u0026#34; /\u0026gt; \u0026lt;Button android:layout_width=\u0026#34;wrap_content\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:text=\u0026#34;ç«‹å³è´­ä¹°\u0026#34; android:backgroundTint=\u0026#34;#FF0000\u0026#34; android:textColor=\u0026#34;#FFFFFF\u0026#34; android:layout_marginTop=\u0026#34;10dp\u0026#34;/\u0026gt; \u0026lt;/LinearLayout\u0026gt; \u0026lt;!-- åˆ†ç±»èœå• --\u0026gt; \u0026lt;LinearLayout android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:orientation=\u0026#34;horizontal\u0026#34; android:padding=\u0026#34;10dp\u0026#34; android:gravity=\u0026#34;center\u0026#34;\u0026gt; \u0026lt;!-- åˆ†ç±»é¡¹ ç¤ºä¾‹ --\u0026gt; \u0026lt;LinearLayout android:layout_width=\u0026#34;0dp\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:layout_weight=\u0026#34;1\u0026#34; android:orientation=\u0026#34;vertical\u0026#34; android:gravity=\u0026#34;center\u0026#34;\u0026gt; \u0026lt;ImageView android:layout_width=\u0026#34;60dp\u0026#34; android:layout_height=\u0026#34;60dp\u0026#34; android:src=\u0026#34;@drawable/ic_category1\u0026#34; /\u0026gt; \u0026lt;TextView android:layout_width=\u0026#34;wrap_content\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:text=\u0026#34;å°ç±³ç¬”è®°æœ¬\u0026#34; android:textSize=\u0026#34;14sp\u0026#34; android:textColor=\u0026#34;#000000\u0026#34; android:gravity=\u0026#34;center\u0026#34; /\u0026gt; \u0026lt;/LinearLayout\u0026gt; \u0026lt;!-- å…¶ä»–åˆ†ç±»é¡¹å¯ä»¥ç±»ä¼¼æ·»åŠ  --\u0026gt; \u0026lt;/LinearLayout\u0026gt; \u0026lt;!-- æ™ºèƒ½ç”Ÿæ´»å£ç¢‘èŠ‚å¹¿å‘Š --\u0026gt; \u0026lt;ImageView android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;100dp\u0026#34; android:src=\u0026#34;@drawable/ad_smart_life\u0026#34; android:scaleType=\u0026#34;centerCrop\u0026#34; android:layout_marginTop=\u0026#34;10dp\u0026#34;/\u0026gt; \u0026lt;!-- åŒæ—¦æ–°å“æ‰‹æœºå¹¿å‘Š --\u0026gt; \u0026lt;ImageView android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;100dp\u0026#34; android:src=\u0026#34;@drawable/ad_new_phone\u0026#34; android:scaleType=\u0026#34;centerCrop\u0026#34; android:layout_marginTop=\u0026#34;10dp\u0026#34;/\u0026gt; \u0026lt;/LinearLayout\u0026gt; \u0026lt;/ScrollView\u0026gt; \u0026lt;!-- åº•éƒ¨å¯¼èˆªæ  --\u0026gt; \u0026lt;LinearLayout android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:orientation=\u0026#34;horizontal\u0026#34; android:background=\u0026#34;#FFFFFF\u0026#34; android:gravity=\u0026#34;center\u0026#34; android:layout_alignParentBottom=\u0026#34;true\u0026#34;\u0026gt; \u0026lt;!-- åº•éƒ¨å¯¼èˆªé¡¹ ç¤ºä¾‹ --\u0026gt; \u0026lt;LinearLayout android:layout_width=\u0026#34;0dp\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:layout_weight=\u0026#34;1\u0026#34; android:orientation=\u0026#34;vertical\u0026#34; android:gravity=\u0026#34;center\u0026#34;\u0026gt; \u0026lt;ImageView android:layout_width=\u0026#34;30dp\u0026#34; android:layout_height=\u0026#34;30dp\u0026#34; android:src=\u0026#34;@drawable/ic_home\u0026#34; /\u0026gt; \u0026lt;TextView android:layout_width=\u0026#34;wrap_content\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:text=\u0026#34;é¦–é¡µ\u0026#34; android:textSize=\u0026#34;12sp\u0026#34; android:textColor=\u0026#34;#000000\u0026#34; android:gravity=\u0026#34;center\u0026#34; /\u0026gt; \u0026lt;/LinearLayout\u0026gt; \u0026lt;!-- å…¶ä»–åº•éƒ¨å¯¼èˆªé¡¹å¯ä»¥ç±»ä¼¼æ·»åŠ  --\u0026gt; \u0026lt;/LinearLayout\u0026gt; \u0026lt;/RelativeLayout\u0026gt; EditText ProgressBar ç»ƒä¹  RecycleView RecycleView.java package com.showguan.study.study_day4; import android.os.Bundle; import android.util.Log; import androidx.activity.EdgeToEdge; import androidx.appcompat.app.AppCompatActivity; import androidx.core.graphics.Insets; import androidx.core.view.ViewCompat; import androidx.core.view.WindowInsetsCompat; import androidx.recyclerview.widget.LinearLayoutManager; import androidx.recyclerview.widget.RecyclerView; import com.showguan.study.R; import com.showguan.study.study_day4.adapter.GameRecyclerAdapter; import com.showguan.study.study_day4.bean.GameBean; import java.util.ArrayList; import java.util.List; public class RecycleViewActivity extends AppCompatActivity { private static final String TAG = \u0026#34;ZhouGuan\u0026#34;; List\u0026lt;GameBean\u0026gt; data = new ArrayList\u0026lt;\u0026gt;(); @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); EdgeToEdge.enable(this); setContentView(R.layout.activity_recycle_view); RecyclerView recyclerView = findViewById(R.id.demo_recyclerview); // 1. åˆå§‹åŒ–æ•°æ® setData(); // 2. å®ä¾‹åŒ–é€‚é…å™¨ GameRecyclerAdapter adapter = new GameRecyclerAdapter(data); // 3. è®¾ç½®é€‚é…å™¨ recyclerView.setAdapter(adapter); // 4. è®¾ç½®å¸ƒå±€ç®¡ç†å™¨ recyclerView.setLayoutManager(new LinearLayoutManager(this)); } private void setData() { String[] gameStatus = new String[]{\u0026#34;å¼€å§‹æ¸¸æˆ\u0026#34;, \u0026#34;æ•¬è¯·æœŸå¾…\u0026#34;, \u0026#34;æ›´æ–°\u0026#34;, \u0026#34;é¢„çº¦\u0026#34;}; int[] icons = new int[]{R.drawable.game_icon1, R.drawable.game_icon2, R.drawable.game_icon3, R.drawable.game_icon4}; for (int i = 0; i \u0026lt; 100; i++) { GameBean gameBean = new GameBean(); gameBean.setGameName(\u0026#34;æ¸¸æˆæ•°æ®\u0026#34; + i); gameBean.setGameIcon(icons[i % 4]); gameBean.setGameStatus(gameStatus[i % 4]); Log.d(TAG, gameBean.toString()); data.add(gameBean); } } } GameRecyclerAdapter.java package com.showguan.study.study_day4.adapter; import android.view.LayoutInflater; import android.view.View; import android.view.ViewGroup; import android.widget.ImageView; import android.widget.TextView; import androidx.annotation.NonNull; import androidx.recyclerview.widget.RecyclerView; import com.showguan.study.R; import com.showguan.study.study_day4.bean.GameBean; import java.util.List; public class GameRecyclerAdapter extends RecyclerView.Adapter\u0026lt;GameRecyclerAdapter.CarriageHolder\u0026gt; { // æ•°æ®åˆ—è¡¨ï¼Œç”¨äºå­˜å‚¨æ‰€æœ‰è¦æ˜¾ç¤ºçš„æ¸¸æˆæ•°æ® private final List\u0026lt;GameBean\u0026gt; mData; // æ„é€ æ–¹æ³•ï¼Œåˆå§‹åŒ–æ•°æ®åˆ—è¡¨ public GameRecyclerAdapter(List\u0026lt;GameBean\u0026gt; data) { this.mData = data; } // åˆ›å»ºæ–°çš„ViewHolderå¯¹è±¡ @NonNull @Override public CarriageHolder onCreateViewHolder(@NonNull ViewGroup parent, int viewType) { // åŠ è½½å¸ƒå±€æ–‡ä»¶å¹¶åˆ›å»ºViewHolderå¯¹è±¡ View view = LayoutInflater.from(parent.getContext()).inflate(R.layout.carriage_view, parent, false); return new CarriageHolder(view); } // ç»‘å®šæ•°æ®åˆ°ViewHolderä¸Š @Override public void onBindViewHolder(@NonNull CarriageHolder holder, int position) { // è·å–å½“å‰æ•°æ®é¡¹ GameBean game = mData.get(position); // è®¾ç½®æ¸¸æˆåç§° holder.gameName.setText(game.getGameName()); // è®¾ç½®æ¸¸æˆçŠ¶æ€ holder.gameStatus.setText(game.getGameStatus()); // è®¾ç½®æ¸¸æˆå›¾æ ‡ holder.gameIcon.setImageResource(game.getGameIcon()); } // è·å–æ•°æ®é¡¹çš„æ•°é‡ @Override public int getItemCount() { return mData.size(); } // å†…éƒ¨ç±»ï¼Œè¡¨ç¤ºä¸€ä¸ªViewHolder static class CarriageHolder extends RecyclerView.ViewHolder { // å®šä¹‰ViewHolderä¸­çš„è§†å›¾ TextView gameName; TextView gameStatus; ImageView gameIcon; // æ„é€ æ–¹æ³•ï¼Œç»‘å®šè§†å›¾ public CarriageHolder(@NonNull View itemView) { super(itemView); // ç»‘å®šæ¸¸æˆåç§°è§†å›¾ gameName = itemView.findViewById(R.id.game_name); // ç¡®ä¿è¿™äº›IDä¸carriage_view.xmlä¸­çš„IDä¸€è‡´ // ç»‘å®šæ¸¸æˆçŠ¶æ€è§†å›¾ gameStatus = itemView.findViewById(R.id.game_status); // ç»‘å®šæ¸¸æˆå›¾æ ‡è§†å›¾ gameIcon = itemView.findViewById(R.id.game_icon); } } } ","permalink":"https://kennems.github.io/posts/tech/%E7%AC%AC%E5%9B%9B%E5%A4%A9%E7%AC%94%E8%AE%B0/","summary":"ç¬¬å››å¤©ç¬”è®° Android UI è¯¾ç¨‹é‡ç‚¹çŸ¥è¯†ç¬”è®° 1. äº†è§£Androidæ§ä»¶å¸¸ç”¨å±æ€§ Android:id ä»»ä½• View å¯¹è±¡å‡å¯æ‹¥æœ‰ä¸ä¹‹å…³è”çš„æ•´å‹ IDï¼Œç”¨äºåœ¨ç»“æ„æ ‘ä¸­å¯¹ View å¯¹è±¡è¿›è¡Œå”¯ä¸€æ ‡è¯†ã€‚ ç³»","title":"è®­ç»ƒè¥ç¬¬å››å¤©å­¦ä¹ ç¬”è®°"},{"content":"ç¬¬äº”å¤©ç¬”è®° Android å¸ƒå±€ä¸ä¼˜åŒ– åŸºæœ¬å¸ƒå±€ å…¬å…±å±æ€§ å¸ƒå±€ç±»å‹ å…±æœ‰å±æ€§ layout_gravity: æ§ä»¶ç›¸å¯¹äºçˆ¶æ§ä»¶çš„å¯¹é½æ–¹å¼ gravity: æ§ä»¶å†…éƒ¨çš„å¯¹é½æ–¹å¼ padding: å†…é—´è· paddingTop: ä¸Šé—´è· paddingBottom: ä¸‹é—´è· paddingLeft: å·¦é—´è·~ paddingRight: å³é—´è· layout_width: æ§ä»¶çš„å®½åº¦ layout_height: æ§ä»¶çš„é«˜åº¦ layout_margin: å¤–é—´è· layout_marginLeft: æ§ä»¶çš„å·¦é—´è· layout_marginRight: æ§ä»¶çš„å³é—´è· layout_marginTop: æ§ä»¶çš„ä¸Šé—´è· layout_marginBottom: æ§ä»¶çš„ä¸‹é—´è· ç¤ºä¾‹ä»£ç  \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;FrameLayout xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34;\u0026gt; \u0026lt;TextView android:layout_width=\u0026#34;300dp\u0026#34; android:layout_height=\u0026#34;300dp\u0026#34; android:layout_weight=\u0026#34;1\u0026#34; android:gravity=\u0026#34;bottom\u0026#34; android:text=\u0026#34;AA\u0026#34; android:textSize=\u0026#34;30sp\u0026#34; android:background=\u0026#34;@color/colorPrimary\u0026#34; /\u0026gt; \u0026lt;TextView android:layout_width=\u0026#34;200dp\u0026#34; android:layout_height=\u0026#34;200dp\u0026#34; android:layout_weight=\u0026#34;2\u0026#34; android:gravity=\u0026#34;bottom\u0026#34; android:text=\u0026#34;BB\u0026#34; android:textSize=\u0026#34;30sp\u0026#34; android:background=\u0026#34;@color/colorAccent\u0026#34; /\u0026gt; \u0026lt;TextView android:layout_width=\u0026#34;100dp\u0026#34; android:layout_height=\u0026#34;100dp\u0026#34; android:layout_weight=\u0026#34;3\u0026#34; android:gravity=\u0026#34;bottom\u0026#34; android:text=\u0026#34;CC\u0026#34; android:textSize=\u0026#34;30sp\u0026#34; android:background=\u0026#34;@color/colorPrimaryDark\u0026#34; /\u0026gt; \u0026lt;/FrameLayout\u0026gt; åŸºæœ¬å¸ƒå±€ FrameLayout ç‰¹ç‚¹ï¼šFrameLayout å…è®¸å­è§†å›¾å †å åœ¨ä¸€èµ·ï¼Œåªæ˜¾ç¤ºæœ€åæ·»åŠ çš„å­è§†å›¾ã€‚ ç¤ºä¾‹ä»£ç  \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;FrameLayout xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34;\u0026gt; \u0026lt;TextView android:layout_width=\u0026#34;300dp\u0026#34; android:layout_height=\u0026#34;300dp\u0026#34; android:layout_weight=\u0026#34;1\u0026#34; android:gravity=\u0026#34;bottom\u0026#34; android:text=\u0026#34;AA\u0026#34; android:textSize=\u0026#34;30sp\u0026#34; android:background=\u0026#34;@color/colorPrimary\u0026#34; /\u0026gt; \u0026lt;TextView android:layout_width=\u0026#34;200dp\u0026#34; android:layout_height=\u0026#34;200dp\u0026#34; android:layout_weight=\u0026#34;2\u0026#34; android:gravity=\u0026#34;bottom\u0026#34; android:text=\u0026#34;BB\u0026#34; android:textSize=\u0026#34;30sp\u0026#34; android:background=\u0026#34;@color/colorAccent\u0026#34; /\u0026gt; \u0026lt;TextView android:layout_width=\u0026#34;100dp\u0026#34; android:layout_height=\u0026#34;100dp\u0026#34; android:layout_weight=\u0026#34;3\u0026#34; android:gravity=\u0026#34;bottom\u0026#34; android:text=\u0026#34;CC\u0026#34; android:textSize=\u0026#34;30sp\u0026#34; android:background=\u0026#34;@color/colorPrimaryDark\u0026#34; /\u0026gt; \u0026lt;/FrameLayout\u0026gt; æ•ˆæœï¼šå¦‚å³ä¾§é¢„è§ˆå›¾æ‰€ç¤ºï¼Œä¸‰ä¸ªTextViewæ§ä»¶å †å åœ¨ä¸€èµ·ï¼Œæ˜¾ç¤ºæœ€ä¸Šå±‚çš„æ§ä»¶å†…å®¹ã€‚ LinearLayout ç‰¹ç‚¹ï¼šLinearLayout ä»¥çº¿æ€§æ’åˆ—å­è§†å›¾ï¼Œå¯ä»¥è®¾ç½®ä¸ºæ°´å¹³æˆ–å‚ç›´å¸ƒå±€ã€‚ å±æ€§ä»‹ç» orientationï¼šæ’åˆ—æ–¹å¼ horizontalï¼šæ°´å¹³å¸ƒå±€ verticalï¼šå‚ç›´å¸ƒå±€ layout_weightï¼šæƒé‡ ä½¿ç”¨æ¯”ä¾‹çš„æ–¹å¼æ¥æŒ‡å®šæ§ä»¶çš„å¤§å° å±æ€§å…³ç³»å›¾ å±æ€§\râ”œâ”€ orientation æ’åˆ—æ–¹å¼\râ”‚ â”œâ”€ horizontal æ°´å¹³å¸ƒå±€\râ”‚ â””â”€ vertical å‚ç›´å¸ƒå±€\râ””â”€ layout_weight æƒé‡ï¼šä½¿ç”¨æ¯”ä¾‹çš„æ–¹å¼æ¥æŒ‡å®šæ§ä»¶çš„å¤§å° ä»¥ä¸Šä¸ºAndroidå¸ƒå±€ä¸­çš„FrameLayoutå’ŒLinearLayoutçš„åŸºæœ¬æ¦‚å¿µä¸å±æ€§ä»‹ç»ã€‚\nRelativeLayout ç¤ºä¾‹ åº”ç”¨åœºæ™¯ï¼šä½¿ç”¨ RelativeLayout å®šä¹‰ç›¸å¯¹å¸ƒå±€ï¼Œä»¥ä¸‹ä»£ç å±•ç¤ºäº†åœ¨ä¸åŒä½ç½®æ”¾ç½®æŒ‰é’®çš„ç¤ºä¾‹ã€‚\n\u0026lt;RelativeLayout xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34;\u0026gt; \u0026lt;Button android:layout_width=\u0026#34;150dp\u0026#34; android:layout_height=\u0026#34;150dp\u0026#34; android:layout_alignParentLeft=\u0026#34;true\u0026#34; android:text=\u0026#34;å·¦ä¸Šè§’\u0026#34; android:textSize=\u0026#34;30dp\u0026#34; /\u0026gt; \u0026lt;Button android:layout_width=\u0026#34;150dp\u0026#34; android:layout_height=\u0026#34;150dp\u0026#34; android:layout_alignParentRight=\u0026#34;true\u0026#34; android:text=\u0026#34;å³ä¸Šè§’\u0026#34; android:textSize=\u0026#34;30dp\u0026#34; /\u0026gt; \u0026lt;Button android:layout_width=\u0026#34;150dp\u0026#34; android:layout_height=\u0026#34;150dp\u0026#34; android:layout_alignParentBottom=\u0026#34;true\u0026#34; android:text=\u0026#34;å·¦ä¸‹è§’\u0026#34; android:textSize=\u0026#34;30dp\u0026#34; /\u0026gt; \u0026lt;Button android:layout_width=\u0026#34;150dp\u0026#34; android:layout_height=\u0026#34;150dp\u0026#34; android:layout_alignParentBottom=\u0026#34;true\u0026#34; android:layout_alignParentRight=\u0026#34;true\u0026#34; android:text=\u0026#34;å³ä¸‹è§’\u0026#34; android:textSize=\u0026#34;30dp\u0026#34; /\u0026gt; \u0026lt;Button android:layout_width=\u0026#34;150dp\u0026#34; android:layout_height=\u0026#34;150dp\u0026#34; android:layout_centerInParent=\u0026#34;true\u0026#34; android:text=\u0026#34;ä¸­é—´\u0026#34; android:textSize=\u0026#34;30dp\u0026#34; /\u0026gt; \u0026lt;/RelativeLayout\u0026gt; ConstraintLayout ç‰¹ç‚¹ï¼šå¯ä»¥çµæ´»æ§åˆ¶å­æ§ä»¶çš„ä½ç½®å’Œå¤§å°çš„æ–°å¸ƒå±€æ–¹å¼ã€‚\nè¿™å¼ å›¾å±•ç¤ºäº† ConstraintLayout ç±»åŠå…¶ç›¸å…³å±æ€§å’Œæ–¹æ³•,è®©æˆ‘ä»¬æ·±å…¥äº†è§£å…¶ä½œç”¨:\nConstraintLayout æ˜¯ Android ä¸­ä¸€ç§å¼ºå¤§çš„å¸ƒå±€ç®¡ç†å™¨,å®ƒå…è®¸å¼€å‘è€…é€šè¿‡å®šä¹‰å„è§†å›¾ä¹‹é—´çš„çº¦æŸå…³ç³»æ¥å®ç°å¤æ‚çš„å¸ƒå±€ã€‚\nå±æ€§ layout_constraintX_bias å’Œ layout_constraintCircle ç­‰ç”¨äºæ§åˆ¶è§†å›¾åœ¨çˆ¶å®¹å™¨ä¸­çš„ä½ç½®å’Œæ–¹å‘ã€‚\nlayout_constraintX ç³»åˆ—å±æ€§ç”¨äºå®šä¹‰è§†å›¾é—´çš„å¯¹é½å…³ç³»,å¦‚ layout_constraintLeft_toLeftOfã€layout_constraintRight_toRightOf ç­‰ã€‚\nlayout_constraintDimensionRatio å±æ€§å¯ç”¨äºè®¾ç½®è§†å›¾çš„å®½é«˜æ¯”ã€‚\napp:layout_constrainedWidth/Height å±æ€§æ§åˆ¶è§†å›¾æ˜¯å¦å—çº¦æŸã€‚\nGuidelineLink å’Œ Chain åˆ™æä¾›äº†æ›´å¤æ‚çš„å¸ƒå±€èƒ½åŠ›,å¦‚å°†å¤šä¸ªè§†å›¾ä¸²è”æˆä¸€ä¸ªæ•´ä½“ã€‚\nlayout_goneMargin ç³»åˆ—å±æ€§åˆ™ç”¨äºæ§åˆ¶å½“å…³è”çš„è§†å›¾ä¸å¯è§æ—¶,å…¶ä»–è§†å›¾çš„è¾¹è·ã€‚\næ€»çš„æ¥è¯´,ConstraintLayout æä¾›äº†ä¸°å¯Œçš„å±æ€§å’Œæ–¹æ³•,å…è®¸å¼€å‘è€…ä»¥ç¼–ç¨‹æ–¹å¼å®šä¹‰å¤æ‚çš„è§†å›¾å¸ƒå±€å…³ç³»,éå¸¸é€‚ç”¨äºéœ€è¦çµæ´»ã€åŠ¨æ€å¸ƒå±€çš„åœºæ™¯ã€‚æŒæ¡å¥½è¿™äº›æ¦‚å¿µå¯¹äºå¼€å‘é«˜è´¨é‡çš„ Android åº”ç”¨ç¨‹åºè‡³å…³é‡è¦ã€‚\nç›¸å¯¹å®šä½ è¯´æ˜ï¼šå¦‚ä¸‹å›¾æ‰€ç¤ºï¼ŒTextView2 åœ¨ TextView1 çš„å³è¾¹ï¼ŒTextView3 åœ¨ TextView1 çš„ä¸‹é¢ï¼Œè¿™ä¸ªæ—¶å€™åœ¨å¸ƒå±€æ–‡ä»¶é‡Œé¢åº”è¯¥è¿™æ ·å†™ï¼š\n\u0026lt;TextView android:id=\u0026#34;@+id/TextView1\u0026#34; ... android:text=\u0026#34;TextView1\u0026#34; /\u0026gt; \u0026lt;TextView android:id=\u0026#34;@+id/TextView2\u0026#34; ... app:layout_constraintLeft_toRightOf=\u0026#34;@+id/TextView1\u0026#34; /\u0026gt; \u0026lt;TextView android:id=\u0026#34;@+id/TextView3\u0026#34; ... app:layout_constraintTop_toBottomOf=\u0026#34;@+id/TextView1\u0026#34; /\u0026gt; è§’åº¦å®šä½ è¯´æ˜ï¼šåˆ©ç”¨ ConstraintLayout å®ç°æ›´ä¸ºçµæ´»çš„æ§ä»¶å¸ƒå±€ã€‚\nè§’åº¦å®šä½\nè§’åº¦å®šä½æŒ‡çš„æ˜¯å¯ä»¥ç”¨ä¸€ä¸ªè§’åº¦å’Œä¸€ä¸ªè·ç¦»æ¥çº¦æŸä¸¤ä¸ªç©ºé—´çš„ä¸­å¿ƒã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼š\n\u0026lt;TextView android:id=\u0026#34;@+id/TextView1\u0026#34; android:layout_width=\u0026#34;wrap_content\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; /\u0026gt; \u0026lt;TextView android:id=\u0026#34;@+id/TextView2\u0026#34; android:layout_width=\u0026#34;wrap_content\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; app:layout_constraintCircle=\u0026#34;@+id/TextView1\u0026#34; app:layout_constraintCircleAngle=\u0026#34;120\u0026#34; app:layout_constraintCircleRadius=\u0026#34;150dp\u0026#34; /\u0026gt; çº¦æŸå¸ƒå±€ ä¸Šé¢çš„ä¾‹å­ä¸­çš„ TextView2 ç”¨åˆ°äº† 3 ä¸ªå±æ€§ï¼š\napp:layout_constraintCircle=\u0026#34;@+id/TextView1\u0026#34;ï¼šæŒ‡å®šå‚è€ƒè§†å›¾ TextView1ã€‚\rapp:layout_constraintCircleAngle=\u0026#34;120\u0026#34;ï¼šæŒ‡å®šè§’åº¦ä¸º 120 åº¦ã€‚\rapp:layout_constraintCircleRadius=\u0026#34;150dp\u0026#34;ï¼šæŒ‡å®šè·ç¦»ä¸º 150dpã€‚ å±…ä¸­å’Œåç§»\nåœ¨ RelativeLayout ä¸­ï¼ŒæŠŠæ§ä»¶æ”¾åœ¨å¸ƒå±€ä¸­é—´çš„æ–¹æ³•æ˜¯æŠŠ layout_centerInParent è®¾ä¸º trueï¼Œè€Œåœ¨ ConstraintLayout ä¸­çš„å†™æ³•æ˜¯ï¼š\napp:layout_constraintBottom_toBottomOf=\u0026#34;parent\u0026#34; app:layout_constraintLeft_toLeftOf=\u0026#34;parent\u0026#34; app:layout_constraintRight_toRightOf=\u0026#34;parent\u0026#34; app:layout_constraintTop_toTopOf=\u0026#34;parent\u0026#34; è¿™æ„å‘³ç€æŠŠæ§ä»¶çš„ä¸Šä¸‹å·¦å³çº¦æŸåœ¨å¸ƒå±€çš„ä¸Šä¸‹å·¦å³ï¼Œè¿™æ ·å°±èƒ½æŠŠæ§ä»¶æ”¾åœ¨å¸ƒå±€çš„ä¸­é—´äº†ã€‚åŒç†ï¼ŒRelativeLayout ä¸­çš„æ°´å¹³å±…ä¸­ layout_centerHorizontal ç›¸å½“äºåœ¨ ConstraintLayout çº¦æŸæ§ä»¶çš„å·¦å³ä¸º parent çš„å·¦å³ï¼›RelativeLayout ä¸­çš„å‚ç›´å±…ä¸­ layout_centerVertical ç›¸å½“äºåœ¨ ConstraintLayout çº¦æŸæ§ä»¶çš„ä¸Šä¸‹ä¸º parent çš„ä¸Šä¸‹ã€‚ é“¾\nå¦‚æœä¸¤ä¸ªæˆ–ä»¥ä¸Šæ§ä»¶é€šè¿‡ä¸‹å›¾çš„æ–¹å¼çº¦æŸåœ¨ä¸€èµ·ï¼Œå°±å¯ä»¥è®¤ä¸ºå®ƒä»¬æ˜¯ä¸€æ¡é“¾ï¼ˆå›¾ä¸ºæ¨ªå‘çš„é“¾ï¼Œçºµå‘åŒç†ï¼‰ã€‚\nå¸ƒå±€ä¼˜åŒ–å’ŒåŠ è½½åŸç† æŒæ¡å¸¸ç”¨å¸ƒå±€çš„ç”¨æ³•ã€ç‰¹æ€§ï¼Œèƒ½å®ç°ç®€å•çš„å¸ƒå±€ã€‚ å¸ƒå±€åŠ è½½åŸç†\näº†è§£å¸ƒå±€åŠ è½½è¿‡ç¨‹ï¼Œä¸è¦æ±‚ä¸€å®šæŒæ¡ã€‚ å¸ƒå±€ä¼˜åŒ–\näº†è§£å¸ƒå±€ä¼˜åŒ–çš„æ–¹æ³•ï¼š\nIncludeçš„ç”¨æ³•\rMergeçš„ç”¨æ³•\rViewStubçš„ç”¨æ³•\rçº¦æŸå¸ƒå±€ä»£ç ç¤ºä¾‹\n\u0026lt;TextView android:id=\u0026#34;@+id/TextView1\u0026#34; android:layout_width=\u0026#34;wrap_content\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; app:layout_constraintLeft_toLeftOf=\u0026#34;parent\u0026#34; app:layout_constraintRight_toLeftOf=\u0026#34;@id/TextView2\u0026#34; /\u0026gt; \u0026lt;TextView android:id=\u0026#34;@+id/TextView2\u0026#34; android:layout_width=\u0026#34;wrap_content\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; app:layout_constraintLeft_toRightOf=\u0026#34;@id/TextView1\u0026#34; app:layout_constraintRight_toLeftOf=\u0026#34;@id/TextView3\u0026#34; app:layout_constraintRight_toRightOf=\u0026#34;parent\u0026#34; /\u0026gt; \u0026lt;TextView android:id=\u0026#34;@+id/TextView3\u0026#34; android:layout_width=\u0026#34;wrap_content\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; app:layout_constraintLeft_toRightOf=\u0026#34;@id/TextView2\u0026#34; app:layout_constraintRight_toRightOf=\u0026#34;parent\u0026#34; /\u0026gt; è¯´æ˜\nTextView1 å·¦è¾¹çº¦æŸåœ¨çˆ¶å¸ƒå±€å·¦è¾¹ï¼Œå³è¾¹çº¦æŸåœ¨ TextView2 å·¦è¾¹ã€‚ TextView2 å·¦è¾¹çº¦æŸåœ¨ TextView1 å³è¾¹ï¼Œå³è¾¹çº¦æŸåœ¨ TextView3 å·¦è¾¹ï¼ŒåŒæ—¶å³è¾¹çº¦æŸåœ¨çˆ¶å¸ƒå±€å³è¾¹ã€‚ TextView3 å·¦è¾¹çº¦æŸåœ¨ TextView2 å³è¾¹ï¼Œå³è¾¹çº¦æŸåœ¨çˆ¶å¸ƒå±€å³è¾¹ã€‚\né€šè¿‡è¿™ç§æ–¹å¼ï¼Œå¯ä»¥å®ç°å¤šä¸ªæ§ä»¶ä¹‹é—´çš„ç›¸å¯¹ä½ç½®çº¦æŸï¼Œä½¿å¾—å®ƒä»¬åœ¨å¸ƒå±€ä¸­ä¿æŒä¸€è‡´çš„æ’åˆ—å’Œé—´è·ã€‚\nViewStub è¿‡åº¦ç»˜åˆ¶ï¼ˆOverdraw) ä½œä¸š è¿›ç¨‹å’Œè¿›ç¨‹ä¹‹é—´æ•°æ®æ˜¯éš”ç¦»çš„ã€‚è·‘å¤šä¸ªçº¿ç¨‹\n","permalink":"https://kennems.github.io/posts/tech/%E7%AC%AC%E4%BA%94%E5%A4%A9%E7%AC%94%E8%AE%B0/","summary":"ç¬¬äº”å¤©ç¬”è®° Android å¸ƒå±€ä¸ä¼˜åŒ– åŸºæœ¬å¸ƒå±€ å…¬å…±å±æ€§ å¸ƒå±€ç±»å‹ å…±æœ‰å±æ€§ layout_gravity: æ§ä»¶ç›¸å¯¹äºçˆ¶æ§ä»¶çš„å¯¹é½æ–¹å¼ gravity: æ§ä»¶å†…éƒ¨çš„å¯¹é½æ–¹å¼ padding: å†…é—´è· paddingTop: ä¸Šé—´è· paddingBottom: ä¸‹é—´è· paddingLeft: å·¦é—´è·~ paddingRight: å³","title":"è®­ç»ƒè¥ç¬¬äº”å¤©å­¦ä¹ ç¬”è®°"},{"content":"ç¬¬ä¸‰å¤©ç¬”è®° Fragment é‡ç‚¹çŸ¥è¯†æ€»ç»“ 1. fragmentèƒŒæ™¯ Fragmentçš„è¯ç”Ÿ å¼•å…¥ç‰ˆæœ¬: Android 3.0 (API 11)\nèƒŒæ™¯å’Œç›®çš„:\nåˆè¡·æ˜¯ä¸ºäº†é€‚åº”å¤§å±å¹•çš„å¹³æ¿ç”µè„‘ï¼Œç”±äºå¹³æ¿ç”µè„‘çš„å±å¹•æ¯”æ‰‹æœºå±å¹•æ›´å¤§ï¼Œå› æ­¤å¯ä»¥å®¹çº³æ›´å¤šçš„UIç»„ä»¶ï¼Œä¸”è¿™äº›UIç»„ä»¶ä¹‹é—´å­˜åœ¨äº¤äº’å…³ç³»ã€‚\nä½¿ç”¨Fragmentå¯¹UIç»„ä»¶è¿›è¡Œåˆ†ç»„ã€æ¨¡å—åŒ–ç®¡ç†ï¼Œå°±å¯ä»¥æ›´æ–¹ä¾¿åœ°åœ¨è¿è¡Œè¿‡ç¨‹ä¸­åŠ¨æ€æ›´æ–°Activityçš„ç”¨æˆ·ç•Œé¢ã€‚ ä½œä¸ºä¸€ä¸ªå¾®å‹Activityè€Œè¯ç”Ÿï¼Œè¿ˆå‡ºäº†ç¼©å‡Activityä¹‹è·¯ä¸Šçš„ä¸€æ­¥ã€‚\n2. åˆ›å»ºfragment æ·»åŠ Fragmentä¾èµ– Fragmentéœ€è¦ä¾èµ–äºAndroidX Fragmentåº“ï¼š æ·»åŠ Google Mavenä»£ç åº“ï¼Œå¹¶åœ¨build.gradleä¸­æ·»åŠ æ­¤ä¾èµ–é¡¹ã€‚ dependencyResolutionManagement { repositoriesMode.set(RepositoriesMode.FAIL_ON_PROJECT_REPOS) repositories { google() } } dependencies { def fragment_version = \u0026#34;1.5.5\u0026#34; // Java language implementation implementation \u0026#34;androidx.fragment:fragment:$fragment_version\u0026#34; // Kotlin implementation \u0026#34;androidx.fragment:fragment-ktx:$fragment_version\u0026#34; } æŸ¥çœ‹gradleç‰ˆæœ¬ä¾èµ–ï¼š\n./gradlew app:dependencies åˆ›å»ºFragment åœ¨res/layoutæ–‡ä»¶å¤¹ä¸‹ï¼Œåˆ›å»ºexample_fragment.xmlå¸ƒå±€æ–‡ä»¶ï¼š \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;LinearLayout xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34; android:orientation=\u0026#34;vertical\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34;\u0026gt; \u0026lt;TextView android:layout_width=\u0026#34;wrap_content\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:text=\u0026#34;Fragment View\u0026#34;/\u0026gt; \u0026lt;/LinearLayout\u0026gt; åˆ›å»ºExampleFragmentç±»ï¼Œç»§æ‰¿Fragmentç±»ï¼Œå¹¶å‘åŸºæœ¬æ„é€ å‡½æ•°æä¾›Fragmentçš„å¸ƒå±€èµ„æºï¼š class ExampleFragment extends Fragment { public ExampleFragment() { super(R.layout.example_fragment); } } Fragment äº‹åŠ¡æ“ä½œ add å’Œ replace æ“ä½œ add: ä¸ä¼šåˆ é™¤å®¹å™¨å†…å·²å­˜åœ¨çš„Fragment åŸFragmentç”Ÿå‘½å‘¨æœŸä¸å—å½±å“ åŸFragmentä¼šè¢«ä¿å­˜å’Œè‡ªåŠ¨æ¢å¤ å†…å­˜å ç”¨å¤š æ­é…hide/showä½¿ç”¨ replace: åˆ é™¤å®¹å™¨å†…å·²å­˜åœ¨çš„Fragment åŸFragmentè¢«é”€æ¯ åŸFragmentçŠ¶æ€æ— æ³•æ¢å¤ å†…å­˜å ç”¨å°‘ äº‹åŠ¡commitçš„å‡ ç§æ–¹å¼ æ–¹æ³• è¯´æ˜ commit éç«‹å³æ‰§è¡Œï¼Œå°†æ¶ˆæ¯å‘é€åˆ°ä¸»çº¿ç¨‹é˜Ÿåˆ—ç­‰å¾…æ‰§è¡Œã€‚éœ€è¦ç«‹å³æ‰§è¡Œæ—¶é…åˆexecutePendingTransactionså°†é˜Ÿåˆ—ä¸­æ‰€æœ‰äº‹åŠ¡å…¨éƒ¨æ‰§è¡Œã€‚ commitNow ç«‹åˆ»ä»…æ‰§è¡Œå½“å‰äº‹åŠ¡ï¼Œä¸èƒ½ä¸addToBackStackåŒæ—¶ä½¿ç”¨ã€‚ commitAllowingStateLoss onDestroyæ—¶æäº¤ä¸å†æŠ›å‡ºIllegalStateExceptionï¼Œè€Œæ˜¯ä¸¢å¼ƒæäº¤çš„Fragmentã€‚ commitNowAllowingStateLoss ç«‹åˆ»æ‰§è¡Œå¹¶å…è®¸çŠ¶æ€ä¸¢å¤±ã€‚ \u0026lt;!-- android:label=\u0026#34;@string/app_name\u0026#34;--\u0026gt; éšå ‚ç»ƒä¹ \nç›®æ ‡ï¼š æŒæ¡Fragmentç”Ÿå‘½å‘¨æœŸçš„æ‰§è¡Œè¿‡ç¨‹\nTodo List:\nåœ¨MainActivityã€DemoFragmentå’ŒDemoFragment2ç”Ÿå‘½å‘¨æœŸå„æ–¹æ³•ä¸­æ·»åŠ æ—¥å¿— åˆ†æå¯åŠ¨å¹¶æ·»åŠ DemoFragmentæ—¶çš„ç”Ÿå‘½å‘¨æœŸæ—¥å¿— åˆ†ææŒ‰ä¸‹Homeé”®åçš„ç”Ÿå‘½å‘¨æœŸæ—¥å¿— åˆ†æä½¿ç”¨addä¸replaceæ˜¾ç¤ºDemoFragment2æ—¶ç”Ÿå‘½å‘¨æœŸæ—¥å¿—å·®å¼‚ åˆ†ææŒ‰ä¸‹è¿”å›é”®åçš„ç”Ÿå‘½å‘¨æœŸæ—¥å¿— Fragmenté€šä¿¡ æ¯ä¸ªFragmentåº”ä¸ºå®Œå…¨ç‹¬ç«‹çš„æ¨¡å—åŒ–ç»„ä»¶ï¼Œå®šä¹‰å®ƒè‡ªå·±çš„å¸ƒå±€å’Œè¡Œä¸º ä¸¤ä¸ªFragmentä¸èƒ½ç›´æ¥é€šä¿¡ é€šä¿¡æ–¹å¼ï¼š\nä¸Activityé€šä¿¡\nå¤–éƒ¨å¯¹å¤–publicæ–¹æ³•\nFragment Result API\nFragmentåŠ¨ç”» å¯ä»¥ä½¿ç”¨æŒ‰é’®å®ç°\né‡ç‚¹ï¼šActivity BroadCastReceiver Fragment\n","permalink":"https://kennems.github.io/posts/tech/%E7%AC%AC%E4%B8%89%E5%A4%A9%E7%AC%94%E8%AE%B0/","summary":"ç¬¬ä¸‰å¤©ç¬”è®° Fragment é‡ç‚¹çŸ¥è¯†æ€»ç»“ 1. fragmentèƒŒæ™¯ Fragmentçš„è¯ç”Ÿ å¼•å…¥ç‰ˆæœ¬: Android 3.0 (API 11) èƒŒæ™¯å’Œç›®çš„: åˆè¡·æ˜¯ä¸ºäº†é€‚åº”å¤§å±å¹•çš„å¹³æ¿ç”µè„‘ï¼Œç”±äºå¹³æ¿ç”µ","title":"è®­ç»ƒè¥ç¬¬ä¸‰å¤©å­¦ä¹ ç¬”è®°"},{"content":"ç¬¬äºŒå¤©ç¬”è®° Android å››å¤§ç»„ä»¶è¯¾ç¨‹æ¦‚è¦æ€»ç»“ 1. Activity a. åˆ›å»º\nè‡ªåŠ¨åˆ›å»º åœ¨æ–°å»ºé¡¹ç›®åï¼Œä¼šè‡ªåŠ¨ä¸ºæˆ‘ä»¬åˆ›å»ºä¸€ä¸ª MainActivityã€‚Activity ç»„æˆéƒ¨åˆ†å¦‚ä¸‹ï¼š ç»§æ‰¿è‡ª Activity çš„ç±» æ”¾åœ¨ res/layout æ–‡ä»¶å¤¹çš„å¸ƒå±€ XML æ–‡ä»¶ åœ¨ AndroidManifest.xml æ–‡ä»¶ä¸­å£°æ˜ b. Activity ç”Ÿå‘½å‘¨æœŸå›è°ƒæ–¹æ³•\nActivity ç”Ÿå‘½å‘¨æœŸæ–¹æ³•\nonCreate(): æ˜¯ - å®ƒä¼šåœ¨ç³»ç»Ÿåˆ›å»ºæ‚¨çš„ Activity æ—¶è¢«å”¤èµ·ã€‚å¿…é¡»åœ¨æ­¤ç±»ä¸­è°ƒç”¨ setContentView() æ¥å®šä¹‰ Activity çš„å¸ƒå±€ã€‚ onStart(): å¦ - onCreate å®Œæˆåï¼ŒActivity å°†è¿›å…¥å·²å¯åŠ¨çŠ¶æ€ï¼Œå¹¶å¯¹ç”¨æˆ·å¯è§ã€‚æ­¤å›è°ƒé€šå¸¸ä¼šåœ¨ Activity è¿›å…¥å‰å°ä¸ç”¨æˆ·äº’åŠ¨ä¹‹å‰çš„æœ€åå‡†å¤‡å·¥ä½œã€‚ onResume(): å¦ - ç³»ç»Ÿä¼šåœ¨ Activity å¼€å§‹ä¸ç”¨æˆ·äº’åŠ¨ä¹‹å‰è°ƒç”¨æ­¤å›è°ƒã€‚æ­¤æ—¶ï¼ŒActivity ä½äº Activity å †æ ˆçš„é¡¶éƒ¨ï¼Œå¹¶è·å–æ‰€æœ‰ç”¨æˆ·è¾“å…¥ã€‚ onPause(): å¦ - å½“ Activity å¤±ç„¦ç‚¹å¹¶è¿›å…¥â€œæš‚åœâ€çŠ¶æ€æ—¶ï¼Œç³»ç»Ÿä¼šè°ƒç”¨ onPause()ã€‚ onStop(): å¦ - å½“ Activity å¯¹ç”¨æˆ·ä¸å¯è§æ—¶ï¼Œç³»ç»Ÿä¼šè°ƒç”¨ onStop()ã€‚å‡ºç°è¿™ç§æƒ…å†µçš„åŸå› å¯èƒ½æ˜¯æ–°æ´»åŠ¨å¯åŠ¨ã€ç°æœ‰ Activity è¿”å›å‰å°ï¼Œæˆ–é”€æ¯æ—§çš„ Activity æ­£åœ¨è¿›å…¥å®ƒâ€œåœæ­¢â€çŠ¶æ€ä¹‹å‰å³å°†ç»ˆæ­¢çš„ Activityã€‚ onRestart(): å¦ - å½“ç”¨æˆ·å·²ä¸­æ–­çš„ Activity ç›´æ¥é‡æ–°å¯åŠ¨æ—¶ï¼Œç³»ç»Ÿä¼šè°ƒç”¨ onRestart()ã€‚ onDestroy(): å¦ - ç³»ç»Ÿä¼šåœ¨é”€æ¯ Activity ä¹‹å‰è°ƒç”¨æ­¤å›è°ƒã€‚Activity è¢«é”€æ¯çš„æœ€åä¸€ä¸ªå›è°ƒ onDestroy() æ˜¯ Activity è¿›è¡Œæ¸…ç†å·¥ä½œå’Œé‡Šæ”¾æ‰€æœ‰èµ„æºçš„æœ€åæœºä¼šã€‚ Activity ç†è§£ç”Ÿå‘½å‘¨æœŸ\né€šè¿‡ç”Ÿå‘½å‘¨æœŸæ‰§è¡Œé¡ºåºç®€åŒ–å›¾äº†è§£ç”Ÿå‘½å‘¨æœŸçš„å„ä¸ªé˜¶æ®µã€‚ c. Activity çš„å››ç§å¯åŠ¨æ–¹å¼\ni. é€šè¿‡å¦‚ä¸‹å‘½ä»¤æŸ¥çœ‹è¯¦ç»†çš„ Activity ä»»åŠ¡æ ˆä¿¡æ¯ï¼šadb shell dumpsys activity activities\nè¿™ä»½æ€»ç»“æ¶µç›–äº† Activity çš„åˆ›å»ºã€ç”Ÿå‘½å‘¨æœŸæ–¹æ³•åŠå…¶ç†è§£ã€ä»¥åŠå¯åŠ¨æ–¹å¼çš„æ¦‚è¿°ã€‚å¸Œæœ›è¿™äº›å†…å®¹å¯¹æ‚¨çš„å­¦ä¹ æœ‰å¸®åŠ©ï¼\nABé¡µé¢è·³è½¬ï¼š // æ™®é€šæ ·å¼\rA.onPause\rB.onCreate\rB.onStart\rB.onResume\rA.stop\r// Bæ˜¯é€æ˜æˆ–è€…dialogæ ·å¼\rA.onPause\rB.onCreate\rB.onStart\rB.onResume\r// Bé¡µé¢å…³é—­é‡æ–°å›åˆ°Aé¡µé¢\rB.onPause\rA.onRestart\rA.onStart\rA.onResume\rB.onStop\rB.onDestory å¯åŠ¨æ¨¡å¼ä¸é¿å‘æŒ‡å—ç¬”è®° å®šä¹‰å¯åŠ¨æ¨¡å¼ å¯ä»¥é€šè¿‡å¯åŠ¨æ¨¡å¼å®šä¹‰Activityçš„æ–°å®ä¾‹å¦‚ä½•ä¸å½“å‰ä»»åŠ¡å…³è”ï¼š\nAndroidManifest.xmlä¸­å£°æ˜\n\u0026lt;activity android:name=\u0026#34;.YourActivity\u0026#34; android:launchMode=\u0026#34;singleTask\u0026#34; /\u0026gt; å¯åŠ¨æ¨¡å¼ä»‹ç» å±æ€§å€¼ å¯¹åº” flags æè¿° standard \u0026ndash; é»˜è®¤æ¨¡å¼ã€‚ç³»ç»Ÿåœ¨å¯åŠ¨Activityçš„ä»»åŠ¡ä¸­åˆ›å»ºæ–°å®ä¾‹ï¼Œå¹¶å°†intentä¼ é€’ç»™è¯¥å®ä¾‹ã€‚æ¯ä¸ªå®ä¾‹å¯ä»¥å±äºä¸åŒçš„ä»»åŠ¡ã€‚ singleTop FLAG_ACTIVITY_SINGLE_TOP å¦‚æœå½“å‰ä»»åŠ¡çš„é¡¶éƒ¨å·²æœ‰è¯¥Activityå®ä¾‹ï¼Œç³»ç»Ÿè°ƒç”¨onNewIntent()æ–¹æ³•ä¼ é€’intentç»™è¯¥å®ä¾‹ï¼Œè€Œä¸æ˜¯åˆ›å»ºæ–°å®ä¾‹ã€‚ singleTask FLAG_ACTIVITY_NEW_TASK ç³»ç»Ÿä¼šåˆ›å»ºæ–°ä»»åŠ¡ï¼Œå¹¶å®ä¾‹åŒ–æ–°çš„Activityã€‚å¦‚æœä»»åŠ¡ä¸­å·²æœ‰è¯¥Activityå®ä¾‹ï¼Œåˆ™è°ƒç”¨onNewIntent()æ–¹æ³•ä¼ é€’intentï¼Œè€Œä¸æ˜¯åˆ›å»ºæ–°å®ä¾‹ã€‚ singleInstance \u0026ndash; ä¸singleTaskç›¸ä¼¼ï¼Œå”¯ä¸€ä¸åŒæ˜¯è¯¥æ¨¡å¼ä¸‹çš„Activityåœ¨å¯åŠ¨æ—¶ä¼šç‹¬å ä¸€ä¸ªä»»åŠ¡æ ˆï¼Œä¸”ä¸ä¼šä¸å…¶ä»–Activityå…±äº«ã€‚ standard : ä¸ç®¡æ€æ ·éƒ½ä¼šæ–°å»ºactivity singleTopï¼šå¦‚æœç›®æ ‡åœ¨ä»»åŠ¡æ ˆçš„æ ˆé¡¶ï¼Œé‚£ä¹ˆç›´æ¥å¤ç”¨å®ä¾‹ï¼Œè§¦å‘ç›®æ ‡activityçš„onNewIntentæ–¹æ³•ï¼Œ å¦‚æœç›®æ ‡ä»»åŠ¡ä¸åœ¨ä»»åŠ¡æ ˆçš„æ ˆé¡¶ï¼Œé‚£ä¹ˆæ–°å»ºä¸€ä¸ªç›®æ ‡å®ä¾‹ï¼Œæ·»åŠ åˆ°ä»»åŠ¡æ ˆ singleTaskï¼šå¦‚æœä»»åŠ¡æ ˆå†…æ²¡æœ‰ç›®æ ‡å®ä¾‹ï¼Œåˆ™ç›´æ¥åˆ›å»ºæ–°çš„ç›®æ ‡å®ä¾‹åˆ°ä»»åŠ¡æ ˆï¼Œå¦‚æœæœ‰ï¼Œåˆ™ç›´æ¥æŠŠç›®æ ‡activityä¸Šé¢æ‰€æœ‰çš„activityéƒ½ç§»å‡ºæ ˆï¼ŒæŠŠç›®æ ‡activityç½®äºæ ˆé¡¶ã€‚ singleInstanceï¼š è®¾ç½®singleInstance åœ¨ Android ä¸­ï¼Œå¦‚æœä½ å¸Œæœ›ä¸€ä¸ª Activity é‡‡ç”¨ singleInstance å¯åŠ¨æ¨¡å¼ï¼Œéœ€è¦åœ¨ AndroidManifest.xml æ–‡ä»¶ä¸­ä¸ºè¯¥ Activity è®¾ç½®ç›¸åº”çš„ launchMode å±æ€§ã€‚æ­¤å¤–ï¼Œä½ è¿˜å¯ä»¥é€šè¿‡ Intent è®¾ç½® Flags æ¥æ§åˆ¶ Activity çš„å¯åŠ¨è¡Œä¸ºã€‚\nåœ¨ AndroidManifest.xml ä¸­è®¾ç½® singleInstance åœ¨ AndroidManifest.xml æ–‡ä»¶ä¸­ä¸ºç›®æ ‡ Activity æ·»åŠ  launchMode å±æ€§ï¼Œå¹¶å°†å…¶å€¼è®¾ç½®ä¸º singleInstanceï¼š\n\u0026lt;activity android:name=\u0026#34;.YourActivity\u0026#34; android:launchMode=\u0026#34;singleInstance\u0026#34;\u0026gt; \u0026lt;/activity\u0026gt; é€šè¿‡ Intent è®¾ç½® Flags å½“ä½ å¯åŠ¨ä¸€ä¸ª Activity æ—¶ï¼Œå¯ä»¥é€šè¿‡è®¾ç½® Intent Flags æ¥å½±å“ Activity çš„å¯åŠ¨è¡Œä¸ºã€‚å¸¸è§çš„ Flags åŒ…æ‹¬ï¼š\nFLAG_ACTIVITY_NEW_TASK: å¦‚æœ Activity ä¸å­˜åœ¨äºå½“å‰ä»»åŠ¡ä¸­ï¼Œå°†å¯åŠ¨ä¸€ä¸ªæ–°çš„ä»»åŠ¡å¹¶å°† Activity æ”¾ç½®åœ¨è¯¥ä»»åŠ¡çš„æ ¹ä¸Šã€‚ FLAG_ACTIVITY_CLEAR_TOP: å¦‚æœ Activity å·²å­˜åœ¨äºä»»åŠ¡ä¸­ï¼Œå°†æ¸…é™¤å…¶ä¸Šçš„æ‰€æœ‰ Activityï¼Œå¹¶å°†å…¶ç½®äºé¡¶éƒ¨ã€‚ ä¸‹é¢æ˜¯ä¸€ä¸ªç¤ºä¾‹ä»£ç ï¼Œå±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ Intent å¯åŠ¨ singleInstance æ¨¡å¼çš„ Activity å¹¶è®¾ç½® Flagsï¼š\nIntent intent = new Intent(this, YourActivity.class); intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK | Intent.FLAG_ACTIVITY_CLEAR_TOP); startActivity(intent); ç»“åˆä½¿ç”¨ singleInstance å’Œ Intent Flags ç»“åˆä¸Šè¿°æ–¹æ³•ï¼Œç¡®ä¿åœ¨ AndroidManifest.xml ä¸­æ­£ç¡®é…ç½® singleInstance æ¨¡å¼ï¼Œå¹¶åœ¨å¯åŠ¨ Activity æ—¶è®¾ç½®åˆé€‚çš„ Flagsã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªå®Œæ•´çš„ç¤ºä¾‹ï¼š\n1. åœ¨ AndroidManifest.xml ä¸­é…ç½®ï¼š \u0026lt;activity android:name=\u0026#34;.YourActivity\u0026#34; android:launchMode=\u0026#34;singleInstance\u0026#34;\u0026gt; \u0026lt;/activity\u0026gt; 2. åœ¨ä»£ç ä¸­å¯åŠ¨ Activity å¹¶è®¾ç½® Flagsï¼š Intent intent = new Intent(this, YourActivity.class); intent.setFlags(Intent.FLAG_ACTrIVITY_NEW_TASK | Intent.FLAG_ACTIVITY_CLEAR_TOP); startActivity(intent); é€šè¿‡è¿™ç§æ–¹å¼ï¼Œä½ å¯ä»¥ç¡®ä¿ç›®æ ‡ Activity ä»¥ singleInstance æ¨¡å¼å¯åŠ¨ï¼Œå¹¶æ ¹æ®éœ€è¦è®¾ç½®ç›¸åº”çš„ Flags æ¥æ§åˆ¶å…¶å¯åŠ¨è¡Œä¸ºã€‚\nIntentä¸¤ç§å¯åŠ¨æ–¹å¼ æ˜¾å¼ Intent éšå¼ Intent Activity é¿å‘æŒ‡å— èµ„æºå›æ”¶ï¼šåœ¨Activityçš„ç”Ÿå‘½å‘¨æœŸç»“æŸæ—¶ï¼Œç¡®ä¿é‡Šæ”¾èµ„æºã€å–æ¶ˆç½‘ç»œè¯·æ±‚ã€æ³¨é”€ç›‘å¬å™¨ç­‰æ“ä½œï¼Œä»¥é˜²æ­¢å†…å­˜æ³„æ¼ã€‚ å†…å­˜æ³„æ¼ï¼šé¿å…åœ¨Activityä¸­å¼•ç”¨é•¿ç”Ÿå‘½å‘¨æœŸå¯¹è±¡ï¼Œä½¿ç”¨å¼±å¼•ç”¨æˆ–åœ¨é€‚å½“çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ä¸­é‡Šæ”¾èµ„æºã€‚ Context ä½¿ç”¨ï¼šè°¨æ…ä½¿ç”¨Contextï¼Œé¿å…æŒæœ‰Activityçš„å¼•ç”¨ï¼Œä»¥å…å¼•å‘å†…å­˜æ³„æ¼ã€‚å°½é‡ä½¿ç”¨Applicationçš„Contextã€‚ ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼šç†è§£Activityçš„ç”Ÿå‘½å‘¨æœŸå¹¶æ­£ç¡®åœ°ç®¡ç†èµ„æºã€‚ç¡®ä¿åœ¨onPauseã€onStopã€onDestroyç­‰ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ä¸­é‡Šæ”¾èµ„æºå’Œå–æ¶ˆæ³¨å†Œç›‘å¬å™¨ã€‚ æ¨ªç«–å±åˆ‡æ¢ï¼šå½“æ¨ªç«–å±åˆ‡æ¢æ—¶ï¼ŒActivityä¼šé”€æ¯å¹¶é‡æ–°åˆ›å»ºã€‚ç¡®ä¿åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ä¿å­˜å’Œæ¢å¤å¿…è¦çš„çŠ¶æ€ä¿¡æ¯ï¼Œä»¥é˜²æ­¢ç”¨æˆ·ä½“éªŒçš„ä¸­æ–­ã€‚ Activity-Serviceä¸¤ç§å¯åŠ¨æ–¹å¼åŠå…³é”®æ–¹æ³•å›è°ƒï¼ˆstart bindï¼‰ Serviceåˆ›å»º Serviceçš„åˆ›å»ºåŒ…æ‹¬ä¸¤éƒ¨åˆ†ï¼š\næ–°å»ºç±»éœ€è¦ç»§æ‰¿ Service åœ¨ AndroidManifest.xml æ–‡ä»¶ä¸­è¿›è¡Œå£°æ˜ ç¤ºä¾‹ä»£ç ï¼š\n\u0026lt;service android:name=\u0026#34;.service.FirstService\u0026#34; android:enabled=\u0026#34;true\u0026#34; android:exported=\u0026#34;true\u0026#34;\u0026gt; \u0026lt;/service\u0026gt; å¯åŠ¨å’Œåœæ­¢æœåŠ¡ æ–¹æ³• æè¿° startService() å¯åŠ¨æœåŠ¡ startForegroundService() å¯åŠ¨å‰å°æœåŠ¡ stopService()ã€stopSelf() åœæ­¢æœåŠ¡ å¯åŠ¨æœåŠ¡çš„ç”Ÿå‘½å‘¨æœŸ æ–¹æ³• æè¿° onCreate() é¦–æ¬¡åˆ›å»ºæœåŠ¡æ—¶ï¼Œç³»ç»Ÿä¼šï¼ˆåœ¨è°ƒç”¨ onStartCommand() æˆ– onBind() ä¹‹å‰ï¼‰è°ƒç”¨æ­¤æ–¹æ³•æ¥æ‰§è¡Œä¸€æ¬¡æ€§è®¾ç½®ç¨‹åºã€‚å¦‚æœæœåŠ¡å·²åœ¨è¿è¡Œï¼Œåˆ™ä¸ä¼šè°ƒç”¨æ­¤æ–¹æ³•ã€‚ onStartCommand() é€šè¿‡ startService() æ–¹æ³•å¯åŠ¨ Service æ—¶è°ƒç”¨æ­¤æ–¹æ³•ï¼Œæ‰§è¡Œæ­¤æ–¹æ³•æ—¶ï¼ŒæœåŠ¡å³ä¼šå¯åŠ¨å¹¶å¯åœ¨åå°æ— é™æœŸè¿è¡Œã€‚ onDestroy() å½“ä¸å†ä½¿ç”¨æœåŠ¡ä¸”å‡†å¤‡é”€æ¯æ—¶ï¼Œç³»ç»Ÿä¼šè°ƒç”¨æ­¤æ–¹æ³•ã€‚ æœåŠ¡ç”Ÿå‘½å‘¨æœŸç¤ºæ„å›¾ Call to startService() â†“ onCreate() â†“ onStartCommand() â†“ Service running â†“ onDestroy() â†“ Service shut down Serviceçš„å¯åŠ¨ä¸ç»‘å®š ä¸€ã€å¯åŠ¨å’Œåœæ­¢æœåŠ¡ Serviceåˆ›å»º æ–°å»ºç±»ç»§æ‰¿ Service\nåœ¨ AndroidManifest.xml æ–‡ä»¶ä¸­å£°æ˜\n\u0026lt;service android:name=\u0026#34;.service.FirstService\u0026#34; android:enabled=\u0026#34;true\u0026#34; android:exported=\u0026#34;true\u0026#34;\u0026gt; \u0026lt;/service\u0026gt; å¯åŠ¨å’Œåœæ­¢æœåŠ¡æ–¹æ³• æ–¹æ³• æè¿° startService() å¯åŠ¨æœåŠ¡ startForegroundService() å¯åŠ¨å‰å°æœåŠ¡ stopService()ã€stopSelf() åœæ­¢æœåŠ¡ å¯åŠ¨æœåŠ¡çš„ç”Ÿå‘½å‘¨æœŸ æ–¹æ³• æè¿° onCreate() é¦–æ¬¡åˆ›å»ºæœåŠ¡æ—¶è°ƒç”¨ï¼Œç”¨äºä¸€æ¬¡æ€§è®¾ç½®ç¨‹åºã€‚å¦‚æœæœåŠ¡å·²åœ¨è¿è¡Œï¼Œåˆ™ä¸ä¼šè°ƒç”¨æ­¤æ–¹æ³•ã€‚ onStartCommand() é€šè¿‡ startService() æ–¹æ³•å¯åŠ¨ Service æ—¶è°ƒç”¨æ­¤æ–¹æ³•ã€‚ onDestroy() æœåŠ¡ä¸å†ä½¿ç”¨ä¸”å‡†å¤‡é”€æ¯æ—¶è°ƒç”¨ã€‚ æœåŠ¡ç”Ÿå‘½å‘¨æœŸç¤ºæ„å›¾ Call to startService()\râ†“\ronCreate()\râ†“\ronStartCommand()\râ†“\rService running\râ†“\ronDestroy()\râ†“\rService shut down äºŒã€ç»‘å®šå’Œè§£ç»‘æœåŠ¡ ç»‘å®šå’Œè§£ç»‘æ–¹æ³• æ–¹æ³• æè¿° bindService() ç»‘å®šæœåŠ¡ unbindService() è§£ç»‘æœåŠ¡ ç»‘å®šæœåŠ¡çš„ç”Ÿå‘½å‘¨æœŸ æ–¹æ³• æè¿° onCreate() é¦–æ¬¡åˆ›å»ºæœåŠ¡æ—¶ç³»ç»Ÿè°ƒç”¨ï¼ˆåœ¨è°ƒç”¨ onStartCommand() æˆ– onBind() ä¹‹å‰ï¼‰ã€‚ onBind() é€šè¿‡ bindService() å¯åŠ¨ Service æ—¶è°ƒç”¨ï¼Œè¿”å› IBinder æ¥å£ä¾›å®¢æˆ·ç«¯ä¸æœåŠ¡é€šä¿¡ã€‚ onUnbind() æ‰€æœ‰å®¢æˆ·ç«¯é€šè¿‡ unbindService() è§£ç»‘æ—¶è°ƒç”¨ã€‚ onDestroy() æœåŠ¡ä¸å†ä½¿ç”¨ä¸”å‡†å¤‡é”€æ¯æ—¶ç³»ç»Ÿè°ƒç”¨ã€‚ unbindService() è§£ç»‘æœåŠ¡ã€‚ ç»‘å®šæœåŠ¡ç”Ÿå‘½å‘¨æœŸç¤ºæ„å›¾ Call to bindService()\râ†“\ronCreate()\râ†“\ronBind()\râ†“\rClients are bound to service\râ†“\rAll clients unbind by calling unbindService()\râ†“\ronUnbind()\râ†“\ronDestroy()\râ†“\rService shut down ä¸‰ã€å…¶ä»–æ¦‚å¿µ å¹¿æ’­ å®ç°æ–¹å¼ï¼šä½¿ç”¨ IntentService ä»£ç å®ç°ã€‚ å¹¿æ’­å›è°ƒï¼šä¸¤ç§å®ç°æ–¹å¼ã€‚ ContentProvider ç†è§£åŸç†ï¼šæŒæ¡ ContentProvider çš„å·¥ä½œæœºåˆ¶å’Œä½¿ç”¨æ–¹æ³•ã€‚ è·¨è¿›ç¨‹å®ç°æ–¹å¼ Messenger å’Œ AIDLï¼šä½¿ç”¨ Messenger å’Œ AIDL å®ç°è·¨è¿›ç¨‹é€šä¿¡ã€‚ æ€»ç»“ activity: ç”Ÿå‘½å‘¨æœŸï¼šonCreate/onStart/onResume/onPause/onStop/onDestroy å…¶ä¸­ onStartï¼šå¯è§ï¼Œä¸å¯äº¤äº’ onResume:å¯è§ï¼Œå¯äº¤äº’ onPauseï¼šå¯è§ã€ä¸å¯äº¤äº’ onStop:ä¸å¯è§ï¼Œä¸å¯äº¤äº’ onCreate - onDestroy onStart - onStop onResume - onPause åœºæ™¯1ï¼šç›´æ¥Aè·³è½¬B A.onpause B.oncreate B.onstart B.onresume A.stop åœºæ™¯2: Aè·³Bï¼Œä½†æ˜¯Bæ˜¯é€æ˜çš„ or dialogæ ·å¼çš„ A.onpause B.oncreate B.onstart B.onresume åœºæ™¯3ï¼š Bé¡µé¢å…³é—­ï¼Œé‡æ–°å›åˆ°Aé¡µé¢ B.onpause A.onrestart A.onstart A.onReusme B.onstop B.ondestroy activityä¸‰å¤§è¦ç´  1ï¼š åˆ›å»ºä¸€ä¸ªæ–°çš„activityï¼Œç»§æ‰¿è‡ªç³»ç»Ÿçš„AppCompatActivity 2ï¼š res/layoutæ–‡ä»¶å¤¹ä¸­åˆ›å»ºå¯¹åº”çš„xmlå¸ƒå±€æ–‡ä»¶ 3ï¼š activity ä¸ layoutçš„ç»“åˆï¼Œåœ¨activity.onCreateçš„setContentViewï¼ˆR.layout.xxxï¼‰ 4. æ¸…å•æ–‡ä»¶ä¸­androidManifastå¿…é¡»è¦å£°æ˜ç»„ä»¶activity å¯åŠ¨æ¨¡å¼ standard : ä¸ç®¡æ€ä¹ˆæ ·ï¼Œéƒ½ä¼šæ–°å»ºä¸€ä¸ªç›®æ ‡activityçš„ç¤ºä¾‹ singleTop: å¦‚æœç›®æ ‡activityåœ¨ä»»åŠ¡æ ˆçš„æ ˆé¡¶ï¼Œé‚£ä¹ˆç›´æ¥å¤ç”¨å®ä¾‹ï¼Œä¼šè§¦å‘ç›®æ ‡activityçš„onnewintentæ–¹æ³• å¦‚æœç›®æ ‡activityä¸åœ¨ä»»åŠ¡æ ˆçš„æ ˆé¡¶ï¼Œæ–°å»ºä¸€ä¸ªç›®æ ‡å®ä¾‹ï¼Œæ·»åŠ åˆ°ä»»åŠ¡æ ˆ singleTaskï¼š1. å¦‚æœä»»åŠ¡æ ˆæ²¡æœ‰ç›®æ ‡å®ä¾‹ï¼Œåˆ™ç›´æ¥åˆ›å»ºæ–°çš„å®ä¾‹ï¼Œæ·»åŠ åˆ°ä»»åŠ¡æ ˆ 2. å¦‚æœä»»åŠ¡æ ˆä¸­å·²ç»å­˜åœ¨ç›®æ ‡activityï¼Œé‚£ä¹ˆç›´æ¥æŠŠç›®æ ‡activityä¸Šé¢çš„æ‰€æœ‰çš„å…¶ä»–activityéƒ½ç§»é™¤ä»»åŠ¡æ ˆï¼Œ æŠŠç›®æ ‡activityç½®äºæ ˆé¡¶ activityè·³è½¬ï¼š æ˜¾å¼è·³è½¬ï¼š Intent intent = new Intent(this,XXXActivity.class) startActivity(intent) éšå¼è·³è½¬ï¼šé€šè¿‡actionè¿›è¡Œè·³è½¬ Intent intent = new Intent() intent.setAction(\u0026#34;xxxx\u0026#34;) startActivity ç¤ºä¾‹ä»£ç ï¼šè·³è½¬æ‹¨å·é¡µé¢ Intent intent = new Intent(); intent.setAction(Intent.ACTION_DIAL); intent.setData(Uri.parse(\u0026#34;tel:110\u0026#34;)); startActivity(intent); intentï¼šç»„ä»¶ä¹‹é—´æ¶ˆæ¯ä¼ é€’çš„åª’ä»‹ï¼ŒåŒæ—¶æˆ‘ä»¬å¯ä»¥ç”¨å®ƒå¯åŠ¨å„ä¸ªç»„ä»¶ï¼ˆactivityã€serviceï¼‰ Serviceåˆ›å»ºæµç¨‹ 1. ç»§æ‰¿ç³»ç»ŸService,å®ç°æŠ½è±¡æ–¹æ³• onBind 2. æ¸…å•æ–‡ä»¶ä¸­æ³¨å†Œç»„ä»¶ ç¤ºä¾‹ï¼š \u0026lt;service android:name=\u0026#34;.service.MyService\u0026#34; android:exported=\u0026#34;true\u0026#34; android:enabled=\u0026#34;true\u0026#34;/\u0026gt; Serviceå¯åŠ¨æ¨¡å¼ï¼š 1. startServiceï¼ˆnew Intent(this,xxxService.class)ï¼‰ è§¦å‘ç”Ÿå‘½å‘¨æœŸï¼šonCreateã€onStartCommandï¼Œå¦‚æœserviceå·²ç»åˆ›å»ºäº†ï¼Œåˆ™ä¸ä¼šå†æ¬¡è§¦å‘onCreate 2. stopServiceã€stopSelf è§¦å‘ç”Ÿå‘½å‘¨æœŸï¼šonDestroy 1. bindService (intent,serviceConnection,BIND_AUTO_CREATE) è§¦å‘ç”Ÿå‘½å‘¨æœŸï¼šonCreateã€onbind. å¦‚æœæœåŠ¡å·²ç»ç»‘å®šï¼Œå†æ¬¡ç»‘å®šä¸ä¼šè§¦å‘ç”Ÿå‘½å‘¨æœŸ 2. unBindService è§¦å‘ç”Ÿå‘½å‘¨æœŸï¼šonDestroy intentä¼ å€¼ï¼š putExtra(\u0026#34;key\u0026#34;,value) valueæ˜¯ä»»ä½•æ•°æ®ç±»å‹ Object getExtra(\u0026#34;key\u0026#34;) æœ‰äº›ç±»å‹éœ€è¦é»˜è®¤å€¼ ç¤ºä¾‹ï¼šä¼ é€’ intent.putExtra(\u0026#34;name\u0026#34;,\u0026#34;å”é¸¿ç¨‹\u0026#34;); intent.putExtra(\u0026#34;age\u0026#34;,32); intent.putExtra(\u0026#34;gender\u0026#34;,false); ç¤ºä¾‹ï¼šè·å– Intent intent = getIntent(); String name = intent.getStringExtra(\u0026#34;name\u0026#34;); int age = intent.getIntExtra(\u0026#34;age\u0026#34;, 18); boolean gender = intent.getBooleanExtra(\u0026#34;gender\u0026#34;, true); æ³¨æ„é‡ç‚¹ï¼šè·å–çš„æ—¶å€™ï¼Œæ˜¯é€šè¿‡getIntentï¼ˆï¼‰ï¼Œä¸æ˜¯è‡ªå·±new intent() æ³¨æ„ç‚¹ï¼škeyå‰åä¸€å®šè¦ä¿æŒä¸€è‡´ å¦‚æœæˆ‘ä»¬éœ€è¦ä¼ é€’çš„å±æ€§æ¯”è¾ƒå¤šï¼Œå¯ä»¥é€‰æ‹©ä½¿ç”¨åºåˆ—åŒ–çš„å®ä½“ç±»æ¥è¿›è¡Œä¼ é€’ åºåˆ—åŒ–ï¼šSerializableã€Parcelable è·å–å¯¹è±¡çš„æ—¶å€™ï¼Œéœ€è¦è½¬å‹ï¼Œç¤ºä¾‹ï¼š Person person = (Person) intent.getSerializableExtra(\u0026#34;personInfo\u0026#34;); broadcastreceiver æ³¨å†Œæ–¹å¼ï¼š 1. é™æ€æ³¨å†Œ step1:åˆ›å»ºä¸€ä¸ªå¹¿æ’­æ¥æ”¶å™¨ ï¼Œç»§æ‰¿è‡ªBroadcastReceiver(ä¸èƒ½å†…éƒ¨ç±») step2:åœ¨æ¸…å•æ–‡ä»¶ä¸­è¿›è¡Œå£°æ˜ \u0026lt;!-- æ¸…å•æ–‡ä»¶ä¸­ å£°æ˜é™æ€æ³¨å†Œå¹¿æ’­--\u0026gt; \u0026lt;receiver android:name=\u0026#34;.MyBroadCastReceiver\u0026#34; android:exported=\u0026#34;true\u0026#34;\u0026gt; \u0026lt;intent-filter\u0026gt; \u0026lt;!-- actionå¯ä»¥å¼€å‘è€…è‡ªå·±æŒ‡å®š--\u0026gt; \u0026lt;action android:name=\u0026#34;myFirstBroadCast\u0026#34;/\u0026gt; \u0026lt;/intent-filter\u0026gt; \u0026lt;/receiver\u0026gt; step3:å¯ä»¥è‡ªå·±å‘é€å¹¿æ’­ï¼ˆå¯é€‰ï¼‰ //å‘é€å¹¿æ’­ Intent intent = new Intent(); intent.setAction(\u0026#34;myFirstBroadCast\u0026#34;); //å‘é€å¹¿æ’­ä¸€å®šè¦æŒ‡å®šåŒ…å intent.setPackage(getPackageName()); sendBroadcast(intent); step4:æ¥æ”¶å¹¶å¤„ç†å¹¿æ’­ï¼Œ æ˜¯åœ¨ç¬¬ä¸€æ­¥è‡ªå®šä¹‰åˆ›å»ºçš„å¹¿æ’­æ¥æ”¶å™¨çš„onReceiveæ–¹æ³•ä¸­ï¼Œå¤„ç†å¹¿æ’­ï¼Œå¯ä»¥é€šè¿‡intentæ¥è·å–å¯¹åº”çš„action @Override public void onReceive(Context context, Intent intent) { //è·å–actionï¼Œåç»­å¯ä»¥æ ¹æ®actionçš„ä¸åŒï¼Œåšé€»è¾‘åŒºåˆ†å¤„ç† String action = intent.getAction(); switch (action){ case \u0026#34;myFirstBroadCast\u0026#34;: Toast.makeText(context,\u0026#34;ç¬¬ä¸€ä¸ªå¹¿æ’­:\u0026#34; +action,Toast.LENGTH_SHORT).show(); break; case \u0026#34;secondBroadcast\u0026#34;: Toast.makeText(context,\u0026#34;ç¬¬äºŒä¸ªå¹¿æ’­:\u0026#34; +action,Toast.LENGTH_SHORT).show(); break; } Log.d(\u0026#34;lollipop\u0026#34;,\u0026#34;llll:\u0026#34; + action); } æ³¨æ„é‡ç‚¹ï¼šå¦‚æœæˆ‘ä»¬æƒ³è¦æ¥å—åˆ°actionï¼Œæˆ‘ä»¬å¿…é¡»è¦ä¿è¯ æ¸…å•æ–‡ä»¶ä¸­æ³¨å†Œçš„actionå’Œ å¹¿æ’­å‘é€è€…å‘é€çš„actionæ˜¯ä¸€è‡´çš„ ","permalink":"https://kennems.github.io/posts/tech/%E7%AC%AC%E4%BA%8C%E5%A4%A9%E7%AC%94%E8%AE%B0/","summary":"ç¬¬äºŒå¤©ç¬”è®° Android å››å¤§ç»„ä»¶è¯¾ç¨‹æ¦‚è¦æ€»ç»“ 1. Activity a. åˆ›å»º è‡ªåŠ¨åˆ›å»º åœ¨æ–°å»ºé¡¹ç›®åï¼Œä¼šè‡ªåŠ¨ä¸ºæˆ‘ä»¬åˆ›å»ºä¸€ä¸ª MainActivityã€‚Activity ç»„æˆéƒ¨åˆ†å¦‚ä¸‹ï¼š","title":"è®­ç»ƒè¥ç¬¬äºŒå¤©å­¦ä¹ ç¬”è®°"},{"content":"ç¬¬ä¸€å¤©å­¦ä¹ ç¬”è®° è€å¸ˆï¼šå”é¸¿ç¨‹\nAndroidæŒ‰ç…§è¿è¡Œæ–¹å¼åˆ†ä¸º3é˜¶æ®µ JIT\tAOT AOT+JIT\nAndroidç³»ç»Ÿå¯ä»¥åˆ†5å±‚ kernel å±‚ ï¼Œç¡¬ä»¶æŠ½è±¡å±‚ ï¼Œ art c++å±‚ ï¼Œ java frameworkå±‚ ï¼Œ appå±‚\nå­—èŠ‚ç å¯¹é½ï¼ˆBytecode Alignmentï¼‰ï¼šåœ¨ Android åº”ç”¨å¼€å‘ä¸­æ˜¯ä¸€ä¸ªä¼˜åŒ–æ­¥éª¤ï¼Œæ—¨åœ¨æé«˜åº”ç”¨ç¨‹åºçš„å¯åŠ¨é€Ÿåº¦å’Œè¿è¡Œæ•ˆç‡ã€‚å®ƒä¸»è¦ç”¨äºä¼˜åŒ– DEX æ–‡ä»¶çš„åŠ è½½è¿‡ç¨‹ã€‚\ngit é¡¹ç›®ç®¡ç†å·¥å…· gitä½¿ç”¨\ngité…ç½®å¤šä¸ªsshè´¦å·\n1ã€è´¦å·å¯†ç ç™»é™† ï¼š git config --global user.name â€œxxâ€ git config --global user.email \u0026#34;[fangqi@xiaomi.com](mailto:fangqi@xiaomi.com)\u0026#34; éœ€è¦å’Œä½ çš„ç™»å½•çš„è´¦æˆ·é‚®ç®±ä¸€è‡´ 2ã€é…ç½®sshæ–¹å¼ï¼šç”Ÿæˆæœ¬åœ°çš„æŒ‡çº¹ ï¼š ssh-keygen -t rsa cat /Users/{tournament}/.ssh/id_rsa.pub å°†æ–‡æ¡£å…¨éƒ¨å­—ç¬¦ä¸²å¤åˆ¶åˆ° gitlab çš„ sshkey 3ã€å°†ä»£ç æ¨åˆ°æ–°ä»“åº“ï¼š git init git remote add origin [git@partner-gitlab.mioffice.cn](mailto:git@partner-gitlab.mioffice.cn):nj-trainingcollege/miclassroom240108/{yourproject}.git git add * git commit -m \u0026#34;Initial commit\u0026#34; git push -u origin master 4ã€æ‹‰ä»¥åä»“åº“ä»£ç å¹¶æ›´æ–° git clone [git@partner-gitlab.mioffice.cn](mailto:git@partner-gitlab.mioffice.cn):nj-trainingcollege/miclassroom240108/hello.git git status git add * git commit -m \u0026#34;Initial commit\u0026#34; git push -u origin master 5ã€Android studio ä½¿ç”¨ ä¸‹è½½ 2020-2022ç‰ˆæœ¬çš„ android studio\né…ç½® java_home\né…ç½® android_home\né…ç½® adb_home {androidsdk} /platform-tools\næ–°å»ºé¡¹ç›® hello\nåœ¨appç›®å½•ä¸‹ æ‰¾æ‰“resæ–‡ä»¶å¤¹ æ–°å»ºlayoutæ–‡ä»¶å¤¹ ï¼Œæ–°å»ºæ–‡ä»¶ activity_hello.xml\næ·»åŠ ä»£ç \n\u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;LinearLayout xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34; android:orientation=\u0026#34;vertical\u0026#34;\u0026gt; \u0026lt;TextView android:layout_width=\u0026#34;wrap_content\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:layout_margin=\u0026#34;50dp\u0026#34; android:layout_gravity=\u0026#34;center\u0026#34; android:text=\u0026#34;hello world\u0026#34;/\u0026gt; \u0026lt;/LinearLayout\u0026gt; åˆ‡æ¢åˆ°æ–‡ä»¶mainactivity.java æ–‡ä»¶ï¼ˆå¦‚æœæ˜¯ktæ–‡ä»¶ï¼Œè¯·åˆ æ‰ï¼Œæ–°å»ºmainactivity.java ï¼‰ æ”¹æˆå¦‚ä¸‹ä»£ç \npackage com.example.hello; import android.app.Activity; import android.os.Bundle; public class MainActivity extends Activity { @Override protected void onCreate( Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_hello); } } gradle æ„å»ºé¡¹ç›® ./gradlew build å¦‚æœbuildå¤±è´¥æç¤º java ç‰ˆæœ¬é—®é¢˜ ï¼Œè¯·åˆ‡æ¢åˆ°ç›¸åº”ç‰ˆæœ¬\nadb å®‰è£… apk æ‰‹æœº\næ‰¾åˆ°æ ¹ç›®å½•ä¸‹å·²ç»ç¼–è¯‘å¥½çš„ release æ–‡ä»¶ release/app-release.apk\nadb install {rootdir}/release/app-release.apk æ–°å»ºé¡¹ç›® ç­¾åæ‰“åŒ… åˆ›å»ºä¸€ä¸ªkeystoreã€‚\nApplicationä¸­ä¸è¦åšä¸€äº›è€—æ—¶çš„æ“ä½œ\nADB\nå…¶ä»–èµ„æº Androidå®˜æ–¹æ–‡æ¡£ï¼šhttps://developer.android.google.cn/docs?hl=zh-cn å„ç§å¼€æºä»£ç ï¼šhttps://github.com/ kotlin https://kotlinlang.org/docs/home.html javaï¼š https://www.oracle.com/java/technologies/downloads/ ç³»ç»Ÿæºç  https://cs.android.com/ gradle https://developer.android.google.cn/studio/build/building-cmdline?hl=zh-cn\n","permalink":"https://kennems.github.io/posts/tech/%E7%AC%AC%E4%B8%80%E5%A4%A9%E7%AC%94%E8%AE%B0/","summary":"ç¬¬ä¸€å¤©å­¦ä¹ ç¬”è®° è€å¸ˆï¼šå”é¸¿ç¨‹ AndroidæŒ‰ç…§è¿è¡Œæ–¹å¼åˆ†ä¸º3é˜¶æ®µ JIT AOT AOT+JIT Androidç³»ç»Ÿå¯ä»¥åˆ†5å±‚ kernel å±‚ ï¼Œç¡¬ä»¶æŠ½è±¡å±‚ ï¼Œ art c++å±‚ ï¼Œ java framew","title":"è®­ç»ƒè¥ç¬¬ä¸€å¤©å­¦ä¹ ç¬”è®°"},{"content":"Androidå†…å­˜ç®¡ç†çŸ¥è¯†ç‚¹ é—®é¢˜ 1: ä»€ä¹ˆæ˜¯åƒåœ¾å›æ”¶æœºåˆ¶ï¼Ÿ è§£ç­”ï¼š åƒåœ¾å›æ”¶ï¼ˆGCï¼‰æ˜¯ç”±Javaè™šæ‹Ÿæœºï¼ˆJVMï¼‰åƒåœ¾å›æ”¶å™¨æä¾›çš„ä¸€ç§å¯¹å†…å­˜å›æ”¶çš„æœºåˆ¶ã€‚å®ƒä¼šåœ¨å†…å­˜ç©ºé—´ä¸è¶³æˆ–è€…å†…å­˜å ç”¨è¿‡é«˜çš„æ—¶å€™ï¼Œè‡ªåŠ¨å›æ”¶é‚£äº›æ²¡æœ‰å¼•ç”¨çš„å¯¹è±¡ï¼Œä»¥é‡Šæ”¾å†…å­˜èµ„æºã€‚åƒåœ¾å›æ”¶çš„ä¸»è¦ç›®æ ‡æ˜¯è‡ªåŠ¨ç®¡ç†å†…å­˜ï¼Œé¿å…å†…å­˜æ³„æ¼å’Œå†…å­˜æº¢å‡ºã€‚\né—®é¢˜ 2: JVMçš„å†…å­˜æ¨¡å‹æœ‰å“ªäº›éƒ¨åˆ†ç»„æˆï¼Ÿ è§£ç­”ï¼š JVMå†…å­˜æ¨¡å‹ä¸»è¦åˆ†ä¸ºä»¥ä¸‹å‡ éƒ¨åˆ†ï¼š\nç¨‹åºè®¡æ•°å™¨ï¼ˆProgram Counter Registerï¼‰ï¼šè®°å½•å½“å‰çº¿ç¨‹æ‰§è¡Œçš„å­—èŠ‚ç æŒ‡ä»¤åœ°å€ã€‚ æœ¬åœ°æ–¹æ³•æ ˆï¼ˆNative Method Stacksï¼‰ï¼šç”¨äºæ‰§è¡Œæœ¬åœ°æ–¹æ³•ã€‚ JVMæ ˆï¼ˆJVM Stacksï¼‰ï¼šæ¯ä¸ªçº¿ç¨‹ä¸€ä¸ªæ ˆï¼Œå­˜å‚¨å±€éƒ¨å˜é‡ã€æ“ä½œæ•°æ ˆã€åŠ¨æ€é“¾æ¥å’Œæ–¹æ³•å‡ºå£ç­‰ã€‚ å †ï¼ˆHeapï¼‰ï¼šæ‰€æœ‰çº¿ç¨‹å…±äº«çš„å†…å­˜åŒºåŸŸï¼Œç”¨äºå­˜å‚¨æ‰€æœ‰å¯¹è±¡å®ä¾‹å’Œæ•°ç»„ã€‚å †åˆåˆ†ä¸ºå¹´è½»ä»£ï¼ˆYoung Generationï¼‰å’Œè€å¹´ä»£ï¼ˆOld Generationï¼‰ï¼Œå…¶ä¸­å¹´è½»ä»£åˆåˆ’åˆ†ä¸ºEdenåŒºã€S0åŒºå’ŒS1åŒºã€‚ æ–¹æ³•åŒºï¼ˆMethod Areaï¼‰ï¼šå­˜å‚¨å·²è¢«è™šæ‹ŸæœºåŠ è½½çš„ç±»ä¿¡æ¯ã€å¸¸é‡ã€é™æ€å˜é‡å’Œå³æ—¶ç¼–è¯‘åçš„ä»£ç ç­‰ã€‚ è¿è¡Œæ—¶å¸¸é‡æ± ï¼ˆRuntime Constant Poolï¼‰ï¼šæ–¹æ³•åŒºçš„ä¸€éƒ¨åˆ†ï¼Œç”¨äºå­˜å‚¨ç¼–è¯‘æœŸç”Ÿæˆçš„å„ç§å­—é¢é‡å’Œç¬¦å·å¼•ç”¨ã€‚ ç›´æ¥å†…å­˜ï¼ˆDirect Memoryï¼‰ï¼šå¹¶ä¸æ˜¯JVMè§„èŒƒçš„ä¸€éƒ¨åˆ†ï¼Œä½†è¢«å¹¿æ³›ä½¿ç”¨ï¼Œä¸»è¦ç”¨äºNIOï¼ˆNew Input/Outputï¼‰ä¸­çš„ç¼“å†²åŒºã€‚ é—®é¢˜ 3: ä»€ä¹ˆæ˜¯å¼•ç”¨è®¡æ•°ç®—æ³•ï¼Ÿ è§£ç­”ï¼š å¼•ç”¨è®¡æ•°ç®—æ³•æ˜¯ä¸€ç§åˆ¤æ–­å¯¹è±¡æ˜¯å¦æ˜¯åƒåœ¾çš„ç®—æ³•ã€‚å¯¹è±¡è¢«åˆ›å»ºåï¼Œç³»ç»Ÿä¼šç»™è¯¥å¯¹è±¡åˆå§‹åŒ–ä¸€ä¸ªå¼•ç”¨è®¡æ•°å™¨ï¼Œå½“è¯¥å¯¹è±¡è¢«å¼•ç”¨æ—¶ï¼Œè®¡æ•°å™¨+1ï¼›å½“å¼•ç”¨å¤±æ•ˆæ—¶ï¼Œè®¡æ•°å™¨-1ã€‚å½“è®¡æ•°å™¨ä¸º0æ—¶ï¼Œè¡¨ç¤ºè¯¥å¯¹è±¡ä¸å†è¢«ä½¿ç”¨ï¼Œå¯ä»¥è¿›è¡Œå›æ”¶ã€‚\né—®é¢˜ 4: å¼•ç”¨è®¡æ•°ç®—æ³•çš„ä¼˜ç¼ºç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ è§£ç­”ï¼š\nä¼˜ç‚¹ï¼šåˆ¤å®šæ¯”è¾ƒç®€å•ï¼Œæ•ˆç‡é«˜ã€‚ ç¼ºç‚¹ï¼šæ— æ³•é¿å…å¾ªç¯å¼•ç”¨ã€‚ä¾‹å¦‚ï¼Œå½“å¯¹è±¡Aå’Œå¯¹è±¡Bç›¸äº’å¼•ç”¨æ—¶ï¼Œå³ä½¿å®ƒä»¬éƒ½ä¸å†è¢«å…¶ä»–å¯¹è±¡å¼•ç”¨ï¼Œå…¶å¼•ç”¨è®¡æ•°å™¨ä¹Ÿä¸ä¼šå˜ä¸º0ï¼Œå¯¼è‡´å†…å­˜æ³„æ¼ã€‚ é—®é¢˜ 5: å¦‚ä½•å¤„ç†å¼•ç”¨è®¡æ•°ç®—æ³•çš„å¾ªç¯å¼•ç”¨é—®é¢˜ï¼Ÿ è§£ç­”ï¼š å¼•ç”¨è®¡æ•°ç®—æ³•æ— æ³•ç›´æ¥è§£å†³å¾ªç¯å¼•ç”¨é—®é¢˜ã€‚é€šå¸¸éœ€è¦ç»“åˆå…¶ä»–ç®—æ³•ï¼Œå¦‚æ ‡è®°-æ¸…é™¤ç®—æ³•ï¼ˆMark-Sweepï¼‰ï¼Œæ¥å¤„ç†å¾ªç¯å¼•ç”¨ã€‚æ ‡è®°-æ¸…é™¤ç®—æ³•é€šè¿‡ä»æ ¹å¯¹è±¡å‡ºå‘ï¼Œéå†æ‰€æœ‰å¯è¾¾å¯¹è±¡å¹¶è¿›è¡Œæ ‡è®°ï¼Œç„¶åå›æ”¶æœªè¢«æ ‡è®°çš„å¯¹è±¡ã€‚\nè¡¥å……é—®é¢˜ 6: å¸¸è§çš„åƒåœ¾å›æ”¶å™¨æœ‰å“ªäº›ï¼Ÿ è§£ç­”ï¼š\nSerial æ”¶é›†å™¨ï¼šå•çº¿ç¨‹æ”¶é›†ï¼Œé€‚ç”¨äºå•æ ¸å¤„ç†å™¨å’Œå†…å­˜è¾ƒå°çš„åœºæ™¯ã€‚ ParNew æ”¶é›†å™¨ï¼šSerial æ”¶é›†å™¨çš„å¤šçº¿ç¨‹ç‰ˆæœ¬ï¼Œå¸¸ç”¨äºå¤šå¤„ç†å™¨ç³»ç»Ÿã€‚ Parallel Scavenge æ”¶é›†å™¨ï¼šå…³æ³¨ååé‡ï¼Œé€‚ç”¨äºåå°è¿ç®—è€Œä¸è¦æ±‚é«˜å“åº”é€Ÿåº¦çš„åœºæ™¯ã€‚ CMSï¼ˆConcurrent Mark-Sweepï¼‰æ”¶é›†å™¨ï¼šå…³æ³¨ä½å»¶è¿Ÿï¼Œé€‚ç”¨äºéœ€è¦è¾ƒå¿«å“åº”çš„åº”ç”¨ã€‚ G1ï¼ˆGarbage Firstï¼‰æ”¶é›†å™¨ï¼šé€‚ç”¨äºå¤šæ ¸å¤„ç†å™¨å’Œå¤§å†…å­˜åœºæ™¯ï¼Œèƒ½å¤Ÿæä¾›é«˜ååé‡å’Œä½å»¶è¿Ÿã€‚ è¡¥å……é—®é¢˜ 7: å¦‚ä½•æ£€æµ‹å’Œè§£å†³å†…å­˜æ³„æ¼ï¼Ÿ è§£ç­”ï¼š\nå·¥å…·ï¼šä½¿ç”¨MATï¼ˆMemory Analyzer Toolï¼‰ã€VisualVMã€JProfilerç­‰å·¥å…·ã€‚ æ–¹æ³•ï¼šé€šè¿‡åˆ†æå†…å­˜å¿«ç…§ï¼Œæ‰¾åˆ°é•¿æ—¶é—´å­˜åœ¨çš„å¯¹è±¡ï¼Œæ£€æŸ¥å®ƒä»¬çš„å¼•ç”¨é“¾ï¼Œæ‰¾å‡ºå¯èƒ½çš„å†…å­˜æ³„æ¼ç‚¹ã€‚ ç¼–ç è§„èŒƒï¼šåŠæ—¶é‡Šæ”¾ä¸å†ä½¿ç”¨çš„èµ„æºï¼Œé¿å…é•¿æ—¶é—´æŒæœ‰å¯¹è±¡å¼•ç”¨ï¼Œä½¿ç”¨å¼±å¼•ç”¨ï¼ˆWeakReferenceï¼‰ã€è½¯å¼•ç”¨ï¼ˆSoftReferenceï¼‰å’Œè™šå¼•ç”¨ï¼ˆPhantomReferenceï¼‰æ¥è¾…åŠ©åƒåœ¾å›æ”¶ã€‚ é¢è¯•æç¤º é¢è¯•å®˜å¯èƒ½ä¼šæ·±å…¥æ¢è®¨åƒåœ¾å›æ”¶å™¨çš„å…·ä½“å®ç°ï¼Œå¦‚Serialã€Parallelã€CMSã€G1ç­‰ä¸åŒç±»å‹çš„åƒåœ¾å›æ”¶å™¨ã€‚ å¯èƒ½ä¼šæ¶‰åŠå†…å­˜æ³„æ¼çš„å…·ä½“åœºæ™¯åŠæ’æŸ¥å·¥å…·å’Œæ–¹æ³•ï¼Œå¦‚MATï¼ˆMemory Analyzer Toolï¼‰ã€‚ äº†è§£å…¶ä»–åƒåœ¾å›æ”¶ç®—æ³•åŠå…¶ä¼˜ç¼ºç‚¹ï¼Œå¦‚æ ‡è®°-æ¸…é™¤ç®—æ³•ã€æ ‡è®°-å‹ç¼©ç®—æ³•ã€åˆ†ä»£æ”¶é›†ç®—æ³•ç­‰ã€‚ ç†Ÿæ‚‰å„ç§åƒåœ¾å›æ”¶è°ƒä¼˜å‚æ•°åŠå…¶é…ç½®æ–¹æ³•ï¼Œå¦‚-Xmsã€-Xmxã€-XXã€-XX ç­‰ã€‚ å¯è¾¾æ€§åˆ†ææ³• é—®é¢˜ 1: ä»€ä¹ˆæ˜¯å¯è¾¾æ€§åˆ†ææ³•ï¼Ÿ\nè§£ç­”ï¼š å¯è¾¾æ€§åˆ†ææ³•æ˜¯ä¸€ç§åƒåœ¾å›æ”¶ç®—æ³•ï¼Œé€šè¿‡ä»æ ¹å¯¹è±¡ï¼ˆGC Rootsï¼‰å¼€å§‹ï¼Œæ²¿ç€å¼•ç”¨é“¾éå†æ•´ä¸ªå¯¹è±¡å›¾ã€‚å¦‚æœä¸€ä¸ªå¯¹è±¡åˆ°GC Rootsæ²¡æœ‰ä»»ä½•å¼•ç”¨é“¾ç›¸è¿ï¼Œåˆ™è®¤ä¸ºè¯¥å¯¹è±¡ä¸å¯è¾¾ï¼Œå¯ä»¥è¢«åƒåœ¾å›æ”¶ã€‚\né—®é¢˜ 2: GC RootsåŒ…å«å“ªäº›å¯¹è±¡ï¼Ÿ\nè§£ç­”ï¼š GC RootsåŒ…å«ä»¥ä¸‹å‡ ç±»å¯¹è±¡ï¼š\nè™šæ‹Ÿæœºæ ˆï¼ˆJavaçº¿ç¨‹æ ˆï¼‰ä¸­å¼•ç”¨çš„å¯¹è±¡ï¼šä¾‹å¦‚æ ˆå¸§ä¸­çš„æœ¬åœ°å˜é‡è¡¨ã€‚ æ–¹æ³•åŒºä¸­ç±»é™æ€å±æ€§å¼•ç”¨çš„å¯¹è±¡ï¼šä¾‹å¦‚é™æ€å˜é‡å¼•ç”¨çš„å¯¹è±¡ã€‚ æ–¹æ³•åŒºä¸­å¸¸é‡å¼•ç”¨çš„å¯¹è±¡ï¼šä¾‹å¦‚å¸¸é‡æ± ä¸­çš„å¼•ç”¨ã€‚ æœ¬åœ°æ–¹æ³•æ ˆä¸­JNIï¼ˆNativeæ–¹æ³•ï¼‰å¼•ç”¨çš„å¯¹è±¡ã€‚ é—®é¢˜ 3: åœ¨å¯è¾¾æ€§åˆ†æä¸­ï¼Œå¦‚æœä¸€ä¸ªå¯¹è±¡ä¸å¯è¾¾ï¼Œæ˜¯å¦ç«‹å³è¢«å›æ”¶ï¼Ÿ\nè§£ç­”ï¼š ä¸ä¸€å®šã€‚å³ä½¿ä¸€ä¸ªå¯¹è±¡åœ¨å¯è¾¾æ€§åˆ†æä¸­è¢«åˆ¤å®šä¸ºä¸å¯è¾¾ï¼Œå®ƒä¹Ÿä¸ä¼šç«‹å³è¢«å›æ”¶ã€‚å®ƒå°†é¦–å…ˆè¿›å…¥ä¸€ä¸ªâ€œç¼“å†²é˜¶æ®µâ€ï¼ˆå¦‚åœ¨Javaä¸­ä¼šç»å†ä¸¤æ¬¡æ ‡è®°è¿‡ç¨‹ï¼‰ï¼Œä»¥é˜²æ­¢å¯¹è±¡åœ¨ç¼“å†²é˜¶æ®µä¸­è¢«é”™è¯¯åœ°å›æ”¶ã€‚åªæœ‰åœ¨ç¼“å†²é˜¶æ®µç»“æŸåï¼Œä¸”å¯¹è±¡ä»ç„¶ä¸å¯è¾¾æ—¶ï¼Œæ‰ä¼šè¢«æ ‡è®°ä¸ºçœŸæ­£çš„åƒåœ¾ï¼Œè¿›è¡Œå›æ”¶ã€‚\nJava ä¸­çš„å¯¹è±¡å¼•ç”¨ é—®é¢˜ 4: Javaä¸­çš„å¯¹è±¡å¼•ç”¨æœ‰å‡ ç§ç±»å‹ï¼Ÿ\nè§£ç­”ï¼š Javaä¸­çš„å¯¹è±¡å¼•ç”¨æœ‰å››ç§ç±»å‹ï¼š\nå¼ºå¼•ç”¨ï¼ˆStrong Referenceï¼‰ï¼š ç¤ºä¾‹ï¼šObject obj = new Object(); ç‰¹ç‚¹ï¼šæœ€å¸¸è§çš„å¼•ç”¨ç±»å‹ï¼Œåƒåœ¾å›æ”¶å™¨ä¸ä¼šå›æ”¶è¿™ç±»å¯¹è±¡ï¼Œå³ä½¿å†…å­˜ä¸è¶³ï¼Œä¹Ÿä¼šæŠ›å‡ºOutOfMemoryErroré”™è¯¯ã€‚ è½¯å¼•ç”¨ï¼ˆSoft Referenceï¼‰ï¼š ç‰¹ç‚¹ï¼šæ¯”å¼ºå¼•ç”¨å¼±ä¸€äº›ï¼Œå½“å†…å­˜ä¸è¶³æ—¶ï¼Œåƒåœ¾å›æ”¶å™¨ä¼šå›æ”¶è½¯å¼•ç”¨æŒ‡å‘çš„å¯¹è±¡ï¼Œä»¥é¿å…å†…å­˜æº¢å‡ºã€‚å¸¸ç”¨äºå®ç°ç¼“å­˜ã€‚ ç¤ºä¾‹ï¼šSoftReference\u0026lt;Object\u0026gt; softRef = new SoftReference\u0026lt;\u0026gt;(new Object()); å¼±å¼•ç”¨ï¼ˆWeak Referenceï¼‰ï¼š ç‰¹ç‚¹ï¼šæ¯”è½¯å¼•ç”¨æ›´å¼±ï¼Œåªè¦åƒåœ¾å›æ”¶å™¨è¿è¡Œï¼Œä¸è®ºå†…å­˜æ˜¯å¦å……è¶³ï¼Œéƒ½ä¼šå›æ”¶å¼±å¼•ç”¨æŒ‡å‘çš„å¯¹è±¡ã€‚å¸¸ç”¨äºé˜²æ­¢å†…å­˜æ³„æ¼ã€‚ ç¤ºä¾‹ï¼šWeakReference\u0026lt;Object\u0026gt; weakRef = new WeakReference\u0026lt;\u0026gt;(new Object()); è™šå¼•ç”¨ï¼ˆPhantom Referenceï¼‰ï¼š ç‰¹ç‚¹ï¼šæœ€å¼±çš„å¼•ç”¨ï¼Œä¸èƒ½é€šè¿‡è™šå¼•ç”¨æ¥è®¿é—®å¯¹è±¡ï¼Œå”¯ä¸€çš„ä½œç”¨æ˜¯åœ¨å¯¹è±¡è¢«å›æ”¶æ—¶æ”¶åˆ°ä¸€ä¸ªç³»ç»Ÿé€šçŸ¥ï¼Œé€šå¸¸ç”¨æ¥å®ç°ä¸€äº›æ¸…ç†æœºåˆ¶ã€‚ ç¤ºä¾‹ï¼šPhantomReference\u0026lt;Object\u0026gt; phantomRef = new PhantomReference\u0026lt;\u0026gt;(new Object(), new ReferenceQueue\u0026lt;\u0026gt;()); é—®é¢˜ 5: è½¯å¼•ç”¨å’Œå¼±å¼•ç”¨çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\nè§£ç­”ï¼š\nè½¯å¼•ç”¨ï¼š åœ¨å†…å­˜ä¸è¶³æ—¶ï¼Œåƒåœ¾å›æ”¶å™¨ä¼šå›æ”¶è½¯å¼•ç”¨æŒ‡å‘çš„å¯¹è±¡ï¼Œä»¥é¿å…å†…å­˜æº¢å‡ºã€‚ é€‚ç”¨äºå®ç°ç¼“å­˜ï¼Œå½“å†…å­˜è¶³å¤Ÿæ—¶ï¼Œä¿ç•™å¯¹è±¡ï¼›å½“å†…å­˜ä¸è¶³æ—¶ï¼Œå›æ”¶å¯¹è±¡ã€‚ å¼±å¼•ç”¨ï¼š åªè¦åƒåœ¾å›æ”¶å™¨è¿è¡Œï¼Œä¸è®ºå†…å­˜æ˜¯å¦å……è¶³ï¼Œéƒ½ä¼šå›æ”¶å¼±å¼•ç”¨æŒ‡å‘çš„å¯¹è±¡ã€‚ é€‚ç”¨äºé˜²æ­¢å†…å­˜æ³„æ¼ï¼Œå¦‚é¿å…é•¿ç”Ÿå‘½å‘¨æœŸå¯¹è±¡å¼•ç”¨çŸ­ç”Ÿå‘½å‘¨æœŸå¯¹è±¡ã€‚ é—®é¢˜ 6: ä»€ä¹ˆæ˜¯è™šå¼•ç”¨ï¼Œæœ‰ä»€ä¹ˆç”¨å¤„ï¼Ÿ\nè§£ç­”ï¼š\nè™šå¼•ç”¨ï¼ˆPhantom Referenceï¼‰ï¼š ä¹Ÿç§°ä¸ºå¹½çµå¼•ç”¨æˆ–å¹»å½±å¼•ç”¨ï¼Œæ˜¯æœ€å¼±çš„ä¸€ç§å¼•ç”¨å…³ç³»ã€‚ ä½œç”¨ï¼šä¸èƒ½é€šè¿‡è™šå¼•ç”¨è®¿é—®å¯¹è±¡ï¼Œä¸»è¦ç”¨äºåœ¨å¯¹è±¡è¢«åƒåœ¾å›æ”¶æ—¶æ”¶åˆ°ä¸€ä¸ªç³»ç»Ÿé€šçŸ¥ï¼Œä»è€Œè¿›è¡Œç›¸å…³æ¸…ç†æ“ä½œã€‚å®ƒä¸ºå¯¹è±¡è®¾ç½®ä¸€ä¸ªè™šå¼•ç”¨å…³è”ï¼Œè¿™æ ·å¯¹è±¡è¢«æ”¶é›†å™¨å›æ”¶æ—¶ï¼Œä¼šæ”¶åˆ°é€šçŸ¥ã€‚ é¢è¯•æç¤º é¢è¯•å®˜å¯èƒ½ä¼šæ·±å…¥æ¢è®¨å¯è¾¾æ€§åˆ†ææ³•çš„å…·ä½“å®ç°å’Œä¼˜åŒ–ç­–ç•¥ã€‚ äº†è§£å¦‚ä½•åœ¨å®é™…é¡¹ç›®ä¸­åº”ç”¨ä¸åŒç±»å‹çš„å¼•ç”¨ï¼Œç‰¹åˆ«æ˜¯è½¯å¼•ç”¨å’Œå¼±å¼•ç”¨çš„åº”ç”¨åœºæ™¯ã€‚ å¯ä»¥å‡†å¤‡ä¸€äº›å®é™…æ¡ˆä¾‹ï¼Œè¯´æ˜å¦‚ä½•ä½¿ç”¨è¿™äº›å¼•ç”¨ç±»å‹æ¥ä¼˜åŒ–å†…å­˜ç®¡ç†å’Œé˜²æ­¢å†…å­˜æ³„æ¼ã€‚ Javaä¸­çš„å¯¹è±¡å¼•ç”¨ é—®é¢˜ 1: Javaä¸­çš„å¯¹è±¡å¼•ç”¨æœ‰å‡ ç§ç±»å‹ï¼Ÿè¯·è§£é‡Šå®ƒä»¬çš„ç‰¹ç‚¹ã€‚\nè§£ç­”ï¼š Javaä¸­çš„å¯¹è±¡å¼•ç”¨æœ‰å››ç§ç±»å‹ï¼š\nå¼ºå¼•ç”¨ï¼ˆStrong Referenceï¼‰ï¼š ç¤ºä¾‹ï¼šObject obj = new Object(); ç‰¹ç‚¹ï¼šæœ€å¸¸è§çš„å¼•ç”¨ç±»å‹ï¼Œåƒåœ¾å›æ”¶å™¨ä¸ä¼šå›æ”¶è¿™ç±»å¯¹è±¡ï¼Œå³ä½¿å†…å­˜ä¸è¶³ï¼Œä¹Ÿä¼šæŠ›å‡ºOutOfMemoryErroré”™è¯¯ã€‚ è½¯å¼•ç”¨ï¼ˆSoft Referenceï¼‰ï¼š ç‰¹ç‚¹ï¼šæ¯”å¼ºå¼•ç”¨å¼±ä¸€äº›ï¼Œå½“å†…å­˜ä¸è¶³æ—¶ï¼Œåƒåœ¾å›æ”¶å™¨ä¼šå›æ”¶è½¯å¼•ç”¨æŒ‡å‘çš„å¯¹è±¡ï¼Œä»¥é¿å…å†…å­˜æº¢å‡ºã€‚å¸¸ç”¨äºå®ç°ç¼“å­˜ã€‚ ç¤ºä¾‹ï¼šSoftReference\u0026lt;Object\u0026gt; softRef = new SoftReference\u0026lt;\u0026gt;(new Object()); å¼±å¼•ç”¨ï¼ˆWeak Referenceï¼‰ï¼š ç‰¹ç‚¹ï¼šæ¯”è½¯å¼•ç”¨æ›´å¼±ï¼Œåªè¦åƒåœ¾å›æ”¶å™¨è¿è¡Œï¼Œä¸è®ºå†…å­˜æ˜¯å¦å……è¶³ï¼Œéƒ½ä¼šå›æ”¶å¼±å¼•ç”¨æŒ‡å‘çš„å¯¹è±¡ã€‚å¸¸ç”¨äºé˜²æ­¢å†…å­˜æ³„æ¼ã€‚ ç¤ºä¾‹ï¼šWeakReference\u0026lt;Object\u0026gt; weakRef = new WeakReference\u0026lt;\u0026gt;(new Object()); è™šå¼•ç”¨ï¼ˆPhantom Referenceï¼‰ï¼š ç‰¹ç‚¹ï¼šæœ€å¼±çš„å¼•ç”¨ï¼Œä¸èƒ½é€šè¿‡è™šå¼•ç”¨æ¥è®¿é—®å¯¹è±¡ï¼Œå”¯ä¸€çš„ä½œç”¨æ˜¯åœ¨å¯¹è±¡è¢«å›æ”¶æ—¶æ”¶åˆ°ä¸€ä¸ªç³»ç»Ÿé€šçŸ¥ï¼Œé€šå¸¸ç”¨æ¥å®ç°ä¸€äº›æ¸…ç†æœºåˆ¶ã€‚ ç¤ºä¾‹ï¼šPhantomReference\u0026lt;Object\u0026gt; phantomRef = new PhantomReference\u0026lt;\u0026gt;(new Object(), new ReferenceQueue\u0026lt;\u0026gt;()); é—®é¢˜ 2: è½¯å¼•ç”¨å’Œå¼±å¼•ç”¨çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\nè§£ç­”ï¼š\nè½¯å¼•ç”¨ï¼š åœ¨å†…å­˜ä¸è¶³æ—¶ï¼Œåƒåœ¾å›æ”¶å™¨ä¼šå›æ”¶è½¯å¼•ç”¨æŒ‡å‘çš„å¯¹è±¡ï¼Œä»¥é¿å…å†…å­˜æº¢å‡ºã€‚ é€‚ç”¨äºå®ç°ç¼“å­˜ï¼Œå½“å†…å­˜è¶³å¤Ÿæ—¶ï¼Œä¿ç•™å¯¹è±¡ï¼›å½“å†…å­˜ä¸è¶³æ—¶ï¼Œå›æ”¶å¯¹è±¡ã€‚ å¼±å¼•ç”¨ï¼š åªè¦åƒåœ¾å›æ”¶å™¨è¿è¡Œï¼Œä¸è®ºå†…å­˜æ˜¯å¦å……è¶³ï¼Œéƒ½ä¼šå›æ”¶å¼±å¼•ç”¨æŒ‡å‘çš„å¯¹è±¡ã€‚ é€‚ç”¨äºé˜²æ­¢å†…å­˜æ³„æ¼ï¼Œå¦‚é¿å…é•¿ç”Ÿå‘½å‘¨æœŸå¯¹è±¡å¼•ç”¨çŸ­ç”Ÿå‘½å‘¨æœŸå¯¹è±¡ã€‚ é—®é¢˜ 3: ä»€ä¹ˆæ˜¯è™šå¼•ç”¨ï¼Œæœ‰ä»€ä¹ˆç”¨å¤„ï¼Ÿ\nè§£ç­”ï¼š\n**è™šå¼•ç”¨ï¼ˆPhantom Referenceï¼‰**ä¹Ÿç§°ä¸ºå¹½çµå¼•ç”¨æˆ–å¹»å½±å¼•ç”¨ï¼Œæ˜¯æœ€å¼±çš„ä¸€ç§å¼•ç”¨å…³ç³»ã€‚ ä½œç”¨ï¼šä¸èƒ½é€šè¿‡è™šå¼•ç”¨è®¿é—®å¯¹è±¡ï¼Œä¸»è¦ç”¨äºåœ¨å¯¹è±¡è¢«åƒåœ¾å›æ”¶æ—¶æ”¶åˆ°ä¸€ä¸ªç³»ç»Ÿé€šçŸ¥ï¼Œä»è€Œè¿›è¡Œç›¸å…³æ¸…ç†æ“ä½œã€‚è™šå¼•ç”¨ä¸ä¸€ä¸ªå¼•ç”¨é˜Ÿåˆ—ï¼ˆReferenceQueueï¼‰ä¸€èµ·ä½¿ç”¨ï¼Œå½“åƒåœ¾å›æ”¶å™¨å‡†å¤‡å›æ”¶ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œå¦‚æœå‘ç°å®ƒæœ‰è™šå¼•ç”¨ï¼Œä¼šåœ¨å›æ”¶å¯¹è±¡ä¹‹å‰æŠŠè¿™ä¸ªè™šå¼•ç”¨åŠ å…¥åˆ°å¼•ç”¨é˜Ÿåˆ—ä¸­ã€‚ Androidå†…å­˜æ³„æ¼ é—®é¢˜ 1: ä»€ä¹ˆæ˜¯å†…å­˜æ³„æ¼ï¼Ÿå†…å­˜æ³„æ¼çš„åŸå› æ˜¯ä»€ä¹ˆï¼Ÿ\nè§£ç­”ï¼š å†…å­˜æ³„æ¼æ˜¯æŒ‡ç¨‹åºä¸­å·²åˆ†é…çš„å†…å­˜æ— æ³•è¢«é‡Šæ”¾æˆ–å›æ”¶ï¼Œå¯¼è‡´å†…å­˜èµ„æºé€æ¸è€—å°½çš„é—®é¢˜ã€‚å†…å­˜æ³„æ¼çš„ä¸»è¦åŸå› æ˜¯çŸ­ç”Ÿå‘½å‘¨æœŸçš„å¯¹è±¡è¢«é•¿ç”Ÿå‘½å‘¨æœŸçš„å¯¹è±¡æŒæœ‰ï¼Œå¯¼è‡´çŸ­ç”Ÿå‘½å‘¨æœŸçš„å¯¹è±¡æ— æ³•å›æ”¶ã€‚ä¾‹å¦‚ï¼ŒActivityã€Fragmentã€Viewæˆ–ServiceæŒæœ‰äº†ä¸€ä¸ªçŸ­ç”Ÿå‘½å‘¨æœŸçš„å¯¹è±¡å¹¶ä¸”æœªåŠæ—¶é‡Šæ”¾ã€‚\né—®é¢˜ 2: Androidä¸­å“ªäº›å¯¹è±¡è¢«é•¿ç”Ÿå‘½å‘¨æœŸå¯¹è±¡æŒæœ‰ä¼šå¯¼è‡´å†…å­˜æ³„æ¼ï¼Ÿ\nè§£ç­”ï¼š åœ¨Androidä¸­ï¼Œä»¥ä¸‹å¯¹è±¡è¢«é•¿ç”Ÿå‘½å‘¨æœŸå¯¹è±¡æŒæœ‰ä¼šå¯¼è‡´å†…å­˜æ³„æ¼ï¼š\nActivity Fragment View Service é—®é¢˜ 3: å¦‚ä½•æ£€æµ‹å’Œè§£å†³å†…å­˜æ³„æ¼é—®é¢˜ï¼Ÿ\nè§£ç­”ï¼š å¯ä»¥ä½¿ç”¨å·¥å…·å¦‚LeakCanaryæ¥æ£€æµ‹å’Œè§£å†³å†…å­˜æ³„æ¼é—®é¢˜ã€‚LeakCanaryæ˜¯Squareå…¬å¸ä¸ºAndroidå¼€å‘è€…æä¾›çš„ä¸€ä¸ªè‡ªåŠ¨æ£€æµ‹å†…å­˜æ³„æ¼çš„å·¥å…·ã€‚å®ƒåŸºäºMATè¿›è¡ŒAndroidåº”ç”¨ç¨‹åºå†…å­˜æ³„æ¼çš„è‡ªåŠ¨åŒ–æ£€æµ‹ã€‚é€šè¿‡é›†æˆLeakCanaryæä¾›çš„jaråŒ…åˆ°è‡ªå·±çš„å·¥ç¨‹ä¸­ï¼Œä¸€æ—¦æ£€æµ‹åˆ°å†…å­˜æ³„æ¼ï¼ŒLeakCanaryä¼šdump Memoryä¿¡æ¯ï¼Œå¹¶é€šè¿‡å¦ä¸€ä¸ªè¿›ç¨‹åˆ†æå†…å­˜æ³„æ¼çš„ä¿¡æ¯å¹¶å±•ç¤ºå‡ºæ¥ï¼Œå¸®åŠ©å¼€å‘è€…åŠæ—¶å‘ç°å’Œå®šä½å†…å­˜æ³„æ¼é—®é¢˜ã€‚\né¢è¯•æç¤º é¢è¯•å®˜å¯èƒ½ä¼šæ·±å…¥æ¢è®¨å¼•ç”¨ç±»å‹çš„å…·ä½“å®ç°å’Œä½¿ç”¨åœºæ™¯ï¼Œç‰¹åˆ«æ˜¯è½¯å¼•ç”¨å’Œå¼±å¼•ç”¨åœ¨å®é™…é¡¹ç›®ä¸­çš„åº”ç”¨ã€‚ å¯¹äºå†…å­˜æ³„æ¼éƒ¨åˆ†ï¼Œå‡†å¤‡ä¸€äº›å®é™…æ¡ˆä¾‹è¯´æ˜å¦‚ä½•æ£€æµ‹å’Œè§£å†³å†…å­˜æ³„æ¼é—®é¢˜ï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨LeakCanaryç­‰å·¥å…·è¿›è¡Œå†…å­˜ç®¡ç†ä¼˜åŒ–ã€‚ äº†è§£å†…å­˜æ³„æ¼çš„å¸¸è§åœºæ™¯ï¼Œå¦‚é™æ€æŒæœ‰Activityã€åŒ¿åå†…éƒ¨ç±»æˆ–éé™æ€å†…éƒ¨ç±»ã€æœªå–æ¶ˆçš„Handleræˆ–AsyncTaskç­‰ã€‚ ANRï¼ˆApplication Not Respondingï¼‰ é—®é¢˜ 1: ä»€ä¹ˆæ˜¯ANRï¼Ÿ\nè§£ç­”ï¼š ANRçš„å…¨ç§°æ˜¯Application Not Respondingï¼Œå³åº”ç”¨ç¨‹åºæ— å“åº”ã€‚å®ƒæŒ‡çš„æ˜¯åœ¨Androidåº”ç”¨çš„UIçº¿ç¨‹ï¼ˆä¸»çº¿ç¨‹ï¼‰ä¸­ï¼Œæœ‰ç‰¹å®šçš„æ¶ˆæ¯ï¼ˆä¾‹å¦‚æŒ‰é”®ã€è§¦æ‘¸äº‹ä»¶ã€å¹¿æ’­ã€æœåŠ¡ç­‰ï¼‰æ²¡æœ‰åœ¨è§„å®šæ—¶é—´å†…å¤„ç†å®Œæ¯•ï¼Œä»è€Œè§¦å‘äº†ANRå¼‚å¸¸ã€‚\nAndroidç³»ç»Ÿé€šè¿‡æ¶ˆæ¯å¤„ç†æœºåˆ¶ï¼Œç¡®ä¿åœ¨è§„å®šçš„æ—¶é—´é—´éš”å†…å¤„ç†æ¶ˆæ¯ï¼Œå¦‚æœè¶…è¿‡è¿™ä¸ªæ—¶é—´ï¼Œç³»ç»Ÿå°†è®¤ä¸ºåº”ç”¨ç¨‹åºæ— å“åº”ï¼Œå¹¶è§¦å‘ANRå¼‚å¸¸ã€‚\né—®é¢˜ 2: ANRæœ‰å“ªå‡ ç§ç±»å‹ï¼Ÿè¯·è¯¦ç»†è§£é‡Šæ¯ç§ç±»å‹ã€‚\nè§£ç­”ï¼š ANRæœ‰ä¸‰ç§ç±»å‹ï¼š\nKeyDispatchTimeoutï¼š æè¿°ï¼šå½“æŒ‰é”®æˆ–è§¦æ‘¸äº‹ä»¶æ²¡æœ‰åœ¨ç‰¹å®šæ—¶é—´å†…æ— å“åº”æ—¶è§¦å‘ã€‚ é»˜è®¤æ—¶é—´ï¼šä¸€èˆ¬Androidå¹³å°é»˜è®¤è¶…æ—¶æ—¶é—´æ˜¯5ç§’ï¼Œä½†æœ‰äº›å¹³å°ä¼šä¿®æ”¹è¿™ä¸ªæ—¶é—´ï¼Œä¾‹å¦‚MTKå¹³å°è¶…æ—¶æ—¶é—´ä¸º8ç§’ã€‚ BroadcastTimeoutï¼š æè¿°ï¼šå½“BroadcastReceiveråœ¨è§„å®šæ—¶é—´å†…æ— æ³•å¤„ç†å®Œå¹¿æ’­æ¶ˆæ¯æ—¶è§¦å‘ã€‚ é»˜è®¤æ—¶é—´ï¼šå‰å°å¹¿æ’­è¶…æ—¶æ—¶é—´æ˜¯10ç§’ï¼Œåå°å¹¿æ’­è¶…æ—¶æ—¶é—´æ˜¯60ç§’ã€‚ ServiceTimeoutï¼š æè¿°ï¼šå½“Serviceåœ¨è§„å®šæ—¶é—´å†…æ— æ³•å¤„ç†å®Œæ“ä½œæ—¶è§¦å‘ã€‚ é»˜è®¤æ—¶é—´ï¼šå‰å°Serviceè¶…æ—¶æ—¶é—´æ˜¯20ç§’ï¼Œåå°Serviceè¶…æ—¶æ—¶é—´æ˜¯200ç§’ã€‚ é—®é¢˜ 3: å¦‚ä½•æ£€æµ‹ANRé—®é¢˜ï¼Ÿ\nè§£ç­”ï¼š ANRå‘ç”Ÿæ—¶ï¼Œç³»ç»Ÿä¼šåœ¨æ—¥å¿—ä¸­è¾“å‡ºé”™è¯¯ä¿¡æ¯ï¼Œå¹¶ç”Ÿæˆä¸€ä¸ª/data/anr/traces.txtçš„æ–‡ä»¶ã€‚è¿™ä¸ªæ–‡ä»¶ä¸­åŒ…å«å½“å‰åº”ç”¨è¿›ç¨‹å’Œç³»ç»Ÿè¿›ç¨‹çš„å‡½æ•°å †æ ˆä¿¡æ¯ï¼Œæ˜¯åˆ†æANRåŸå› çš„å…³é”®æ–‡ä»¶ã€‚é€šè¿‡æ£€æŸ¥è¿™ä¸ªæ–‡ä»¶ï¼Œå¯ä»¥çœ‹åˆ°å½“å‰çš„CPUä½¿ç”¨ç‡ç­‰ä¿¡æ¯ï¼Œè¿™äº›éƒ½æ˜¯é‡è¦çš„çº¿ç´¢ã€‚\né—®é¢˜ 4: ä¸»çº¿ç¨‹æ‰§è¡Œè€—æ—¶æ“ä½œä¼šå¯¼è‡´ANRï¼Œè¯·è§£é‡Šå¹¶ä¸¾ä¾‹è¯´æ˜ã€‚\nè§£ç­”ï¼š ä¸»çº¿ç¨‹ï¼ˆUIçº¿ç¨‹ï¼‰æ‰§è¡Œè€—æ—¶æ“ä½œï¼Œä¾‹å¦‚å¤§é‡è®¡ç®—ã€å¾ªç¯ã€é€’å½’ã€I/Oæ“ä½œç­‰ï¼Œä¼šå ç”¨ä¸»çº¿ç¨‹çš„æ—¶é—´ï¼Œå¯¼è‡´æ— æ³•åŠæ—¶å¤„ç†UIæ›´æ–°å’Œç”¨æˆ·è¾“å…¥ï¼Œä»è€Œå¼•å‘ANRã€‚\nç¤ºä¾‹ä»£ç ï¼š\njavaCopy codemBind.textView.setOnClickListener(new View.OnClickListener() {\r@Override\rpublic void onClick(View v) {\rwhile (true) {\rLog.i(\u0026#34;TAG\u0026#34;, \u0026#34;ä¸»çº¿ç¨‹æ‰§è¡Œè€—æ—¶æ“ä½œ\u0026#34;);\rtry {\rThread.sleep(500);\r} catch (Exception e) {\re.printStackTrace();\r}\r}\r}\r}); é—®é¢˜ 5: æ­»é”ä¼šå¯¼è‡´ANRï¼Œè¯·è§£é‡Šå¹¶ä¸¾ä¾‹è¯´æ˜ã€‚\nè§£ç­”ï¼š æ­»é”æ˜¯æŒ‡ä¸¤ä¸ªæˆ–å¤šä¸ªçº¿ç¨‹äº’ç›¸ç­‰å¾…å¯¹æ–¹é‡Šæ”¾èµ„æºï¼Œå¯¼è‡´çº¿ç¨‹æ°¸ä¹…é˜»å¡ã€‚ä¸»çº¿ç¨‹é•¿æ—¶é—´æ— æ³•è·å–åˆ°æ‰€éœ€çš„èµ„æºé”ï¼Œå¯¼è‡´æ— æ³•å“åº”ç”¨æˆ·æ“ä½œï¼Œä»è€Œå¼•å‘ANRã€‚\nç¤ºä¾‹ä»£ç ï¼š\njavaCopy codepublic class MainThreadAnrActivity extends BaseActivity\u0026lt;ActivityHandlerBinding\u0026gt; { private final Object object = new Object(); private final String TAG = MainThreadAnrActivity.class.getSimpleName(); private boolean taskComplete = false; @Override protected void bindListener() { super.bindListener(); mBind.textView.setOnClickListener(new View.OnClickListener() { @Override public void onClick(View v) { synchronized (object) { Log.i(TAG, \u0026#34;æ­»é”å¯¼è‡´ANR \u0026#34; + taskComplete); } } }); new Thread(new Runnable() { @Override public void run() { synchronized (object) { try { Thread.sleep(30 * 1000); taskComplete = true; } catch (Exception e) { e.printStackTrace(); } } } }).start(); } } é¢è¯•æç¤º é¢è¯•å®˜å¯èƒ½ä¼šæ·±å…¥æ¢è®¨ANRçš„å…·ä½“ç±»å‹å’Œè§¦å‘æ¡ä»¶ï¼Œäº†è§£å¦‚ä½•åˆ†æå’Œè§£å†³ANRé—®é¢˜ã€‚ å‡†å¤‡ä¸€äº›å®é™…é¡¹ç›®ä¸­çš„ANRæ¡ˆä¾‹ï¼Œè¯´æ˜å¦‚ä½•æ£€æµ‹ã€åˆ†æå’Œè§£å†³è¿™äº›é—®é¢˜ã€‚ ç†Ÿæ‚‰ANRç›¸å…³çš„æ—¥å¿—æ–‡ä»¶ï¼ˆå¦‚traces.txtï¼‰çš„ç»“æ„å’Œå†…å®¹ï¼Œèƒ½å¤Ÿæ ¹æ®æ—¥å¿—è¿›è¡Œé—®é¢˜å®šä½å’Œåˆ†æã€‚ ","permalink":"https://kennems.github.io/posts/tech/android%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E7%9F%A5%E8%AF%86%E7%82%B9/","summary":"Androidå†…å­˜ç®¡ç†çŸ¥è¯†ç‚¹ é—®é¢˜ 1: ä»€ä¹ˆæ˜¯åƒåœ¾å›æ”¶æœºåˆ¶ï¼Ÿ è§£ç­”ï¼š åƒåœ¾å›æ”¶ï¼ˆGCï¼‰æ˜¯ç”±Javaè™šæ‹Ÿæœºï¼ˆJVMï¼‰åƒåœ¾å›æ”¶å™¨æä¾›çš„ä¸€ç§å¯¹å†…å­˜å›æ”¶çš„æœºåˆ¶","title":"Androidå†…å­˜ç®¡ç†çŸ¥è¯†ç‚¹"},{"content":"Androidï¼ˆ5ï¼‰ é«˜çº§æ§ä»¶ SpinnerDialog + ArrayAdapter XML \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;LinearLayout xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34; xmlns:app=\u0026#34;http://schemas.android.com/apk/res-auto\u0026#34; xmlns:tools=\u0026#34;http://schemas.android.com/tools\u0026#34; android:id=\u0026#34;@+id/main\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34; tools:context=\u0026#34;.SpinnerDropdownActivity\u0026#34; android:orientation=\u0026#34;vertical\u0026#34;\u0026gt; \u0026lt;TextView android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:text=\u0026#34;ä¸‹æ‹‰æ¨¡å¼çš„åˆ—è¡¨æ¡†\u0026#34; android:textSize=\u0026#34;17sp\u0026#34;/\u0026gt; \u0026lt;Spinner android:id=\u0026#34;@id/sp_dialog\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:spinnerMode=\u0026#34;dialog\u0026#34;/\u0026gt; \u0026lt;/LinearLayout\u0026gt; item_select.xml \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;TextView xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34; xmlns:tools=\u0026#34;http://schemas.android.com/tools\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;50dp\u0026#34; android:gravity=\u0026#34;center\u0026#34; android:textColor=\u0026#34;#0000ff\u0026#34; android:textSize=\u0026#34;17sp\u0026#34; tools:text=\u0026#34;ç«æ˜Ÿ\u0026#34;\u0026gt; \u0026lt;/TextView\u0026gt; Java package com.showguan.chapter08; import android.os.Bundle; import android.view.View; import android.widget.AdapterView; import android.widget.ArrayAdapter; import android.widget.Spinner; import androidx.appcompat.app.AppCompatActivity; import com.showguan.chapter08.util.ToastUtil; public class SpinnerDialogActivity extends AppCompatActivity implements AdapterView.OnItemSelectedListener { private Spinner sp_dialog; private static final String[] starArray = new String[]{ \u0026#34;æ°´æ˜Ÿ\u0026#34;, \u0026#34;é‡‘æ˜Ÿ\u0026#34;, \u0026#34;åœ°çƒ\u0026#34;, \u0026#34;ç«æ˜Ÿ\u0026#34;, \u0026#34;æœ¨æ˜Ÿ\u0026#34;, \u0026#34;åœŸæ˜Ÿ\u0026#34;, \u0026#34;å¤©ç‹æ˜Ÿ\u0026#34;, \u0026#34;æµ·ç‹æ˜Ÿ\u0026#34; }; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_spinner_dialog); sp_dialog = findViewById(R.id.sp_dialog); ArrayAdapter\u0026lt;String\u0026gt; starAdapter = new ArrayAdapter\u0026lt;\u0026gt;(this, R.layout.item_select, starArray); sp_dialog.setPrompt(\u0026#34;ğŸŒ¤é€‰æ‹©è¡Œæ˜Ÿ\u0026#34;); sp_dialog.setAdapter(starAdapter); sp_dialog.setSelection(0); sp_dialog.setOnItemSelectedListener(this); } @Override public void onItemSelected(AdapterView\u0026lt;?\u0026gt; parent, View view, int position, long id) { ToastUtil.show(this, \u0026#34;æ‚¨é€‰æ‹©äº†ï¼š \u0026#34; + starArray[position]); } @Override public void onNothingSelected(AdapterView\u0026lt;?\u0026gt; parent) { } } SpinnerDropdown XML \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;LinearLayout xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34; xmlns:app=\u0026#34;http://schemas.android.com/apk/res-auto\u0026#34; xmlns:tools=\u0026#34;http://schemas.android.com/tools\u0026#34; android:id=\u0026#34;@+id/main\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34; tools:context=\u0026#34;.SpinnerDropdownActivity\u0026#34; android:orientation=\u0026#34;vertical\u0026#34;\u0026gt; \u0026lt;TextView android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:text=\u0026#34;ä¸‹æ‹‰æ¨¡å¼çš„åˆ—è¡¨æ¡†\u0026#34; android:textSize=\u0026#34;17sp\u0026#34;/\u0026gt; \u0026lt;Spinner android:id=\u0026#34;@id/sp_dropdown\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:spinnerMode=\u0026#34;dropdown\u0026#34;/\u0026gt; \u0026lt;/LinearLayout\u0026gt; Java package com.showguan.chapter08; import android.os.Bundle; import android.view.View; import android.widget.AdapterView; import android.widget.ArrayAdapter; import android.widget.Spinner; import androidx.activity.EdgeToEdge; import androidx.appcompat.app.AppCompatActivity; import androidx.core.graphics.Insets; import androidx.core.view.ViewCompat; import androidx.core.view.WindowInsetsCompat; import com.showguan.chapter08.util.ToastUtil; public class SpinnerDropdownActivity extends AppCompatActivity implements AdapterView.OnItemSelectedListener { private Spinner sp_dropdown; private static final String[] starArray = new String[]{ \u0026#34;æ°´æ˜Ÿ\u0026#34;, \u0026#34;é‡‘æ˜Ÿ\u0026#34;, \u0026#34;åœ°çƒ\u0026#34;, \u0026#34;ç«æ˜Ÿ\u0026#34;, \u0026#34;æœ¨æ˜Ÿ\u0026#34;, \u0026#34;åœŸæ˜Ÿ\u0026#34;, \u0026#34;å¤©ç‹æ˜Ÿ\u0026#34;, \u0026#34;æµ·ç‹æ˜Ÿ\u0026#34; }; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_spinner_dropdown); sp_dropdown = findViewById(R.id.sp_dropdown); ArrayAdapter\u0026lt;String\u0026gt; starAdapter = new ArrayAdapter\u0026lt;\u0026gt;(this, R.layout.item_select, starArray); sp_dropdown.setAdapter(starAdapter); sp_dropdown.setSelection(0); sp_dropdown.setOnItemSelectedListener(this); } @Override public void onItemSelected(AdapterView\u0026lt;?\u0026gt; parent, View view, int position, long id) { ToastUtil.show(this, \u0026#34;æ‚¨é€‰æ‹©äº†ï¼š \u0026#34; + starArray[position]); } @Override public void onNothingSelected(AdapterView\u0026lt;?\u0026gt; parent) { } } SimpleAdapterç®€å•é€‚é…å™¨ XML \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;LinearLayout xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34; xmlns:app=\u0026#34;http://schemas.android.com/apk/res-auto\u0026#34; xmlns:tools=\u0026#34;http://schemas.android.com/tools\u0026#34; android:id=\u0026#34;@+id/main\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34; android:orientation=\u0026#34;vertical\u0026#34; tools:context=\u0026#34;.SpinnerDropdownActivity\u0026#34;\u0026gt; \u0026lt;TextView android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:gravity=\u0026#34;center\u0026#34; android:text=\u0026#34;è¡Œæ˜Ÿçš„ç®€å•é€‚é…å™¨\u0026#34; android:textSize=\u0026#34;17sp\u0026#34; /\u0026gt; \u0026lt;Spinner android:id=\u0026#34;@id/sp_icon\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:spinnerMode=\u0026#34;dropdown\u0026#34; /\u0026gt; \u0026lt;/LinearLayout\u0026gt; Java package com.showguan.chapter08; // åŒ…å public class SpinnerIconActivity extends AppCompatActivity implements AdapterView.OnItemSelectedListener { // å®šä¹‰ä¸€ä¸ªæ•´å‹æ•°ç»„ï¼Œå­˜å‚¨æ˜Ÿçƒå›¾æ ‡çš„èµ„æºID private static final int[] iconArray = { R.drawable.shuixing, R.drawable.jinxing, R.drawable.diqiu, R.drawable.huoxing, R.drawable.muxing, R.drawable.tuxing, }; // å®šä¹‰ä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„ï¼Œå­˜å‚¨æ˜Ÿçƒçš„åç§° private static final String[] starArray = new String[]{ \u0026#34;æ°´æ˜Ÿ\u0026#34;, \u0026#34;é‡‘æ˜Ÿ\u0026#34;, \u0026#34;åœ°çƒ\u0026#34;, \u0026#34;ç«æ˜Ÿ\u0026#34;, \u0026#34;æœ¨æ˜Ÿ\u0026#34;, \u0026#34;åœŸæ˜Ÿ\u0026#34;, \u0026#34;å¤©ç‹æ˜Ÿ\u0026#34;, \u0026#34;æµ·ç‹æ˜Ÿ\u0026#34; }; @Override protected void onCreate(Bundle savedInstanceState) { // onCreateæ–¹æ³•ï¼Œæ´»åŠ¨å¯åŠ¨æ—¶è°ƒç”¨ super.onCreate(savedInstanceState); // è°ƒç”¨çˆ¶ç±»çš„onCreateæ–¹æ³• setContentView(R.layout.activity_spinner_icon); // è®¾ç½®æ´»åŠ¨çš„å¸ƒå±€æ–‡ä»¶ List\u0026lt;Map\u0026lt;String, Object\u0026gt;\u0026gt; list = new ArrayList\u0026lt;\u0026gt;(); // åˆ›å»ºä¸€ä¸ªåˆ—è¡¨ï¼Œç”¨äºå­˜å‚¨å›¾æ ‡å’Œåç§° for (int i = 0; i \u0026lt; iconArray.length; i++) { // éå†å›¾æ ‡æ•°ç»„ Map\u0026lt;String, Object\u0026gt; item = new HashMap\u0026lt;\u0026gt;(); // åˆ›å»ºä¸€ä¸ªHashMapå¯¹è±¡ item.put(\u0026#34;icon\u0026#34;, iconArray[i]); // å°†å›¾æ ‡èµ„æºIDæ”¾å…¥Mapä¸­ item.put(\u0026#34;name\u0026#34;, starArray[i]); // å°†åç§°æ”¾å…¥Mapä¸­ list.add(item); // å°†Mapæ·»åŠ åˆ°åˆ—è¡¨ä¸­ } // åˆ›å»ºä¸€ä¸ªSimpleAdapterï¼Œè¿æ¥æ•°æ®å’Œå¸ƒå±€ SimpleAdapter startAdapter = new SimpleAdapter(this, list, // æ•°æ®æº R.layout.item_simple, // åˆ—è¡¨é¡¹å¸ƒå±€ new String[]{\u0026#34;icon\u0026#34;, \u0026#34;name\u0026#34;}, // Mapä¸­çš„é”® new int[]{R.id.iv_icon, R.id.tv_name}); // å¸ƒå±€ä¸­çš„è§†å›¾ID Spinner sp_icon = findViewById(R.id.sp_icon); // è·å–Spinneræ§ä»¶ sp_icon.setAdapter(startAdapter); // ä¸ºSpinnerè®¾ç½®é€‚é…å™¨ sp_icon.setSelection(0); // é»˜è®¤é€‰ä¸­ç¬¬0é¡¹ sp_icon.setOnItemSelectedListener(this); // è®¾ç½®é€‰é¡¹é€‰ä¸­ç›‘å¬å™¨ } @Override public void onItemSelected(AdapterView\u0026lt;?\u0026gt; parent, View view, int position, long id) { // å½“é€‰æ‹©ä¸€ä¸ªé€‰é¡¹æ—¶è°ƒç”¨ ToastUtil.show(this, \u0026#34;ä½ é€‰æ‹©çš„æ˜¯ï¼š\u0026#34; + starArray[position]); // æ˜¾ç¤ºé€‰æ‹©çš„æ˜Ÿçƒåç§° } @Override public void onNothingSelected(AdapterView\u0026lt;?\u0026gt; parent) { // å½“æ²¡æœ‰é€‰é¡¹è¢«é€‰æ‹©æ—¶è°ƒç”¨ } } BaseAdapteråŸºæœ¬é€‚é…å™¨ BaseAdapteræ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œæ‰€ä»¥éœ€è¦é‡å†™\nPlanetBaseAdapter.java package com.showguan.chapter08.adapter; // åŒ…å import android.content.Context; // å¯¼å…¥Contextç±» import android.view.LayoutInflater; // å¯¼å…¥LayoutInflaterç±» import android.view.View; // å¯¼å…¥Viewç±» import android.view.ViewGroup; // å¯¼å…¥ViewGroupç±» import android.widget.BaseAdapter; // å¯¼å…¥BaseAdapterç±» import android.widget.ImageView; // å¯¼å…¥ImageViewç±» import android.widget.TextView; // å¯¼å…¥TextViewç±» import com.showguan.chapter08.R; // å¯¼å…¥é¡¹ç›®çš„Rç±» import com.showguan.chapter08.bean.Planet; // å¯¼å…¥è‡ªå®šä¹‰çš„Planetç±» import java.util.List; // å¯¼å…¥Listæ¥å£ public class PlanetBaseAdapter extends BaseAdapter { // å®šä¹‰PlanetBaseAdapterç±»ï¼Œç»§æ‰¿è‡ªBaseAdapter private Context mContext; // ä¸Šä¸‹æ–‡å¯¹è±¡ private List\u0026lt;Planet\u0026gt; mPlanetList; // å­˜å‚¨Planetå¯¹è±¡çš„åˆ—è¡¨ // æ„é€ æ–¹æ³•ï¼Œåˆå§‹åŒ–ä¸Šä¸‹æ–‡å’Œåˆ—è¡¨ public PlanetBaseAdapter(Context mContext, List\u0026lt;Planet\u0026gt; mPlanetList) { this.mContext = mContext; // åˆå§‹åŒ–ä¸Šä¸‹æ–‡ this.mPlanetList = mPlanetList; // åˆå§‹åŒ–æ˜Ÿçƒåˆ—è¡¨ } @Override public int getCount() { // è¿”å›åˆ—è¡¨é¡¹çš„æ•°é‡ return mPlanetList.size(); // è¿”å›æ˜Ÿçƒåˆ—è¡¨çš„å¤§å° } @Override public Object getItem(int position) { // è·å–æŒ‡å®šä½ç½®çš„åˆ—è¡¨é¡¹ return mPlanetList.get(position); // è¿”å›æŒ‡å®šä½ç½®çš„Planetå¯¹è±¡ } @Override public long getItemId(int position) { // è·å–æŒ‡å®šä½ç½®é¡¹çš„ID return position; // è¿”å›ä½ç½®ä½œä¸ºé¡¹çš„ID } @Override public View getView(int position, View convertView, ViewGroup parent) { // è·å–æ¯ä¸ªåˆ—è¡¨é¡¹çš„è§†å›¾ // æ ¹æ®å¸ƒå±€æ–‡ä»¶item_base.xmlç”Ÿæˆè½¬æ¢è§†å›¾å¯¹è±¡ View view = LayoutInflater.from(mContext).inflate(R.layout.item_base, null); ImageView iv_icon = view.findViewById(R.id.iv_icon); // è·å–å›¾æ ‡è§†å›¾ TextView tv_name = view.findViewById(R.id.tv_name); // è·å–åç§°è§†å›¾ TextView tv_desc = view.findViewById(R.id.tv_desc); // è·å–æè¿°è§†å›¾ // ç»™æ§ä»¶è®¾ç½®æ•°æ® Planet planet = mPlanetList.get(position); // è·å–å½“å‰æ˜Ÿçƒå¯¹è±¡ iv_icon.setImageResource(planet.image); // è®¾ç½®å›¾æ ‡èµ„æº tv_name.setText(planet.name); // è®¾ç½®æ˜Ÿçƒåç§° tv_desc.setText(planet.desc); // è®¾ç½®æ˜Ÿçƒæè¿° return view; // è¿”å›ç”Ÿæˆçš„è§†å›¾ } } item_base.xml \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;LinearLayout xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34; xmlns:tools=\u0026#34;http://schemas.android.com/tools\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:orientation=\u0026#34;horizontal\u0026#34;\u0026gt; \u0026lt;ImageView android:id=\u0026#34;@+id/iv_icon\u0026#34; android:layout_width=\u0026#34;0dp\u0026#34; android:layout_height=\u0026#34;60dp\u0026#34; android:layout_weight=\u0026#34;1\u0026#34; tools:src=\u0026#34;@drawable/diqiu\u0026#34; /\u0026gt; \u0026lt;LinearLayout android:layout_width=\u0026#34;0dp\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34; android:layout_weight=\u0026#34;3\u0026#34; android:orientation=\u0026#34;vertical\u0026#34;\u0026gt; \u0026lt;TextView android:id=\u0026#34;@+id/tv_name\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:text=\u0026#34;åœ°çƒ\u0026#34; android:textColor=\u0026#34;@color/black\u0026#34; android:textSize=\u0026#34;20sp\u0026#34; /\u0026gt; \u0026lt;TextView android:id=\u0026#34;@+id/tv_desc\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34; android:text=\u0026#34;åœ°çƒ\u0026#34; android:textColor=\u0026#34;@color/black\u0026#34; android:textSize=\u0026#34;12sp\u0026#34; tools:text=\u0026#34;åœ°çƒå¿«ä¸€ç‚¹æ¯ç­å§ï¼åœ°çƒå¿«ä¸€ç‚¹æ¯ç­å§ï¼åœ°çƒå¿«ä¸€ç‚¹æ¯ç­å§ï¼åœ°çƒå¿«ä¸€ç‚¹æ¯ç­å§ï¼åœ°çƒå¿«ä¸€ç‚¹æ¯ç­å§ï¼åœ°çƒå¿«ä¸€ç‚¹æ¯ç­å§ï¼\u0026#34;/\u0026gt; \u0026lt;/LinearLayout\u0026gt; \u0026lt;/LinearLayout\u0026gt; BaseAdapterActivity.java package com.showguan.chapter08; // åŒ…å public class BaseAdapterActivity extends AppCompatActivity implements AdapterView.OnItemSelectedListener { // å®šä¹‰æ´»åŠ¨ç±»ï¼Œå®ç°é€‰é¡¹é€‰æ‹©ç›‘å¬å™¨ private static final String[] starArray = new String[]{ // å®šä¹‰æ˜Ÿçƒåç§°æ•°ç»„ \u0026#34;æ°´æ˜Ÿ\u0026#34;, \u0026#34;é‡‘æ˜Ÿ\u0026#34;, \u0026#34;åœ°çƒ\u0026#34;, \u0026#34;ç«æ˜Ÿ\u0026#34;, \u0026#34;æœ¨æ˜Ÿ\u0026#34;, \u0026#34;åœŸæ˜Ÿ\u0026#34;, \u0026#34;å¤©ç‹æ˜Ÿ\u0026#34;, \u0026#34;æµ·ç‹æ˜Ÿ\u0026#34; }; private List\u0026lt;Planet\u0026gt; planetList; // å­˜å‚¨Planetå¯¹è±¡çš„åˆ—è¡¨ @Override protected void onCreate(Bundle savedInstanceState) { // æ´»åŠ¨åˆ›å»ºæ—¶è°ƒç”¨ super.onCreate(savedInstanceState); // è°ƒç”¨çˆ¶ç±»çš„onCreateæ–¹æ³• setContentView(R.layout.activity_base_adapter); // è®¾ç½®æ´»åŠ¨çš„å¸ƒå±€æ–‡ä»¶ Spinner sp_planet = findViewById(R.id.sp_planet); // è·å–Spinneræ§ä»¶ planetList = Planet.getDefaultList(); // è·å–é»˜è®¤çš„æ˜Ÿçƒåˆ—è¡¨ PlanetBaseAdapter adapter = new PlanetBaseAdapter(this, planetList); // åˆ›å»ºé€‚é…å™¨ sp_planet.setAdapter(adapter); // ä¸ºSpinnerè®¾ç½®é€‚é…å™¨ sp_planet.setSelection(0); // é»˜è®¤é€‰ä¸­ç¬¬0é¡¹ sp_planet.setOnItemSelectedListener(this); // è®¾ç½®é€‰é¡¹é€‰ä¸­ç›‘å¬å™¨ } @Override public void onItemSelected(AdapterView\u0026lt;?\u0026gt; parent, View view, int position, long id) { // å½“é€‰æ‹©ä¸€ä¸ªé€‰é¡¹æ—¶è°ƒç”¨ ToastUtil.show(this, \u0026#34;æ‚¨é€‰æ‹©çš„æ˜¯\u0026#34; + planetList.get(position).name); // æ˜¾ç¤ºé€‰æ‹©çš„æ˜Ÿçƒåç§° } @Override public void onNothingSelected(AdapterView\u0026lt;?\u0026gt; parent) { // å½“æ²¡æœ‰é€‰é¡¹è¢«é€‰æ‹©æ—¶è°ƒç”¨ } } BaseAdapterä¼˜åŒ– @Override public View getView(int position, View convertView, ViewGroup parent) { // è·å–æ¯ä¸ªåˆ—è¡¨é¡¹çš„è§†å›¾ ViewHolder holder = null; if (convertView == null) { convertView = LayoutInflater.from(mContext).inflate(R.layout.item_base, null); holder = new ViewHolder(); holder.iv_icon = convertView.findViewById(R.id.iv_icon); // è·å–å›¾æ ‡è§†å›¾ holder.tv_name = convertView.findViewById(R.id.tv_name); // è·å–åç§°è§†å›¾ holder.tv_desc = convertView.findViewById(R.id.tv_desc); // è·å–æè¿°è§†å›¾ // å°†è§†å›¾æŒæœ‰è€…ä¿å­˜åˆ°è½¬æ¢è§†å›¾å½“ä¸­ convertView.setTag(holder); } else { holder = (ViewHolder) convertView.getTag(); } Planet planet = mPlanetList.get(position); holder.iv_icon.setImageResource(planet.image); holder.tv_name.setText(planet.name); holder.tv_desc.setText(planet.desc); return convertView; } åˆ—è¡¨è§†å›¾ListView XML \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;LinearLayout xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34; xmlns:app=\u0026#34;http://schemas.android.com/apk/res-auto\u0026#34; xmlns:tools=\u0026#34;http://schemas.android.com/tools\u0026#34; android:id=\u0026#34;@+id/main\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34; android:orientation=\u0026#34;vertical\u0026#34; tools:context=\u0026#34;.ListViewActivity\u0026#34;\u0026gt; \u0026lt;LinearLayout android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:orientation=\u0026#34;horizontal\u0026#34;\u0026gt; \u0026lt;CheckBox android:id=\u0026#34;@+id/ck_divider\u0026#34; android:layout_width=\u0026#34;0dp\u0026#34; android:layout_height=\u0026#34;40dp\u0026#34; android:layout_weight=\u0026#34;1\u0026#34; android:gravity=\u0026#34;start|center\u0026#34; android:text=\u0026#34;æ˜¾ç¤ºåˆ†å‰²çº¿\u0026#34; android:textSize=\u0026#34;17sp\u0026#34; /\u0026gt; \u0026lt;CheckBox android:id=\u0026#34;@+id/ck_bgc\u0026#34; android:layout_width=\u0026#34;0dp\u0026#34; android:layout_height=\u0026#34;40dp\u0026#34; android:layout_weight=\u0026#34;1\u0026#34; android:gravity=\u0026#34;start|center\u0026#34; android:text=\u0026#34;æ˜¾ç¤ºæŒ‰å‹èƒŒæ™¯\u0026#34; android:textSize=\u0026#34;17sp\u0026#34; /\u0026gt; \u0026lt;/LinearLayout\u0026gt; \u0026lt;ListView android:id=\u0026#34;@+id/lv_planet\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:divider=\u0026#34;@null\u0026#34; android:dividerHeight=\u0026#34;0dp\u0026#34; android:listSelector=\u0026#34;@color/transparent\u0026#34; /\u0026gt; \u0026lt;/LinearLayout\u0026gt; Java package com.showguan.chapter08; public class ListViewActivity extends AppCompatActivity implements AdapterView.OnItemClickListener, View.OnClickListener, CompoundButton.OnCheckedChangeListener { // æ˜Ÿçƒåˆ—è¡¨ private List\u0026lt;Planet\u0026gt; planetList; // åˆ†å‰²çº¿å¤é€‰æ¡† private CheckBox ck_divider; // èƒŒæ™¯è‰²å¤é€‰æ¡† private CheckBox ck_bgc; // åˆ—è¡¨è§†å›¾ private ListView lv_planet; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_list_view); // åˆå§‹åŒ–åˆ—è¡¨è§†å›¾ lv_planet = findViewById(R.id.lv_planet); // åˆå§‹åŒ–åˆ†å‰²çº¿å¤é€‰æ¡†å¹¶è®¾ç½®ç›‘å¬å™¨ ck_divider = findViewById(R.id.ck_divider); ck_divider.setOnCheckedChangeListener(this); // åˆå§‹åŒ–èƒŒæ™¯è‰²å¤é€‰æ¡†å¹¶è®¾ç½®ç›‘å¬å™¨ ck_bgc = findViewById(R.id.ck_bgc); ck_bgc.setOnCheckedChangeListener(this); // è·å–é»˜è®¤æ˜Ÿçƒåˆ—è¡¨ planetList = Planet.getDefaultList(); // åˆ›å»ºé€‚é…å™¨å¹¶è®¾ç½®ç»™åˆ—è¡¨è§†å›¾ PlanetBaseAdapter adapter = new PlanetBaseAdapter(this, planetList); lv_planet.setAdapter(adapter); // è®¾ç½®åˆ—è¡¨é¡¹ç‚¹å‡»ç›‘å¬å™¨ lv_planet.setOnItemClickListener(this); } @Override public void onItemClick(AdapterView\u0026lt;?\u0026gt; parent, View view, int position, long id) { // å½“åˆ—è¡¨é¡¹è¢«ç‚¹å‡»æ—¶ï¼Œæ˜¾ç¤ºå¯¹åº”æ˜Ÿçƒåç§°çš„ Toast æ¶ˆæ¯ ToastUtil.show(this, \u0026#34;æ‚¨é€‰æ‹©çš„æ˜¯\u0026#34; + planetList.get(position).name); } @Override public void onClick(View v) { // ç©ºå®ç°ï¼Œæš‚æ—¶æ²¡æœ‰éœ€è¦å¤„ç†çš„ç‚¹å‡»äº‹ä»¶ } @Override public void onCheckedChanged(CompoundButton buttonView, boolean isChecked) { // å½“å¤é€‰æ¡†çŠ¶æ€æ”¹å˜æ—¶è°ƒç”¨ if (buttonView.getId() == R.id.ck_divider) { // å¤„ç†åˆ†å‰²çº¿å¤é€‰æ¡†çš„çŠ¶æ€æ”¹å˜ if (ck_divider.isChecked()) { // å¦‚æœå¤é€‰æ¡†è¢«é€‰ä¸­ï¼Œè®¾ç½®é»‘è‰²åˆ†å‰²çº¿å’Œé«˜åº¦ Drawable black = getResources().getDrawable(R.color.black, getTheme()); lv_planet.setDivider(black); lv_planet.setDividerHeight(Utils.dip2px(this, 1)); } else { // å¦‚æœå¤é€‰æ¡†æœªé€‰ä¸­ï¼Œç§»é™¤åˆ†å‰²çº¿ lv_planet.setDivider(null); lv_planet.setDividerHeight(Utils.dip2px(this, 0)); } } else if (buttonView.getId() == R.id.ck_bgc) { // å¤„ç†èƒŒæ™¯è‰²å¤é€‰æ¡†çš„çŠ¶æ€æ”¹å˜ if (ck_bgc.isChecked()) { // å¦‚æœå¤é€‰æ¡†è¢«é€‰ä¸­ï¼Œè®¾ç½®åˆ—è¡¨é¡¹çš„é€‰æ‹©å™¨èƒŒæ™¯ lv_planet.setSelector(R.drawable.list_selector); } else { // å¦‚æœå¤é€‰æ¡†æœªé€‰ä¸­ï¼Œè®¾ç½®é€æ˜èƒŒæ™¯ Drawable transparent = getResources().getDrawable(R.color.transparent, getTheme()); lv_planet.setSelector(transparent); } } } } ListViewæ³¨æ„ç‚¹ åœ¨ListViewä¸­æ·»åŠ æŒ‰é’®å¹¶è®¾ç½®ç›‘å¬æ—¶ï¼Œ ä¼šå¯¼è‡´åŸæ¥çš„ListViewä¸­onItemClickæ— æ•ˆï¼Œæ­¤æ—¶éœ€è¦åœ¨XMLæ–‡ä»¶ä¸­è®¾ç½®android:descendantFocusability=\u0026quot;blocksDescendantsæ‰èƒ½åŒæ—¶ç”Ÿæ•ˆã€‚\nandroid:descendantFocusability=\u0026#34;blocksDescendants\u0026#34; ç½‘æ ¼è§†å›¾GridView XML \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;LinearLayout xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34; xmlns:app=\u0026#34;http://schemas.android.com/apk/res-auto\u0026#34; xmlns:tools=\u0026#34;http://schemas.android.com/tools\u0026#34; android:id=\u0026#34;@+id/main\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:orientation=\u0026#34;vertical\u0026#34;\u0026gt; \u0026lt;GridView android:id=\u0026#34;@+id/gv_planet\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:numColumns=\u0026#34;2\u0026#34; android:background=\u0026#34;@color/pink\u0026#34; android:columnWidth=\u0026#34;100dp\u0026#34; android:verticalSpacing=\u0026#34;10dp\u0026#34; android:stretchMode=\u0026#34;none\u0026#34;/\u0026gt; \u0026lt;/LinearLayout\u0026gt; Java package com.showguan.chapter08; import android.os.Bundle; import android.view.View; import android.widget.AdapterView; import android.widget.GridView; import androidx.appcompat.app.AppCompatActivity; import com.showguan.chapter08.adapter.PlanetGridAdapter; import com.showguan.chapter08.entity.Planet; import com.showguan.chapter08.util.ToastUtil; import java.util.List; // GridViewActivity ç±»å®ç°äº† AdapterView.OnItemClickListener æ¥å£ public class GridViewActivity extends AppCompatActivity implements AdapterView.OnItemClickListener { // å£°æ˜ä¸€ä¸ª Planet å¯¹è±¡çš„ Listï¼Œç”¨äºå­˜å‚¨è¡Œæ˜Ÿæ•°æ® private List\u0026lt;Planet\u0026gt; planetList; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); // è®¾ç½®æ´»åŠ¨çš„å¸ƒå±€æ–‡ä»¶ setContentView(R.layout.activity_grid_view); // è·å– GridView æ§ä»¶ GridView gv_planet = findViewById(R.id.gv_planet); // è·å–é»˜è®¤çš„è¡Œæ˜Ÿåˆ—è¡¨ planetList = Planet.getDefaultList(); // åˆ›å»ºä¸€ä¸ªé€‚é…å™¨ï¼Œå°†è¡Œæ˜Ÿåˆ—è¡¨ä¼ é€’ç»™é€‚é…å™¨ PlanetGridAdapter adapter = new PlanetGridAdapter(this, planetList); // è®¾ç½® GridView çš„é€‚é…å™¨ gv_planet.setAdapter(adapter); // è®¾ç½® GridView çš„ item ç‚¹å‡»äº‹ä»¶ç›‘å¬å™¨ gv_planet.setOnItemClickListener(this); // è®¾ç½® GridView çš„æ‹‰ä¼¸æ¨¡å¼ gv_planet.setStretchMode(GridView.STRETCH_COLUMN_WIDTH); } // å½“ GridView çš„ item è¢«ç‚¹å‡»æ—¶è°ƒç”¨æ­¤æ–¹æ³• @Override public void onItemClick(AdapterView\u0026lt;?\u0026gt; parent, View view, int position, long id) { // æ˜¾ç¤ºä¸€ä¸ª Toastï¼Œæç¤ºç”¨æˆ·é€‰æ‹©äº†å“ªä¸ªè¡Œæ˜Ÿ ToastUtil.show(this, \u0026#34;ä½ é€‰æ‹©äº†\u0026#34; + planetList.get(position).name); } } ä½¿ç”¨GridViewé‡æ„è´­ç‰©è½¦ XML \u0026lt;LinearLayout xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34; android:background=\u0026#34;@color/AntiqueWhite1\u0026#34; android:orientation=\u0026#34;vertical\u0026#34;\u0026gt; \u0026lt;include layout=\u0026#34;@layout/title_shopping\u0026#34; /\u0026gt; \u0026lt;GridView android:id=\u0026#34;@+id/gv_channel\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:numColumns=\u0026#34;2\u0026#34; /\u0026gt; \u0026lt;/LinearLayout\u0026gt; Java GoodsGridAdapter.java package com.showguan.chapter08.adapter; import android.content.Context; import android.net.Uri; import android.view.LayoutInflater; import android.view.View; import android.view.ViewGroup; import android.widget.BaseAdapter; import android.widget.Button; import android.widget.ImageView; import android.widget.TextView; import com.showguan.chapter08.R; import com.showguan.chapter08.ShoppingChannelActivity; import com.showguan.chapter08.entity.GoodsInfo; import java.util.List; public class GoodsGridAdapter extends BaseAdapter { public Context mContext; public List\u0026lt;GoodsInfo\u0026gt; mGoodsInfo; private AddCartListener mAddCartListener; public GoodsGridAdapter(Context mContext, List\u0026lt;GoodsInfo\u0026gt; mGoodsInfo, AddCartListener addCartListener) { this.mContext = mContext; this.mGoodsInfo = mGoodsInfo; this.mAddCartListener = addCartListener; } @Override public int getCount() { return mGoodsInfo.size(); } @Override public Object getItem(int position) { return mGoodsInfo.get(position); } @Override public long getItemId(int position) { return position; } @Override public View getView(int position, View convertView, ViewGroup parent) { GoodsInfo goodsInfo = mGoodsInfo.get(position); ViewHolder holder; if(convertView == null){ holder = new ViewHolder(); // å°† XML å¸ƒå±€æ–‡ä»¶æ‰©å±•ä¸ºç›¸åº”çš„ View å¯¹è±¡çš„ç±» convertView = LayoutInflater.from(mContext).inflate(R.layout.item_goods, null); holder.iv_thumb = convertView.findViewById(R.id.iv_thumb); holder.tv_name = convertView.findViewById(R.id.tv_name); holder.tv_price = convertView.findViewById(R.id.tv_price); holder.btn_add = convertView.findViewById(R.id.btn_add); convertView.setTag(holder); }else{ holder = (ViewHolder) convertView.getTag(); } GoodsInfo info = mGoodsInfo.get(position); holder.iv_thumb.setImageURI(Uri.parse(info.picPath)); holder.tv_name.setText(info.name); holder.tv_price.setText(String.valueOf(info.price)); holder.btn_add.setOnClickListener(v -\u0026gt; { // ShoppingChannelActivity activity = (ShoppingChannelActivity) mContext; // activity.addToCart(info.id, info.name); mAddCartListener.addToCart(info.id, info.name); }); return convertView; } public final class ViewHolder{ public ImageView iv_thumb; public TextView tv_name; public TextView tv_price; public Button btn_add; } public interface AddCartListener{ abstract void addToCart(int goodsId, String goodsName); } } ShoppingChannelActivity.java package com.showguan.chapter08; // ShoppingChannelActivity ç±»å®ç°äº† GoodsGridAdapter.AddCartListener å’Œ View.OnClickListener æ¥å£ public class ShoppingChannelActivity extends AppCompatActivity implements GoodsGridAdapter.AddCartListener, View.OnClickListener { private static String TAG = \u0026#34;Kennem\u0026#34;; // æ—¥å¿—æ ‡ç­¾ private ShoppingDBHelper mDBHelper; // æ•°æ®åº“åŠ©æ‰‹å¯¹è±¡ private TextView tv_title; // æ˜¾ç¤ºæ ‡é¢˜çš„ TextView private GridView gv_channel; // æ˜¾ç¤ºå•†å“çš„ GridView private TextView tv_count; // æ˜¾ç¤ºè´­ç‰©è½¦å•†å“æ•°é‡çš„ TextView @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); // è®¾ç½®æ´»åŠ¨çš„å¸ƒå±€æ–‡ä»¶ setContentView(R.layout.activity_shopping_channel); // åˆå§‹åŒ–æ§ä»¶ tv_title = findViewById(R.id.tv_title); tv_title.setText(\u0026#34;æ‰‹æœºå•†åŸ\u0026#34;); tv_count = findViewById(R.id.tv_count); gv_channel = findViewById(R.id.gv_channel); // è®¾ç½®ç‚¹å‡»äº‹ä»¶ç›‘å¬å™¨ findViewById(R.id.iv_back).setOnClickListener(this); findViewById(R.id.iv_cart).setOnClickListener(this); // åˆå§‹åŒ–æ•°æ®åº“åŠ©æ‰‹å¹¶æ‰“å¼€è¯»å†™é“¾æ¥ mDBHelper = ShoppingDBHelper.getInstance(this); mDBHelper.openWriteLink(); mDBHelper.openReadLink(); // æ˜¾ç¤ºå•†å“ä¿¡æ¯ showGoods(); } @Override protected void onResume() { super.onResume(); // åœ¨æ´»åŠ¨æ¢å¤æ—¶ï¼Œæ˜¾ç¤ºè´­ç‰©è½¦çš„æ€»ä¿¡æ¯ showCartTotalInfo(); } // æ˜¾ç¤ºè´­ç‰©è½¦æ€»ä¿¡æ¯çš„æ–¹æ³• private void showCartTotalInfo() { int count = mDBHelper.countCartInfo(); MyApplication.getInstance().goodsCount = count; tv_count.setText(String.valueOf(count)); } // æ˜¾ç¤ºå•†å“ä¿¡æ¯çš„æ–¹æ³• private void showGoods() { List\u0026lt;GoodsInfo\u0026gt; list = mDBHelper.queryAllGoods(); GoodsGridAdapter adapter = new GoodsGridAdapter(this, list, this); gv_channel.setAdapter(adapter); } // æ·»åŠ å•†å“åˆ°è´­ç‰©è½¦çš„æ–¹æ³• @Override public void addToCart(int goodsId, String name) { mDBHelper.insertCartInfo(goodsId); int count = ++MyApplication.getInstance().goodsCount; tv_count.setText(String.valueOf(count)); ToastUtil.show(this, \u0026#34;å·²æ·»åŠ ä¸€éƒ¨ \u0026#34; + name + \u0026#34;åˆ°è´­ç‰©è½¦æˆåŠŸï¼\u0026#34;); } @Override protected void onDestroy() { super.onDestroy(); // åœ¨æ´»åŠ¨é”€æ¯æ—¶ï¼Œå…³é—­æ•°æ®åº“é“¾æ¥ mDBHelper.closeLink(); } // å¤„ç†ç‚¹å‡»äº‹ä»¶çš„æ–¹æ³• @Override public void onClick(View v) { if (v.getId() == R.id.iv_back) { // ç‚¹å‡»è¿”å›æŒ‰é’®æ—¶ï¼Œç»“æŸå½“å‰æ´»åŠ¨ finish(); } else if (v.getId() == R.id.iv_cart) { // ç‚¹å‡»è´­ç‰©è½¦æŒ‰é’®æ—¶ï¼Œå¯åŠ¨è´­ç‰©è½¦æ´»åŠ¨ Intent intent = new Intent(this, ShoppingCartActivity.class); intent.setFlags(Intent.FLAG_ACTIVITY_SINGLE_TOP); startActivity(intent); } } @Override public void onPointerCaptureChanged(boolean hasCapture) { super.onPointerCaptureChanged(hasCapture); } } ViewPager XML \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;LinearLayout xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34; xmlns:app=\u0026#34;http://schemas.android.com/apk/res-auto\u0026#34; xmlns:tools=\u0026#34;http://schemas.android.com/tools\u0026#34; android:id=\u0026#34;@+id/main\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34; android:orientation=\u0026#34;vertical\u0026#34; tools:context=\u0026#34;.ViewPageActivity\u0026#34;\u0026gt; \u0026lt;androidx.viewpager.widget.ViewPager android:id=\u0026#34;@+id/vp_content\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;300dp\u0026#34; /\u0026gt; \u0026lt;/LinearLayout\u0026gt; Java package com.showguan.chapter08; import android.os.Bundle; import android.view.View; import androidx.activity.EdgeToEdge; import androidx.appcompat.app.AppCompatActivity; import androidx.core.graphics.Insets; import androidx.core.view.ViewCompat; import androidx.core.view.WindowInsetsCompat; import androidx.viewpager.widget.ViewPager; import com.showguan.chapter08.adapter.ImagePagerAdapter; import com.showguan.chapter08.entity.GoodsInfo; import com.showguan.chapter08.util.ToastUtil; import java.util.ArrayList; public class ViewPageActivity extends AppCompatActivity implements ViewPager.OnPageChangeListener { // å•†å“ä¿¡æ¯åˆ—è¡¨ private ArrayList\u0026lt;GoodsInfo\u0026gt; mGoodsList; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); // è®¾ç½®å½“å‰æ´»åŠ¨çš„å¸ƒå±€æ–‡ä»¶ setContentView(R.layout.activity_view_page); // è·å– ViewPager æ§ä»¶ ViewPager vp_content = findViewById(R.id.vp_content); // è·å–é»˜è®¤çš„å•†å“ä¿¡æ¯åˆ—è¡¨ mGoodsList = GoodsInfo.getDefaultList(); // åˆ›å»º ImagePagerAdapter é€‚é…å™¨ ImagePagerAdapter adapter = new ImagePagerAdapter(this, mGoodsList); // ä¸º ViewPager è®¾ç½®é€‚é…å™¨ vp_content.setAdapter(adapter); // è®¾ç½®é¡µé¢å˜æ›´ç›‘å¬å™¨ vp_content.addOnPageChangeListener(this); } /** * åœ¨ç¿»é¡µè¿‡ç¨‹ä¸­è§¦å‘ * @param position å½“å‰é¡µé¢ä½ç½® * @param positionOffset é¡µé¢åç§»ç™¾åˆ†æ¯” * @param positionOffsetPixels é¡µé¢åç§»åƒç´  */ @Override public void onPageScrolled(int position, float positionOffset, int positionOffsetPixels) { // å¯ä»¥åœ¨è¿™é‡Œå®ç°é¡µé¢æ»šåŠ¨æ—¶çš„ç›¸å…³é€»è¾‘ } /** * é¡µé¢é€‰ä¸­æ—¶è§¦å‘ * @param position é€‰ä¸­é¡µé¢çš„ä½ç½® */ @Override public void onPageSelected(int position) { // æ˜¾ç¤ºå½“å‰é€‰ä¸­é¡µé¢çš„å•†å“åç§° ToastUtil.show(this, \u0026#34;å½“å‰æ»‘åŠ¨çš„é¡µé¢ä¸º \u0026#34; + mGoodsList.get(position).name); } /** * ç¿»é¡µçŠ¶æ€æ”¹å˜æ—¶è§¦å‘ * @param state é¡µé¢çŠ¶æ€ */ @Override public void onPageScrollStateChanged(int state) { // å¯ä»¥åœ¨è¿™é‡Œå®ç°é¡µé¢æ»šåŠ¨çŠ¶æ€å˜åŒ–æ—¶çš„ç›¸å…³é€»è¾‘ } } ç¿»é¡µæ ‡ç­¾æ PagerTabStrip XML \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;LinearLayout xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34; xmlns:app=\u0026#34;http://schemas.android.com/apk/res-auto\u0026#34; xmlns:tools=\u0026#34;http://schemas.android.com/tools\u0026#34; android:id=\u0026#34;@+id/main\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34; android:orientation=\u0026#34;vertical\u0026#34; tools:context=\u0026#34;.PagerTabActivity\u0026#34;\u0026gt; \u0026lt;androidx.viewpager.widget.ViewPager android:id=\u0026#34;@+id/vp_content\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34;\u0026gt; \u0026lt;androidx.viewpager.widget.PagerTabStrip android:id=\u0026#34;@+id/pts_tab\u0026#34; android:layout_width=\u0026#34;wrap_content\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; /\u0026gt; \u0026lt;/androidx.viewpager.widget.ViewPager\u0026gt; \u0026lt;/LinearLayout\u0026gt; Java package com.showguan.chapter08; import android.graphics.Color; import android.os.Bundle; import android.util.TypedValue; import android.view.View; import androidx.activity.EdgeToEdge; import androidx.appcompat.app.AppCompatActivity; import androidx.core.graphics.Insets; import androidx.core.view.ViewCompat; import androidx.core.view.WindowInsetsCompat; import androidx.viewpager.widget.PagerTabStrip; import androidx.viewpager.widget.ViewPager; import com.showguan.chapter08.adapter.ImagePagerAdapter; import com.showguan.chapter08.entity.GoodsInfo; import com.showguan.chapter08.util.ToastUtil; import java.util.ArrayList; public class PagerTabActivity extends AppCompatActivity implements ViewPager.OnPageChangeListener { // å•†å“ä¿¡æ¯åˆ—è¡¨ private ArrayList\u0026lt;GoodsInfo\u0026gt; mGoodsList; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_pager_tab); initPagerStrip(); initViewPager(); } // åˆå§‹åŒ–ç¿»é¡µæ ‡ç­¾æ  private void initPagerStrip() { PagerTabStrip pts_tab = findViewById(R.id.pts_tab); pts_tab.setTextSize(TypedValue.COMPLEX_UNIT_SP, 20); pts_tab.setTextColor(Color.GRAY); } private void initViewPager() { // è·å– ViewPager æ§ä»¶ ViewPager vp_content = findViewById(R.id.vp_content); // è·å–é»˜è®¤çš„å•†å“ä¿¡æ¯åˆ—è¡¨ mGoodsList = GoodsInfo.getDefaultList(); // åˆ›å»º ImagePagerAdapter é€‚é…å™¨ ImagePagerAdapter adapter = new ImagePagerAdapter(this, mGoodsList); // ä¸º ViewPager è®¾ç½®é€‚é…å™¨ vp_content.setAdapter(adapter); // è®¾ç½®é¡µé¢å˜æ›´ç›‘å¬å™¨ vp_content.addOnPageChangeListener(this); vp_content.setCurrentItem(2); } @Override public void onPageScrolled(int position, float positionOffset, int positionOffsetPixels) { } @Override public void onPageSelected(int position) { ToastUtil.show(this, \u0026#34;å½“å‰æ»‘åŠ¨çš„é¡µé¢ä¸º \u0026#34; + mGoodsList.get(position).name); } @Override public void onPageScrollStateChanged(int state) { } } ç®€å•çš„å¯åŠ¨å¼•å¯¼é¡µ XML activity_launch_simple.xml \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;LinearLayout xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34; xmlns:app=\u0026#34;http://schemas.android.com/apk/res-auto\u0026#34; xmlns:tools=\u0026#34;http://schemas.android.com/tools\u0026#34; android:id=\u0026#34;@+id/main\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34; android:orientation=\u0026#34;vertical\u0026#34; tools:context=\u0026#34;.LaunchSimpleActivity\u0026#34;\u0026gt; \u0026lt;androidx.viewpager.widget.ViewPager android:id=\u0026#34;@+id/vp_launch\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34;/\u0026gt; \u0026lt;/LinearLayout\u0026gt; item_launch.xml \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;RelativeLayout xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34; xmlns:app=\u0026#34;http://schemas.android.com/apk/res-auto\u0026#34; xmlns:tools=\u0026#34;http://schemas.android.com/tools\u0026#34; android:id=\u0026#34;@+id/main\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34; android:orientation=\u0026#34;vertical\u0026#34; tools:context=\u0026#34;.LaunchSimpleActivity\u0026#34;\u0026gt; \u0026lt;ImageView android:id=\u0026#34;@+id/iv_launch\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34; android:scaleType=\u0026#34;fitXY\u0026#34; /\u0026gt; \u0026lt;RadioGroup android:id=\u0026#34;@+id/rg_indicate\u0026#34; android:layout_width=\u0026#34;wrap_content\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:layout_alignParentBottom=\u0026#34;true\u0026#34; android:layout_centerHorizontal=\u0026#34;true\u0026#34; android:orientation=\u0026#34;horizontal\u0026#34; android:paddingBottom=\u0026#34;20dp\u0026#34; /\u0026gt; \u0026lt;Button android:id=\u0026#34;@+id/btn_launch\u0026#34; android:layout_width=\u0026#34;wrap_content\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:layout_centerInParent=\u0026#34;true\u0026#34; android:text=\u0026#34;ç‚¹å‡»å¼€å§‹ç¾å¥½ç”Ÿæ´»\u0026#34; android:textColor=\u0026#34;@color/blue\u0026#34; android:textSize=\u0026#34;22sp\u0026#34; android:visibility=\u0026#34;gone\u0026#34; /\u0026gt; \u0026lt;/RelativeLayout\u0026gt; Java LaunchSimpleActivity.java package com.showguan.chapter08; import android.annotation.SuppressLint; import android.os.Bundle; import android.view.View; import androidx.activity.EdgeToEdge; import androidx.appcompat.app.AppCompatActivity; import androidx.core.graphics.Insets; import androidx.core.view.ViewCompat; import androidx.core.view.WindowInsetsCompat; import androidx.viewpager.widget.ViewPager; import com.showguan.chapter08.adapter.LaunchPagerAdapter; public class LaunchSimpleActivity extends AppCompatActivity { // å®šä¹‰ä¸€ä¸ªæ•°ç»„ï¼Œç”¨äºå­˜å‚¨å¯åŠ¨ç•Œé¢çš„èƒŒæ™¯å›¾ç‰‡èµ„æºID private static int[] launchImageArray = { R.drawable.guide_bg1, R.drawable.guide_bg2, R.drawable.guide_bg3, R.drawable.guide_bg4 }; // å½“Activityè¢«åˆ›å»ºæ—¶è°ƒç”¨ @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); // è®¾ç½®å¸ƒå±€æ–‡ä»¶ setContentView(R.layout.activity_launch_simple); // æŸ¥æ‰¾å¸ƒå±€æ–‡ä»¶ä¸­çš„ViewPageræ§ä»¶ ViewPager vp_launch = findViewById(R.id.vp_launch); // åˆ›å»ºé€‚é…å™¨å¯¹è±¡ï¼Œå°†å›¾ç‰‡æ•°ç»„ä¼ é€’è¿›å» LaunchPagerAdapter adapter = new LaunchPagerAdapter(this, launchImageArray); // ä¸ºViewPagerè®¾ç½®é€‚é…å™¨ vp_launch.setAdapter(adapter); } } LaunchPagerAdapter.java package com.showguan.chapter08.adapter; import android.content.Context; import android.view.View; import android.view.ViewGroup; import android.widget.ImageView; import androidx.annotation.NonNull; import androidx.annotation.Nullable; import androidx.viewpager.widget.PagerAdapter; import com.showguan.chapter08.ViewPageActivity; import com.showguan.chapter08.entity.GoodsInfo; import java.util.ArrayList; import java.util.List; public class ImagePagerAdapter extends PagerAdapter { private final Context mContext; private final ArrayList\u0026lt;GoodsInfo\u0026gt; mGoodsList; private List\u0026lt;ImageView\u0026gt; mViewList = new ArrayList\u0026lt;\u0026gt;(); public ImagePagerAdapter(Context context, ArrayList\u0026lt;GoodsInfo\u0026gt; goodsInfos) { this.mContext = context; this.mGoodsList = goodsInfos; for (GoodsInfo goodsInfo : mGoodsList) { ImageView view = new ImageView(mContext); view.setLayoutParams(new ViewGroup.LayoutParams( ViewGroup.LayoutParams.MATCH_PARENT, ViewGroup.LayoutParams.WRAP_CONTENT )); view.setImageResource(goodsInfo.pic); mViewList.add(view); } } @Override public int getCount() { return mViewList.size(); } @Override public boolean isViewFromObject(@NonNull View view, @NonNull Object object) { return (view == object); } // å®ä¾‹åŒ–æŒ‡å®šä½ç½®çš„é¡µé¢ï¼Œå¹¶å°†å…¶æ·»åŠ åˆ°å®¹å™¨ä¸­ @NonNull @Override public Object instantiateItem(@NonNull ViewGroup container, int position) { ImageView item = mViewList.get(position); container.addView(item); return item; } // ä»å®¹å™¨ä¸­é”€æ¯æŒ‡å®šä½ç½®çš„é¡µé¢ @Override public void destroyItem(@NonNull ViewGroup container, int position, @NonNull Object object) { container.removeView(mViewList.get(position)); } @Nullable @Override public CharSequence getPageTitle(int position) { return mGoodsList.get(position).name; } } ç¢ç‰‡Fragment â­â­â­â­â­ ä¼ ç»Ÿçš„Activityå¹¶ä¸èƒ½å¾ˆå¥½çš„å¤„ç†å¤§å±é—®é¢˜ï¼Œæ‰€ä»¥æ€¥éœ€ä¸€ä¸ªç¢ç‰‡åŒ–çš„ä¸œè¥¿èƒ½å¤Ÿåˆ’åŒºåŸŸçš„å±•ç¤ºå†…å®¹ï¼Œå¹¶ä¸”æœ‰å±äºè‡ªå·±çš„ç‹¬ç«‹å¯æ“ä½œç©ºé—´ï¼Œæ‰€ä»¥å°±å‡ºç°äº†Fragmentã€‚\nStaticFragment XML activity_fragement_static.xml \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;LinearLayout xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34; xmlns:app=\u0026#34;http://schemas.android.com/apk/res-auto\u0026#34; xmlns:tools=\u0026#34;http://schemas.android.com/tools\u0026#34; android:id=\u0026#34;@+id/main\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34; tools:context=\u0026#34;.FragmentStaticActivity\u0026#34; android:orientation=\u0026#34;vertical\u0026#34;\u0026gt; \u0026lt;androidx.fragment.app.FragmentContainerView android:id=\u0026#34;@+id/fragment_static\u0026#34; android:name=\u0026#34;com.showguan.chapter08.fragment.StaticFragment\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;60dp\u0026#34;/\u0026gt; \u0026lt;TextView android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:textSize=\u0026#34;@dimen/common_font_size\u0026#34; android:gravity=\u0026#34;center\u0026#34; android:text=\u0026#34;æ¯ä¸ªé¡µé¢çš„å…·ä½“å†…å®¹ï¼š\u0026#34;/\u0026gt; \u0026lt;/LinearLayout\u0026gt; fragment_static.xml \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;LinearLayout xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34; xmlns:tools=\u0026#34;http://schemas.android.com/tools\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:background=\u0026#34;@color/pink\u0026#34; android:orientation=\u0026#34;horizontal\u0026#34; tools:context=\u0026#34;.fragment.StaticFragment\u0026#34;\u0026gt; \u0026lt;TextView android:id=\u0026#34;@+id/tv_adv\u0026#34; android:layout_width=\u0026#34;0dp\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34; android:layout_weight=\u0026#34;1\u0026#34; android:gravity=\u0026#34;center\u0026#34; android:text=\u0026#34;å¹¿å‘Šå›¾ç‰‡\u0026#34; android:textColor=\u0026#34;@color/brown\u0026#34; android:textSize=\u0026#34;@dimen/common_font_size\u0026#34; /\u0026gt; \u0026lt;ImageView android:id=\u0026#34;@+id/iv_adv\u0026#34; android:layout_width=\u0026#34;0dp\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34; android:layout_weight=\u0026#34;4\u0026#34; android:scaleType=\u0026#34;fitCenter\u0026#34; android:src=\u0026#34;@drawable/adv\u0026#34; /\u0026gt; \u0026lt;/LinearLayout\u0026gt; Java FragmentStaticActivity.java package com.showguan.chapter08; import com.showguan.chapter08.adapter.PlanetBaseAdapter; import com.showguan.chapter08.entity.Planet; public class FragmentStaticActivity extends AppCompatActivity { private static final String TAG = \u0026#34;fragment\u0026#34;; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_fragement_static); } } StaticFragment.java package com.showguan.chapter08.fragment; import android.content.Context; import android.os.Bundle; import androidx.annotation.NonNull; import androidx.annotation.Nullable; import androidx.fragment.app.Fragment; import android.util.Log; import android.view.LayoutInflater; import android.view.View; import android.view.ViewGroup; import com.showguan.chapter08.R; public class StaticFragment extends Fragment { private static final String TAG = \u0026#34;fragment\u0026#34;; @Override public void onAttach(@NonNull Context context) { super.onAttach(context); Log.d(TAG, \u0026#34;Fragment onAttach: \u0026#34;); } @Override public void onCreate(@Nullable Bundle savedInstanceState) { super.onCreate(savedInstanceState); Log.d(TAG, \u0026#34;Fragment onCreate: \u0026#34;); } @Override public void onStart() { super.onStart(); Log.d(TAG, \u0026#34;Fragment onStart: \u0026#34;); } @Override public void onResume() { super.onResume(); Log.d(TAG, \u0026#34;Fragment onResume: \u0026#34;); } @Override public void onPause() { super.onPause(); Log.d(TAG, \u0026#34;Fragment onPause: \u0026#34;); } @Override public void onStop() { super.onStop(); Log.d(TAG, \u0026#34;Fragment onStop: \u0026#34;); } @Override public void onDestroy() { super.onDestroy(); Log.d(TAG, \u0026#34;Fragment onDestroy: \u0026#34;); } @Override public void onDetach() { super.onDetach(); Log.d(TAG, \u0026#34;Fragment onDetach: \u0026#34;); } @Nullable @Override public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) { Log.d(TAG, \u0026#34;Fragment onCreateView: \u0026#34;); return inflater.inflate(R.layout.fragment_static, container, false); } @Override public void onActivityCreated(@Nullable Bundle savedInstanceState) { super.onActivityCreated(savedInstanceState); Log.d(TAG, \u0026#34;Fragment onActivityCreated: \u0026#34;); } } Fragmentæ³¨å†Œ é™æ€æ³¨å†Œåœ¨å¸ƒå±€æ–‡ä»¶ä¸­ç›´æ¥æŒ‡å®šFragmentï¼Œè€ŒåŠ¨æ€æ³¨å†Œç›´åˆ°ä»£ç ä¸­æ‰åŠ¨æ€æ·»åŠ Fragmentã€‚\nFragmentå£°æ˜å‘¨æœŸ DynamicFragment ç”¨DynamicFragmenté‡æ„æ™®é€šçš„PagerTabStrip\nXML activity_fragment_dynamic.xml \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;LinearLayout xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34; xmlns:tools=\u0026#34;http://schemas.android.com/tools\u0026#34; android:id=\u0026#34;@+id/main\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34; android:orientation=\u0026#34;vertical\u0026#34; tools:context=\u0026#34;.FragmentDynamicActivity\u0026#34;\u0026gt; \u0026lt;androidx.viewpager.widget.ViewPager android:id=\u0026#34;@+id/vp_content\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34;\u0026gt; \u0026lt;androidx.viewpager.widget.PagerTabStrip android:id=\u0026#34;@+id/pts_tab\u0026#34; android:layout_width=\u0026#34;wrap_content\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; /\u0026gt; \u0026lt;/androidx.viewpager.widget.ViewPager\u0026gt; \u0026lt;/LinearLayout\u0026gt; fragment_dynamic.xml \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;LinearLayout xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34; xmlns:tools=\u0026#34;http://schemas.android.com/tools\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34; tools:context=\u0026#34;.fragment.DynamicFragment\u0026#34; android:orientation=\u0026#34;vertical\u0026#34;\u0026gt; \u0026lt;ImageView android:id=\u0026#34;@+id/iv_pic\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;360dp\u0026#34; android:scaleType=\u0026#34;fitCenter\u0026#34; tools:src=\u0026#34;@drawable/adv\u0026#34; /\u0026gt; \u0026lt;TextView android:id=\u0026#34;@+id/tv_desc\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:gravity=\u0026#34;left\u0026#34; android:textColor=\u0026#34;@color/black\u0026#34; android:textSize=\u0026#34;17sp\u0026#34; tools:text=\u0026#34;Test\u0026#34; /\u0026gt; \u0026lt;/LinearLayout\u0026gt; Java FragmentDynamicActivity.java package com.showguan.chapter08; import android.graphics.Color; import android.os.Bundle; import android.util.Log; import android.util.TypedValue; import androidx.appcompat.app.AppCompatActivity; import androidx.viewpager.widget.PagerTabStrip; import androidx.viewpager.widget.ViewPager; import com.showguan.chapter08.adapter.MobilePagerAdapter; import com.showguan.chapter08.entity.GoodsInfo; import com.showguan.chapter08.util.ToastUtil; import java.util.ArrayList; public class FragmentDynamicActivity extends AppCompatActivity implements ViewPager.OnPageChangeListener { private static String TAG = \u0026#34;Kennem\u0026#34;; // å•†å“ä¿¡æ¯åˆ—è¡¨ private ArrayList\u0026lt;GoodsInfo\u0026gt; mGoodsList; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_fragment_dynamic); initPagerStrip(); initViewPager(); } // åˆå§‹åŒ–ç¿»é¡µæ ‡ç­¾æ  private void initPagerStrip() { PagerTabStrip pts_tab = findViewById(R.id.pts_tab); pts_tab.setTextSize(TypedValue.COMPLEX_UNIT_SP, 20); pts_tab.setTextColor(Color.GRAY); pts_tab.setDrawFullUnderline(false); pts_tab.setTabIndicatorColor(Color.BLUE); } private void initViewPager() { // è·å– ViewPager æ§ä»¶ ViewPager vp_content = findViewById(R.id.vp_content); // è·å–é»˜è®¤çš„å•†å“ä¿¡æ¯åˆ—è¡¨ mGoodsList = GoodsInfo.getDefaultList(); Log.d(TAG, mGoodsList.toString()); // åˆ›å»º MobilePagerAdapter é€‚é…å™¨ MobilePagerAdapter adapter = new MobilePagerAdapter(getSupportFragmentManager(), mGoodsList); // ä¸º ViewPager è®¾ç½®é€‚é…å™¨ vp_content.setAdapter(adapter); // è®¾ç½®é¡µé¢å˜æ›´ç›‘å¬å™¨ vp_content.addOnPageChangeListener(this); vp_content.setCurrentItem(2); // è®¾ç½®å½“å‰æ˜¾ç¤ºçš„é¡µ } @Override public void onPageScrolled(int position, float positionOffset, int positionOffsetPixels) { // é¡µé¢æ»‘åŠ¨æ—¶è§¦å‘ } @Override public void onPageSelected(int position) { // é¡µé¢é€‰ä¸­æ—¶è§¦å‘ ToastUtil.show(this, \u0026#34;å½“å‰æ»‘åŠ¨çš„é¡µé¢ä¸º \u0026#34; + mGoodsList.get(position).name); } @Override public void onPageScrollStateChanged(int state) { // é¡µé¢æ»‘åŠ¨çŠ¶æ€æ”¹å˜æ—¶è§¦å‘ } } MobilePagerAdapter.java package com.showguan.chapter08.adapter; import androidx.annotation.NonNull; import androidx.annotation.Nullable; import androidx.fragment.app.Fragment; import androidx.fragment.app.FragmentManager; import androidx.fragment.app.FragmentPagerAdapter; import com.showguan.chapter08.entity.GoodsInfo; import com.showguan.chapter08.fragment.DynamicFragment; import java.util.List; public class MobilePagerAdapter extends FragmentPagerAdapter { // å•†å“ä¿¡æ¯åˆ—è¡¨ private final List\u0026lt;GoodsInfo\u0026gt; mGoodsList; /** * æ„é€ å‡½æ•°ï¼Œåˆå§‹åŒ–é€‚é…å™¨ * @param fm FragmentManager ç”¨äºç®¡ç† Fragment çš„äº‹åŠ¡ * @param mGoodsList å•†å“ä¿¡æ¯åˆ—è¡¨ */ public MobilePagerAdapter(@NonNull FragmentManager fm, List\u0026lt;GoodsInfo\u0026gt; mGoodsList) { super(fm, BEHAVIOR_RESUME_ONLY_CURRENT_FRAGMENT); this.mGoodsList = mGoodsList; } /** * è·å–æŒ‡å®šä½ç½®çš„ Fragment * @param position ä½ç½®ç´¢å¼• * @return å¯¹åº”ä½ç½®çš„ Fragment å®ä¾‹ */ @NonNull @Override public Fragment getItem(int position) { // ä»åˆ—è¡¨ä¸­è·å–å•†å“ä¿¡æ¯ GoodsInfo info = mGoodsList.get(position); // åˆ›å»ºå¹¶è¿”å›æ–°çš„ DynamicFragment å®ä¾‹ return DynamicFragment.newInstance(position, info.pic, info.description); } /** * è·å–åˆ—è¡¨ä¸­çš„é¡¹ç›®æ•°é‡ * @return å•†å“ä¿¡æ¯åˆ—è¡¨çš„å¤§å° */ @Override public int getCount() { return mGoodsList.size(); } /** * è·å–é¡µé¢æ ‡é¢˜ * @param position ä½ç½®ç´¢å¼• * @return å¯¹åº”ä½ç½®çš„é¡µé¢æ ‡é¢˜ */ @Nullable @Override public CharSequence getPageTitle(int position) { // è¿”å›å•†å“åç§°ä½œä¸ºé¡µé¢æ ‡é¢˜ return mGoodsList.get(position).name; } } DynamicFragment.java package com.showguan.chapter08.fragment; import android.os.Bundle; import androidx.fragment.app.Fragment; import android.view.LayoutInflater; import android.view.View; import android.view.ViewGroup; import android.widget.ImageView; import android.widget.TextView; import com.showguan.chapter08.R; public class DynamicFragment extends Fragment { /** * é™æ€å·¥å‚æ–¹æ³•ï¼Œç”¨äºåˆ›å»ºæ–°çš„ DynamicFragment å®ä¾‹å¹¶ä¼ é€’å‚æ•° * @param position ä½ç½®ç´¢å¼• * @param pic_id å›¾ç‰‡èµ„æº ID * @param desc æè¿°æ–‡æœ¬ * @return æ–°çš„ DynamicFragment å®ä¾‹ */ public static DynamicFragment newInstance(int position, int pic_id, String desc) { DynamicFragment fragment = new DynamicFragment(); // å‚æ•°æ‰“åŒ… Bundle args = new Bundle(); args.putInt(\u0026#34;position\u0026#34;, position); args.putInt(\u0026#34;image_id\u0026#34;, pic_id); args.putString(\u0026#34;desc\u0026#34;, desc); fragment.setArguments(args); return fragment; } /** * åˆ›å»ºå¹¶è¿”å›è¯¥ fragment çš„è§†å›¾å±‚æ¬¡ç»“æ„ * @param inflater ç”¨äºå®ä¾‹åŒ–å¸ƒå±€ XML æ–‡ä»¶çš„å¸ƒå±€å¡«å……å™¨å¯¹è±¡ * @param container çˆ¶çº§è§†å›¾ï¼Œnull è¡¨ç¤ºæ²¡æœ‰çˆ¶çº§è§†å›¾ * @param savedInstanceState ç”¨äºä¿å­˜çš„çŠ¶æ€ * @return è¿”å› fragment çš„æ ¹è§†å›¾ */ @Override public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) { // ä½¿ç”¨ç»™å®šçš„å¸ƒå±€æ–‡ä»¶å®ä¾‹åŒ–è§†å›¾ View view = inflater.inflate(R.layout.fragment_dynamic, container, false); // è·å–ä¼ é€’çš„å‚æ•° Bundle arguments = getArguments(); if(arguments != null){ // è·å–å¹¶è®¾ç½® ImageView å’Œ TextView çš„å†…å®¹ ImageView iv_pic = view.findViewById(R.id.iv_pic); TextView tv_desc = view.findViewById(R.id.tv_desc); iv_pic.setImageResource(arguments.getInt(\u0026#34;image_id\u0026#34;, R.drawable.diqiu)); tv_desc.setText(arguments.getString(\u0026#34;desc\u0026#34;, \u0026#34;\u0026#34;)); } return view; } } ","permalink":"https://kennems.github.io/posts/tech/android5/","summary":"Androidï¼ˆ5ï¼‰ é«˜çº§æ§ä»¶ SpinnerDialog + ArrayAdapter XML \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;LinearLayout xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34; xmlns:app=\u0026#34;http://schemas.android.com/apk/res-auto\u0026#34; xmlns:tools=\u0026#34;http://schemas.android.com/tools\u0026#34; android:id=\u0026#34;@+id/main\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34; tools:context=\u0026#34;.SpinnerDropdownActivity\u0026#34; android:orientation=\u0026#34;vertical\u0026#34;\u0026gt; \u0026lt;TextView android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:text=\u0026#34;ä¸‹æ‹‰æ¨¡å¼çš„åˆ—è¡¨æ¡†\u0026#34; android:textSize=\u0026#34;17sp\u0026#34;/\u0026gt; \u0026lt;Spinner android:id=\u0026#34;@id/sp_dialog\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:spinnerMode=\u0026#34;dialog\u0026#34;/\u0026gt;","title":"Androidï¼ˆ5ï¼‰"},{"content":"ã€Šæ•°å­—å›¾åƒå¤„ç†ã€‹è¯¾ç¨‹ç»¼åˆé¡¹ç›®â€”â€”åŸºäºå¤šç§æ»¤æ³¢å™¨çš„å›¾åƒå»å™ªç®—æ³•æ¯”è¾ƒä¸åˆ†æ GUIç•Œé¢ï¼š æœ¬é¡¹ç›®æºä»£ç å’ŒæŠ¥å‘Šå‡å·²å¼€æºï¼š\nå¼€æºä»“åº“ï¼šhttps://github.com/Kennems/Image_Processing_GUI\né¡¹ç›®ç®€ä»‹ æœ¬é¡¹ç›®æ—¨åœ¨è®¾è®¡ä¸€ä¸ªåŸºäºMatlabçš„å›¾åƒå»å™ªGUIç³»ç»Ÿï¼Œé€šè¿‡åº”ç”¨å¤šç§å›¾åƒå»å™ªç®—æ³•ï¼Œæé«˜å›¾åƒçš„è´¨é‡å’Œå¯ç”¨æ€§ã€‚è¯¥ç³»ç»Ÿé›†æˆäº†å¤šç§ç»å…¸å’Œç°ä»£çš„å»å™ªæ–¹æ³•ï¼Œå¹¶æä¾›äº†ç›´è§‚çš„ç”¨æˆ·ç•Œé¢ï¼Œæ–¹ä¾¿ç”¨æˆ·å¯¹å›¾åƒè¿›è¡Œå»å™ªå¤„ç†å’Œæ•ˆæœè¯„ä¼°ã€‚\nä¸»è¦åŠŸèƒ½æ¦‚è¿° 1. å›¾åƒå»å™ªæ–¹æ³• ç³»ç»Ÿå®ç°äº†å¤šç§å¸¸è§çš„å›¾åƒå»å™ªæ–¹æ³•ï¼ŒåŒ…æ‹¬ï¼š\nå‡å€¼æ»¤æ³¢ï¼šé€šè¿‡é‚»åŸŸåƒç´ çš„å¹³å‡å€¼æ¥æ›¿ä»£ä¸­å¿ƒåƒç´ çš„å€¼ï¼Œæœ‰æ•ˆå‡å°‘é«˜é¢‘å™ªå£°ï¼Œä½†å¯èƒ½å¯¼è‡´å›¾åƒç»†èŠ‚ä¸¢å¤± ã€‚ ä¸­å€¼æ»¤æ³¢ï¼šé‡‡ç”¨æ»¤æ³¢çª—å£å†…åƒç´ çš„ä¸­å€¼æ›¿ä»£ä¸­å¿ƒåƒç´ çš„å€¼ï¼Œèƒ½å¤Ÿæœ‰æ•ˆå»é™¤æ¤’ç›å™ªå£°å’Œè„‰å†²å™ªå£°ï¼ŒåŒæ—¶ä¿ç•™å›¾åƒè¾¹ç¼˜å’Œç»†èŠ‚ä¿¡æ¯ ã€‚ é«˜æ–¯ä½é€šæ»¤æ³¢ï¼šåˆ©ç”¨é«˜æ–¯å‡½æ•°å¯¹å›¾åƒè¿›è¡Œä½é€šæ»¤æ³¢ï¼Œå¹³æ»‘å›¾åƒå¹¶å‡å°‘å™ªå£° ã€‚ å·´ç‰¹æ²ƒæ–¯ä½é€šæ»¤æ³¢ï¼šä¸€ç§é¢‘åŸŸæ»¤æ³¢æ–¹æ³•ï¼Œé€‚ç”¨äºå»é™¤é¢‘ç‡è¾ƒé«˜çš„å™ªå£° ã€‚ å°æ³¢å˜æ¢ï¼šé€šè¿‡å°æ³¢åˆ†è§£å’Œé‡æ„æ¥å®ç°å›¾åƒå»å™ªï¼Œèƒ½å¤Ÿæœ‰æ•ˆä¿ç•™å›¾åƒçš„ç»†èŠ‚å’Œè¾¹ç¼˜ ã€‚ éå±€éƒ¨å‡å€¼å»å™ªï¼šåŸºäºå›¾åƒä¸­ç›¸ä¼¼åŒºåŸŸçš„åƒç´ å€¼ä¿¡æ¯ï¼Œå¯¹ç›®æ ‡åƒç´ è¿›è¡ŒåŠ æƒå¹³å‡ï¼Œä¿ç•™å›¾åƒç»†èŠ‚ä½†è®¡ç®—å¤æ‚åº¦è¾ƒé«˜ ã€‚ ç»´çº³æ»¤æ³¢ï¼šåŸºäºæœ€å°å‡æ–¹è¯¯å·®å‡†åˆ™ï¼Œæ¢å¤ç”±å™ªå£°æ±¡æŸ“çš„å›¾åƒï¼Œæ•ˆæœæ˜¾è‘—ä½†éœ€é¢„ä¼°å™ªå£°æ€§è´¨ ã€‚ åŒæ€æ»¤æ³¢ï¼šç»“åˆå¯¹æ•°å˜æ¢å’Œé¢‘åŸŸæ»¤æ³¢ï¼Œå¢å¼ºå›¾åƒå¯¹æ¯”åº¦ï¼Œå»é™¤å…‰ç…§å˜åŒ–å’Œå™ªå£° ã€‚ 2. å›¾åƒå™ªå£°æ·»åŠ  ç³»ç»Ÿæ”¯æŒå¤šç§å™ªå£°ç±»å‹çš„æ·»åŠ ï¼Œä»¥æ¨¡æ‹Ÿå®é™…åº”ç”¨ä¸­çš„å™ªå£°ç¯å¢ƒï¼ŒåŒ…æ‹¬é«˜æ–¯å™ªå£°ã€æ¤’ç›å™ªå£°ã€æ³Šæ¾å™ªå£°å’Œè¿åŠ¨å™ªå£°ç­‰ ã€‚\n3. å»å™ªæ•ˆæœè¯„ä¼° æä¾›äº†å¤šç§å›¾åƒè´¨é‡è¯„ä»·æŒ‡æ ‡ï¼ŒåŒ…æ‹¬å³°å€¼ä¿¡å™ªæ¯”ï¼ˆPSNRï¼‰ã€å‡æ–¹è¯¯å·®ï¼ˆMSEï¼‰ã€ä¿¡å™ªæ¯”ï¼ˆSNRï¼‰å’Œç»“æ„ç›¸ä¼¼æ€§æŒ‡æ•°ï¼ˆSSIMï¼‰ç­‰ï¼Œå¸®åŠ©ç”¨æˆ·å®¢è§‚æ¯”è¾ƒä¸åŒå»å™ªç®—æ³•çš„æ€§èƒ½ ã€‚\n4. ç”¨æˆ·ç•Œé¢ ç³»ç»Ÿé‡‡ç”¨Matlab GUIè®¾è®¡ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡ç•Œé¢é€‰æ‹©å»å™ªæ–¹æ³•ã€è®¾ç½®ç›¸å…³å‚æ•°ã€æ·»åŠ å™ªå£°ä»¥åŠæŸ¥çœ‹å»å™ªæ•ˆæœå›¾ï¼Œæ“ä½œç®€ä¾¿ç›´è§‚ ã€‚\nç»“è®º æœ¬é¡¹ç›®è®¾è®¡çš„æ•°å­—å›¾åƒå¤„ç†GUIç³»ç»Ÿï¼Œé€šè¿‡é›†æˆå¤šç§å›¾åƒå»å™ªæ–¹æ³•å’Œæä¾›ç›´è§‚çš„ç”¨æˆ·ç•Œé¢ï¼Œæ–¹ä¾¿ç”¨æˆ·è¿›è¡Œå›¾åƒå»å™ªå¤„ç†å’Œæ•ˆæœè¯„ä¼°ã€‚è¯¥ç³»ç»Ÿå…·æœ‰é‡è¦çš„ç†è®ºæ„ä¹‰å’Œå®é™…åº”ç”¨ä»·å€¼ï¼Œä¸ºæ¨åŠ¨æ•°å­—å›¾åƒå¤„ç†æŠ€æœ¯çš„è¿›æ­¥å’Œæ»¡è¶³å®é™…åº”ç”¨éœ€æ±‚æä¾›äº†æœ‰åŠ›æ”¯æŒã€‚\n","permalink":"https://kennems.github.io/posts/tech/%E6%95%B0%E5%AD%97%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86%E8%AF%BE%E7%A8%8B%E7%BB%BC%E5%90%88%E9%A1%B9%E7%9B%AE%E5%9F%BA%E4%BA%8E%E5%A4%9A%E7%A7%8D%E6%BB%A4%E6%B3%A2%E5%99%A8%E7%9A%84%E5%9B%BE%E5%83%8F%E5%8E%BB%E5%99%AA%E7%AE%97%E6%B3%95%E6%AF%94%E8%BE%83%E4%B8%8E%E5%88%86%E6%9E%90/","summary":"ã€Šæ•°å­—å›¾åƒå¤„ç†ã€‹è¯¾ç¨‹ç»¼åˆé¡¹ç›®â€”â€”åŸºäºå¤šç§æ»¤æ³¢å™¨çš„å›¾åƒå»å™ªç®—æ³•æ¯”è¾ƒä¸åˆ†æ GUIç•Œé¢ï¼š æœ¬é¡¹ç›®æºä»£ç å’ŒæŠ¥å‘Šå‡å·²å¼€æºï¼š å¼€æºä»“åº“ï¼šhttps://gi","title":"ã€Šæ•°å­—å›¾åƒå¤„ç†ã€‹è¯¾ç¨‹ç»¼åˆé¡¹ç›®(Matlab)"},{"content":"Androidï¼ˆ4ï¼‰ å°±ç®—æ˜¯æœ€ä½çš„15x15éƒ½å·²ç»ä¸é”™äº†ï¼Œä»¥åè¿˜æœ‰æ—¶é—´å»å­¦ï¼Œä¸Šäº†ç ”ç©¶ç”Ÿä¹Ÿæ²¡äººèƒ½ä¿è¯ä½ æœ‰15x15çš„æ”¶å…¥\nå†…å®¹æä¾›è€…(ContentProvider) CountentProviderä¸ºAppå­˜å–å†…éƒ¨æ•°æ®æä¾›ç»Ÿä¸€çš„å¤–éƒ¨æ¥å£ï¼Œè®©ä¸åŒçš„åº”ç”¨ä¹‹é—´å¾—ä»¥å…±äº«æ•°æ®\nUri é€šç”¨èµ„æºæ ‡è¯†ç¬¦ Universal Resource Identiferï¼Œ ä»£è¡¨æ•°æ®æ“ä½œçš„åœ°å€ï¼Œæ¯ä¸€ä¸ªContentProvideréƒ½ä¼šæœ‰å”¯ä¸€çš„åœ°å€ã€‚ContentProviderä½¿ç”¨çš„Uriè¯­æ³•ç»“æ„å¦‚ä¸‹ï¼š\ncontent://authority/data_path/id content://æ˜¯é€šç”¨å‰ç¼€ï¼Œè¡¨ç¤ºè¯¥Uriç”¨äºContentProviderå®šä½èµ„æºã€‚ authorityæ˜¯æˆæƒè€…åç§°ï¼Œç”¨æ¥ç¡®å®šå…·ä½“ç”±å“ªä¸€ä¸ªContentProvideræä¾›èµ„æºã€‚å› æ­¤ä¸€èˆ¬anthorityéƒ½ç”±ç±»çš„å°å†™å…¨ç§°ç»„æˆï¼Œä»¥ä¿è¯å”¯ä¸€æ€§ã€‚ data_pathæ˜¯æ•°æ®è·¯å¾„ï¼Œç”¨æ¥ç¡®å®šè¯·æ±‚çš„æ˜¯å“ªä¸ªæ•°æ®é›† idæ˜¯æ•°æ®ç¼–å·ï¼Œç”¨æ¥è¯·æ±‚å•æ¡æ•°æ®ã€‚å¦‚æœæ˜¯å¤šæ¡è¿™ä¸ªå­—æ®µå¿½ç•¥ã€‚ serverå†…å®¹æä¾›ç¨‹åº UserInfoProvider.java package com.showguan.chapter07_server.provider; import android.content.ContentProvider; import android.content.ContentValues; import android.content.UriMatcher; import android.database.Cursor; import android.database.sqlite.SQLiteDatabase; import android.net.Uri; import android.util.Log; import com.showguan.chapter07_server.database.UserDBHelper; public class UserInfoProvider extends ContentProvider { private static String TAG = \u0026#34;Kennem\u0026#34;; private UserDBHelper dbHelper; private static final int USER = 1; private static final int USERS = 2; private static final UriMatcher URI_MATCHER = new UriMatcher(UriMatcher.NO_MATCH); static { URI_MATCHER.addURI(UserInfoContent.AUTHORITIES, \u0026#34;/user/#\u0026#34;, USER); URI_MATCHER.addURI(UserInfoContent.AUTHORITIES, \u0026#34;/user\u0026#34;, USERS); } @Override public boolean onCreate() { // TODO: Implement this to initialize your content provider on startup. Log.d(TAG, \u0026#34;ContentProvider onCreate: \u0026#34;); dbHelper = UserDBHelper.getInstance(getContext()); return true; } @Override public Uri insert(Uri uri, ContentValues values) { if (URI_MATCHER.match(uri) == USERS) { SQLiteDatabase db = dbHelper.getWritableDatabase(); db.insert(UserDBHelper.TABLE_NAME, null, values); } return uri; } @Override public Cursor query(Uri uri, String[] projection, String selection, String[] selectionArgs, String sortOrder) { if (URI_MATCHER.match(uri) == USERS) { Log.d(TAG, \u0026#34;UserInfoProvider query: \u0026#34;); SQLiteDatabase db = dbHelper.getReadableDatabase(); Cursor cursor = db.query(UserDBHelper.TABLE_NAME, projection, selection, selectionArgs, null, null, null); return cursor; } return null; } @Override public int delete(Uri uri, String selection, String[] selectionArgs) { int count = 0; switch (URI_MATCHER.match(uri)) { case USER: String id = uri.getLastPathSegment(); SQLiteDatabase db1 = dbHelper.getWritableDatabase(); count = db1.delete(UserDBHelper.TABLE_NAME, \u0026#34;_id = ?\u0026#34;, new String[]{id}); db1.close(); break; case USERS: SQLiteDatabase db2 = dbHelper.getWritableDatabase(); count = db2.delete(UserDBHelper.TABLE_NAME, selection, selectionArgs); db2.close(); break; } return count; } @Override public String getType(Uri uri) { // TODO: Implement this to handle requests for the MIME type of the data // at the given URI. throw new UnsupportedOperationException(\u0026#34;Not yet implemented\u0026#34;); } @Override public int update(Uri uri, ContentValues values, String selection, String[] selectionArgs) { // TODO: Implement this to handle requests to update one or more rows. throw new UnsupportedOperationException(\u0026#34;Not yet implemented\u0026#34;); } } UserInfoContent.java å®šä¹‰å¸¸é‡ package com.showguan.chapter07_server.provider; import android.net.Uri; import android.provider.BaseColumns; public class UserInfoContent implements BaseColumns { public static final String AUTHORITIES = \u0026#34;com.showguan.chapter07_server.provider.UserInfoProvider\u0026#34;; public static final Uri CONTENT_URI = Uri.parse(\u0026#34;content://\u0026#34; + AUTHORITIES + \u0026#34;/user\u0026#34;); public static final String USER_NAME = \u0026#34;name\u0026#34;; public static final String USER_AGE = \u0026#34;age\u0026#34;; public static final String USER_HEIGHT = \u0026#34;height\u0026#34;; public static final String USER_WEIGHT = \u0026#34;weight\u0026#34;; public static final String USER_MARRIED = \u0026#34;married\u0026#34;; } UserDBHelper.javaåˆ›å»ºè¡¨ package com.showguan.chapter07_server.database; import android.content.ContentValues; import android.content.Context; import android.database.Cursor; import android.database.sqlite.SQLiteDatabase; import android.database.sqlite.SQLiteOpenHelper; import androidx.annotation.Nullable; import java.util.ArrayList; import java.util.List; public class UserDBHelper extends SQLiteOpenHelper { public static final String DB_NAME = \u0026#34;user.db\u0026#34;; public static final String TABLE_NAME = \u0026#34;user_info\u0026#34;; private static final int DB_VERSION = 2; private static UserDBHelper mHelper = null; private SQLiteDatabase mRDB = null; private SQLiteDatabase mWDB = null; private UserDBHelper(@Nullable Context context) { super(context, DB_NAME, null, DB_VERSION); } public static UserDBHelper getInstance(Context context) { if (mHelper == null) { mHelper = new UserDBHelper(context); } return mHelper; } @Override public void onCreate(SQLiteDatabase db) { String sql = \u0026#34;CREATE TABLE IF NOT EXISTS \u0026#34; + TABLE_NAME + \u0026#34; (\u0026#34; + \u0026#34;_id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,\u0026#34; + \u0026#34; name VARCHAR NOT NULL,\u0026#34; + \u0026#34; age INTEGER NOT NULL,\u0026#34; + \u0026#34; height LONG NOT NULL,\u0026#34; + \u0026#34; weight FLOAT NOT NULL,\u0026#34; + \u0026#34; married INTEGER NOT NULL);\u0026#34;; db.execSQL(sql); } @Override public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) { } } clientæ¥å—æ•°æ®ç«¯ é¦–å…ˆåœ¨Manifestä¸­æ·»åŠ å¦‚ä¸‹ï¼Œè¡¨ç¤ºéœ€è¦è®¿é—®çš„å†…å®¹æä¾›è€…çš„åŒ…\nContentWriteActivity.java package com.showguan.chapter07_client; public class ContentWriteActivity extends AppCompatActivity implements View.OnClickListener { private static String TAG = \u0026#34;Kennem\u0026#34;; private EditText et_name; private EditText et_age; private EditText et_height; private EditText et_weight; private CheckBox ck_isMarried; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_content_write); et_name = findViewById(R.id.et_name); et_age = findViewById(R.id.et_age); et_height = findViewById(R.id.et_height); et_weight = findViewById(R.id.et_weight); ck_isMarried = findViewById(R.id.ck_isMarried); findViewById(R.id.btn_read).setOnClickListener(this); findViewById(R.id.btn_write).setOnClickListener(this); findViewById(R.id.btn_delete).setOnClickListener(this); } @SuppressLint(\u0026#34;Range\u0026#34;) @Override public void onClick(View v) { if(v.getId() == R.id.btn_write){ ContentValues values = new ContentValues(); values.put(UserInfoContent.USER_NAME, et_name.getText().toString()); values.put(UserInfoContent.USER_AGE, et_age.getText().toString()); values.put(UserInfoContent.USER_HEIGHT, et_height.getText().toString()); values.put(UserInfoContent.USER_WEIGHT, et_weight.getText().toString()); values.put(UserInfoContent.USER_MARRIED, ck_isMarried.isChecked()); getContentResolver().insert(UserInfoContent.CONTENT_URI, values); ToastUtil.show(this, \u0026#34;ä¿å­˜æˆåŠŸï¼\u0026#34;); } else if (v.getId() == R.id.btn_read) { Cursor cursor = getContentResolver().query(UserInfoContent.CONTENT_URI, null, null, null, null); if (cursor != null) { while(cursor.moveToNext()){ User info = new User(); info.setId(cursor.getInt(cursor.getColumnIndex(UserInfoContent._ID))); info.setAge(cursor.getInt(cursor.getColumnIndex(UserInfoContent.USER_AGE))); info.setName(cursor.getString(cursor.getColumnIndex(UserInfoContent.USER_NAME))); info.setHeight(cursor.getFloat(cursor.getColumnIndex(UserInfoContent.USER_HEIGHT))); info.setWeight(cursor.getFloat(cursor.getColumnIndex(UserInfoContent.USER_WEIGHT))); info.setMarried(cursor.getInt(cursor.getColumnIndex(UserInfoContent.USER_MARRIED)) == 1); Log.d(TAG, info.toString()); } cursor.close(); } } else if (v.getId() == R.id.btn_delete) { // æ ¹æ®idåˆ é™¤å•æ¡ // Uri uri = ContentUris.withAppendedId(UserInfoContent.CONTENT_URI, 1); // int count = getContentResolver().delete(uri, null, null); //æ ¹æ®åç§°åˆ é™¤å¤šæ¡ int count = getContentResolver().delete(UserInfoContent.CONTENT_URI, \u0026#34;name = ?\u0026#34;, new String[]{et_name.getText().toString()}); if(count \u0026gt; 0){ ToastUtil.show(this, \u0026#34;åˆ é™¤æˆåŠŸ\u0026#34;); }else{ ToastUtil.show(this, \u0026#34;åˆ é™¤å¤±è´¥ï¼Œä¸å­˜åœ¨åä¸º\u0026#34; + et_name.getText().toString() + \u0026#34;çš„ç”¨æˆ·ï¼\u0026#34;); } } } } é€šè¿‡Uriæ ¼å¼åˆ é™¤ä¸€ä¸ªç”¨æˆ· // æ ¹æ®idåˆ é™¤å•æ¡ Uri uri = ContentUris.withAppendedId(UserInfoContent.CONTENT_URI, 1); int count = getContentResolver().delete(uri, null, null); åŠ¨æ€ç”³è¯·æƒé™ æ­¥éª¤ï¼š\næ£€æŸ¥Appæ˜¯å¦å¼€å¯äº†æŒ‡å®šæƒé™ è°ƒç”¨ContextCompatçš„checkSelfPermissionæ–¹æ³• è¯·æ±‚ç³»ç»Ÿå¼¹çª—ï¼Œä»¥ä¾¿ç”¨æˆ·é€‰æ‹©æ˜¯å¦å¼€å¯æƒé™ è°ƒç”¨ActivityCompatçš„requestPermissionæ–¹æ³•ï¼Œå³å¯å‘½ä»¤ç³»ç»Ÿè‡ªåŠ¨å¼¹å‡ºæƒé™ç”³è¯·çª—å£ã€‚ åˆ¤æ–­ç”¨æˆ·çš„æƒé™é€‰æ‹©ç»“æœ é‡å†™æ´»åŠ¨é¡µé¢çš„æƒé™è¯·æ±‚å›è°ƒæ–¹æ³•onRequestPermissionResultï¼Œ åœ¨è¯¥æ–¹æ³•å†…éƒ¨å¤„ç†ç”¨æˆ·çš„æƒé™é€‰æ‹©ç»“æœã€‚ æ‡’æ±‰å¼è·å–æƒé™ é¦–å…ˆæ·»åŠ æŒ‰é’®äº‹ä»¶ç›‘å¬ï¼š @Override public void onClick(View v) { if (v.getId() == R.id.btn_contacts) { PermissionUtil.checkPermission(this, PERMISSIONS_CONTACTS, REQUEST_CODE_CONTACTS); } else if (v.getId() == R.id.btn_sms) { PermissionUtil.checkPermission(this, PERMISSIONS_SMS, REQUEST_CODE_SMS); } } åœ¨å·¥å…·ç±»ä¸­åˆ¤æ–­æ˜¯å¦æœ‰æ²¡æœ‰è·å–åˆ°çš„æƒé™ï¼Œç”³è¯·è·å– public static boolean checkPermission(Activity act, String[] permissions, int requestCode){ if(Build.VERSION.SDK_INT \u0026gt;= Build.VERSION_CODES.M){ int check = PackageManager.PERMISSION_GRANTED; for (String permission : permissions) { check = ContextCompat.checkSelfPermission(act, permission); if(check != PackageManager.PERMISSION_GRANTED){ break; } } if(check != PackageManager.PERMISSION_GRANTED){ ActivityCompat.requestPermissions(act, permissions, requestCode); return false; } } return true; } å…¶ä¸­ActivityCompat.requestPermissionsæ–¹æ³•çš„å‚æ•°åœ¨onRequestPermissionsResultä¸­è¿”å› @Override public void onRequestPermissionsResult(int requestCode, @NonNull String[] permissions, @NonNull int[] grantResults) { super.onRequestPermissionsResult(requestCode, permissions, grantResults); switch (requestCode) { case REQUEST_CODE_CONTACTS: for (int grantResult : grantResults) { Log.d(TAG, String.valueOf(grantResult)); } if (PermissionUtil.checkGranted(grantResults)) { Log.d(TAG, \u0026#34;é€šè®¯å½•æƒé™è·å–æˆåŠŸ\u0026#34;); } else { ToastUtil.show(this, \u0026#34;è·å–æƒé™å¤±è´¥!\u0026#34;); jumpToSettings(); } break; case REQUEST_CODE_SMS: if (PermissionUtil.checkGranted(grantResults)) { Log.d(TAG, \u0026#34;çŸ­ä¿¡æ”¶å‘æƒé™è·å–æˆåŠŸ\u0026#34;); } else { ToastUtil.show(this, \u0026#34;è·å–æƒé™å¤±è´¥!\u0026#34;); jumpToSettings(); } break; } } PermissionLazyActivity.java package com.showguan.chapter07_client; import android.Manifest; import android.content.Intent; import android.net.Uri; import android.os.Bundle; import android.provider.Settings; import android.util.Log; import android.view.View; import androidx.activity.EdgeToEdge; import androidx.annotation.NonNull; import androidx.appcompat.app.AppCompatActivity; import androidx.core.graphics.Insets; import androidx.core.view.ViewCompat; import androidx.core.view.WindowInsetsCompat; import com.showguan.chapter07_client.util.PermissionUtil; import com.showguan.chapter07_client.util.ToastUtil; public class PermissionLazyActivity extends AppCompatActivity implements View.OnClickListener { private static String TAG = \u0026#34;Kennem\u0026#34;; private static final String[] PERMISSIONS_CONTACTS = new String[]{ android.Manifest.permission.READ_CONTACTS, android.Manifest.permission.WRITE_CONTACTS }; private static final String[] PERMISSIONS_SMS = new String[]{ Manifest.permission.SEND_SMS, Manifest.permission.READ_SMS }; private static final int REQUEST_CODE_CONTACTS = 1; private static final int REQUEST_CODE_SMS = 2; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_permission_lazy); findViewById(R.id.btn_contacts).setOnClickListener(this); findViewById(R.id.btn_sms).setOnClickListener(this); } @Override public void onClick(View v) { if (v.getId() == R.id.btn_contacts) { PermissionUtil.checkPermission(this, PERMISSIONS_CONTACTS, REQUEST_CODE_CONTACTS); } else if (v.getId() == R.id.btn_sms) { PermissionUtil.checkPermission(this, PERMISSIONS_SMS, REQUEST_CODE_SMS); } } @Override public void onRequestPermissionsResult(int requestCode, @NonNull String[] permissions, @NonNull int[] grantResults) { super.onRequestPermissionsResult(requestCode, permissions, grantResults); switch (requestCode) { case REQUEST_CODE_CONTACTS: for (int grantResult : grantResults) { Log.d(TAG, String.valueOf(grantResult)); } if (PermissionUtil.checkGranted(grantResults)) { Log.d(TAG, \u0026#34;é€šè®¯å½•æƒé™è·å–æˆåŠŸ\u0026#34;); } else { ToastUtil.show(this, \u0026#34;è·å–æƒé™å¤±è´¥!\u0026#34;); jumpToSettings(); } break; case REQUEST_CODE_SMS: if (PermissionUtil.checkGranted(grantResults)) { Log.d(TAG, \u0026#34;çŸ­ä¿¡æ”¶å‘æƒé™è·å–æˆåŠŸ\u0026#34;); } else { ToastUtil.show(this, \u0026#34;è·å–æƒé™å¤±è´¥!\u0026#34;); jumpToSettings(); } break; } } private void jumpToSettings() { Intent intent = new Intent(); intent.setAction(Settings.ACTION_APPLICATION_DETAILS_SETTINGS); intent.setData(Uri.fromParts(\u0026#34;package\u0026#34;, getPackageName(), null)); intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK); startActivity(intent); } } è·³è½¬åˆ°ç³»ç»Ÿæƒé™è®¾è®¡ç•Œé¢ï¼š private void jumpToSettings() { Intent intent = new Intent(); intent.setAction(Settings.ACTION_APPLICATION_DETAILS_SETTINGS); intent.setData(Uri.fromParts(\u0026#34;package\u0026#34;, getPackageName(), null)); intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK); startActivity(intent); } é¥¿æ±‰å¼è·å–æƒé™ PermissionHungryActivity.java ä¸åŒäºæ‡’æ±‰å¼ï¼Œåˆ›å»ºæ—¶å³ç”³è¯·å…¨éƒ¨æƒé™\npackage com.showguan.chapter07_client; import android.Manifest; import android.content.Intent; import android.content.pm.PackageManager; import android.net.Uri; import android.os.Bundle; import android.provider.Settings; import android.util.Log; import android.view.View; import androidx.activity.EdgeToEdge; import androidx.annotation.NonNull; import androidx.appcompat.app.AppCompatActivity; import androidx.core.graphics.Insets; import androidx.core.view.ViewCompat; import androidx.core.view.WindowInsetsCompat; import com.showguan.chapter07_client.util.PermissionUtil; import com.showguan.chapter07_client.util.ToastUtil; public class PermissionHungryActivity extends AppCompatActivity implements View.OnClickListener { private static String TAG = \u0026#34;Kennem\u0026#34;; private static final String[] PERMISSIONS_ALL = new String[]{ android.Manifest.permission.READ_CONTACTS, android.Manifest.permission.WRITE_CONTACTS, android.Manifest.permission.SEND_SMS, Manifest.permission.READ_SMS }; private static final int REQUEST_CODE_ALL = 1; private static final int REQUEST_CODE_CONTACTS = 2; private static final int REQUEST_CODE_SMS = 3; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_permission_lazy); findViewById(R.id.btn_contacts).setOnClickListener(this); findViewById(R.id.btn_sms).setOnClickListener(this); PermissionUtil.checkPermission(this, PERMISSIONS_ALL, REQUEST_CODE_ALL); } @Override public void onClick(View v) { if (v.getId() == R.id.btn_contacts) { PermissionUtil.checkPermission(this, new String[]{PERMISSIONS_ALL[0], PERMISSIONS_ALL[1]}, REQUEST_CODE_CONTACTS); } else if (v.getId() == R.id.btn_sms) { PermissionUtil.checkPermission(this, new String[]{PERMISSIONS_ALL[2], PERMISSIONS_ALL[3]}, REQUEST_CODE_SMS); } } @Override public void onRequestPermissionsResult(int requestCode, @NonNull String[] permissions, @NonNull int[] grantResults) { super.onRequestPermissionsResult(requestCode, permissions, grantResults); switch (requestCode) { case REQUEST_CODE_ALL: if (PermissionUtil.checkGranted(grantResults)) { Log.d(TAG, \u0026#34;æ‰€æœ‰æƒé™è·å–æˆåŠŸï¼\u0026#34;); } else { for (int i = 0; i \u0026lt; grantResults.length; i++) { if (grantResults[i] != PackageManager.PERMISSION_GRANTED) { switch (permissions[i]) { case Manifest.permission.READ_CONTACTS: case Manifest.permission.WRITE_CONTACTS: ToastUtil.show(this, \u0026#34;è·å–é€šè®¯å½•è¯»å†™æƒé™å¤±è´¥\u0026#34;); jumpToSettings(); return; case Manifest.permission.SEND_SMS: case Manifest.permission.READ_SMS: ToastUtil.show(this, \u0026#34;è·å–çŸ­ä¿¡è¯»å†™æƒé™å¤±è´¥\u0026#34;); jumpToSettings(); return; } } } } break; case REQUEST_CODE_CONTACTS: for (int grantResult : grantResults) { Log.d(TAG, String.valueOf(grantResult)); } if (PermissionUtil.checkGranted(grantResults)) { Log.d(TAG, \u0026#34;é€šè®¯å½•æƒé™è·å–æˆåŠŸ\u0026#34;); } else { ToastUtil.show(this, \u0026#34;è·å–æƒé™å¤±è´¥!\u0026#34;); jumpToSettings(); } break; case REQUEST_CODE_SMS: if (PermissionUtil.checkGranted(grantResults)) { Log.d(TAG, \u0026#34;çŸ­ä¿¡æ”¶å‘æƒé™è·å–æˆåŠŸ\u0026#34;); } else { ToastUtil.show(this, \u0026#34;è·å–æƒé™å¤±è´¥!\u0026#34;); jumpToSettings(); } break; } } private void jumpToSettings() { Intent intent = new Intent(); intent.setAction(Settings.ACTION_APPLICATION_DETAILS_SETTINGS); intent.setData(Uri.fromParts(\u0026#34;package\u0026#34;, getPackageName(), null)); intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK); startActivity(intent); } } æ·»åŠ è”ç³»äºº æ·»åŠ ç”¨æˆ·åˆ°é€šè®¯å½•ï¼Œè¯»å–æ‰€æœ‰è”ç³»äººä¿¡æ¯åˆ°logcatä¸­ã€‚\npackage com.showguan.chapter07_client; public class ContactAddActivity extends AppCompatActivity implements View.OnClickListener { private static String TAG = \u0026#34;Kennem\u0026#34;; private TextView et_name; private TextView et_phone; private TextView et_email; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_contact_add); et_name = findViewById(R.id.et_name); et_phone = findViewById(R.id.et_phone); et_email = findViewById(R.id.et_email); findViewById(R.id.btn_read).setOnClickListener(this); findViewById(R.id.btn_write).setOnClickListener(this); } @Override public void onClick(View v) { if (v.getId() == R.id.btn_write) { // åˆ›å»ºä¸€ä¸ªè”ç³»äººå¯¹è±¡ Contact contact = new Contact(); contact.name = et_name.getText().toString(); contact.phone = et_phone.getText().toString(); contact.email = et_email.getText().toString(); //addContacts(getContentResolver(), contact); //æ‰¹å¤„ç†æ–¹å¼ï¼Œæ¯ä¸€æ¬¡æ“ä½œéƒ½æ˜¯ä¸€ä¸ªContentProviderOperationï¼Œ æ„å»ºä¸€ä¸ªæ“ä½œé›†åˆï¼Œç„¶åä¸€æ¬¡æ€§æ‰§è¡Œ // å¥½å¤„ï¼šè¦ä¹ˆå…¨éƒ¨æˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨å¤±è´¥ï¼Œä¿è¯äº†äº‹åŠ¡çš„ä¸€è‡´æ€§ addFullContacts(getContentResolver(), contact); } else if (v.getId() == R.id.btn_read) { readPhoneContact(getContentResolver()); } } @SuppressLint(\u0026#34;Range\u0026#34;) // ç¦ç”¨èŒƒå›´è­¦å‘Šï¼Œå› ä¸ºæˆ‘ä»¬æ‰‹åŠ¨å¤„ç†åˆ—ç´¢å¼• private void readPhoneContact(ContentResolver resolver) { // æŸ¥è¯¢RawContactsè¡¨ï¼Œè·å–æ‰€æœ‰è”ç³»äººçš„_raw_contact_id Cursor cursor = resolver.query( ContactsContract.RawContacts.CONTENT_URI, new String[]{ContactsContract.RawContacts._ID}, // åªæŸ¥è¯¢_raw_contact_idåˆ— null, // æ— ç­›é€‰æ¡ä»¶ null, // æ— ç­›é€‰æ¡ä»¶å‚æ•° null // æ— æ’åº ); // éå†æŸ¥è¯¢ç»“æœ while (cursor.moveToNext()) { // è·å–å½“å‰è®°å½•çš„raw_contact_id int rawContactId = cursor.getInt(0); // æ„å»ºç”¨äºæŸ¥è¯¢è”ç³»äººçš„Data URI Uri uri = Uri.parse(\u0026#34;content://com.android.contacts/contacts/\u0026#34; + rawContactId + \u0026#34;/data\u0026#34;); // æŸ¥è¯¢Dataè¡¨ï¼Œè·å–ä¸å½“å‰è”ç³»äººç›¸å…³çš„æ‰€æœ‰æ•°æ® Cursor dataCursor = resolver.query( uri, new String[]{Contacts.Data.MIMETYPE, Contacts.Data.DATA1, Contacts.Data.DATA2}, // æŸ¥è¯¢MIMEç±»å‹å’Œæ•°æ®åˆ— null, // æ— ç­›é€‰æ¡ä»¶ null, // æ— ç­›é€‰æ¡ä»¶å‚æ•° null // æ— æ’åº ); // åˆ›å»ºä¸€ä¸ªContactå¯¹è±¡ç”¨äºå­˜å‚¨æŸ¥è¯¢ç»“æœ Contact contact = new Contact(); // éå†æŸ¥è¯¢ç»“æœ while (dataCursor.moveToNext()) { // è·å–å½“å‰è®°å½•çš„DATA1åˆ—çš„å€¼ String data1 = dataCursor.getString(dataCursor.getColumnIndex(Contacts.Data.DATA1)); // è·å–å½“å‰è®°å½•çš„MIMETYPEåˆ—çš„å€¼ String mimeType = dataCursor.getString(dataCursor.getColumnIndex(Contacts.Data.MIMETYPE)); // æ ¹æ®MIMEç±»å‹ï¼Œå°†æ•°æ®å­˜å‚¨åˆ°ç›¸åº”çš„Contactå±æ€§ä¸­ switch (mimeType) { case CommonDataKinds.StructuredName.CONTENT_ITEM_TYPE: // å¦‚æœMIMEç±»å‹æ˜¯StructuredNameï¼Œåˆ™å°†data1èµ‹å€¼ç»™contactçš„nameå±æ€§ contact.name = data1; break; case CommonDataKinds.Phone.CONTENT_ITEM_TYPE: // å¦‚æœMIMEç±»å‹æ˜¯Phoneï¼Œåˆ™å°†data1èµ‹å€¼ç»™contactçš„phoneå±æ€§ contact.phone = data1; break; case CommonDataKinds.Email.CONTENT_ITEM_TYPE: // å¦‚æœMIMEç±»å‹æ˜¯Emailï¼Œåˆ™å°†data1èµ‹å€¼ç»™contactçš„emailå±æ€§ contact.email = data1; break; } } // å…³é—­Dataè¡¨çš„æŸ¥è¯¢ç»“æœæ¸¸æ ‡ dataCursor.close(); // å¦‚æœcontactçš„nameå±æ€§ä¸ä¸ºç©ºï¼Œåˆ™è¾“å‡ºè”ç³»äººå§“ååˆ°æ—¥å¿— if (contact.name != null) { Log.d(TAG, contact.name); } } // å…³é—­RawContactsè¡¨çš„æŸ¥è¯¢ç»“æœæ¸¸æ ‡ cursor.close(); } // å¾€æ‰‹æœºé€šè®¯å½•ä¸€æ¬¡æ€§æ·»åŠ ä¸€ä¸ªè”ç³»äººä¿¡æ¯ï¼ˆåŒ…æ‹¬ä¸»è®°å½•ï¼Œå§“åï¼Œç”µè¯å·ç ï¼Œç”µå­é‚®ç®±ï¼‰ // äº‹åŠ¡æ€§ï¼Œè¦ä¹ˆå…¨éƒ¨æˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨å¤±è´¥ private void addFullContacts(ContentResolver contentResolver, Contact contact) { // åˆ›å»ºä¸€ä¸ªæ’å…¥è”ç³»äººä¸»è®°å½•çš„å†…å®¹æ“ä½œå™¨ ContentProviderOperation op_main = ContentProviderOperation // è®¾ç½®æ“ä½œç±»å‹ä¸ºæ’å…¥ .newInsert(ContactsContract.RawContacts.CONTENT_URI) // è®¾ç½®æ’å…¥çš„ACCOUNT_NAMEä¸ºnullï¼Œè¡¨ç¤ºä½¿ç”¨é»˜è®¤è´¦æˆ· .withValue(ContactsContract.RawContacts.ACCOUNT_NAME, null) // æ„å»ºæ“ä½œ .build(); // åˆ›å»ºä¸€ä¸ªæ’å…¥è”ç³»äººå§“åçš„å†…å®¹æ“ä½œå™¨ ContentProviderOperation op_name = ContentProviderOperation // è®¾ç½®æ“ä½œç±»å‹ä¸ºæ’å…¥ .newInsert(ContactsContract.Data.CONTENT_URI) // è®¾ç½®å¼•ç”¨çš„RAW_CONTACT_IDä¸ºå‰ä¸€ä¸ªæ“ä½œç”Ÿæˆçš„ID .withValueBackReference(Contacts.Data.RAW_CONTACT_ID, 0) // è®¾ç½®æ•°æ®çš„MIMEç±»å‹ä¸ºStructuredNameï¼ˆè”ç³»äººçš„åå­—ï¼‰ .withValue(Contacts.Data.MIMETYPE, CommonDataKinds.StructuredName.CONTENT_ITEM_TYPE) // è®¾ç½®è”ç³»äººçš„åå­— .withValue(Contacts.Data.DATA1, contact.name) // æ„å»ºæ“ä½œ .build(); // åˆ›å»ºä¸€ä¸ªæ’å…¥è”ç³»äººç”µè¯å·ç çš„å†…å®¹æ“ä½œå™¨ ContentProviderOperation op_phone = ContentProviderOperation // è®¾ç½®æ“ä½œç±»å‹ä¸ºæ’å…¥ .newInsert(ContactsContract.Data.CONTENT_URI) // è®¾ç½®å¼•ç”¨çš„RAW_CONTACT_IDä¸ºå‰ä¸€ä¸ªæ“ä½œç”Ÿæˆçš„ID .withValueBackReference(Contacts.Data.RAW_CONTACT_ID, 0) // è®¾ç½®æ•°æ®çš„MIMEç±»å‹ä¸ºPhoneï¼ˆè”ç³»äººçš„ç”µè¯ï¼‰ .withValue(Contacts.Data.MIMETYPE, CommonDataKinds.Phone.CONTENT_ITEM_TYPE) // è®¾ç½®è”ç³»äººçš„ç”µè¯å·ç  .withValue(Contacts.Data.DATA1, contact.phone) // è®¾ç½®ç”µè¯å·ç çš„ç±»å‹ä¸ºMobileï¼ˆæ‰‹æœºï¼‰ .withValue(Contacts.Data.DATA2, CommonDataKinds.Phone.TYPE_MOBILE) // æ„å»ºæ“ä½œ .build(); // åˆ›å»ºä¸€ä¸ªæ’å…¥è”ç³»äººç”µå­é‚®ç®±çš„å†…å®¹æ“ä½œå™¨ ContentProviderOperation op_email = ContentProviderOperation // è®¾ç½®æ“ä½œç±»å‹ä¸ºæ’å…¥ .newInsert(ContactsContract.Data.CONTENT_URI) // è®¾ç½®å¼•ç”¨çš„RAW_CONTACT_IDä¸ºå‰ä¸€ä¸ªæ“ä½œç”Ÿæˆçš„ID .withValueBackReference(Contacts.Data.RAW_CONTACT_ID, 0) // è®¾ç½®æ•°æ®çš„MIMEç±»å‹ä¸ºEmailï¼ˆè”ç³»äººçš„é‚®ç®±ï¼‰ .withValue(Contacts.Data.MIMETYPE, CommonDataKinds.Email.CONTENT_ITEM_TYPE) // è®¾ç½®è”ç³»äººçš„ç”µå­é‚®ç®±åœ°å€ .withValue(Contacts.Data.DATA1, contact.email) // è®¾ç½®ç”µå­é‚®ç®±çš„ç±»å‹ä¸ºMobileï¼ˆæ‰‹æœºé‚®ç®±ï¼‰ .withValue(Contacts.Data.DATA2, CommonDataKinds.Email.TYPE_MOBILE) // æ„å»ºæ“ä½œ .build(); // åˆ›å»ºä¸€ä¸ªæ“ä½œåˆ—è¡¨ï¼Œç”¨äºæ‰¹é‡æ‰§è¡Œæ‰€æœ‰æ“ä½œ ArrayList\u0026lt;ContentProviderOperation\u0026gt; operations = new ArrayList\u0026lt;\u0026gt;(); // å°†æ’å…¥ä¸»è®°å½•çš„æ“ä½œæ·»åŠ åˆ°æ“ä½œåˆ—è¡¨ operations.add(op_main); // å°†æ’å…¥å§“åçš„æ“ä½œæ·»åŠ åˆ°æ“ä½œåˆ—è¡¨ operations.add(op_name); // å°†æ’å…¥ç”µè¯å·ç çš„æ“ä½œæ·»åŠ åˆ°æ“ä½œåˆ—è¡¨ operations.add(op_phone); // å°†æ’å…¥ç”µå­é‚®ç®±çš„æ“ä½œæ·»åŠ åˆ°æ“ä½œåˆ—è¡¨ operations.add(op_email); try { // æ‰§è¡Œæ‰¹é‡æ“ä½œï¼Œå°†æ‰€æœ‰æ•°æ®æ’å…¥è”ç³»äººæ•°æ®åº“ contentResolver.applyBatch(ContactsContract.AUTHORITY, operations); } catch (OperationApplicationException e) { // æ•è·OperationApplicationExceptionå¼‚å¸¸å¹¶æŠ›å‡ºRuntimeException throw new RuntimeException(e); } catch (RemoteException e) { // æ•è·RemoteExceptionå¼‚å¸¸å¹¶æŠ›å‡ºRuntimeException throw new RuntimeException(e); } } private void addContacts(ContentResolver resolver, Contact contact) { // åˆ›å»ºä¸€ä¸ªContentValueså¯¹è±¡ï¼Œç”¨äºå­˜å‚¨æ–°è”ç³»äººæ•°æ® ContentValues values = new ContentValues(); // æ’å…¥ä¸€ä¸ªç©ºçš„RawContactè®°å½•ï¼Œè¿”å›è¯¥è®°å½•çš„URI Uri uri = resolver.insert(ContactsContract.RawContacts.CONTENT_URI, values); // è§£æå‡ºæ–°æ’å…¥è®°å½•çš„ID long rawContactId = ContentUris.parseId(uri); // åˆ›å»ºä¸€ä¸ªContentValueså¯¹è±¡ï¼Œç”¨äºå­˜å‚¨è”ç³»äººçš„åå­—æ•°æ® ContentValues name = new ContentValues(); // è®¾ç½®RAW_CONTACT_IDï¼Œè¡¨ç¤ºè¯¥æ•°æ®å±äºå“ªä¸ªè”ç³»äºº name.put(Contacts.Data.RAW_CONTACT_ID, rawContactId); // è®¾ç½®æ•°æ®çš„MIMEç±»å‹ä¸ºStructuredNameï¼ˆè”ç³»äººçš„åå­—ï¼‰ name.put(Contacts.Data.MIMETYPE, CommonDataKinds.StructuredName.CONTENT_ITEM_TYPE); // è®¾ç½®è”ç³»äººçš„åå­— name.put(Contacts.Data.DATA1, contact.name); // å°†è”ç³»äººçš„åå­—æ•°æ®æ’å…¥åˆ°Dataè¡¨ä¸­ resolver.insert(ContactsContract.Data.CONTENT_URI, name); // åˆ›å»ºä¸€ä¸ªContentValueså¯¹è±¡ï¼Œç”¨äºå­˜å‚¨è”ç³»äººçš„ç”µè¯å·ç æ•°æ® ContentValues phone = new ContentValues(); // è®¾ç½®RAW_CONTACT_IDï¼Œè¡¨ç¤ºè¯¥æ•°æ®å±äºå“ªä¸ªè”ç³»äºº phone.put(Contacts.Data.RAW_CONTACT_ID, rawContactId); // è®¾ç½®æ•°æ®çš„MIMEç±»å‹ä¸ºPhoneï¼ˆè”ç³»äººçš„ç”µè¯ï¼‰ phone.put(Contacts.Data.MIMETYPE, CommonDataKinds.Phone.CONTENT_ITEM_TYPE); // è®¾ç½®è”ç³»äººçš„ç”µè¯å·ç  phone.put(Contacts.Data.DATA1, contact.phone); // è®¾ç½®ç”µè¯å·ç çš„ç±»å‹ä¸ºMobileï¼ˆæ‰‹æœºï¼‰ phone.put(Contacts.Data.DATA2, CommonDataKinds.Phone.TYPE_MOBILE); // å°†è”ç³»äººçš„ç”µè¯å·ç æ•°æ®æ’å…¥åˆ°Dataè¡¨ä¸­ resolver.insert(ContactsContract.Data.CONTENT_URI, phone); // åˆ›å»ºä¸€ä¸ªContentValueså¯¹è±¡ï¼Œç”¨äºå­˜å‚¨è”ç³»äººçš„é‚®ç®±æ•°æ® ContentValues email = new ContentValues(); // è®¾ç½®RAW_CONTACT_IDï¼Œè¡¨ç¤ºè¯¥æ•°æ®å±äºå“ªä¸ªè”ç³»äºº email.put(Contacts.Data.RAW_CONTACT_ID, rawContactId); // è®¾ç½®æ•°æ®çš„MIMEç±»å‹ä¸ºEmailï¼ˆè”ç³»äººçš„é‚®ç®±ï¼‰ email.put(Contacts.Data.MIMETYPE, CommonDataKinds.Email.CONTENT_ITEM_TYPE); // è®¾ç½®è”ç³»äººçš„é‚®ç®±åœ°å€ï¼ˆæ­¤å¤„é”™è¯¯ï¼Œåº”è¯¥æ˜¯contact.emailï¼Œè€Œä¸æ˜¯contact.phoneï¼‰ email.put(Contacts.Data.DATA1, contact.email); // çº æ­£äº†åŸæ¥çš„é”™è¯¯ // è®¾ç½®é‚®ç®±åœ°å€çš„ç±»å‹ä¸ºWorkï¼ˆå·¥ä½œé‚®ç®±ï¼‰ email.put(Contacts.Data.DATA2, CommonDataKinds.Email.TYPE_WORK); // å°†è”ç³»äººçš„é‚®ç®±æ•°æ®æ’å…¥åˆ°Dataè¡¨ä¸­ resolver.insert(ContactsContract.Data.CONTENT_URI, email); } private void addContact(ContentResolver resolver, Contact contact) { ContentValues values = new ContentValues(); Uri uri = resolver.insert(ContactsContract.RawContacts.CONTENT_URI, values); long rawDataId = ContentUris.parseId(uri); } } å‘é€çŸ­ä¿¡ Java package com.showguan.chapter07_client; // å®šä¹‰åŒ…å public class SentMmsActivity extends AppCompatActivity implements View.OnClickListener { // å®šä¹‰SentMmsActivityç±»ï¼Œç»§æ‰¿AppCompatActivityï¼Œå®ç°View.OnClickListeneræ¥å£ private static String TAG = \u0026#34;Kennem\u0026#34;; // å®šä¹‰TAGç”¨äºæ—¥å¿— private ActivityResultLauncher\u0026lt;Intent\u0026gt; mResultLauncher; // å®šä¹‰ActivityResultLauncherå˜é‡ private EditText et_phone_number; // å®šä¹‰EditTextå˜é‡ç”¨äºç”µè¯å·ç è¾“å…¥ private EditText et_title; // å®šä¹‰EditTextå˜é‡ç”¨äºæ ‡é¢˜è¾“å…¥ private EditText et_desc; // å®šä¹‰EditTextå˜é‡ç”¨äºæè¿°è¾“å…¥ private Uri picUri; // å®šä¹‰Uriå˜é‡ç”¨äºå­˜å‚¨å›¾ç‰‡URI @Override protected void onCreate(Bundle savedInstanceState) { // onCreateæ–¹æ³•ï¼ŒActivityåˆ›å»ºæ—¶è°ƒç”¨ super.onCreate(savedInstanceState); // è°ƒç”¨çˆ¶ç±»onCreateæ–¹æ³• setContentView(R.layout.activity_sent_mms); // è®¾ç½®å¸ƒå±€æ–‡ä»¶ ImageView iv_add_pic = findViewById(R.id.iv_add_pic); // è·å–ImageViewç”¨äºæ·»åŠ å›¾ç‰‡ findViewById(R.id.btn_send).setOnClickListener(this); // è®¾ç½®å‘é€æŒ‰é’®çš„ç‚¹å‡»ç›‘å¬ iv_add_pic.setOnClickListener(this); // è®¾ç½®æ·»åŠ å›¾ç‰‡æŒ‰é’®çš„ç‚¹å‡»ç›‘å¬ et_phone_number = findViewById(R.id.et_phone_number); // è·å–EditTextç”¨äºç”µè¯å·ç è¾“å…¥ et_title = findViewById(R.id.et_title); // è·å–EditTextç”¨äºæ ‡é¢˜è¾“å…¥ et_desc = findViewById(R.id.et_desc); // è·å–EditTextç”¨äºæè¿°è¾“å…¥ mResultLauncher = registerForActivityResult(new ActivityResultContracts.StartActivityForResult(), result -\u0026gt; { // æ³¨å†ŒActivityç»“æœå¯åŠ¨å™¨ if(result.getResultCode() == RESULT_OK){ // æ£€æŸ¥ç»“æœç æ˜¯å¦ä¸ºRESULT_OK Intent intent = result.getData(); // è·å–ç»“æœæ•°æ® picUri = intent.getData(); // è·å–å›¾ç‰‡URI if(picUri != null){ // å¦‚æœURIä¸ä¸ºç©º iv_add_pic.setImageURI(picUri); // è®¾ç½®ImageViewæ˜¾ç¤ºå›¾ç‰‡ Log.d(TAG, picUri.toString()); // æ‰“å°å›¾ç‰‡URIåˆ°æ—¥å¿— } } }); } @Override public void onClick(View v) { // onClickæ–¹æ³•ï¼Œå¤„ç†ç‚¹å‡»äº‹ä»¶ if(v.getId() == R.id.iv_add_pic){ // å¦‚æœç‚¹å‡»çš„æ˜¯æ·»åŠ å›¾ç‰‡æŒ‰é’® Intent intent = new Intent(Intent.ACTION_GET_CONTENT); // åˆ›å»ºIntentç”¨äºé€‰æ‹©å†…å®¹ intent.setType(\u0026#34;image/*\u0026#34;); // è®¾ç½®é€‰æ‹©ç±»å‹ä¸ºå›¾ç‰‡ mResultLauncher.launch(intent); // å¯åŠ¨é€‰æ‹©å›¾ç‰‡çš„Activity } else if (v.getId() == R.id.btn_send) { // å¦‚æœç‚¹å‡»çš„æ˜¯å‘é€æŒ‰é’® sendMms(et_phone_number.getText().toString(), // è°ƒç”¨sendMmsæ–¹æ³•å‘é€MMS et_title.getText().toString(), // è·å–æ ‡é¢˜æ–‡æœ¬ et_desc.getText().toString()); // è·å–æè¿°æ–‡æœ¬ } } private void sendMms(String phone, String title, String desc) { // sendMmsæ–¹æ³•ï¼Œç”¨äºå‘é€MMS Intent intent = new Intent(Intent.ACTION_SEND); // åˆ›å»ºå‘é€Intent intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK); // æ·»åŠ æ–°ä»»åŠ¡æ ‡å¿— intent.addFlags(Intent.FLAG_GRANT_READ_URI_PERMISSION); // æ·»åŠ URIè¯»æƒé™æ ‡å¿— intent.putExtra(\u0026#34;address\u0026#34;, phone); // è®¾ç½®ç”µè¯å·ç  intent.putExtra(\u0026#34;subject\u0026#34;, title); // è®¾ç½®æ ‡é¢˜ intent.putExtra(\u0026#34;sms_body\u0026#34;, desc); // è®¾ç½®æè¿° intent.putExtra(Intent.EXTRA_STREAM, picUri); // æ·»åŠ å›¾ç‰‡URI intent.setType(\u0026#34;image/*\u0026#34;); // è®¾ç½®ç±»å‹ä¸ºå›¾ç‰‡ startActivity(intent); // å¯åŠ¨å‘é€MMSçš„Activity ToastUtil.show(this, \u0026#34;ä»åœ¨å¼¹çª—ä¸­é€‰æ‹©ä¿¡æ¯æˆ–çŸ­ä¿¡åº”ç”¨\u0026#34;); // æ˜¾ç¤ºæç¤ºä¿¡æ¯ } } FileProvideræŒ‡å®šè·å–å›¾ç‰‡è·¯å¾„å¹¶å‘é€çŸ­ä¿¡ package com.showguan.chapter07_client; // å®šä¹‰åŒ…å public class ProvideMmsActivity extends AppCompatActivity { // å®šä¹‰ProvideMmsActivityç±»ï¼Œç»§æ‰¿AppCompatActivity private static String TAG = \u0026#34;Kennem\u0026#34;; // å®šä¹‰TAGç”¨äºæ—¥å¿— private List\u0026lt;ImageInfo\u0026gt; mImageList = new ArrayList\u0026lt;\u0026gt;(); // å®šä¹‰ç”¨äºå­˜å‚¨å›¾ç‰‡ä¿¡æ¯çš„åˆ—è¡¨ private GridLayout gl_appendix; // å®šä¹‰GridLayoutç”¨äºæ˜¾ç¤ºå›¾ç‰‡ private static final String[] PERMISSION_STORAGE = new String[]{ // å®šä¹‰å­˜å‚¨æƒé™æ•°ç»„ Manifest.permission.READ_EXTERNAL_STORAGE, }; private static final int PERMISSION_STORAGE_CODE = 1; // å®šä¹‰å­˜å‚¨æƒé™è¯·æ±‚ç  private EditText et_phone_number; // å®šä¹‰EditTextç”¨äºè¾“å…¥ç”µè¯å·ç  private EditText et_message; // å®šä¹‰EditTextç”¨äºè¾“å…¥æ¶ˆæ¯ private EditText et_title; // å®šä¹‰EditTextç”¨äºè¾“å…¥æ ‡é¢˜ @Override protected void onCreate(Bundle savedInstanceState) { // onCreateæ–¹æ³•ï¼ŒActivityåˆ›å»ºæ—¶è°ƒç”¨ super.onCreate(savedInstanceState); // è°ƒç”¨çˆ¶ç±»onCreateæ–¹æ³• setContentView(R.layout.activity_provide_mms); // è®¾ç½®å¸ƒå±€æ–‡ä»¶ gl_appendix = findViewById(R.id.gl_appendix); // è·å–GridLayoutç”¨äºæ˜¾ç¤ºå›¾ç‰‡ et_title = findViewById(R.id.et_title); // è·å–EditTextç”¨äºè¾“å…¥æ ‡é¢˜ et_message = findViewById(R.id.et_message); // è·å–EditTextç”¨äºè¾“å…¥æ¶ˆæ¯ et_phone_number = findViewById(R.id.et_phone_number); // è·å–EditTextç”¨äºè¾“å…¥ç”µè¯å·ç  MediaScannerConnection.scanFile( // è°ƒç”¨MediaScannerConnectionæ‰«ææ–‡ä»¶ this, new String[]{Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_DOWNLOADS).toString()}, // æ‰«æä¸‹è½½ç›®å½• null, null ); if (PermissionUtil.checkPermission(this, PERMISSION_STORAGE, PERMISSION_STORAGE_CODE)) { // æ£€æŸ¥å­˜å‚¨æƒé™ loadImageList(); // åŠ è½½å›¾ç‰‡åˆ—è¡¨ showImageGrid(); // æ˜¾ç¤ºå›¾ç‰‡ç½‘æ ¼ } } @Override public void onRequestPermissionsResult(int requestCode, @NonNull String[] permissions, @NonNull int[] grantResults) { // æƒé™è¯·æ±‚ç»“æœå›è°ƒ super.onRequestPermissionsResult(requestCode, permissions, grantResults); // è°ƒç”¨çˆ¶ç±»æ–¹æ³• if (requestCode == PERMISSION_STORAGE_CODE) { // åˆ¤æ–­è¯·æ±‚ç æ˜¯å¦ä¸ºå­˜å‚¨æƒé™ if (PermissionUtil.checkGranted(grantResults)) { // æ£€æŸ¥æƒé™æ˜¯å¦è¢«æˆäºˆ loadImageList(); // åŠ è½½å›¾ç‰‡åˆ—è¡¨ showImageGrid(); // æ˜¾ç¤ºå›¾ç‰‡ç½‘æ ¼ } } } private void showImageGrid() { // æ˜¾ç¤ºå›¾ç‰‡ç½‘æ ¼çš„æ–¹æ³• gl_appendix.removeAllViews(); // ç§»é™¤æ‰€æœ‰è§†å›¾ for (ImageInfo image : mImageList) { // éå†å›¾ç‰‡åˆ—è¡¨ ImageView imageView = new ImageView(this); // åˆ›å»ºImageView Bitmap bitmap = BitmapFactory.decodeFile(image.path); // è§£ç å›¾ç‰‡æ–‡ä»¶ imageView.setImageBitmap(bitmap); // è®¾ç½®å›¾ç‰‡ imageView.setScaleType(ImageView.ScaleType.FIT_CENTER); // è®¾ç½®ç¼©æ”¾ç±»å‹ int px = Utils.dip2px(this, 110); // å°†110dpè½¬æ¢ä¸ºpx ViewGroup.LayoutParams params = new ViewGroup.LayoutParams(px, px); // åˆ›å»ºå¸ƒå±€å‚æ•° imageView.setLayoutParams(params); // è®¾ç½®å¸ƒå±€å‚æ•° int padding = Utils.dip2px(this, 5); // å°†5dpè½¬æ¢ä¸ºpx imageView.setPadding(padding, padding, padding, padding); // è®¾ç½®å†…è¾¹è· imageView.setOnClickListener(v -\u0026gt; { // è®¾ç½®ç‚¹å‡»ç›‘å¬å™¨ sendMms(et_phone_number.getText().toString(), // è·å–è¾“å…¥çš„ç”µè¯å·ç  et_title.getText().toString(), // è·å–è¾“å…¥çš„æ ‡é¢˜ et_message.getText().toString(), // è·å–è¾“å…¥çš„æ¶ˆæ¯ image.path); // è·å–å›¾ç‰‡è·¯å¾„ }); gl_appendix.addView(imageView); // å°†ImageViewæ·»åŠ åˆ°GridLayout } } private void sendMms(String phone, String title, String desc, String path) { // å‘é€MMSçš„æ–¹æ³• Uri uri = Uri.parse(path); // å°†è·¯å¾„è§£æä¸ºUri // å…¼å®¹Android 7.0 æŠŠè®¿é—®æ–‡ä»¶çš„Uriæ–¹å¼æ”¹ä¸ºFileProvider if (Build.VERSION.SDK_INT \u0026gt;= Build.VERSION_CODES.N) { // åˆ¤æ–­æ˜¯å¦ä¸ºAndroid 7.0åŠä»¥ä¸Š uri = FileProvider.getUriForFile(this, getString(R.string.file_Provider), new File(path)); // ä½¿ç”¨FileProviderè·å–Uri Log.d(TAG, String.format(\u0026#34;FileProvider Uri : %s\u0026#34;, uri.toString())); // æ‰“å°FileProviderçš„Uri } Intent intent = new Intent(Intent.ACTION_SEND); // åˆ›å»ºå‘é€Intent intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK); // æ·»åŠ æ–°ä»»åŠ¡æ ‡å¿— intent.addFlags(Intent.FLAG_GRANT_READ_URI_PERMISSION); // æ·»åŠ è¯»å–URIæƒé™æ ‡å¿— intent.putExtra(\u0026#34;address\u0026#34;, phone); // è®¾ç½®ç”µè¯å·ç  intent.putExtra(\u0026#34;subject\u0026#34;, title); // è®¾ç½®æ ‡é¢˜ intent.putExtra(\u0026#34;sms_body\u0026#34;, desc); // è®¾ç½®æ¶ˆæ¯å†…å®¹ intent.putExtra(Intent.EXTRA_STREAM, uri); // æ·»åŠ å›¾ç‰‡Uri intent.setType(\u0026#34;image/*\u0026#34;); // è®¾ç½®ç±»å‹ä¸ºå›¾ç‰‡ startActivity(intent); // å¯åŠ¨Activity ToastUtil.show(this, \u0026#34;ä»åœ¨å¼¹çª—ä¸­é€‰æ‹©ä¿¡æ¯æˆ–çŸ­ä¿¡åº”ç”¨\u0026#34;); // æ˜¾ç¤ºæç¤ºä¿¡æ¯ } @SuppressLint(\u0026#34;Range\u0026#34;) private void loadImageList() { // åŠ è½½å›¾ç‰‡åˆ—è¡¨çš„æ–¹æ³• String[] columns = new String[]{ // å®šä¹‰è¦æŸ¥è¯¢çš„åˆ— MediaStore.Images.Media._ID, MediaStore.Images.Media.TITLE, MediaStore.Images.Media.SIZE, MediaStore.Images.Media.DATA }; Cursor cursor = getContentResolver().query( // æŸ¥è¯¢å›¾ç‰‡åª’ä½“åº“ MediaStore.Images.Media.EXTERNAL_CONTENT_URI, // æŸ¥è¯¢å¤–éƒ¨å›¾ç‰‡URI columns, // æŸ¥è¯¢çš„åˆ— \u0026#34;_size \u0026lt; 307200\u0026#34;, // æŸ¥è¯¢æ¡ä»¶ï¼šå¤§å°å°äº300KB null, // æŸ¥è¯¢å‚æ•° \u0026#34;_size DESC\u0026#34;); // æ’åºæ–¹å¼ï¼šæŒ‰å¤§å°é™åº int count = 0; // å®šä¹‰è®¡æ•°å™¨ if (cursor != null) { // å¦‚æœæ¸¸æ ‡ä¸ä¸ºç©º while (cursor.moveToNext() \u0026amp;\u0026amp; count \u0026lt; 6) { // éå†æŸ¥è¯¢ç»“æœï¼Œæœ€å¤š6ä¸ª ImageInfo image = new ImageInfo(); // åˆ›å»ºImageInfoå¯¹è±¡ image.id = cursor.getLong(cursor.getColumnIndex(MediaStore.Images.Media._ID)); // è·å–å›¾ç‰‡ID image.name = cursor.getString(cursor.getColumnIndex(MediaStore.Images.Media.TITLE)); // è·å–å›¾ç‰‡æ ‡é¢˜ image.size = cursor.getLong(cursor.getColumnIndex(MediaStore.Images.Media.SIZE)); // è·å–å›¾ç‰‡å¤§å° image.path = cursor.getString(cursor.getColumnIndex(MediaStore.Images.Media.DATA)); // è·å–å›¾ç‰‡è·¯å¾„ if (FileUtil.checkFileUri(this, image.path)) { // æ£€æŸ¥æ–‡ä»¶URIæ˜¯å¦æœ‰æ•ˆ count += 1; // å¢åŠ è®¡æ•° mImageList.add(image); // å°†å›¾ç‰‡ä¿¡æ¯æ·»åŠ åˆ°åˆ—è¡¨ } Log.d(TAG, image.toString()); // æ‰“å°å›¾ç‰‡ä¿¡æ¯ } } } } xml \u0026lt;LinearLayout xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34; android:orientation=\u0026#34;vertical\u0026#34; android:padding=\u0026#34;5dp\u0026#34;\u0026gt; \u0026lt;LinearLayout android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;40dp\u0026#34; android:orientation=\u0026#34;horizontal\u0026#34;\u0026gt; \u0026lt;TextView android:layout_width=\u0026#34;wrap_content\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34; android:gravity=\u0026#34;center\u0026#34; android:text=\u0026#34;å¯¹æ–¹å·ç ï¼š\u0026#34; android:textColor=\u0026#34;@color/black\u0026#34; android:textSize=\u0026#34;17sp\u0026#34; /\u0026gt; \u0026lt;EditText android:id=\u0026#34;@+id/et_phone_number\u0026#34; android:layout_width=\u0026#34;0dp\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34; android:layout_margin=\u0026#34;3dp\u0026#34; android:layout_weight=\u0026#34;1\u0026#34; android:background=\u0026#34;@drawable/edittext_selector\u0026#34; android:inputType=\u0026#34;number\u0026#34; android:textColor=\u0026#34;@color/black\u0026#34; android:textSize=\u0026#34;17sp\u0026#34; android:text=\u0026#34;10086\u0026#34;/\u0026gt; \u0026lt;/LinearLayout\u0026gt; \u0026lt;LinearLayout android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;40dp\u0026#34; android:orientation=\u0026#34;horizontal\u0026#34;\u0026gt; \u0026lt;TextView android:layout_width=\u0026#34;wrap_content\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34; android:gravity=\u0026#34;center\u0026#34; android:text=\u0026#34;å½©ä¿¡æ ‡é¢˜ï¼š\u0026#34; android:textColor=\u0026#34;@color/black\u0026#34; android:textSize=\u0026#34;17sp\u0026#34; /\u0026gt; \u0026lt;EditText android:id=\u0026#34;@+id/et_title\u0026#34; android:layout_width=\u0026#34;0dp\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34; android:layout_margin=\u0026#34;3dp\u0026#34; android:layout_weight=\u0026#34;1\u0026#34; android:background=\u0026#34;@drawable/edittext_selector\u0026#34; android:textColor=\u0026#34;@color/black\u0026#34; android:textSize=\u0026#34;17sp\u0026#34; android:text=\u0026#34;Hallo\u0026#34;/\u0026gt; \u0026lt;/LinearLayout\u0026gt; \u0026lt;LinearLayout android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;100dp\u0026#34; android:orientation=\u0026#34;horizontal\u0026#34;\u0026gt; \u0026lt;TextView android:layout_width=\u0026#34;wrap_content\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34; android:gravity=\u0026#34;center\u0026#34; android:text=\u0026#34;å½©ä¿¡å†…å®¹ï¼š\u0026#34; android:textColor=\u0026#34;@color/black\u0026#34; android:textSize=\u0026#34;17sp\u0026#34; /\u0026gt; \u0026lt;EditText android:id=\u0026#34;@+id/et_message\u0026#34; android:layout_width=\u0026#34;0dp\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34; android:layout_margin=\u0026#34;3dp\u0026#34; android:layout_weight=\u0026#34;1\u0026#34; android:background=\u0026#34;@drawable/edittext_selector\u0026#34; android:gravity=\u0026#34;left|top\u0026#34; android:textColor=\u0026#34;@color/black\u0026#34; android:textSize=\u0026#34;17sp\u0026#34; android:text=\u0026#34;test\u0026#34;/\u0026gt; \u0026lt;/LinearLayout\u0026gt; \u0026lt;TextView android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;30dp\u0026#34; android:text=\u0026#34;ç‚¹å‡»ä¸‹æ–¹å›¾ç‰‡å¼€å§‹å‘é€å½©ä¿¡\u0026#34; android:textColor=\u0026#34;@color/black\u0026#34; android:textSize=\u0026#34;17sp\u0026#34; /\u0026gt; \u0026lt;GridLayout andddroid:id=\u0026#34;@+id/gl_appendix\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:columnCount=\u0026#34;3\u0026#34; /\u0026gt; \u0026lt;/LinearLayout\u0026gt; FileProvider å®‰è£…apk Java package com.showguan.chapter07_client; public class ProviderApkActivity extends AppCompatActivity implements View.OnClickListener { private static final String TAG = \u0026#34;Kennem\u0026#34;; // æ‰€éœ€æƒé™åˆ—è¡¨ private static final String[] PERMISSIONS = new String[]{ Manifest.permission.REQUEST_INSTALL_PACKAGES, Manifest.permission.READ_EXTERNAL_STORAGE, Manifest.permission.WRITE_EXTERNAL_STORAGE }; // è¯·æ±‚ç ï¼Œç”¨äºæƒé™è¯·æ±‚å›è°ƒæ ‡è¯† private static final int REQUEST_CODE = 1; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_provider_apk); // è®¾ç½®æŒ‰é’®ç‚¹å‡»ç›‘å¬ findViewById(R.id.btn_install).setOnClickListener(this); } @Override public void onClick(View v) { // æ£€æŸ¥æƒé™å¹¶å®‰è£…APK checkAndInstall(); } /** * æ£€æŸ¥æƒé™å¹¶å®‰è£…APK */ private void checkAndInstall() { if (Build.VERSION.SDK_INT \u0026gt;= Build.VERSION_CODES.R) { Log.d(TAG, \u0026#34;android 11 + \u0026#34;); // æ£€æŸ¥æ˜¯å¦å…·æœ‰ç®¡ç†æ‰€æœ‰æ–‡ä»¶çš„æƒé™ if (!Environment.isExternalStorageManager()) { Log.d(TAG, \u0026#34;checkisExternalStorageManager\u0026#34;); // è·³è½¬åˆ°è®¾ç½®é¡µé¢è¯·æ±‚æƒé™ Intent intent = new Intent(Settings.ACTION_MANAGE_APP_ALL_FILES_ACCESS_PERMISSION); intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK); intent.setData(Uri.fromParts(\u0026#34;package\u0026#34;, getPackageName(), null)); startActivity(intent); } else { // æƒé™å·²æˆäºˆï¼Œ // å®‰è£…APK installApk(); } } else { // æ£€æŸ¥æ‰€éœ€æƒé™æ˜¯å¦å·²å…¨éƒ¨æˆäºˆ if (PermissionUtil.checkPermission(this, PERMISSIONS, REQUEST_CODE)) { // æƒé™å·²æˆäºˆï¼Œå®‰è£…APK installApk(); } } } /** * å®‰è£…APKæ–‡ä»¶ */ private void installApk() { // è·å–APKæ–‡ä»¶çš„è·¯å¾„ String apkPath = Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_DOWNLOADS).toString() + \u0026#34;/chapter06-release.apk\u0026#34;; Log.d(TAG, \u0026#34;apkPath:\u0026#34; + apkPath); // è·å–åº”ç”¨åŒ…ç®¡ç†å™¨ PackageManager pm = getPackageManager(); // è·å–APKæ–‡ä»¶çš„åŒ…ä¿¡æ¯ PackageInfo pi = pm.getPackageArchiveInfo(apkPath, PackageManager.GET_ACTIVITIES); if (pi == null) { // å¦‚æœåŒ…ä¿¡æ¯ä¸ºç©ºï¼Œæ˜¾ç¤ºæ–‡ä»¶æŸåæç¤º ToastUtil.show(this, \u0026#34;å®‰è£…æ–‡ä»¶å·²ç»æŸå!\u0026#34;); return; } // è·å–APKæ–‡ä»¶çš„Uri Uri uri = Uri.parse(apkPath); // å…¼å®¹Android 7.0åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œé€šè¿‡FileProviderè·å–Uri if (Build.VERSION.SDK_INT \u0026gt;= Build.VERSION_CODES.N) { // é€šè¿‡FileProviderè·å–æ–‡ä»¶çš„Uri uri = FileProvider.getUriForFile(this, getString(R.string.file_provider), new File(apkPath)); Log.d(\u0026#34;Kennem\u0026#34;, String.format(\u0026#34;new uri:%s\u0026#34;, uri.toString())); } // åˆ›å»ºIntentä»¥å¯åŠ¨APKå®‰è£…ç¨‹åº Intent intent = new Intent(Intent.ACTION_VIEW); intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK); intent.addFlags(Intent.FLAG_GRANT_READ_URI_PERMISSION); // è®¾ç½®Uriçš„æ•°æ®ç±»å‹ä¸ºAPKæ–‡ä»¶ intent.setDataAndType(uri, \u0026#34;application/vnd.android.package-archive\u0026#34;); // å¯åŠ¨ç³»ç»Ÿè‡ªå¸¦çš„åº”ç”¨å®‰è£…ç¨‹åº startActivity(intent); } @Override public void onRequestPermissionsResult(int requestCode, @NonNull String[] permissions, @NonNull int[] grantResults) { super.onRequestPermissionsResult(requestCode, permissions, grantResults); // æ£€æŸ¥æƒé™è¯·æ±‚ç»“æœ if (requestCode == REQUEST_CODE \u0026amp;\u0026amp; PermissionUtil.checkGranted(grantResults)) { // æƒé™å·²æˆäºˆï¼Œå®‰è£…APK installApk(); } } } ","permalink":"https://kennems.github.io/posts/tech/android4/","summary":"Androidï¼ˆ4ï¼‰ å°±ç®—æ˜¯æœ€ä½çš„15x15éƒ½å·²ç»ä¸é”™äº†ï¼Œä»¥åè¿˜æœ‰æ—¶é—´å»å­¦ï¼Œä¸Šäº†ç ”ç©¶ç”Ÿä¹Ÿæ²¡äººèƒ½ä¿è¯ä½ æœ‰15x15çš„æ”¶å…¥ å†…å®¹æä¾›è€…(Conten","title":"Androidï¼ˆ4ï¼‰"},{"content":"Androidï¼ˆ2ï¼‰ Activityçš„å¯åŠ¨å’Œç»“æŸ ä»å½“å‰é¡µé¢è·³è½¬åˆ°æ–°é¡µé¢ï¼Œè·³è½¬ä»£ç å¦‚ä¸‹ï¼š\nstartActivity(new Intent(æºé¡µé¢.thisï¼Œ ç›®æ ‡é¡µé¢.class)) ä»å½“å‰é¡µé¢å›åˆ°ä¸Šä¸€ä¸ªé¡µé¢ï¼Œç›¸å½“äºå…³é—­å½“å‰é¡µé¢ï¼Œè¿”å›ä»£ç å¦‚ä¸‹ï¼š\nfinish(); //ç»“æŸå½“å‰çš„æ´»åŠ¨é¡µé¢ Activityå£°æ˜å‘¨æœŸ onCreate ï¼šåˆ›å»ºæ´»åŠ¨ã€‚æŠŠé¡µé¢å¸ƒå±€åŠ è½½è¿›å†…å­˜ï¼Œè¿›å…¥äº†åˆå§‹çŠ¶æ€ã€‚ onStartï¼šå¼€å§‹æ´»åŠ¨ã€‚æŠŠæ´»åŠ¨æ˜¾ç¤ºåœ¨å±å¹•ä¸Šï¼Œè¿›å…¥äº†å°±ç»ªçŠ¶æ€ onResumeï¼šæ¢å¤æ´»åŠ¨ã€‚æ´»åŠ¨é¡µé¢è¿›å…¥äº†æ´»è·ƒçŠ¶æ€ï¼Œèƒ½å¤Ÿä¸ç”¨æˆ·æ­£å¸¸äº¤äº’ï¼Œä¾‹å¦‚å…è®¸å“åº”ç”¨æˆ·çš„ç‚¹å‡»åŠ¨ä½œï¼Œå…è®¸ç”¨æˆ·è¾“å…¥æ–‡å­—ç­‰ç­‰ã€‚åŠ¨ç”»å¼€å¯ onPauseï¼šæš‚åœæ´»åŠ¨ã€‚é¡µé¢è¿›å…¥æš‚åœçŠ¶æ€ï¼Œæ— æ³•ä¸ç”¨æˆ·æ­£å¸¸äº¤äº’ã€‚åŠ¨ç”»æš‚åœ onStopï¼šåœæ­¢æ´»åŠ¨ã€‚é¡µé¢ä¸åœ¨å±å¹•ä¸Šæ˜¾ç¤ºã€‚ onDestroyï¼šé”€æ¯æ´»åŠ¨ã€‚å›æ”¶æ´»åŠ¨å ç”¨çš„ç³»ç»Ÿèµ„æºï¼ŒæŠŠé¡µé¢ä»å†…å­˜ä¸­æ¸…é™¤ã€‚ onRestartï¼šé‡å¯æ´»åŠ¨ã€‚é‡æ–°åŠ è½½å†…å­˜ä¸­çš„é¡µé¢æ•°æ®ã€‚ onNewIntentï¼šé‡ç”¨å·²æœ‰çš„æ´»åŠ¨å®ä¾‹ Activityçš„å¯åŠ¨æ¨¡å¼ launchModeå±æ€§å€¼ è¯´æ˜ standard æ ‡å‡†æ¨¡å¼ï¼Œæ— è®ºä½•æ—¶å¯åŠ¨å“ªä¸ªæ´»åŠ¨ï¼Œéƒ½æ˜¯é‡æ–°åˆ›å»ºè¯¥é¡µé¢çš„å®ä¾‹å¹¶æ”¾å…¥æ ˆé¡¶ã€‚å¦‚æœä¸æŒ‡å®šlaunchModeå±æ€§ï¼Œåˆ™é»˜è®¤ä¸ºæ ‡å‡†æ¨¡å¼ singleTop å¯åŠ¨æ–°æ´»åŠ¨æ—¶ï¼Œåˆ¤æ–­å¦‚æœæ ˆé¡¶æ­£å¥½å°±æ˜¯è¯¥æ´»åŠ¨çš„å®ä¾‹ï¼Œåˆ™é‡ç”¨è¯¥å®ä¾‹ï¼›å¦åˆ™åˆ›å»ºæ–°çš„å®ä¾‹å¹¶æ”¾å…¥æ ˆé¡¶ï¼Œä¹Ÿå°±æ˜¯æŒ‰ç…§standardæ¨¡å¼å¤„ç† singleTask å¯åŠ¨æ–°æ´»åŠ¨æ—¶ï¼Œåˆ¤æ–­å¦‚æœæ ˆä¸­å­˜åœ¨è¯¥æ´»åŠ¨çš„å®ä¾‹ï¼Œåˆ™é‡ç”¨è¯¥å®ä¾‹ï¼Œå¯åŠ¨æ–°æ´»åŠ¨æ—¶ï¼Œåˆ¤æ–­å¦‚æœæ ˆä¸­å­˜åœ¨è¯¥æ´»åŠ¨çš„å®ä¾‹ï¼Œåˆ™é‡ç”¨è¯¥å®ä¾‹ï¼Œå¹¶æ¸…é™¤ä½äºè¯¥å®ä¾‹ä¸Šé¢çš„æ‰€æœ‰å®ä¾‹ï¼›å¦åˆ™æŒ‰ç…§standardæ¨¡å¼å¤„ç† singleInstance å¯åŠ¨æ–°æ´»åŠ¨æ—¶ï¼Œå°†è¯¥æ´»åŠ¨çš„å®ä¾‹æ”¾å…¥ä¸€ä¸ªæ–°æ ˆä¸­ï¼ŒåŸæ ˆçš„å®ä¾‹åˆ—è¡¨ä¿æŒä¸å˜ å¯åŠ¨æ ‡å¿—çš„å–å€¼è¯´æ˜å¦‚ä¸‹ï¼š\nIntent.FLAG_ACTIVITY_NEW_TASKï¼šå¼€è¾Ÿä¸€ä¸ªæ–°çš„ä»»åŠ¡æ ˆ\nIntent.FLAG_ACTIVITY_SINGLE_TOPï¼šå½“æ ˆé¡¶ä¸ºå¾…è·³è½¬çš„æ´»åŠ¨å®ä¾‹ä¹‹æ—¶ï¼Œåˆ™é‡ç”¨æ ˆé¡¶çš„å®ä¾‹\nIntent.FLAG_ACTIVITY_CLEAR_TOPï¼šå½“æ ˆä¸­å­˜åœ¨å¾…è·³è½¬çš„æ´»åŠ¨å®ä¾‹æ—¶ï¼Œåˆ™é‡æ–°åˆ›å»ºä¸€ä¸ªæ–°å®ä¾‹ï¼Œå¹¶æ¸…é™¤åŸå®ä¾‹ä¸Šæ–¹çš„æ‰€æœ‰å®ä¾‹\nIntent.FLAG_ACTIVITY_NO_HISTORYï¼šæ ˆä¸­ä¸ä¿å­˜æ–°å¯åŠ¨çš„æ´»åŠ¨å®ä¾‹\nIntent.FLAG_ACTIVITY_CLEAR_TASKï¼šè·³è½¬åˆ°æ–°é¡µé¢æ—¶ï¼Œæ ˆä¸­çš„åŸæœ‰å®ä¾‹éƒ½è¢«æ¸…ç©º\næ˜¾ç¤ºIntentå’Œéšå¼Intent Intentæ˜¯å„ä¸ªç»„ä»¶ä¹‹é—´ä¿¡æ¯æ²Ÿé€šçš„æ¡¥æ¢ï¼Œå®ƒç”¨äºAndroidå„ç»„ä»¶ä¹‹é—´çš„é€šä¿¡ï¼Œä¸»è¦å®Œæˆä¸‹åˆ—å·¥ä½œï¼š\næ ‡æ˜æœ¬æ¬¡é€šä¿¡è¯·æ±‚ä»å“ªé‡Œæ¥ï¼Œåˆ°å“ªé‡Œå»ï¼Œè¦æ€ä¹ˆèµ°ã€‚ å‘èµ·æ–¹æºå¸¦æœ¬æ¬¡é€šä¿¡éœ€è¦çš„æ•°æ®å†…å®¹ï¼Œæ¥æ”¶æ–¹ä»æ”¶åˆ°çš„æ„å›¾ä¸­è§£ææ•°æ® å‘èµ·æ–¹è‹¥æƒ³åˆ¤æ–­æ¥æ”¶æ–¹çš„å¤„ç†ç»“æœï¼Œæ„å›¾å°±è¦è´Ÿè´£è®©æ¥æ”¶æ–¹ä¼ å›åº”ç­”çš„æ•°æ®å†…å®¹ æ˜¾ç¤ºIntent æ˜¾ç¤ºIntentï¼Œç›´æ¥æŒ‡å®šæ¥æºæ´»åŠ¨ä¸ç›®æ ‡æ´»åŠ¨ï¼Œå±äºç²¾ç¡®åŒ¹é…ã€‚ä¸‰ç§æ„å»ºæ–¹å¼ï¼š\nåœ¨Intentçš„æ„é€ å‡½æ•°ä¸­æŒ‡å®š è°ƒç”¨æ„å›¾å¯¹è±¡çš„setClassæ–¹æ³•æŒ‡å®š è°ƒç”¨æ„å›¾å¯¹è±¡çš„setComponentæ–¹æ³•æŒ‡å®š @Override public void onClick(View v) { // startActivity(new Intent(this, ActFinishActivity.class)); // Intent intent = new Intent(); // intent.setClass(this, ActFinishActivity.class) // startActivity(intent); Intent intent = new Intent(); ComponentName componentName = new ComponentName(this, ActFinishActivity.class); intent.setComponent(componentName); Log.d(TAG, \u0026#34;ActStartActivity onClick\u0026#34;); } éšå¼Intent æ²¡æœ‰æ˜ç¡®æŒ‡å®šè¦è·³è½¬çš„ç›®æ ‡æ´»åŠ¨ï¼Œåªç»™å‡ºä¸€ä¸ªåŠ¨ä½œå­—ç¬¦ä¸²è®©ç³»ç»Ÿè‡ªåŠ¨åŒ¹é…ã€‚å±äºæ¨¡ç³ŠåŒ¹é…ã€‚åŠ¨ä½œåç§°æ—¢å¯ä»¥é€šè¿‡setActionæ–¹æ³•æŒ‡å®šï¼Œä¹Ÿå¯ä»¥é€šè¿‡æ„é€ å‡½æ•°Intent(String action)ç›´æ¥ç”Ÿæˆæ„å›¾å¯¹è±¡ã€‚å¸¸ç”¨çš„ç³»ç»ŸåŠ¨ä½œå¦‚ä¸‹è¡¨ï¼š\nAndroidManifest.xml æŒ‡å®šä¸€ä¸ªéœ€è¦è‡ªå®šä¹‰è·³è½¬çš„View, å°†\u0026lt;action\u0026gt; å’Œ \u0026lt;category\u0026gt;ä¸¤ä¸ªæ ‡ç­¾åˆ†åˆ«ä¿®æ”¹ä¸ºï¼Œè‡ªå®šä¹‰åŒ…åï¼Œä»¥åŠandroid.intent.category.DEFAULT\n\u0026lt;activity android:name=\u0026#34;.LoginInputActivity\u0026#34; android:exported=\u0026#34;true\u0026#34;\u0026gt; \u0026lt;intent-filter\u0026gt; \u0026lt;action android:name=\u0026#34;android.intent.action.kennem\u0026#34; /\u0026gt; \u0026lt;category android:name=\u0026#34;android.intent.category.DEFAULT\u0026#34; /\u0026gt; \u0026lt;/intent-filter\u0026gt; \u0026lt;/activity\u0026gt; XML \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;LinearLayout xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34; android:id=\u0026#34;@+id/main\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34; android:orientation=\u0026#34;vertical\u0026#34;\u0026gt; \u0026lt;TextView android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:padding=\u0026#34;5dp\u0026#34; android:text=\u0026#34;ç‚¹å‡»ä»¥ä¸‹æŒ‰é’®å¯¹å·ç 123321å‘èµ·è¯·æ±‚\u0026#34;/\u0026gt; \u0026lt;Button android:id=\u0026#34;@+id/btn_dial\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:text=\u0026#34;è·³è½¬åˆ°æ‹¨å·é¡µé¢\u0026#34;/\u0026gt; \u0026lt;Button android:id=\u0026#34;@+id/btn_sms\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:text=\u0026#34;è·³è½¬åˆ°å‘çŸ­ä¿¡é¡µé¢\u0026#34;/\u0026gt; \u0026lt;Button android:id=\u0026#34;@+id/btn_my\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:text=\u0026#34;è·³è½¬åˆ°æˆ‘çš„é¡µé¢\u0026#34;/\u0026gt; \u0026lt;/LinearLayout\u0026gt; Java // å®šä¹‰ä¸€ä¸ªåä¸º ActUriActivity çš„ Activity ç±»ï¼Œç»§æ‰¿è‡ª AppCompatActivity å¹¶å®ç° View.OnClickListener æ¥å£ public class ActUriActivity extends AppCompatActivity implements View.OnClickListener { @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); // è®¾ç½® Activity çš„å¸ƒå±€æ–‡ä»¶ setContentView(R.layout.activity_act_uri); // ä¸ºä¸‰ä¸ªæŒ‰é’®è®¾ç½®ç‚¹å‡»ç›‘å¬å™¨ findViewById(R.id.btn_dial).setOnClickListener(this); findViewById(R.id.btn_sms).setOnClickListener(this); findViewById(R.id.btn_my).setOnClickListener(this); } @Override public void onClick(View v) { // åˆ›å»ºä¸€ä¸ª Intent å¯¹è±¡ï¼Œç”¨äºå¯åŠ¨å…¶ä»– Activity Intent intent = new Intent(); // å®šä¹‰ä¸€ä¸ªç”µè¯å·ç å­—ç¬¦ä¸² String phoneNum = \u0026#34;123654789\u0026#34;; // æ ¹æ®ç‚¹å‡»çš„æŒ‰é’® ID æ‰§è¡Œç›¸åº”çš„æ“ä½œ if (v.getId() == R.id.btn_dial) { // è®¾ç½® Intent çš„ Action ä¸ºæ‹¨å· intent.setAction(Intent.ACTION_DIAL); // åˆ›å»ºä¸€ä¸ª Uri å¯¹è±¡ï¼Œè¡¨ç¤ºç”µè¯å·ç  Uri uri = Uri.parse(\u0026#34;tel:\u0026#34; + phoneNum); // å°† Uri æ•°æ®è®¾ç½®åˆ° Intent ä¸­ intent.setData(uri); // å¯åŠ¨æ‹¨å·ç•Œé¢ startActivity(intent); } else if (v.getId() == R.id.btn_sms) { // è®¾ç½® Intent çš„ Action ä¸ºå‘é€çŸ­ä¿¡ intent.setAction(Intent.ACTION_SENDTO); // åˆ›å»ºä¸€ä¸ª Uri å¯¹è±¡ï¼Œè¡¨ç¤ºçŸ­ä¿¡å·ç  Uri uri2 = Uri.parse(\u0026#34;smsto:\u0026#34; + phoneNum); // å°† Uri æ•°æ®è®¾ç½®åˆ° Intent ä¸­ intent.setData(uri2); // å¯åŠ¨çŸ­ä¿¡ç•Œé¢ startActivity(intent); } else if (v.getId() == R.id.btn_my) { // è®¾ç½® Intent çš„ Action ä¸ºè‡ªå®šä¹‰ Action intent.setAction(\u0026#34;android.intent.action.kennem\u0026#34;); // æ·»åŠ é»˜è®¤ç±»åˆ« intent.addCategory(Intent.CATEGORY_DEFAULT); // å¯åŠ¨è‡ªå®šä¹‰çš„ Activity startActivity(intent); } } } å‘ä¸‹ä¸€ä¸ªActivityå‘é€æ•°æ®\nIntentä½¿ç”¨Bundleå¯¹è±¡å­˜æ”¾å¾…ä¼ é€’çš„æ•°æ®ä¿¡æ¯ã€‚ Bundleå¯¹è±¡æ“ä½œå„ç§ç±»å‹æ•°æ®çš„è¯»å†™æ–¹æ³•è¯´æ˜ï¼š å‘ä¸‹ä¸€ä¸ªActivityå‘é€æ•°æ® XML send.xml \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;LinearLayout xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34; android:id=\u0026#34;@+id/main\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34; android:orientation=\u0026#34;vertical\u0026#34;\u0026gt; \u0026lt;TextView android:id=\u0026#34;@+id/tv_send\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:text=\u0026#34;åšæŒä¸‹å»\u0026#34; android:textSize=\u0026#34;20sp\u0026#34;/\u0026gt; \u0026lt;Button android:id=\u0026#34;@+id/btn_send\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:gravity=\u0026#34;center\u0026#34; android:text=\u0026#34;å‘é€ä»¥ä¸Šçš„æ–‡å­—\u0026#34; /\u0026gt; \u0026lt;/LinearLayout\u0026gt; receive.xml \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;LinearLayout xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34; android:id=\u0026#34;@+id/main\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34; android:orientation=\u0026#34;vertical\u0026#34;\u0026gt; \u0026lt;TextView android:id=\u0026#34;@+id/tv_receive\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:text=\u0026#34;åšæŒä¸‹å»\u0026#34; android:textSize=\u0026#34;20sp\u0026#34;/\u0026gt; \u0026lt;/LinearLayout\u0026gt; Java ActSentActivity.java package com.showguan.chapter04; public class ActSentActivity extends AppCompatActivity implements View.OnClickListener { private TextView tv_send; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_act_sent); tv_send = findViewById(R.id.tv_send); findViewById(R.id.btn_send).setOnClickListener(this); } @Override public void onClick(View v) { Intent intent = new Intent(this, ActReceiveActivity.class); Bundle bundle = new Bundle(); bundle.putString(\u0026#34;request_time\u0026#34;, DateUtil.getNowTime()); bundle.putString(\u0026#34;request_content\u0026#34;, tv_send.getText().toString()); intent.putExtras(bundle); startActivity(intent); } } ActReceiveActivity.java package com.showguan.chapter04; public class ActReceiveActivity extends AppCompatActivity { private TextView tv_send; private TextView tv_receive; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_act_receive); tv_receive = findViewById(R.id.tv_receive); Bundle bundle = getIntent().getExtras(); String request_time = bundle.getString(\u0026#34;request_time\u0026#34;); String request_content = bundle.getString(\u0026#34;request_content\u0026#34;); String desc = String.format(\u0026#34;æˆåŠŸæ”¶åˆ°æ¶ˆæ¯ï¼Œæ”¶åˆ°æ—¶é—´ä¸º%s, æ”¶åˆ°å†…å®¹ä¸º%s\u0026#34;, request_time, request_content); tv_receive.setText(desc); } } å‘ä¸Šä¸€ä¸ªActivityè¿”å›æ•°æ® XML request.xml \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;LinearLayout xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34; android:id=\u0026#34;@+id/main\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34; android:orientation=\u0026#34;vertical\u0026#34;\u0026gt; \u0026lt;TextView android:id=\u0026#34;@+id/tv_request\u0026#34; android:layout_margin=\u0026#34;30dp\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:textSize=\u0026#34;15sp\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; /\u0026gt; \u0026lt;Button android:id=\u0026#34;@+id/btn_request\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:layout_margin=\u0026#34;30dp\u0026#34; android:gravity=\u0026#34;center\u0026#34; android:text=\u0026#34;è¯·æ±‚ä¼ é€æ•°æ®\u0026#34; /\u0026gt; \u0026lt;TextView android:id=\u0026#34;@+id/tv_response\u0026#34; android:layout_margin=\u0026#34;30dp\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34;/\u0026gt; \u0026lt;/LinearLayout\u0026gt; response.xml \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;LinearLayout xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34; xmlns:app=\u0026#34;http://schemas.android.com/apk/res-auto\u0026#34; xmlns:tools=\u0026#34;http://schemas.android.com/tools\u0026#34; android:id=\u0026#34;@+id/main\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34; android:orientation=\u0026#34;vertical\u0026#34;\u0026gt; \u0026lt;TextView android:id=\u0026#34;@+id/tv_request\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; /\u0026gt; \u0026lt;Button android:id=\u0026#34;@+id/btn_response\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:gravity=\u0026#34;center\u0026#34; android:text=\u0026#34;è¯·æ±‚ä¼ é€æ•°æ®\u0026#34; /\u0026gt; \u0026lt;TextView android:id=\u0026#34;@+id/tv_response\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34;/\u0026gt; \u0026lt;/LinearLayout\u0026gt; Java ActRequestActivity.java package com.showguan.chapter04; public class ActRequestActivity extends AppCompatActivity implements View.OnClickListener { // è¦å‘é€çš„è¯·æ±‚å†…å®¹ private final String mRequest = \u0026#34;ä»Šå¤©æ˜¯2024/06/18ï¼Œ åšæŒå°±æ˜¯èƒœåˆ©ï¼Œæ•ˆç‡å°±æ˜¯ç‹è€…\u0026#34;; // ç”¨äºå¯åŠ¨æ´»åŠ¨å¹¶æ¥æ”¶ç»“æœçš„å¯åŠ¨å™¨ private ActivityResultLauncher\u0026lt;Intent\u0026gt; register; // æ˜¾ç¤ºå“åº”å†…å®¹çš„TextView private TextView tv_response; // æ˜¾ç¤ºè¯·æ±‚å†…å®¹çš„TextView private TextView tv_request; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); // è®¾ç½®æ´»åŠ¨çš„å¸ƒå±€ setContentView(R.layout.activity_act_request); // ç»‘å®šæ˜¾ç¤ºè¯·æ±‚å†…å®¹çš„TextView tv_request = findViewById(R.id.tv_request); // ç»‘å®šæ˜¾ç¤ºå“åº”å†…å®¹çš„TextView tv_response = findViewById(R.id.tv_response); // è®¾ç½®å¾…å‘é€çš„æ–‡æœ¬å†…å®¹ tv_request.setText(\u0026#34;å¾…å‘é€çš„æ–‡æœ¬ï¼š\u0026#34; + mRequest); // ç»‘å®šæŒ‰é’®ç‚¹å‡»äº‹ä»¶ findViewById(R.id.btn_request).setOnClickListener(this); // æ³¨å†Œä¸€ä¸ªç”¨äºå¯åŠ¨æ´»åŠ¨å¹¶æ¥æ”¶ç»“æœçš„å¯åŠ¨å™¨ register = registerForActivityResult(new ActivityResultContracts.StartActivityForResult(), result -\u0026gt; { if (result != null) { // è·å–è¿”å›çš„Intent Intent intent = result.getData(); if (intent != null \u0026amp;\u0026amp; result.getResultCode() == Activity.RESULT_OK) { // è·å–Intentä¸­çš„æ•°æ® Bundle bundle = intent.getExtras(); String request_time = bundle.getString(\u0026#34;response_time\u0026#34;); String request_content = bundle.getString(\u0026#34;response_content\u0026#34;); // æ ¼å¼åŒ–æ˜¾ç¤ºå“åº”æ¶ˆæ¯ String desc = String.format(\u0026#34;æ”¶åˆ°åº”ç­”æ¶ˆæ¯ï¼Œåº”ç­”æ—¶é—´ä¸º%s, åº”ç­”å†…å®¹ä¸º%s\u0026#34;, request_time, request_content); tv_response.setText(desc); } } }); } @Override public void onClick(View v) { // åˆ›å»ºä¸€ä¸ªå¯åŠ¨ActResponseActivityçš„Intent Intent intent = new Intent(this, ActResponseActivity.class); // åˆ›å»ºä¸€ä¸ªBundleç”¨äºä¼ é€’è¯·æ±‚æ•°æ® Bundle bundle = new Bundle(); // å°†å½“å‰æ—¶é—´å’Œè¯·æ±‚å†…å®¹æ”¾å…¥Bundle bundle.putString(\u0026#34;request_time\u0026#34;, DateUtil.getNowTime()); bundle.putString(\u0026#34;request_content\u0026#34;, mRequest); // å°†Bundleæ”¾å…¥Intent intent.putExtras(bundle); // å¯åŠ¨æ´»åŠ¨å¹¶ç­‰å¾…ç»“æœ register.launch(intent); } } ActResponseActivity.java package com.showguan.chapter04; public class ActResponseActivity extends AppCompatActivity implements View.OnClickListener { // é™æ€å¸¸é‡ï¼Œè¡¨ç¤ºå“åº”çš„å†…å®¹ private static final String mResponse = \u0026#34;æˆ‘â„¢ä¸€å®šèƒ½è¿›å°ç±³\u0026#34;; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); // è®¾ç½®æ´»åŠ¨çš„å¸ƒå±€ setContentView(R.layout.activity_act_response); // ç»‘å®šæ˜¾ç¤ºè¯·æ±‚å†…å®¹çš„TextView TextView tv_request = findViewById(R.id.tv_request); // è·å–å¯åŠ¨æ­¤æ´»åŠ¨æ—¶ä¼ é€’çš„Intentä¸­çš„Extras Bundle bundle = getIntent().getExtras(); // ä»Extrasä¸­è·å–è¯·æ±‚çš„æ—¶é—´å’Œå†…å®¹ String request_time = bundle.getString(\u0026#34;request_time\u0026#34;); String request_content = bundle.getString(\u0026#34;request_content\u0026#34;); // æ ¼å¼åŒ–æ˜¾ç¤ºæ¥æ”¶åˆ°çš„è¯·æ±‚æ¶ˆæ¯ String desc = String.format(\u0026#34;æˆåŠŸæ”¶åˆ°æ¶ˆæ¯ï¼Œæ”¶åˆ°æ—¶é—´ä¸º%s, æ”¶åˆ°å†…å®¹ä¸º%s\u0026#34;, request_time, request_content); tv_request.setText(desc); // ç»‘å®šå“åº”æŒ‰é’®çš„ç‚¹å‡»äº‹ä»¶ findViewById(R.id.btn_response).setOnClickListener(this); // ç»‘å®šæ˜¾ç¤ºå“åº”å†…å®¹çš„TextView TextView tv_response = findViewById(R.id.tv_response); // è®¾ç½®å¾…è¿”å›çš„å“åº”å†…å®¹ tv_response.setText(\u0026#34;å¾…è¿”å›çš„å†…å®¹ï¼š\u0026#34; + mResponse); } @Override public void onClick(View v) { // åˆ›å»ºä¸€ä¸ªè¿”å›ç»™ActRequestActivityçš„Intent Intent intent = new Intent(this, ActRequestActivity.class); // åˆ›å»ºä¸€ä¸ªBundleç”¨äºä¼ é€’å“åº”æ•°æ® Bundle bundle = new Bundle(); // å°†å½“å‰æ—¶é—´å’Œå“åº”å†…å®¹æ”¾å…¥Bundle bundle.putString(\u0026#34;response_time\u0026#34;, DateUtil.getNowTime()); bundle.putString(\u0026#34;response_content\u0026#34;, \u0026#34;åº”ç­”å†…å®¹ï¼š\u0026#34; + mResponse); // å°†Bundleæ”¾å…¥Intent intent.putExtras(bundle); // è®¾ç½®ç»“æœç å’Œè¿”å›çš„Intent setResult(Activity.RESULT_OK, intent); // ç»“æŸå½“å‰æ´»åŠ¨ finish(); } } ä¸ºæ´»åŠ¨è¡¥å……é™„åŠ ä¿¡æ¯ å°†stringä¿¡æ¯å®šä¹‰åœ¨strings.xml\n\u0026lt;resources\u0026gt; \u0026lt;string name=\u0026#34;app_name\u0026#34;\u0026gt;chapter04\u0026lt;/string\u0026gt; \u0026lt;string name=\u0026#34;weather_info\u0026#34;\u0026gt;ä»Šå¤©æ˜¯ä¸ªç³Ÿç³•çš„ä¸€å¤©\u0026lt;/string\u0026gt; \u0026lt;/resources\u0026gt; javaä»£ç ä¸­å¼•ç”¨å³å¯ï¼š\nTextView tv_resource = findViewById(R.id.tv_resource); String value = getString(R.string.weather_info); tv_resource.setText(value); åœ¨ä»£ç ä¸­è·å–å…ƒæ•°æ® åœ¨AndroidManifest.xmlæ–‡ä»¶ä¸­æŒ‡å®šmetadata \u0026lt;activity android:name=\u0026#34;.ActStartActivity\u0026#34; android:exported=\u0026#34;true\u0026#34; android:launchMode=\u0026#34;standard\u0026#34;\u0026gt; \u0026lt;intent-filter\u0026gt; \u0026lt;action android:name=\u0026#34;android.intent.action.MAIN\u0026#34; /\u0026gt; \u0026lt;category android:name=\u0026#34;android.intent.category.LAUNCHER\u0026#34; /\u0026gt; \u0026lt;/intent-filter\u0026gt; \u0026lt;meta-data android:name=\u0026#34;android.app.shortcuts\u0026#34; android:resource=\u0026#34;@xml/shortcuts\u0026#34; /\u0026gt; \u0026lt;/activity\u0026gt; ç¼–å†™shortcuts.xmlï¼Œ æŒ‡å®šæ˜¾ç¤ºçš„åç§°å’Œè¦è·³è½¬çš„é¡µé¢ \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;shortcuts xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34;\u0026gt; \u0026lt;shortcut android:enabled=\u0026#34;true\u0026#34; android:icon=\u0026#34;@mipmap/ic_launcher\u0026#34; android:shortcutId=\u0026#34;first\u0026#34; android:shortcutLongLabel=\u0026#34;@string/first_long\u0026#34; android:shortcutShortLabel=\u0026#34;@string/first_short\u0026#34;\u0026gt; \u0026lt;intent android:action=\u0026#34;android.intent.action.VIEW\u0026#34; android:targetClass=\u0026#34;com.showguan.chapter04.ActStartActivity\u0026#34; android:targetPackage=\u0026#34;com.showguan.chapter04\u0026#34;\u0026gt; \u0026lt;categories android:name=\u0026#34;android.shortcut.conversation\u0026#34; /\u0026gt; \u0026lt;/intent\u0026gt; \u0026lt;/shortcut\u0026gt; \u0026lt;shortcut android:enabled=\u0026#34;true\u0026#34; android:icon=\u0026#34;@mipmap/ic_launcher\u0026#34; android:shortcutId=\u0026#34;second\u0026#34; android:shortcutLongLabel=\u0026#34;@string/second_long\u0026#34; android:shortcutShortLabel=\u0026#34;@string/second_short\u0026#34;\u0026gt; \u0026lt;intent android:action=\u0026#34;android.intent.action.VIEW\u0026#34; android:targetClass=\u0026#34;com.showguan.chapter04.JumpFirstActivity\u0026#34; android:targetPackage=\u0026#34;com.showguan.chapter04\u0026#34;\u0026gt; \u0026lt;categories android:name=\u0026#34;android.shortcut.conversation\u0026#34; /\u0026gt; \u0026lt;/intent\u0026gt; \u0026lt;/shortcut\u0026gt; \u0026lt;shortcut android:enabled=\u0026#34;true\u0026#34; android:icon=\u0026#34;@mipmap/ic_launcher\u0026#34; android:shortcutId=\u0026#34;third\u0026#34; android:shortcutLongLabel=\u0026#34;@string/third_long\u0026#34; android:shortcutShortLabel=\u0026#34;@string/third_short\u0026#34;\u0026gt; \u0026lt;intent android:action=\u0026#34;android.intent.action.VIEW\u0026#34; android:targetClass=\u0026#34;com.showguan.chapter04.LoginInputActivity\u0026#34; android:targetPackage=\u0026#34;com.showguan.chapter04\u0026#34;\u0026gt; \u0026lt;categories android:name=\u0026#34;android.shortcut.conversation\u0026#34; /\u0026gt; \u0026lt;/intent\u0026gt; \u0026lt;/shortcut\u0026gt; \u0026lt;/shortcuts\u0026gt; æ³¨æ„åç§°éœ€è¦å­˜å‚¨åœ¨strings.xmlä¸­\nAndroidManifest.xmlä¸­éœ€è¦è·³è½¬çš„é¡µé¢exportedå±æ€§è¦è®¾ç½®ä¸ºtrue ä¸­çº§æ§ä»¶ å›¾å½¢Drawable Drawableç±»å‹è¡¨è¾¾äº†å„ç§å„æ ·çš„å›¾å½¢ï¼ŒåŒ…æ‹¬å›¾ç‰‡ï¼Œè‰²å—ï¼Œç”»æ¿ï¼Œ èƒŒæ™¯ç­‰\nåŒ…å«å›¾ç‰‡åœ¨å†…çš„å›¾å½¢æ–‡ä»¶æ”¾åœ¨resç›®å½•çš„å„ä¸ªdrawableç›®å½•ä¸‹ï¼Œå…¶ä¸­drawableç›®å½•ä¸€èˆ¬ä¿å­˜æè¿°æ€§çš„XMLæ–‡ä»¶ï¼Œè€Œå›¾ç‰‡æ–‡ä»¶ä¸€èˆ¬æ”¾åœ¨å…·ä½“åˆ†è¾¨ç‡çš„drawableç›®å½•ä¸‹ã€‚\ndrawable-ldpi, drawable-mdpi, drawable-hdpi, drawable-xhdpi,drawable-xxhdpiï¼Œ drawable-xxhdpiè¡¨ç¤ºä½åˆ†è¾¨ç‡ï¼Œä¸­ç­‰åˆ†è¾¨ç‡ï¼Œé«˜åˆ†è¾¨ç‡ï¼Œè¶…é«˜åˆ†è¾¨ç‡ï¼Œ è¶…è¶…é«˜åˆ†è¾¨ç‡ å„è§†å›¾çš„backgroundå±æ€§ï¼ŒImageViewå’ŒImageButtonçš„srcå±æ€§ï¼ŒTextViewå’ŒButtonå››ä¸ªæ–¹å‘çš„drawableç³»åˆ—å±æ€§éƒ½å¯ä»¥å¼•ç”¨å›¾å½¢æ–‡ä»¶ã€‚\nå½¢çŠ¶å›¾å½¢ shapeå›¾å½¢åˆç§°å½¢çŠ¶å›¾å½¢ï¼Œå®ƒç”¨æ¥æè¿°å¸¸è§çš„å‡ ä½•å½¢çŠ¶ï¼ŒåŒ…æ‹¬çŸ©å½¢ï¼Œåœ†è§’çŸ©å½¢ï¼Œåœ†å½¢ï¼Œæ¤­åœ†ç­‰ã€‚ å½¢çŠ¶å›¾å½¢ drawableä¸­xml \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;shape xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34; android:shape=\u0026#34;oval\u0026#34;\u0026gt; \u0026lt;solid android:color=\u0026#34;#ff66aa\u0026#34;/\u0026gt; \u0026lt;stroke android:width=\u0026#34;1dp\u0026#34; android:color=\u0026#34;#aaaaaa\u0026#34;/\u0026gt; \u0026lt;/shape\u0026gt; \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;shape xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34;\u0026gt; \u0026lt;!-- å¡«å……é¢œè‰²--\u0026gt; \u0026lt;solid android:color=\u0026#34;#ffdd66\u0026#34; /\u0026gt; \u0026lt;!-- è½®å»“ç²—ç»†ä¸é¢œè‰²--\u0026gt; \u0026lt;stroke android:width=\u0026#34;1dp\u0026#34; android:color=\u0026#34;#aaaaaa\u0026#34; /\u0026gt; \u0026lt;!-- å½¢çŠ¶å››ä¸ªåœ†è§’çš„åŠå¾„--\u0026gt; \u0026lt;corners android:radius=\u0026#34;10dp\u0026#34; /\u0026gt; \u0026lt;/shape\u0026gt; activity_draw_shape.xml \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;LinearLayout xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34; android:id=\u0026#34;@+id/main\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34; android:orientation=\u0026#34;vertical\u0026#34;\u0026gt; \u0026lt;View android:id=\u0026#34;@+id/v_content\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;200dp\u0026#34; android:layout_margin=\u0026#34;10dp\u0026#34;/\u0026gt; \u0026lt;LinearLayout android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:orientation=\u0026#34;horizontal\u0026#34;\u0026gt; \u0026lt;Button android:id=\u0026#34;@+id/btn_rect\u0026#34; android:layout_width=\u0026#34;0dp\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:layout_weight=\u0026#34;1\u0026#34; android:text=\u0026#34;åœ†è§’çŸ©å½¢æŒ‰é’®\u0026#34;/\u0026gt; \u0026lt;Button android:id=\u0026#34;@+id/btn_oval\u0026#34; android:layout_width=\u0026#34;0dp\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:layout_weight=\u0026#34;1\u0026#34; android:text=\u0026#34;æ¤­åœ†æŒ‰é’®\u0026#34;/\u0026gt; \u0026lt;/LinearLayout\u0026gt; \u0026lt;/LinearLayout\u0026gt; Java package com.showguan.chapter05; public class DrawShapeActivity extends AppCompatActivity implements View.OnClickListener { private View v_content; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_draw_shape); v_content = findViewById(R.id.v_content); findViewById(R.id.btn_rect).setOnClickListener(this); findViewById(R.id.btn_oval).setOnClickListener(this); v_content.setBackgroundResource(R.drawable.shape_rect_gold); } @Override public void onClick(View v) { if(v.getId() == R.id.btn_rect){ v_content.setBackgroundResource(R.drawable.shape_rect_gold); }else if (v.getId()==R.id.btn_oval){ v_content.setBackgroundResource(R.drawable.shape_oval_rose); } } } ä¹å®«æ ¼å›¾ç‰‡ å°†æŸå¼ å›¾ç‰‡è®¾ç½®ä¸ºè§†å›¾èƒŒæ™¯æ—¶ï¼Œå¦‚æœå›¾ç‰‡å°ºå¯¸å¤ªå°ï¼Œåˆ™ç³»ç»Ÿä¼šè‡ªåŠ¨æ‹‰ä¼¸å›¾ç‰‡ä½¿ä¹‹å¡«æ»¡èƒŒæ™¯ å¯æ˜¯ä¸€æ—¦å›¾ç‰‡æ‹‰å¾—è¿‡å¤§ï¼Œå…¶ç”»é¢å®¹æ˜“å˜å¾—æ¨¡ç³Š åˆ›å»º.9æ–‡ä»¶ çŠ¶æ€åˆ—è¡¨å›¾å½¢ btn_nice_selector.xml \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;selector xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34;\u0026gt; \u0026lt;item android:state_pressed=\u0026#34;true\u0026#34; android:drawable=\u0026#34;@drawable/button_pressed\u0026#34; /\u0026gt; \u0026lt;item android:drawable=\u0026#34;@drawable/button_normal\u0026#34; /\u0026gt; \u0026lt;/selector\u0026gt; å¤é€‰æ¡†checkbox xml \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;LinearLayout xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34; android:id=\u0026#34;@+id/main\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34; android:orientation=\u0026#34;vertical\u0026#34;\u0026gt; \u0026lt;CheckBox android:id=\u0026#34;@+id/ck_system\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:layout_marginTop=\u0026#34;5dp\u0026#34; android:text=\u0026#34;ç³»ç»Ÿçš„checkbox\u0026#34;/\u0026gt; \u0026lt;CheckBox android:id=\u0026#34;@+id/ck_custom\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:button=\u0026#34;@drawable/checkbox_selector\u0026#34; android:layout_marginTop=\u0026#34;10dp\u0026#34; android:checked=\u0026#34;true\u0026#34; android:text=\u0026#34;ç³»ç»Ÿçš„checkbox\u0026#34;/\u0026gt; \u0026lt;/LinearLayout\u0026gt; Java package com.showguan.chapter05; import android.os.Bundle; import android.view.View; import android.widget.CheckBox; import android.widget.CompoundButton; import androidx.activity.EdgeToEdge; import androidx.appcompat.app.AppCompatActivity; import androidx.core.graphics.Insets; import androidx.core.view.ViewCompat; import androidx.core.view.WindowInsetsCompat; public class CheckBoxActivity extends AppCompatActivity implements CompoundButton.OnCheckedChangeListener { @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_check_box); CheckBox ck_system = findViewById(R.id.ck_system); CheckBox ck_custom = findViewById(R.id.ck_custom); ck_system.setOnCheckedChangeListener(this); ck_custom.setOnCheckedChangeListener(this); } @Override public void onCheckedChanged(CompoundButton buttonView, boolean isChecked) { String desc = String.format(\u0026#34;æ‚¨%sæ­¤æŒ‰é’®ã€‚\u0026#34; , isChecked ? \u0026#34;å‹¾é€‰äº†\u0026#34; : \u0026#34;å–æ¶ˆå‹¾é€‰äº†\u0026#34;); buttonView.setText(desc); } } å¼€å…³Switch xml \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;LinearLayout xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34; android:id=\u0026#34;@+id/main\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34; android:orientation=\u0026#34;vertical\u0026#34;\u0026gt; \u0026lt;LinearLayout android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:orientation=\u0026#34;horizontal\u0026#34;\u0026gt; \u0026lt;TextView android:layout_width=\u0026#34;0dp\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:layout_gravity=\u0026#34;start\u0026#34; android:layout_marginTop=\u0026#34;5dp\u0026#34; android:layout_weight=\u0026#34;1\u0026#34; android:text=\u0026#34;å¼€å…³\u0026#34; android:textSize=\u0026#34;17sp\u0026#34; /\u0026gt; \u0026lt;Switch android:id=\u0026#34;@+id/sw_status\u0026#34; android:layout_width=\u0026#34;wrap_content\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:layout_gravity=\u0026#34;end\u0026#34; android:width=\u0026#34;80dp\u0026#34; android:height=\u0026#34;30dp\u0026#34; android:padding=\u0026#34;5dp\u0026#34; /\u0026gt; \u0026lt;/LinearLayout\u0026gt; \u0026lt;TextView android:id=\u0026#34;@+id/tv_result\u0026#34; android:layout_width=\u0026#34;0dp\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:layout_gravity=\u0026#34;start\u0026#34; android:layout_marginTop=\u0026#34;10dp\u0026#34; android:layout_weight=\u0026#34;1\u0026#34; android:gravity=\u0026#34;start\u0026#34; /\u0026gt; \u0026lt;/LinearLayout\u0026gt; Java package com.showguan.chapter05; public class SwitchActivity extends AppCompatActivity implements CompoundButton.OnCheckedChangeListener { private TextView tv_result; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_switch); Switch sw_status = findViewById(R.id.sw_status); tv_result = findViewById(R.id.tv_result); sw_status.setOnCheckedChangeListener(this); } @Override public void onCheckedChanged(CompoundButton buttonView, boolean isChecked) { String desc = String.format(\u0026#34;SwitchæŒ‰é’®çš„çŠ¶æ€æ˜¯%s\u0026#34;, isChecked ? \u0026#34;å¼€\u0026#34; : \u0026#34;å…³\u0026#34;); tv_result.setText(desc); } } ç”¨checkboxå®ç°switch xml \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;LinearLayout xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34; android:id=\u0026#34;@+id/main\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34; android:orientation=\u0026#34;vertical\u0026#34;\u0026gt; \u0026lt;LinearLayout android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:orientation=\u0026#34;horizontal\u0026#34;\u0026gt; \u0026lt;TextView android:layout_width=\u0026#34;0dp\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:layout_gravity=\u0026#34;start\u0026#34; android:layout_marginTop=\u0026#34;5dp\u0026#34; android:layout_weight=\u0026#34;1\u0026#34; android:text=\u0026#34;å¼€å…³\u0026#34; android:textSize=\u0026#34;17sp\u0026#34; /\u0026gt; \u0026lt;CheckBox android:id=\u0026#34;@+id/ck_status\u0026#34; android:layout_width=\u0026#34;60dp\u0026#34; android:layout_height=\u0026#34;30dp\u0026#34; android:layout_gravity=\u0026#34;end\u0026#34; android:width=\u0026#34;80dp\u0026#34; android:height=\u0026#34;30dp\u0026#34; android:background=\u0026#34;@drawable/switch_selector\u0026#34; android:button=\u0026#34;@null\u0026#34; /\u0026gt; \u0026lt;/LinearLayout\u0026gt; \u0026lt;TextView android:id=\u0026#34;@+id/tv_result\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:layout_gravity=\u0026#34;start\u0026#34; android:layout_marginTop=\u0026#34;10dp\u0026#34; android:gravity=\u0026#34;start\u0026#34; /\u0026gt; \u0026lt;/LinearLayout\u0026gt; Java package com.showguan.chapter05; public class SwitchIOSActivity extends AppCompatActivity implements CompoundButton.OnCheckedChangeListener { private TextView tv_result; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_switch_iosactivity); CheckBox ck_status = findViewById(R.id.ck_status); tv_result = findViewById(R.id.tv_result); ck_status.setOnCheckedChangeListener(this); } @Override public void onCheckedChanged(CompoundButton buttonView, boolean isChecked) { String desc = String.format(\u0026#34;å¼€å…³æŒ‰é’®çš„çŠ¶æ€æ˜¯%s\u0026#34;, isChecked ? \u0026#34;å¼€\u0026#34; : \u0026#34;å…³\u0026#34;); tv_result.setText(desc); } } å•é€‰æŒ‰é’®RadioButton XML \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;LinearLayout xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34; android:id=\u0026#34;@+id/main\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34; android:orientation=\u0026#34;vertical\u0026#34;\u0026gt; \u0026lt;TextView android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:layout_gravity=\u0026#34;start\u0026#34; android:layout_marginTop=\u0026#34;5dp\u0026#34; android:text=\u0026#34;è¯·é€‰æ‹©ä½ çš„æ€§åˆ«\u0026#34; android:textSize=\u0026#34;17sp\u0026#34; /\u0026gt; \u0026lt;RadioGroup android:id=\u0026#34;@+id/rg_gender\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:orientation=\u0026#34;horizontal\u0026#34;\u0026gt; \u0026lt;RadioButton android:id=\u0026#34;@+id/rb_male\u0026#34; android:layout_width=\u0026#34;0dp\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:layout_weight=\u0026#34;1\u0026#34; android:text=\u0026#34;ç”·\u0026#34; /\u0026gt; \u0026lt;RadioButton android:id=\u0026#34;@+id/rb_female\u0026#34; android:layout_width=\u0026#34;0dp\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:layout_weight=\u0026#34;1\u0026#34; android:text=\u0026#34;å¥³\u0026#34; /\u0026gt; \u0026lt;/RadioGroup\u0026gt; \u0026lt;TextView android:id=\u0026#34;@+id/tv_result\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:layout_marginTop=\u0026#34;10dp\u0026#34; android:textSize=\u0026#34;17sp\u0026#34; /\u0026gt; \u0026lt;/LinearLayout\u0026gt; Java package com.showguan.chapter05; public class RadioHorizontalActivity extends AppCompatActivity implements RadioGroup.OnCheckedChangeListener { private TextView tv_result; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_radio_horizontal); RadioGroup rg_gender = findViewById(R.id.rg_gender); rg_gender.setOnCheckedChangeListener(this); tv_result = findViewById(R.id.tv_result); } @Override public void onCheckedChanged(RadioGroup group, int checkedId) { if(checkedId == R.id.rb_male){ tv_result.setText(\u0026#34;ä½ æ˜¯ä¸ªå¸…æ°”çš„ç”·å­©\u0026#34;); } else if (checkedId==R.id.rb_female) { tv_result.setText(\u0026#34;ä½ æ˜¯ä¸ªæ¼‚äº®çš„å¥³å­©\u0026#34;); } } } EditTextè®¾ç½®å¤–æ¡† XML \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;LinearLayout xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34; android:id=\u0026#34;@+id/main\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34; android:orientation=\u0026#34;vertical\u0026#34; android:padding=\u0026#34;5dp\u0026#34;\u0026gt; \u0026lt;EditText android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:hint=\u0026#34;è¿™é‡Œæ˜¯é»˜è®¤è¾¹æ¡†\u0026#34; android:inputType=\u0026#34;text\u0026#34;/\u0026gt; \u0026lt;EditText android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:hint=\u0026#34;è¿™é‡Œæ²¡æœ‰è¾¹æ¡†\u0026#34; android:inputType=\u0026#34;text\u0026#34; android:layout_marginTop=\u0026#34;5dp\u0026#34; android:background=\u0026#34;@null\u0026#34;/\u0026gt; \u0026lt;EditText android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:hint=\u0026#34;è¿™é‡Œæ˜¯åœ†è§’è¾¹æ¡†\u0026#34; android:inputType=\u0026#34;text\u0026#34; android:layout_marginTop=\u0026#34;5dp\u0026#34; android:background=\u0026#34;@drawable/edittext_selector\u0026#34; /\u0026gt; \u0026lt;/LinearLayout\u0026gt; Java public class EditBoardActivity extends AppCompatActivity { @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_edit_board); } } å¯¹è¯æç¤ºæ¡† XML \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;LinearLayout xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34; android:id=\u0026#34;@+id/main\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34; android:orientation=\u0026#34;vertical\u0026#34; android:padding=\u0026#34;5dp\u0026#34;\u0026gt; \u0026lt;Button android:id=\u0026#34;@+id/btn_alert\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:hint=\u0026#34;è¿™é‡Œæ²¡æœ‰è¾¹æ¡†\u0026#34; android:text=\u0026#34;ç‚¹å‡»å¼¹å‡ºæé†’å¯¹è¯æ¡†\u0026#34; android:layout_marginTop=\u0026#34;5dp\u0026#34; android:background=\u0026#34;@null\u0026#34;/\u0026gt; \u0026lt;TextView android:id=\u0026#34;@+id/tv_alert\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:layout_marginTop=\u0026#34;5dp\u0026#34; /\u0026gt; \u0026lt;/LinearLayout\u0026gt; Java package com.showguan.chapter05; import android.os.Bundle; import android.view.View; import android.widget.TextView; import androidx.appcompat.app.AlertDialog; import androidx.appcompat.app.AppCompatActivity; public class AlertDialogActivity extends AppCompatActivity implements View.OnClickListener { private TextView tv_alert; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_alert_dialog); findViewById(R.id.btn_alert).setOnClickListener(this); tv_alert = findViewById(R.id.tv_alert); } @Override public void onClick(View v) { AlertDialog.Builder builder = new AlertDialog.Builder(this); builder.setTitle(\u0026#34;å°Šæ•¬çš„ç”¨æˆ·æœ‹å‹\u0026#34;); builder.setMessage(\u0026#34;ä½ çœŸçš„ç¡®å®šæ²¡ç‚¹é”™å—ï¼Ÿ\u0026#34;); builder.setPositiveButton(\u0026#34;æ®‹å¿å¸è½½\u0026#34;, (dialog, which) -\u0026gt; { tv_alert.setText(\u0026#34;è™½ç„¶ä¾ä¾ä¸èˆï¼Œä½†æ˜¯å¸Œæœ›èƒ½å†è§é¢\u0026#34;); }); builder.setNegativeButton(\u0026#34;ç‚¹é”™äº†å“¦\u0026#34;, (dialog, which) -\u0026gt; { tv_alert.setText(\u0026#34;æˆ‘è¿˜è¦å†é™ªä½ 365*nä¸ªæ—¥å¤œ\u0026#34;); }); AlertDialog dialog = builder.create(); dialog.show(); } } æ–‡æœ¬æ¡†æç¤ºä¿¡æ¯ XML \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;LinearLayout xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34; android:id=\u0026#34;@+id/main\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34; android:orientation=\u0026#34;vertical\u0026#34; android:padding=\u0026#34;5dp\u0026#34;\u0026gt; \u0026lt;EditText android:id=\u0026#34;@+id/et_phone\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:hint=\u0026#34;è¯·è¾“å…¥11ä½æ‰‹æœºå·ç \u0026#34; android:inputType=\u0026#34;number\u0026#34; android:maxLength=\u0026#34;11\u0026#34; android:layout_marginTop=\u0026#34;15dp\u0026#34; android:background=\u0026#34;@drawable/edittext_selector\u0026#34;/\u0026gt; \u0026lt;EditText android:id=\u0026#34;@+id/et_password\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:hint=\u0026#34;è¯·è¾“å…¥6ä½å¯†ç \u0026#34; android:inputType=\u0026#34;numberPassword\u0026#34; android:maxLength=\u0026#34;11\u0026#34; android:layout_marginTop=\u0026#34;15dp\u0026#34; android:background=\u0026#34;@drawable/edittext_selector\u0026#34;/\u0026gt; \u0026lt;Button android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_marginTop=\u0026#34;15dp\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:text=\u0026#34;ç™»å½•\u0026#34;/\u0026gt; \u0026lt;/LinearLayout\u0026gt; Java package com.showguan.chapter05; public class EditFocusActivity extends AppCompatActivity implements View.OnFocusChangeListener { private EditText et_phone; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_edit_focus); et_phone = findViewById(R.id.et_phone); et_phone.setOnFocusChangeListener(this); } @Override public void onFocusChange(View v, boolean hasFocus) { if(!hasFocus){ String phone = et_phone.getText().toString(); if(TextUtils.isEmpty(phone) || phone.length() \u0026lt; 11){ // et_phone.requestFocus(); Toast.makeText(this, \u0026#34;è¯·è¾“å…¥11ä½æ‰‹æœºå·ç \u0026#34;, Toast.LENGTH_SHORT).show(); } } } } å®ç°å½“æ–‡æœ¬é•¿åº¦ç¬¦åˆæ—¶è‡ªåŠ¨æ”¶èµ·è¾“å…¥æ³• @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_edit_hide); // è®¾ç½®å½“å‰æ´»åŠ¨çš„å¸ƒå±€ // è·å–å¸ƒå±€æ–‡ä»¶ä¸­çš„EditTextæ§ä»¶ EditText et_phone = findViewById(R.id.et_phone); EditText et_password = findViewById(R.id.et_password); // ä¸ºEditTextæ§ä»¶æ·»åŠ æ–‡æœ¬å˜åŒ–ç›‘å¬å™¨ et_phone.addTextChangedListener(new HideTextWatcher(et_phone, 11)); et_password.addTextChangedListener(new HideTextWatcher(et_password, 6)); } // è‡ªå®šä¹‰çš„æ–‡æœ¬ç›‘å¬å™¨ç±»ï¼Œç”¨äºåœ¨æ–‡æœ¬é•¿åº¦è¾¾åˆ°æŒ‡å®šå€¼æ—¶éšè—è¾“å…¥æ³• private class HideTextWatcher implements TextWatcher { private EditText mView; // éœ€è¦ç›‘å¬çš„EditTextæ§ä»¶ private int mMaxLength; // æ–‡æœ¬é•¿åº¦çš„æœ€å¤§å€¼ // æ„é€ å‡½æ•°ï¼Œåˆå§‹åŒ–æ§ä»¶å’Œæœ€å¤§é•¿åº¦ public HideTextWatcher(EditText et, int maxLength) { this.mView = et; this.mMaxLength = maxLength; } // æ–‡æœ¬å˜åŒ–å‰çš„å›è°ƒæ–¹æ³• @Override public void beforeTextChanged(CharSequence s, int start, int count, int after) { // åœ¨æ–‡æœ¬å˜åŒ–å‰æ‰§è¡Œçš„æ“ä½œï¼Œè¿™é‡Œä¸éœ€è¦å®ç° } // æ–‡æœ¬å˜åŒ–ä¸­çš„å›è°ƒæ–¹æ³• @Override public void onTextChanged(CharSequence s, int start, int before, int count) { // åœ¨æ–‡æœ¬å˜åŒ–ä¸­æ‰§è¡Œçš„æ“ä½œï¼Œè¿™é‡Œä¸éœ€è¦å®ç° } // æ–‡æœ¬å˜åŒ–åçš„å›è°ƒæ–¹æ³• @Override public void afterTextChanged(Editable s) { String str = s.toString(); // è·å–å½“å‰æ–‡æœ¬å†…å®¹ if(str.length() == mMaxLength) { // å¦‚æœæ–‡æœ¬é•¿åº¦ç­‰äºæœ€å¤§å€¼ // è°ƒç”¨è‡ªå®šä¹‰å·¥å…·ç±»éšè—è¾“å…¥æ³• ViewUtil.hideOneInputMethod(EditHideActivity.this, mView); } } } æ—¥æœŸé€‰æ‹©å™¨ DatePicker XML \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;LinearLayout xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34; android:id=\u0026#34;@+id/main\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34; android:orientation=\u0026#34;vertical\u0026#34; \u0026gt; \u0026lt;Button android:id=\u0026#34;@+id/btn_calendar\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:text=\u0026#34;è¯·é€‰æ‹©æ—¥æœŸ\u0026#34; android:layout_marginTop=\u0026#34;40dp\u0026#34;/\u0026gt; \u0026lt;DatePicker android:id=\u0026#34;@+id/dp_date\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:datePickerMode=\u0026#34;spinner\u0026#34; android:calendarViewShown=\u0026#34;false\u0026#34;/\u0026gt; \u0026lt;Button android:id=\u0026#34;@+id/btn_confirm\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:text=\u0026#34;ç¡®å®š\u0026#34;/\u0026gt; \u0026lt;TextView android:id=\u0026#34;@+id/tv_result\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:background=\u0026#34;@drawable/edittext_selector\u0026#34; /\u0026gt; \u0026lt;/LinearLayout\u0026gt; Java package com.showguan.chapter05; import android.app.DatePickerDialog; import android.os.Bundle; import android.view.View; import android.widget.Button; import android.widget.DatePicker; import android.widget.TextView; import androidx.activity.EdgeToEdge; import androidx.appcompat.app.AppCompatActivity; import androidx.core.graphics.Insets; import androidx.core.view.ViewCompat; import androidx.core.view.WindowInsetsCompat; public class DatePickerActivity extends AppCompatActivity implements View.OnClickListener, DatePickerDialog.OnDateSetListener { private DatePicker dp_date; private TextView tv_result; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); EdgeToEdge.enable(this); setContentView(R.layout.activity_date_picker); findViewById(R.id.btn_confirm).setOnClickListener(this); findViewById(R.id.btn_calendar).setOnClickListener(this); dp_date = findViewById(R.id.dp_date); tv_result = findViewById(R.id.tv_result); } @Override public void onClick(View v) { if(v.getId() == R.id.btn_confirm){ String desc = String.format(\u0026#34;æ‚¨é€‰æ‹©çš„æ—¥æœŸä¸º%så¹´ %sæœˆ %sæ—¥\u0026#34;, dp_date.getYear(), dp_date.getMonth() + 1, dp_date.getDayOfMonth()); tv_result.setText(desc); } else if (v.getId() == R.id.btn_calendar) { DatePickerDialog dialog = new DatePickerDialog(this, this, 2027, 4, 13); dialog.show(); } } @Override public void onDateSet(DatePicker view, int year, int month, int dayOfMonth) { String desc = String.format(\u0026#34;æ‚¨é€‰æ‹©çš„æ—¥æœŸä¸º%så¹´ %sæœˆ %sæ—¥\u0026#34;, year, month, dayOfMonth); tv_result.setText(desc); } } æ—¶é—´é€‰æ‹©å™¨ TimePicker XML \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;LinearLayout xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34; android:id=\u0026#34;@+id/main\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34; android:orientation=\u0026#34;vertical\u0026#34; \u0026gt; \u0026lt;Button android:id=\u0026#34;@+id/btn_time\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:text=\u0026#34;è¯·é€‰æ‹©æ—¶é—´\u0026#34; android:layout_marginTop=\u0026#34;40dp\u0026#34;/\u0026gt; \u0026lt;TimePicker android:id=\u0026#34;@+id/tp_time\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:timePickerMode=\u0026#34;spinner\u0026#34; android:layout_marginTop=\u0026#34;5dp\u0026#34; android:calendarViewShown=\u0026#34;false\u0026#34;/\u0026gt; \u0026lt;Button android:id=\u0026#34;@+id/btn_confirm\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:text=\u0026#34;ç¡®å®š\u0026#34;/\u0026gt; \u0026lt;TextView android:id=\u0026#34;@+id/tv_result\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:layout_marginTop=\u0026#34;5dp\u0026#34; android:background=\u0026#34;@drawable/edittext_selector\u0026#34; /\u0026gt; \u0026lt;/LinearLayout\u0026gt; Java public class TimePickerActivity extends AppCompatActivity implements View.OnClickListener, TimePickerDialog.OnTimeSetListener { private TimePicker tp_time; private TextView tv_result; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_time_picker); findViewById(R.id.btn_confirm).setOnClickListener(this); findViewById(R.id.btn_time).setOnClickListener(this); tp_time = findViewById(R.id.tp_time); tv_result = findViewById(R.id.tv_result); } @Override public void onClick(View v) { if (v.getId() == R.id.btn_confirm) { String desc = String.format(\u0026#34;æ‚¨é€‰æ‹©çš„æ—¶é—´ä¸º%sæ—¶ %såˆ†\u0026#34;, tp_time.getHour(), tp_time.getMinute()); tv_result.setText(desc); } else if (v.getId() == R.id.btn_time) { Log.d(\u0026#34;Kennem\u0026#34;, \u0026#34;onClick: R.id.btn_time\u0026#34;); Calendar calendar = Calendar.getInstance(); TimePickerDialog dialog = new TimePickerDialog(this, AlertDialog.THEME_HOLO_DARK,this, calendar.get(Calendar.HOUR_OF_DAY), calendar.get(Calendar.MINUTE), true); dialog.show(); } } @Override public void onTimeSet(TimePicker view, int hourOfDay, int minute) { String desc = String.format(\u0026#34;æ‚¨é€‰æ‹©çš„æ—¶é—´ä¸º%sæ—¶ %såˆ†\u0026#34;, hourOfDay, minute); tv_result.setText(desc); } } æ¡ˆä¾‹ ç™»å½•é¡µé¢ä»¥åŠæ‰¾å›å¯†ç é¡µé¢\n","permalink":"https://kennems.github.io/posts/tech/android2/","summary":"Androidï¼ˆ2ï¼‰ Activityçš„å¯åŠ¨å’Œç»“æŸ ä»å½“å‰é¡µé¢è·³è½¬åˆ°æ–°é¡µé¢ï¼Œè·³è½¬ä»£ç å¦‚ä¸‹ï¼š startActivity(new Intent(æºé¡µé¢.thisï¼Œ ç›®æ ‡é¡µé¢.class","title":"Androidï¼ˆ2ï¼‰"},{"content":"Androidï¼ˆ3ï¼‰ æ•°æ®å­˜å‚¨ å…±äº«å‚æ•°çš„ç”¨æ³• SharedPreferences æ˜¯ Androidçš„ä¸€ä¸ªè½»é‡çº§å­˜å‚¨å·¥å…·ï¼Œé‡‡ç”¨çš„å­˜å‚¨ç»“æ„æ˜¯key-valueçš„é”®å€¼å¯¹æ–¹å¼ å…±äº«å‚æ•°çš„å­˜å‚¨ä»‹è´¨æ˜¯ç¬¦åˆXMLè§„èŒƒçš„é…ç½®æ–‡ä»¶ã€‚ä¿å­˜è·¯å¾„æ˜¯ï¼š/data/data/åº”ç”¨åŒ…å/shared_prefs/æ–‡ä»¶å.xml å…±äº«å‚æ•°ä¸»è¦é€‚ç”¨çš„åœºåˆï¼š\nç®€å•ä¸”å­¤ç«‹çš„æ•°æ®ã€‚è‹¥æ˜¯å¤æ‚ä¸”ç›¸äº’é—´æœ‰å…³çš„æ•°æ®ï¼Œåˆ™è¦ä¿å­˜åœ¨æ•°æ®åº“ä¸­ã€‚ æ–‡æœ¬å½¢å¼çš„æ•°æ®ã€‚è‹¥æ˜¯äºŒè¿›åˆ¶æ•°æ®ï¼Œåˆ™è¦ä¿å­˜åœ¨æ–‡ä»¶ä¸­ã€‚ éœ€è¦æŒä¹…åŒ–å­˜å‚¨çš„æ•°æ®ã€‚åœ¨Appé€€å‡ºåå†æ¬¡å¯åŠ¨æ—¶ï¼Œä¹‹å‰ä¿å­˜çš„æ•°æ®ä»ç„¶æœ‰æ•ˆã€‚ å®é™…å¼€å‘ä¸­ï¼Œå…±äº«å‚æ•°ç»å¸¸å­˜å‚¨çš„æ•°æ®æœ‰Appçš„ä¸ªæ€§åŒ–é…ç½®ä¿¡æ¯ï¼Œç”¨æˆ·ä½¿ç”¨Appçš„è¡Œä¸ºä¿¡æ¯ï¼Œä¸´æ—¶éœ€è¦ä¿å­˜çš„ç‰‡æ®µä¿¡æ¯ã€‚\nShareWriteActivity.java package com.showguan.chapter06; public class ShareWriteActivity extends AppCompatActivity implements View.OnClickListener { private EditText et_name; private EditText et_age; private EditText et_height; private EditText et_weight; private SharedPreferences preferences; private CheckBox ck_isMarried; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_share_write); et_name = findViewById(R.id.et_name); et_age = findViewById(R.id.et_age); et_height = findViewById(R.id.et_height); et_weight = findViewById(R.id.et_weight); ck_isMarried = findViewById(R.id.ck_isMarried); findViewById(R.id.btn_save).setOnClickListener(this); preferences = getSharedPreferences(\u0026#34;config\u0026#34;, Context.MODE_PRIVATE); reload(); } private void reload() { String name = preferences.getString(\u0026#34;name\u0026#34;, null); if(name != null){ et_name.setText(name); } int age = preferences.getInt(\u0026#34;age\u0026#34;, 0); if(age != 0){ et_age.setText(String.valueOf(age)); } Float height = preferences.getFloat(\u0026#34;height\u0026#34;, 0.0F); if(height != 0.0F){ et_height.setText(height.toString()); } Float weight = preferences.getFloat(\u0026#34;weight\u0026#34;, 0.0F); if(weight != 0.0F){ et_weight.setText(weight.toString()); } Boolean isMarried = preferences.getBoolean(\u0026#34;married\u0026#34;, false); ck_isMarried.setChecked(isMarried); } @Override public void onClick(View v) { String name = et_name.getText().toString(); String age = et_age.getText().toString(); String height = et_height.getText().toString(); String weight = et_weight.getText().toString(); SharedPreferences.Editor editor = preferences.edit(); editor.putString(\u0026#34;name\u0026#34;, name); editor.putInt(\u0026#34;age\u0026#34;, Integer.valueOf(age)); editor.putFloat(\u0026#34;height\u0026#34;, Float.valueOf(height)); editor.putFloat(\u0026#34;weight\u0026#34;, Float.valueOf(weight)); editor.putBoolean(\u0026#34;married\u0026#34;, ck_isMarried.isChecked()); editor.commit(); } } å®ç°ä¿å­˜å¯†ç  Java ç”¨æ•°æ®åº“å­˜å‚¨\npackage com.showguan.chapter06; import java.util.Random; public class LoginSQLliteActivity extends AppCompatActivity implements RadioGroup.OnCheckedChangeListener, View.OnClickListener, View.OnFocusChangeListener { // å®šä¹‰ç•Œé¢ä¸­çš„æ§ä»¶ private TextView login_passFun; private EditText login_input; private TextView login_input_option; private View remember_password_layout; private RadioButton rb_phonecode; private RadioButton rb_password; private CheckBox ck_save_password; private EditText et_phone; private Button login; private String mPassword = \u0026#34;123456\u0026#34;; // é»˜è®¤å¯†ç  private String mVerifyCode; // éªŒè¯ç  // ActivityResultLauncherç”¨äºå¤„ç†ä»FindPasswordActivityè¿”å›çš„ç»“æœ private ActivityResultLauncher\u0026lt;Intent\u0026gt; register = registerForActivityResult(new ActivityResultContracts.StartActivityForResult(), new ActivityResultCallback\u0026lt;ActivityResult\u0026gt;() { @Override public void onActivityResult(ActivityResult o) { Intent intent = o.getData(); if (intent != null \u0026amp;\u0026amp; o.getResultCode() == Activity.RESULT_OK) { mPassword = intent.getStringExtra(\u0026#34;new_password\u0026#34;); // è·å–æ–°å¯†ç  } } }); private SharedPreferences preferences; private LoginDBHelper mHelper; @Override protected void onStart() { super.onStart(); mHelper = LoginDBHelper.getInstance(this); // è·å–æ•°æ®åº“å¸®åŠ©ç±»å®ä¾‹ mHelper.openReadLink(); // æ‰“å¼€æ•°æ®åº“è¯»å–è¿æ¥ mHelper.openWriteLink(); // æ‰“å¼€æ•°æ®åº“å†™å…¥è¿æ¥ reload(); // é‡æ–°åŠ è½½ç”¨æˆ·ä¿¡æ¯ } @Override protected void onStop() { super.onStop(); mHelper.closeLink(); // å…³é—­æ•°æ®åº“è¿æ¥ } @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_login_main); // è®¾ç½®æ´»åŠ¨å¸ƒå±€ // åˆå§‹åŒ–æ§ä»¶ RadioGroup rg_login = findViewById(R.id.rg_login); login_passFun = findViewById(R.id.login_passFun); login_input = findViewById(R.id.login_input); login_input_option = findViewById(R.id.login_input_option); remember_password_layout = findViewById(R.id.remember_password_layout); rb_password = findViewById(R.id.rb_password); rb_phonecode = findViewById(R.id.rb_phonecode); et_phone = findViewById(R.id.et_phone); ck_save_password = findViewById(R.id.ck_save_password); login = findViewById(R.id.login); // è®¾ç½®ç›‘å¬å™¨ rg_login.setOnCheckedChangeListener(this); et_phone.addTextChangedListener(new HideTextWatcher(et_phone, 11)); login_input.addTextChangedListener(new HideTextWatcher(login_input, 6)); login_input.setOnFocusChangeListener(this); login_input_option.setOnClickListener(this); login.setOnClickListener(this); // è·å–SharedPreferenceså¯¹è±¡ preferences = getSharedPreferences(\u0026#34;config\u0026#34;, Context.MODE_PRIVATE); } // é‡æ–°åŠ è½½ç”¨æˆ·ä¿¡æ¯ private void reload() { LoginInfo info = mHelper.queryTop(); // æŸ¥è¯¢æœ€æ–°çš„ç”¨æˆ·ä¿¡æ¯ if (info != null \u0026amp;\u0026amp; info.isRemember()) { et_phone.setText(info.getPhone()); login_input.setText(info.getPassword()); ck_save_password.setChecked(true); } } // ç›‘å¬RadioGroupé€‰ä¸­çŠ¶æ€å˜åŒ– @Override public void onCheckedChanged(RadioGroup group, int checkedId) { if (checkedId == R.id.rb_password) { login_passFun.setText(R.string.login_password); login_input.setHint(R.string.password_hint); login_input_option.setText(R.string.forget_password); remember_password_layout.setVisibility(View.VISIBLE); } else if (checkedId == R.id.rb_phonecode) { login_passFun.setText(R.string.login_phonecode); login_input.setHint(R.string.code_hint); login_input_option.setText(R.string.get_code); remember_password_layout.setVisibility(View.GONE); } } // ç›‘å¬ç‚¹å‡»äº‹ä»¶ @Override public void onClick(View v) { String phoneNum = et_phone.getText().toString(); if (phoneNum.length() \u0026lt; 11) { Toast.makeText(this, \u0026#34;æ‚¨è¾“å…¥çš„æ‰‹æœºå·ä¸è¶³11ä½ï¼Œè¯·é‡æ–°è¾“å…¥\u0026#34;, Toast.LENGTH_SHORT).show(); return; } if (v.getId() == R.id.login_input_option) { if (rb_password.isChecked()) { Intent intent = new Intent(this, FindPasswordActivity.class); intent.putExtra(\u0026#34;phone\u0026#34;, phoneNum); register.launch(intent); // å¯åŠ¨FindPasswordActivity } else if (rb_phonecode.isChecked()) { mVerifyCode = String.format(\u0026#34;%06d\u0026#34;, new Random().nextInt(999999)); // ç”ŸæˆéšæœºéªŒè¯ç  AlertDialog.Builder builder = new AlertDialog.Builder(this); builder.setTitle(\u0026#34;æ‰‹æœºéªŒè¯ç \u0026#34;); builder.setMessage(\u0026#34;æ‰‹æœºå·\u0026#34; + phoneNum + \u0026#34;, æœ¬æ¬¡éªŒè¯ç æ˜¯\u0026#34; + mVerifyCode); builder.setPositiveButton(\u0026#34;å¥½çš„\u0026#34;, null); AlertDialog dialog = builder.create(); dialog.show(); } } else if (v.getId() == R.id.login) { if (rb_password.isChecked()) { if (!mPassword.equals(login_input.getText().toString())) { Toast.makeText(this, \u0026#34;ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯ï¼Œè¯·æ£€æŸ¥è¾“å…¥ï¼š\u0026#34;, Toast.LENGTH_SHORT).show(); return; } loginSuccess(); } else if (rb_phonecode.isChecked()) { if (mVerifyCode == null || !mVerifyCode.equals(login_input.getText().toString())) { Toast.makeText(this, \u0026#34;éªŒè¯ç é”™è¯¯ï¼Œè¯·æ£€æŸ¥è¾“å…¥ï¼š\u0026#34;, Toast.LENGTH_SHORT).show(); return; } loginSuccess(); } } } // ç™»å½•æˆåŠŸå¤„ç† private void loginSuccess() { String desc = String.format(\u0026#34;ä½ çš„æ‰‹æœºå·æ˜¯%s, æ­å–œä½ ç™»å½•æˆåŠŸï¼Œç‚¹å‡»ç¡®è®¤è¿”å›ä¸Šä¸€ä¸ªé¡µé¢\u0026#34;, et_phone.getText().toString()); AlertDialog.Builder builder = new AlertDialog.Builder(this); builder.setTitle(\u0026#34;ç™»å½•æˆåŠŸ\u0026#34;); builder.setMessage(desc); builder.setPositiveButton(\u0026#34;ç¡®è®¤è¿”å›\u0026#34;, (dialog, which) -\u0026gt; { finish(); // ç»“æŸå½“å‰æ´»åŠ¨ }); builder.setNegativeButton(\u0026#34;æˆ‘å†çœ‹çœ‹å§\u0026#34;, null); AlertDialog dialog = builder.create(); dialog.show(); if (rb_password.isChecked() \u0026amp;\u0026amp; ck_save_password.isChecked()) { SharedPreferences.Editor editor = preferences.edit(); editor.putString(\u0026#34;account\u0026#34;, et_phone.getText().toString()); editor.putString(\u0026#34;password\u0026#34;, login_input.getText().toString()); editor.putBoolean(\u0026#34;is_save_password\u0026#34;, true); editor.commit(); // æäº¤ä¿å­˜ } LoginInfo info = new LoginInfo(et_phone.getText().toString(), login_input.getText().toString(), ck_save_password.isChecked()); mHelper.insert(info); // å°†ç”¨æˆ·ä¿¡æ¯æ’å…¥æ•°æ®åº“ } // ç›‘å¬æ§ä»¶ç„¦ç‚¹å˜åŒ– @Override public void onFocusChange(View v, boolean hasFocus) { if (v.getId() == R.id.login_input \u0026amp;\u0026amp; hasFocus) { LoginInfo info = mHelper.queryByPhone(et_phone.getText().toString()); if (info != null) { login_input.setText(info.getPassword()); ck_save_password.setChecked(true); } else { login_input.setText(\u0026#34;\u0026#34;); ck_save_password.setChecked(false); } } } // è‡ªå®šä¹‰TextWatcherç±»ï¼Œç”¨äºéšè—è¾“å…¥æ³• class HideTextWatcher implements TextWatcher { private EditText mView; private int maxLength; public HideTextWatcher(EditText editText, int maxLength) { this.mView = editText; this.maxLength = maxLength; } @Override public void beforeTextChanged(CharSequence s, int start, int count, int after) { // åœ¨æ–‡æœ¬æ”¹å˜å‰æ‰§è¡Œçš„æ“ä½œ } @Override public void onTextChanged(CharSequence s, int start, int before, int count) { // åœ¨æ–‡æœ¬æ”¹å˜æ—¶æ‰§è¡Œçš„æ“ä½œ } @Override public void afterTextChanged(Editable s) { // åœ¨æ–‡æœ¬æ”¹å˜åæ‰§è¡Œçš„æ“ä½œ if (s.toString().length() == maxLength) { ViewUtil.hideOneInputMethod(LoginSQLliteActivity.this, mView); } } } } æ•°æ®åº“ç®¡ç†å™¨SQLiteDatabase SQLiteDatabaseæ˜¯SQLiteçš„æ•°æ®åº“ç®¡ç†ç±»ï¼Œå®ƒæä¾›äº†æ‰˜å¹²æ“ä½œæ•°æ®è¡¨çš„APIï¼Œ å¸¸ç”¨çš„æ–¹æ³•æœ‰3ç±»ï¼š ç®¡ç†ç±»ï¼Œç”¨æˆ·æ•°æ®åº“å±‚é¢çš„æ“ä½œ openDatabaseï¼šæ‰“å¼€æŒ‡å®šè·¯å¾„çš„æ•°æ®åº“ isOpenï¼šåˆ¤æ–­æ•°æ®åº“æ˜¯å¦å·²æ‰“å¼€ closeï¼šå…³é—­æ•°æ®åº“ getVersionï¼šè·å–æ•°æ®åº“çš„ç‰ˆæœ¬å· setVersionï¼šè®¾ç½®æ•°æ®åº“çš„ç‰ˆæœ¬å· SQLiteDatabaseå®ç°ä¿å­˜å¯†ç  æ•ˆæœå’ŒSharePreferenceä¸€è‡´ï¼Œä½†æ˜¯æ˜¯ä¿å­˜åœ¨æ•°æ®åº“ä¸­ã€‚\nLoginDBHelper.java package com.showguan.chapter06.database; import android.content.ContentValues; import android.content.Context; import android.database.Cursor; import android.database.sqlite.SQLiteDatabase; import android.database.sqlite.SQLiteOpenHelper; import android.util.Log; import androidx.annotation.Nullable; import com.showguan.chapter06.enity.LoginInfo; import com.showguan.chapter06.enity.User; import java.util.ArrayList; import java.util.List; public class LoginDBHelper extends SQLiteOpenHelper { private static final String DB_NAME = \u0026#34;login.db\u0026#34;; private static final String TABLE_NAME = \u0026#34;login_info\u0026#34;; private static final int DB_VERSION = 1; private static LoginDBHelper mHelper = null; private SQLiteDatabase mRDB = null; private SQLiteDatabase mWDB = null; private LoginDBHelper(@Nullable Context context) { super(context, DB_NAME, null, DB_VERSION); } public static LoginDBHelper getInstance(Context context) { if (mHelper == null) { mHelper = new LoginDBHelper(context); } return mHelper; } public SQLiteDatabase openReadLink() { if (mRDB == null || !mRDB.isOpen()) { mRDB = mHelper.getReadableDatabase(); } return mRDB; } public SQLiteDatabase openWriteLink() { if (mWDB == null || !mWDB.isOpen()) { mWDB = mHelper.getReadableDatabase(); } return mWDB; } public void closeLink() { if (mRDB != null \u0026amp;\u0026amp; mRDB.isOpen()) { mRDB.close(); mRDB = null; } if (mWDB != null \u0026amp;\u0026amp; mWDB.isOpen()) { mWDB.close(); mWDB = null; } } @Override public void onCreate(SQLiteDatabase db) { String sql = \u0026#34;CREATE TABLE IF NOT EXISTS \u0026#34; + TABLE_NAME + \u0026#34; (\u0026#34; + \u0026#34;_id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,\u0026#34; + \u0026#34; phone VARCHAR NOT NULL,\u0026#34; + \u0026#34; password VARCHAR NOT NULL,\u0026#34; + \u0026#34; remember INTEGER NOT NULL);\u0026#34;; db.execSQL(sql); } @Override public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) { // æ•°æ®åº“ç‰ˆæœ¬æ›´æ–°æ—¶ä½¿ç”¨ String sql = \u0026#34;ALTER TABLE \u0026#34; + TABLE_NAME + \u0026#34; ADD COLUMN phone VARCHAR;\u0026#34;; db.execSQL(sql); sql = \u0026#34;ALTER TABLE \u0026#34; + TABLE_NAME + \u0026#34; ADD COLUMN password VARCHAR;\u0026#34;; db.execSQL(sql); } public void save(LoginInfo info){ try { mWDB.beginTransaction(); delete(info); insert(info); mWDB.setTransactionSuccessful(); }catch (Exception e){ e.printStackTrace(); }finally { mWDB.endTransaction(); } } public long delete(LoginInfo info){ return mWDB.delete(TABLE_NAME, \u0026#34;phone=?\u0026#34;, new String[]{ info.getPhone() }); } public long insert(LoginInfo info) { ContentValues values = new ContentValues(); values.put(\u0026#34;phone\u0026#34;, info.getPhone()); values.put(\u0026#34;password\u0026#34;, info.getPassword()); values.put(\u0026#34;remember\u0026#34;, info.isRemember()); // è¿”å›è¡Œå· return mWDB.insert(TABLE_NAME, null, values); } public long deleteByName(String name) { return mWDB.delete(TABLE_NAME, \u0026#34;name = ?\u0026#34;, new String[]{ name }); } public List\u0026lt;User\u0026gt; queryAll() { List\u0026lt;User\u0026gt; list = new ArrayList\u0026lt;\u0026gt;(); Cursor cursor = mRDB.query(TABLE_NAME, null, null, null, null, null, null); while (cursor.moveToNext()) { User user = new User(); user.setId(cursor.getInt(0)); user.setName(cursor.getString(1)); user.setAge(cursor.getInt(2)); user.setHeight(cursor.getFloat(3)); user.setWeight(cursor.getFloat(4)); user.setMarried(cursor.getInt(5) == 1 ? true : false); list.add(user); } return list; } public LoginInfo queryTop() { LoginInfo info = null; String sql = \u0026#34;SELECT * FROM \u0026#34; + TABLE_NAME + \u0026#34; WHERE remember = 1 ORDER BY _id DESC LIMIT 1\u0026#34;; Cursor cursor = null; try { cursor = mRDB.rawQuery(sql, null); if (cursor != null \u0026amp;\u0026amp; cursor.moveToNext()) { info = new LoginInfo(); int phoneIndex = cursor.getColumnIndex(\u0026#34;phone\u0026#34;); int passwordIndex = cursor.getColumnIndex(\u0026#34;password\u0026#34;); int rememberIndex = cursor.getColumnIndex(\u0026#34;remember\u0026#34;); if (phoneIndex != -1) { info.setPhone(cursor.getString(phoneIndex)); } if (passwordIndex != -1) { info.setPassword(cursor.getString(passwordIndex)); } if (rememberIndex != -1) { info.setRemember(cursor.getInt(rememberIndex) == 1); } } } finally { if (cursor != null) { cursor.close(); } } return info; } public LoginInfo queryByPhone(String phone) { LoginInfo info = null; String sql = \u0026#34;SELECT * FROM \u0026#34; + TABLE_NAME; Cursor cursor = mRDB.query(TABLE_NAME, null, \u0026#34;phone=? and remember=1\u0026#34;, new String[]{phone}, null, null, null); try { if (cursor != null \u0026amp;\u0026amp; cursor.moveToNext()) { info = new LoginInfo(); int phoneIndex = cursor.getColumnIndex(\u0026#34;phone\u0026#34;); int passwordIndex = cursor.getColumnIndex(\u0026#34;password\u0026#34;); int rememberIndex = cursor.getColumnIndex(\u0026#34;remember\u0026#34;); if (phoneIndex != -1) { info.setPhone(cursor.getString(phoneIndex)); } if (passwordIndex != -1) { info.setPassword(cursor.getString(passwordIndex)); } if (rememberIndex != -1) { info.setRemember(cursor.getInt(rememberIndex) == 1); } } } finally { if (cursor != null) { cursor.close(); } } return info; } } å®ä½“ç±»LoginInfo.java package com.showguan.chapter06.enity; public class LoginInfo { private String phone; private String password; private boolean remember; public LoginInfo(String phone, String password, boolean remember) { this.phone = phone; this.password = password; this.remember = remember; } public LoginInfo() { } public String getPhone() { return phone; } public void setPhone(String phone) { this.phone = phone; } public String getPassword() { return password; } public void setPassword(String password) { this.password = password; } public boolean isRemember() { return remember; } public void setRemember(boolean remember) { this.remember = remember; } @Override public String toString() { return \u0026#34;LoginInfo{\u0026#34; + \u0026#34;phone=\u0026#39;\u0026#34; + phone + \u0026#39;\\\u0026#39;\u0026#39; + \u0026#34;, password=\u0026#39;\u0026#34; + password + \u0026#39;\\\u0026#39;\u0026#39; + \u0026#34;, remember=\u0026#34; + remember + \u0026#39;}\u0026#39;; } } LoginSQLliteActivity.java package com.showguan.chapter06; public class LoginSQLliteActivity extends AppCompatActivity implements RadioGroup.OnCheckedChangeListener, View.OnClickListener, View.OnFocusChangeListener { // UIå…ƒç´  private TextView login_passFun; private EditText login_input; private TextView login_input_option; private View remember_password_layout; private RadioButton rb_phonecode; private RadioButton rb_password; private CheckBox ck_save_password; private EditText et_phone; private Button login; // å¯†ç å’ŒéªŒè¯ç  private String mPassword = \u0026#34;123456\u0026#34;; private String mVerifyCode; // ActivityResultLauncher ç”¨äºå¯åŠ¨å¦ä¸€ä¸ªActivityå¹¶æ¥æ”¶ç»“æœ private ActivityResultLauncher\u0026lt;Intent\u0026gt; register = registerForActivityResult(new ActivityResultContracts.StartActivityForResult(), new ActivityResultCallback\u0026lt;ActivityResult\u0026gt;() { @Override public void onActivityResult(ActivityResult o) { Intent intent = o.getData(); if (intent != null \u0026amp;\u0026amp; o.getResultCode() == Activity.RESULT_OK) { // è·å–ä»FindPasswordActivityè¿”å›çš„æ–°å¯†ç  mPassword = intent.getStringExtra(\u0026#34;new_password\u0026#34;); } } }); // SharedPreferences ç”¨äºå­˜å‚¨æ•°æ® private SharedPreferences preferences; // SQLiteæ•°æ®åº“åŠ©æ‰‹ private LoginDBHelper mHelper; // Activityç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼Œåœ¨Activityå¯åŠ¨æ—¶è°ƒç”¨ @Override protected void onStart() { super.onStart(); // æ‰“å¼€æ•°æ®åº“è¯»å†™è¿æ¥ mHelper = LoginDBHelper.getInstance(this); mHelper.openReadLink(); mHelper.openWriteLink(); // é‡æ–°åŠ è½½ç™»å½•ä¿¡æ¯ reload(); } // Activityç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼Œåœ¨Activityåœæ­¢æ—¶è°ƒç”¨ @Override protected void onStop() { super.onStop(); // å…³é—­æ•°æ®åº“è¿æ¥ mHelper.closeLink(); } // Activityåˆ›å»ºæ—¶è°ƒç”¨ @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); // è®¾ç½®Activityçš„å¸ƒå±€æ–‡ä»¶ setContentView(R.layout.activity_login_main); // ç»‘å®šUIå…ƒç´  RadioGroup rg_login = findViewById(R.id.rg_login); login_passFun = findViewById(R.id.login_passFun); login_input = findViewById(R.id.login_input); login_input_option = findViewById(R.id.login_input_option); remember_password_layout = findViewById(R.id.remember_password_layout); rb_password = findViewById(R.id.rb_password); rb_phonecode = findViewById(R.id.rb_phonecode); et_phone = findViewById(R.id.et_phone); ck_save_password = findViewById(R.id.ck_save_password); login = findViewById(R.id.login); // è®¾ç½®äº‹ä»¶ç›‘å¬ rg_login.setOnCheckedChangeListener(this); et_phone.addTextChangedListener(new HideTextWatcher(et_phone, 11)); login_input.addTextChangedListener(new HideTextWatcher(login_input, 6)); login_input.setOnFocusChangeListener(this); login_input_option.setOnClickListener(this); login.setOnClickListener(this); // åˆå§‹åŒ–SharedPreferences preferences = getSharedPreferences(\u0026#34;config\u0026#34;, Context.MODE_PRIVATE); } // é‡æ–°åŠ è½½ç™»å½•ä¿¡æ¯ private void reload() { LoginInfo info = mHelper.queryTop(); if (info != null \u0026amp;\u0026amp; info.isRemember()) { // å¦‚æœæœ‰ä¿å­˜çš„ç™»å½•ä¿¡æ¯ï¼Œå¡«å……åˆ°UIå…ƒç´ ä¸­ et_phone.setText(info.getPhone()); login_input.setText(info.getPassword()); ck_save_password.setChecked(true); } } // RadioGroupé€‰é¡¹å˜åŒ–æ—¶è°ƒç”¨ @Override public void onCheckedChanged(RadioGroup group, int checkedId) { if (checkedId == R.id.rb_password) { // é€‰æ‹©å¯†ç ç™»å½• login_passFun.setText(R.string.login_password); login_input.setHint(R.string.password_hint); login_input_option.setText(R.string.forget_password); remember_password_layout.setVisibility(View.VISIBLE); } else if (checkedId == R.id.rb_phonecode) { // é€‰æ‹©éªŒè¯ç ç™»å½• login_passFun.setText(R.string.login_phonecode); login_input.setHint(R.string.code_hint); login_input_option.setText(R.string.get_code); remember_password_layout.setVisibility(View.GONE); } } // ç‚¹å‡»äº‹ä»¶å¤„ç† @Override public void onClick(View v) { String phoneNum = et_phone.getText().toString(); if (phoneNum.length() \u0026lt; 11) { // æ‰‹æœºå·ä¸è¶³11ä½ï¼Œæç¤ºç”¨æˆ· Toast.makeText(this, \u0026#34;æ‚¨è¾“å…¥çš„æ‰‹æœºå·ä¸è¶³11ä½ï¼Œè¯·é‡æ–°è¾“å…¥\u0026#34;, Toast.LENGTH_SHORT).show(); return; } if (v.getId() == R.id.login_input_option) { if (rb_password.isChecked()) { // æ‰¾å›å¯†ç  Intent intent = new Intent(this, FindPasswordActivity.class); intent.putExtra(\u0026#34;phone\u0026#34;, phoneNum); register.launch(intent); } else if (rb_phonecode.isChecked()) { // è·å–éªŒè¯ç  mVerifyCode = String.format(\u0026#34;%06d\u0026#34;, new Random().nextInt(999999)); AlertDialog.Builder builder = new AlertDialog.Builder(this); builder.setTitle(\u0026#34;æ‰‹æœºéªŒè¯ç \u0026#34;); builder.setMessage(\u0026#34;æ‰‹æœºå·\u0026#34; + phoneNum + \u0026#34;, æœ¬æ¬¡éªŒè¯ç æ˜¯\u0026#34; + mVerifyCode); builder.setPositiveButton(\u0026#34;å¥½çš„\u0026#34;, null); AlertDialog dialog = builder.create(); dialog.show(); } } else if (v.getId() == R.id.login) { if (rb_password.isChecked()) { // éªŒè¯å¯†ç ç™»å½• if (!mPassword.equals(login_input.getText().toString())) { Toast.makeText(this, \u0026#34;ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯ï¼Œè¯·æ£€æŸ¥è¾“å…¥ï¼š\u0026#34;, Toast.LENGTH_SHORT).show(); return; } loginSuccess(); } else if (rb_phonecode.isChecked()) { // éªŒè¯éªŒè¯ç ç™»å½• if (mVerifyCode == null || !mVerifyCode.equals(login_input.getText().toString())) { Toast.makeText(this, \u0026#34;éªŒè¯ç é”™è¯¯ï¼Œè¯·æ£€æŸ¥è¾“å…¥ï¼š\u0026#34;, Toast.LENGTH_SHORT).show(); return; } loginSuccess(); } } } // ç™»å½•æˆåŠŸå¤„ç† private void loginSuccess() { String desc = String.format(\u0026#34;ä½ çš„æ‰‹æœºå·æ˜¯%s, æ­å–œä½ ç™»å½•æˆåŠŸï¼Œç‚¹å‡»ç¡®è®¤è¿”å›ä¸Šä¸€ä¸ªé¡µé¢\u0026#34;, et_phone.getText().toString()); AlertDialog.Builder builder = new AlertDialog.Builder(this); builder.setTitle(\u0026#34;ç™»å½•æˆåŠŸ\u0026#34;); builder.setMessage(desc); builder.setPositiveButton(\u0026#34;ç¡®è®¤è¿”å›\u0026#34;, (dialog, which) -\u0026gt; { finish(); }); builder.setNegativeButton(\u0026#34;æˆ‘å†çœ‹çœ‹å§\u0026#34;, null); AlertDialog dialog = builder.create(); dialog.show(); if (rb_password.isChecked() \u0026amp;\u0026amp; ck_save_password.isChecked()) { // ä¿å­˜å¯†ç åˆ°SharedPreferences SharedPreferences.Editor editor = preferences.edit(); editor.putString(\u0026#34;account\u0026#34;, et_phone.getText().toString()); editor.putString(\u0026#34;password\u0026#34;, login_input.getText().toString()); editor.putBoolean(\u0026#34;is_save_password\u0026#34;, true); editor.commit(); } if (rb_password.isChecked()) { // ä¿å­˜ç™»å½•ä¿¡æ¯åˆ°SQLite LoginInfo info = new LoginInfo(et_phone.getText().toString(), login_input.getText().toString(), ck_save_password.isChecked()); mHelper.insert(info); } } // ç„¦ç‚¹å˜åŒ–å¤„ç† @Override public void onFocusChange(View v, boolean hasFocus) { if (v.getId() == R.id.login_input \u0026amp;\u0026amp; hasFocus) { // è¾“å…¥æ¡†è·å¾—ç„¦ç‚¹æ—¶ï¼Œä»æ•°æ®åº“ä¸­æŸ¥è¯¢å¯¹åº”çš„å¯†ç  LoginInfo info = mHelper.queryByPhone(et_phone.getText().toString()); if (info != null) { login_input.setText(info.getPassword()); ck_save_password.setChecked(true); } else { login_input.setText(\u0026#34;\u0026#34;); ck_save_password.setChecked(false); } } } // è‡ªå®šä¹‰TextWatcherç±»ï¼Œç”¨äºç›‘å¬æ–‡æœ¬å˜åŒ– class HideTextWatcher implements TextWatcher { private EditText mView; private int maxLength; public HideTextWatcher(EditText editText, int i) { this.mView = editText; this.maxLength = i; } @Override public void beforeTextChanged(CharSequence s, int start, int count, int after) { } @Override public void onTextChanged(CharSequence s, int start, int before, int count) { } @Override public void afterTextChanged(Editable s) { if (s.toString().length() == maxLength) { // å½“æ–‡æœ¬é•¿åº¦è¾¾åˆ°æœ€å¤§å€¼æ—¶éšè—è¾“å…¥æ³• ViewUtil.hideOneInputMethod(LoginSQLliteActivity.this, mView); } } } } å­˜å‚¨å¡å­˜å‚¨ ç§æœ‰å­˜å‚¨ç©ºé—´ä¸å…¬å…±å­˜å‚¨ç©ºé—´\nXML \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;LinearLayout xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34; android:id=\u0026#34;@+id/main\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34; android:orientation=\u0026#34;vertical\u0026#34;\u0026gt; \u0026lt;LinearLayout android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:orientation=\u0026#34;horizontal\u0026#34; android:layout_marginTop=\u0026#34;10dp\u0026#34;\u0026gt; \u0026lt;TextView android:layout_width=\u0026#34;wrap_content\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:text=\u0026#34;å§“å: \u0026#34; android:textSize=\u0026#34;@dimen/common_font_size\u0026#34;/\u0026gt; \u0026lt;EditText android:id=\u0026#34;@+id/et_name\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:background=\u0026#34;@drawable/edittext_selector\u0026#34;/\u0026gt; \u0026lt;/LinearLayout\u0026gt; \u0026lt;LinearLayout android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:orientation=\u0026#34;horizontal\u0026#34; android:layout_marginTop=\u0026#34;10dp\u0026#34;\u0026gt; \u0026lt;TextView android:layout_width=\u0026#34;wrap_content\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:text=\u0026#34;å¹´é¾„: \u0026#34; android:textSize=\u0026#34;@dimen/common_font_size\u0026#34;/\u0026gt; \u0026lt;EditText android:id=\u0026#34;@+id/et_age\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:background=\u0026#34;@drawable/edittext_selector\u0026#34;/\u0026gt; \u0026lt;/LinearLayout\u0026gt; \u0026lt;LinearLayout android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:orientation=\u0026#34;horizontal\u0026#34; android:layout_marginTop=\u0026#34;10dp\u0026#34;\u0026gt; \u0026lt;TextView android:layout_width=\u0026#34;wrap_content\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:text=\u0026#34;èº«é«˜: \u0026#34; android:textSize=\u0026#34;@dimen/common_font_size\u0026#34;/\u0026gt; \u0026lt;EditText android:id=\u0026#34;@+id/et_height\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:background=\u0026#34;@drawable/edittext_selector\u0026#34;/\u0026gt; \u0026lt;/LinearLayout\u0026gt; \u0026lt;LinearLayout android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:orientation=\u0026#34;horizontal\u0026#34; android:layout_marginTop=\u0026#34;10dp\u0026#34;\u0026gt; \u0026lt;TextView android:layout_width=\u0026#34;wrap_content\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:text=\u0026#34;ä½“é‡: \u0026#34; android:textSize=\u0026#34;@dimen/common_font_size\u0026#34;/\u0026gt; \u0026lt;EditText android:id=\u0026#34;@+id/et_weight\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:background=\u0026#34;@drawable/edittext_selector\u0026#34;/\u0026gt; \u0026lt;/LinearLayout\u0026gt; \u0026lt;LinearLayout android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:orientation=\u0026#34;horizontal\u0026#34;\u0026gt; \u0026lt;CheckBox android:id=\u0026#34;@+id/ck_isMarried\u0026#34; android:layout_width=\u0026#34;wrap_content\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34;/\u0026gt; \u0026lt;TextView android:layout_width=\u0026#34;wrap_content\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:text=\u0026#34;å·²å©š\u0026#34; android:textSize=\u0026#34;@dimen/common_small_font_size\u0026#34;/\u0026gt; \u0026lt;/LinearLayout\u0026gt; \u0026lt;Button android:id=\u0026#34;@+id/btn_write\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:text=\u0026#34;ä¿å­˜\u0026#34;/\u0026gt; \u0026lt;Button android:id=\u0026#34;@+id/btn_read\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:text=\u0026#34;è¯»å–\u0026#34;/\u0026gt; \u0026lt;TextView android:id=\u0026#34;@+id/tv_content\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; /\u0026gt; \u0026lt;/LinearLayout\u0026gt; Java package com.showguan.chapter06; public class FileWriteActivity extends AppCompatActivity implements View.OnClickListener { // å®šä¹‰ç•Œé¢ä¸­çš„æ§ä»¶ private EditText et_name; private EditText et_age; private EditText et_height; private EditText et_weight; private SharedPreferences preferences; private CheckBox ck_isMarried; private String path; private TextView tv_content; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); // è®¾ç½®æ´»åŠ¨å¸ƒå±€ setContentView(R.layout.activity_file_write); // åˆå§‹åŒ–æ§ä»¶ et_name = findViewById(R.id.et_name); et_age = findViewById(R.id.et_age); et_height = findViewById(R.id.et_height); et_weight = findViewById(R.id.et_weight); ck_isMarried = findViewById(R.id.ck_isMarried); tv_content = findViewById(R.id.tv_content); // è®¾ç½®æŒ‰é’®ç‚¹å‡»äº‹ä»¶ç›‘å¬å™¨ findViewById(R.id.btn_write).setOnClickListener(this); findViewById(R.id.btn_read).setOnClickListener(this); // è·å–SharedPreferenceså¯¹è±¡ï¼Œæ¨¡å¼ä¸ºç§æœ‰ preferences = getSharedPreferences(\u0026#34;config\u0026#34;, Context.MODE_PRIVATE); } @Override public void onClick(View v) { if(v.getId() == R.id.btn_write){ // è·å–è¾“å…¥æ¡†ä¸­çš„æ–‡æœ¬å†…å®¹ String name = et_name.getText().toString(); String age = et_age.getText().toString(); String height = et_height.getText().toString(); String weight = et_weight.getText().toString(); // æ‹¼æ¥å­—ç¬¦ä¸²å†…å®¹ StringBuilder sb = new StringBuilder(); sb.append(\u0026#34;å§“å:\u0026#34;).append(name); sb.append(\u0026#34;\\nå¹´é¾„:\u0026#34;).append(age); sb.append(\u0026#34;\\nèº«é«˜:\u0026#34;).append(height); sb.append(\u0026#34;\\nä½“é‡:\u0026#34;).append(weight); sb.append(\u0026#34;\\nå©šå¦:\u0026#34;).append(ck_isMarried.isChecked()); String directory; String fileName = System.currentTimeMillis() + \u0026#34;.txt\u0026#34;; // ä½¿ç”¨å†…éƒ¨å­˜å‚¨ç©ºé—´ï¼Œå¸è½½åº”ç”¨åæ–‡ä»¶å°†è¢«åˆ é™¤ directory = getFilesDir().toString(); path = directory + File.separatorChar + fileName; // æ‰“å°è·¯å¾„æ—¥å¿— Log.d(\u0026#34;Kennem\u0026#34;, path); // ä¿å­˜æ–‡æœ¬å†…å®¹åˆ°æ–‡ä»¶ FileUtil.saveText(path, sb.toString()); // æ˜¾ç¤ºä¿å­˜æˆåŠŸçš„Toastæ¶ˆæ¯ Toast.makeText(this, \u0026#34;ä¿å­˜æˆåŠŸ\u0026#34;, Toast.LENGTH_SHORT).show(); } else if (v.getId() == R.id.btn_read) { // ä»æ–‡ä»¶è¯»å–å†…å®¹å¹¶æ˜¾ç¤ºåˆ°TextView tv_content.setText(FileUtil.openText(path)); } } } å­˜å‚¨å¡ä¿å­˜å›¾ç‰‡ å®é™…ä¿å­˜çš„æ–‡ä»¶è·¯å¾„ï¼š/sdcard/Android/data/com.showguan.chapter06/files/Download/1719307975140.jpg\nJava package com.showguan.chapter06; import android.graphics.Bitmap; import android.graphics.BitmapFactory; import android.net.Uri; import android.os.Bundle; import android.os.Environment; import android.util.Log; import android.view.View; import android.widget.ImageView; import android.widget.Toast; import androidx.activity.EdgeToEdge; import androidx.appcompat.app.AppCompatActivity; import androidx.core.graphics.Insets; import androidx.core.view.ViewCompat; import androidx.core.view.WindowInsetsCompat; import com.showguan.chapter06.util.FileUtil; import java.io.File; public class ImageWriteActivity extends AppCompatActivity implements View.OnClickListener { private ImageView iv_pic; private String path; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_image_write); findViewById(R.id.btn_read).setOnClickListener(this); findViewById(R.id.btn_save).setOnClickListener(this); iv_pic = findViewById(R.id.iv_pic); } @Override public void onClick(View v) { if(v.getId() == R.id.btn_save){ String directory = getExternalFilesDir(Environment.DIRECTORY_DOWNLOADS).toString(); String fileName = System.currentTimeMillis() + \u0026#34;.jpg\u0026#34;; path = directory + File.separatorChar + fileName; Log.d(\u0026#34;Kennem\u0026#34;, path); Bitmap bitmap = BitmapFactory.decodeResource(getResources(), R.drawable.cat2); FileUtil.saveImage(path, bitmap); Toast.makeText(this, \u0026#34;ä¿å­˜æˆåŠŸ\u0026#34;, Toast.LENGTH_SHORT).show(); } else if (v.getId() == R.id.btn_read) { // ä½¿ç”¨FileUtilå·¥å…·ç±»ä»æŒ‡å®šè·¯å¾„è¯»å–å›¾ç‰‡æ–‡ä»¶å¹¶è®¾ç½®åˆ°ImageViewä¸­æ˜¾ç¤º // æ³¨æ„ï¼šè¿™é‡Œå‡è®¾FileUtilç±»ä¸­æœ‰ä¸€ä¸ªåä¸ºreadImageçš„æ–¹æ³•ï¼Œå¯ä»¥æ ¹æ®è·¯å¾„è¿”å›Bitmapå¯¹è±¡ã€‚ // ç”±äºå…·ä½“çš„FileUtilç±»å®ç°ä¸æ˜ç¡®ï¼Œè¿™æ®µä»£ç æ˜¯å‡è®¾æ€§çš„ç¤ºä¾‹ã€‚ // æ–¹æ³•ä¸€ï¼šä½¿ç”¨FileUtilå·¥å…·ç±»è¯»å–å›¾ç‰‡æ–‡ä»¶ // Bitmap bitmap = FileUtil.readImage(path); // å‡è®¾FileUtilç±»æœ‰è¿™ä¸ªæ–¹æ³• // iv_pic.setImageBitmap(bitmap); // å°†è¯»å–çš„Bitmapå¯¹è±¡è®¾ç½®åˆ°ImageViewä¸­æ˜¾ç¤º // æ–¹æ³•äºŒï¼šç›´æ¥ä½¿ç”¨BitmapFactoryè§£ç æŒ‡å®šè·¯å¾„çš„å›¾ç‰‡æ–‡ä»¶ä¸ºBitmapå¯¹è±¡ // Bitmap bitmap = BitmapFactory.decodeFile(path); // ä½¿ç”¨BitmapFactoryè§£ç æ–‡ä»¶ // iv_pic.setImageBitmap(bitmap); // å°†è§£ç å¾—åˆ°çš„Bitmapå¯¹è±¡è®¾ç½®åˆ°ImageViewä¸­æ˜¾ç¤º // æ–¹æ³•ä¸‰ï¼šä½¿ç”¨Uriå¯¹è±¡åŠ è½½æŒ‡å®šè·¯å¾„çš„å›¾ç‰‡æ–‡ä»¶åˆ°ImageViewä¸­æ˜¾ç¤º iv_pic.setImageURI(Uri.parse(path)); // å°†æŒ‡å®šè·¯å¾„çš„å›¾ç‰‡æ–‡ä»¶é€šè¿‡UriåŠ è½½å¹¶æ˜¾ç¤ºåˆ°ImageView } } } FileUtil package com.showguan.chapter06.util; public class FileUtil { // ä¿å­˜æ–‡æœ¬åˆ°æŒ‡å®šè·¯å¾„ public static void saveText(String path, String txt) { // æ³¨æ„ï¼Œè¿™é‡Œéœ€è¦ç¡®ä¿osè¢«æ­£ç¡®å…³é—­ä¹‹åæ‰èƒ½ä¿å­˜æ–‡ä»¶ try (BufferedWriter os = new BufferedWriter(new FileWriter(path))) { os.write(txt); Log.d(\u0026#34;Kennem\u0026#34;, \u0026#34;ä¿å­˜æˆåŠŸ\u0026#34;); Log.d(\u0026#34;Kennem\u0026#34;, \u0026#34;ä¿å­˜çš„å†…å®¹\u0026#34; + txt); } catch (Exception e) { e.printStackTrace(); } } //ä»æŒ‡å®šè·¯å¾„çš„æ–‡æœ¬æ–‡ä»¶ä¸­è¯»å–ä¸ºå­—ç¬¦ä¸² public static String openText(String path){ BufferedReader is = null; StringBuilder sb = new StringBuilder(); try{ is = new BufferedReader(new FileReader(path)); String line = null; while((line = is.readLine()) != null){ sb.append(line); } }catch (Exception e){ e.printStackTrace(); }finally { if(is != null){ try{ is.close(); }catch (Exception e){ e.printStackTrace(); } } } return sb.toString(); } public static void saveImage(String path, Bitmap bitmap) { try(FileOutputStream fos = new FileOutputStream(path)){ bitmap.compress(Bitmap.CompressFormat.JPEG, 100, fos); }catch (Exception e){ e.printStackTrace(); } } public static Bitmap readImage(String path) { Bitmap bitmap = null; try(FileInputStream fis = new FileInputStream(path)) { bitmap = BitmapFactory.decodeStream(fis); }catch (Exception e){ e.printStackTrace(); } return bitmap; } } Application å£°æ˜å‘¨æœŸ é¦–å…ˆè‡ªå®šä¹‰ä¸€ä¸ªApplication\npackage com.showguan.chapter06; import android.app.Application; import android.content.res.Configuration; import android.util.Log; import androidx.annotation.NonNull; import java.util.HashMap; public class MyApplication extends Application { private static MyApplication mApp; public HashMap\u0026lt;String, String\u0026gt; infoMap = new HashMap\u0026lt;\u0026gt;(); public static MyApplication getInstance(){ return mApp; } @Override public void onCreate() { super.onCreate(); Log.d(\u0026#34;Kennem\u0026#34;, \u0026#34;MyApplication onCreate: \u0026#34;); } @Override public void onTerminate() { super.onTerminate(); Log.d(\u0026#34;Kennem\u0026#34;, \u0026#34;MyApplication onTerminate: \u0026#34;); } @Override public void onConfigurationChanged(@NonNull Configuration newConfig) { super.onConfigurationChanged(newConfig); Log.d(\u0026#34;Kennem\u0026#34;, \u0026#34;MyApplication onConfigurationChanged: \u0026#34;); } } 2ã€ä¿®æ”¹manifestæ–‡ä»¶\n3ã€Applicationå£°æ˜å‘¨æœŸ\nApplicationåœ¨Activityä¹‹å‰åˆ›å»ºï¼Œ å¹¶ä¸”æ—‹è½¬å±å¹•æ—¶ä¼šè°ƒç”¨onConfigurationChangedæ–¹æ³•ï¼Œå¹¶ä¼šé‡æ–°åˆ›å»ºActivityã€‚\nApplicationå…¨å±€å˜é‡ æ•°å’Œåœ¨Applicationä¸­ä¿å­˜çš„å…¨å±€å˜é‡ä¸»è¦æœ‰ä¸‹é¢ä¸‰ç§æ•°æ®ï¼š\nä¼šé¢‘ç¹è¯»å–çš„ä¿¡æ¯ï¼Œå¦‚ç”¨æˆ·åï¼Œæ‰‹æœºå·ç­‰ã€‚ ä¸æ–¹ä¾¿ç”±æ„å›¾ä¼ é€’çš„æ•°æ®ï¼Œä¾‹å¦‚ä½å›¾å¯¹è±¡ï¼Œéå­—ç¬¦ä¸²ç±»å‹çš„é›†åˆå¯¹è±¡ç­‰ å®¹æ˜“å› é¢‘ç¹åˆ†é…å†…å­˜äºŒå¯¼è‡´å†…å­˜æ³„æ¼çš„å¯¹è±¡ï¼Œå¦‚Handlerå¯¹è±¡ç­‰ã€‚ é€šè¿‡åœ¨MyApplicationä¸­å®šä¹‰å…¨å±€å˜é‡infoMap, é€šè¿‡å•ä¾‹ç±»è·å–appå¯¹è±¡ï¼Œå®ç°åœ¨infoMapä¸­ï¼Œ å³å†…å­˜ä¸­å­˜å‚¨æ•°æ®ã€‚\nMyAppliaction.java package com.showguan.chapter06; import android.app.Application; import android.content.res.Configuration; import android.util.Log; import androidx.annotation.NonNull; import java.util.HashMap; public class MyApplication extends Application { private static MyApplication mApp = new MyApplication(); public HashMap\u0026lt;String, String\u0026gt; infoMap = new HashMap\u0026lt;\u0026gt;(); public static MyApplication getInstance(){ return mApp; } @Override public void onCreate() { super.onCreate(); Log.d(\u0026#34;Kennem\u0026#34;, \u0026#34;MyApplication onCreate: \u0026#34;); } @Override public void onTerminate() { super.onTerminate(); Log.d(\u0026#34;Kennem\u0026#34;, \u0026#34;MyApplication onTerminate: \u0026#34;); } @Override public void onConfigurationChanged(@NonNull Configuration newConfig) { super.onConfigurationChanged(newConfig); Log.d(\u0026#34;Kennem\u0026#34;, \u0026#34;MyApplication onConfigurationChanged: \u0026#34;); } } AppWriteActivity.java package com.showguan.chapter06; import android.content.SharedPreferences; import android.os.Bundle; import android.view.View; import android.widget.CheckBox; import android.widget.EditText; import androidx.appcompat.app.AppCompatActivity; import com.showguan.chapter06.util.ToastUtil; public class AppWriteActivity extends AppCompatActivity implements View.OnClickListener { private EditText et_name; private EditText et_age; private EditText et_height; private EditText et_weight; private SharedPreferences preferences; private CheckBox ck_isMarried; private MyApplication app; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_app_write); et_name = findViewById(R.id.et_name); et_age = findViewById(R.id.et_age); et_height = findViewById(R.id.et_height); et_weight = findViewById(R.id.et_weight); ck_isMarried = findViewById(R.id.ck_isMarried); findViewById(R.id.btn_save).setOnClickListener(this); app = MyApplication.getInstance(); reload(); } private void reload() { String name = app.infoMap.get(\u0026#34;name\u0026#34;); if (name == null) { return; } String age = app.infoMap.get(\u0026#34;age\u0026#34;); String height = app.infoMap.get(\u0026#34;height\u0026#34;); String weight = app.infoMap.get(\u0026#34;weight\u0026#34;); String married = app.infoMap.get(\u0026#34;married\u0026#34;); et_name.setText(name); et_age.setText(age); et_height.setText(height); et_weight.setText(weight); ck_isMarried.setChecked(married == \u0026#34;æ˜¯\u0026#34;); } // @Override public void onClick(View v) { String name = et_name.getText().toString(); String age = et_age.getText().toString(); String height = et_height.getText().toString(); String weight = et_weight.getText().toString(); app.infoMap.put(\u0026#34;name\u0026#34;, name); app.infoMap.put(\u0026#34;age\u0026#34;, age); app.infoMap.put(\u0026#34;height\u0026#34;, height); app.infoMap.put(\u0026#34;weight\u0026#34;, weight); app.infoMap.put(\u0026#34;married\u0026#34;, ck_isMarried.isChecked() ? \u0026#34;æ˜¯\u0026#34; : \u0026#34;å¦\u0026#34;); ToastUtil.show(this, \u0026#34;ä¿å­˜æˆåŠŸ\u0026#34;); } } Roomæ¡†æ¶çš„å¯¼å…¥ Roomæ—¶è°·æ­Œå…¬å¸æ¨å‡ºçš„æ•°æ®åº“å¤„ç†æ¡†æ¶ï¼Œè¯¥æ¡†æ¶åŒæ ·åŸºäºSQLite, ä½†å®ƒé€šè¿‡æ³¨è§£æŠ€æœ¯æå¤§ç®€åŒ–äº†æ•°æ®åº“æ“ä½œï¼Œå‡å°‘äº†åŸæ¥ç›¸å½“ä¸€éƒ¨åˆ†ç¼–ç å·¥ä½œé‡ã€‚\nåœ¨ä½¿ç”¨Roomä¹‹å‰ï¼Œè¦å…ˆä¿®æ”¹æ¨¡å—çš„build.gradleæ–‡ä»¶ï¼Œå¾€dependenciesèŠ‚ç‚¹æ·»åŠ ä¸‹é¢çš„é…ç½®ï¼Œè¡¨ç¤ºå¯¼å…¥æŒ‡å®šç‰ˆæœ¬çš„Roomåº“ dependencies { implementation \u0026#39;androidx.room:room-runtime:2.6.1\u0026#39; annotationProcessor \u0026#39;androidx.room:room-compiler:2.6.1\u0026#39; } 1ã€åˆ›å»ºå®ä½“ç±» BookInfo.java package com.showguan.chapter06.enity; import androidx.room.Entity; import androidx.room.PrimaryKey; @Entity public class BookInfo { @PrimaryKey(autoGenerate = true) private int id; private String name; private String author; private String publish; private double price; public int getId() { return id; } public void setId(int id) { this.id = id; } public String getName() { return name; } public void setName(String name) { this.name = name; } public String getAuthor() { return author; } public void setAuthor(String author) { this.author = author; } public String getPublish() { return publish; } public void setPublish(String publish) { this.publish = publish; } public double getPrice() { return price; } public void setPrice(double price) { this.price = price; } @Override public String toString() { return \u0026#34;BookInfo{\u0026#34; + \u0026#34;id=\u0026#34; + id + \u0026#34;, name=\u0026#39;\u0026#34; + name + \u0026#39;\\\u0026#39;\u0026#39; + \u0026#34;, author=\u0026#39;\u0026#34; + author + \u0026#39;\\\u0026#39;\u0026#39; + \u0026#34;, publish=\u0026#39;\u0026#34; + publish + \u0026#39;\\\u0026#39;\u0026#39; + \u0026#34;, price=\u0026#34; + price + \u0026#39;}\u0026#39;; } } 2ã€åˆ›å»ºDaoæ•°æ®è®¿é—®å¯¹è±¡ package com.showguan.chapter06.dao; import androidx.room.Dao; import androidx.room.Delete; import androidx.room.Insert; import androidx.room.Query; import androidx.room.Update; import com.showguan.chapter06.enity.BookInfo; import java.util.List; @Dao public interface BookDao { @Insert void insert(BookInfo... bookInfos); @Delete void delete(BookInfo... bookInfos); @Query(\u0026#34;DELETE FROM BookInfo\u0026#34;) void deleteAll(); @Update int update(BookInfo... bookInfos); @Query(\u0026#34;SELECT * FROM BookInfo\u0026#34;) List\u0026lt;BookInfo\u0026gt; queryAll(); @Query(\u0026#34;SELECT * FROM BookInfo WHERE name = :name ORDER BY id DESC LIMIT 1\u0026#34;) BookInfo queryByName(String name); } 3ã€åˆ›å»º BookDatabase è¿æ¥å®ä½“ç±»å’ŒDao package com.showguan.chapter06.database; import androidx.room.Database; import androidx.room.RoomDatabase; import com.showguan.chapter06.dao.BookDao; import com.showguan.chapter06.enity.BookInfo; @Database(entities = {BookInfo.class}, version = 1, exportSchema = true) public abstract class BookDatabase extends RoomDatabase{ public abstract BookDao bookDao(); } 4ã€åœ¨MyApplicationä¸­æ„å»ºå¹¶è¿”å›æ•°æ®åº“å¯¹è±¡ package com.showguan.chapter06; import android.app.Application; import android.content.res.Configuration; import android.util.Log; import androidx.annotation.NonNull; import androidx.room.DatabaseConfiguration; import androidx.room.InvalidationTracker; import androidx.room.Room; import androidx.sqlite.db.SupportSQLiteOpenHelper; import com.showguan.chapter06.dao.BookDao; import com.showguan.chapter06.database.BookDatabase; import java.util.HashMap; public class MyApplication extends Application { private static MyApplication mApp = new MyApplication(); public HashMap\u0026lt;String, String\u0026gt; infoMap = new HashMap\u0026lt;\u0026gt;(); private static BookDatabase bookDatabase; public static MyApplication getInstance(){ return mApp; } @Override public void onCreate() { super.onCreate(); Log.d(\u0026#34;Kennem\u0026#34;, \u0026#34;MyApplication onCreate: \u0026#34;); bookDatabase = Room.databaseBuilder(this, BookDatabase.class, \u0026#34;book\u0026#34;) .addMigrations() // å…è®¸è¿ç§»æ•°æ®åº“ï¼ˆå‘ç”Ÿæ•°æ®åº“å˜æ›´æ—¶ï¼ŒRoomé»˜è®¤åˆ é™¤åŸæ•°æ®åº“å†åˆ›å»ºæ–°æ•°æ®åº“ï¼Œ è¿™æ ·åŸæ¥çš„æ•°æ®ä¼šæ¶ˆå¤±ã€‚ .allowMainThreadQueries() //å…è®¸å†ä¸»çº¿ç¨‹ä¸­æ“ä½œæ•°æ®åº“ï¼ˆRoomé»˜è®¤ä¸èƒ½åœ¨ä¸»çº¿ç¨‹ä¸­æ“ä½œæ•°æ®åº“ï¼‰ .build(); } @Override public void onTerminate() { super.onTerminate(); Log.d(\u0026#34;Kennem\u0026#34;, \u0026#34;MyApplication onTerminate: \u0026#34;); } @Override public void onConfigurationChanged(@NonNull Configuration newConfig) { super.onConfigurationChanged(newConfig); Log.d(\u0026#34;Kennem\u0026#34;, \u0026#34;MyApplication onConfigurationChanged: \u0026#34;); } public BookDatabase getBookDatabase(){ return bookDatabase; } } 5ã€åœ¨ä½¿ç”¨æ—¶åªéœ€è¦ç”¨BookDaoè°ƒç”¨ç›¸åº”çš„æ–¹æ³•å³å¯ package com.showguan.chapter06; import android.os.Bundle; import android.util.Log; import android.view.View; import android.widget.EditText; import androidx.appcompat.app.AppCompatActivity; import com.showguan.chapter06.dao.BookDao; import com.showguan.chapter06.enity.BookInfo; import com.showguan.chapter06.util.ToastUtil; import java.util.List; public class RoomWriteActivity extends AppCompatActivity implements View.OnClickListener { private String TAG = \u0026#34;Kennem\u0026#34;; private EditText et_name; private EditText et_author; private EditText et_publish; private EditText et_price; private BookDao bookDao; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_room_write); et_name = findViewById(R.id.et_name); et_author = findViewById(R.id.et_author); et_publish = findViewById(R.id.et_publish); et_price = findViewById(R.id.et_price); findViewById(R.id.btn_add).setOnClickListener(this); findViewById(R.id.btn_delete).setOnClickListener(this); findViewById(R.id.btn_update).setOnClickListener(this); findViewById(R.id.btn_select).setOnClickListener(this); findViewById(R.id.btn_deleteAll).setOnClickListener(this); bookDao = MyApplication.getInstance().getBookDatabase().bookDao(); } @Override public void onClick(View v) { String name = null; String author = null; String publish = null; Double price = 0.0; if (!et_name.getText().toString().equals(\u0026#34;\u0026#34;)) { name = et_name.getText().toString(); } if (!et_author.getText().toString().equals(\u0026#34;\u0026#34;)) { author = et_author.getText().toString(); } if (!et_publish.getText().toString().equals(\u0026#34;\u0026#34;)) { publish = et_publish.getText().toString(); } if (!et_price.getText().toString().equals(\u0026#34;\u0026#34;)) { // Log.d(TAG, et_price.getText().toString()); price = Double.valueOf(et_price.getText().toString()); } if (v.getId() == R.id.btn_add) { BookInfo bookInfo = new BookInfo(); bookInfo.setName(name); bookInfo.setAuthor(author); bookInfo.setPublish(publish); bookInfo.setPrice(price); bookDao.insert(bookInfo); ToastUtil.show(this, \u0026#34;ä¿å­˜æˆåŠŸï¼\u0026#34;); } else if (v.getId() == R.id.btn_delete) { BookInfo b = new BookInfo(); int id = bookDao.queryByName(name).getId(); b.setId(id); bookDao.delete(b); } else if (v.getId() == R.id.btn_update) { BookInfo b3 = new BookInfo(); BookInfo b4 = bookDao.queryByName(name); b3.setId(b4.getId()); b3.setName(name); b3.setAuthor(author); b3.setPublish(publish); b3.setPrice(price); bookDao.update(b3); } else if (v.getId() == R.id.btn_select) { List\u0026lt;BookInfo\u0026gt; bookInfos = bookDao.queryAll(); for (BookInfo bookInfo : bookInfos) { Log.d(TAG, bookInfo.toString()); } } else if (v.getId() == R.id.btn_deleteAll) { bookDao.deleteAll(); } } } æ¡ˆä¾‹-å®ç°è´­ç‰©è½¦ ","permalink":"https://kennems.github.io/posts/tech/android3/","summary":"Androidï¼ˆ3ï¼‰ æ•°æ®å­˜å‚¨ å…±äº«å‚æ•°çš„ç”¨æ³• SharedPreferences æ˜¯ Androidçš„ä¸€ä¸ªè½»é‡çº§å­˜å‚¨å·¥å…·ï¼Œé‡‡ç”¨çš„å­˜å‚¨ç»“æ„æ˜¯key-valueçš„é”®å€¼å¯¹æ–¹å¼ å…±äº«å‚æ•°çš„å­˜","title":"Androidï¼ˆ3ï¼‰"},{"content":"Androidï¼ˆ1ï¼‰ ã€é‡‘å±±æ–‡æ¡£ | WPSäº‘æ–‡æ¡£ã€‘ Kotlin è®²ä¹‰\rhttps://kdocs.cn/l/cu14rrCtfKxv\rã€é‡‘å±±æ–‡æ¡£ | WPSäº‘æ–‡æ¡£ã€‘ Android å››å¤§ç»„ä»¶è¯¾ç¨‹æ¦‚è¦ https://kdocs.cn/l/croaFl0RS5LA\rã€é‡‘å±±æ–‡æ¡£ | WPSäº‘æ–‡æ¡£ã€‘ Fragment é‡ç‚¹çŸ¥è¯†\rhttps://kdocs.cn/l/cj89XRLXypb8\rã€é‡‘å±±æ–‡æ¡£ | WPSäº‘æ–‡æ¡£ã€‘ Android UI è¯¾ç¨‹é‡ç‚¹çŸ¥è¯†\rhttps://kdocs.cn/l/cokrSwEg1GF4\rã€é‡‘å±±æ–‡æ¡£ | WPSäº‘æ–‡æ¡£ã€‘ Androidå¸ƒå±€ä¸ä¼˜åŒ–\rhttps://kdocs.cn/l/ciwSdaSLRAwB\rã€é‡‘å±±æ–‡æ¡£ | WPSäº‘æ–‡æ¡£ã€‘ ç»„ä»¶åº“\rhttps://kdocs.cn/l/cvsBNce6AfjI\rã€é‡‘å±±æ–‡æ¡£ | WPSäº‘æ–‡æ¡£ã€‘ Android åŠ¨ç”»\rhttps://kdocs.cn/l/cf4bQiAeZdlI\rã€é‡‘å±±æ–‡æ¡£ | WPSäº‘æ–‡æ¡£ã€‘ è‡ªå®šä¹‰æ§ä»¶çš„å®ç°\rhttps://kdocs.cn/l/cu3bUFFJVvn8\rã€é‡‘å±±æ–‡æ¡£ | WPSäº‘æ–‡æ¡£ã€‘ æƒé™ä¸ç½‘ç»œè¯·æ±‚è¯¾ç¨‹é¢„ä¹ \rhttps://kdocs.cn/l/cme7bRkDMYcB\rã€é‡‘å±±æ–‡æ¡£ | WPSäº‘æ–‡æ¡£ã€‘ å†…å­˜æ³„æ¼å’ŒANRé¢„ä¹ \rhttps://kdocs.cn/l/cpFLi1gGV4Xs\rAndroid å¼€å‘ç¯å¢ƒé…ç½®ï¼šhttps://www.kdocs.cn/l/cekCbJzGOsTM\rGit ç¯å¢ƒé…ç½®ï¼šhttps://kdocs.cn/l/crWdNGh7Onio ctrl + alt + o è‡ªåŠ¨ç»„ç»‡å¯¼å…¥\nAppå¼€å‘è¯­è¨€\nAppå¼€å‘ä¸»è¦æœ‰ä¸¤å¤§æŠ€æœ¯è·¯å¾„ï¼Œåˆ†åˆ«æ˜¯åŸç”Ÿå¼€å‘å’Œæ··åˆå¼€å‘ Androidçš„å®˜æ–¹ç¼–ç¨‹è¯­è¨€åŒ…æ‹¬Javaå’ŒKotlin XMLï¼šExtensible Markup Language, å³å¯æ‰©å±•æ ‡è®°è¯­è¨€\ngradleä¸‹è½½é•œåƒ\nä½¿ç”¨å®˜ç½‘ä¸‹è½½éå¸¸çš„æ…¢ï¼Œå»ºè®®ä½¿ç”¨é•œåƒç«™ï¼š\nï¼ˆ1ï¼‰å®˜ç½‘åœ°å€ï¼šhttps://services.gradle.org/distributions/ ï¼ˆ2ï¼‰è…¾è®¯é•œåƒ Gradleä¸‹è½½åœ°å€ï¼šhttps://mirrors.cloud.tencent.com/gradle/ ï¼ˆ3ï¼‰é˜¿é‡Œäº‘é•œåƒ Gradleä¸‹è½½åœ°å€ï¼šhttps://mirrors.aliyun.com/macports/distfiles/gradle/\nè™šæ‹Ÿæœºæ”¹æˆå†·å¯åŠ¨\nhttps://blog.csdn.net/gh8609123/article/details/118514352\nç±»ä¼¼ç½‘é¡µï¼ŒXMLæè¿°ç•Œé¢ï¼ŒJavaåšäº¤äº’æ•ˆæœ\nç®€å•æ§ä»¶ å­—ä½“å¤§å°è®¾ç½® Javaä»£ç  tv.setTextSize(10); åœ¨XMLæ–‡ä»¶ä¸­åˆ™é€šè¿‡å±æ€§android:textSizeæŒ‡å®šæ–‡æœ¬å¤§å°ï¼Œæ­¤æ—¶éœ€è¦æŒ‡å®šå­—å·å•ä½ã€‚ pxï¼šæ˜¯æ‰‹æœºå±å¹•çš„æœ€å°æ˜¾ç¤ºå•ä½ï¼Œä¸è®¾å¤‡çš„æ˜¾ç¤ºå±æœ‰å…³ dpï¼šæ˜¯ä¸è®¾å¤‡æ— å…³çš„æ˜¾ç¤ºå•ä½**ï¼Œåªä¸å±å¹•çš„å°ºå¯¸æœ‰å…³** spï¼šä¸“é—¨ç”¨æ¥è®¾ç½®å­—ä½“å¤§å°ï¼Œåœ¨ç³»ç»Ÿè®¾ç½®ä¸­å¯ä»¥è°ƒæ•´å­—ä½“å¤§å° Dpi(åƒç´ å¯†åº¦dots-per-inch)è®¡ç®—è§„åˆ™\nä»¥$4.95$è‹±å¯¸ $1920*1080$ çš„æ‰‹æœºè®¾å¤‡ä¸ºä¾‹ï¼š\nè®¡ç®—ç›´è§’è¾¹åƒç´ æ•°é‡ï¼š$1920^2 + 1080^2 = 2202^2$ è®¡ç®—Dpiï¼š$2205/4.95=445$ å¾—åˆ°Dpiä¸º$445$ ï¼ˆæ¯è‹±å¯¸çš„è·ç¦»æœ‰$445$ä¸ªåƒç´ ï¼‰ Density\næŒ‡å±å¹•ä¸Šæ¯å¹³æ–¹è‹±å¯¸ä¸­å«æœ‰çš„åƒç´ ç‚¹æ•°ï¼Œ $445^2$\nDip/dp (è®¾å¤‡ç‹¬ç«‹åƒç´ Device Independent Pixel)\næ‰€æœ‰æ˜¾ç¤ºåˆ°å±å¹•ä¸Šçš„å›¾åƒéƒ½æ˜¯ä»¥pxä¸ºå•ä½çš„ï¼ŒDipæ˜¯å¼€å‘ä¸­ä½¿ç”¨çš„é•¿åº¦å•ä½ï¼Œæœ€åä¹Ÿéœ€è¦è½¬æ¢æˆpxï¼Œè®¡ç®—è¿™ä¸ªè®¾å¤‡ä¸Š1dipç­‰äºå¤šå°‘px\n$px = dip * dpi / 160$\næ ¹æ®æ¢ç®—å…³ç³»ï¼š\n320*480åƒç´ ï¼Œ3.6å¯¸çš„æ‰‹æœºï¼šdpi ä¸º160ï¼Œ$ 1dp = 1px$\npublic class TextSizeActivity extends AppCompatActivity { @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); EdgeToEdge.enable(this); setContentView(R.layout.activity_text_size); TextView viewById = findViewById(R.id.hello_tv); viewById.setTextSize(30); } } \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;LinearLayout xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34; android:orientation=\u0026#34;vertical\u0026#34; android:gravity=\u0026#34;center\u0026#34; \u0026gt; \u0026lt;TextView android:id=\u0026#34;@+id/tv_TextSize_px\u0026#34; android:layout_width=\u0026#34;wrap_content\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:text=\u0026#34;@string/textSize\u0026#34; android:textSize=\u0026#34;30px\u0026#34; /\u0026gt; \u0026lt;TextView android:id=\u0026#34;@+id/tv_TextSize_dp\u0026#34; android:layout_width=\u0026#34;wrap_content\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:text=\u0026#34;@string/textSize\u0026#34; android:textSize=\u0026#34;30dp\u0026#34; /\u0026gt; \u0026lt;TextView android:id=\u0026#34;@+id/tv_TextSize_sp\u0026#34; android:layout_width=\u0026#34;wrap_content\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:text=\u0026#34;@string/textSize\u0026#34; android:textSize=\u0026#34;30sp\u0026#34; /\u0026gt; \u0026lt;!-- spè·Ÿéšç³»ç»Ÿå­—ä½“å˜å¤§è€Œå˜å¤§--\u0026gt; \u0026lt;TextView android:id=\u0026#34;@+id/hello_tv\u0026#34; android:layout_width=\u0026#34;wrap_content\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:text=\u0026#34;@string/textSize\u0026#34; android:textSize=\u0026#34;30px\u0026#34; /\u0026gt; \u0026lt;/LinearLayout\u0026gt; å­—ä½“é¢œè‰²è®¾ç½® åœ¨XMLæ–‡ä»¶ä¸­é€šè¿‡å±æ€§android:textColoræŒ‡å®šæ–‡æœ¬é¢œè‰²ï¼Œè‰²å€¼ç”±é€æ˜åº¦alphaå’ŒRGBä¸‰åŸè‰²ï¼ˆçº¢è‰²red, ç»¿è‰²green, è“è‰²blueï¼‰è”åˆå®šä¹‰ã€‚ è‰²å€¼æœ‰å…«ä½åå…­è¿›åˆ¶å’Œå…­ä½åå…­è¿›åˆ¶ä¸¤ç§è¡¨è¾¾æ–¹å¼ï¼Œä¾‹å¦‚å…«ä½ç¼–ç FFEEDDCCä¸­ï¼ŒFFè¡¨ç¤ºé€æ˜åº¦ï¼ŒEEè¡¨ç¤ºçº¢è‰²çš„æµ“åº¦ï¼ŒDDè¡¨ç¤ºç»¿è‰²çš„æµ“åº¦ï¼ŒCCè¡¨ç¤ºè“è‰²çš„æµ“åº¦ã€‚ é€æ˜åº¦ä¸ºFFè¡¨ç¤ºå®Œå…¨ä¸é€æ˜ï¼Œä¸º00è¡¨ç¤ºå®Œå…¨é€æ˜ã€‚RGBä¸‰è‰²çš„æ•°å€¼è¶Šå¤§ï¼Œè¡¨ç¤ºé¢œè‰²è¶Šæµ“ï¼Œä¹Ÿå°±è¶Šäº®ï¼›æ•°å€¼è¶Šå°ï¼Œè¡¨ç¤ºé¢œè‰²è¶Šæ·¡ï¼Œä¹Ÿå°±è¶Šæš—ã€‚ Javaä¸­é€æ˜åº¦è®¾ç½®çš„æ˜¯é€æ˜ï¼ˆä¾‹å¦‚ï¼š0x00ff00 å®é™…ä¸ºï¼š0x0000ff00ï¼‰ï¼Œè€ŒXMLæ–‡ä»¶ä¸­é€æ˜åº¦è®¾ç½®é»˜è®¤ä¸ºä¸é€æ˜ï¼ˆä¾‹å¦‚é»‘è‰²ï¼š#000000ï¼Œ å®é™…ä¸º#ff000000ï¼‰\n\u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;LinearLayout xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34; android:gravity=\u0026#34;center\u0026#34; android:orientation=\u0026#34;vertical\u0026#34;\u0026gt; \u0026lt;TextView android:id=\u0026#34;@+id/tv_TextSize_code_system\u0026#34; android:layout_width=\u0026#34;wrap_content\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:text=\u0026#34;æ™®é€šé¢œè‰²è®¾ç½®\u0026#34; android:textSize=\u0026#34;17sp\u0026#34; /\u0026gt; \u0026lt;TextView android:id=\u0026#34;@+id/tv_code_eight\u0026#34; android:layout_width=\u0026#34;wrap_content\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:text=\u0026#34;å…«ä½åå…­è¿›åˆ¶é¢œè‰²è®¾ç½®\u0026#34; android:textSize=\u0026#34;17sp\u0026#34; /\u0026gt; \u0026lt;TextView android:id=\u0026#34;@+id/tv_code_six\u0026#34; android:layout_width=\u0026#34;wrap_content\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:text=\u0026#34;å…­ä½åå…­è¿›åˆ¶é¢œè‰²è®¾ç½®\u0026#34; android:textSize=\u0026#34;17sp\u0026#34; /\u0026gt; \u0026lt;TextView android:id=\u0026#34;@+id/tv_xml\u0026#34; android:layout_width=\u0026#34;wrap_content\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:text=\u0026#34;XMLæ–‡ä»¶é»˜è®¤é€æ˜åº¦é¢œè‰²è®¾ç½®\u0026#34; android:textColor=\u0026#34;#00ff00\u0026#34; android:textSize=\u0026#34;17sp\u0026#34; /\u0026gt; \u0026lt;TextView android:id=\u0026#34;@+id/tv_values\u0026#34; android:layout_width=\u0026#34;wrap_content\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:text=\u0026#34;è‡ªå®šä¹‰é¢œè‰²è®¾ç½®\u0026#34; android:textColor=\u0026#34;@color/kennemColor\u0026#34; android:textSize=\u0026#34;17sp\u0026#34; /\u0026gt; \u0026lt;TextView android:id=\u0026#34;@+id/tv_bgc\u0026#34; android:layout_width=\u0026#34;wrap_content\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:background=\u0026#34;@color/kennemColor\u0026#34; android:text=\u0026#34;XMLèƒŒæ™¯è‰²é¢œè‰²è®¾ç½®\u0026#34; android:textSize=\u0026#34;17sp\u0026#34; /\u0026gt; \u0026lt;TextView android:id=\u0026#34;@+id/tv_java_bgc\u0026#34; android:layout_width=\u0026#34;wrap_content\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:text=\u0026#34;JavaèƒŒæ™¯è‰²è®¾ç½®\u0026#34; android:textSize=\u0026#34;17sp\u0026#34; /\u0026gt; \u0026lt;/LinearLayout\u0026gt; public class TextColorActivity extends AppCompatActivity { @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); // è®¾ç½®å½“å‰æ´»åŠ¨çš„å¸ƒå±€è§†å›¾ï¼Œå¸ƒå±€æ–‡ä»¶ä¸º activity_text_color.xml setContentView(R.layout.activity_text_color); // è·å–å¸ƒå±€æ–‡ä»¶ä¸­çš„ TextViewï¼Œå…¶ ID ä¸º tv_TextSize_code_system TextView textView = findViewById(R.id.tv_TextSize_code_system); // å°†è¯¥ TextView çš„æ–‡æœ¬é¢œè‰²è®¾ç½®ä¸ºç»¿è‰²ï¼Œä½¿ç”¨ Color ç±»çš„é™æ€å¸¸é‡ textView.setTextColor(Color.GREEN); // è·å–å¸ƒå±€æ–‡ä»¶ä¸­çš„ TextViewï¼Œå…¶ ID ä¸º tv_code_eight TextView tv_code_eight = findViewById(R.id.tv_code_eight); // å°†è¯¥ TextView çš„æ–‡æœ¬é¢œè‰²è®¾ç½®ä¸ºç»¿è‰²ï¼Œä½¿ç”¨ ARGB æ ¼å¼çš„ 8 ä½åå…­è¿›åˆ¶é¢œè‰²å€¼ tv_code_eight.setTextColor(0xff00ff00); // è·å–å¸ƒå±€æ–‡ä»¶ä¸­çš„ TextViewï¼Œå…¶ ID ä¸º tv_code_six TextView tv_code_six = findViewById(R.id.tv_code_six); // å°†è¯¥ TextView çš„æ–‡æœ¬é¢œè‰²è®¾ç½®ä¸ºç»¿è‰²ï¼Œä½¿ç”¨ RGB æ ¼å¼çš„ 6 ä½åå…­è¿›åˆ¶é¢œè‰²å€¼ï¼ˆ0x00ff00ï¼‰ // æ³¨æ„ï¼šè¿™è¡Œä»£ç å­˜åœ¨é—®é¢˜ï¼Œå› ä¸º 0x00ff00 å®é™…ä¸Šæ˜¯ä¸€ä¸ª 24 ä½çš„å€¼ï¼Œä¼šè¢«è§£æä¸ºé€æ˜é¢œè‰²ã€‚ // åº”è¯¥ä½¿ç”¨ 0xff00ff00 è¿™ç§ 32 ä½æ ¼å¼ã€‚ tv_code_six.setTextColor(0xff00ff00); // ä¿®æ”¹äº†åŸæœ‰çš„é”™è¯¯ // è·å–å¸ƒå±€æ–‡ä»¶ä¸­çš„ TextViewï¼Œå…¶ ID ä¸º tv_java_bgc TextView tv_java_bgc = findViewById(R.id.tv_java_bgc); // å°†è¯¥ TextView çš„èƒŒæ™¯é¢œè‰²è®¾ç½®ä¸ºçº¢è‰²ï¼Œä½¿ç”¨ Color ç±»çš„é™æ€å¸¸é‡ tv_java_bgc.setBackgroundColor(Color.RED); } } è®¾ç½®è§†å›¾çš„å®½é«˜ è§†å›¾å®½åº¦é€šè¿‡å±æ€§android:layout_widthè¡¨è¾¾ï¼Œè¯•å›¾é«˜åº¦é€šè¿‡å±æ€§android:lay_heightè¡¨è¾¾ï¼Œå®½é«˜çš„å–å€¼ä¸»è¦æœ‰ä¸‹åˆ—ä¸‰ç§\nmatch_parentï¼šè¡¨ç¤ºä¸ä¸Šçº§è¯•å›¾ä¿æŒä¸€è‡´ wrap_contentï¼šè¡¨ç¤ºä¸å†…å®¹è‡ªé€‚åº” ä»¥dpä¸ºå•ä½çš„å…·ä½“å°ºå¯¸ \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;LinearLayout xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34; android:gravity=\u0026#34;center\u0026#34; android:orientation=\u0026#34;vertical\u0026#34;\u0026gt; \u0026lt;TextView android:layout_width=\u0026#34;wrap_content\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:layout_marginTop=\u0026#34;5dp\u0026#34; android:background=\u0026#34;#00ffff\u0026#34; android:text=\u0026#34;è§†å›¾å®½é«˜å‡ç”¨wrap_contentå®šä¹‰\u0026#34; android:textColor=\u0026#34;#000000\u0026#34; android:textSize=\u0026#34;17sp\u0026#34; /\u0026gt; \u0026lt;TextView android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:layout_marginTop=\u0026#34;5dp\u0026#34; android:background=\u0026#34;#00ffff\u0026#34; android:text=\u0026#34;è§†å›¾å®½é«˜å‡ç”¨match_parentå®šä¹‰\u0026#34; android:textColor=\u0026#34;#000000\u0026#34; android:textSize=\u0026#34;17sp\u0026#34; /\u0026gt; \u0026lt;TextView android:layout_width=\u0026#34;300dp\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:layout_marginTop=\u0026#34;5dp\u0026#34; android:background=\u0026#34;#00ffff\u0026#34; android:text=\u0026#34;è§†å›¾å®½åº¦æŒ‡å®šå›ºå®šå¤§å°\u0026#34; android:textColor=\u0026#34;#000000\u0026#34; android:textSize=\u0026#34;17sp\u0026#34; /\u0026gt; \u0026lt;TextView android:id=\u0026#34;@+id/tv_code\u0026#34; android:layout_width=\u0026#34;wrap_content\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:layout_marginTop=\u0026#34;5dp\u0026#34; android:background=\u0026#34;#00ffff\u0026#34; android:text=\u0026#34;ç”¨ä»£ç å®šä¹‰è§†å›¾å®½é«˜\u0026#34; android:textColor=\u0026#34;#000000\u0026#34; android:textSize=\u0026#34;17sp\u0026#34; /\u0026gt; \u0026lt;/LinearLayout\u0026gt; è®¾ç½®è§†å›¾çš„é—´è· layout_margin ï¼š å½“å‰è§†å›¾ä¸å‘¨å›´å¹³çº§è§†å›¾ä¹‹é—´çš„è·ç¦»ã€‚åŒ…æ‹¬layout_marginï¼Œ layout_marginLeft, layout_marginTop, layout_marginRight, layout_marginBottom.\nlayout_padding ï¼š å½“å‰è§†å›¾å’Œå†…éƒ¨ä¸‹çº§è§†å›¾ä¹‹é—´çš„å…³ç³»ï¼Œ åŒ…æ‹¬padding, paddingLeft, paddingTop, paddingRight, paddingBottom\n\u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;LinearLayout xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;300dp\u0026#34; android:background=\u0026#34;#00AAFF\u0026#34; android:orientation=\u0026#34;vertical\u0026#34;\u0026gt; \u0026lt;LinearLayout android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34; android:layout_margin=\u0026#34;20dp\u0026#34; android:background=\u0026#34;#FFFF99\u0026#34; android:padding=\u0026#34;60dp\u0026#34;\u0026gt; \u0026lt;View android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34; android:background=\u0026#34;#FF0000\u0026#34; /\u0026gt; \u0026lt;/LinearLayout\u0026gt; \u0026lt;/LinearLayout\u0026gt; è®¾ç½®è§†å›¾çš„å¯¹é½æ–¹å¼ è®¾ç½®è§†å›¾çš„å¯¹é½æ–¹å¼æœ‰ä¸¤ç§é€”å¾„\né‡‡ç”¨layout_gravityå±æ€§ï¼Œå®ƒæŒ‡å®šäº†å½“å‰è§†å›¾ç›¸å¯¹äºä¸Šçº§è§†å›¾çš„å¯¹é½æ–¹å¼ é‡‡ç”¨gravityå±æ€§ï¼Œå®ƒæŒ‡å®šäº†ä¸‹çº§è§†å›¾ç›¸å¯¹äºå½“å‰è§†å›¾çš„å¯¹é½æ–¹å¼ layout_gravityä¸gravityçš„å–å€¼åŒ…æ‹¬ï¼šleft, top, right, bottom, è¿˜å¯ä»¥ç”¨ç«–çº¿è¿æ¥å„å–å€¼ï¼Œä¾‹å¦‚ \u0026quot;left|top\u0026quot; è¡¨ç¤ºå³é å·¦åˆé ä¸Šï¼Œå·¦ä¸Šè§’å¯¹é½ã€‚\n\u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;LinearLayout xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;300dp\u0026#34; android:background=\u0026#34;#ffff99\u0026#34; android:orientation=\u0026#34;horizontal\u0026#34; \u0026gt; \u0026lt;LinearLayout android:layout_width=\u0026#34;0dp\u0026#34; android:layout_height=\u0026#34;200dp\u0026#34; android:layout_weight=\u0026#34;1\u0026#34; android:layout_margin=\u0026#34;10dp\u0026#34; android:background=\u0026#34;#ff0000\u0026#34; android:padding=\u0026#34;10dp\u0026#34; android:layout_gravity=\u0026#34;bottom\u0026#34; android:gravity=\u0026#34;left\u0026#34;\u0026gt; \u0026lt;View android:layout_width=\u0026#34;100dp\u0026#34; android:layout_height=\u0026#34;100dp\u0026#34; android:background=\u0026#34;#00ffff\u0026#34;/\u0026gt; \u0026lt;/LinearLayout\u0026gt; \u0026lt;LinearLayout android:layout_width=\u0026#34;0dp\u0026#34; android:layout_height=\u0026#34;200dp\u0026#34; android:layout_weight=\u0026#34;1\u0026#34; android:layout_margin=\u0026#34;10dp\u0026#34; android:background=\u0026#34;#ff0000\u0026#34; android:padding=\u0026#34;10dp\u0026#34; android:layout_gravity=\u0026#34;top\u0026#34; android:gravity=\u0026#34;right\u0026#34;\u0026gt; \u0026lt;View android:layout_width=\u0026#34;100dp\u0026#34; android:layout_height=\u0026#34;100dp\u0026#34; android:background=\u0026#34;#00ffff\u0026#34; /\u0026gt; \u0026lt;/LinearLayout\u0026gt; \u0026lt;/LinearLayout\u0026gt; å¸¸ç”¨å¸ƒå±€ çº¿æ€§å¸ƒå±€LinearLayout çº¿æ€§å¸ƒå±€çš„æƒé‡\nçº¿æ€§å¸ƒå±€çš„æƒé‡æ¦‚å¿µï¼ŒæŒ‡çš„æ˜¯çº¿æ€§å¸ƒå±€çš„ä¸‹çº§è§†å›¾å„è‡ªæ‹¥æœ‰å¤šå¤§æ¯”ä¾‹çš„å®½é«˜ æƒé‡å±æ€§åå«layout_weightï¼Œ ä½†è¯¥å±æ€§ä¸åœ¨LinearLayoutèŠ‚ç‚¹è®¾ç½®ï¼Œè€Œåœ¨çº¿æ€§å¸ƒå±€çš„ç›´æ¥ä¸‹çº§è§†å›¾è®¾ç½®ï¼Œè¡¨ç¤ºè¯¥ä¸‹çº§è§†å›¾å æ®çš„å®½é«˜æ¯”ä¾‹ã€‚ layout_widthå¡«0dpæ—¶ï¼Œlayout_weightè¡¨ç¤ºæ°´å¹³æ–¹å‘çš„å®½åº¦æ¯”ä¾‹ã€‚ layout_heightå¡«0dpæ—¶ï¼Œ layout_weightè¡¨ç¤ºå‚ç›´æ–¹å‘çš„é«˜åº¦æ¯”ä¾‹ã€‚ \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;LinearLayout xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34; android:id=\u0026#34;@+id/main\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34; android:orientation=\u0026#34;vertical\u0026#34; android:background=\u0026#34;@color/backgroundColor\u0026#34;\u0026gt; \u0026lt;LinearLayout android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:orientation=\u0026#34;horizontal\u0026#34;\u0026gt; \u0026lt;TextView android:layout_width=\u0026#34;0dp\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:layout_weight=\u0026#34;1\u0026#34; android:text=\u0026#34;The æ¨ªæ’ç¬¬ä¸€ä¸ª\u0026#34; android:textColor=\u0026#34;@color/kennemColor\u0026#34; android:textSize=\u0026#34;17sp\u0026#34; /\u0026gt; \u0026lt;TextView android:layout_width=\u0026#34;0dp\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:layout_weight=\u0026#34;2\u0026#34; android:text=\u0026#34;The æ¨ªæ’ç¬¬äºŒä¸ª\u0026#34; android:textColor=\u0026#34;@color/kennemColor\u0026#34; android:textSize=\u0026#34;17sp\u0026#34; /\u0026gt; \u0026lt;/LinearLayout\u0026gt; \u0026lt;LinearLayout android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:orientation=\u0026#34;vertical\u0026#34;\u0026gt; \u0026lt;TextView android:layout_width=\u0026#34;wrap_content\u0026#34; android:layout_height=\u0026#34;0dp\u0026#34; android:layout_weight=\u0026#34;1\u0026#34; android:text=\u0026#34;The ç«–æ’ç¬¬ä¸€ä¸ª\u0026#34; android:textColor=\u0026#34;@color/kennemColor\u0026#34; android:textSize=\u0026#34;17sp\u0026#34; /\u0026gt; \u0026lt;TextView android:layout_width=\u0026#34;wrap_content\u0026#34; android:layout_height=\u0026#34;0dp\u0026#34; android:layout_weight=\u0026#34;1\u0026#34; android:text=\u0026#34;The ç«–æ’ç¬¬äºŒä¸ª\u0026#34; android:textColor=\u0026#34;@color/kennemColor\u0026#34; android:textSize=\u0026#34;17sp\u0026#34; /\u0026gt; \u0026lt;/LinearLayout\u0026gt; \u0026lt;/LinearLayout\u0026gt; ç›¸å¯¹å¸ƒå±€RelativeLayout ç›¸å¯¹å¸ƒå±€çš„ä¸‹çº§è§†å›¾ä½ç½®åˆå…¶ä»–è§†å›¾å†³å®šã€‚ç”¨äºç¡®å®šä¸‹çº§è§†å›¾ä½ç½®çš„å‚ç…§ç‰©åˆ†ä¸¤ç§ï¼š ä¸è¯¥è§†å›¾è‡ªèº«å¹³çº§çš„è§†å›¾ è¯¥è§†å›¾çš„ä¸Šçº§è§†å›¾ï¼ˆä¹Ÿå°±æ˜¯å®ƒå½’å±çš„RelativeLayoutï¼‰ å¦‚æœä¸è®¾å®šä¸‹çº§è§†å›¾çš„å‚ç…§ç‰©ï¼Œé‚£ä¹ˆä¸‹çº§è§†å›¾é»˜è®¤æ˜¾ç¤ºåœ¨RelativeLayoutå†…éƒ¨çš„å·¦ä¸Šè§’ã€‚ â€‹\t\u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;RelativeLayout xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;150dp\u0026#34; android:orientation=\u0026#34;vertical\u0026#34;\u0026gt; \u0026lt;TextView android:id=\u0026#34;@+id/tv_center\u0026#34; android:layout_width=\u0026#34;wrap_content\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:layout_centerInParent=\u0026#34;true\u0026#34; android:background=\u0026#34;#ffffff\u0026#34; android:text=\u0026#34;æˆ‘åœ¨ä¸­é—´\u0026#34; android:textSize=\u0026#34;11sp\u0026#34; android:textColor=\u0026#34;@color/kennemColor\u0026#34;/\u0026gt; \u0026lt;TextView android:id=\u0026#34;@+id/tv_center_horizontal\u0026#34; android:layout_width=\u0026#34;wrap_content\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:layout_centerHorizontal=\u0026#34;true\u0026#34; android:background=\u0026#34;#ffffff\u0026#34; android:text=\u0026#34;æˆ‘åœ¨æ°´å¹³ä¸­é—´\u0026#34; android:textSize=\u0026#34;11sp\u0026#34; android:textColor=\u0026#34;@color/kennemColor\u0026#34;/\u0026gt; \u0026lt;TextView android:id=\u0026#34;@+id/tv_center_vertical\u0026#34; android:layout_width=\u0026#34;wrap_content\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:layout_centerVertical=\u0026#34;true\u0026#34; android:background=\u0026#34;#ffffff\u0026#34; android:text=\u0026#34;æˆ‘åœ¨å‚ç›´ä¸­é—´\u0026#34; android:textSize=\u0026#34;11sp\u0026#34; android:textColor=\u0026#34;@color/kennemColor\u0026#34;/\u0026gt; \u0026lt;TextView android:id=\u0026#34;@+id/tv_parent_left\u0026#34; android:layout_width=\u0026#34;wrap_content\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:layout_alignParentLeft=\u0026#34;true\u0026#34; android:background=\u0026#34;#ffffff\u0026#34; android:text=\u0026#34;å’Œä¸Šçº§çš„å·¦è¾¹å¯¹é½\u0026#34; android:textSize=\u0026#34;11sp\u0026#34; android:textColor=\u0026#34;@color/kennemColor\u0026#34;/\u0026gt; \u0026lt;TextView android:id=\u0026#34;@+id/tv_parent_right\u0026#34; android:layout_width=\u0026#34;wrap_content\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:layout_alignParentRight=\u0026#34;true\u0026#34; android:background=\u0026#34;#ffffff\u0026#34; android:text=\u0026#34;å’Œä¸Šçº§çš„å³è¾¹å¯¹é½\u0026#34; android:textSize=\u0026#34;11sp\u0026#34; android:textColor=\u0026#34;@color/kennemColor\u0026#34;/\u0026gt; \u0026lt;TextView android:id=\u0026#34;@+id/tv_parent_top\u0026#34; android:layout_width=\u0026#34;wrap_content\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:layout_alignParentTop=\u0026#34;true\u0026#34; android:background=\u0026#34;#ffffff\u0026#34; android:text=\u0026#34;å’Œä¸Šçº§çš„é¡¶éƒ¨å¯¹é½\u0026#34; android:textSize=\u0026#34;11sp\u0026#34; android:textColor=\u0026#34;@color/kennemColor\u0026#34;/\u0026gt; \u0026lt;TextView android:id=\u0026#34;@+id/tv_parent_bottom\u0026#34; android:layout_width=\u0026#34;wrap_content\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:layout_alignParentBottom=\u0026#34;true\u0026#34; android:background=\u0026#34;#ffffff\u0026#34; android:text=\u0026#34;å’Œä¸Šçº§çš„åº•éƒ¨å¯¹é½\u0026#34; android:textSize=\u0026#34;11sp\u0026#34; android:textColor=\u0026#34;@color/kennemColor\u0026#34;/\u0026gt; \u0026lt;TextView android:id=\u0026#34;@+id/tv_left_center\u0026#34; android:layout_width=\u0026#34;wrap_content\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:layout_toLeftOf=\u0026#34;@id/tv_center\u0026#34; android:layout_alignTop=\u0026#34;@+id/tv_center\u0026#34; android:background=\u0026#34;#ffffff\u0026#34; android:text=\u0026#34;æˆ‘åœ¨ä¸­é—´çš„å·¦è¾¹\u0026#34; android:textSize=\u0026#34;11sp\u0026#34; android:textColor=\u0026#34;@color/kennemColor\u0026#34;/\u0026gt; \u0026lt;TextView android:id=\u0026#34;@+id/tv_right_center\u0026#34; android:layout_width=\u0026#34;wrap_content\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:layout_toRightOf=\u0026#34;@id/tv_center\u0026#34; android:layout_alignBottom=\u0026#34;@+id/tv_center\u0026#34; android:background=\u0026#34;#ffffff\u0026#34; android:text=\u0026#34;æˆ‘åœ¨ä¸­é—´çš„å³è¾¹\u0026#34; android:textSize=\u0026#34;11sp\u0026#34; android:textColor=\u0026#34;@color/kennemColor\u0026#34;/\u0026gt; \u0026lt;TextView android:id=\u0026#34;@+id/tv_top_center\u0026#34; android:layout_width=\u0026#34;wrap_content\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:layout_above=\u0026#34;@id/tv_center\u0026#34; android:layout_alignLeft=\u0026#34;@+id/tv_center\u0026#34; android:background=\u0026#34;#ffffff\u0026#34; android:text=\u0026#34;æˆ‘åœ¨ä¸­é—´çš„ä¸Šè¾¹\u0026#34; android:textSize=\u0026#34;11sp\u0026#34; android:textColor=\u0026#34;@color/kennemColor\u0026#34;/\u0026gt; \u0026lt;TextView android:id=\u0026#34;@+id/tv_blow_center\u0026#34; android:layout_width=\u0026#34;wrap_content\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:layout_below=\u0026#34;@id/tv_center\u0026#34; android:layout_alignRight=\u0026#34;@+id/tv_center\u0026#34; android:background=\u0026#34;#ffffff\u0026#34; android:text=\u0026#34;æˆ‘åœ¨ä¸­é—´çš„ä¸‹è¾¹\u0026#34; android:textSize=\u0026#34;11sp\u0026#34; android:textColor=\u0026#34;@color/kennemColor\u0026#34;/\u0026gt; \u0026lt;/RelativeLayout\u0026gt; ç½‘æ ¼å¸ƒå±€GridLayout ç½‘æ ¼å¸ƒå±€æ”¯æŒå¤šè¡Œå¤šåˆ—çš„è¡¨æ ¼æ’åˆ—ã€‚ ç½‘æ ¼å¸ƒå±€é»˜è®¤ä»å·¦å¾€å³ã€ä»ä¸Šåˆ°ä¸‹æ’åˆ—ï¼Œå®ƒæ–°å¢äº†ä¸¤ä¸ªå±æ€§ï¼š columnCountå±æ€§ï¼Œå®ƒæŒ‡å®šäº†ç½‘æ ¼çš„åˆ—æ•°ï¼Œå³æ¯è¡Œèƒ½æ”¾å¤šå°‘ä¸ªè§†å›¾ï¼› rowCountå±æ€§ï¼Œå®ƒæŒ‡å®šäº†ç½‘æ ¼çš„è¡Œæ•°ï¼Œå³æ¯åˆ—èƒ½æ”¾å¤šå°‘ä¸ªè§†å›¾ æ»šåŠ¨è§†å›¾ScrollView æ»šåŠ¨è§†å›¾æœ‰ä¸¤ç§ï¼š\nScrollViewï¼Œ å®ƒæ˜¯å‚ç›´æ–¹å‘çš„æ»šåŠ¨è§†å›¾ï¼Œå‚ç›´æ–¹å‘æ»šåŠ¨æ—¶ï¼Œlayout_widthå±æ€§å€¼è®¾ç½®ä¸ºmatch_parentï¼Œ layout_heightå±æ€§å€¼è®¾ç½®ä¸ºwrap_contentã€‚\nHorizontalScrollViewï¼Œ å®ƒæ˜¯æ°´å¹³æ–¹å‘çš„æ»šåŠ¨è§†å›¾ï¼›æ°´å¹³æ–¹å‘æ»šåŠ¨æ—¶ï¼Œlayout_widthå±æ€§å€¼è®¾ç½®ä¸ºwrap_contentï¼Œ layout_heightå±æ€§å€¼è®¾ç½®ä¸ºmatch_parentã€‚\nå“ªä¸ªæ–¹å‘è¦æ»‘åŠ¨å°±å°†å“ªä¸ªæ–¹å‘è®¾ç½®ä¸ºwrap_content\n\u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;LinearLayout xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34; android:id=\u0026#34;@+id/main\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34; android:orientation=\u0026#34;vertical\u0026#34;\u0026gt; \u0026lt;HorizontalScrollView android:layout_width=\u0026#34;wrap_content\u0026#34; android:layout_height=\u0026#34;200dp\u0026#34;\u0026gt; \u0026lt;LinearLayout android:layout_width=\u0026#34;wrap_content\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34; android:orientation=\u0026#34;horizontal\u0026#34;\u0026gt; \u0026lt;View android:layout_width=\u0026#34;300dp\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34; android:background=\u0026#34;#ffff00\u0026#34; /\u0026gt; \u0026lt;View android:layout_width=\u0026#34;300dp\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34; android:background=\u0026#34;#aaffff\u0026#34; /\u0026gt; \u0026lt;/LinearLayout\u0026gt; \u0026lt;/HorizontalScrollView\u0026gt; \u0026lt;ScrollView android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34;\u0026gt; \u0026lt;LinearLayout android:layout_width=\u0026#34;wrap_content\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34; android:orientation=\u0026#34;vertical\u0026#34;\u0026gt; \u0026lt;View android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;700dp\u0026#34; android:background=\u0026#34;#aaff00\u0026#34; /\u0026gt; \u0026lt;View android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;700dp\u0026#34; android:background=\u0026#34;#ff6600\u0026#34; /\u0026gt; \u0026lt;/LinearLayout\u0026gt; \u0026lt;/ScrollView\u0026gt; \u0026lt;/LinearLayout\u0026gt; æŒ‰é’®æ§ä»¶Button æŒ‰é’®æ§ä»¶Buttonç”±TextViewæ´¾ç”Ÿè€Œæ¥ï¼Œå®ƒä»¬ä¹‹é—´çš„åŒºåˆ«æœ‰ï¼š\nButtonæ‹¥æœ‰é»˜è®¤çš„æŒ‰é’®èƒŒæ™¯ï¼Œè€ŒTextViewé»˜è®¤æ— èƒŒæ™¯ Buttonçš„å†…éƒ¨æ–‡æœ¬é»˜è®¤å±…ä¸­å¯¹é½ï¼Œè€ŒTextViewçš„å†…éƒ¨æ–‡æœ¬é»˜è®¤é å·¦å¯¹é½ Buttonä¼šé»˜è®¤å°†è‹±æ–‡å­—æ¯è½¬ä¸ºå¤§å†™ï¼Œè€ŒTextViewä¿æŒåŸå§‹çš„è‹±æ–‡å¤§å°å†™ï¼ˆæ–°ç‰ˆä¿æŒåŸæœ‰æ ¼å¼ï¼‰ æŒ‰é’®æ§ä»¶çš„æ–°å¢å±æ€§ ä¸TextViewç›¸æ¯”ï¼ŒButtonå¢åŠ äº†ä¸¤ä¸ªæ–°å±æ€§ï¼š\ntextAllCapså±æ€§ï¼Œå®ƒæŒ‡å®šäº†æ˜¯å¦å°†è‹±æ–‡å­—æ¯è½¬ä¸ºå¤§å†™ï¼Œä¸ºtrueè¡¨ç¤ºè‡ªåŠ¨è½¬ä¸ºå¤§å†™ï¼Œä¸ºfalseè¡¨ç¤ºä¸åšå¤§å†™è½¬æ¢ onClickå±æ€§ï¼šå®ƒç”¨æ¥æ¥ç®¡ç”¨æˆ·çš„ç‚¹å‡»åŠ¨ä½œï¼ŒæŒ‡å®šäº†ç‚¹å‡»æŒ‰é’®æ—¶è¦è§¦å‘å“ªä¸ªæ–¹æ³• ButtonStyleActivity.java å°† findViewById(R.id.button_result) å­˜å‚¨åˆ°ä¸€ä¸ªå…¨å±€å˜é‡ä¸­ï¼Œå¿«æ·é”®ï¼šctrl + alt + f\npublic class ButtonStyleActivity extends AppCompatActivity { private TextView button_result; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_button_style); button_result = findViewById(R.id.button_result); } public void doClick(View view){ String desc = String.format(\u0026#34;%s æ‚¨ç‚¹å‡»äº†æŒ‰é’®ï¼š%s\u0026#34;, DateUtil.getNowTime(), ((Button)view).getText()); button_result.setText(desc); } } å¸ƒå±€æ–‡ä»¶ï¼š \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;LinearLayout xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34; android:id=\u0026#34;@+id/main\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34; android:orientation=\u0026#34;vertical\u0026#34; android:padding=\u0026#34;5dp\u0026#34;\u0026gt; \u0026lt;TextView android:layout_width=\u0026#34;wrap_content\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:text=\u0026#34;ä¸‹é¢çš„buttonå­—æ¯é»˜è®¤å¤§å†™ï¼š\u0026#34; android:layout_gravity=\u0026#34;center\u0026#34; /\u0026gt; \u0026lt;Button android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:text=\u0026#34;Hello Button\u0026#34; android:textColor=\u0026#34;@color/black\u0026#34; android:textSize=\u0026#34;16sp\u0026#34; /\u0026gt; \u0026lt;Button android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:text=\u0026#34;ç›´æ¥æŒ‡å®šç‚¹å‡»æ–¹æ³•\u0026#34; android:textColor=\u0026#34;@color/black\u0026#34; android:textSize=\u0026#34;16sp\u0026#34; android:onClick=\u0026#34;doClick\u0026#34; /\u0026gt; \u0026lt;TextView android:id=\u0026#34;@+id/button_result\u0026#34; android:layout_width=\u0026#34;wrap_content\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:text=\u0026#34;ä¸‹é¢æ—¶ç‚¹å‡»æŒ‰é’®æŸ¥çœ‹åˆ°çš„ç»“æœ \u0026#34; android:layout_gravity=\u0026#34;center\u0026#34; /\u0026gt; \u0026lt;/LinearLayout\u0026gt; ç‚¹å‡»äº‹ä»¶å’Œé•¿æŒ‰äº‹ä»¶ ç›‘å¬å™¨ï¼Œæ„æ€æ˜¯å¯¹ä¸“é—¨ç›‘å¬æ§ä»¶çš„åŠ¨ä½œè¡Œä¸ºã€‚åªæœ‰æ§ä»¶å‘ç”Ÿäº†æŒ‡å®šçš„åŠ¨ä½œï¼Œç›‘å¬å™¨æ‰ä¼šè§¦å‘å¼€å…³å»æ‰§è¡Œå¯¹åº”çš„ä»£ç é€»è¾‘ æŒ‰é’®æ§ä»¶æœ‰ä¸¤ç§å¸¸ç”¨çš„ç›‘å¬å™¨ï¼š ç‚¹å‡»ç›‘å¬å™¨ï¼šé€šè¿‡setOnClickListeneræ–¹æ³•è®¾ç½®ã€‚æŒ‰é’®è¢«æŒ‰ä½å°‘äº500æ¯«ç§’æ—¶ï¼Œä¼šè§¦å‘ç‚¹å‡»äº‹ä»¶ é•¿æŒ‰ç›‘å¬å™¨ï¼Œé€šè¿‡setOnLongClickListeneræ–¹æ³•è®¾ç½®ã€‚æŒ‰é’®è¢«æŒ‰ä½è¶…è¿‡500æ¯«ç§’æ—¶ï¼Œä¼šè§¦å‘é•¿æŒ‰äº‹ä»¶ã€‚ å•å‡»äº‹ä»¶ XMLå¸ƒå±€æ–‡ä»¶ \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;LinearLayout xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34; android:id=\u0026#34;@+id/main\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34; android:orientation=\u0026#34;vertical\u0026#34;\u0026gt; \u0026lt;Button android:id=\u0026#34;@+id/btn_click_sigle\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:text=\u0026#34;æŒ‡å®šå•ç‹¬çš„å•å‡»æŒ‰é’®\u0026#34; android:textColor=\u0026#34;@color/black\u0026#34; android:textSize=\u0026#34;15sp\u0026#34; /\u0026gt; \u0026lt;Button android:id=\u0026#34;@+id/btn_click_public\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:text=\u0026#34;æŒ‡å®šå…¬å…±çš„å•å‡»æŒ‰é’®\u0026#34; android:textColor=\u0026#34;@color/black\u0026#34; android:textSize=\u0026#34;15sp\u0026#34; /\u0026gt; \u0026lt;TextView android:id=\u0026#34;@+id/tv_result\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:padding=\u0026#34;5dp\u0026#34; android:gravity=\u0026#34;center\u0026#34; android:textColor=\u0026#34;@color/black\u0026#34; android:textSize=\u0026#34;15sp\u0026#34; android:text=\u0026#34;ç‚¹å‡»æŒ‰é’®æŸ¥çœ‹æ˜¾ç¤ºç»“æœ\u0026#34;/\u0026gt; \u0026lt;/LinearLayout\u0026gt; Javaæ–‡ä»¶ /** * ButtonClickActivityç±»ï¼Œç»§æ‰¿AppCompatActivityï¼Œå®ç°View.OnClickListeneræ¥å£ * ç”¨äºå¤„ç†æŒ‰é’®ç‚¹å‡»äº‹ä»¶ */ public class ButtonClickActivity extends AppCompatActivity implements View.OnClickListener { // å®šä¹‰Viewå’ŒTextViewç±»å‹çš„æˆå‘˜å˜é‡ private View btn_click_sigle; private TextView tv_result; /** * åœ¨Activityåˆ›å»ºæ—¶è°ƒç”¨ï¼Œåˆå§‹åŒ–Activity * @param savedInstanceState ç”¨äºä¿å­˜Activityçš„çŠ¶æ€ */ @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_button_click); // è®¾ç½®å¸ƒå±€æ–‡ä»¶ // è·å–å¸ƒå±€ä¸­çš„TextViewæ§ä»¶ tv_result = findViewById(R.id.tv_result); // è·å–å¸ƒå±€ä¸­çš„æŒ‰é’®æ§ä»¶ btn_click_sigle = findViewById(R.id.btn_click_sigle); // è®¾ç½®æŒ‰é’®çš„ç‚¹å‡»ç›‘å¬å™¨ btn_click_sigle.setOnClickListener(new MyOnClickListener(tv_result)); // è·å–å¦ä¸€ä¸ªæŒ‰é’®æ§ä»¶ Button btn_click_public = findViewById(R.id.btn_click_public); // è®¾ç½®å½“å‰ç±»ä¸ºæŒ‰é’®çš„ç‚¹å‡»ç›‘å¬å™¨ btn_click_public.setOnClickListener(this); } /** * é‡å†™View.OnClickListeneræ¥å£ä¸­çš„onClickæ–¹æ³• * å¤„ç†æŒ‰é’®çš„ç‚¹å‡»äº‹ä»¶ * @param v è¢«ç‚¹å‡»çš„View */ @Override public void onClick(View v) { if (v.getId() == R.id.btn_click_public) { // åˆ¤æ–­ç‚¹å‡»çš„æ˜¯å¦ä¸ºbtn_click_publicæŒ‰é’® // è·å–å½“å‰æ—¶é—´å’ŒæŒ‰é’®æ–‡æœ¬ï¼Œæ ¼å¼åŒ–å­—ç¬¦ä¸² String desc = String.format(\u0026#34;%s æ‚¨ç‚¹å‡»äº†æŒ‰é’®ï¼š%s\u0026#34;, DateUtil.getNowTime(), ((Button) v).getText()); // è®¾ç½®TextViewçš„æ–‡æœ¬å†…å®¹ tv_result.setText(desc); } } /** * é™æ€å†…éƒ¨ç±»ï¼Œå®ç°View.OnClickListeneræ¥å£ * é˜²æ­¢å†…å­˜æ³„æ¼ï¼Œå¤„ç†æŒ‰é’®çš„ç‚¹å‡»äº‹ä»¶ */ static class MyOnClickListener implements View.OnClickListener { // å®šä¹‰TextViewç±»å‹çš„æˆå‘˜å˜é‡ private final TextView tv_result; /** * æ„é€ å‡½æ•°ï¼Œåˆå§‹åŒ–TextView * @param tv_result TextViewæ§ä»¶ */ public MyOnClickListener(TextView tv_result) { this.tv_result = tv_result; } /** * é‡å†™View.OnClickListeneræ¥å£ä¸­çš„onClickæ–¹æ³• * å¤„ç†æŒ‰é’®çš„ç‚¹å‡»äº‹ä»¶ * @param v è¢«ç‚¹å‡»çš„View */ @Override public void onClick(View v) { // è·å–å½“å‰æ—¶é—´å’ŒæŒ‰é’®æ–‡æœ¬ï¼Œæ ¼å¼åŒ–å­—ç¬¦ä¸² String desc = String.format(\u0026#34;%s æ‚¨ç‚¹å‡»äº†æŒ‰é’®ï¼š%s\u0026#34;, DateUtil.getNowTime(), ((Button) v).getText()); // è®¾ç½®TextViewçš„æ–‡æœ¬å†…å®¹ tv_result.setText(desc); } } } é•¿æŒ‰äº‹ä»¶ XML \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;LinearLayout xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34; android:id=\u0026#34;@+id/main\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34; android:orientation=\u0026#34;vertical\u0026#34;\u0026gt; \u0026lt;Button android:id=\u0026#34;@+id/btn_long_click\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:text=\u0026#34;æŒ‡å®šé•¿æŒ‰çš„ç‚¹å‡»ç›‘å¬å™¨\u0026#34; android:textColor=\u0026#34;@color/black\u0026#34; android:textSize=\u0026#34;15sp\u0026#34; /\u0026gt; \u0026lt;TextView android:id=\u0026#34;@+id/tv_result\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:padding=\u0026#34;5dp\u0026#34; android:gravity=\u0026#34;center\u0026#34; android:textColor=\u0026#34;@color/black\u0026#34; android:textSize=\u0026#34;15sp\u0026#34; android:text=\u0026#34;ç‚¹å‡»æŒ‰é’®æŸ¥çœ‹æ˜¾ç¤ºç»“æœ\u0026#34;/\u0026gt; \u0026lt;/LinearLayout\u0026gt; Java package com.showguan.myapplication; import android.os.Bundle; import android.view.View; import android.widget.Button; import android.widget.TextView; import androidx.activity.EdgeToEdge; import androidx.appcompat.app.AppCompatActivity; import androidx.core.graphics.Insets; import androidx.core.view.ViewCompat; import androidx.core.view.WindowInsetsCompat; import com.showguan.myapplication.util.DateUtil; public class ButtomLongClickActivity extends AppCompatActivity { private TextView tv_result; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_buttom_long_click); tv_result = findViewById(R.id.tv_result); Button btn_long_click = findViewById(R.id.btn_long_click); btn_long_click.setOnLongClickListener(v -\u0026gt; { String desc = String.format(\u0026#34;%s æ‚¨ç‚¹å‡»äº†æŒ‰é’®ï¼š%s\u0026#34;, DateUtil.getNowTime(), ((Button) v).getText()); tv_result.setText(desc); return true; }); } } ç¦ç”¨å’Œæ¢å¤ åœ¨å®é™…ä¸šåŠ¡ä¸­ï¼ŒæŒ‰é’®é€šå¸¸æ‹¥æœ‰ä¸¤ç§çŠ¶æ€ï¼Œå³ä¸å¯ç”¨çŠ¶æ€å’Œå¯ç”¨çŠ¶æ€ï¼Œå®ƒä»¬åœ¨å¤–è§‚å’ŒåŠŸèƒ½ä¸Šçš„åŒºåˆ«å¦‚ä¸‹ï¼š\nä¸å¯ç”¨æŒ‰é’®ï¼šæŒ‰é’®ä¸å…è®¸ç‚¹å‡»ï¼Œå³ä½¿ç‚¹å‡»ä¹Ÿæ²¡ååº”ï¼ŒåŒæ—¶æŒ‰é’®æ–‡å­—ä¸ºç°è‰² å¯ç”¨æŒ‰é’®ï¼šæŒ‰é’®å…è®¸ç‚¹å‡»ï¼Œç‚¹å‡»æŒ‰é’®ä¼šè§¦å‘ç‚¹å‡»äº‹ä»¶ï¼ŒåŒæ—¶æŒ‰é’®æ–‡å­—ä¸ºæ­£å¸¸çš„é»‘è‰²ã€‚ æ˜¯å¦å…è®¸ç‚¹å‡»ç”±enabledå±æ€§æ§åˆ¶ï¼Œå±æ€§å€¼ä¸ºtrueæ—¶è¡¨ç¤ºå…è®¸ç‚¹å‡»ï¼Œä¸ºfalseæ—¶è¡¨ç¤ºä¸å…è®¸ç‚¹å‡»ã€‚\nXMLæ–‡ä»¶ \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;LinearLayout xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34; android:id=\u0026#34;@+id/main\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;match_parent\u0026#34; android:orientation=\u0026#34;vertical\u0026#34;\u0026gt; \u0026lt;LinearLayout android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34;\u0026gt; \u0026lt;Button android:id=\u0026#34;@+id/btn_enable\u0026#34; android:layout_width=\u0026#34;0dp\u0026#34; android:layout_weight=\u0026#34;1\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:text=\u0026#34;å¯åŠ¨æµ‹è¯•æŒ‰é’®\u0026#34; android:textColor=\u0026#34;@color/black\u0026#34; android:textSize=\u0026#34;17sp\u0026#34;/\u0026gt; \u0026lt;Button android:id=\u0026#34;@+id/btn_disenable\u0026#34; android:layout_width=\u0026#34;0dp\u0026#34; android:layout_weight=\u0026#34;1\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:text=\u0026#34;ç¦ç”¨æµ‹è¯•æŒ‰é’®\u0026#34; android:textColor=\u0026#34;@color/black\u0026#34; android:textSize=\u0026#34;17sp\u0026#34;/\u0026gt; \u0026lt;/LinearLayout\u0026gt; \u0026lt;Button android:id=\u0026#34;@+id/btn_test\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:text=\u0026#34;æµ‹è¯•æŒ‰é’®\u0026#34; android:textColor=\u0026#34;@color/black\u0026#34; android:textSize=\u0026#34;17sp\u0026#34; android:enabled=\u0026#34;false\u0026#34;/\u0026gt; \u0026lt;TextView android:id=\u0026#34;@+id/tv_content\u0026#34; android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:text=\u0026#34;è¿™é‡ŒæŸ¥çœ‹æµ‹è¯•æŒ‰é’®çš„ç»“æœ\u0026#34; android:textColor=\u0026#34;@color/kennemColor\u0026#34; android:textSize=\u0026#34;17sp\u0026#34;/\u0026gt; \u0026lt;/LinearLayout\u0026gt; Java /** * ButtonEnableActivityç±»ï¼Œç»§æ‰¿AppCompatActivityï¼Œå®ç°View.OnClickListeneræ¥å£ * ç”¨äºå¤„ç†æŒ‰é’®å¯ç”¨å’Œç¦ç”¨çš„åŠŸèƒ½ */ public class ButtonEnableActivity extends AppCompatActivity implements View.OnClickListener { // å®šä¹‰TextViewå’ŒButtonç±»å‹çš„æˆå‘˜å˜é‡ private TextView tv_content; private Button btn_test; private Button btn_enable; private Button btn_disenable; /** * åœ¨Activityåˆ›å»ºæ—¶è°ƒç”¨ï¼Œåˆå§‹åŒ–Activity * @param savedInstanceState ç”¨äºä¿å­˜Activityçš„çŠ¶æ€ */ @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_button_enable); // è®¾ç½®å¸ƒå±€æ–‡ä»¶ // è·å–å¸ƒå±€ä¸­çš„æŒ‰é’®æ§ä»¶ btn_enable = findViewById(R.id.btn_enable); btn_disenable = findViewById(R.id.btn_disenable); btn_test = findViewById(R.id.btn_test); // è·å–å¸ƒå±€ä¸­çš„TextViewæ§ä»¶ tv_content = findViewById(R.id.tv_content); // è®¾ç½®æŒ‰é’®çš„ç‚¹å‡»ç›‘å¬å™¨ btn_enable.setOnClickListener(this); btn_disenable.setOnClickListener(this); btn_test.setOnClickListener(this); } /** * é‡å†™View.OnClickListeneræ¥å£ä¸­çš„onClickæ–¹æ³• * å¤„ç†æŒ‰é’®çš„ç‚¹å‡»äº‹ä»¶ * @param v è¢«ç‚¹å‡»çš„View */ @Override public void onClick(View v) { int id = v.getId(); // è·å–è¢«ç‚¹å‡»Viewçš„ID if (id == R.id.btn_enable) { // å¦‚æœç‚¹å‡»çš„æ˜¯å¯ç”¨æŒ‰é’® btn_test.setEnabled(true); // å¯ç”¨æµ‹è¯•æŒ‰é’® btn_test.setTextColor(Color.BLACK); // è®¾ç½®æŒ‰é’®æ–‡å­—é¢œè‰²ä¸ºé»‘è‰² } else if (id == R.id.btn_disenable) { // å¦‚æœç‚¹å‡»çš„æ˜¯ç¦ç”¨æŒ‰é’® btn_test.setEnabled(false); // ç¦ç”¨æµ‹è¯•æŒ‰é’® btn_test.setTextColor(Color.GRAY); // è®¾ç½®æŒ‰é’®æ–‡å­—é¢œè‰²ä¸ºç°è‰² } else if (id == R.id.btn_test) { // å¦‚æœç‚¹å‡»çš„æ˜¯æµ‹è¯•æŒ‰é’® tv_content.setText(\u0026#34;æµ‹è¯•æŒ‰é’®è¢«ç‚¹å‡»äº†\u0026#34;); // è®¾ç½®TextViewçš„æ–‡æœ¬å†…å®¹ } } } å›¾åƒæ˜¾ç¤ºImageView å›¾åƒè§†å›¾å±•ç¤ºçš„å›¾ç‰‡é€šå¸¸ä½äºres/drawable***ç›®å½•ä¸‹ï¼Œè®¾ç½®å›¾åƒè§†å›¾çš„æ˜¾ç¤ºå›¾ç‰‡æœ‰ä¸¤ç§æ–¹å¼\nåœ¨XMLæ–‡ä»¶ä¸­ï¼Œé€šè¿‡å±æ€§android:srcå±æ€§å€¼æ ¼å¼å¦‚\u0026quot;@drawable/ä¸å«æ‰©å±•åçš„å›¾ç‰‡åç§°\u0026quot; åœ¨Javaä»£ç ä¸­ï¼Œè°ƒç”¨setImageResourceæ–¹æ³•è®¾ç½®å›¾ç‰‡èµ„æºï¼Œæ–¹æ³•å‚æ•°æ ¼å¼å½¢å¦‚\u0026quot;R.drawable.ä¸å«æ‰©å±•åçš„å›¾ç‰‡åç§°\u0026quot;ã€‚ centerInsideå’Œcenterï¼Œ fitCenterçš„åŒºåˆ«ï¼š fitCenteræ—¢å…è®¸ç¼©å°å›¾ç‰‡ï¼Œä¹Ÿå…è®¸æ”¾å¤§å›¾ç‰‡ï¼ŒcenterInsideåªå…è®¸ç¼©å°å›¾ç‰‡ï¼Œä¸å…è®¸æ”¾å¤§å›¾ç‰‡ï¼Œè€Œcenterè‡ªå§‹è‡³ç»ˆä¿æŒåŸå§‹å°ºå¯¸ï¼Œæ—¢ä¸å…è®¸ç¼©å°å›¾ç‰‡ï¼Œä¹Ÿä¸å…è®¸æ”¾å¤§å›¾ç‰‡\né»˜è®¤ä¸ºfitCenter\nä»£ç è®¾ç½®æ–¹å¼ï¼š\nImageView iv_scale = findViewById(R.id.iv_scale); iv_scale.setImageResource(R.drawable.cat); iv_scale.setScaleType(ImageView.ScaleType.FIT_END); å›¾åƒæŒ‰é’®ImageButton ImageButtonæ˜¯æ˜¾ç¤ºå›¾ç‰‡çš„å›¾åƒæŒ‰é’®ï¼Œä½†å®ƒç»§æ‰¿è‡ªImageViewï¼Œ è€Œéç»§æ‰¿Button\nImageButton å’Œ Buttonä¹‹é—´çš„åŒºåˆ«ï¼š\nButtonæ—¢å¯æ˜¾ç¤ºæ–‡æœ¬ä¹Ÿå¯æ˜¾ç¤ºå›¾ç‰‡ï¼ŒImageButtonåªèƒ½æ˜¾ç¤ºå›¾ç‰‡ä¸èƒ½æ˜¾ç¤ºæ–‡æœ¬ã€‚ ImageButtonä¸Šçš„å›¾åƒå¯æŒ‰æ¯”ä¾‹ç¼©æ”¾ï¼Œè€ŒButtoné€šè¿‡èƒŒæ™¯è®¾ç½®çš„å›¾åƒä¼šæ‹‰ä¼¸å˜å½¢ Buttonåªèƒ½é èƒŒæ™¯æ˜¾ç¤ºä¸€å¼ å›¾ç‰‡ï¼Œè€ŒImageButtonå¯åˆ†åˆ«åœ¨å‰æ™¯å’ŒèƒŒæ™¯æ˜¾ç¤ºå›¾ç‰‡ï¼Œä»è€Œå®ç°ä¸¤å¼ å›¾ç‰‡çš„å åŠ æ•ˆæœ \u0026lt;ImageButton android:layout_width=\u0026#34;match_parent\u0026#34; android:layout_height=\u0026#34;80dp\u0026#34; android:src=\u0026#34;@drawable/cat\u0026#34; android:scaleType=\u0026#34;fitCenter\u0026#34; \u0026gt;\u0026lt;/ImageButton\u0026gt; åŒæ—¶å±•ç¤ºæ–‡æœ¬ä¸å›¾åƒ XML æ–‡ä»¶ \u0026lt;Button android:layout_width=\u0026#34;wrap_content\u0026#34; android:layout_height=\u0026#34;wrap_content\u0026#34; android:background=\u0026#34;#ffffffff\u0026#34; android:drawableRight=\u0026#34;@drawable/ic_launcher_foreground\u0026#34; android:drawablePadding=\u0026#34;15dp\u0026#34; android:text=\u0026#34;å›¾æ ‡æ–‡å­—\u0026#34; android:textSize=\u0026#34;17sp\u0026#34; /\u0026gt; åšæŒï¼Œä¸€å®šè¦åšæŒä¸‹å»ï¼ŒæŒç»­æŠ•å…¥ï¼Œä¸€ä¸‡å°æ—¶å®šå¾‹ æœ‰å›°éš¾äº†å°±åœä¸‹æ¥æƒ³ä¸€æƒ³ æ¥å—ç—›è‹¦, æˆ˜èƒœç—›è‹¦ ","permalink":"https://kennems.github.io/posts/tech/android1/","summary":"Androidï¼ˆ1ï¼‰ ã€é‡‘å±±æ–‡æ¡£ | WPSäº‘æ–‡æ¡£ã€‘ Kotlin è®²ä¹‰ https://kdocs.cn/l/cu14rrCtfKxv ã€é‡‘å±±æ–‡æ¡£ | WPSäº‘æ–‡æ¡£ã€‘ Android å››å¤§ç»„ä»¶è¯¾ç¨‹æ¦‚è¦ https://kdocs.cn/l/croaFl0RS5LA ã€é‡‘å±±æ–‡æ¡£ | WPSäº‘æ–‡æ¡£ã€‘ Fragment é‡ç‚¹çŸ¥è¯† https://kdocs.cn/l/cj89XRLXypb8 ã€","title":"Androidï¼ˆ1ï¼‰"},{"content":"Java Webå¼€å‘(7) SpringåŸç† é…ç½®ä¼˜å…ˆçº§ SpringBootä¸­æ”¯æŒä¸‰ç§æ ¼å¼é…ç½®æ–‡ä»¶çš„ä¼˜å…ˆçº§\nproperties yaml yml é…ç½® SpringBooté™¤äº†æ”¯æŒé…ç½®æ–‡ä»¶å±æ€§é…ç½®ï¼Œè¿˜æ”¯æŒJavaç³»ç»Ÿå±æ€§å’Œå‘½ä»¤è¡Œå‚æ•°çš„æ–¹å¼è¿›è¡Œå±æ€§é…ç½®\nJavaç³»ç»Ÿå±æ€§\n-Dserver.port=9000 å‘½ä»¤è¡Œå‚æ•°\n--server.port=10010 æ‰“åŒ…æ—¶æŒ‡å®šç«¯å£å·(cmd å‘½ä»¤)\njava -Dserver.port=9000 -jar tilas-web-management-0.0.1-SNAPSHOT.jar --server.port=10011 powershellå‘½ä»¤è¡Œå‚æ•°è§£é‡Šä¸åŒ\njava -D\u0026#34;server.port=9000\u0026#34; -jar .\\tilas-web-management-0.0.1-SNAPSHOT.jar --server.port=10011 Javaç³»ç»Ÿå±æ€§-Dserver.port=9000ä¼˜å…ˆçº§é«˜äºä¸‰ç§é…ç½®æ–‡ä»¶ï¼Œ è€Œ--server.port=10011é«˜äºJavaç³»ç»Ÿå±æ€§\nBeanç®¡ç† è·å–bean\né»˜è®¤æƒ…å†µä¸‹ï¼ŒSpringé¡¹ç›®å¯åŠ¨æ—¶ï¼Œä¼šæŠŠbeanéƒ½åˆ›å»ºå¥½æ”¾åœ¨IOCå®¹å™¨ä¸­ï¼Œå¦‚æœæƒ³è¦ä¸»åŠ¨è·å–è¿™äº›beanï¼Œ å¯ä»¥é€šè¿‡å¦‚ä¸‹æ–¹å¼\næ ¹æ®nameè·å–bean\nObject getBean(String name) æ ¹æ®ç±»å‹è·å–bean\n\u0026lt;T\u0026gt; T getBean(Class\u0026lt;T\u0026gt; requiredType) æ ¹æ®nameè·å–beanï¼ˆå¸¦ç±»å‹è½¬æ¢ï¼‰\n\u0026lt;T\u0026gt; T getBean(String name, Class\u0026lt;T\u0026gt; requiredType) BUGè§£å†³Could not autowire. No beans of 'ApplicationContext' type found.çš„é—®é¢˜\nideaå¯¼å…¥å‡ºé”™\nimport org.springframework.context.ApplicationContext; DeptController bean1 = (DeptController) applicationContext.getBean(\u0026#34;deptController\u0026#34;); System.out.println(bean1); DeptController bean2 = (DeptController) applicationContext.getBean(DeptController.class); System.out.println(bean2); DeptController bean3 = (DeptController) applicationContext.getBean(\u0026#34;deptController\u0026#34;, DeptController.class); System.out.println(bean3); beançš„ä½œç”¨åŸŸ ä½œç”¨åŸŸ è¯´æ˜ singleton å®¹å™¨å†…åŒåç§°çš„beanåªæœ‰ä¸€ä¸ªå®ä¾‹ï¼ˆå•ä¾‹ï¼‰é»˜è®¤ prototype æ¯æ¬¡ä½¿ç”¨è¯¥beanæ—¶ä¼šåˆ›å»ºæ–°çš„å®ä¾‹ï¼ˆéå•ä¾‹ï¼‰ request æ¯ä¸ªè¯·æ±‚èŒƒå›´å†…ä¼šåˆ›å»ºæ–°çš„å®ä¾‹ï¼ˆwebç¯å¢ƒä¸­ï¼Œäº†è§£ï¼‰ session æ¯ä¸ªä¼šè¯èŒƒå›´å†…ä¼šåˆ›å»ºæ–°çš„å®ä¾‹ï¼ˆwebç¯å¢ƒä¸­ï¼Œäº†è§£ï¼‰ application æ¯ä¸ªåº”ç”¨èŒƒå›´å†…ä¼šåˆ›å»ºæ–°çš„å®ä¾‹ï¼ˆwebç¯å¢ƒä¸­ï¼Œäº†è§£ï¼‰ //@Lazy @Scope(\u0026#34;prototype\u0026#34;) æ³¨æ„äº‹é¡¹ï¼š\né»˜è®¤singletonçš„beanï¼Œåœ¨å®¹å™¨å¯åŠ¨æ—¶èƒŒåˆ›å»ºï¼Œå¯ä»¥ä½¿ç”¨@Lazyæ³¨è§£æ¥å»¶è¿Ÿåˆå§‹åŒ–ï¼ˆå»¶è¿Ÿåˆ°ç¬¬ä¸€æ¬¡ä½¿ç”¨ï¼‰ prototypeçš„beanï¼Œæ¯ä¸€æ¬¡ä½¿ç”¨è¯¥beançš„æ—¶å€™éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å®ä¾‹ å®é™…å¼€å‘ä¸­ï¼Œç»å¤§éƒ¨åˆ†çš„beanéƒ½æ˜¯å•ä¾‹çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ç»å¤§éƒ¨åˆ†çš„beanä¸éœ€è¦é…ç½®scopeå±æ€§ ç¬¬ä¸‰æ–¹bean å¦‚æœè¦ç®¡ç†çš„beanå¯¹è±¡æ¥è‡ªç¬¬ä¸‰æ–¹ï¼ˆä¸æ˜¯è‡ªå®šä¹‰çš„ï¼‰ï¼Œæ˜¯æ— æ³•ä½¿ç”¨@ComponentåŠè¡ç”Ÿæ³¨è§£å£°æ˜beançš„ï¼Œå°±éœ€è¦ç”¨åˆ°@Beanæ³¨è§£ è‹¥è¦ç®¡ç†çš„ç¬¬ä¸‰æ–¹beanå¯¹è±¡ï¼Œå»ºè®®å¯¹è¿™äº›beanè¿›è¡Œé›†ä¸­åˆ†ç±»é…ç½®ï¼Œå¯ä»¥é€šè¿‡@Configurationæ³¨è§£å£°æ˜ä¸€ä¸ªé…ç½®ç±»ã€‚ @Configuration public class CommonConfig { @Bean // ç¬¬ä¸‰æ–¹beanå¯¹è±¡ // è·å–beanå¯¹è±¡ : å¦‚æœæ²¡æœ‰æŒ‡å®šbeanåç§°ï¼Œåˆ™é»˜è®¤ä¸ºæ–¹æ³•å // ç¬¬ä¸‰æ–¹beanå¯¹è±¡éœ€è¦å¯¹è±¡æ³¨å…¥ï¼Œåªéœ€è¦åœ¨æ–¹æ³•å‚æ•°ä¸­å†™è¯¥å‚æ•°å³å¯ public SAXReader reader(DeptService deptService){ System.out.println(deptService); return new SAXReader(); } } @ComponentåŠè¡ç”Ÿæ³¨è§£ä¸@Beanæ³¨è§£ä½¿ç”¨åœºæ™¯ï¼š\né¡¹ç›®ä¸­è‡ªå®šä¹‰çš„ï¼Œä½¿ç”¨@ComponentåŠå…¶è¡ç”Ÿæ³¨è§£ é¡¹ç›®ä¸­å¼•å…¥ç¬¬ä¸‰æ–¹çš„ï¼Œä½¿ç”¨@Beanæ³¨è§£ SpringBootåŸç† èµ·æ­¥ä¾èµ–ï¼šSpringBootä½¿ç”¨Mavenä¾èµ–ä¼ é€’ç®¡ç†ä¾èµ–ï¼Œå¯ä»¥è‡ªåŠ¨é…ç½®ä¾èµ–\nè‡ªåŠ¨é…ç½®ï¼š\nSpringBootçš„è‡ªåŠ¨é…ç½®å°±æ˜¯å½“Springå®¹å™¨å¯åŠ¨åï¼Œä¸€äº›é…ç½®ç±»ï¼Œbeanå¯¹è±¡å°±è‡ªåŠ¨å­˜å…¥åˆ°äº†IOCå®¹å™¨ä¸­ï¼Œä¸éœ€è¦æˆ‘ä»¬æ‰‹åŠ¨å»å£°æ˜ï¼Œä»è€Œç®€åŒ–äº†å¼€å‘ï¼Œçœå»äº†ç¹ççš„é…ç½®æ“ä½œã€‚ è‡ªåŠ¨é…ç½®åŸç† æ–¹æ¡ˆä¸€ï¼š@ComponentScan ç»„ä»¶æ‰«æ\n@ComponentScan({\u0026#34;com.example\u0026#34;, \u0026#34;com.showguan\u0026#34;}) public class TilasWebManagementApplication { æ–¹æ¡ˆäºŒï¼š@Importå¯¼å…¥ã€‚ä½¿ç”¨@Importå¯¼å…¥çš„ç±»ä¼šè¢«SpringåŠ è½½åˆ°IOCå®¹å™¨ä¸­ï¼Œå¯¼å…¥å½¢å¼\nå¯¼å…¥æ™®é€šç±» å¯¼å…¥é…ç½®ç±» å¯¼å…¥ImportSelectoræ¥å£å®ç°ç±» @EnableXXXæ³¨è§£ï¼Œå°è£…@Importæ³¨è§£ //@Import({TokenParser.class}) //@Import({HeaderConfig.class}) //@Import({MyImportSelector.class}) @EnableHeaderConfig public class TilasWebManagementApplication { } æºç è·Ÿè¸ª @SpringBootApplication\nè¯¥æ³¨è§£æ ‡è¯†åœ¨SpringBootå·¥ç¨‹å¼•å¯¼ç±»ä¸Šï¼Œæ˜¯SpringBootä¸­æœ€æœ€æœ€é‡è¦çš„æ³¨è§£ã€‚ @SpringBootConfigurationï¼šè¯¥æ³¨è§£ä¸@Configurationæ³¨è§£ä½œç”¨ç›¸åŒï¼Œç”¨æ¥å£°æ˜å½“å‰ä¹Ÿæ˜¯ä¸€ä¸ªé…ç½®ç±» @ComponentScanï¼šç»„ä»¶æ‰«æï¼Œé»˜è®¤æ‰«æå½“å‰å¼•å¯¼ç±»æ‰€åœ¨åŒ…åŠå…¶å­åŒ… @EnableAutoConfigurationï¼šSpringBootå®ç°è‡ªåŠ¨åŒ–é…ç½®çš„æ ¸å¿ƒæ³¨è§£ @Conditional ä½œç”¨ï¼šæŒ‰ç…§ä¸€å®šçš„æ¡ä»¶è¿›è¡Œåˆ¤æ–­ï¼Œåœ¨æ»¡è¶³ç»™å®šæ¡ä»¶åæ‰ä¼šæ³¨å†Œå¯¹åº”çš„beanå¯¹è±¡åˆ°Spring IOCå®¹å™¨ä¸­ ä½ç½®ï¼šæ–¹æ³•ï¼Œç±» @Conditional æœ¬èº«æ˜¯ä¸€ä¸ªçˆ¶æ³¨è§£ï¼Œæ´¾ç”Ÿå‡ºå¤§é‡çš„å­æ³¨è§£ @ConditionalOnClassï¼šåˆ¤æ–­ç¯å¢ƒä¸­æ˜¯å¦æœ‰å¯¹åº”å­—èŠ‚ç æ–‡ä»¶ï¼Œæ‰æ³¨å†Œbeanåˆ°IOCå®¹å™¨ @ConditonalOnMissingBeanï¼šåˆ¤æ–­ç¯å¢ƒä¸­æ²¡æœ‰å¯¹åº”çš„beanï¼ˆç±»å‹æˆ–åç§°ï¼‰ï¼Œæ‰æ³¨å†Œè¿™ä¸ªbeanåˆ°IOCå®¹å™¨ä¸­ ï¼ˆå¸¸ç”¨åœºæ™¯ï¼šå…ˆä½¿ç”¨è‡ªå·±åˆ›å»ºçš„beanï¼Œå¦‚æœè‡ªå·±æ²¡æœ‰åˆ›å»ºï¼Œåˆ™ä½¿ç”¨ç³»ç»Ÿé»˜è®¤çš„beanï¼‰\u0026ndash; æŒ‡å®šç±»å‹ï¼ˆvalueå±æ€§ï¼‰ æˆ– åç§°ï¼ˆnameå±æ€§ï¼‰ @ConditionalPropertyï¼šåˆ¤æ–­é…ç½®æ–‡ä»¶ä¸­æœ‰å¯¹åº”å±æ€§å’Œå€¼ï¼Œæ‰æ³¨å†Œbeanåˆ°IOCå®¹å™¨ä¸­ è‡ªå®šä¹‰starter åœºæ™¯ï¼šåœ¨å®é™…å¼€å‘ä¸­ï¼Œç»å¸¸ä¼šå®šä¹‰ä¸€äº›å…¬å…±ç»„ä»¶ï¼Œæä¾›ç»™é¡¹ç›®å›¢é˜Ÿä½¿ç”¨ã€‚è€Œåœ¨SpringBootçš„é¡¹ç›®ä¸­ï¼Œä¸€èˆ¬ä¼šå°†è¿™äº›å…¬å…±ç»„ä»¶å°è£…ä¸ºSpringBootçš„starter æ­¥éª¤ï¼š\nåˆ›å»ºaliyun-oss-spring-boot-starteræ¨¡å— åˆ›å»ºaliyun-oss-spring-boot-autoconfigureæ¨¡å—ï¼Œåœ¨starterä¸­å¼•å…¥è¯¥æ¨¡å— åœ¨aliyun-oss-spring-boot-autoconfigure æ¨¡å—ä¸­çš„å®šä¹‰è‡ªåŠ¨é…ç½®åŠŸèƒ½ï¼Œå¹¶å®šä¹‰è‡ªåŠ¨é…ç½®æ–‡ä»¶ META-INF/spring/xxx.imports æ–‡ä»¶ç›®å½•ç»“æ„ï¼š\nå¤–éƒ¨ç±»éœ€è¦ä½¿ç”¨OSSåŠŸèƒ½æ—¶ï¼š\n1ã€å¼•å…¥ä¾èµ– 2ã€ç¼–å†™ymlæ–‡ä»¶çš„å¿…è¦å‚æ•° 3ã€ç›´æ¥æ³¨å…¥å³å¯\næ€»ç»“ Webä¸‰å±‚æ¶æ„\nSpringMVC æ˜¯ Spring frameworkä¸­çš„Webæ¨¡å—\nSSM(SpringMVC + Spring framework + Mybatis)\nMVNé«˜çº§ mavenç”Ÿæˆimiæ–‡ä»¶\nmvn idea:module ä¸ºä»€ä¹ˆè¦åˆ†æ¨¡å—è®¾è®¡ï¼Ÿ æ–¹ä¾¿é¡¹ç›®çš„ç®¡ç†ç»´æŠ¤ï¼Œæ‰©å±•ï¼Œä¹Ÿæ–¹ä¾¿æ¨¡å—é—´çš„ç›¸äº’è°ƒç”¨ï¼Œèµ„æºå…±äº«ã€‚\næ³¨æ„äº‹é¡¹ åˆ†æ¨¡å—è®¾è®¡éœ€è¦å…ˆé’ˆå¯¹æ¨¡å—åŠŸèƒ½è¿›è¡Œè®¾è®¡ï¼Œå†è¿›è¡Œç¼–ç ã€‚ä¸ä¼šå…ˆå°†å·¥ç¨‹å¼€å‘å®Œæ¯•ï¼Œç„¶åè¿›è¡Œæ‹†åˆ†ã€‚ ç»§æ‰¿å…³ç³»å®ç° å¸¸è§æ‰“åŒ…æ–¹å¼ï¼š\njarï¼šæ™®é€šæ¨¡å—æ‰“åŒ…ï¼Œspringbooté¡¹ç›®åŸºæœ¬éƒ½æ˜¯jaråŒ…ï¼ˆå†…åµŒtomcatè¿è¡Œï¼‰ warï¼šæ™®é€šwebç¨‹åºæ‰“åŒ…ï¼Œéœ€è¦éƒ¨ç½²åœ¨å¤–éƒ¨çš„tomcatæœåŠ¡å™¨ä¸Š pomï¼šçˆ¶å·¥ç¨‹æˆ–èšåˆå·¥ç¨‹ï¼Œè¯¥æ¨¡å—ä¸å†™ä»£ç ï¼Œä»…è¿›è¡Œä¾èµ–ç®¡ç† æ­¥éª¤:\nåˆ›å»ºmavenæ¨¡å— tlias-parentï¼Œè¯¥å·¥ç¨‹ä¸ºçˆ¶å·¥ç¨‹ï¼Œ è®¾ç½®æ‰“åŒ…æ–¹å¼pom\n\u0026lt;!-- è®¾ç½®springå·¥ç¨‹çš„çˆ¶å·¥ç¨‹--\u0026gt; \u0026lt;parent\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.boot\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-boot-starter-parent\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;3.2.6\u0026lt;/version\u0026gt; \u0026lt;relativePath/\u0026gt; \u0026lt;!-- lookup parent from repository --\u0026gt; \u0026lt;/parent\u0026gt; \u0026lt;groupId\u0026gt;com.showguan\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;tlias-parent\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.0-SNAPSHOT\u0026lt;/version\u0026gt; \u0026lt;!-- è®¾ç½®æ‰“åŒ…æ–¹å¼--\u0026gt; \u0026lt;packaging\u0026gt;pom\u0026lt;/packaging\u0026gt; åœ¨å­å·¥ç¨‹çš„pom.xmlæ–‡ä»¶ä¸­ï¼Œé…ç½®ç»§æ‰¿å…³ç³»\n\u0026lt;parent\u0026gt; \u0026lt;groupId\u0026gt;com.showguan\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;tlias-parent\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.0-SNAPSHOT\u0026lt;/version\u0026gt; \u0026lt;relativePath\u0026gt;../tlias-parent/pom.xml\u0026lt;/relativePath\u0026gt; \u0026lt;/parent\u0026gt; æ³¨æ„äº‹é¡¹ï¼š\nåœ¨å­å·¥ç¨‹ä¸­ï¼Œé…ç½®äº†ç»§æ‰¿å…³ç³»ä¹‹åï¼Œåæ ‡ä¸­çš„groupidæ˜¯å¯ä»¥çœç•¥çš„ï¼Œå› ä¸ºä¼šè‡ªåŠ¨ç»§æ‰¿çˆ¶å·¥ç¨‹çš„ã€‚ relativePathæŒ‡å®šçˆ¶å·¥ç¨‹çš„pomæ–‡ä»¶çš„ç›¸å¯¹ä½ç½®ï¼ˆå¦‚æœä¸æŒ‡å®šï¼Œå°†ä»æœ¬åœ°ä»“åº“/è¿œç¨‹ä»“åº“æŸ¥æ‰¾è¯¥å·¥ç¨‹ï¼‰ã€‚ åœ¨çˆ¶å·¥ç¨‹ä¸­é…ç½®å„ä¸ªå·¥ç¨‹å…±æœ‰çš„ä¾èµ–ï¼ˆå­å·¥ç¨‹ä¼šè‡ªåŠ¨ç»§æ‰¿çˆ¶å·¥ç¨‹çš„ä¾èµ–ï¼‰\n\u0026lt;dependencies\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.projectlombok\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;lombok\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;/dependencies\u0026gt; è‹¥çˆ¶å­å·¥ç¨‹éƒ½é…ç½®äº†åŒä¸€ä¸ªä¾èµ–ï¼Œä»¥å­å·¥ç¨‹çš„ä¾èµ–ä¸ºå‡†ã€‚ ç‰ˆæœ¬é”å®š åœ¨mavenä¸­ï¼Œå¯ä»¥åœ¨çˆ¶å·¥ç¨‹çš„pomæ–‡ä»¶ä¸­ é€šè¿‡ \u0026lt;dependencyManagement\u0026gt; æ¥ç»Ÿä¸€ç®¡ç†ä¾èµ–ç‰ˆæœ¬ çˆ¶å·¥ç¨‹ï¼š\n\u0026lt;properties\u0026gt; \u0026lt;jjwt.version\u0026gt;0.9.1\u0026lt;/jjwt.version\u0026gt; \u0026lt;/properties\u0026gt; \u0026lt;dependencyManagement\u0026gt; \u0026lt;dependencies\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;io.jsonwebtoken\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;jjwt\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;${jjwt.version}\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependencies\u0026gt; \u0026lt;dependencyManagement\u0026gt; å­å·¥ç¨‹ï¼ˆä»éœ€å¼•å…¥ä¾èµ–ï¼Œä½†æ˜¯ä¸éœ€è¦ç‰ˆæœ¬å·ï¼‰ï¼š\n\u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;io.jsonwebtoken\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;jjwt\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; æ³¨æ„äº‹é¡¹ï¼š\nå­å·¥ç¨‹å¼•å…¥ä¾èµ–æ—¶ï¼Œæ— éœ€æŒ‡å®š\u0026lt;version\u0026gt;ç‰ˆæœ¬å·ï¼Œçˆ¶å·¥ç¨‹ç»Ÿä¸€ç®¡ç†ï¼Œå˜æ›´ä¾èµ–ç‰ˆæœ¬ï¼Œåªéœ€è¦çˆ¶å·¥ç¨‹ä¸­ç»Ÿä¸€å˜æ›´ã€‚ èšåˆ å°†å¤šä¸ªæ¨¡å—ç»„ç»‡æˆä¸€ä¸ªæ•´ä½“ï¼ŒåŒæ—¶è¿›è¡Œé¡¹ç›®çš„æ„å»º\nèšåˆå·¥ç¨‹ ä¸€ä¸ªä¸å…·æœ‰ä¸šåŠ¡åŠŸèƒ½çš„\u0026quot;ç©º\u0026quot;å·¥ç¨‹ï¼ˆæœ‰ä¸”ä»…æœ‰ä¸€ä¸ªpomæ–‡ä»¶\nä½œç”¨ï¼šå¿«é€Ÿæ„å»ºé¡¹ç›®ï¼ˆæ— éœ€æ ¹æ®ä¾èµ–å…³ç³»æ‰‹åŠ¨æ„å»ºï¼Œç›´æ¥åœ¨èšåˆå·¥ç¨‹ä¸Šæ„å»ºå³å¯ï¼‰\nåœ¨parent çš„pom.xmlæ–‡ä»¶å†…æ·»åŠ \n\u0026lt;modules\u0026gt; \u0026lt;module\u0026gt;../tlias-pojo\u0026lt;/module\u0026gt; \u0026lt;module\u0026gt;../tlias-utils\u0026lt;/module\u0026gt; \u0026lt;module\u0026gt;../tlias-web-management\u0026lt;/module\u0026gt; \u0026lt;/modules\u0026gt; èšåˆå’Œç»§æ‰¿ï¼š\nä½œç”¨ èšåˆç”¨äºå¿«é€Ÿæ„å»ºé¡¹ç›® ç»§æ‰¿ç”¨äºç®€åŒ–ä¾èµ–é…ç½®ã€ç»Ÿä¸€ç®¡ç†ä¾èµ– ç›¸åŒç‚¹ èšåˆä¸ç»§æ‰¿çš„pom.xmlæ–‡ä»¶æ‰“åŒ…æ–¹å¼å‡ä¸ºpomï¼Œ å¯ä»¥å°†ä¸¤ç§å…³ç³»åˆ¶ä½œåˆ°åŒä¸€ä¸ªpomæ–‡ä»¶ä¸­ èšåˆä¸ç»§æ‰¿å‡å±äºè®¾è®¡å‹æ¨¡å—ï¼Œå¹¶æ— å®é™…çš„æ¨¡å—å†…å®¹ ä¸åŒç‚¹ èšåˆæ˜¯åœ¨èšåˆå·¥ç¨‹ä¸­é…ç½®å…³ç³»ï¼Œèšåˆå¯ä»¥æ„ŸçŸ¥åˆ°å‚ä¸èšåˆçš„æ¨¡å—æœ‰å“ªäº› ç»§æ‰¿æ˜¯åœ¨å­æ¨¡å—ä¸­é…ç½®å…³ç³»ï¼Œçˆ¶æ¨¡å—æ— æ³•æ„ŸçŸ¥å“ªäº›å­æ¨¡å—ç»§æ‰¿äº†è‡ªå·± ç§æœ ç§æœæ˜¯ä¸€ç§ç‰¹æ®Šçš„ä»“åº“ï¼Œå®ƒæ˜¯æ¶è®¾åœ¨å±€åŸŸç½‘å†…çš„ä»“åº“æœåŠ¡ï¼Œç”¨æ¥ä»£ç†ä½äºå¤–éƒ¨çš„ä¸­å¤®ä»“åº“ï¼Œç”¨äºè§£å†³å›¢é˜Ÿå†…éƒ¨çš„èµ„æºå…±äº«å’Œèµ„æºåŒæ­¥é—®é¢˜ã€‚ èµ„æºä¸Šä¼ ä¸ä¸‹è½½\né¡¹ç›®ç‰ˆæœ¬ï¼š\n\u0026lt;artifactId\u0026gt;tlias-web-management\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;0.0.1-SNAPSHOT\u0026lt;/version\u0026gt; \u0026lt;name\u0026gt;tilas-web-management\u0026lt;/name\u0026gt; \u0026lt;description\u0026gt;tilas-web-management\u0026lt;/description\u0026gt; RELEASEï¼ˆå‘è¡Œç‰ˆæœ¬ï¼‰ï¼šåŠŸèƒ½è¶‹äºç¨³å®šï¼Œå½“å‰æ›´æ–°åœæ­¢ï¼Œå¯ä»¥ç”¨äºå‘è¡Œçš„ç‰ˆæœ¬ï¼Œå­˜å‚¨åœ¨ç§æœä¸­çš„RELEASEä»“åº“ä¸­ã€‚ SNAPSHOTï¼ˆå¿«ç…§ç‰ˆæœ¬ï¼‰ï¼šåŠŸèƒ½ä¸ç¨³å®šï¼Œå°šå¤„äºå¼€å‘ä¸­çš„ç‰ˆæœ¬ï¼Œå³å¿«ç…§ç‰ˆæœ¬ï¼Œå­˜å‚¨åœ¨ç§æœçš„SNAPSHOTä»“åº“ä¸­ã€‚ ","permalink":"https://kennems.github.io/posts/tech/java-web%E5%BC%80%E5%8F%917/","summary":"Java Webå¼€å‘(7) SpringåŸç† é…ç½®ä¼˜å…ˆçº§ SpringBootä¸­æ”¯æŒä¸‰ç§æ ¼å¼é…ç½®æ–‡ä»¶çš„ä¼˜å…ˆçº§ properties yaml yml é…ç½® SpringBooté™¤äº†æ”¯æŒé…ç½®æ–‡ä»¶","title":"Java Webå¼€å‘(7)"},{"content":"é¢ç»ï¼ˆ1ï¼‰ å…«è‚¡åˆ†ä¸ºï¼šåŸºç¡€çŸ¥è¯†ï¼Œåº•å±‚åŸç†ï¼Œåœºæ™¯åº”ç”¨\nåŸºç¡€çŸ¥è¯†ï¼šjavaguide, æ­»è®°ç¡¬èƒŒï¼Œæ€ç»´å¯¼å›¾ åº•å±‚åŸç†ï¼šå…«è‚¡åˆé›†ï¼Œé¢ç»+GPT+æ•´ç† åœºæ™¯åº”ç”¨ï¼šé¢ç»+ç§¯ç´¯ 20240611 é¢å‘é¢ç»èƒŒå…«è‚¡ï¼Œå°ç±³é¢ç»\nå°ç±³ä¸€é¢é¢ç» è‡ªæˆ‘ä»‹ç»ï¼ˆé¡¹ç›®ç»å†å’Œå®ä¹ ç»å†ï¼‰ åœ¨è‡ªæˆ‘ä»‹ç»æ—¶ï¼Œå¯ä»¥ç®€è¦ä»‹ç»è‡ªå·±çš„æ•™è‚²èƒŒæ™¯ã€å·¥ä½œç»å†ã€ä¸»è¦æŠ€èƒ½å’Œé¡¹ç›®ç»å†ã€‚ç€é‡çªå‡ºåœ¨é¡¹ç›®ä¸­çš„å…·ä½“èŒè´£å’Œè´¡çŒ®ï¼Œä»¥åŠæ‰€ä½¿ç”¨çš„æŠ€æœ¯å’Œå–å¾—çš„æˆæœã€‚\n1. Javaçš„åŸºæœ¬æ•°æ®ç±»å‹ Javaæœ‰8ç§åŸºæœ¬æ•°æ®ç±»å‹ï¼š\nbyte: 8ä½ï¼ŒèŒƒå›´æ˜¯ -128 åˆ° 127 short: 16ä½ï¼ŒèŒƒå›´æ˜¯ -32,768 åˆ° 32,767 int: 32ä½ï¼ŒèŒƒå›´æ˜¯ -2^31 åˆ° 2^31-1 long: 64ä½ï¼ŒèŒƒå›´æ˜¯ -2^63 åˆ° 2^63-1 float: 32ä½ï¼Œå•ç²¾åº¦æµ®ç‚¹æ•° double: 64ä½ï¼ŒåŒç²¾åº¦æµ®ç‚¹æ•° char: 16ä½ï¼Œæ— ç¬¦å· Unicode å­—ç¬¦ boolean: åªæœ‰ä¸¤ä¸ªå€¼ï¼štrue å’Œ false 2. äº†è§£å“ªäº›åŸºæœ¬çš„æ•°æ®ç»“æ„ å¸¸è§çš„æ•°æ®ç»“æ„åŒ…æ‹¬ï¼š\næ•°ç»„ é“¾è¡¨ï¼ˆå•é“¾è¡¨ã€åŒé“¾è¡¨ï¼‰ æ ˆ é˜Ÿåˆ—ï¼ˆæ™®é€šé˜Ÿåˆ—ã€ä¼˜å…ˆé˜Ÿåˆ—ã€å¾ªç¯é˜Ÿåˆ—ï¼‰ å“ˆå¸Œè¡¨ æ ‘ï¼ˆå¦‚äºŒå‰æ ‘ã€çº¢é»‘æ ‘ã€Bæ ‘ã€B+æ ‘ï¼‰ å›¾ï¼ˆæœ‰å‘å›¾ã€æ— å‘å›¾ï¼‰ å †ï¼ˆå¦‚äºŒå‰å †ã€æ–æ³¢é‚£å¥‘å †ï¼‰ 3. ç®€å•ä»‹ç»äºŒå‰æ ‘ äºŒå‰æ ‘æ˜¯ä¸€ç§æ ‘å½¢æ•°æ®ç»“æ„ï¼Œå…¶ä¸­æ¯ä¸ªèŠ‚ç‚¹æœ€å¤šæœ‰ä¸¤ä¸ªå­èŠ‚ç‚¹ï¼Œåˆ†åˆ«ç§°ä¸ºå·¦å­èŠ‚ç‚¹å’Œå³å­èŠ‚ç‚¹ã€‚å¸¸è§çš„äºŒå‰æ ‘ç±»å‹æœ‰ï¼š\nå®Œå…¨äºŒå‰æ ‘ï¼šé™¤äº†æœ€åä¸€å±‚ï¼Œæ‰€æœ‰å±‚çš„èŠ‚ç‚¹éƒ½å¡«æ»¡ï¼Œæœ€åä¸€å±‚çš„èŠ‚ç‚¹éƒ½é å·¦å¯¹é½ã€‚ æ»¡äºŒå‰æ ‘ï¼šæ¯ä¸ªèŠ‚ç‚¹è¦ä¹ˆæ˜¯å¶å­èŠ‚ç‚¹ï¼Œè¦ä¹ˆæœ‰ä¸¤ä¸ªå­èŠ‚ç‚¹ã€‚ äºŒå‰æœç´¢æ ‘ï¼šå¯¹äºæ¯ä¸ªèŠ‚ç‚¹ï¼Œå…¶å·¦å­èŠ‚ç‚¹çš„å€¼å°äºè¯¥èŠ‚ç‚¹çš„å€¼ï¼Œå…¶å³å­èŠ‚ç‚¹çš„å€¼å¤§äºè¯¥èŠ‚ç‚¹çš„å€¼ã€‚ 4. çŸ¥é“MySQLå—ï¼ŸMySQLä¸­è·ŸäºŒå‰æ ‘ç›¸å…³çš„ç»“æ„ä½ çŸ¥é“å—ï¼Ÿ åœ¨MySQLä¸­ï¼Œç´¢å¼•ç»“æ„ä¸äºŒå‰æ ‘ç›¸å…³çš„æ˜¯Bæ ‘å’ŒB+æ ‘ã€‚Bæ ‘æ˜¯ä¸€ç§è‡ªå¹³è¡¡çš„å¤šè·¯æœç´¢æ ‘ï¼ŒB+æ ‘æ˜¯Bæ ‘çš„ä¸€ç§æ”¹è¿›ç‰ˆï¼Œæ‰€æœ‰çš„å¶å­èŠ‚ç‚¹å½¢æˆä¸€ä¸ªæœ‰åºé“¾è¡¨ã€‚MySQLçš„InnoDBå­˜å‚¨å¼•æ“ä½¿ç”¨B+æ ‘æ¥å®ç°ç´¢å¼•ã€‚\n5. å±•å¼€è¯´è¯´Bæ ‘å’ŒB+æ ‘ Bæ ‘ï¼šä¸€ç§è‡ªå¹³è¡¡çš„å¤šè·¯æœç´¢æ ‘ï¼ŒèŠ‚ç‚¹å¯ä»¥æœ‰å¤šä¸ªå­èŠ‚ç‚¹ã€‚æ‰€æœ‰å¶å­èŠ‚ç‚¹çš„æ·±åº¦ç›¸åŒï¼ŒèŠ‚ç‚¹ä¸­çš„å…ƒç´ æŒ‰é¡ºåºæ’åˆ—ã€‚ B+æ ‘ï¼šBæ ‘çš„æ”¹è¿›ç‰ˆï¼Œéå¶å­èŠ‚ç‚¹ä¸å­˜å‚¨æ•°æ®ï¼Œåªå­˜å‚¨ç´¢å¼•ï¼Œæ‰€æœ‰æ•°æ®éƒ½å­˜å‚¨åœ¨å¶å­èŠ‚ç‚¹ä¸­ã€‚å¶å­èŠ‚ç‚¹ä¹‹é—´å½¢æˆä¸€ä¸ªæœ‰åºé“¾è¡¨ï¼Œæ–¹ä¾¿èŒƒå›´æŸ¥è¯¢ã€‚ 6. MySQLä¸­ç°åœ¨ä¸»è¦ç”¨Bæ ‘è¿˜æ˜¯B+æ ‘ï¼ŸB+æ ‘çš„ä¼˜åŠ¿ï¼Ÿ MySQLä¸­çš„InnoDBå­˜å‚¨å¼•æ“ä¸»è¦ä½¿ç”¨B+æ ‘ã€‚B+æ ‘çš„ä¼˜åŠ¿åŒ…æ‹¬ï¼š\næ‰€æœ‰æ•°æ®éƒ½åœ¨å¶å­èŠ‚ç‚¹ï¼ŒæŸ¥è¯¢æ•ˆç‡é«˜ å¶å­èŠ‚ç‚¹å½¢æˆæœ‰åºé“¾è¡¨ï¼Œæ–¹ä¾¿èŒƒå›´æŸ¥è¯¢ éå¶å­èŠ‚ç‚¹åªå­˜å‚¨ç´¢å¼•ï¼Œå‡å°‘äº†æ ‘çš„é«˜åº¦ï¼Œæé«˜äº†æŸ¥è¯¢æ•ˆç‡ 7. Redisçš„åŸºæœ¬ç±»å‹ Redisæ”¯æŒä»¥ä¸‹åŸºæœ¬æ•°æ®ç±»å‹ï¼š\nå­—ç¬¦ä¸²ï¼ˆStringï¼‰ åˆ—è¡¨ï¼ˆListï¼‰ é›†åˆï¼ˆSetï¼‰ æœ‰åºé›†åˆï¼ˆSorted Setï¼‰ å“ˆå¸Œï¼ˆHashï¼‰ 8. Redisä¸­Setå’ŒSorted Setçš„åŒºåˆ« Setï¼šæ— åºé›†åˆï¼Œä¸å…è®¸é‡å¤å…ƒç´ ï¼Œæ“ä½œæ—¶é—´å¤æ‚åº¦ä¸ºO(1)ã€‚ Sorted Setï¼šæœ‰åºé›†åˆï¼Œæ¯ä¸ªå…ƒç´ éƒ½ä¼šå…³è”ä¸€ä¸ªåˆ†æ•°ï¼ŒRedisé€šè¿‡åˆ†æ•°è¿›è¡Œæ’åºï¼Œæ“ä½œæ—¶é—´å¤æ‚åº¦ä¸ºO(log N)ã€‚ 9. æœ‰äº†è§£è¿‡JVMæ–¹é¢çš„çŸ¥è¯†å—ï¼Ÿåƒåœ¾å›æ”¶ JVMï¼ˆJavaè™šæ‹Ÿæœºï¼‰æ˜¯Javaç¨‹åºè¿è¡Œçš„åŸºç¡€ï¼Œè´Ÿè´£å†…å­˜ç®¡ç†å’Œåƒåœ¾å›æ”¶ã€‚åƒåœ¾å›æ”¶æœºåˆ¶ï¼ˆGCï¼‰ä¸»è¦æœ‰ä»¥ä¸‹å‡ ç§ç®—æ³•ï¼š\næ ‡è®°-æ¸…é™¤ï¼ˆMark-Sweepï¼‰ æ ‡è®°-æ•´ç†ï¼ˆMark-Compactï¼‰ å¤åˆ¶ï¼ˆCopyingï¼‰ åˆ†ä»£æ”¶é›†ï¼ˆGenerational Collectingï¼‰ï¼šå¹´è½»ä»£ï¼ˆYoung Generationï¼‰å’Œè€å¹´ä»£ï¼ˆOld Generationï¼‰åˆ†åˆ«é‡‡ç”¨ä¸åŒçš„GCç®—æ³•ã€‚ 10. TCPé€šè¿‡ä»€ä¹ˆæ¥ä¿è¯å¯é ä¼ è¾“çš„ï¼Ÿ TCPé€šè¿‡ä»¥ä¸‹æœºåˆ¶ä¿è¯å¯é ä¼ è¾“ï¼š\nä¸‰æ¬¡æ¡æ‰‹å»ºç«‹è¿æ¥ åºåˆ—å·å’Œç¡®è®¤å· æ»‘åŠ¨çª—å£ è¶…æ—¶é‡ä¼  æµé‡æ§åˆ¶ æ‹¥å¡æ§åˆ¶ 11. ç»†è¯´ä¸‰æ¬¡æ¡æ‰‹ã€å››æ¬¡æŒ¥æ‰‹ ä¸‰æ¬¡æ¡æ‰‹ï¼š\nå®¢æˆ·ç«¯å‘é€SYNåŒ…ï¼ˆåŒæ­¥åºåˆ—ç¼–å·ï¼‰è¯·æ±‚å»ºç«‹è¿æ¥ã€‚ æœåŠ¡å™¨æ¥æ”¶åˆ°SYNåŒ…ï¼Œè¿”å›ä¸€ä¸ªSYN+ACKåŒ…è¡¨ç¤ºåŒæ„å»ºç«‹è¿æ¥ã€‚ å®¢æˆ·ç«¯æ”¶åˆ°SYN+ACKåŒ…ï¼Œå›å¤ä¸€ä¸ªACKåŒ…ï¼Œè¿æ¥å»ºç«‹æˆåŠŸã€‚ å››æ¬¡æŒ¥æ‰‹ï¼š\nå®¢æˆ·ç«¯å‘é€FINåŒ…ï¼ˆç»“æŸè¿æ¥ï¼‰è¯·æ±‚æ–­å¼€è¿æ¥ã€‚ æœåŠ¡å™¨æ¥æ”¶åˆ°FINåŒ…ï¼Œè¿”å›ä¸€ä¸ªACKåŒ…ï¼Œè¡¨ç¤ºç¡®è®¤æ–­å¼€è¿æ¥è¯·æ±‚ã€‚ æœåŠ¡å™¨å‘é€FINåŒ…è¯·æ±‚æ–­å¼€è¿æ¥ã€‚ å®¢æˆ·ç«¯æ”¶åˆ°FINåŒ…ï¼Œè¿”å›ä¸€ä¸ªACKåŒ…ï¼Œè¿æ¥æ–­å¼€ã€‚ ã€Œæ‰‹æ’•ã€ é“¾è¡¨ç›¸å…³ å°†é“¾è¡¨è½¬æˆæ•°å­—ï¼Œç›¸åŠ ä¹‹åå†è½¬æˆé“¾è¡¨ã€‚ç¤ºä¾‹ï¼š\nè¾“å…¥ï¼šé“¾è¡¨ä¸€ï¼š1-\u0026gt;6-\u0026gt;3ï¼Œé“¾è¡¨äºŒï¼š7-\u0026gt;1-\u0026gt;2 ç›¸å½“äº361 + 217 = 578 è¾“å‡ºï¼š8-\u0026gt;7-\u0026gt;5 class ListNode { int val; ListNode next; ListNode(int x) { val = x; } } public class Solution { public ListNode addTwoNumbers(ListNode l1, ListNode l2) { ListNode dummyHead = new ListNode(0); ListNode p = l1, q = l2, curr = dummyHead; int carry = 0; while (p != null || q != null) { int x = (p != null) ? p.val : 0; int y = (q != null) ? q.val : 0; int sum = carry + x + y; carry = sum / 10; curr.next = new ListNode(sum % 10); curr = curr.next; if (p != null) p = p.next; if (q != null) q = q.next; } if (carry \u0026gt; 0) { curr.next = new ListNode(carry); } return dummyHead.next; } } ã€Œç»§ç»­QAã€ 1. æ‰‹æ’•è¿™ä¸ªç®—æ³•çš„æ—¶é—´å¤æ‚åº¦ ä¸Šè¿°ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦æ˜¯O(max(m, n))ï¼Œå…¶ä¸­må’Œnåˆ†åˆ«æ˜¯ä¸¤ä¸ªé“¾è¡¨çš„é•¿åº¦ã€‚å› ä¸ºéœ€è¦éå†ä¸¤ä¸ªé“¾è¡¨çš„æ¯ä¸€ä¸ªèŠ‚ç‚¹ã€‚\n2. å¦‚æœèƒ½å®ä¹ ï¼Œæ¯å‘¨å‡ å¤©ã€å®ä¹ å‘¨æœŸï¼Ÿ æ ¹æ®ä¸ªäººæƒ…å†µå›ç­”ï¼Œå¯ä»¥è¯´å‡ºæ¯å‘¨å¯ä»¥å®ä¹ çš„å¤©æ•°å’Œå¸Œæœ›çš„å®ä¹ å‘¨æœŸé•¿åº¦ã€‚ä¾‹å¦‚ï¼š\næ¯å‘¨3-5å¤© å®ä¹ å‘¨æœŸä¸º3-6ä¸ªæœˆ å‚è€ƒèµ„æ–™ ç‰›å®¢ç½‘ï¼šhttps://www.nowcoder.com/feed/main/detail/61f2b3801d6b42d4b39adcf461b784b5?sourceSSR=users å°ç±³äºŒé¢é¢ç» #é¢ç» ã€ŒQAã€\nMyBatis å…·ä½“æ˜¯å¹²ä»€ä¹ˆç”¨çš„ï¼Ÿåœ¨ä½¿ç”¨å®ƒä¹‹å‰å¯èƒ½ä¼šé‡åˆ°ä»€ä¹ˆé—®é¢˜ï¼Œä½¿ç”¨å®ƒä¹‹åä¼šç»™ä½ çš„é¡¹ç›®å¸¦æ¥ä»€ä¹ˆä¾¿åˆ©ï¼Ÿ é¡¹ç›®ä¸­æœ‰æ²¡æœ‰ç”¨åˆ°çº¿ç¨‹æ± ï¼Ÿ MyBatis ä¸­æ¶‰åŠåˆ°åŠ¨æ€ sqlï¼Œsql çš„æ ‡ç­¾èƒ½è¯´å‡ ä¸ªå— MyBatis èƒ½æ‰§è¡Œä¸€å¯¹ä¸€æˆ–è€…ä¸€å¯¹å¤šå…³è”çš„æŸ¥è¯¢å—ï¼Ÿæœ‰å“ªäº›å®ç°æ–¹å¼ï¼Ÿ SpringBoot ä¸­ï¼Œè¯»å–é…ç½®çš„æ—¶å€™æœ‰å“ªäº›æ–¹å¼ï¼Ÿ Integer å¯¹è±¡å’ŒåŸºæœ¬æ•°æ®ç±»å‹ intï¼Œå“ªä¸ªå ç”¨æ›´å¤šçš„å†…å­˜ ArrayList å’Œ LinkedList çš„åŒºåˆ« å¯¹è±¡çš„æµ…æ‹·è´å’Œæ·±æ‹·è´ äº†è§£å“ªäº›è®¾è®¡æ¨¡å¼ï¼Ÿ (é€æ¸ç¦»è°±äº†èµ·æ¥)ï¼štensorflow æ˜¯ç”¨æ¥å¹²å˜›çš„ è§£é‡Šä¸€ä¸‹ softmax (èŠæˆ‘çš„ç§‘ç ”é¡¹ç›®é‡Œ) å¸¸ç”¨çš„å¼ºåŒ–å­¦ä¹ ç®—æ³• ä¸ºä»€ä¹ˆç”¨ PPO ç®—æ³•ä¸ç”¨ DQN ç®—æ³•ï¼Ÿ ä¸ºä»€ä¹ˆä¸ç”¨ A3C ç®—æ³•ï¼Ÿ è®²è®² Transformerâ€¦â€¦ ã€Œæ‰‹æ’•ã€\nå¾ˆç®€å•çš„æ•°ç»„é¢˜ 2min åšå®Œ åè½¬é“¾è¡¨ II åŠ›æ‰£ 92 é¢˜ï¼ˆå†™è¿‡ä½†å¿˜äº† å•Šå•Šå•Šå•Šå•Šå•Šï¼‰ å¥½çš„ï¼Œä»¥ä¸‹æ˜¯å¯¹è¿™äº›é¢è¯•é—®é¢˜çš„è¯¦ç»†å›ç­”ï¼š\n1. MyBatis å…·ä½“æ˜¯å¹²ä»€ä¹ˆç”¨çš„ï¼Ÿåœ¨ä½¿ç”¨å®ƒä¹‹å‰å¯èƒ½ä¼šé‡åˆ°ä»€ä¹ˆé—®é¢˜ï¼Œä½¿ç”¨å®ƒä¹‹åä¼šç»™ä½ çš„é¡¹ç›®å¸¦æ¥ä»€ä¹ˆä¾¿åˆ©ï¼Ÿ MyBatis æ˜¯ä¸€æ¬¾ä¼˜ç§€çš„æŒä¹…å±‚æ¡†æ¶ï¼Œå®ƒæ”¯æŒå®šåˆ¶åŒ– SQLã€å­˜å‚¨è¿‡ç¨‹ä»¥åŠé«˜çº§æ˜ å°„ã€‚MyBatis é¿å…äº†å‡ ä¹æ‰€æœ‰çš„ JDBC ä»£ç å’Œæ‰‹åŠ¨è®¾ç½®å‚æ•°ä»¥åŠè·å–ç»“æœé›†ã€‚ä½¿ç”¨å‰å¯èƒ½é‡åˆ°çš„é—®é¢˜åŒ…æ‹¬ï¼š\nå­¦ä¹ æ›²çº¿ï¼šéœ€è¦èŠ±æ—¶é—´å­¦ä¹ å’Œç†è§£ MyBatis çš„é…ç½®å’Œä½¿ç”¨æ–¹å¼ã€‚ é…ç½®å¤æ‚æ€§ï¼šéœ€è¦é…ç½® XML æ–‡ä»¶æˆ–æ³¨è§£ï¼ŒåˆæœŸé…ç½®è¾ƒå¤æ‚ã€‚ ä½¿ç”¨ä¹‹åçš„ä¾¿åˆ©åŒ…æ‹¬ï¼š é™ä½äº†ç›´æ¥ä½¿ç”¨ JDBC çš„å¤æ‚æ€§ï¼Œæé«˜å¼€å‘æ•ˆç‡ã€‚ æ”¯æŒåŠ¨æ€ SQLï¼Œçµæ´»æ€§é«˜ã€‚ æ”¯æŒé«˜çº§æ˜ å°„ï¼Œå¯ä»¥æ–¹ä¾¿åœ°å°†æŸ¥è¯¢ç»“æœæ˜ å°„ä¸º Java å¯¹è±¡ã€‚ 2. é¡¹ç›®ä¸­æœ‰æ²¡æœ‰ç”¨åˆ°çº¿ç¨‹æ± ï¼Ÿ çº¿ç¨‹æ± ç”¨äºç®¡ç†å’Œå¤ç”¨å¤šä¸ªçº¿ç¨‹ï¼Œé¿å…é¢‘ç¹åˆ›å»ºå’Œé”€æ¯çº¿ç¨‹å¸¦æ¥çš„å¼€é”€ï¼Œæé«˜ç³»ç»Ÿæ€§èƒ½ã€‚å¸¸ç”¨çš„çº¿ç¨‹æ± æœ‰ï¼š\nExecutors.newFixedThreadPool(int n): å›ºå®šå¤§å°çš„çº¿ç¨‹æ± ã€‚ Executors.newCachedThreadPool(): å¯ç¼“å­˜çš„çº¿ç¨‹æ± ã€‚ Executors.newScheduledThreadPool(int n): æ”¯æŒå®šæ—¶å’Œå‘¨æœŸæ€§ä»»åŠ¡çš„çº¿ç¨‹æ± ã€‚ Executors.newSingleThreadExecutor(): å•çº¿ç¨‹æ± ã€‚ 3. MyBatis ä¸­æ¶‰åŠåˆ°åŠ¨æ€ sqlï¼Œsql çš„æ ‡ç­¾èƒ½è¯´å‡ ä¸ªå— MyBatis ä¸­çš„åŠ¨æ€ SQL æ ‡ç­¾åŒ…æ‹¬ï¼š\n\u0026lt;if\u0026gt;: æ ¹æ®æ¡ä»¶æ˜¯å¦åŒ…å«æŸæ®µ SQLã€‚ \u0026lt;choose\u0026gt;: ç±»ä¼¼ switch è¯­å¥ï¼ŒåŒ…å« \u0026lt;when\u0026gt; å’Œ \u0026lt;otherwise\u0026gt;ã€‚ \u0026lt;where\u0026gt;: è‡ªåŠ¨å¤„ç† AND/OR é€»è¾‘ã€‚ \u0026lt;set\u0026gt;: ç”¨äºåŠ¨æ€æ›´æ–°è¯­å¥ã€‚ \u0026lt;foreach\u0026gt;: ç”¨äºéå†é›†åˆç”ŸæˆåŠ¨æ€ SQLã€‚ \u0026lt;trim\u0026gt;: è‡ªå®šä¹‰ SQL ç‰‡æ®µã€‚ 4. MyBatis èƒ½æ‰§è¡Œä¸€å¯¹ä¸€æˆ–è€…ä¸€å¯¹å¤šå…³è”çš„æŸ¥è¯¢å—ï¼Ÿæœ‰å“ªäº›å®ç°æ–¹å¼ï¼Ÿ MyBatis å¯ä»¥æ‰§è¡Œä¸€å¯¹ä¸€æˆ–ä¸€å¯¹å¤šçš„å…³è”æŸ¥è¯¢ã€‚å®ç°æ–¹å¼åŒ…æ‹¬ï¼š\nä½¿ç”¨ resultMap è¿›è¡Œç»“æœæ˜ å°„ï¼Œå®šä¹‰å…³è”å…³ç³»ã€‚ åœ¨ SQL ä¸­ä½¿ç”¨ JOIN è¯­å¥è¿›è¡Œå…³è”æŸ¥è¯¢ã€‚ ä½¿ç”¨ association å’Œ collection æ ‡ç­¾å®ç°ä¸€å¯¹ä¸€å’Œä¸€å¯¹å¤šæ˜ å°„ã€‚ 5. SpringBoot ä¸­ï¼Œè¯»å–é…ç½®çš„æ—¶å€™æœ‰å“ªäº›æ–¹å¼ï¼Ÿ SpringBoot è¯»å–é…ç½®çš„æ–¹å¼åŒ…æ‹¬ï¼š\n@Value: æ³¨å…¥å•ä¸ªé…ç½®å±æ€§ã€‚ @ConfigurationProperties: æ‰¹é‡æ³¨å…¥é…ç½®å±æ€§ã€‚ Environment å¯¹è±¡ï¼šé€šè¿‡ environment.getProperty æ–¹æ³•è·å–é…ç½®ã€‚ @PropertySource: åŠ è½½è‡ªå®šä¹‰é…ç½®æ–‡ä»¶ã€‚ application.properties æˆ– application.yml: é»˜è®¤é…ç½®æ–‡ä»¶ã€‚ 6. Integer å¯¹è±¡å’ŒåŸºæœ¬æ•°æ®ç±»å‹ intï¼Œå“ªä¸ªå ç”¨æ›´å¤šçš„å†…å­˜ Integer å¯¹è±¡å ç”¨çš„å†…å­˜æ›´å¤šã€‚int æ˜¯åŸºæœ¬æ•°æ®ç±»å‹ï¼Œç›´æ¥å­˜å‚¨æ•°å€¼ï¼Œå ç”¨ 4 ä¸ªå­—èŠ‚ã€‚è€Œ Integer æ˜¯åŒ…è£…ç±»ï¼Œé™¤äº†å­˜å‚¨æ•°å€¼å¤–ï¼Œè¿˜åŒ…å«å¯¹è±¡å¤´ä¿¡æ¯ï¼Œè‡³å°‘å ç”¨ 16 ä¸ªå­—èŠ‚ï¼ˆå…·ä½“æ ¹æ® JVM å®ç°å’Œå¯¹è±¡å¤´ä¿¡æ¯æœ‰æ‰€ä¸åŒï¼‰ã€‚\n7. ArrayList å’Œ LinkedList çš„åŒºåˆ« ArrayList: åŸºäºåŠ¨æ€æ•°ç»„å®ç°ï¼ŒæŸ¥è¯¢é€Ÿåº¦å¿«ï¼ˆO(1)ï¼‰ï¼Œå¢åˆ é€Ÿåº¦æ…¢ï¼ˆO(n)ï¼‰ã€‚ LinkedList: åŸºäºåŒå‘é“¾è¡¨å®ç°ï¼ŒæŸ¥è¯¢é€Ÿåº¦æ…¢ï¼ˆO(n)ï¼‰ï¼Œå¢åˆ é€Ÿåº¦å¿«ï¼ˆO(1)ï¼‰ã€‚ 8. å¯¹è±¡çš„æµ…æ‹·è´å’Œæ·±æ‹·è´ æµ…æ‹·è´: åªå¤åˆ¶å¯¹è±¡çš„åŸºæœ¬ç±»å‹å’Œå¼•ç”¨ç±»å‹çš„åœ°å€ï¼Œä¸å¤åˆ¶å¼•ç”¨å¯¹è±¡æœ¬èº«ã€‚ä¿®æ”¹å¼•ç”¨å¯¹è±¡ä¼šå½±å“åŸå¯¹è±¡ã€‚ æ·±æ‹·è´: å¤åˆ¶å¯¹è±¡çš„åŸºæœ¬ç±»å‹å’Œå¼•ç”¨å¯¹è±¡ï¼Œç”Ÿæˆä¸€ä¸ªå…¨æ–°çš„å¯¹è±¡ï¼Œäº’ä¸å½±å“ã€‚ 9. äº†è§£å“ªäº›è®¾è®¡æ¨¡å¼ï¼Ÿ å¸¸è§çš„è®¾è®¡æ¨¡å¼åŒ…æ‹¬ï¼š\nåˆ›å»ºå‹æ¨¡å¼: å·¥å‚æ¨¡å¼ã€æŠ½è±¡å·¥å‚æ¨¡å¼ã€å•ä¾‹æ¨¡å¼ã€å»ºé€ è€…æ¨¡å¼ã€åŸå‹æ¨¡å¼ã€‚ ç»“æ„å‹æ¨¡å¼: é€‚é…å™¨æ¨¡å¼ã€è£…é¥°å™¨æ¨¡å¼ã€ä»£ç†æ¨¡å¼ã€å¤–è§‚æ¨¡å¼ã€æ¡¥æ¥æ¨¡å¼ã€ç»„åˆæ¨¡å¼ã€äº«å…ƒæ¨¡å¼ã€‚ è¡Œä¸ºå‹æ¨¡å¼: ç­–ç•¥æ¨¡å¼ã€æ¨¡æ¿æ–¹æ³•æ¨¡å¼ã€è§‚å¯Ÿè€…æ¨¡å¼ã€è¿­ä»£å™¨æ¨¡å¼ã€è´£ä»»é“¾æ¨¡å¼ã€å‘½ä»¤æ¨¡å¼ã€å¤‡å¿˜å½•æ¨¡å¼ã€çŠ¶æ€æ¨¡å¼ã€è®¿é—®è€…æ¨¡å¼ã€è§£é‡Šå™¨æ¨¡å¼ã€ä¸­ä»‹è€…æ¨¡å¼ã€‚ 10. TensorFlow æ˜¯ç”¨æ¥å¹²å˜›çš„ TensorFlow æ˜¯ä¸€ä¸ªå¼€æºçš„æœºå™¨å­¦ä¹ æ¡†æ¶ï¼Œä¸»è¦ç”¨äºæ·±åº¦å­¦ä¹ æ¨¡å‹çš„å¼€å‘ã€è®­ç»ƒå’Œéƒ¨ç½²ã€‚å®ƒæä¾›äº†çµæ´»çš„è®¡ç®—å›¾ç»“æ„ï¼Œå¯ä»¥åœ¨ CPUã€GPU å’Œ TPU ä¸Šè¿è¡Œï¼Œæ”¯æŒåˆ†å¸ƒå¼è®¡ç®—ã€‚\n11. è§£é‡Šä¸€ä¸‹ softmax Softmax æ˜¯ä¸€ç§æ¿€æ´»å‡½æ•°ï¼Œå¸¸ç”¨äºå¤šåˆ†ç±»æ¨¡å‹çš„è¾“å‡ºå±‚ã€‚å®ƒå°†è¾“å…¥çš„ logits è½¬æ¢ä¸ºæ¦‚ç‡åˆ†å¸ƒï¼Œå…¬å¼å¦‚ä¸‹ï¼š [ \\text{softmax}(x_i) = \\frac{e^{x_i}}{\\sum_{j} e^{x_j}} ] å…¶ä¸­ï¼Œ( x_i ) æ˜¯è¾“å…¥å‘é‡çš„ç¬¬ i ä¸ªåˆ†é‡ï¼Œè¾“å‡ºçš„æ¯ä¸ªåˆ†é‡éƒ½æ˜¯ä»‹äº 0 å’Œ 1 ä¹‹é—´çš„æ¦‚ç‡å€¼ï¼Œä¸”æ‰€æœ‰åˆ†é‡çš„å’Œä¸º 1ã€‚\n12. å¸¸ç”¨çš„å¼ºåŒ–å­¦ä¹ ç®—æ³• ä¸ºä»€ä¹ˆç”¨ PPO ç®—æ³•ä¸ç”¨ DQN ç®—æ³•ï¼Ÿ PPOï¼ˆProximal Policy Optimizationï¼‰å’Œ DQNï¼ˆDeep Q-Networkï¼‰éƒ½æ˜¯å¸¸ç”¨çš„å¼ºåŒ–å­¦ä¹ ç®—æ³•ã€‚é€‰æ‹© PPO è€Œä¸æ˜¯ DQN çš„åŸå› åŒ…æ‹¬ï¼š\nPPO æ˜¯åŸºäºç­–ç•¥æ¢¯åº¦çš„ç®—æ³•ï¼Œé€‚ç”¨äºè¿ç»­åŠ¨ä½œç©ºé—´ï¼Œè€Œ DQN ä¸»è¦ç”¨äºç¦»æ•£åŠ¨ä½œç©ºé—´ã€‚ PPO å¼•å…¥äº†å‰ªåˆ‡æ¦‚ç‡æ¯”ï¼ˆclipped probability ratioï¼‰ï¼Œåœ¨æ›´æ–°ç­–ç•¥æ—¶ä¿æŒå¹³ç¨³ï¼Œè®­ç»ƒæ›´ç¨³å®šã€‚ PPO æ›´åŠ ç®€å•é«˜æ•ˆï¼Œä¸éœ€è¦åƒ DQN é‚£æ ·å¤æ‚çš„ç»éªŒå›æ”¾å’Œç›®æ ‡ç½‘ç»œã€‚ 13. ä¸ºä»€ä¹ˆä¸ç”¨ A3C ç®—æ³•ï¼Ÿ å°½ç®¡ A3Cï¼ˆAsynchronous Advantage Actor-Criticï¼‰æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„ç®—æ³•ï¼Œä½†ç›¸è¾ƒäº PPOï¼Œæœ‰ä»¥ä¸‹ç¼ºç‚¹ï¼š\nA3C ä½¿ç”¨å¤šçº¿ç¨‹å¹¶è¡Œï¼Œå®¹æ˜“å—åˆ°çº¿ç¨‹è°ƒåº¦å’ŒåŒæ­¥çš„å½±å“ã€‚ PPO ä¸éœ€è¦å¤æ‚çš„å¤šçº¿ç¨‹è®¾ç½®ï¼Œå…·æœ‰æ›´é«˜çš„æ ·æœ¬æ•ˆç‡å’Œè®­ç»ƒç¨³å®šæ€§ã€‚ PPO ç®—æ³•ç›¸å¯¹æ›´ç®€å•ï¼Œæ›´å®¹æ˜“è°ƒè¯•å’Œå®ç°ã€‚ 14. è®²è®² Transformer Transformer æ˜¯ä¸€ç§ç”¨äºè‡ªç„¶è¯­è¨€å¤„ç†çš„ç¥ç»ç½‘ç»œæ¨¡å‹ï¼Œå…‹æœäº†ä¼ ç»Ÿ RNN æ¨¡å‹åœ¨å¤„ç†é•¿åºåˆ—æ—¶çš„å±€é™æ€§ã€‚å®ƒä¸»è¦ç”±ä»¥ä¸‹éƒ¨åˆ†ç»„æˆï¼š\nç¼–ç å™¨ï¼ˆEncoderï¼‰: ç”±å¤šä¸ªç›¸åŒçš„ç¼–ç å±‚å †å è€Œæˆï¼Œæ¯å±‚åŒ…å«è‡ªæ³¨æ„åŠ›æœºåˆ¶å’Œå‰é¦ˆç¥ç»ç½‘ç»œã€‚ è§£ç å™¨ï¼ˆDecoderï¼‰: ç»“æ„ç±»ä¼¼äºç¼–ç å™¨ï¼Œä½†æ¯ä¸ªè§£ç å±‚åœ¨è‡ªæ³¨æ„åŠ›æœºåˆ¶ä¹‹åè¿˜å¢åŠ äº†ä¸€ä¸ªå¯¹ç¼–ç å™¨è¾“å‡ºçš„æ³¨æ„åŠ›æœºåˆ¶ã€‚ è‡ªæ³¨æ„åŠ›æœºåˆ¶ï¼ˆSelf-Attentionï¼‰: è®¡ç®—è¾“å…¥åºåˆ—ä¸­æ¯ä¸ªå…ƒç´ ä¸å…¶ä»–å…ƒç´ çš„å…³ç³»ï¼Œä»¥æ•æ‰å…¨å±€ä¾èµ–å…³ç³»ã€‚ ä½ç½®ç¼–ç ï¼ˆPositional Encodingï¼‰: ä¸ºäº†ä¿ç•™åºåˆ—ä¿¡æ¯ï¼Œå‘è¾“å…¥ä¸­æ·»åŠ ä½ç½®ä¿¡æ¯ã€‚ Transformer çš„ä¼˜åŠ¿åŒ…æ‹¬ï¼š å¹¶è¡ŒåŒ–è®¡ç®—æ•ˆç‡é«˜ï¼Œé€‚åˆå¤„ç†é•¿åºåˆ—ã€‚ èƒ½å¤Ÿæ•æ‰åºåˆ—ä¸­å…¨å±€ä¾èµ–å…³ç³»ã€‚ ã€Œæ‰‹æ’•ã€ 1. å¾ˆç®€å•çš„æ•°ç»„é¢˜ 2min åšå®Œ å‡è®¾è¿™æ˜¯ä¸€ä¸ªç®€å•çš„æ±‚æ•°ç»„æœ€å¤§å€¼çš„é¢˜ç›®ï¼Œä»£ç å¦‚ä¸‹ï¼š\npublic int findMax(int[] nums) { int max = nums[0]; for (int num : nums) { if (num \u0026gt; max) { max = num; } } return max; } 2. åè½¬é“¾è¡¨ II åŠ›æ‰£ 92 é¢˜ åè½¬é“¾è¡¨ II çš„è§£é¢˜æ€è·¯æ˜¯æ‰¾åˆ°è¦åè½¬çš„èµ·ç‚¹å’Œç»ˆç‚¹ï¼Œè¿›è¡Œå±€éƒ¨åè½¬ã€‚ä»£ç å¦‚ä¸‹ï¼š\npublic ListNode reverseBetween(ListNode head, int m, int n) { if (head == null) return null; ListNode dummy = new ListNode(0); dummy.next = head; ListNode pre = dummy; for (int i = 0; i \u0026lt; m - 1; i++) pre = pre.next; ListNode start = pre.next; ListNode then = start.next; for (int i = 0; i \u0026lt; n - m; i++) { start.next = then.next; then.next = pre.next; pre.next = then; then = start.next; } return dummy.next; } /** * Definition for singly-linked list. * public class ListNode { * int val; * ListNode next; * ListNode() {} * ListNode(int val) { this.val = val; } * ListNode(int val, ListNode next) { this.val = val; this.next = next; } * } */ class Solution { public ListNode reverseBetween(ListNode head, int m, int n) { if (head == null) return null; ListNode dummy = new ListNode(0); dummy.next = head; ListNode pre = dummy; for (int i = 0; i \u0026lt; m - 1; i++) pre = pre.next; ListNode start = pre.next; ListNode cur = null; ListNode newEnd = start; for (int i = 0; i \u0026lt;= n - m; i++) { ListNode nxt = start.next; start.next = cur; cur = start; start = nxt; } pre.next = cur; newEnd.next = start; return dummy.next; } } å¸Œæœ›è¿™äº›å›ç­”èƒ½å¸®åŠ©ä½ æ›´å¥½åœ°å‡†å¤‡é¢è¯•ã€‚ç¥ä½ é¢è¯•æˆåŠŸï¼\n","permalink":"https://kennems.github.io/posts/tech/%E9%9D%A2%E7%BB%8F1/","summary":"é¢ç»ï¼ˆ1ï¼‰ å…«è‚¡åˆ†ä¸ºï¼šåŸºç¡€çŸ¥è¯†ï¼Œåº•å±‚åŸç†ï¼Œåœºæ™¯åº”ç”¨ åŸºç¡€çŸ¥è¯†ï¼šjavaguide, æ­»è®°ç¡¬èƒŒï¼Œæ€ç»´å¯¼å›¾ åº•å±‚åŸç†ï¼šå…«è‚¡åˆé›†ï¼Œé¢ç»+GPT+æ•´ç† åœºæ™¯åº”","title":"é¢ç»ï¼ˆ1ï¼‰"},{"content":"Java Webå¼€å‘(6) äº‹åŠ¡ï¼šäº‹åŠ¡æ˜¯ä¸€ç»„æ“ä½œçš„é›†åˆï¼Œå®ƒæ˜¯ä¸€ä¸ªä¸å¯åˆ†å‰²çš„å·¥ä½œå•ä½ï¼Œè¿™äº›æ“ä½œè¦ä¹ˆåŒæ—¶æˆåŠŸï¼Œè¦ä¹ˆåŒæ—¶å¤±è´¥\nstart transaction / begin commit rollback Springäº‹åŠ¡ç®¡ç† @Transactional ä½ç½®ï¼šä¸šåŠ¡ï¼ˆserviceï¼‰å±‚çš„æ–¹æ³•ä¸Šã€ç±»ä¸Šã€æ¥å£ä¸Š ä½œç”¨ï¼šå°†å½“å‰æ–¹æ³•äº¤ç»™springè¿›è¡Œäº‹åŠ¡ç®¡ç†ï¼Œæ–¹æ³•æ‰§è¡Œå‰ï¼Œå¼€å¯äº‹åŠ¡ï¼›æˆåŠŸæ‰§è¡Œå®Œæ¯•ï¼Œæäº¤äº‹åŠ¡ï¼›å‡ºç°å¼‚å¸¸ï¼Œå›æ»šäº‹åŠ¡ã€‚ äº‹åŠ¡å±æ€§\né»˜è®¤æƒ…å†µä¸‹ï¼Œåªæœ‰å‡ºç°RuntimeException æ‰å›æ»šå¼‚å¸¸ã€‚rollbackForå±æ€§ç”¨äºæ§åˆ¶å‡ºç°ä½•ç§å¼‚å¸¸ç±»å‹æ˜¯å›æ»šäº‹åŠ¡ @Transactional(rollbackFor = Exception.class) ä¼ æ’­è¡Œä¸º\npropagation\näº‹åŠ¡ä¼ æ’­è¡Œä¸ºï¼šæŒ‡çš„æ˜¯å½“ä¸€ä¸ªäº‹åŠ¡æ–¹æ³•è¢«å¦ä¸€ä¸ªäº‹åŠ¡æ–¹æ³•è°ƒç”¨æ—¶ï¼Œè¿™ä¸ªäº‹åŠ¡æ–¹æ³•åº”è¯¥å¦‚ä½•è¿›è¡Œäº‹åŠ¡æ§åˆ¶\nREQUIREDï¼šå¤§éƒ¨åˆ†æƒ…å†µä¸‹éƒ½æ˜¯ç”¨è¯¥ä¼ æ’­è¡Œä¸ºå³å¯\nREQUIRES_NEWï¼šå½“æˆ‘ä»¬ä¸å¸Œæœ›äº‹åŠ¡ä¹‹é—´ç›¸äº’å½±å“æ—¶ï¼Œå¯ä»¥ä½¿ç”¨è¯¥ä¼ æ’­è¡Œä¸ºã€‚æ¯”å¦‚ï¼šä¸‹è®¢å•å‰éœ€è¦è®°å½•æ—¥å¿—ï¼Œä¸è®ºè®¢å•ä¿å­˜æˆåŠŸä¸å¦ï¼Œéƒ½éœ€è¦ä¿è¯æ—¥å¿—è®°å½•èƒ½å¤Ÿè®°å½•æˆåŠŸã€‚\nAOP AOPï¼ˆAspect Oriented Programmingï¼‰é¢å‘åˆ‡é¢ç¼–ç¨‹ï¼Œé¢å‘æ–¹é¢ç¼–ç¨‹ï¼Œå…¶å®å°±æ˜¯é¢å‘ç‰¹å®šæ–¹æ³•ç¼–ç¨‹ã€‚ åœºæ™¯ï¼š\nç»Ÿè®¡Serviceå„é¡¹æ–¹æ³•çš„è¿è¡Œè€—æ—¶\n@Slf4j @Component @Aspect public class TimeAspect { @Around(\u0026#34;execution(* com.showguan.service.*.*(..))\u0026#34;) public Object recordTime(ProceedingJoinPoint joinPoint) throws Throwable { long begin = System.currentTimeMillis(); Object result = joinPoint.proceed(); long end = System.currentTimeMillis(); log.info(joinPoint.getSignature() + \u0026#34;æ–¹æ³•è€—æ—¶ :{} ms\u0026#34;, (end-begin)); return result; } } AOPæ ¸å¿ƒæ¦‚å¿µ\nè¿æ¥ç‚¹ï¼šJoinPointï¼Œå¯ä»¥è¢«AOPæ§åˆ¶çš„æ–¹æ³•ï¼ˆæš—å«æ–¹æ³•æ‰§è¡Œæ—¶çš„ç›¸å…³ä¿¡æ¯ï¼‰ é€šçŸ¥ï¼šAdviceï¼Œ æŒ‡å“ªäº›é‡å¤çš„é€»è¾‘ï¼Œä¹Ÿå°±æ˜¯å…±æ€§åŠŸèƒ½ï¼ˆæœ€ç»ˆä½“ç°ä¸ºä¸€ä¸ªæ–¹æ³•ï¼‰ åˆ‡å…¥ç‚¹ï¼šPointCutï¼ŒåŒ¹é…è¿æ¥ç‚¹çš„æ¡ä»¶ï¼Œé€šçŸ¥ä»…ä¼šåœ¨åˆ‡å…¥ç‚¹æ–¹æ³•æ‰§è¡Œæ—¶è¢«åº”ç”¨ åˆ‡é¢ï¼šAspectï¼Œæè¿°é€šçŸ¥ä¸åˆ‡å…¥ç‚¹çš„å¯¹åº”å…³ç³»ï¼ˆé€šçŸ¥+åˆ‡å…¥ç‚¹ï¼‰ ç›®æ ‡å¯¹è±¡ï¼šTarget, é€šçŸ¥æ‰€åº”ç”¨çš„å¯¹è±¡ é€šçŸ¥ç±»å‹\n@Aroundï¼šç¯ç»•é€šçŸ¥ï¼Œæ­¤æ³¨è§£æ ‡æ³¨çš„é€šçŸ¥æ–¹æ³•åœ¨ç›®æ ‡æ–¹æ³•å‰åéƒ½è¢«æ‰§è¡Œ @Beforeï¼šå‰ç½®é€šçŸ¥ï¼Œæ­¤æ³¨è§£æ ‡æ³¨çš„é€šçŸ¥æ–¹æ³•åœ¨ç›®æ ‡æ–¹æ³•å‰è¢«æ‰§è¡Œ @Afterï¼šåç½®é€šçŸ¥ï¼Œæ­¤æ³¨è§£æ ‡æ³¨çš„é€šçŸ¥æ–¹æ³•åœ¨ç›®æ ‡æ–¹æ³•åè¢«æ‰§è¡Œï¼Œæ— è®ºæ˜¯å¦æœ‰å¼‚å¸¸éƒ½ä¼šæ‰§è¡Œ @AfterReturningï¼šè¿”å›åé€šçŸ¥ï¼Œæ­¤æ³¨è§£æ ‡æ³¨çš„é€šçŸ¥æ–¹æ³•åœ¨ç›®æ ‡æ–¹æ³•åè¢«æ‰§è¡Œï¼Œæœ‰å¼‚å¸¸ä¸ä¼šæ‰§è¡Œ @AfterThrowingï¼šå¼‚å¸¸åé€šçŸ¥ï¼Œæ­¤æ³¨è§£æ ‡æ³¨çš„é€šçŸ¥æ–¹æ³•å‘ç”Ÿå¼‚å¸¸åæ‰§è¡Œ æ³¨æ„äº‹é¡¹ï¼›\n@Around ç¯ç»•é€šçŸ¥éœ€è¦è‡ªå·±è°ƒç”¨ Object result = proceedingJoinPoint.proceed(); æ¥è®©åŸå§‹æ–¹æ³•æ‰§è¡Œï¼Œå…¶ä»–é€šçŸ¥ä¸éœ€è¦è€ƒè™‘ç›®æ ‡æ–¹æ³•æ‰§è¡Œ\n@Around ç¯ç»•é€šçŸ¥æ–¹æ³•çš„è¿”å›å€¼ï¼Œå¿…é¡»æŒ‡å®šä¸ºObjectï¼Œæ¥æ¥æ”¶åŸå§‹æ–¹æ³•çš„è¿”å›å€¼ é€šçŸ¥é¡ºåº å½“æœ‰å¤šä¸ªåˆ‡é¢çš„åˆ‡å…¥ç‚¹éƒ½åŒ¹é…åˆ°äº†ç›®æ ‡æ–¹æ³•ï¼Œç›®æ ‡æ–¹æ³•è¿è¡Œæ—¶ï¼Œå¤šä¸ªé€šçŸ¥æ–¹æ³•éƒ½ä¼šè¢«æ‰§è¡Œ\næ‰§è¡Œé¡ºåº\nä¸åŒåˆ‡é¢ç±»ä¸­ï¼Œé»˜è®¤æŒ‰ç…§åˆ‡é¢ç±»çš„ç±»åå­—æ¯æ’åº ç›®æ ‡æ–¹æ³•å‰çš„é€šçŸ¥æ–¹æ³•ï¼šå­—æ¯æ’åé å‰çš„å…ˆæ‰§è¡Œ ç›®æ ‡æ–¹æ³•åçš„é€šçŸ¥æ–¹æ³•ï¼šå­—æ¯æ’åé å‰çš„åæ‰§è¡Œ ç”¨@Orderï¼ˆæ•°å­—ï¼‰åŠ åœ¨åˆ‡é¢ç±»ä¸Šæ¥æ§åˆ¶é¡ºåº ç›®æ ‡æ–¹æ³•å‰çš„é€šçŸ¥æ–¹æ³•ï¼šæ•°å­—å°çš„å…ˆæ‰§è¡Œ ç›®æ ‡æ–¹æ³•åçš„é€šçŸ¥æ–¹æ³•ï¼šæ•°å­—å°çš„åæ‰§è¡Œ åˆ‡å…¥ç‚¹è¡¨è¾¾å¼\næè¿°åˆ‡å…¥ç‚¹æ–¹æ³•çš„ä¸€ç§è¡¨è¾¾å¼ ä½œç”¨ï¼šä¸»è¦ç”¨æ¥å†³å®šé¡¹ç›®ä¸­å“ªäº›æ–¹æ³•éœ€è¦åŠ å…¥é€šçŸ¥ å¸¸è§å½¢å¼ execution(...)ï¼šæ ¹æ®æ–¹æ³•çš„ç­¾åæ¥åŒ¹é… @annotation(...)ï¼šæ ¹æ®æ³¨è§£åŒ¹é… executionæ ¹æ®æ–¹æ³•çš„è¿”å›å€¼ï¼ŒåŒ…åï¼Œç±»åï¼Œæ–¹æ³•åï¼Œæ–¹æ³•å‚æ•°ç­‰ä¿¡æ¯æ¥åŒ¹é…ï¼Œè¯­æ³•ä¸ºï¼š\nexecution(è®¿é—®ä¿®é¥°ç¬¦? è¿”å›å€¼ åŒ…å.ç±»å.?æ–¹æ³•å(æ–¹æ³•å‚æ•°) throws å¼‚å¸¸?) å…¶ä¸­å¸¦ ? è¡¨ç¤ºå¯ä»¥çœç•¥çš„éƒ¨åˆ†\nè®¿é—®ä¿®é¥°ç¬¦ï¼šå¯çœç•¥ï¼ˆpublic, protected) åŒ…å.ç±»åï¼šå¯çœç•¥ throwså¼‚å¸¸ï¼šå¯çœç•¥ï¼ˆæ³¨æ„æ—¶æ–¹æ³•ä¸Šå£°æ˜æŠ›å‡ºçš„å¼‚å¸¸ï¼Œä¸æ˜¯å®é™…æŠ›å‡ºçš„å¼‚å¸¸ï¼‰ å¯ä»¥ä½¿ç”¨é€šé…ç¬¦æè¿°åˆ‡å…¥ç‚¹\n*ï¼šå•ä¸ªç‹¬ç«‹çš„ä»»æ„ç¬¦å·ï¼Œå¯ä»¥é€šé…ä»»æ„è¿”å›å€¼ï¼ŒåŒ…åï¼Œç±»åï¼Œæ–¹æ³•åï¼Œä»»æ„ç±»å‹çš„ä¸€ä¸ªå‚æ•°ï¼Œä¹Ÿå¯ä»¥ç»Ÿé…åŒ…ï¼Œç±»ï¼Œæ–¹æ³•åçš„ä¸€éƒ¨åˆ†\nexecution(* com.*.service.*.update*(*)) .. : å¤šä¸ªè¿ç»­çš„ä»»æ„ç¬¦å·ï¼Œå¯ä»¥é€šé…ä»»æ„å±‚çº§çš„åŒ…ï¼Œæˆ–ä»»æ„ç±»å‹ï¼Œä»»æ„ä¸ªæ•°çš„å‚æ•°\nexecution(* com.showguan..DeptService.*(..)) æ ¹æ®ä¸šåŠ¡éœ€è¦ï¼Œ å¯ä»¥ä½¿ç”¨ \u0026amp;\u0026amp;ï¼Œ ||ï¼Œ ! æ¥ç»„åˆæ¯”è¾ƒå¤æ‚çš„åˆ‡å…¥ç‚¹è¡¨è¾¾å¼\nä¹¦å†™å»ºè®®ï¼š\næ‰€æœ‰ä¸šåŠ¡æ–¹æ³•ååœ¨å‘½åæ—¶å°½é‡è§„èŒƒï¼Œæ–¹ä¾¿åˆ‡å…¥ç‚¹è¡¨è¾¾å¼å¿«é€ŸåŒ¹é…ã€‚å¦‚ï¼šæŸ¥è¯¢ç±»æ–¹æ³•éƒ½æ˜¯findå¼€å¤´ï¼Œæ›´æ–°ç±»æ–¹æ³•éƒ½æ˜¯updateå¼€å¤´ æè¿°åˆ‡å…¥ç‚¹æ–¹æ³•é€šå¸¸åŸºäºæ¥å£æè¿°ï¼Œè€Œä¸æ˜¯ç›´æ¥æè¿°å®ç°ç±»ï¼Œå¢å¼ºæ‹“å±•æ€§ åœ¨æ»¡è¶³ä¸šåŠ¡éœ€è¦çš„å‰æä¸‹ï¼Œå°½é‡ç¼©å°åˆ‡å…¥ç‚¹çš„åŒ¹é…èŒƒå›´ï¼Œå¦‚ï¼šåŒ…åå°½é‡ä¸ä½¿ç”¨\u0026hellip;ï¼Œ ä½¿ç”¨*åŒ¹é…å•ä¸ªåŒ…å æ³¨è§£å½¢å¼ åœ¨apoæ–‡ä»¶å¤¹å†…æ–°å»ºæ³¨è§£æ–‡ä»¶ Mylog.java\n@Retention(RetentionPolicy.RUNTIME) //ä»€ä¹ˆæ—¶å€™è¿è¡Œ @Target(ElementType.METHOD) // è¿è¡ŒèŒƒå›´ public @interface MyLog { } Aspectæ–‡ä»¶é…ç½®ï¼š\n@Slf4j @Component @Aspect public class MyAspect2 { // @Pointcut(\u0026#34;execution(* com.showguan.service.DeptService.list()) ||\u0026#34; + // \u0026#34;execution(* com.showguan.service.DeptService.delete(java.lang.Integer))\u0026#34; // ) @Pointcut(\u0026#34;@annotation(com.showguan.apo.MyLog)\u0026#34;) private void pt(){} @Before(\u0026#34;pt()\u0026#34;) private void before(){ log.info(\u0026#34;My Aspect6 ... Before ...\u0026#34;); } } åœ¨éœ€è¦åŒ¹é…çš„æ–¹æ³•å‰é¢åŠ ä¸Š @MyLog æ³¨è§£å³å¯ã€‚\nè¿æ¥ç‚¹\nåœ¨Springä¸­ç”¨JoinPointæŠ½è±¡äº†è¿æ¥ç‚¹ï¼Œç”¨å®ƒå¯ä»¥åçš„æ–¹æ³•æ‰§è¡Œæ—¶çš„ç›¸å…³ä¿¡æ¯ï¼Œå¦‚ç›®æ ‡ç±»åï¼Œæ–¹æ³•åï¼Œæ–¹æ³•å‚æ•°ç­‰ å¯¹äº@Aroundé€šçŸ¥ï¼Œè·å–è¿æ¥ç‚¹ä¿¡æ¯åªèƒ½ç”¨ProceedingJoinPoing å¯¹äºå…¶ä»–å››ç§é€šçŸ¥ï¼Œè·å–è¿æ¥ç‚¹ä¿¡æ¯åªèƒ½ä½¿ç”¨JointPointï¼Œ å®ƒæ˜¯ProceedingPointçš„çˆ¶ç±»å‹ package com.showguan.apo; import lombok.extern.slf4j.Slf4j; import net.sf.jsqlparser.statement.select.Join; import org.aspectj.lang.JoinPoint; import org.aspectj.lang.ProceedingJoinPoint; import org.aspectj.lang.annotation.Around; import org.aspectj.lang.annotation.Aspect; import org.aspectj.lang.annotation.Before; import org.aspectj.lang.annotation.Pointcut; import org.springframework.stereotype.Component; @Slf4j @Component @Aspect public class MyAspect3 { @Pointcut(\u0026#34;execution(* com.showguan.service.impl.DeptServiceImpl.*(..))\u0026#34;) // private void pt(){} public void pt(){} @Before(\u0026#34;pt()\u0026#34;) public void before(JoinPoint joinPoint){ log.info(\u0026#34;before ...\u0026#34;); } @Around(\u0026#34;pt()\u0026#34;) public Object around(ProceedingJoinPoint JoinPoint) throws Throwable { log.info(\u0026#34;around before\u0026#34;); Object target = JoinPoint.getTarget(); log.info(\u0026#34;ç›®æ ‡ å¯¹è±¡çš„ç±»åï¼š{}\u0026#34;, JoinPoint); String name = JoinPoint.getSignature().getName(); log.info(\u0026#34;ç›®æ ‡æ–¹æ³•çš„æ–¹æ³•å\u0026#34;, name); Object[] args = JoinPoint.getArgs(); log.info(\u0026#34;ç›®æ ‡æ–¹æ³•è¿è¡Œæ—¶ä¼ å…¥çš„å‚æ•°ï¼š{}\u0026#34;, args); Object result = JoinPoint.proceed(); log.info(\u0026#34;ç›®æ ‡æ–¹æ³•çš„è¿”å›å€¼ï¼š{}\u0026#34;, result); log.info(\u0026#34;around after ...\u0026#34;); return result; } } å®è·µ å¯¹å‘˜å·¥å’Œéƒ¨åˆ†çš„å¢åˆ æ”¹éƒ¨åˆ†è¿›è¡Œæ—¥å¿—è®°å½•\n@Slf4j @Component @Aspect public class LogAspect { @Autowired private OperateLogMapper operateLogMapper; @Autowired private HttpServletRequest request; @Around(\u0026#34;@annotation(com.showguan.anno.Log)\u0026#34;) public Object recordLog(ProceedingJoinPoint joinPoint) throws Throwable { String jwt = request.getHeader(\u0026#34;token\u0026#34;); Claims claims = JwtUtils.parseJWT(jwt); Integer operateUser = (Integer) claims.get(\u0026#34;id\u0026#34;); LocalDateTime operateTime = LocalDateTime.now(); String className = joinPoint.getTarget().getClass().getName(); String methodName = joinPoint.getSignature().getName(); Object[] args = joinPoint.getArgs(); String methodParams = Arrays.toString(args); long begin = System.currentTimeMillis(); Object result = joinPoint.proceed(); long end = System.currentTimeMillis(); String returnValue = JSONObject.toJSONString(result); Long costTime = end - begin; OperateLog operateLog = new OperateLog(null, operateUser, operateTime, className, methodName, methodParams, returnValue, costTime); operateLogMapper.insert(operateLog); return result; } } ","permalink":"https://kennems.github.io/posts/tech/java-web%E5%BC%80%E5%8F%916/","summary":"Java Webå¼€å‘(6) äº‹åŠ¡ï¼šäº‹åŠ¡æ˜¯ä¸€ç»„æ“ä½œçš„é›†åˆï¼Œå®ƒæ˜¯ä¸€ä¸ªä¸å¯åˆ†å‰²çš„å·¥ä½œå•ä½ï¼Œè¿™äº›æ“ä½œè¦ä¹ˆåŒæ—¶æˆåŠŸï¼Œè¦ä¹ˆåŒæ—¶å¤±è´¥ start transaction / begin commit rollback Springäº‹åŠ¡ç®¡ç†","title":"Java Webå¼€å‘(6)"},{"content":"LeetCodeåŒå‘¨èµ›132 \u0026amp; å‘¨èµ›401(240608/09) 3181. æ‰§è¡Œæ“ä½œå¯è·å¾—çš„æœ€å¤§æ€»å¥–åŠ± IIå‘¨èµ›ç¬¬å››é¢˜ é¢˜ç›®å¤§æ„ ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ rewardValuesï¼Œé•¿åº¦ä¸º nï¼Œè¡¨ç¤ºä¸åŒä½ç½®çš„å¥–åŠ±å€¼ã€‚åˆå§‹æ—¶ï¼Œæ€»å¥–åŠ± x ä¸º 0ï¼Œæ‰€æœ‰ä¸‹æ ‡éƒ½æ˜¯æœªæ ‡è®°çš„ã€‚å¯ä»¥æ‰§è¡Œä»¥ä¸‹æ“ä½œä»»æ„æ¬¡ï¼š\nä»åŒºé—´ [0, n-1] ä¸­é€‰æ‹©ä¸€ä¸ªæœªæ ‡è®°çš„ä¸‹æ ‡ iã€‚ å¦‚æœ rewardValues[i] å¤§äºå½“å‰çš„æ€»å¥–åŠ± xï¼Œåˆ™å°† rewardValues[i] åŠ åˆ° x ä¸Šï¼Œå¹¶æ ‡è®°ä¸‹æ ‡ iã€‚ è¦æ±‚è¿”å›æ‰§è¡Œæœ€ä¼˜æ“ä½œèƒ½å¤Ÿè·å¾—çš„æœ€å¤§æ€»å¥–åŠ±ã€‚\nå®ç°æ€è·¯ ä½¿ç”¨åŠ¨æ€è§„åˆ’çš„æ€æƒ³è§£å†³é—®é¢˜ï¼Œè€ƒè™‘å¦‚ä½•é€‰æ‹©æ“ä½œèƒ½ä½¿å¾—æ€»å¥–åŠ±æœ€å¤§åŒ–ã€‚ ä½¿ç”¨ä¸€ä¸ªçŠ¶æ€ f è¡¨ç¤ºå½“å‰å¯ä»¥è¾¾åˆ°çš„æœ€å¤§æ€»å¥–åŠ±çš„äºŒè¿›åˆ¶è¡¨ç¤ºã€‚åˆå§‹çŠ¶æ€ f = 1 è¡¨ç¤ºå¯ä»¥è¾¾åˆ°æ€»å¥–åŠ±ä¸º 0 çš„çŠ¶æ€ã€‚ éå†å¥–åŠ±å€¼ rewardValues çš„ä¸åŒå€¼ï¼Œå¯¹æ¯ä¸ªå€¼è¿›è¡Œå¤„ç†ï¼š å°†è¯¥å¥–åŠ±å€¼ä½œä¸ºæ–°çš„çŠ¶æ€åŠ å…¥åˆ°å½“å‰çŠ¶æ€ f ä¸­ã€‚ æœ€ç»ˆ f çš„ä½é•¿åº¦å‡å» 1 å³ä¸ºå¯ä»¥è¾¾åˆ°çš„æœ€å¤§æ€»å¥–åŠ±ã€‚ è¯¥è§£æ³•åˆ©ç”¨äº†åŠ¨æ€è§„åˆ’å’Œä½è¿ç®—çš„ç‰¹æ€§ï¼Œé€šè¿‡çŠ¶æ€çš„æ›´æ–°å’Œè½¬ç§»ï¼Œå®ç°äº†å¯¹æœ€ä¼˜æ“ä½œåºåˆ—çš„æ±‚è§£ï¼Œä¿è¯äº†æ—¶é—´å¤æ‚åº¦åœ¨åˆç†èŒƒå›´å†…ã€‚\nclass Solution: def maxTotalReward(self, r: List[int]) -\u0026gt; int: f = 1 for v in sorted(set(r)): mask = (1 \u0026lt;\u0026lt; v) - 1 mask = mask \u0026amp; f mask = mask \u0026lt;\u0026lt; v f |= mask return f.bit_length() - 1 3177. æ±‚å‡ºæœ€é•¿å¥½å­åºåˆ— IIåŒå‘¨èµ›ç¬¬å››é¢˜ é¢˜ç›®å¤§æ„ ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ nums å’Œä¸€ä¸ªéè´Ÿæ•´æ•° kã€‚å¦‚æœä¸€ä¸ªæ•´æ•°åºåˆ— seq æ»¡è¶³åœ¨ä¸‹æ ‡èŒƒå›´ [0, seq.length - 2] ä¸­å­˜åœ¨ä¸è¶…è¿‡ k ä¸ªä¸‹æ ‡ i ä½¿å¾— seq[i] != seq[i + 1]ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç§°è¿™ä¸ªæ•´æ•°åºåˆ—ä¸º å¥½åºåˆ—ã€‚\nè¯·ä½ è¿”å› nums ä¸­ å¥½å­åºåˆ— çš„æœ€é•¿é•¿åº¦ã€‚\nå®ç°æ€è·¯ é¢„å¤„ç†ï¼šå°† nums ä¸­çš„å…ƒç´ ç¦»æ•£åŒ–ï¼Œå³å°†æ¯ä¸ªå…ƒç´ æ˜ å°„åˆ°ä¸€ä¸ªæ–°çš„å”¯ä¸€æ•´æ•°ï¼Œè¿™æ ·å¯ä»¥ç®€åŒ–åç»­çš„å¤„ç†ã€‚ç”¨ d å­—å…¸ä¿å­˜æ¯ä¸ªå…ƒç´ çš„ç¦»æ•£åŒ–åçš„å€¼ã€‚ åŠ¨æ€è§„åˆ’ï¼šä½¿ç”¨äºŒç»´æ•°ç»„ f è®°å½•å½“å‰å­åºåˆ—çš„æœ€å¤§é•¿åº¦ï¼Œå…¶ä¸­ f[nm][i] è¡¨ç¤ºä»¥ nm ç»“å°¾ä¸”æœ‰ i æ¬¡ä¸è¿ç»­çš„æœ€å¤§é•¿åº¦ã€‚ å¦ç”¨ mx è®°å½•ä½¿ç”¨ i æ¬¡å˜æ¢çš„æœ€å¤§é•¿åº¦ï¼Œlst è®°å½•è¯¥æœ€å¤§é•¿åº¦å¯¹åº”çš„æœ€åä¸€ä¸ªå…ƒç´ ã€‚ çŠ¶æ€è½¬ç§»ï¼šéå† nums ä¸­çš„æ¯ä¸ªå…ƒç´  nmï¼Œå¹¶æ›´æ–° f å’Œ mxã€lstã€‚ å¦‚æœ i \u0026gt; 0ï¼Œåˆ™ f[nm][i] æ›´æ–°ä¸º f[lst[i-1]][i-1] + 1ã€‚ æ›´æ–° mx[i] å’Œ lst[i]ï¼Œä¿è¯å®ƒä»¬è®°å½•å½“å‰çš„æœ€å¤§å€¼å’Œå¯¹åº”å…ƒç´ ã€‚ ç»“æœï¼šæœ€ç»ˆçš„ç»“æœä¸º resï¼Œè®°å½•æ‰€æœ‰æƒ…å†µä¸‹çš„æœ€å¤§é•¿åº¦ã€‚ class Solution: def maximumLength(self, nums: List[int], k: int) -\u0026gt; int: # ç¦»æ•£åŒ– d = {v: i for i, v in enumerate(set(nums))} if len(d) == 1: return len(nums) n = len(d) nums = [d[x] for x in nums] # åˆå§‹åŒ–åŠ¨æ€è§„åˆ’æ•°ç»„ f = [[0] * (k + 1) for _ in range(n + 1)] mx, lst = [0] * (k + 1), [0] * (k + 1) res = 0 for nm in nums: for i in range(k, -1, -1): f[nm][i] += 1 if i and f[lst[i - 1]][i - 1] + 1 \u0026gt; f[nm][i]: f[nm][i] = f[lst[i - 1]][i - 1] + 1 if f[nm][i] \u0026gt; mx[i]: mx[i] = f[nm][i] lst[i] = nm if f[nm][i] \u0026gt; res: res = f[nm][i] return res ","permalink":"https://kennems.github.io/posts/tech/leetcode%E5%8F%8C%E5%91%A8%E8%B5%9B132--%E5%91%A8%E8%B5%9B40124060809/","summary":"LeetCodeåŒå‘¨èµ›132 \u0026amp; å‘¨èµ›401(240608/09) 3181. æ‰§è¡Œæ“ä½œå¯è·å¾—çš„æœ€å¤§æ€»å¥–åŠ± IIå‘¨èµ›ç¬¬å››é¢˜ é¢˜ç›®å¤§æ„ ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ reward","title":"LeetCodeåŒå‘¨èµ›132 \u0026 å‘¨èµ›401(240608/09)"},{"content":"Java Webå¼€å‘(5) MyBatis MyBatisæ˜¯ä¸€æ¬¾ä¼˜ç§€çš„æŒä¹…å±‚æ¡†æ¶ï¼Œç”¨äºç®€åŒ–JDBCçš„å¼€å‘ã€‚ ä½¿ç”¨MybatisæŸ¥è¯¢æ‰€æœ‰ç”¨æˆ·æ•°æ®\nåˆ›å»ºSpringBootå·¥ç¨‹ï¼Œ æ•°æ®åº“è¡¨userï¼Œ å®ä½“ç±»User\nå¼•å…¥Mybatisçš„ç›¸å…³ä¾èµ–ï¼Œé…ç½®Mybatis\n\u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.mybatis.spring.boot\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;mybatis-spring-boot-starter-test\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;3.0.3\u0026lt;/version\u0026gt; \u0026lt;scope\u0026gt;test\u0026lt;/scope\u0026gt; \u0026lt;/dependency\u0026gt; ç¼–å†™SQLè¯­å¥ï¼ˆæ³¨è§£/XMLï¼‰\né‡åˆ°çš„Bug åœ¨mybatisquickstart ä¸­çš„MybatisQuickstartApplication.javaæ·»åŠ ä¸‹é¢è¿™ä¸€è¡Œ\n@MapperScan(\u0026#34;com.showguan.mapper\u0026#34;) // æ·»åŠ è¿™ä¸€è¡Œ package com.showguan.mybatisquickstart; import org.mybatis.spring.annotation.MapperScan; import org.springframework.boot.SpringApplication; import org.springframework.boot.autoconfigure.SpringBootApplication; @SpringBootApplication @MapperScan(\u0026#34;com.showguan.mapper\u0026#34;) // æ·»åŠ è¿™ä¸€è¡Œ public class MybatisQuickstartApplication { public static void main(String[] args) { SpringApplication.run(MybatisQuickstartApplication.class, args); } } JDBC JDBCï¼š(Java DataBase Connectivity)ï¼Œ å°±æ˜¯ä½¿ç”¨Javaè¯­è¨€æ“ä½œå…³ç³»å‹æ•°æ®åº“çš„ä¸€å¥—APIã€‚\næœ¬è´¨ï¼š\nSunå…¬å¸å®˜æ–¹å®šä¹‰çš„ä¸€å¥—æ“ä½œæ‰€æœ‰å…³ç³»å‹æ•°æ®åº“çš„è§„èŒƒï¼Œ å³æ¥å£ å„ä¸ªæ•°æ®åº“å‚å•†å»å®ç°è¿™å¥—æ¥å£ï¼Œæä¾›æ•°æ®åº“é©±åŠ¨jaråŒ… æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™å¥—æ¥å£ï¼ˆJDBCï¼‰ç¼–ç¨‹ï¼Œ çœŸæ­£æ‰§è¡Œçš„ä»£ç æ˜¯é©±åŠ¨jaråŒ…ä¸­çš„å®ç°ç±» æ•°æ®åº“è¿æ¥æ±  æ•°æ®åº“è¿æ¥æ± æ˜¯ä¸€ä¸ªå®¹å™¨ï¼Œè´Ÿè´£åˆ†é…ï¼Œç®¡ç†æ•°æ®åº“è¿æ¥ï¼ˆConnectionï¼‰ å®ƒå…è®¸åº”ç”¨ç¨‹åºé‡å¤ä½¿ç”¨ä¸€ä¸ªç°æœ‰çš„æ•°æ®åº“è¿æ¥ï¼Œè€Œä¸æ˜¯å†é‡æ–°å»ºç«‹ä¸€ä¸ª é‡Šæ”¾ç©ºé—²æ—¶é—´è¶…è¿‡æœ€å¤§ç©ºé—²æ—¶é—´çš„è¿æ¥ï¼Œæ¥é¿å…å› ä¸ºæ²¡æœ‰é‡Šæ”¾è¿æ¥è€Œå¼•èµ·çš„æ•°æ®åº“è¿æ¥é—æ¼ æ ‡å‡†æ¥å£ï¼šDataSource\nå®˜æ–¹æä¾›çš„æ•°æ®åº“è¿æ¥æ± æ¥å£ï¼Œç”±ç¬¬ä¸‰æ–¹ç»„ç»‡å®ç°æ­¤æ¥å£ åŠŸèƒ½ï¼šè·å–è¿æ¥ Druid(å¾·é²ä¼Š)ï¼Œ Hikari\nLombok Lombokæ˜¯ä¸€ä¸ªå®ç”¨çš„Javaç±»åº“ï¼Œ èƒ½é€šè¿‡æ³¨è§£çš„å½¢å¼è‡ªåŠ¨ç”Ÿæˆæ„é€ å™¨ï¼Œgetter/setter, equals, hashcode, toStringç­‰æ–¹æ³•ï¼Œ å¹¶å¯ä»¥è‡ªåŠ¨åŒ–ç”Ÿæˆæ—¥å¿—å˜é‡ï¼Œ ç®€åŒ–Javaå¼€å‘ï¼Œ æé«˜æ•ˆç‡ã€‚ \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.projectlombok\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;lombok\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; æ³¨è§£ ä½œç”¨ @Getter/Setter ä¸ºæ‰€æœ‰çš„å±æ€§æä¾›get/setæ–¹æ³• @ToString ä¼šç»™ç±»è‡ªåŠ¨ç”Ÿæˆæ˜“é˜…è¯»çš„toStringæ–¹æ³• @EqualsAndHashCode æ ¹æ®ç±»æ‰€æ‹¥æœ‰çš„éé™æ€å­—æ®µè‡ªåŠ¨é‡å†™equalsæ–¹æ³•å’ŒhashCodeæ–¹æ³• @Data æä¾›æ›´ç»¼åˆçš„ç”Ÿæˆä»£ç åŠŸèƒ½ï¼ˆ@Getter + @Setter + @ToString + @EqualsAndHashCodeï¼‰ @NoArgsConstructor ä¸ºå®ä½“ç±»ç”Ÿæˆæ— å‚æ•°çš„æ„é€ å™¨æ–¹æ³• @AllArgsConstructor ä¸ºå®ä½“ç±»ç”Ÿæˆé™¤äº†staticä¿®é¥°çš„å­—æ®µä¹‹å¤–çš„å¸¦æœ‰å„å‚æ•°çš„æ„é€ å™¨æ–¹æ³• MybatisåŸºç¡€æ“ä½œ åˆ é™¤å’Œæ–°å¢æ“ä½œ\nMybatisCrudApplicationTests\n@SpringBootTest class MybatisCrudApplicationTests { @Autowired private EmpMapper empMapper; @Test public void testDelete() { int delete = empMapper.delete(17); System.out.println(delete); } @Test public void testInsert(){ Emp emp = new Emp(152, \u0026#34;Tom1\u0026#34;, \u0026#34;0303\u0026#34;, \u0026#34;Tom\u0026#34;, (short)1, \u0026#34;1.jpg\u0026#34;, (short)1, LocalDate.of(2001, 3, 4), 1, LocalDateTime.now(), LocalDateTime.now()); empMapper.insert(emp); System.out.println(emp.getId()); } } application.properties\nspring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver spring.datasource.url=jdbc:mysql://localhost:3306/mybatis spring.datasource.username=root spring.datasource.password=20230205.ken #é…ç½®mybatisçš„æ—¥å¿—, æŒ‡å®šè¾“å‡ºåˆ°æ§åˆ¶å° mybatis.configuration.log-impl=org.apache.ibatis.logging.stdout.StdOutImpl #å¼€å¯mybatisçš„é©¼å³°å‘½åè‡ªåŠ¨æ˜ å°„å¼€å…³ a_column ------\u0026gt; aCloumn mybatis.configuration.map-underscore-to-camel-case=true Emp.java\npackage com.showguan.pojo; import lombok.AllArgsConstructor; import lombok.Data; import lombok.NoArgsConstructor; import java.time.LocalDate; import java.time.LocalDateTime; @Data @NoArgsConstructor @AllArgsConstructor public class Emp { private Integer id; private String username; private String password; private String name; private Short gender; private String image; private Short job; private LocalDate entrydate; private Integer deptId; private LocalDateTime createTime; private LocalDateTime updateTime; } MybatisCrudApplication.java\npackage com.showguan.mybatiscrud; import org.mybatis.spring.annotation.MapperScan; import org.springframework.boot.SpringApplication; import org.springframework.boot.autoconfigure.SpringBootApplication; @SpringBootApplication @MapperScan(\u0026#34;com.showguan.mapper\u0026#34;) // æ·»åŠ è¿™ä¸€è¡Œ public class MybatisCrudApplication { public static void main(String[] args) { SpringApplication.run(MybatisCrudApplication.class, args); } } EmpMapper.java(å®šä¹‰ä¸ºæ¥å£)\npackage com.showguan.mapper; import com.showguan.pojo.Emp; import org.apache.ibatis.annotations.*; @Mapper public interface EmpMapper { @Delete(\u0026#34;delete from emp where id = #{id}\u0026#34;) // public void delete(Integer id); public int delete(Integer id); // å®šä¹‰ä¸ºintè¿”å›å€¼, è·å–åˆ é™¤çš„ä¸ªæ•°ä¿¡æ¯ @Insert(\u0026#34;insert into emp(id, username, password, name, gender, image, job, entrydate, dept_id, create_time, update_time)\\n\u0026#34; + \u0026#34; values (#{id}, #{username}, #{password}, #{name}, #{gender}, #{image}, #{job}, #{entrydate}, #{deptId}, #{createTime}, #{updateTime});\u0026#34;) public void insert(Emp emp); } æ³¨æ„äº‹é¡¹\nå¦‚æœmapperæ¥å£æ–¹æ³•å½¢å‚ä¸­åªæœ‰ä¸€ä¸ªæ™®é€šç±»å‹çš„å‚æ•°ï¼Œ #{ }é‡Œé¢çš„å±æ€§åå¯ä»¥éšä¾¿å†™ï¼Œ å¦‚ ï¼š #{id}, #{xxx} (æ¨èä¿æŒä¸€è‡´) é¢„ç¼–è¯‘SQL\nä¼˜åŠ¿ï¼š\næ€§èƒ½æ›´é«˜ æ›´å®‰å…¨ï¼ˆæ”¾ç½®SQLæ³¨å…¥ï¼‰ SQLæ³¨å…¥ SQLæ³¨å…¥æ˜¯é€šè¿‡æ“ä½œè¾“å…¥çš„æ•°æ®æ¥ä¿®æ”¹äº‹å…ˆå®šä¹‰å¥½çš„SQLè¯­å¥ï¼Œ ä»¥è¾¾åˆ°æ‰§è¡Œä»£ç å¯¹æœåŠ¡å™¨è¿›è¡Œæ”»å‡»çš„æ–¹æ³•ã€‚ é¢è¯•é¢˜ : å‚æ•°å ä½ç¬¦ #{\u0026hellip;} æ‰§è¡ŒSQLæ—¶ï¼Œ ä¼šå°†#{\u0026hellip;}æ›¿æ¢ä¸º?, ç”Ÿæˆé¢„ç¼–è¯‘SQLï¼Œ ä¼šè‡ªåŠ¨è®¾ç½®å‚æ•°å€¼ ä½¿ç”¨æ—¶æœºï¼šå‚æ•°ä¼ é€’ï¼Œ éƒ½ä½¿ç”¨{\u0026hellip;} ${\u0026hellip;} æ‹¼æ¥SQLã€‚ç›´æ¥å°†å‚æ•°æ‹¼æ¥å†SQLè¯­å¥ä¸­ï¼Œå­˜åœ¨SQLæ³¨å…¥é—®é¢˜ ä½¿ç”¨æ—¶æœºï¼šå¦‚æœå¯¹è¡¨åï¼Œåˆ—è¡¨è¿›è¡ŒåŠ¨æ€è®¾ç½®æ—¶ä½¿ç”¨ æ•°æ®å°è£… èµ·åˆ«åï¼šåœ¨SQLè¯­å¥ä¸­ï¼Œå¯¹ä¸ä¸€æ ·çš„åˆ—åèµ·åˆ«åï¼Œåˆ«åå’Œå®ä½“ç±»å±æ€§åä¸€æ · @Select(\u0026#34;select id, username, password, name, gender, image, job, entrydate, dept_id deptId, create_time createTime, update_time updateTime from emp where id = #{id}\u0026#34;) public Emp getById(Integer id); æ‰‹åŠ¨ç»“æœæ˜ å°„ï¼šé€šè¿‡ @Results åŠ @Result è¿›è¡Œæ‰‹åŠ¨ç»“æœæ˜ å°„ @Select(\u0026#34;select * from emp where id = #{id}\u0026#34;) @Results({ @Result(column = \u0026#34;dept_id\u0026#34;, property = \u0026#34;deptId\u0026#34;), @Result(column = \u0026#34;create_time\u0026#34;, property = \u0026#34;createTime\u0026#34;), @Result(column = \u0026#34;update_time\u0026#34;, property = \u0026#34;updateTime\u0026#34;) }) public Emp getById(Integer id); å¼€å¯é©¼å³°å‘½åï¼šå¦‚æœå­—æ®µåå’Œå±æ€§åç§°ç¬¦åˆé©¼å³°å‘½åè§„åˆ™ï¼Œ mybatisä¼šè‡ªåŠ¨é€šè¿‡é©¼å³°å‘½åè§„åˆ™æ˜ å°„\n#å¼€å¯mybatisçš„é©¼å³°å‘½åè‡ªåŠ¨æ˜ å°„å¼€å…³ a_column ------\u0026gt; aCloumn mybatis.configuration.map-underscore-to-camel-case=true mybatis æŸ¥è¯¢ @Select(\u0026#34;select * from emp where id = #{id}\u0026#34;) public Emp getById(Integer id); // @Select(\u0026#34;select id, username, password, name, gender, image, job, entrydate, dept_id deptId, create_time createTime, update_time updateTime from emp where id = #{id}\u0026#34;) // public Emp getById(Integer id); // @Select(\u0026#34;select * from emp where id = #{id}\u0026#34;) // @Results({ // @Result(column = \u0026#34;dept_id\u0026#34;, property = \u0026#34;deptId\u0026#34;), // @Result(column = \u0026#34;create_time\u0026#34;, property = \u0026#34;createTime\u0026#34;), // @Result(column = \u0026#34;update_time\u0026#34;, property = \u0026#34;updateTime\u0026#34;) // }) // public Emp getById(Integer id); // ä½¿ç”¨${} // @Select(\u0026#34;select *\\n\u0026#34; + // \u0026#34;from emp\\n\u0026#34; + // \u0026#34;where name like \u0026#39;%${name}%\u0026#39;\\n\u0026#34; + // \u0026#34; and gender = #{gender}\\n\u0026#34; + // \u0026#34; and entrydate between #{begin}\\n\u0026#34; + // \u0026#34; and #{end}\\n\u0026#34; + // \u0026#34;order by update_time\u0026#34;) // public List\u0026lt;Emp\u0026gt; list(String name, Short gender, LocalDate begin, LocalDate end); //è§£å†³ä¸Šé¢çš„ #{}å‡ºç°åœ¨å¼•å·ä¹‹å†… @Select(\u0026#34;select *\\n\u0026#34; + \u0026#34;from emp\\n\u0026#34; + \u0026#34;where name like concat(\u0026#39;%\u0026#39;, #{name}, \u0026#39;%\u0026#39;)\\n\u0026#34; + \u0026#34; and gender = #{gender}\\n\u0026#34; + \u0026#34; and entrydate between #{begin}\\n\u0026#34; + \u0026#34; and #{end}\\n\u0026#34; + \u0026#34;order by update_time\u0026#34;) public List\u0026lt;Emp\u0026gt; list(String name, Short gender, LocalDate begin, LocalDate end); å‚æ•°åè¯´æ˜\nåœ¨SpringBootçš„ 1.x ç‰ˆæœ¬ä¸­å•ç‹¬ä½¿ç”¨mybatis XMLæ˜ å°„æ–‡ä»¶ è§„èŒƒ\nXMLæ˜ å°„æ–‡ä»¶çš„åç§°ä¸Mapperæ¥å£åç§°ä¸€è‡´ï¼Œå¹¶ä¸”å°†XMLæ–‡ä»¶å’ŒMapperæ¥å£æ”¾ç½®åœ¨ç›¸åŒåŒ…ä¸‹ï¼ˆåŒåŒ…åŒåï¼‰ XMLæ˜ å°„æ–‡ä»¶çš„ namespace å±æ€§ä¸ºMapperæ¥å£å…¨é™å®šåä¸€è‡´ XMLæ˜ å°„æ–‡ä»¶SQLè¯­å¥çš„idå’ŒMapperæ¥å£çš„æ–¹æ³•åä¸€è‡´ï¼Œå¹¶ä¿æŒè¿”å›ç±»å‹ä¸€è‡´ã€‚ \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34; ?\u0026gt; \u0026lt;!DOCTYPE mapper PUBLIC \u0026#34;-//mybatis.org//DTD Mapper 3.0//EN\u0026#34; \u0026#34;http://mybatis.org/dtd/mybatis-3-mapper.dtd\u0026#34;\u0026gt; \u0026lt;mapper namespace=\u0026#34;com.showguan.mapper.EmpMapper\u0026#34;\u0026gt; \u0026lt;select id=\u0026#34;list\u0026#34; resultType=\u0026#34;com.showguan.pojo.Emp\u0026#34;\u0026gt; select * from emp where name like concat(\u0026#39;%\u0026#39;, \u0026#39;å¼ \u0026#39;, \u0026#39;%\u0026#39;) and gender = 1 and entrydate between \u0026#39;2000-01-01\u0026#39; and \u0026#39;2030-01-01\u0026#39; order by update_time; \u0026lt;/select\u0026gt; \u0026lt;/mapper\u0026gt; MybatisåŠ¨æ€SQL æŸ¥è¯¢\u0026lt;if\u0026gt; \u0026lt;where\u0026gt;(å¯ä»¥åˆ é™¤å¤šä½™çš„andå’Œor)\n\u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34; ?\u0026gt; \u0026lt;!DOCTYPE mapper PUBLIC \u0026#34;-//mybatis.org//DTD Mapper 3.0//EN\u0026#34; \u0026#34;http://mybatis.org/dtd/mybatis-3-mapper.dtd\u0026#34;\u0026gt; \u0026lt;mapper namespace=\u0026#34;com.showguan.mapper.EmpMapper\u0026#34;\u0026gt; \u0026lt;select id=\u0026#34;list\u0026#34; resultType=\u0026#34;com.showguan.pojo.Emp\u0026#34;\u0026gt; select * from emp \u0026lt;where\u0026gt; \u0026lt;if test=\u0026#34;name != null\u0026#34;\u0026gt; name like concat(\u0026#39;%\u0026#39;, \u0026#39;å¼ \u0026#39;, \u0026#39;%\u0026#39;) \u0026lt;/if\u0026gt; \u0026lt;if test=\u0026#34;gender != null\u0026#34;\u0026gt; and gender = 1 \u0026lt;/if\u0026gt; \u0026lt;if test=\u0026#34;begin != null and end != null\u0026#34;\u0026gt; and entrydate between \u0026#39;2000-01-01\u0026#39; and \u0026#39;2030-01-01\u0026#39; \u0026lt;/if\u0026gt; \u0026lt;/where\u0026gt; order by update_time desc; \u0026lt;/select\u0026gt; \u0026lt;/mapper\u0026gt; æ›´æ–°\u0026lt;set\u0026gt;ï¼ˆå¯ä»¥åˆ é™¤å¤šä½™çš„,ï¼‰\n\u0026lt;update id=\u0026#34;update2\u0026#34;\u0026gt; update emp \u0026lt;set\u0026gt; \u0026lt;if test=\u0026#34;username != null\u0026#34;\u0026gt; username = #{username}, \u0026lt;/if\u0026gt; \u0026lt;if test=\u0026#34;password != null\u0026#34;\u0026gt; password = #{password}, \u0026lt;/if\u0026gt; \u0026lt;if test=\u0026#34;name != null\u0026#34;\u0026gt; name = #{name}, \u0026lt;/if\u0026gt; \u0026lt;if test=\u0026#34;gender != null\u0026#34;\u0026gt; gender = #{gender}, \u0026lt;/if\u0026gt; \u0026lt;if test=\u0026#34;image != null\u0026#34;\u0026gt; image = #{image}, \u0026lt;/if\u0026gt; \u0026lt;if test=\u0026#34;job != null\u0026#34;\u0026gt; job = #{job}, \u0026lt;/if\u0026gt; \u0026lt;if test=\u0026#34;deptId != null\u0026#34;\u0026gt; dept_id = #{deptId}, \u0026lt;/if\u0026gt; \u0026lt;if test=\u0026#34;createTime != null\u0026#34;\u0026gt; create_time = #{createTime}, \u0026lt;/if\u0026gt; \u0026lt;if test=\u0026#34;updateTime != null\u0026#34;\u0026gt; update_time = #{updateTime} \u0026lt;/if\u0026gt; \u0026lt;/set\u0026gt; where id = #{id}; \u0026lt;/update\u0026gt; \u0026lt;foreach\u0026gt;\n\u0026lt;delete id=\u0026#34;deleteByIds\u0026#34;\u0026gt; delete from emp where id in \u0026lt;foreach collection=\u0026#34;ids\u0026#34; item=\u0026#34;id\u0026#34; separator=\u0026#34;,\u0026#34; open=\u0026#34;(\u0026#34; close=\u0026#34;)\u0026#34;\u0026gt; #{id} \u0026lt;/foreach\u0026gt;; \u0026lt;/delete\u0026gt; å¼€å‘è§„èŒƒ-Restful\nREST(REPresentational State Transfer), è¡¨è¿°æ€§çŠ¶æ€è½¬æ¢ï¼Œ å®ƒæ˜¯ä¸€ç§è½¯ä»¶æ¶æ„é£æ ¼ æ³¨æ„äº‹é¡¹ï¼š\nRESTæ˜¯é£æ ¼ï¼Œ æ˜¯çº¦å®šæ–¹å¼ï¼Œçº¦å®šä¸æ˜¯è§„å®šï¼Œå¯ä»¥æ‰“ç ´ æè¿°æ¨¡å—çš„åŠŸèƒ½é€šå¸¸ä½¿ç”¨å¤æ•°ï¼Œ ä¹Ÿå°±æ˜¯åŠ sçš„æ ¼å¼æ¥æè¿°ï¼Œè¡¨ç¤ºæ­¤ç±»èµ„æºï¼Œè€Œéå•ä¸ªèµ„æºã€‚å¦‚ï¼šusers, emps, books, æ¥å£å¼€å‘æµç¨‹ æ˜ç¡®éœ€æ±‚ æ¥å£æ–‡æ¡£ æ€è·¯åˆ†æ æ¥å£å¼€å‘\næ¥å£æµ‹è¯• postmanæµ‹è¯• å‰åç«¯è”è°ƒ\næ—¥å¿—å°æŠ€å·§ ä½¿ç”¨logbackè®°å½•æ—¥å¿—\n@Slf4j // æ¥å£ @RestController æŸ¥è¯¢éƒ¨é—¨ /** * æŸ¥è¯¢éƒ¨åˆ†æ•°æ® * @return */ // @RequestMapping(value = \u0026#34;/depts\u0026#34;, method = RequestMethod.GET) @GetMapping(\u0026#34;/depts\u0026#34;) public Result list(){ log.info(\u0026#34;æŸ¥è¯¢å…¨éƒ¨\u0026#34;); List\u0026lt;Dept\u0026gt; deptList = deptService.list(); return Result.success(deptList); } åˆ é™¤éƒ¨é—¨ /** * åˆ é™¤éƒ¨é—¨æ•°æ® */ @DeleteMapping(\u0026#34;/depts/{id}\u0026#34;) public Result delete(@PathVariable Integer id){ log.info(\u0026#34;æ ¹æ®idåˆ é™¤éƒ¨åˆ†ï¼š{}\u0026#34;, id); deptService.delete(id); return Result.success(); } å‘˜å·¥æŸ¥è¯¢ æ˜“é”™ç‚¹ï¼š\nä¸€å®šè¦åŠ @AutoWired\nPostManè¯·æ±‚ï¼Œä»ç¬¬ä¸€é¡µå¼€å§‹ï¼Œå¦‚æœæ˜¯ç¬¬0åˆ™è¿”å›çš„æ˜¯æŸ¥è¯¢çš„æ•°é‡\n@Autowired private EmpMapper empMapper; // @Override // public PageBean page(Integer page, Integer pageSize) { // Long count = empMapper.count(); // // Integer start = (page - 1) * pageSize; // List\u0026lt;Emp\u0026gt; empList = empMapper.page(start, pageSize); // PageBean pageBean = new PageBean(count, empList); // return pageBean; // } @Override public PageBean page(Integer page, Integer pageSize,String name, Short gender,LocalDate begin,LocalDate end) { //1. è®¾ç½®åˆ†é¡µå‚æ•° PageHelper.startPage(page,pageSize); //2. æ‰§è¡ŒæŸ¥è¯¢ List\u0026lt;Emp\u0026gt; empList = empMapper.list(name, gender, begin, end); Page\u0026lt;Emp\u0026gt; p = (Page\u0026lt;Emp\u0026gt;) empList; //3. å°è£…PageBeanå¯¹è±¡ PageBean pageBean = new PageBean(p.getTotal(), p.getResult()); return pageBean; } @Override public void delete(List\u0026lt;Integer\u0026gt; ids) { empMapper.delete(ids); } @Override public void save(Emp emp) { emp.setCreateTime(LocalDateTime.now()); emp.setUpdateTime(LocalDateTime.now()); empMapper.insert(emp); } /** * æ ¹æ®idæŸ¥è¯¢å‘˜å·¥ * @param id * @return */ @Override public Emp getById(Integer id) { Emp emp = empMapper.getById(id); return emp; } @Override public void modify(Emp emp) { emp.setUpdateTime(LocalDateTime.now()); empMapper.modify(emp); } PageHelper åˆ†é¡µæŸ¥è¯¢æ—¶ä½¿ç”¨PageHelper\n\u0026lt;!-- PageHelperä¾èµ–--\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.github.pagehelper\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;pagehelper-spring-boot-starter\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.4.7\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; æ–‡ä»¶ä¸Šä¼  å‰ç«¯ï¼š\nå¿…é¡»è¦ä¸€ä¸ªè¡¨å•é¡¹type=\u0026quot;file\u0026quot; å¿…é¡»æ˜¯POSTè¯·æ±‚ method=\u0026quot;post\u0026quot; ç¼–ç æ ¼å¼enctype=\u0026quot;multipart/form-data\u0026quot; \u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;UTF-8\u0026#34;\u0026gt; \u0026lt;title\u0026gt;ä¸Šä¼ æ–‡ä»¶\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;form action=\u0026#34;/upload\u0026#34; method=\u0026#34;post\u0026#34; enctype=\u0026#34;multipart/form-data\u0026#34;\u0026gt; å§“å: \u0026lt;input type=\u0026#34;text\u0026#34; name=\u0026#34;username\u0026#34;\u0026gt;\u0026lt;br\u0026gt; å¹´é¾„: \u0026lt;input type=\u0026#34;text\u0026#34; name=\u0026#34;age\u0026#34;\u0026gt;\u0026lt;br\u0026gt; å¤´åƒ: \u0026lt;input type=\u0026#34;file\u0026#34; name=\u0026#34;image\u0026#34;\u0026gt;\u0026lt;br\u0026gt; \u0026lt;input type=\u0026#34;submit\u0026#34; value=\u0026#34;æäº¤\u0026#34;\u0026gt; \u0026lt;/form\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; é˜¿é‡Œäº‘OSS é˜¿é‡Œäº‘å¯¹è±¡å­˜å‚¨OSSï¼ˆObject Storage Serviceï¼‰\nåœ¨utilsæ–‡ä»¶å¤¹å†…ç¼–å†™ AliOSSUtils\npackage com.showguan.utils; import com.aliyun.oss.OSS; import com.aliyun.oss.OSSClientBuilder; import org.springframework.beans.factory.annotation.Value; import org.springframework.stereotype.Component; import org.springframework.web.multipart.MultipartFile; import java.io.*; import java.util.UUID; /** * é˜¿é‡Œäº‘ OSS å·¥å…·ç±» */ @Component public class AliOSSUtils { @Value(\u0026#34;${aiyun.oss.endpoint}\u0026#34;) private String endpoint; @Value(\u0026#34;${aiyun.oss.accessKeyId}\u0026#34;) private String accessKeyId ; @Value(\u0026#34;${aiyun.oss.accessKeySecret}\u0026#34;) private String accessKeySecret; @Value(\u0026#34;${aiyun.oss.bucketName}\u0026#34;) private String bucketName; /** * å®ç°ä¸Šä¼ å›¾ç‰‡åˆ°OSS */ public String upload(MultipartFile file) throws IOException { // è·å–ä¸Šä¼ çš„æ–‡ä»¶çš„è¾“å…¥æµ InputStream inputStream = file.getInputStream(); // é¿å…æ–‡ä»¶è¦†ç›– String originalFilename = file.getOriginalFilename(); String fileName = UUID.randomUUID().toString() + originalFilename.substring(originalFilename.lastIndexOf(\u0026#34;.\u0026#34;)); //ä¸Šä¼ æ–‡ä»¶åˆ° OSS OSS ossClient = new OSSClientBuilder().build(endpoint, accessKeyId, accessKeySecret); ossClient.putObject(bucketName, fileName, inputStream); //æ–‡ä»¶è®¿é—®è·¯å¾„ String url = endpoint.split(\u0026#34;//\u0026#34;)[0] + \u0026#34;//\u0026#34; + bucketName + \u0026#34;.\u0026#34; + endpoint.split(\u0026#34;//\u0026#34;)[1] + \u0026#34;/\u0026#34; + fileName; // å…³é—­ossClient ossClient.shutdown(); return url;// æŠŠä¸Šä¼ åˆ°ossçš„è·¯å¾„è¿”å› } } é…ç½®æ–‡ä»¶å‡é…ç½®åˆ°propertiesæ–‡ä»¶ä¸­ï¼Œ è€Œåœ¨AliOSSUtilsä¸­ç”¨@Valueæ³¨å…¥\né…ç½®æ–‡ä»¶ SpringBootæä¾›äº†å¤šç§å±æ€§é…ç½®æ–¹å¼\napplication.properties\nserver.port=8080 server.address=127.0.0.1 yml/yaml ç®€æ´ï¼Œæ•°æ®ä¸ºä¸­å¿ƒ\nserver: port: 8080 address: 127.0.0.1 åŸºæœ¬è¯­æ³•\nå¤§å°å†™æ•æ„Ÿ æ•°å€¼å‰å¿…é¡»æœ‰ç©ºæ ¼ï¼Œä½œä¸ºåˆ†éš”ç¬¦ ä½¿ç”¨ç¼©è¿›è¡¨ç¤ºå±‚çº§å…³ç³»ï¼Œç¼©è¿›æ—¶ï¼Œä¸å…è®¸ä½¿ç”¨tabé”®ï¼Œåªèƒ½ç”¨ç©ºæ ¼ï¼ˆideaä¼šè‡ªåŠ¨å°†Tabè½¬æ¢ä¸ºç©ºæ ¼ï¼‰ ç©ºæ ¼çš„æ•°ç›®ä¸é‡è¦ï¼Œåªè¦ç›¸åŒå±‚çº§çš„å…ƒç´ å·¦ä¾§å¯¹é½å³å¯ # è¡¨ç¤ºæ³¨é‡Šï¼Œ ä»è¿™ä¸ªå­—ç¬¦ä¸€ç›´åˆ°ç»“å°¾ï¼Œéƒ½ä¼šè¢«è§£é‡Šå™¨å¿½ç•¥ã€‚ @ConfigurationProperties åœ¨utilsä¸­æ–°å»ºæ–‡ä»¶AliOSSUtilsProperties.javaï¼Œ ç¼–å†™ä¸‹é¢çš„ç¨‹åº\n@Data @Component @ConfigurationProperties(prefix = \u0026#34;aliyun.oss\u0026#34;) public class AliOSSUtilsProperties { private String endpoint; private String accessKeyId; private String accessKeySecret; private String bucketName; } åœ¨AliOssutils.javaä¸­åªéœ€è¦ç¼–å†™ä¸‹é¢çš„ç¨‹åºå³å¯\n@Autowired private AliOSSUtilsProperties aliOSSUtilsProperties; /** * å®ç°ä¸Šä¼ å›¾ç‰‡åˆ°OSS */ String endpoint = aliOSSUtilsProperties.getEndpoint(); String accessKeyId = aliOSSUtilsProperties.getAccessKeyId(); String accessKeySecret = aliOSSUtilsProperties.getAccessKeySecret(); String bucketName = aliOSSUtilsProperties.getBucketName(); å’Œ@Valueå¯¹æ¯”\nç›¸åŒç‚¹ éƒ½æ˜¯ç”¨æ¥æ³¨å…¥å¤–éƒ¨é…ç½®çš„å±æ€§çš„ ä¸åŒç‚¹ @Valueæ³¨è§£åªèƒ½ä¸€ä¸ªä¸€ä¸ªçš„è¿›è¡Œå¤–éƒ¨å±æ€§çš„æ³¨å…¥ã€‚ @ConfigurationPropertieså¯ä»¥æ‰¹é‡çš„å°†å¤–éƒ¨çš„å±æ€§é…ç½®æ³¨å…¥åˆ°beanå¯¹è±¡çš„å±æ€§ä¸­ã€‚ ç»Ÿä¸€æ‹¦æˆª ä¼šè¯æŠ€æœ¯ ä¼šè¯ï¼šç”¨æˆ·æ‰“å¼€æµè§ˆå™¨ï¼Œè®¿é—®webæœåŠ¡å™¨çš„èµ„æºï¼Œä¼šè¯å»ºç«‹ï¼ŒçŸ¥é“æœ‰ä¸€æ–¹æ–­å¼€è¿æ¥ï¼Œä¼šè¯ç»“æŸï¼Œåœ¨ä¸€æ¬¡ä¼šè¯ä¸­å¯ä»¥åŒ…å«å¤šæ¬¡è¯·æ±‚å’Œå“åº”\nä¼šè¯è·Ÿè¸ªï¼šä¸€ç§ç»´æŠ¤æµè§ˆå™¨çŠ¶æ€çš„æ–¹æ³•ï¼ŒæœåŠ¡å™¨éœ€è¦è¯†åˆ«å¤šæ¬¡è¯·æ±‚æ˜¯å¦æ¥è‡ªäºåŒä¸€æµè§ˆå™¨ï¼Œä»¥ä¾¿åœ¨åŒä¸€æ¬¡ä¼šè¯çš„å¤šæ¬¡è¯·æ±‚é—´å…±äº«æ•°æ®\nä¼šè¯è·Ÿè¸ªæŠ€æœ¯æ–¹æ¡ˆï¼š\nå®¢æˆ·ç«¯ä¼šè¯è·Ÿè¸ªæŠ€æœ¯ï¼šCookie æœåŠ¡ç«¯ä¼šè¯è·Ÿè¸ªæŠ€æœ¯ï¼šSession ä»¤ç‰ŒæŠ€æœ¯ Cookie ä¼˜ç‚¹ï¼š\nHTTPåè®®ä¸­æ”¯æŒçš„æŠ€æœ¯ ç¼ºç‚¹ï¼š\nç§»åŠ¨ç«¯APPæ— æ³•ä½¿ç”¨Cookie ä¸å®‰å…¨ï¼Œ ç”¨æˆ·å¯ä»¥è‡ªå·±ç¦ç”¨Cookie Cookieä¸èƒ½è·¨åŸŸ è·¨åŸŸåŒºåˆ†ä¸‰ä¸ªç»´åº¦ï¼šåè®®ï¼ŒIP/åŸŸåï¼Œç«¯å£ @GetMapping(\u0026#34;/cookie1\u0026#34;) public Result cookie1(HttpServletResponse response){ response.addCookie(new Cookie(\u0026#34;login_username\u0026#34;, \u0026#34;Kennem\u0026#34;)); return Result.success(); } @GetMapping(\u0026#34;/cookie2\u0026#34;) public Result cookie2(HttpServletRequest request){ Cookie[] cookies = request.getCookies(); for(Cookie cookie : cookies){ if(cookie.getName().equals(\u0026#34;login_username\u0026#34;)){ System.out.println(\u0026#34;login_username: \u0026#34; + cookie.getValue()); } } return Result.success(); } Session ä¼˜ç‚¹ï¼š\nå­˜å‚¨åœ¨æœåŠ¡ç«¯ï¼Œå®‰å…¨ æœåŠ¡å™¨é›†ç¾¤ç¯å¢ƒä¸‹æ— æ³•ç›´æ¥ä½¿ç”¨Session Cookieçš„ç¼ºç‚¹ @GetMapping(\u0026#34;/session1\u0026#34;) public Result session1(HttpSession httpSession){ log.info(\u0026#34;HttpSession-s1 {}\u0026#34;, httpSession.hashCode()); httpSession.setAttribute(\u0026#34;loginUser\u0026#34;, \u0026#34;Kennem\u0026#34;); return Result.success(); } @GetMapping(\u0026#34;/session2\u0026#34;) public Result session2(HttpServletRequest request){ HttpSession session = request.getSession(); log.info(\u0026#34;HttpSession-s2 {}\u0026#34;, session.hashCode()); Object loginUser = session.getAttribute(\u0026#34;loginUser\u0026#34;); log.info(\u0026#34;loginUser {}\u0026#34;, loginUser); return Result.success(loginUser); } ä»¤ç‰ŒæŠ€æœ¯ ä¼˜ç‚¹ï¼š\næ”¯æŒPCç«¯ï¼Œç§»åŠ¨ç«¯ è§£å†³é›†ç¾¤ç¯å¢ƒä¸‹çš„è®¤è¯é—®é¢˜ å‡è½»æœåŠ¡ç«¯å­˜å‚¨å‹åŠ› ç¼ºç‚¹ï¼š\néœ€è¦è‡ªå·±å®ç° JWT JSON Web Token å®šä¹‰äº†ä¸€ç§ç®€æ´çš„ï¼Œè‡ªåŒ…å«çš„æ ¼å¼ï¼Œç”¨äºåœ¨é€šä¿¡åŒæ–¹ä»¥jsonæ•°æ®æ ¼å¼å®‰å…¨çš„ä¼ è¾“ä¿¡æ¯ã€‚ç”±äºæ•°å­—ç­¾åçš„å­˜åœ¨ï¼Œè¿™äº›ä¿¡æ¯æ—¶å¯é çš„ã€‚ ç»„æˆï¼š ç¬¬ä¸€éƒ¨åˆ†ï¼šHeaderï¼ˆå¤´ï¼‰ï¼Œè®°å½•ä»¤ç‰Œç±»å‹ï¼Œç­¾åç®—æ³•ç­‰ã€‚ä¾‹å¦‚ï¼š{\u0026ldquo;alg\u0026rdquo;:\u0026ldquo;HS256\u0026rdquo;, \u0026ldquo;\u0026rdquo;} ç¬¬äºŒéƒ¨åˆ†ï¼šPayloadï¼ˆæœ‰æ•ˆè½½è·ï¼‰ï¼Œæºå¸¦ä¸€äº›è‡ªå®šä¹‰ä¿¡æ¯ï¼Œé»˜è®¤ä¿¡æ¯ç­‰ã€‚ä¾‹å¦‚ï¼š{â€˜\u0026ldquo;id\u0026rdquo;:\u0026ldquo;1\u0026rdquo;, \u0026ldquo;username\u0026rdquo;:\u0026ldquo;Tom\u0026rdquo;} ç¬¬ä¸‰éƒ¨åˆ†ï¼šSignatureï¼ˆç­¾åï¼‰ï¼Œæ”¾ç½®Tokenè¢«ç¯¡æ”¹ï¼Œç¡®ä¿å®‰å…¨æ€§ã€‚å°†headerï¼Œpayload, å¹¶åŠ å…¥æŒ‡å®šå¯†é’¥ï¼ŒåŒè¿‡æŒ‡å®šç­¾åç®—æ³•è€Œæ¥ã€‚ Base64ï¼šæ˜¯ä¸€ç§åŸºäº64ä¸ªå¯æ‰“å°å­—ç¬¦ï¼ˆA-Z, a-z, 0-9, + /)æ¥è¡¨ç¤ºäºŒè¿›åˆ¶æ•°æ®çš„ç¼–ç æ–¹å¼\nåœºæ™¯ï¼šç™»å½•è®¤è¯ ç™»å½•æˆåŠŸåï¼Œç”Ÿæˆä»¤ç‰Œ åç»­çš„æ¯ä¸ªè¯·æ±‚ï¼Œéƒ½è¦æºå¸¦JWTä»¤ç‰Œï¼Œç³»ç»Ÿåœ¨æ¯æ¬¡è¯·æ±‚å¤„ç†ä¹‹å‰ï¼Œå…ˆæ ¡éªŒçµæ‘†ï¼Œé€šè¿‡åï¼Œå†å¤„ç†ã€‚ @Test public void testGenJwt(){ Map\u0026lt;String, Object\u0026gt; claims = new HashMap\u0026lt;\u0026gt;(); claims.put(\u0026#34;id\u0026#34;, 1); claims.put(\u0026#34;name\u0026#34;, 2); claims.put(\u0026#34;company\u0026#34;, \u0026#34;xiaomi\u0026#34;); String jwt = Jwts.builder() .signWith(SignatureAlgorithm.HS256, \u0026#34;Kennem\u0026#34;) .setClaims(claims) .setExpiration(new Date(System.currentTimeMillis())) // è®¾ç½®æœ‰æ•ˆæœŸä¸ºä¸€ä¸ªå°æ—¶ .compact(); System.out.println(jwt); } @Test public void parseJwt(){ Claims claims = Jwts.parser() .setSigningKey(\u0026#34;Kennem\u0026#34;) .parseClaimsJws(\u0026#34;eyJhbGciOiJIUzI1NiJ9.eyJuYW1lIjoyLCJjb21wYW55IjoieGlhb21pIiwiaWQiOjEsImV4cCI6MTcxODAwMzMwM30.raK4huIfzd9RY0T3U2a9DGsxHFYLRGYbzTrbqXJabaA\u0026#34;) .getBody(); System.out.println(claims); } æ³¨æ„äº‹é¡¹ï¼š\nJWTæ ¡éªŒæ—¶ä½¿ç”¨çš„ç­¾åå¯†é’¥ï¼Œå¿…é¡»å’Œç”ŸæˆJWTä»¤ç‰Œæ—¶ä½¿ç”¨çš„å¯†é’¥æ—¶é…å¥—çš„ã€‚ å¦‚æœJWTä»¤ç‰Œè§£ææ ¡éªŒæ—¶æŠ¥é”™ï¼Œåˆ™è¯´æ˜JWTä»¤ç‰Œè¢«ç¯¡æ”¹æˆ–å¤±æ•ˆäº†ï¼Œä»¤ç‰Œéæ³•ã€‚ è¿‡æ»¤å™¨Filter Filterè¿‡æ»¤å™¨ï¼Œæ—¶Java webä¸‰å¤§ç»„ä»¶ï¼ˆServlet, Filter, Listenerï¼‰ä¹‹ä¸€ è¿‡æ»¤å™¨å¯ä»¥æŠŠå¯¹èµ„æºçš„è¯·æ±‚æ‹¦æˆªä¸‹æ¥ï¼Œä»è€Œå®ç°ä¸€äº›ç‰¹æ®Šçš„åŠŸèƒ½ è¿‡æ»¤å™¨ä¸€èˆ¬å®Œæˆä¸€äº›é€šç”¨çš„æ“ä½œï¼Œæ¯”å¦‚ï¼šç™»å½•æ ¡éªŒã€ç»Ÿä¸€ç¼–ç å¤„ç†ï¼Œæ•æ„Ÿå­—ç¬¦å¤„ç†ç­‰ã€‚ //@WebFilter(urlPatterns = \u0026#34;/*\u0026#34;) //@WebFilter(urlPatterns = \u0026#34;/login\u0026#34;) @WebFilter(urlPatterns = \u0026#34;/depts/*\u0026#34;) public class DemoFilter implements Filter { @Override public void init(FilterConfig filterConfig) throws ServletException { System.out.println(\u0026#34;Init!\u0026#34;); } @Override public void doFilter(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain chain) throws IOException, ServletException { System.out.println(\u0026#34;Do Fileter!\u0026#34;); chain.doFilter(servletRequest, servletResponse); } @Override public void destroy() { System.out.println(\u0026#34;Destroy!\u0026#34;); } } æ‰§è¡Œæµç¨‹ï¼š\nè¯·æ±‚ -\u0026gt; æ”¾è¡Œå‰é€»è¾‘ -\u0026gt;æ”¾è¡Œ -\u0026gt;èµ„æº -\u0026gt;æ”¾è¡Œåé€»è¾‘ è¿‡æ»¤å™¨é“¾ ä¸€ä¸ªWebåº”ç”¨ä¸­ï¼Œå¯ä»¥é…ç½®å¤šä¸ªè¿‡æ»¤å™¨ï¼Œè¿™å¤šä¸ªè¿‡æ»¤å™¨å½¢æˆä¸€ä¸ªè¿‡æ»¤å™¨é“¾\né¡ºåºï¼šæ³¨è§£é…ç½®çš„Filterï¼Œä¼˜å…ˆçº§æ—¶æŒ‰ç…§è¿‡æ»¤å™¨ç±»åï¼ˆå­—ç¬¦ä¸²ï¼‰çš„è‡ªç„¶æ’åº(å­—å…¸åº)\nç™»å½•æ ¡éªŒ @Slf4j @WebFilter(urlPatterns = \u0026#34;/*\u0026#34;) public class LoginCheckFilter implements Filter { @Override public void doFilter(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain) throws IOException, ServletException { HttpServletRequest req = (HttpServletRequest) servletRequest; HttpServletResponse resp = (HttpServletResponse) servletResponse; String url = req.getRequestURI().toString(); log.info(\u0026#34;è¯·æ±‚çš„url {}\u0026#34;, url); if(url.contains(\u0026#34;login\u0026#34;)){ log.info(\u0026#34;ç™»å½•æ“ä½œï¼Œ æ”¾è¡Œ...\u0026#34;); filterChain.doFilter(servletRequest, servletResponse); return; } String jwt = req.getHeader(\u0026#34;token\u0026#34;); if(!StringUtils.hasLength(jwt)){ log.info(\u0026#34;è¯·æ±‚å¤´tokenä¸ºç©ºï¼Œ è¿”å›æœªç™»å½•çš„ä¿¡æ¯\u0026#34;); Result error = Result.error(\u0026#34;NOT_LOGIN\u0026#34;); String notLogin = JSONObject.toJSONString(error); resp.getWriter().write(notLogin); return ; } try{ JwtUtils.parseJWT(jwt); }catch (Exception e){ e.printStackTrace(); log.info(\u0026#34;è§£æä»¤ç‰Œå¤±è´¥ï¼Œè¿”å›æœªç™»å½•é”™è¯¯ä¿¡æ¯\u0026#34;); Result error = Result.error(\u0026#34;NOT_LOGIN\u0026#34;); // å‰ç«¯æ”¶åˆ°NOT_LOGIN ä¼šè¿”å›åˆ°ç™»å½•ç•Œé¢ String notLogin = JSONObject.toJSONString(error); resp.getWriter().write(notLogin); return ; } log.info(\u0026#34;æˆåŠŸç™»å½•\u0026#34;); filterChain.doFilter(servletRequest, servletResponse); } } æ‹¦æˆªå™¨ Interceptor Spring æä¾›çš„ï¼Œ åªèƒ½æ‹¦æˆªSpringç¯å¢ƒä¸­çš„èµ„æº\nç”¨æ¥åŠ¨æ€æ‹¦æˆªæ§åˆ¶å™¨æ–¹æ³•çš„æ‰§è¡Œ\næ‹¦æˆªè¯·æ±‚ï¼Œå†æŒ‡å®šçš„æ–¹æ³•è°ƒç”¨å‰åï¼Œæ ¹æ®ä¸šåŠ¡éœ€è¦æ‰§è¡Œé¢„å…ˆè®¾å®šçš„ä»£ç  /* è¡¨ç¤ºä¸€çº§è·¯å¾„\n/** è¡¨ç¤ºä»»æ„çº§åˆ«çš„è·¯å¾„\né…ç½®éœ€è¦æ‹¦æˆªçš„è·¯å¾„å’Œä¸éœ€è¦æ‹¦æˆªçš„è·¯å¾„\n@Override public void addInterceptors(InterceptorRegistry registry) { registry.addInterceptor(loginCheckinterceptor).addPathPatterns(\u0026#34;/**\u0026#34;).excludePathPatterns(\u0026#34;/login\u0026#34;); } Filter å’Œ Interceptor\næ¥å£è§„èŒƒä¸åŒï¼šè¿‡æ»¤å™¨éœ€è¦å®ç°Filteræ¥å£ï¼Œè€Œæ‹¦æˆªå™¨éœ€è¦å®ç°HandlerInterceptoræ¥å£ æ‹¦æˆªèŒƒå›´ä¸åŒï¼šè¿‡æ»¤å™¨Filterä¼šæ‹¦æˆªæ‰€æœ‰çš„èµ„æºï¼Œè€ŒInterceptoråªä¼šæ‹¦æˆªSpringç¯å¢ƒä¸­çš„èµ„æºã€‚ @Override // ç›®æ ‡èµ„æºæ–¹æ³•è¿è¡Œå‰è¿è¡Œï¼Œ true:æ”¾è¡Œ false:ä¸æ”¾è¡Œ public boolean preHandle(HttpServletRequest req, HttpServletResponse resp, Object handler) throws Exception { String url = req.getRequestURI().toString(); log.info(\u0026#34;è¯·æ±‚çš„url {}\u0026#34;, url); if(url.contains(\u0026#34;login\u0026#34;)){ log.info(\u0026#34;ç™»å½•æ“ä½œï¼Œ æ”¾è¡Œ...\u0026#34;); return true; } String jwt = req.getHeader(\u0026#34;token\u0026#34;); if(!StringUtils.hasLength(jwt)){ log.info(\u0026#34;è¯·æ±‚å¤´tokenä¸ºç©ºï¼Œ è¿”å›æœªç™»å½•çš„ä¿¡æ¯\u0026#34;); Result error = Result.error(\u0026#34;NOT_LOGIN\u0026#34;); String notLogin = JSONObject.toJSONString(error); resp.getWriter().write(notLogin); return false; } try{ JwtUtils.parseJWT(jwt); }catch (Exception e){ e.printStackTrace(); log.info(\u0026#34;è§£æä»¤ç‰Œå¤±è´¥ï¼Œè¿”å›æœªç™»å½•é”™è¯¯ä¿¡æ¯\u0026#34;); Result error = Result.error(\u0026#34;NOT_LOGIN\u0026#34;); // å‰ç«¯æ”¶åˆ°NOT_LOGIN ä¼šè¿”å›åˆ°ç™»å½•ç•Œé¢ String notLogin = JSONObject.toJSONString(error); resp.getWriter().write(notLogin); return false; } log.info(\u0026#34;æˆåŠŸç™»å½•\u0026#34;); return true; } @Override // ç›®æ ‡èµ„æºæ–¹æ³•è¿è¡Œåè¿è¡Œ public void postHandle(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView) throws Exception { System.out.println(\u0026#34;postHandle ...\u0026#34;); } @Override // è§†å›¾æ¸²æŸ“å®Œæ¯•åè¿è¡Œï¼Œæœ€åè¿è¡Œ public void afterCompletion(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex) throws Exception { System.out.println(\u0026#34;afterCompletion ...\u0026#34;); } å¼‚å¸¸å¤„ç† å…¨å±€å¼‚å¸¸å¤„ç†å™¨\nexception/GlobalExceptionHandler\n/** * å…¨å±€å¼‚å¸¸å¤„ç†å™¨ */ @RestControllerAdvice public class GlobalExceptionHandler{ @ExceptionHandler(Exception.class) public Result ex(Exception ex){ ex.printStackTrace(); return Result.error(\u0026#34;æ“ä½œé”™è¯¯ï¼å¯èƒ½çš„åŸå› ï¼šåç§°é‡å¤\u0026#34;); } } ","permalink":"https://kennems.github.io/posts/tech/java-web%E5%BC%80%E5%8F%915/","summary":"Java Webå¼€å‘(5) MyBatis MyBatisæ˜¯ä¸€æ¬¾ä¼˜ç§€çš„æŒä¹…å±‚æ¡†æ¶ï¼Œç”¨äºç®€åŒ–JDBCçš„å¼€å‘ã€‚ ä½¿ç”¨MybatisæŸ¥è¯¢æ‰€æœ‰ç”¨æˆ·æ•°æ® åˆ›å»ºSpringBoot","title":"Java Webå¼€å‘(5)"},{"content":"åŒå‘¨èµ›131(240525) AKçš„ç¬¬äºŒåœºğŸ˜ï¼Œ ç¬¬å››é¢˜æ˜¯ç”¨C++ æ‰¾ç½‘ä¸Šæ¨¡æ¿ï¼Œå¥—ç”¨æŸ¥æ‰¾æœ€é•¿çš„è¿0ä¸²è¿‡çš„ï¼Œ æœ€åä¸¤åˆ†é’Ÿæ‰è¿‡ï¼Œå¾ˆæƒŠé™©ã€‚èµ›åå‘ç°åšæ³•å¹¶ä¸ä¼˜ç§€ï¼Œä½†æ˜¯ä¸éœ€è¦å¹³è¡¡æ ‘ã€‚\n3161. ç‰©å—æ”¾ç½®æŸ¥è¯¢ é¢˜ç›®å¤§æ„ï¼š\næœ‰ä¸€æ¡æ— é™é•¿çš„æ•°è½´ï¼ŒåŸç‚¹åœ¨ 0 å¤„ï¼Œæ²¿ç€ x è½´æ­£æ–¹å‘æ— é™å»¶ä¼¸ã€‚ç»™å®šä¸€ä¸ªäºŒç»´æ•°ç»„ queries åŒ…å«ä¸¤ç§æ“ä½œï¼š\næ“ä½œç±»å‹ 1ï¼šåœ¨è·ç¦»åŸç‚¹ x å¤„å»ºä¸€ä¸ªéšœç¢ç‰©ã€‚ æ“ä½œç±»å‹ 2ï¼šåˆ¤æ–­åœ¨æ•°è½´èŒƒå›´ [0, x] å†…æ˜¯å¦å¯ä»¥æ”¾ç½®ä¸€ä¸ªé•¿åº¦ä¸º sz çš„ç‰©å—ï¼Œè¯¥ç‰©å—éœ€è¦å®Œå…¨æ”¾ç½®åœ¨èŒƒå›´ [0, x] å†…ã€‚å¦‚æœç‰©å—ä¸ä»»ä½•éšœç¢ç‰©æœ‰é‡åˆï¼Œåˆ™è¯¥ç‰©å—ä¸èƒ½è¢«æ”¾ç½®ï¼Œä½†ç‰©å—å¯ä»¥ä¸éšœç¢ç‰©åˆšå¥½æ¥è§¦ã€‚ å¯¹äºæ“ä½œç±»å‹ 2 çš„æŸ¥è¯¢ï¼Œè‹¥å¯ä»¥æ”¾ç½®ç‰©å—ï¼Œåˆ™è¿”å› trueï¼Œå¦åˆ™è¿”å› falseã€‚\nå®ç°æ€è·¯ï¼š\nçº¿æ®µæ ‘çš„æ„å»ºå’Œç»´æŠ¤ï¼š\nä½¿ç”¨ä¸€ä¸ªæ•°ç»„ tr æ¥è¡¨ç¤ºçº¿æ®µæ ‘ï¼Œåˆå§‹åŒ–ä¸ºå…¨é›¶ã€‚æ•°ç»„çš„é•¿åº¦å¯ä»¥é€šè¿‡æŸ¥è¯¢ä¸­çš„æœ€å¤§èŒƒå›´ç¡®å®šï¼Œå³ m = max(q[1] for q in queries)ã€‚ å®šä¹‰ pushup å‡½æ•°ç”¨äºæ›´æ–°çº¿æ®µæ ‘ä¸­çš„èŠ‚ç‚¹ä¿¡æ¯ï¼Œæ¯å½“ä¿®æ”¹çº¿æ®µæ ‘ä¸­æŸä¸ªèŠ‚ç‚¹çš„å€¼æ—¶è°ƒç”¨ã€‚ å®šä¹‰ modify å‡½æ•°ç”¨äºä¿®æ”¹çº¿æ®µæ ‘ä¸­çš„å€¼ï¼Œå°†æŸä¸ªä½ç½®çš„å€¼æ›´æ–°ä¸ºæ–°å€¼ï¼Œå¹¶æ ¹æ®éœ€è¦é€’å½’æ›´æ–°çˆ¶èŠ‚ç‚¹çš„ä¿¡æ¯ã€‚ å®šä¹‰ query å‡½æ•°ç”¨äºæŸ¥è¯¢çº¿æ®µæ ‘ä¸­æŸä¸ªåŒºé—´å†…çš„æœ€å¤§å€¼ã€‚ Sorted List çš„ç»´æŠ¤ï¼š\nä½¿ç”¨ SortedList ç»“æ„æ¥ç»´æŠ¤éšœç¢ç‰©çš„ä½ç½®ä¿¡æ¯ï¼ŒSortedSet æ˜¯ä¸€ä¸ªæœ‰åºçš„é›†åˆæ•°æ®ç»“æ„ã€‚ åœ¨æ“ä½œç±»å‹ 1 ä¸­ï¼Œå³æ·»åŠ éšœç¢ç‰©æ—¶ï¼Œä½¿ç”¨ bisect_left æ‰¾åˆ°åº”è¯¥æ’å…¥çš„ä½ç½®ï¼Œå¹¶åœ¨ç›¸åº”çš„ä½ç½®æ’å…¥æ–°çš„éšœç¢ç‰©ä½ç½®ï¼Œå¹¶æ›´æ–°çº¿æ®µæ ‘çš„ä¿¡æ¯ã€‚ æŸ¥è¯¢æ“ä½œç±»å‹ 2ï¼š\nå¯¹äºæ¯ä¸€ä¸ªæ“ä½œç±»å‹ 2 çš„æŸ¥è¯¢ï¼Œå…ˆæ‰¾åˆ°è¯¥ä½ç½®ä¹‹å‰æœ€è¿‘çš„éšœç¢ç‰©çš„ä½ç½® preï¼Œç„¶åé€šè¿‡çº¿æ®µæ ‘æŸ¥è¯¢è¯¥åŒºé—´å†…çš„æœ€å¤§å€¼ã€‚ å¦‚æœè¯¥å€¼å¤§äºç­‰äºæ‰€éœ€æ”¾ç½®ç‰©å—çš„å¤§å°ï¼Œåˆ™è¯´æ˜å¯ä»¥æ”¾ç½®ç‰©å—ï¼Œå¦åˆ™ä¸è¡Œã€‚ from sortedcontainers import SortedList class Solution: def getResults(self, queries: List[List[int]]) -\u0026gt; List[bool]: m = max(q[1] for q in queries) tr = [0]*(1\u0026lt;\u0026lt;m.bit_length() + 1) def pushup(u): tr[u] = max(tr[u\u0026lt;\u0026lt;1], tr[u\u0026lt;\u0026lt;1|1]) def modify(u, l, r, x, val): if l==r: tr[u] = val else: mid = l+r\u0026gt;\u0026gt;1 if x\u0026lt;=mid: modify(u\u0026lt;\u0026lt;1, l, mid, x, val) else: modify(u\u0026lt;\u0026lt;1|1, mid+1, r, x, val) pushup(u) def query(u, l, r, ql, qr): if ql\u0026lt;=l and r\u0026lt;=qr: return tr[u] mid = l+r\u0026gt;\u0026gt;1 res = 0 if ql\u0026lt;=mid: res = query(u\u0026lt;\u0026lt;1, l, mid, ql, qr) if qr\u0026gt;mid: res = max(res, query(u\u0026lt;\u0026lt;1|1, mid+1, r, ql, qr)) return res sl = SortedList([0, m]) res = [] for q in queries: x = q[1] i = sl.bisect_left(x) pre = sl[i-1] if q[0]==1: nxt = sl[i] sl.add(x) modify(1, 0, m, x, x-pre) modify(1, 0, m, nxt, nxt-x) else: sz = q[2] ans = max(x-pre, query(1, 0, m, 0, pre)) res.append(ans \u0026gt;= sz) return res æ¯”èµ›æ—¶çš„åšæ³•ï¼Œæœ¬æ¥æ˜¯C++ï¼Œè½¬æˆäº†python\nclass Node: def __init__(self): self.l = 0 self.r = 0 self.d = 0 self.ld = 0 self.rd = 0 self.low = -1 class Solution: def getResults(self, queries): def build(u, l, r): tr[u].l = l tr[u].r = r tr[u].d = r - l + 1 tr[u].ld = r - l + 1 tr[u].rd = r - l + 1 tr[u].low = -1 if l != r: mid = (l + r) \u0026gt;\u0026gt; 1 build(u \u0026lt;\u0026lt; 1, l, mid) build(u \u0026lt;\u0026lt; 1 | 1, mid + 1, r) def pushup(u): tr[u].ld = tr[u \u0026lt;\u0026lt; 1].ld if tr[u \u0026lt;\u0026lt; 1].ld == tr[u \u0026lt;\u0026lt; 1].r - tr[u \u0026lt;\u0026lt; 1].l + 1: tr[u].ld += tr[u \u0026lt;\u0026lt; 1 | 1].ld tr[u].rd = tr[u \u0026lt;\u0026lt; 1 | 1].rd if tr[u \u0026lt;\u0026lt; 1 | 1].rd == tr[u \u0026lt;\u0026lt; 1 | 1].r - tr[u \u0026lt;\u0026lt; 1 | 1].l + 1: tr[u].rd += tr[u \u0026lt;\u0026lt; 1].rd tr[u].d = max(max(tr[u \u0026lt;\u0026lt; 1].d, tr[u \u0026lt;\u0026lt; 1 | 1].d), tr[u \u0026lt;\u0026lt; 1].rd + tr[u \u0026lt;\u0026lt; 1 | 1].ld) def pushdown(u): if tr[u].low == -1: return tr[u \u0026lt;\u0026lt; 1].low = tr[u \u0026lt;\u0026lt; 1 | 1].low = tr[u].low if tr[u].low: tr[u \u0026lt;\u0026lt; 1].d = tr[u \u0026lt;\u0026lt; 1].ld = tr[u \u0026lt;\u0026lt; 1].rd = 0 tr[u \u0026lt;\u0026lt; 1 | 1].d = tr[u \u0026lt;\u0026lt; 1 | 1].ld = tr[u \u0026lt;\u0026lt; 1 | 1].rd = 0 else: tr[u \u0026lt;\u0026lt; 1].d = tr[u \u0026lt;\u0026lt; 1].ld = tr[u \u0026lt;\u0026lt; 1].rd = tr[u \u0026lt;\u0026lt; 1].r - tr[u \u0026lt;\u0026lt; 1].l + 1 tr[u \u0026lt;\u0026lt; 1 | 1].d = tr[u \u0026lt;\u0026lt; 1 | 1].ld = tr[u \u0026lt;\u0026lt; 1 | 1].rd = tr[u \u0026lt;\u0026lt; 1 | 1].r - tr[u \u0026lt;\u0026lt; 1 | 1].l + 1 tr[u].low = -1 def query(u, ql, qr): if tr[u].l \u0026gt; qr or tr[u].r \u0026lt; ql: return 0 if tr[u].l \u0026gt;= ql and tr[u].r \u0026lt;= qr: return tr[u].d pushdown(u) mid = (tr[u].l + tr[u].r) \u0026gt;\u0026gt; 1 res = 0 if ql \u0026lt;= mid: res = max(res, query(u \u0026lt;\u0026lt; 1, ql, qr)) if qr \u0026gt; mid: res = max(res, query(u \u0026lt;\u0026lt; 1 | 1, ql, qr)) # Cross left and right subintervals handling if ql \u0026lt;= mid and qr \u0026gt; mid: left_suffix = min(tr[u \u0026lt;\u0026lt; 1].rd, mid - ql + 1) right_prefix = min(tr[u \u0026lt;\u0026lt; 1 | 1].ld, qr - mid) res = max(res, left_suffix + right_prefix) return res def modify(u, l, r, d): if tr[u].l \u0026gt;= l and tr[u].r \u0026lt;= r: if d: tr[u].d = tr[u].ld = tr[u].rd = 0 tr[u].low = 1 else: tr[u].d = tr[u].ld = tr[u].rd = tr[u].r - tr[u].l + 1 tr[u].low = 0 return pushdown(u) mid = (tr[u].l + tr[u].r) \u0026gt;\u0026gt; 1 if l \u0026lt;= mid: modify(u \u0026lt;\u0026lt; 1, l, r, d) if r \u0026gt; mid: modify(u \u0026lt;\u0026lt; 1 | 1, l, r, d) pushup(u) n = max(q[1] for q in queries) tr = [Node() for _ in range(1\u0026lt;\u0026lt;n.bit_length() + 1)] build(1, 0, n) res = [] modify(1, 0, 0, 1) mp = {} for q in queries: if q[0] == 1: x = q[1] modify(1, x, x, 1) mp[x] = 1 else: x = q[1] sz = q[2] if x \u0026lt; sz: res.append(False) continue if mp.get(x) != 1: modify(1, x, x, 1) ans = query(1, 0, x) if mp.get(x) != 1: modify(1, x, x, 0) res.append(ans \u0026gt;= sz-1) return res ","permalink":"https://kennems.github.io/posts/tech/%E5%8F%8C%E5%91%A8%E8%B5%9B131240525/","summary":"åŒå‘¨èµ›131(240525) AKçš„ç¬¬äºŒåœºğŸ˜ï¼Œ ç¬¬å››é¢˜æ˜¯ç”¨C++ æ‰¾ç½‘ä¸Šæ¨¡æ¿ï¼Œå¥—ç”¨æŸ¥æ‰¾æœ€é•¿çš„è¿0ä¸²è¿‡çš„ï¼Œ æœ€åä¸¤åˆ†é’Ÿæ‰è¿‡ï¼Œå¾ˆæƒŠé™©ã€‚èµ›åå‘ç°åšæ³•å¹¶ä¸ä¼˜","title":"LeetCodeåŒå‘¨èµ›131(240525)"},{"content":"å‘¨èµ›399(240526) è¿™åœºæ‰åˆ†äº†ï¼Œç¬¬å››é¢˜æ²¡æ€è·¯ï¼Œè€Œä¸”ç½šæ—¶å¤ªå¤šäº†ğŸ˜¥\nç¬¬ä¸‰é¢˜3164. ä¼˜è´¨æ•°å¯¹çš„æ€»æ•° II é¢˜ç›®å¤§æ„ï¼š ç»™å®šä¸¤ä¸ªæ•´æ•°æ•°ç»„nums1å’Œnums2ï¼Œä»¥åŠä¸€ä¸ªæ­£æ•´æ•°kã€‚å¦‚æœnums1[i]å¯ä»¥è¢«nums2[j]*kæ•´é™¤ï¼Œåˆ™ç§°æ•°å¯¹(i, j)ä¸ºä¼˜è´¨æ•°å¯¹ã€‚è¦æ±‚è®¡ç®—ä¼˜è´¨æ•°å¯¹çš„æ€»æ•°ã€‚\nå®ç°æ€è·¯ï¼š\né¦–å…ˆï¼Œä½¿ç”¨Counterç»Ÿè®¡nums1ä¸­å¯ä»¥è¢«kæ•´é™¤çš„æ•°é™¤ä»¥kçš„ç»“æœï¼Œå¾—åˆ°c1ã€‚ ç„¶åï¼Œæ‰¾åˆ°c1ä¸­çš„æœ€å¤§å€¼mxï¼Œå¦‚æœc1ä¸ºç©ºï¼Œåˆ™mxä¸º0ã€‚ ä½¿ç”¨Counterç»Ÿè®¡nums2ä¸­å„ä¸ªæ•°å‡ºç°çš„æ¬¡æ•°ï¼Œå¾—åˆ°c2ã€‚ åˆå§‹åŒ–ç»“æœresä¸º0ã€‚ éå†c2ä¸­çš„æ¯ä¸ªæ•°nmå’Œå…¶å‡ºç°çš„æ¬¡æ•°cï¼Œå¯¹äºæ¯ä¸ªæ•°nmï¼Œä»nmå¼€å§‹é€’å¢åˆ°mxï¼Œæ­¥é•¿ä¸ºnmï¼Œè®¡ç®—c * c1[j]å¹¶ç´¯åŠ åˆ°resä¸­ã€‚ æœ€ç»ˆè¿”å›resä½œä¸ºä¼˜è´¨æ•°å¯¹çš„æ€»æ•°ã€‚ class Solution: def numberOfPairs(self, nums1: List[int], nums2: List[int], k: int) -\u0026gt; int: c1 = Counter(nm//k for nm in nums1 if nm%k==0) mx = max(nm for nm, _ in c1.items()) if c1 else 0 c2 = Counter(nums2) res = 0 for nm, c in c2.items(): for j in range(nm, mx+1, nm): res += c * c1[j] return res ç¬¬å››é¢˜3165. ä¸åŒ…å«ç›¸é‚»å…ƒç´ çš„å­åºåˆ—çš„æœ€å¤§å’Œ é¢˜ç›®å¤§æ„ ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ nums å’Œä¸€ä¸ªäºŒç»´æ•°ç»„ queriesï¼Œå…¶ä¸­ queries[i] = [posi, xi] è¡¨ç¤ºå¯¹äºæ¯ä¸ªæŸ¥è¯¢ iï¼Œé¦–å…ˆå°† nums[posi] è®¾ç½®ä¸º xiï¼Œç„¶åè®¡ç®—æŸ¥è¯¢ i çš„ç­”æ¡ˆã€‚ç­”æ¡ˆä¸º nums ä¸­ä¸åŒ…å«ç›¸é‚»å…ƒç´ çš„å­åºåˆ—çš„æœ€å¤§å’Œã€‚æœ€ç»ˆè¿”å›æ‰€æœ‰æŸ¥è¯¢çš„ç­”æ¡ˆä¹‹å’Œã€‚\nå®ç°æ€è·¯ æ„å»ºçº¿æ®µæ ‘ï¼šä½¿ç”¨çº¿æ®µæ ‘ç»´æŠ¤åŒºé—´çš„æœ€å¤§å’Œã€‚ çº¿æ®µæ ‘èŠ‚ç‚¹ tr[u] å­˜å‚¨äº†å››ä¸ªå€¼ï¼Œåˆ†åˆ«è¡¨ç¤ºï¼š ä¸è·¨è¶ŠåŒºé—´çš„æœ€å¤§å’Œï¼ˆæ— ç›¸é‚»å…ƒç´ ï¼‰ã€‚ åŒºé—´å·¦ç«¯ç‚¹ä¸ºèµ·ç‚¹çš„æœ€å¤§å’Œï¼ˆæ— ç›¸é‚»å…ƒç´ ï¼‰ã€‚ åŒºé—´å³ç«¯ç‚¹ä¸ºèµ·ç‚¹çš„æœ€å¤§å’Œï¼ˆæ— ç›¸é‚»å…ƒç´ ï¼‰ã€‚ åŒºé—´çš„æœ€å¤§å’Œã€‚ å®šä¹‰ pushup å‡½æ•°æ›´æ–°èŠ‚ç‚¹å€¼ï¼Œå®šä¹‰ build å‡½æ•°æ„å»ºçº¿æ®µæ ‘ã€‚ æ›´æ–°æ“ä½œï¼šæ›´æ–°çº¿æ®µæ ‘ä¸­çš„èŠ‚ç‚¹å€¼ã€‚ å®šä¹‰ update å‡½æ•°æ›´æ–°çº¿æ®µæ ‘ä¸­çš„èŠ‚ç‚¹å€¼ã€‚ éå†æŸ¥è¯¢ï¼šå¯¹æ¯ä¸ªæŸ¥è¯¢ï¼Œæ›´æ–° nums ä¸­å¯¹åº”ä½ç½®çš„å€¼ï¼Œå¹¶è®¡ç®—å½“å‰çš„æœ€å¤§å’Œã€‚ æœ€ç»ˆè¿”å›æ‰€æœ‰æŸ¥è¯¢çš„ç­”æ¡ˆä¹‹å’Œï¼Œè®°å¾—å¯¹ç»“æœå–æ¨¡ã€‚ class Solution: def maximumSumSubsequence(self, nums: List[int], queries: List[List[int]]) -\u0026gt; int: def pushup(u): l, r = tr[u\u0026lt;\u0026lt;1], tr[u\u0026lt;\u0026lt;1|1] tr[u][0] = max(l[1]+r[0], l[0]+r[2]) tr[u][1] = max(l[0]+r[3], l[1]+r[1]) tr[u][2] = max(l[2]+r[2], l[3]+r[0]) tr[u][3] = max(l[2]+r[3], l[3]+r[1]) def build(u, l, r): if l==r: tr[u][3] = max(nums[l], 0) else: mid = l+r\u0026gt;\u0026gt;1 build(u\u0026lt;\u0026lt;1, l, mid) build(u\u0026lt;\u0026lt;1|1, mid+1, r) pushup(u) def update(u, l, r, x, val): if l==r: tr[u][3] = max(0, val) return mid = l+r\u0026gt;\u0026gt;1 if x\u0026lt;=mid: update(u\u0026lt;\u0026lt;1, l, mid, x, val) else: update(u\u0026lt;\u0026lt;1|1, mid+1, r, x, val) pushup(u) n = len(nums) tr = [[0]*4 for _ in range(1\u0026lt;\u0026lt;n.bit_length() + 1)] mod = int(1e9) + 7 res = 0 build(1, 0, n-1) for pos, x in queries: update(1, 0, n-1, pos, x) res = (res + tr[1][3])%mod return res ","permalink":"https://kennems.github.io/posts/tech/%E5%91%A8%E8%B5%9B399240526/","summary":"å‘¨èµ›399(240526) è¿™åœºæ‰åˆ†äº†ï¼Œç¬¬å››é¢˜æ²¡æ€è·¯ï¼Œè€Œä¸”ç½šæ—¶å¤ªå¤šäº†ğŸ˜¥ ç¬¬ä¸‰é¢˜3164. ä¼˜è´¨æ•°å¯¹çš„æ€»æ•° II é¢˜ç›®å¤§æ„ï¼š ç»™å®šä¸¤ä¸ªæ•´æ•°æ•°ç»„nums1å’Œn","title":"LeetCodeå‘¨èµ›399(240526)"},{"content":"Pythonåº“ ç¨‹åºæ˜“é”™ç‚¹ ï¼š\nå˜é‡æœªå£°æ˜ i,j,kå˜é‡å†™é”™äº† å˜é‡åä¸€å®šè¦çœ‹æ¸…æ¥š å‡½æ•°ä½“å†…å˜é‡å’Œå¤–éƒ¨å˜é‡åˆ†ä¸æ¸…ï¼Œå˜é‡åç›¸è¿‘çš„ä¸€å®šè¦çœ‹æ¸…æ¥š 11+12+16+15+12+12 = 78\nä¸ƒå¤•ç¥­ é¢˜ç›®å¤§æ„ï¼š TYVJ ä¸ƒå¤•ç¥­çš„ä¼šåœºæ˜¯ä¸€ä¸ª N è¡Œ M åˆ—çš„çŸ©å½¢ï¼Œå…±æœ‰ NÃ—M ä¸ªæ‘Šç‚¹ã€‚Vani é‚€è¯· cl åŒå­¦æ¥å‚åŠ ï¼Œä½† cl åªå¯¹å…¶ä¸­çš„ä¸€éƒ¨åˆ†æ‘Šç‚¹æ„Ÿå…´è¶£ã€‚Vani å¸Œæœ›èƒ½å¤Ÿé€šè¿‡è°ƒæ•´æ‘Šç‚¹çš„å¸ƒç½®ï¼Œä½¿å¾—æ¯è¡Œå’Œæ¯åˆ—ä¸­ cl æ„Ÿå…´è¶£çš„æ‘Šç‚¹æ•°ç›¸ç­‰ã€‚ç°åœ¨éœ€è¦åˆ¤æ–­æ˜¯å¦èƒ½æ»¡è¶³è¿™ä¸¤ä¸ªè¦æ±‚ï¼Œå¹¶è®¡ç®—æœ€å°‘éœ€è¦äº¤æ¢çš„æ‘Šç‚¹æ•°ã€‚\nå®ç°æ€è·¯ï¼š\nå®šä¹‰å‡½æ•° get(a, n)ï¼Œç”¨äºè®¡ç®—æ•°ç»„ a ä¸­ä½¿å¾—æ¯ä¸ªå…ƒç´ éƒ½ç­‰äºå…¶ä¸­ä½æ•°æ‰€éœ€çš„æœ€å°‘æ“ä½œæ¬¡æ•°ã€‚è¯¥å‡½æ•°é¦–å…ˆè®¡ç®—æ•°ç»„ a çš„å‡å€¼ï¼Œç„¶åè®¡ç®—æ•°ç»„ä¸­æ¯ä¸ªå…ƒç´ ä¸å‡å€¼çš„å·®å€¼ï¼Œå–å·®å€¼çš„ä¸­ä½æ•°ä½œä¸ºç›®æ ‡ä¸­ä½æ•°ã€‚æ¥ç€è®¡ç®—æ¯ä¸ªå…ƒç´ ä¸ç›®æ ‡ä¸­ä½æ•°çš„å·®å€¼çš„ç»å¯¹å€¼ä¹‹å’Œï¼Œå³ä¸ºæœ€å°‘æ“ä½œæ¬¡æ•°ã€‚ è§£æè¾“å…¥ï¼Œç»Ÿè®¡æ¯è¡Œå’Œæ¯åˆ—ä¸­ cl æ„Ÿå…´è¶£çš„æ‘Šç‚¹æ•°ï¼Œå¹¶ä¿å­˜åœ¨æ•°ç»„ r å’Œ c ä¸­ã€‚ æ ¹æ® cl æ„Ÿå…´è¶£çš„æ‘Šç‚¹æ•°æ˜¯å¦èƒ½è¢«è¡Œæ•°å’Œåˆ—æ•°æ•´é™¤ï¼Œåˆ†æƒ…å†µè®¨è®ºï¼š å¦‚æœä¸èƒ½åŒæ—¶æ•´é™¤è¡Œæ•°å’Œåˆ—æ•°ï¼Œåˆ™è¾“å‡º \u0026ldquo;impossible\u0026rdquo;ã€‚ å¦‚æœèƒ½åŒæ—¶æ•´é™¤è¡Œæ•°å’Œåˆ—æ•°ï¼Œå³ t % n == 0 ä¸” t % m == 0ï¼Œåˆ™è¯´æ˜å¯ä»¥é€šè¿‡è°ƒæ•´æ‘Šç‚¹ä½¿å¾—æ¯è¡Œå’Œæ¯åˆ—ä¸­ cl æ„Ÿå…´è¶£çš„æ‘Šç‚¹æ•°ç›¸ç­‰ã€‚è¾“å‡º \u0026ldquo;both\u0026rdquo;ï¼Œå¹¶è°ƒç”¨ get å‡½æ•°è®¡ç®—æœ€å°‘äº¤æ¢æ¬¡æ•°ã€‚ å¦‚æœåªèƒ½æ•´é™¤è¡Œæ•°æˆ–è€…åˆ—æ•°ï¼Œè€Œä¸èƒ½åŒæ—¶æ•´é™¤ï¼Œåˆ™è¯´æ˜åªèƒ½ä½¿æ¯è¡Œæˆ–è€…æ¯åˆ—ä¸­ cl æ„Ÿå…´è¶£çš„æ‘Šç‚¹æ•°ç›¸ç­‰ã€‚åˆ†åˆ«è¾“å‡º \u0026ldquo;row\u0026rdquo; æˆ–è€… \u0026ldquo;column\u0026rdquo;ï¼Œå¹¶è°ƒç”¨ get å‡½æ•°è®¡ç®—æœ€å°‘äº¤æ¢æ¬¡æ•°ã€‚ $p[i] : iç»™i+1 \\enspace p[i]ä¸ªç³–æœ$ $åˆ™ ans = \\sum_{i=1}^n|p[i]| $ $\tp[1]=a[1]-avg $ $é€’æ¨ \\enspace p[2]=p[1]+a[2]-avg $ $p[3]=p[2]+a[3]-avg = p[1]+a[2]-avg+a[3]-avg $ $p[4]=p[3]+a[4]-avg = p[2]+p[3]-avg+a[4]-avg = p[1]+a[2]-avg+a[3]-avg+a[4]-avg $ $=\\sum_{i=2}^4{(a[i]-avg)} - p[1] $\nfrom collections import defaultdict r = defaultdict(int) c = defaultdict(int) s = defaultdict(int) def get_ans(a, n): ans = 0 avg = sum(a.values()) // n for i in a: a[i] -= avg s[1] = 0 prev_sum = 0 sorted_values = sorted(a.values()) mid = sorted_values[n // 2] for i in range(2, n + 1): prev_sum += a[i] s[i] = prev_sum for i in s.values(): ans += abs(i - mid) return ans n, m, t = map(int, input().split()) for _ in range(t): x, y = map(int, input().split()) r[x] += 1 c[y] += 1 if t % n != 0 and t % m != 0: print(\u0026#34;impossible\u0026#34;) elif t % n == 0 and t % m == 0: print(\u0026#34;both\u0026#34;, get_ans(r, n) + get_ans(c, m)) elif t % n == 0: print(\u0026#34;row\u0026#34;, get_ans(r, n)) else: print(\u0026#34;column\u0026#34;, get_ans(c, m)) çº¿æ®µæ ‘ #include \u0026lt;iostream\u0026gt; #include \u0026lt;vector\u0026gt; #include \u0026lt;cmath\u0026gt; using namespace std; const int mod = 998244353; vector\u0026lt;int\u0026gt; tr; void pushup(int u) { tr[u] = (1LL * tr[u\u0026lt;\u0026lt;1] * tr[u\u0026lt;\u0026lt;1|1]) % mod; } void build(int u, int l, int r, vector\u0026lt;int\u0026gt;\u0026amp; a) { if (l == r) { tr[u] = a[l]; return; } int mid = (l + r) \u0026gt;\u0026gt; 1; build(u\u0026lt;\u0026lt;1, l, mid, a); build(u\u0026lt;\u0026lt;1|1, mid+1, r, a); pushup(u); } void modify(int u, int l, int r, int x, int v) { if (l == r) { tr[u] = v; return; } int mid = (l + r) \u0026gt;\u0026gt; 1; if (x \u0026lt;= mid) { modify(u\u0026lt;\u0026lt;1, l, mid, x, v); } else { modify(u\u0026lt;\u0026lt;1|1, mid+1, r, x, v); } pushup(u); } int query(int u, int l, int r, int ql, int qr) { if (ql \u0026lt;= l \u0026amp;\u0026amp; r \u0026lt;= qr) { return tr[u]; } int mid = (l + r) \u0026gt;\u0026gt; 1; int res = 1; if (ql \u0026lt;= mid) { res = 1LL * res * query(u\u0026lt;\u0026lt;1, l, mid, ql, qr) % mod; } if (qr \u0026gt; mid) { res = 1LL * res * query(u\u0026lt;\u0026lt;1|1, mid+1, r, ql, qr) % mod; } return res; } int main() { ios::sync_with_stdio(false); cin.tie(0); cout.tie(0); int n, m; cin \u0026gt;\u0026gt; n \u0026gt;\u0026gt; m; tr.resize(1 \u0026lt;\u0026lt; (int)ceil(log2(n)) + 1); vector\u0026lt;int\u0026gt; a(n + 1); for (int i = 1; i \u0026lt;= n; ++i) { cin \u0026gt;\u0026gt; a[i]; } build(1, 1, n, a); for (int i = 0; i \u0026lt; m; ++i) { int op; cin \u0026gt;\u0026gt; op; if (op == 1) { int l, r, x; cin \u0026gt;\u0026gt; l \u0026gt;\u0026gt; r \u0026gt;\u0026gt; x; for (int pos = l; pos \u0026lt;= r; ++pos) { if (a[pos] \u0026lt;= x) { modify(1, 1, n, pos, x); a[pos] = x; } } } else { int l, r; cin \u0026gt;\u0026gt; l \u0026gt;\u0026gt; r; cout \u0026lt;\u0026lt; query(1, 1, n, l, r) \u0026lt;\u0026lt; endl; } } return 0; } from sys import stdin input = lambda:stdin.readline().strip() def pushup(u): tr[u] = tr[u\u0026lt;\u0026lt;1] * tr[u\u0026lt;\u0026lt;1|1] % mod def build(u, l, r): if l==r: tr[u] = a[l] return mid = l+r\u0026gt;\u0026gt;1 build(u\u0026lt;\u0026lt;1, l, mid) build(u\u0026lt;\u0026lt;1|1, mid+1, r) pushup(u) def modify(u, l, r, x, v): if l==r: tr[u] = v return mid = l+r\u0026gt;\u0026gt;1 if x\u0026lt;=mid: modify(u\u0026lt;\u0026lt;1, l, mid, x, v) else: modify(u\u0026lt;\u0026lt;1|1, mid+1, r, x, v) pushup(u) def query(u, l, r, ql, qr): if ql\u0026lt;=l and r\u0026lt;=qr: return tr[u]%mod mid = l+r\u0026gt;\u0026gt;1 res = 1 if ql\u0026lt;=mid: res = res*query(u\u0026lt;\u0026lt;1, l, mid, ql, qr)%mod if qr\u0026gt;mid: res = res*query(u\u0026lt;\u0026lt;1|1, mid+1, r, ql, qr)%mod return res n, m = map(int, input().split()) tr = [1]*(1\u0026lt;\u0026lt;n.bit_length() + 1) a = [0] + list(map(int, input().split())) mod = 998244353 build(1, 1, n) for i in range(m): q = list(map(int, input().split())) if q[0]==1: _, l, r, x = q for pos in range(l, r+1): if a[i]\u0026lt;=x: modify(1, 1, n, pos, x) a[i] = x else: _, l, r = q print(query(1, 1, n, l, r)) é¢˜ç›® æ—¥æœŸå·®å€¼ mm = [0, 31, 28, 31, 30, 31, 30, 31, 31, 30,31, 30, 31] def day(x): y = int(x/10000) m = int((x/100)%100) d = x%100 mm[2]=29 if (y%4==0 and y%100!=0) or y%400==0 else 28 for i in range(1, m): d+=mm[i] for i in range(1, y): d+=366 if (i%4==0 and i%100!=0) or i%400==0 else 365 return d while True: try: x=int(input()) y=int(input()) print( abs(day(x)-day(y))+1 ) except: break ç‰¹æ®Šæ’åº # Forward declaration of compare API. # def compare(a, b): # @param a, b int # @return bool # return bool means whether a is less than b. class Solution(object): def specialSort(self, N): \u0026#34;\u0026#34;\u0026#34; :type N: int :rtype: List[int] \u0026#34;\u0026#34;\u0026#34; a = [1] for i in range(2, N+1): l, r = 0, len(a)-1 while l\u0026lt;r: mid = (l+r)\u0026gt;\u0026gt;1 if compare(i, a[mid]): r=mid else: l=mid+1 a[r+1:]=a[r:] a[r]=i if compare(a[r+1],a[r]): a[r], a[r+1] = a[r+1], a[r] return a çº¿æ®µæ ‘ # å®šä¹‰æ ‘èŠ‚ç‚¹ï¼Œl,r, valè¡¨ç¤ºè¯¥èŠ‚ç‚¹è®°å½•çš„æ˜¯åŒºé—´[l, r]çš„æœ€å¤§å€¼æ˜¯val class Tree(): def __init__(self): self.l = 0 self.r = 0 self.lazy = 0 self.val = 0 # äºŒå‰æ ‘æ˜¯å †å½¢å¼ï¼Œå¯ä»¥ç”¨ä¸€ç»´æ•°ç»„å­˜å‚¨ï¼Œæ³¨æ„æ•°ç»„é•¿åº¦è¦å¼€4å€ç©ºé—´ tree = [Tree() for i in range(10*4)] # å»ºæ ‘ï¼Œç”¨cur\u0026lt;\u0026lt;1è®¿é—®å·¦å­æ ‘ï¼Œcur\u0026lt;\u0026lt;1|1è®¿é—®å³å­æ ‘ï¼Œä½è¿ç®—æ“ä½œå¾ˆæ–¹ä¾¿ def build(cur, l, r): tree[cur].l, tree[cur].r, tree[cur].lazy, tree[cur].val = l, r, 0, 0 # å½“l==rçš„æ—¶å€™ç»“æŸé€’å½’ if l \u0026lt; r: mid = l + r \u0026gt;\u0026gt; 1 build(cur\u0026lt;\u0026lt;1, l, mid) build(cur\u0026lt;\u0026lt;1|1, mid+1, r) # å½“å­èŠ‚ç‚¹è®¡ç®—å®Œæˆåï¼Œç”¨å­èŠ‚ç‚¹çš„å€¼æ¥æ›´æ–°è‡ªå·±çš„å€¼ def pushup(cur): tree[cur].val = max(tree[cur\u0026lt;\u0026lt;1].val, tree[cur\u0026lt;\u0026lt;1|1].val) # å•ç‚¹æ›´æ–° def add(cur, x, v): if tree[cur].l == tree[cur].r: tree[cur].val += v else: mid = tree[cur].r + tree[cur].l \u0026gt;\u0026gt; 1 if x \u0026gt; mid: add(cur\u0026gt;\u0026gt;1|1, x, v) else: add(cur\u0026lt;\u0026lt;1, x, v) pushup(cur) # å°†lazyæ ‡è®°å‘ä¸‹ä¼ é€’ä¸€å±‚ def pushdown(cur): if tree[cur].lazy: lazy = tree[cur].lazy tree[cur\u0026lt;\u0026lt;1].lazy += lazy tree[cur\u0026lt;\u0026lt;1|1].lazy += lazy tree[cur\u0026lt;\u0026lt;1].val += lazy tree[cur\u0026lt;\u0026lt;1|1].val += lazy tree[cur].lazy = 0 # åŒºé—´æ›´æ–° def update(cur, l, r, v): if l \u0026lt;= tree[cur].l and tree[cur].r \u0026lt;= r: tree[cur].lazy += v tree[cur].val += v return if r \u0026lt; tree[cur].l or l \u0026gt; tree[cur].r: return if tree[cur].lazy: pushdown(cur) update(cur\u0026lt;\u0026lt;1, l, r, v) update(cur\u0026lt;\u0026lt;1|1, l, r, v) pushup(cur) # åŒºé—´æŸ¥è¯¢ def query(cur, l, r): if l \u0026lt;= tree[cur].l and tree[cur].r \u0026lt;= r: return tree[cur].val if tree[cur].l \u0026gt; r or tree[cur].r \u0026lt; l: return 0 if tree[cur].lazy: pushdown(cur) return max(query(cur\u0026lt;\u0026lt;1, l, r), query(cur\u0026lt;\u0026lt;1|1)) # æµ‹è¯• # ----- # --- # ------- # -- # -- build(1, 1, 10) update(1, 1, 5, 1) update(1, 7, 10, 1) update(1, 2, 8, 1) update(1, 3, 4, 1) update(1, 9, 10, 1) print(query(1, 1, 10)) def pushup(u): tr[u] = tr[u \u0026lt;\u0026lt; 1] + tr[u \u0026lt;\u0026lt; 1 | 1] def build(u, l, r): if l == r: tr[u] = 0 else: mid = (l + r) \u0026gt;\u0026gt; 1 build(u \u0026lt;\u0026lt; 1, l, mid) build(u \u0026lt;\u0026lt; 1 | 1, mid + 1, r) pushup(u) def query(u, l, r, ql, qr): if l \u0026gt;= ql and r \u0026lt;= qr: return tr[u] mid = (l + r) \u0026gt;\u0026gt; 1 if mid==l and mid==r: return 0 res = 0 if ql \u0026lt;= mid: res = query(u \u0026lt;\u0026lt; 1, l, mid, ql, qr) if qr \u0026gt; mid: res += query(u \u0026lt;\u0026lt; 1 | 1, mid + 1, r, ql, qr) return res def modify(u, x, l, r, val): if l == r: tr[u] += val else: mid = (l + r) \u0026gt;\u0026gt; 1 if x \u0026lt;= mid: modify(u \u0026lt;\u0026lt; 1, x, l, mid, val) else: modify(u \u0026lt;\u0026lt; 1 | 1, x, mid + 1, r, val) pushup(u) Pythonç‰¹ç‚¹ IDLE ä½¿ç”¨ è®¾ç½®å­—ä½“ï¼Œè¡Œå·ï¼Œå’Œä½¿ç”¨docs\nå¿«æ·é”®ï¼š\nå¿«æ·é”® åŠŸèƒ½ å¯ç”¨çª—å£ F1 æ‰“å¼€ Python å¸®åŠ©æ–‡æ¡£ Python æ–‡ä»¶çª—å£å’Œ Shell Alt+P æµè§ˆå†å²å‘½ä»¤ï¼ˆä¸Šä¸€æ¡ï¼‰ ä»… Python Shell çª—å£ Alt+N æµè§ˆå†å²å‘½ä»¤ï¼ˆä¸‹ä¸€æ¡ï¼‰ ä»… Python Shell çª—å£ Alt+/ è‡ªåŠ¨è¡¥å…¨å‰é¢æ›¾ç»å‡ºç°è¿‡çš„å•è¯ï¼Œå¦‚æœä¹‹å‰æœ‰å¤šä¸ªå•è¯å…·æœ‰ç›¸åŒå‰ç¼€ï¼Œå¯ä»¥è¿ç»­æŒ‰ä¸‹è¯¥å¿«æ·é”®ï¼Œåœ¨å¤šä¸ªå•è¯ä¸­é—´å¾ªç¯é€‰æ‹© Python æ–‡ä»¶çª—å£å’Œ Shell Alt+3 æ³¨é‡Šä»£ç å— ä»… Python æ–‡ä»¶çª—å£ Alt+4 å–æ¶ˆä»£ç å—æ³¨é‡Š ä»… Python æ–‡ä»¶çª—å£ Alt+g è½¬åˆ°æŸä¸€è¡Œ ä»… Python æ–‡ä»¶çª—å£ Ctrl+Z æ’¤é”€ä¸€æ­¥æ“ä½œ Python æ–‡ä»¶çª—å£å’Œ Shell Ctrl+Shift+Z æ¢å¤ä¸Šâ€”æ¬¡çš„æ’¤é”€æ“ä½œ Python æ–‡ä»¶çª—å£å’Œ Shell Ctrl+S ä¿å­˜æ–‡ä»¶ Python æ–‡ä»¶çª—å£å’Œ Shell Ctrl+] ç¼©è¿›ä»£ç å— ä»… Python æ–‡ä»¶çª—å£ Ctrl+[ å–æ¶ˆä»£ç å—ç¼©è¿› ä»… Python æ–‡ä»¶çª—å£ Ctrl+F6 é‡æ–°å¯åŠ¨ Python Shell ä»… Python Shell çª—å£ è¾“å…¥è¾“å‡º è¾“å‡ºåˆ—è¡¨ï¼š\nprint(*a) # è¾“å‡ºåˆ—è¡¨ä¸­çš„æ‰€æœ‰æ•°ï¼Œç”¨ç©ºæ ¼åˆ†éš” print(*a, sep=\u0026#34;\\n\u0026#34;) #æ¯ä¸ªæ•°å•ç‹¬æ”¾ä¸€è¡Œ *è¿ç®—ç¬¦ è§£åŒ…è¿ç®—ç¬¦ï¼š å½“*è¿ç®—ç¬¦ç”¨äºå¯è¿­ä»£å¯¹è±¡ï¼ˆå¦‚åˆ—è¡¨ã€å…ƒç»„ã€é›†åˆç­‰ï¼‰å‰é¢æ—¶ï¼Œå®ƒå¯ä»¥å°†å¯è¿­ä»£å¯¹è±¡è§£åŒ…ä¸ºå¤šä¸ªå…ƒç´ ã€‚ä¾‹å¦‚ï¼š\na = [1, 2, 3] print(*a) # è§£åŒ…å¹¶æ‰“å°å‡ºæ¯ä¸ªå…ƒç´ ï¼š1 2 3 å¯å˜å‚æ•°ï¼š å½“*è¿ç®—ç¬¦ç”¨äºå‡½æ•°å®šä¹‰æ—¶ï¼Œå®ƒè¡¨ç¤ºæ¥å—ä»»æ„æ•°é‡çš„å‚æ•°ï¼Œå¹¶å°†å®ƒä»¬ä½œä¸ºå…ƒç»„ä¼ é€’ç»™å‡½æ•°ã€‚è¿™ç§ç”¨æ³•é€šå¸¸ç§°ä¸ºå¯å˜å‚æ•°ã€‚ä¾‹å¦‚ï¼š\ndef my_func(*args): for arg in args: print(arg) my_func(1, 2, 3) # æ‰“å°å‡ºæ¯ä¸ªå‚æ•°ï¼š1 2 3 æ‰©å±•è¿ç®—ç¬¦ï¼š å½“*è¿ç®—ç¬¦ç”¨äºå¯è¿­ä»£å¯¹è±¡å‰é¢æ—¶ï¼Œå®ƒå¯ä»¥å°†å¯è¿­ä»£å¯¹è±¡çš„å…ƒç´ æ‰©å±•åˆ°å¦ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡ä¸­ã€‚è¿™ç§ç”¨æ³•é€šå¸¸ç§°ä¸ºæ‰©å±•è¿ç®—ç¬¦ã€‚ä¾‹å¦‚ï¼š\na = [1, 2, 3] b = [4, 5, 6 c = [*a, *b] # æ‰©å±•aå’Œbçš„å…ƒç´ åˆ°cä¸­ print(c) # è¾“å‡ºï¼š[1, 2, 3, 4, 5, 6] ä¹˜æ³•è¿ç®—ç¬¦ï¼š å½“*è¿ç®—ç¬¦ç”¨äºæ•°å­—å’Œå¯è¿­ä»£å¯¹è±¡ä¹‹é—´æ—¶ï¼Œå®ƒè¡¨ç¤ºé‡å¤è¯¥å¯è¿­ä»£å¯¹è±¡çš„å…ƒç´ ã€‚ä¾‹å¦‚ï¼š\na = [1, 2, 3] b = a * 3 # é‡å¤açš„å…ƒç´ 3æ¬¡ print(b) # è¾“å‡ºï¼š[1, 2, 3, 1, 2, 3, 1, 2, 3] å’Œ* *å’Œ**åœ¨å‡½æ•°å®šä¹‰ä¸­çš„ä½¿ç”¨ï¼š *argsç”¨äºæ¥æ”¶ä»»æ„æ•°é‡çš„ä½ç½®å‚æ•°ï¼Œå¹¶å°†å®ƒä»¬ä½œä¸ºå…ƒç»„ä¼ é€’ç»™å‡½æ•°ã€‚ **kwargsç”¨äºæ¥æ”¶ä»»æ„æ•°é‡çš„å…³é”®å­—å‚æ•°ï¼Œå¹¶å°†å®ƒä»¬ä½œä¸ºå­—å…¸ä¼ é€’ç»™å‡½æ•°ã€‚ *å’Œ**åœ¨å‡½æ•°è°ƒç”¨ä¸­çš„ä½¿ç”¨ï¼š åœ¨å‡½æ•°è°ƒç”¨æ—¶ï¼Œ*ç”¨äºè§£åŒ…å¯è¿­ä»£å¯¹è±¡ï¼Œå¹¶å°†å…¶ä½œä¸ºä½ç½®å‚æ•°ä¼ é€’ç»™å‡½æ•°ã€‚ åœ¨å‡½æ•°è°ƒç”¨æ—¶ï¼Œ**ç”¨äºè§£åŒ…å­—å…¸ï¼Œå¹¶å°†å…¶ä½œä¸ºå…³é”®å­—å‚æ•°ä¼ é€’ç»™å‡½æ•°ã€‚ æ ˆæ¨¡æ‹Ÿé€’å½’ from collections import deque def dfs(idx,p): q = deque() q.append((idx,p)) while q: idx,p = q.pop() D[idx] = D[p] + V[idx] for u in A[idx]: if u == p: continue q.append((u,idx)) å¼•ç”¨èµ‹å€¼ã€æµ…æ‹·è´å’Œæ·±æ‹·è´ Pythonèµ‹å€¼ã€æµ…æ‹·è´ã€æ·±æ‹·è´çš„åŒºåˆ« [:]å’Œ.copy()éƒ½å±äºâ€œæµ…æ‹·è´â€ï¼Œåªæ‹·è´æœ€å¤–å±‚å…ƒç´ ï¼Œå¤–å±‚å…ƒç´ æ˜¯ç‹¬ç«‹å†…å­˜ï¼›å†…å±‚åµŒå¥—å…ƒç´ åˆ™é€šè¿‡å¼•ç”¨æ–¹å¼å…±äº«ï¼Œè€Œéç‹¬ç«‹åˆ†é…å†…å­˜ã€‚ä½¿ç”¨ copy æ¨¡å—çš„ copy.copyï¼ˆ æµ…æ‹·è´ ï¼‰å’Œ copy.deepcopyï¼ˆæ·±æ‹·è´ï¼‰ï¼Œå…¶ä¸­deepcopyæ˜¯æ„å»ºäº†ä¸€ä¸ªå®Œå…¨ç‹¬ç«‹çš„å¯¹è±¡ã€‚\n1ã€b = a: èµ‹å€¼å¼•ç”¨ï¼Œa å’Œ b éƒ½æŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡ã€‚\n2ã€b = a.copy(): æµ…æ‹·è´, a å’Œ b æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„å¯¹è±¡ï¼Œä½†ä»–ä»¬çš„å­å¯¹è±¡ï¼ˆå†…å±‚åµŒå¥—å¯¹è±¡ï¼‰è¿˜æ˜¯æŒ‡å‘ç»Ÿä¸€å¯¹è±¡ï¼ˆæ˜¯å¼•ç”¨ï¼‰ã€‚\n3ã€b = copy.deepcopy(a): æ·±åº¦æ‹·è´, a å’Œ b å®Œå…¨æ‹·è´äº†çˆ¶å¯¹è±¡åŠå…¶å­å¯¹è±¡ï¼Œä¸¤è€…æ˜¯å®Œå…¨ç‹¬ç«‹çš„ã€‚\nä¾‹å­ï¼š å¼•ç”¨èµ‹å€¼ \u0026gt;\u0026gt;\u0026gt;a = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9] \u0026gt;\u0026gt;\u0026gt;b = a[:] \u0026gt;\u0026gt;\u0026gt;print(b) [0, 1, 2, 3, 4, 5, 6, 7, 8, 9] \u0026gt;\u0026gt;\u0026gt;print(id(a)) #41946376 \u0026gt;\u0026gt;\u0026gt;print(id(b)) #41921864 æˆ– \u0026gt;\u0026gt;\u0026gt;b = a.copy() \u0026gt;\u0026gt;\u0026gt;print(b) [0, 1, 2, 3, 4, 5, 6, 7, 8, 9] \u0026gt;\u0026gt;\u0026gt;print(id(a)) #39783752 \u0026gt;\u0026gt;\u0026gt;print(id(b)) #39759176 æµ…æ‹·è´ \u0026gt;\u0026gt;\u0026gt;a = [1,2,[\u0026#39;A\u0026#39;,\u0026#39;B\u0026#39;]] \u0026gt;\u0026gt;\u0026gt;print(\u0026#39;a={}\u0026#39;.format(a)) \u0026gt;\u0026gt;\u0026gt;b = a[:] \u0026gt;\u0026gt;\u0026gt;b[0] = 9 #ä¿®æ”¹bçš„æœ€å¤–å±‚å…ƒç´ ï¼Œå°†1å˜æˆ9 \u0026gt;\u0026gt;\u0026gt;b[2][0] = \u0026#39;D\u0026#39; #ä¿®æ”¹bçš„å†…åµŒå±‚å…ƒç´  \u0026gt;\u0026gt;\u0026gt;print(\u0026#39;a={}\u0026#39;.format(a)) \u0026gt;\u0026gt;\u0026gt;print(\u0026#39;b={}\u0026#39;.format(b)) \u0026gt;\u0026gt;\u0026gt;print(\u0026#39;id(a)={}\u0026#39;.format(id(a))) \u0026gt;\u0026gt;\u0026gt;print(\u0026#39;id(b)={}\u0026#39;.format(id(b))) a=[1, 2, [\u0026#39;A\u0026#39;, \u0026#39;B\u0026#39;]] #åŸå§‹a a=[1, 2, [\u0026#39;D\u0026#39;, \u0026#39;B\u0026#39;]] #bä¿®æ”¹å†…éƒ¨å…ƒç´ Aä¸ºDåï¼Œaä¸­çš„Aä¹Ÿå˜æˆäº†Dï¼Œè¯´æ˜å…±äº«å†…éƒ¨åµŒå¥—å…ƒç´ ï¼Œä½†å¤–éƒ¨å…ƒç´ 1æ²¡å˜ã€‚ b=[9, 2, [\u0026#39;D\u0026#39;, \u0026#39;B\u0026#39;]] #ä¿®æ”¹åçš„b id(a)=38669128 id(b)=38669192 æ·±æ‹·è´ import copy a = [1, 2, 3, 4, [\u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;]] #åŸå§‹å¯¹è±¡ b = a #èµ‹å€¼ï¼Œä¼ å¯¹è±¡çš„å¼•ç”¨ c = copy.copy(a) #å¯¹è±¡æ‹·è´ï¼Œæµ…æ‹·è´ d = copy.deepcopy(a) #å¯¹è±¡æ‹·è´ï¼Œæ·±æ‹·è´ a.append(5) #ä¿®æ”¹å¯¹è±¡a a[4].append(\u0026#39;c\u0026#39;) #ä¿®æ”¹å¯¹è±¡aä¸­çš„[\u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;]æ•°ç»„å¯¹è±¡ print( \u0026#39;a = \u0026#39;, a ) print( \u0026#39;b = \u0026#39;, b ) print( \u0026#39;c = \u0026#39;, c ) print( \u0026#39;d = \u0026#39;, d ) #è¾“å‡ºï¼š \u0026#39;a = \u0026#39;, [1, 2, 3, 4, [\u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;, \u0026#39;c\u0026#39;], 5] \u0026#39;b = \u0026#39;, [1, 2, 3, 4, [\u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;, \u0026#39;c\u0026#39;], 5] \u0026#39;c = \u0026#39;, [1, 2, 3, 4, [\u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;, \u0026#39;c\u0026#39;]] \u0026#39;d = \u0026#39;, [1, 2, 3, 4, [\u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;]] æ ˆä»£æ›¿é€’å½’ å¢åŠ é€’å½’æ·±åº¦ import sys sys.setrecursionlimit(150000000) print(sys.getrecursionlimit()) è¿­ä»£åŠ æ·±æœç´¢ s = input() l = len(s) s = \u0026#34;0\u0026#34; + s # 1~l ans = set() st = {} def dfs(curlen, last): global ans, st stack = [(curlen, last)] while stack: curlen, last = stack.pop() if curlen - 2 \u0026gt; 4 and last != s[curlen - 1:curlen + 1]: if (curlen - 1, curlen) not in st: st[(curlen - 1, curlen)] = 1 ans.add(s[curlen - 1:curlen + 1]) stack.append((curlen - 2, s[curlen - 1:curlen + 1])) if curlen - 3 \u0026gt; 4 and last != s[curlen - 2:curlen + 1]: if (curlen - 2, curlen) not in st: st[(curlen - 2, curlen)] = 1 ans.add(s[curlen - 2:curlen + 1]) stack.append((curlen - 3, s[curlen - 2:curlen + 1])) dfs(l, \u0026#34;\u0026#34;) ans = sorted(ans) # å°†é›†åˆè½¬æ¢ä¸ºåˆ—è¡¨å¹¶æ’åº print(len(ans)) for si in ans: print(si) åŠ é€Ÿè¯»å…¥ import sys input = lambda:sys.stdin.readline().strip() a = int(input()) print(a) é˜Ÿåˆ— Queueä¸­æœ‰FIFOï¼ˆå…ˆå…¥å…ˆå‡ºï¼‰é˜Ÿåˆ—Queueï¼ŒLIFOï¼ˆåå…¥å…ˆå‡ºï¼‰æ ˆLifoQueueï¼Œå’Œä¼˜å…ˆçº§é˜Ÿåˆ—PriorityQueueï¼Œä½†é€Ÿåº¦è¾ƒæ…¢ï¼Œä¸”ä¸èƒ½ä¸å‡ºæ ˆåœ°è®¿é—®å¤´éƒ¨å…ƒç´ ï¼Œæƒ³è¦è®¿é—®å¤´éƒ¨å…ƒç´ ï¼Œåªèƒ½ç”¨getæ–¹æ³•å‡ºæ ˆé¦–éƒ¨è·å–æ–¹æ³•è¿”å›å€¼çš„æ¥è¿›è¡Œè®¿é—®ï¼Œéå¸¸ä¸æ–¹ä¾¿ã€‚\nå¯ä»¥ç”¨deque()æ¨¡æ‹Ÿ\nimport collections q=collections.deque() m=int(input()) for i in range(m): s = input().split() if s[0]==\u0026#39;push\u0026#39;: q.append(s[1]) elif s[0]==\u0026#39;pop\u0026#39;: q.popleft() elif s[0]==\u0026#39;empty\u0026#39;: if len(q)==0: print(\u0026#39;YES\u0026#39;) else: print(\u0026#39;NO\u0026#39;) else: print(q[0]) æ ˆ åˆ—è¡¨æ¨¡æ‹Ÿ\nm=int(input()) stk=[] for i in range(m): s = input().split() if s[0]==\u0026#39;push\u0026#39;: stk.append(int(s[1])) elif s[0]==\u0026#39;pop\u0026#39;: stk.pop() elif s[0]==\u0026#39;empty\u0026#39;: if len(stk)==0: print(\u0026#39;YES\u0026#39;) else: print(\u0026#39;NO\u0026#39;) else: print(stk[-1]) dequeæ¨¡æ‹Ÿ\nimport collections stk = collections.deque() m=int(input()) for i in range(m): s = input().split() if s[0]==\u0026#39;push\u0026#39;: stk.appendleft( int(s[1]) ) elif s[0]==\u0026#39;pop\u0026#39;: stk.popleft() elif s[0]==\u0026#39;empty\u0026#39;: if len(stk)==0: print(\u0026#39;YES\u0026#39;) else: print(\u0026#39;NO\u0026#39;) else: print(stk[0]) Python å¸¸ç”¨å†…ç½®åº“ array å®šé•¿æ•°ç»„ argparse å‘½ä»¤è¡Œå‚æ•°å¤„ç† bisect äºŒåˆ†æŸ¥æ‰¾ collections æœ‰åºå­—å…¸ã€åŒç«¯é˜Ÿåˆ—ç­‰æ•°æ®ç»“æ„ fractions æœ‰ç†æ•° heapq åŸºäºå †çš„ä¼˜å…ˆçº§é˜Ÿåˆ— io æ–‡ä»¶æµã€å†…å­˜æµ itertools è¿­ä»£å™¨ math æ•°å­¦å‡½æ•° os.path ç³»ç»Ÿè·¯å¾„ç­‰ random éšæœºæ•° re æ­£åˆ™è¡¨è¾¾å¼ struct è½¬æ¢ç»“æ„ä½“å’ŒäºŒè¿›åˆ¶æ•°æ® sys ç³»ç»Ÿä¿¡æ¯ defaultdict() from collections import defaultdict # åˆ›å»ºä¸€ä¸ª defaultdictï¼ŒæŒ‡å®šé»˜è®¤å€¼ä¸º int ç±»å‹çš„ 0 d = defaultdict() # ä¿®æ”¹é»˜è®¤å€¼ä¸º 100 d.default_factory = lambda: 100 g = defaultdict(lambda:defaultdict(lambda:INF)) #åŒæ ·çš„æ•ˆæœ é‚»æ¥çŸ©é˜µ Counter() from collections import Counter # å®šä¹‰ä¸€ä¸ªåˆ—è¡¨ lst = [1, 2, 2, 3, 3, 3, 4, 4, 4, 4] s = \u0026#39;abcdgsaa\u0026#39; # ä½¿ç”¨ Counter ç»Ÿè®¡åˆ—è¡¨ä¸­å…ƒç´ çš„å‡ºç°æ¬¡æ•° c1 = Counter(lst) c2 = Counter(s) print(c1,c2, sep=\u0026#39;\\n\u0026#39;) # ä½¿ç”¨ most_common() æ–¹æ³•æŒ‰ç…§å…ƒç´ çš„å‡ºç°æ¬¡æ•°è¿›è¡Œæ’åº sorted_items = c1.most_common() for x,y in enumerate(sorted_items): print(y[0]) c.elements() c.update(b) #å°†ä¸¤ä¸ªCounteråˆå¹¶ï¼Œ å¯¹åº”å…ƒç´ æ•°ç›®ç›¸åŠ  c.subtract(b) # å¯¹åº”å…ƒç´ æ•°ç›®ç›¸å‡ heapq å»ºå † ( å°æ ¹å † )\na = [1, 5, 20, 18, 10, 200] heapq.heapify(a) print(a) å»ºå¤§æ ¹å †\na = [] for i in [1, 5, 20, 18, 10, 200]: heapq.heappush(a,-i) print( list( map(lambda x:-x,a) ) ) heap_sort(heappush)\nimport heapq def heap_sort(arr): if not arr: return [] h = [] #å»ºç«‹ç©ºå † for i in arr: heapq.heappush(h,i) #heappushè‡ªåŠ¨å»ºç«‹å°æ ¹å † return [heapq.heappop(h) for i in range(len(h))] #heappopæ¯æ¬¡åˆ é™¤å¹¶è¿”å›åˆ—è¡¨ä¸­æœ€å°çš„å€¼ # å †æ’åºå–æœ€å°çš„mä¸ªæ•°å­— import heapq def heap_sort(arr, k): if not arr: return [] h=[] for i in arr: heapq.heappush(h, i) return [heapq.heappop(h) for _ in range(k)] n,m = map(int, input().split()) arr = list(map(int, input().split())) ans = heap_sort(arr, m) print(\u0026#39; \u0026#39;.join(map(str, ans))) heappushpop\npopå¼¹å‡ºå †é¡¶å…ƒç´ \nå…ˆpushå†pop\n[1, 18, 5, 20, 90, 10, 200] h [1, 18, 5, 20, 90, 10, 200] heapq.heappushpop(h, 300) 1 h [5, 18, 10, 20, 90, 300, 200] heapreplace\nå…ˆpopå†push\nh [5, 18, 10, 20, 90, 300, 200] heapq.heapreplace(h, -1) 5 h [-1, 18, 10, 20, 90, 300, 200] heapq.merge\nimport heapq h1 = [90, 1, 5, 20, 18, 10, 200] h2 = [4,2,3,4,1000] heapq.heapify(h1) heapq.heapify(h2) print(list(heapq.merge(h1, h2))) heap.nlargest\nh1 [1, 18, 5, 20, 90, 10, 200] heapq.nlargest(2,h1,key=lambda x:-x) heapq.nsmallest() [1, 5] list() del list[1] åˆ é™¤åˆ—è¡¨å…ƒç´  åˆ—è¡¨æ¯”è¾ƒ import operator operator.eq(a,b) len(list) max(list) min(list) list(seq) å°†å…ƒç»„è½¬æ¢ä¸ºåˆ—è¡¨ list.append(obj) list.count(obj) list.extend(seq) list.index(obj) list.insert(index, obj) list.pop([index=-1]) åˆ é™¤åˆ—è¡¨ä¸­ä¸€ä¸ªå…ƒç´  list.remove(obj) åˆ é™¤ç¬¬ä¸€ä¸ªåŒ¹é…é¡¹ list.reverse() list.sort(key=None, reverse=False) list.clear() list.copy() tuple() å…ƒç´ ç»„åˆ ç±»ä¼¼list\nSortedList() from sortedcontainers import SortedList sl = SortedList() sl.add(1) print(sl[-1]) print(sl[0]) sl.update([3,2,1]) print(sl) sl.update([9,8,7]) print(sl) ##sl.clear() sl.discard(5) sl.remove(9) print(sl) sl.pop() print(sl) sl.pop(-2) print(sl) print(sl.bisect_left(12)) #è¿”å›éœ€è¦æ’å…¥çš„ä½ç½®ï¼Œå¦‚æœ‰å­˜åœ¨åˆ™è¿”å›å·¦ä¾§çš„ä½ç½® print(sl.bisect_right(2)) print(sl.count(1)) print(sl.index(1)) it = sl.islice(2,4) print(list(it)) dict() é”®å€¼å¿…é¡»ä¸å¯å˜\nd = {\u0026#39;1\u0026#39;:\u0026#39;a\u0026#39;, \u0026#39;2\u0026#39;:\u0026#39;b\u0026#39;, \u0026#39;99\u0026#39;:\u0026#39;xycz\u0026#39;} print(d) if \u0026#39;0\u0026#39; in d :del d[\u0026#39;0\u0026#39;] del d[\u0026#39;1\u0026#39;] print(d) {\u0026#39;1\u0026#39;: \u0026#39;a\u0026#39;, \u0026#39;2\u0026#39;: \u0026#39;b\u0026#39;, \u0026#39;99\u0026#39;: \u0026#39;xycz\u0026#39;} {\u0026#39;2\u0026#39;: \u0026#39;b\u0026#39;, \u0026#39;99\u0026#39;: \u0026#39;xycz\u0026#39;} å†…ç½®æ–¹æ³• len str type dict.clear() dict.copy() dict.fromkeys(seq) å°†seqä½œä¸ºå­—å…¸çš„é”®å€¼ï¼Œ å­—å…¸ä¸­valä¸ºé»˜è®¤ dict.get(key, default=None) # ä¸éœ€è¦å†™default key in dict dict.items() dict.keys() dict.setdefault(key, default = None) # ç”¨äºåœ¨å­—å…¸ä¸­æŸ¥æ‰¾æŒ‡å®šé”®ï¼ˆkeyï¼‰ã€‚å¦‚æœé”®å­˜åœ¨ï¼Œåˆ™è¿”å›å¯¹åº”çš„å€¼ï¼›å¦‚æœé”®ä¸å­˜åœ¨ï¼Œåˆ™åœ¨å­—å…¸ä¸­è®¾ç½®è¯¥é”®ï¼Œå¹¶å°†é»˜è®¤å€¼ï¼ˆdefaultï¼‰ä½œä¸ºå…¶å€¼ï¼Œå¹¶è¿”å›è¯¥é»˜è®¤å€¼ã€‚ dict.update(dict2) #æŠŠdict2æ·»åŠ åˆ°dictä¸­ dict.values() #è¿”å›å€¼ pop(key[,default]) #åˆ é™¤å­—å…¸ä¸­keyæ‰€å¯¹åº”çš„å€¼å¹¶è¿”å› popitem() #è¿”å›å¹¶åˆ é™¤å­—å…¸ä¸­æœ€åä¸€å¯¹é”®å€¼ set() ç©ºé›†åˆç”¨set() æ”¯æŒ -, |, \u0026amp;, ^(ä¸åŒæ—¶åŒ…å«äºä¸¤ä¸ªé›†åˆ) difference() #è¿”å›æ–°é›†åˆ difference_update() #åœ¨åŸé›†åˆä¸Šä¿®æ”¹ï¼Œæ— è¿”å›å€¼ s1.difference_update(s2) union() #å¹¶é›† intersection() #äº¤é›† intersection_update() #è¿”å›äº¤é›† isdisjoint() #åˆ¤æ–­ä¸¤ä¸ªé›†åˆæ˜¯å¦åŒ…å«ç›¸åŒçš„å…ƒç´  issubset() #åˆ¤æ–­æŒ‡å®šå‚æ•°çš„é›†åˆæ˜¯å¦ä¸ºè¯¥è°ƒç”¨æ–¹æ³•çš„é›†åˆçš„å­é›† issuperset() #ç”¨äºç¡®å®šä¸€ä¸ªé›†åˆæ˜¯å¦ä¸ºå¦ä¸€ä¸ªé›†åˆçš„è¶…é›†, å®ƒç”¨äºæ£€æŸ¥ä¸€ä¸ªé›†åˆæ˜¯å¦åŒ…å«å¦ä¸€ä¸ªé›†åˆçš„æ‰€æœ‰å…ƒç´  symmetric_difference() #è¿”å›ä¸¤ä¸ªé›†åˆä¸­ä¸é‡å¤çš„å…ƒç´ é›†åˆ symmetric_difference_update() #ç§»é™¤ç›¸åŒçš„å…ƒç´ ï¼Œå¹¶æ’å…¥æ²¡æœ‰çš„å…ƒç´  s.add(x) æ·»åŠ å…ƒç´  s.update(x) #å¯ä»¥æ·»åŠ å¤šä¸ªå…ƒç´ ï¼Œå¹¶ä¸”å¯ä»¥æ˜¯åˆ—è¡¨å…ƒç»„å­—å…¸ s.remove(x) #å°†å…ƒç´ ä»é›†åˆä¸­ç§»é™¤ï¼Œ å¦‚æœä¸å­˜åœ¨åˆ™æŠ¥é”™ s.discard(x) #ç§»é™¤å…ƒç´ ï¼Œä½†æ˜¯ä¸æŠ¥é”™ s.pop() #è®¾ç½®éšæœºåˆ é™¤ç»“åˆä¸­çš„ä¸€ä¸ªå…ƒç´ ï¼ˆæ— åºé›†åˆçš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼‰ len(s) s.clear() x in s s.copy() deque() append() appendleft() extend() extendleft() pop() popleft() count() insert(index, obj) #ä¸listç›¸åŒï¼Œåœ¨indexä½ç½®æ’å…¥objï¼Œ æœ¬æ¥åœ¨indexä¸Šçš„å…ƒç´ å¾€åç§»åŠ¨ rotate(n) # ä»å³ä¾§ç¿»è½¬næ­¥ï¼ˆånä¸ªå…ƒç´ æ”¾åˆ°å‰é¢ï¼‰ï¼Œå¦‚æœä¸ºè´Ÿæ•°ï¼Œåˆ™ä»å·¦è¾¹ç¿»è½¬ clear() remove() maxlen q = deque(maxlen = 2) #å¦‚æœè¶…è¿‡é•¿åº¦ï¼Œåˆ™åœ¨å¦ä¸€ä¾§åˆ é™¤ bisect from bisect import * idx = bisect(ls, x) # bisect å’Œ bisect_rightç­‰åŒ idx = bisect_left(ls, x) # å¦‚æœåˆ—è¡¨å†…æ²¡æœ‰æ­¤å…ƒç´ ï¼Œé‚£ä¹ˆè¿”å›åˆé€‚çš„æ’å…¥ç‚¹ç´¢å¼• insort_left(ls, x)#æ’å…¥å…ƒç´ å¹¶ä¿æŒæœ‰åº insort(ls, x) # ç­‰ä»·äºinsort_right(ls, x) import bisect my_list = [1, 3, 5, 7, 9, 11, 13] i = bisect.bisect_left(my_list, -1) #0 i = bisect.bisect_left(my_list, 8, lo=3, hi=6) #4 bisect.insort_right(my_list, 8, lo=3, hi=6) #[1, 3, 5, 7, 8, 9, 11, 13] str s = \u0026#34;hello world\u0026#34; print(s.capitalize()) # Output: \u0026#34;Hello world\u0026#34; print(s.upper()) # Output: \u0026#34;HELLO WORLD\u0026#34; print(s.lower()) # Output: \u0026#34;hello world\u0026#34; print(s.title()) # Output: \u0026#34;Hello World\u0026#34; s = \u0026#34;Hello World\u0026#34; print(s.swapcase()) # Output: \u0026#34;hELLO wORLD\u0026#34; s = \u0026#34; hello world \u0026#34; print(s.strip()) # Output: \u0026#34;hello world\u0026#34; s = \u0026#34;hello world\u0026#34; print(s.replace(\u0026#34;world\u0026#34;, \u0026#34;python\u0026#34;)) # Output: \u0026#34;hello python\u0026#34; s = \u0026#34;hello world\u0026#34; print(s.split()) # Output: [\u0026#39;hello\u0026#39;, \u0026#39;world\u0026#39;] words = [\u0026#34;hello\u0026#34;, \u0026#34;world\u0026#34;] separator = \u0026#34;, \u0026#34; print(separator.join(words)) # Output: \u0026#34;hello, world\u0026#34; s = \u0026#34;hello world\u0026#34; print(s.startswith(\u0026#34;hello\u0026#34;)) # Output: True s = \u0026#34;hello world\u0026#34; print(s.endswith(\u0026#34;world\u0026#34;)) # Output: True s = \u0026#34;hello world\u0026#34; print(s.find(\u0026#34;world\u0026#34;)) # Output: 6 s = \u0026#34;hello world\u0026#34; print(s.count(\u0026#34;l\u0026#34;)) # Output: 3 è‡ªå®šä¹‰æ¯”è¾ƒå‚æ•° from functools import cmp_to_key def compare(s1, s2): if len(s1) == len(s2): for c1, c2 in zip(s1, s2): if c1 \u0026gt; c2: return 1 elif c1 \u0026lt; c2: return -1 return 0 else: if len(s1) \u0026gt; len(s2): return 1 else: return -1 things = input().split() # ä½¿ç”¨ cmp_to_key å°†æ¯”è¾ƒå‡½æ•°è½¬æ¢ä¸º key å‡½æ•° things.sort(key=cmp_to_key(compare)) print(things) __init__é­”æœ¯æ–¹æ³• class Fib(object): def __init__(self): pass def __call__(self, num): # å°†å¯¹è±¡ä½œä¸ºå‡½æ•°è°ƒç”¨æ—¶è§¦å‘ a, b = 0, 1 self.l = [] for i in range(num): self.l.append(a) a, b = b, a+b return self.l def __str__(self): # ä½¿ç”¨print(å¯¹è±¡ï¼‰æˆ–è€…str (å¯¹è±¡)çš„æ—¶å€™è§¦å‘ return str(self.l) # å¿…é¡»è¿”å›å­—ç¬¦ä¸²ç±»å‹ __rept__=__str__ # ä½¿ç”¨repr(å¯¹è±¡) f = Fib() print(f(10)) from itertools import combinations, permutations from copy import deepcopy from functools import lru_cache from sys import stdin from collections import defaultdict, deque, Counter from heapq import * import operator from functools import cmp_to_key ls = [1, 2, 3] ls2 = [1, 2, 3] print(operator.eq(ls, ls2)) for j in permutations(ls, 1): print(j) for j in combinations(ls, 2): print(j) len(ls) max(ls) min(ls) list(s) ls.append() ls.count() ls.index() ls.extend() ls.insert(index, obj) ls.pop(index) ls.remove() ls.reverse() ls.sort(key = lambda x:-x, reverse = True) ls.clear() ls.copy print(s.capitalize()) print(s.capitalize()) print(s.capitalize()) print(s.lower()) print(s.upper()) print(s.title()) ","permalink":"https://kennems.github.io/posts/tech/python%E5%BA%93/","summary":"Pythonåº“ ç¨‹åºæ˜“é”™ç‚¹ ï¼š å˜é‡æœªå£°æ˜ i,j,kå˜é‡å†™é”™äº† å˜é‡åä¸€å®šè¦çœ‹æ¸…æ¥š å‡½æ•°ä½“å†…å˜é‡å’Œå¤–éƒ¨å˜é‡åˆ†ä¸æ¸…ï¼Œå˜é‡åç›¸è¿‘çš„ä¸€å®šè¦çœ‹æ¸…æ¥š 11+12+16+15+12+12 = 78 ä¸ƒå¤•ç¥­","title":"Pythonåº“"},{"content":"å‘¨èµ›250519 ç»ˆäºç»ˆäºAKäº†ä¸€åœºğŸ˜†\nç¬¬å››é¢˜100298. åˆ°è¾¾ç¬¬ K çº§å°é˜¶çš„æ–¹æ¡ˆæ•° é¢˜ç›®å¤§æ„\nç»™å®šä¸€ä¸ªéè´Ÿæ•´æ•° kï¼Œè¡¨ç¤ºç›®æ ‡å°é˜¶çš„ç¼–å·ã€‚è™è€å¸ˆä»å°é˜¶ 1 å¼€å§‹ï¼Œé€šè¿‡ä¸€ç³»åˆ—æ“ä½œåˆ°è¾¾å°é˜¶ kã€‚æ“ä½œåˆ†ä¸ºä¸¤ç§ï¼š\nå‘ä¸‹èµ°ä¸€çº§åˆ° i - 1ï¼Œä½†è¯¥æ“ä½œä¸èƒ½è¿ç»­ä½¿ç”¨ï¼Œå¦‚æœåœ¨å°é˜¶ 0 ä¹Ÿä¸èƒ½ä½¿ç”¨ã€‚ å‘ä¸Šèµ°åˆ°å°é˜¶ i + 2^jump å¤„ï¼Œç„¶å jump å˜ä¸º jump + 1ã€‚ ç›®æ ‡æ˜¯è®¡ç®—è™è€å¸ˆåˆ°è¾¾å°é˜¶ k çš„æ€»æ–¹æ¡ˆæ•°ã€‚\nå®ç°æ€è·¯\nå®šä¹‰é€’å½’å‡½æ•°ï¼šå®šä¹‰ä¸€ä¸ªé€’å½’å‡½æ•° dfs(p, j, f)ï¼Œå…¶ä¸­ p è¡¨ç¤ºå½“å‰æ‰€åœ¨çš„å°é˜¶ï¼Œj è¡¨ç¤ºå½“å‰ jump çš„æ¬¡æ•°ï¼Œf è¡¨ç¤ºä¸Šä¸€æ¬¡æ“ä½œæ˜¯å¦æ˜¯å‘ä¸‹èµ°ä¸€çº§çš„æ ‡å¿—ã€‚ é€’å½’ç»ˆæ­¢æ¡ä»¶ï¼š å½“ p == k æ—¶ï¼Œè¡¨ç¤ºå·²ç»åˆ°è¾¾ç›®æ ‡å°é˜¶ï¼Œè¿”å› 1 è¡¨ç¤ºæ‰¾åˆ°ä¸€ç§æ–¹æ¡ˆã€‚ å½“ p \u0026lt; 0 æ—¶ï¼Œè¡¨ç¤ºè¶…å‡ºèŒƒå›´ï¼Œè¿”å› 0ã€‚ å½“ p - 1 \u0026gt; k æˆ–è€… p - 1 == k ä¸” f == 1 æ—¶ï¼Œè¡¨ç¤ºå‘ä¸‹èµ°è¶…è¿‡ç›®æ ‡æˆ–åœ¨ç›®æ ‡æ—¶æ— æ³•å‘ä¸‹èµ°ï¼Œè¿”å› 0ã€‚ é€’å½’è®¡ç®—ï¼š upï¼šè®¡ç®—å‘ä¸Šèµ°åˆ° p + 2^j çš„æ–¹æ¡ˆæ•°ï¼Œå¹¶å°† j åŠ  1ï¼Œè¡¨ç¤ºä½¿ç”¨äº†ä¸€æ¬¡å‘ä¸Šè·³è·ƒã€‚ downï¼šè®¡ç®—å‘ä¸‹èµ°åˆ° p - 1 çš„æ–¹æ¡ˆæ•°ï¼Œå½“ p \u0026gt; 0 ä¸” f == 0 æ—¶æ‰å¯ä»¥å‘ä¸‹èµ°ã€‚ è¿”å› up + down + more çš„å’Œï¼Œå…¶ä¸­ more è¡¨ç¤ºå½“å‰æ­£å¥½åœ¨ç›®æ ‡å°é˜¶çš„æƒ…å†µã€‚ è®°å¿†åŒ–æœç´¢ï¼šä½¿ç”¨ @cache ä¿®é¥°é€’å½’å‡½æ•°ï¼Œé¿å…é‡å¤è®¡ç®—ã€‚ class Solution: def waysToReachStair(self, k: int) -\u0026gt; int: @cache def dfs(p, j, f): # flag 1: ä¸Šä¸€æ¬¡æ˜¯ä¸‹ç§»ï¼Œ 0ï¼šä¸Šä¸€æ¬¡ä¸æ˜¯ more = 0 if p == k: more = 1 if p \u0026lt; 0: return 0 if p-1\u0026gt;k or (p-1==k and f==1): return 0 up = dfs(p + (1 \u0026lt;\u0026lt; j), j + 1, 0) if p \u0026gt; 0 and f==0: down = dfs(p - 1, j, 1) else: down = 0 return up + down + more return dfs(1, 0, 0) ","permalink":"https://kennems.github.io/posts/tech/%E5%91%A8%E8%B5%9B250519/","summary":"å‘¨èµ›250519 ç»ˆäºç»ˆäºAKäº†ä¸€åœºğŸ˜† ç¬¬å››é¢˜100298. åˆ°è¾¾ç¬¬ K çº§å°é˜¶çš„æ–¹æ¡ˆæ•° é¢˜ç›®å¤§æ„ ç»™å®šä¸€ä¸ªéè´Ÿæ•´æ•° kï¼Œè¡¨ç¤ºç›®æ ‡å°é˜¶çš„ç¼–å·ã€‚è™è€å¸ˆä»å°é˜¶ 1","title":"LeetCodeå‘¨èµ›398(240519)"},{"content":"å‘¨èµ›20240505 ç¬¬å››é¢˜ 100288. ä½¿æ•°ç»„ä¸­æ‰€æœ‰å…ƒç´ ç›¸ç­‰çš„æœ€å°å¼€é”€ é¢˜ç›®å¤§æ„ï¼šç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ nums å’Œä¸¤ä¸ªæ•´æ•° cost1 å’Œ cost2ï¼Œå¯ä»¥æ‰§è¡Œä¸¤ç§æ“ä½œæ¥ä½¿æ•°ç»„ä¸­æ‰€æœ‰å…ƒç´ ç›¸ç­‰ï¼š1. é€‰æ‹©æŸä¸ªå…ƒç´ å¢åŠ 1ï¼Œå¼€é”€ä¸ºcost1ï¼›2. é€‰æ‹©ä¸¤ä¸ªä¸åŒçš„å…ƒç´ åŒæ—¶å¢åŠ 1ï¼Œå¼€é”€ä¸ºcost2ã€‚ç›®æ ‡æ˜¯ä½¿æ•°ç»„ä¸­æ‰€æœ‰å…ƒç´ ç›¸ç­‰ï¼Œè¿”å›éœ€è¦çš„æœ€å°å¼€é”€ä¹‹å’Œã€‚\nå®ç°æ€è·¯ï¼šé¦–å…ˆè®¡ç®—æ•°ç»„ä¸­æœ€å¤§å€¼mxå’Œæœ€å°å€¼mnï¼Œç„¶åè®¡ç®—åŸºç¡€å¼€é”€baseï¼Œå³å°†æœ€å¤§å€¼å˜ä¸ºæœ€å°å€¼æ‰€éœ€çš„å¼€é”€ã€‚ç„¶åæ ¹æ®ä¸¤ç§æ“ä½œçš„å¼€é”€æ¯”è¾ƒï¼Œè‹¥cost1*2 \u0026lt;= cost2ï¼Œåˆ™åªéœ€è€ƒè™‘å°†æœ€å¤§å€¼å˜ä¸ºæœ€å°å€¼çš„å¼€é”€ï¼Œç›´æ¥è¿”å›å³å¯ã€‚è‹¥cost1*2 \u0026gt; cost2ï¼Œåˆ™éœ€è¦è€ƒè™‘ä¸¤ç§æ“ä½œçš„æ¯”è¾ƒï¼Œé€šè¿‡äºŒåˆ†æœç´¢æ‰¾åˆ°ä½¿å¾—æ€»å¼€é”€æœ€å°çš„æƒ…å†µã€‚å…·ä½“å®ç°ä¸­ï¼Œå®šä¹‰äº†å‡½æ•°f(x)ï¼Œè¡¨ç¤ºå°†æœ€å¤§å€¼å˜ä¸ºxæ—¶çš„æ€»å¼€é”€ï¼Œç„¶ååœ¨mxçš„èŒƒå›´å†…è¿›è¡ŒäºŒåˆ†æœç´¢æ‰¾åˆ°æœ€å°æ€»å¼€é”€ã€‚\nclass Solution: def minCostToEqualizeArray(self, nums: List[int], c1: int, c2: int) -\u0026gt; int: mod = int(1e9) + 7 mx = max(nums); mn = min(nums) n = len(nums) base = mx*n - sum(nums) if c1*2 \u0026lt;= c2: return base * c1 % mod def f(x): d = x - mn s = base + (x-mx) * n if d \u0026lt;= s-d: return s//2 * c2 + s%2*c1 return (s-d) * c2 + (d-(s-d)) * c1 ans = inf if mx\u0026amp;1: ans = f(mx) mx += 1 base += n k0 = bisect_left( range(mx), True, mx//2, key = lambda m: f(m*2) \u0026lt; f((m+1)*2) ) k1 = bisect_left( range(mx), True, mx//2, key = lambda m: f(m*2+1) \u0026lt; f((m+1)*2 + 1) ) ans = min(ans, f(k0*2), f(k1*2 + 1)) return ans%mod ","permalink":"https://kennems.github.io/posts/tech/%E5%91%A8%E8%B5%9B20240505/","summary":"å‘¨èµ›20240505 ç¬¬å››é¢˜ 100288. ä½¿æ•°ç»„ä¸­æ‰€æœ‰å…ƒç´ ç›¸ç­‰çš„æœ€å°å¼€é”€ é¢˜ç›®å¤§æ„ï¼šç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ nums å’Œä¸¤ä¸ªæ•´æ•° cost1 å’Œ cost2ï¼Œå¯ä»¥æ‰§è¡Œä¸¤ç§æ“ä½œæ¥ä½¿æ•°ç»„ä¸­æ‰€","title":"LeetCodeå‘¨èµ›396(240505)"},{"content":"LeetCodeæ¯æ—¥ä¸€é¢˜(2405) 1235. è§„åˆ’å…¼èŒå·¥ä½œ é¢˜ç›®å¤§æ„ï¼šç»™å®šnä»½å…¼èŒå·¥ä½œï¼Œæ¯ä»½å·¥ä½œéƒ½æœ‰å¼€å§‹æ—¶é—´ã€ç»“æŸæ—¶é—´å’ŒæŠ¥é…¬ã€‚ä»»åŠ¡æ˜¯é€‰æ‹©ä¸€äº›å·¥ä½œï¼Œä½¿å¾—åœ¨ä¸é‡å çš„æƒ…å†µä¸‹èƒ½å¤Ÿè·å¾—æœ€å¤§æŠ¥é…¬ã€‚\nå®ç°æ€è·¯ï¼šé¦–å…ˆå¯¹å·¥ä½œæŒ‰ç…§ç»“æŸæ—¶é—´è¿›è¡Œæ’åºï¼Œç„¶åä½¿ç”¨åŠ¨æ€è§„åˆ’æ¥æ±‚è§£æœ€å¤§æŠ¥é…¬ã€‚åœ¨åŠ¨æ€è§„åˆ’çš„è¿‡ç¨‹ä¸­ï¼Œç»´æŠ¤ä¸€ä¸ªæ•°ç»„fï¼Œå…¶ä¸­f[i]è¡¨ç¤ºåœ¨è€ƒè™‘å‰iä¸ªå·¥ä½œæ—¶å¯ä»¥è·å¾—çš„æœ€å¤§æŠ¥é…¬ã€‚éå†æ¯ä¸ªå·¥ä½œï¼Œå¯¹äºç¬¬iä¸ªå·¥ä½œï¼Œæ‰¾åˆ°åœ¨å…¶å¼€å§‹æ—¶é—´ä¹‹å‰ä¸”ç»“æŸæ—¶é—´æœ€æ¥è¿‘çš„å·¥ä½œjï¼Œç„¶åæ›´æ–°f[i]ä¸ºf[j] + ç¬¬iä¸ªå·¥ä½œçš„æŠ¥é…¬ã€‚æœ€ç»ˆè¿”å›f[n]å³ä¸ºæ‰€æ±‚çš„æœ€å¤§æŠ¥é…¬ã€‚\nclass Solution: def jobScheduling(self, startTime: List[int], endTime: List[int], profit: List[int]) -\u0026gt; int: # å…µè´µç¥é€Ÿï¼Œç°åœ¨èƒ½é¢†å…ˆä¸€ç§’ï¼Œä»¥åå°±èƒ½æŒ‰ç…§å¤åˆ©ä¸€ç›´é¢†å…ˆ n = len(startTime) job = [(0, 0, 0)] + sorted(zip(endTime, startTime, profit)) f = [0]*(n+1) for i, (_, st, p) in enumerate(job[1:], start = 1): # l, r = 0, i-1 # while l\u0026lt;r: # mid = (l+r+1)\u0026gt;\u0026gt;1 # if job[mid][0] \u0026gt; st: # r = mid-1 # else: # l = mid # f[i] = max(f[i-1], f[l] + p) l = bisect_left(job, (st+1, ), hi = i, lo = 0) # å†…ç½®åº“åªèƒ½æŸ¥æ‰¾ ä¸¥æ ¼ \u0026gt; \u0026lt; çš„å€¼ # æ— æ³•æ‰¾åˆ° \u0026gt;= \u0026lt;=çš„å€¼ï¼Œä½†æ˜¯å¯ä»¥åœ¨æ‰¾åˆ°æœ€å¤§çš„ \u0026lt;ç›®æ ‡å€¼çš„ i, i-1å³ä¸º\u0026lt;=ç›®æ ‡å€¼çš„ä¸‹æ ‡ f[i] = max(f[i-1], f[l-1] + p) return f[n] 741. æ‘˜æ¨±æ¡ƒ é¢˜ç›®å¤§æ„ï¼šç»™å®šä¸€ä¸ªç½‘æ ¼ï¼Œå…¶ä¸­åŒ…å«ç©ºæ ¼ã€æ¨±æ¡ƒå’Œè†æ£˜ï¼Œè¦æ±‚ä»å·¦ä¸Šè§’åˆ°å³ä¸‹è§’ï¼Œç„¶åè¿”å›å·¦ä¸Šè§’ï¼ŒæŒ‰ç…§è§„å®šçš„èµ°æ³•ï¼Œæœ€å¤šèƒ½æ‘˜åˆ°çš„æ¨±æ¡ƒæ•°é‡ã€‚\nè®°å¿†åŒ–æœç´¢ å®ç°æ€è·¯ï¼šè¿™æ˜¯ä¸€ä¸ªåŠ¨æ€è§„åˆ’é—®é¢˜ã€‚å®šä¹‰ä¸€ä¸ªé€’å½’å‡½æ•°dfs(t, j, l)ï¼Œè¡¨ç¤ºåœ¨æ—¶åˆ»tï¼Œç¬¬ä¸€ä¸ªäººä½äº(j, t-j)ï¼Œç¬¬äºŒä¸ªäººä½äº(l, t-l)æ—¶ï¼Œèƒ½å¤Ÿå¾—åˆ°çš„æœ€å¤§æ¨±æ¡ƒæ•°é‡ã€‚é€’å½’ç»ˆæ­¢æ¡ä»¶æ˜¯å½“å…¶ä¸­ä¸€ä¸ªäººèµ°åˆ°äº†è¾¹ç•Œä¹‹å¤–æˆ–è€…ç¢°åˆ°äº†è†æ£˜æ—¶ï¼Œè¿”å›è´Ÿæ— ç©·ã€‚ç„¶åé€’å½’åœ°è®¡ç®—å››ç§å¯èƒ½çš„ç§»åŠ¨æ–¹å‘ï¼šå‘ä¸‹èµ°ã€å‘å³èµ°ã€å‘ä¸‹å’Œå‘å³èµ°ã€å‘å·¦èµ°ï¼ŒåŒæ—¶æ›´æ–°æ¨±æ¡ƒæ•°é‡ã€‚æœ€åè¿”å›ç»è¿‡è·¯å¾„èƒ½å¤Ÿæ‘˜åˆ°çš„æœ€å¤šæ¨±æ¡ƒæ•°é‡ã€‚\nclass Solution: def cherryPickup(self, g: List[List[int]]) -\u0026gt; int: @cache def dfs(t, j, l): if j\u0026lt;0 or l\u0026lt;0 or t-j\u0026lt;0 or t-l\u0026lt;0 or g[t-j][j]==-1 or g[t-l][l]==-1: return -inf if t==0: return g[0][0] return max(dfs(t-1, j, l), dfs(t-1, j-1, l), dfs(t-1, j, l-1), dfs(t-1, j-1, l-1)) \\ + g[t-j][j] + (g[t-l][l] if j!=l else 0) n = len(g) return max(0, dfs(2*n-2, n-1, n-1)) é€’æ¨ å®ç°æ€è·¯ï¼š\nä½¿ç”¨åŠ¨æ€è§„åˆ’æ¥è§£å†³ã€‚å®šä¹‰ä¸€ä¸ªä¸‰ç»´æ•°ç»„ fï¼Œå…¶ä¸­ f[t][i][j] è¡¨ç¤ºåœ¨ t æ­¥ä¸­ï¼Œç¬¬ä¸€ä¸ªäººä½äº (i-1, t-i)ã€ç¬¬äºŒä¸ªäººä½äº (j-1, t-j) æ—¶æ‰€èƒ½æ‘˜åˆ°çš„æœ€å¤§æ¨±æ¡ƒæ•°ã€‚ åˆå§‹æ¡ä»¶ä¸º f[0][1][1] = grid[0][0]ï¼Œè¡¨ç¤ºå¼€å§‹æ—¶ç¬¬ä¸€ä¸ªäººå’Œç¬¬äºŒä¸ªäººéƒ½åœ¨å·¦ä¸Šè§’ï¼Œç¬¬ä¸€ä¸ªæ ¼å­ä¸Šçš„æ¨±æ¡ƒæ•°ã€‚ ç„¶åè¿›è¡ŒçŠ¶æ€è½¬ç§»ï¼Œå¯¹äºæ¯ä¸€æ­¥ tï¼Œéå†ä¸¤ä¸ªäººå¯èƒ½çš„ä½ç½® (i, t-i)ï¼Œ(j, t-j)ï¼š å¦‚æœè¯¥ä½ç½®ä¸æ˜¯è†æ£˜ï¼Œåˆ™è®¡ç®—èƒ½ä»ä¸Šä¸€æ­¥åˆ°è¾¾å½“å‰ä½ç½®çš„æœ€å¤§æ¨±æ¡ƒæ•°ã€‚çŠ¶æ€è½¬ç§»æ–¹ç¨‹ä¸ºï¼šf[t][i][j] = max(f[t-1][i][j], f[t-1][i-1][j], f[t-1][i][j-1], f[t-1][i-1][j-1]) + å½“å‰æ ¼å­ä¸Šçš„æ¨±æ¡ƒæ•°ã€‚ æœ€åè¿”å› f[2*n-2][n][n]ï¼Œè¡¨ç¤ºåœ¨è¿”å›è¿‡ç¨‹ä¸­æœ€å¤šèƒ½æ‘˜åˆ°çš„æ¨±æ¡ƒæ•°ã€‚ class Solution: def cherryPickup(self, grid: List[List[int]]) -\u0026gt; int: n = len(grid) f = [[[-inf]*(n+1) for _ in range(n+1)] for _ in range(2*n-1)] f[0][1][1] = grid[0][0] for t in range(1, 2*n-1): for j in range(max(t-n+1, 0), min(n, t+1)): if grid[t-j][j]==-1: continue for k in range(j, min(n, t+1)): if grid[t-k][k]==-1: continue f[t][j+1][k+1] = max(f[t-1][j+1][k+1], f[t-1][j][k+1], f[t-1][j+1][k], f[t-1][j][k]) \\ + grid[t-j][j] + (grid[t-k][k] if j!=k else 0) return max(0, f[2*n-2][n][n]) 463. æ‘˜æ¨±æ¡ƒ II é¢˜ç›®å¤§æ„ï¼šç»™å®šä¸€ä¸ªçŸ©é˜µè¡¨ç¤ºæ¨±æ¡ƒåœ°ï¼Œä¸¤ä¸ªæœºå™¨äººåˆ†åˆ«ä»å·¦ä¸Šè§’å’Œå³ä¸Šè§’å‡ºå‘ï¼Œæ¯ä¸ªæœºå™¨äººåªèƒ½å‘ä¸‹ä¸€è¡Œçš„å·¦ä¸‹ã€ä¸‹æ–¹å’Œå³ä¸‹æ–¹ç§»åŠ¨ï¼Œå½“æœºå™¨äººåˆ°è¾¾ä¸€ä¸ªæ ¼å­æ—¶ï¼Œä¼šæ‘˜å–è¯¥æ ¼å­å†…æ‰€æœ‰çš„æ¨±æ¡ƒå¹¶å°†å…¶ç½®ç©ºã€‚ä¸¤ä¸ªæœºå™¨äººä¸èƒ½åŒæ—¶æ‘˜å–åŒä¸€ä¸ªæ ¼å­çš„æ¨±æ¡ƒï¼Œæ±‚ä¸¤ä¸ªæœºå™¨äººèƒ½å¤Ÿæ‘˜å–çš„æœ€å¤§æ¨±æ¡ƒæ€»æ•°ã€‚\nè®°å¿†åŒ–æœç´¢ å®ç°æ€è·¯ï¼šå¯ä»¥ä½¿ç”¨åŠ¨æ€è§„åˆ’æ¥è§£å†³ã€‚å®šä¹‰ä¸€ä¸ªé€’å½’å‡½æ•° dfs(i, j, k) è¡¨ç¤ºæœºå™¨äºº1ä½äºç¬¬iè¡Œç¬¬jåˆ—ï¼Œæœºå™¨äºº2ä½äºç¬¬iè¡Œç¬¬kåˆ—æ—¶ï¼Œèƒ½å¤Ÿæ‘˜å–çš„æœ€å¤§æ¨±æ¡ƒæ€»æ•°ã€‚é€’å½’è¿‡ç¨‹ä¸­ï¼Œå¯¹äºæ¯ä¸ªæœºå™¨äººï¼Œéƒ½æœ‰ä¸‰ç§ç§»åŠ¨æ–¹å¼ï¼Œå³å‘ä¸‹ä¸€è¡Œçš„å·¦ä¸‹ã€ä¸‹æ–¹å’Œå³ä¸‹æ–¹ç§»åŠ¨ã€‚é€’å½’ç»ˆæ­¢æ¡ä»¶ä¸ºæœºå™¨äººåˆ°è¾¾æœ€åä¸€è¡Œã€‚ä½¿ç”¨ç¼“å­˜è£…é¥°å™¨ @cache å¯ä»¥é¿å…é‡å¤è®¡ç®—ã€‚æœ€åï¼Œè¿”å›dfs(0, 0, m-1)ï¼Œå…¶ä¸­mä¸ºçŸ©é˜µçš„åˆ—æ•°ã€‚\nclass Solution: def cherryPickup(self, grid: List[List[int]]) -\u0026gt; int: n, m = len(grid), len(grid[0]) @cache def dfs(i, j, k): if i==n or j\u0026lt;0 or j\u0026gt;=m or k\u0026lt;0 or k\u0026gt;=m: return 0 return max(dfs(i+1, nj, nk) for nj in range(j-1, j+2) for nk in range(k-1, k+2)) \\ + grid[i][j] + (grid[i][k] if j!=k else 0) return dfs(0, 0, m-1) é€’æ¨ å®ç°æ€è·¯ï¼šä½¿ç”¨åŠ¨æ€è§„åˆ’è¿›è¡Œè§£å†³ã€‚å®šä¹‰ä¸€ä¸ªä¸‰ç»´æ•°ç»„ fï¼Œå…¶ä¸­ f[i][j+1][k+1] è¡¨ç¤ºæœºå™¨äºº1ä½äºç¬¬iè¡Œç¬¬jåˆ—ï¼Œæœºå™¨äºº2ä½äºç¬¬iè¡Œç¬¬kåˆ—æ—¶ï¼Œèƒ½å¤Ÿæ‘˜å–çš„æœ€å¤§æ¨±æ¡ƒæ€»æ•°ã€‚é€šè¿‡ä¸‰é‡å¾ªç¯ï¼Œä¾æ¬¡éå†æ¯ä¸€è¡Œå’Œæ¯ä¸€åˆ—ï¼Œæ›´æ–° f[i][j+1][k+1] çš„å€¼ï¼Œå…¶ä¸­ i è¡¨ç¤ºå½“å‰è¡Œï¼Œj è¡¨ç¤ºæœºå™¨äºº1çš„åˆ—æ•°ï¼Œk è¡¨ç¤ºæœºå™¨äºº2çš„åˆ—æ•°ã€‚åœ¨æ›´æ–° f[i][j+1][k+1] çš„è¿‡ç¨‹ä¸­ï¼Œé€šè¿‡éå†æœºå™¨äºº1å’Œæœºå™¨äºº2çš„ä½ç½®ï¼Œè®¡ç®—èƒ½å¤Ÿæ‘˜å–çš„æœ€å¤§æ¨±æ¡ƒæ€»æ•°ã€‚æœ€åè¿”å› f[0][1][m]ï¼Œå…¶ä¸­ m ä¸ºçŸ©é˜µçš„åˆ—æ•°ã€‚\nclass Solution: def cherryPickup(self, grid: List[List[int]]) -\u0026gt; int: n, m = len(grid), len(grid[0]) f = [[[0]*(m+2) for _ in range(m+2)] for _ in range(n+1)] for i in range(n-1, -1, -1): for j in range(min(i+1, m)): for k in range(max(j+1, m-1-i), m): t = 0 for nj in range(j, j+3): for nk in range(k, k+3): t = max(t, f[i+1][nj][nk]) f[i][j+1][k+1] = t + grid[i][j] + grid[i][k] return f[0][1][m] ","permalink":"https://kennems.github.io/posts/tech/leetcode%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98202405/","summary":"LeetCodeæ¯æ—¥ä¸€é¢˜(2405) 1235. è§„åˆ’å…¼èŒå·¥ä½œ é¢˜ç›®å¤§æ„ï¼šç»™å®šnä»½å…¼èŒå·¥ä½œï¼Œæ¯ä»½å·¥ä½œéƒ½æœ‰å¼€å§‹æ—¶é—´ã€ç»“æŸæ—¶é—´å’ŒæŠ¥é…¬ã€‚ä»»åŠ¡æ˜¯é€‰æ‹©ä¸€äº›å·¥ä½œï¼Œä½¿å¾—","title":"LeetCodeæ¯æ—¥ä¸€é¢˜(202405)"},{"content":"åŒå‘¨èµ›20230427 ç¬¬ä¸‰/å››é¢˜3130. æ‰¾å‡ºæ‰€æœ‰ç¨³å®šçš„äºŒè¿›åˆ¶æ•°ç»„ II é¢˜ç›®å¤§æ„ï¼šç»™å®šä¸‰ä¸ªæ­£æ•´æ•° zeroã€one å’Œ limitï¼Œå®šä¹‰ä¸€ä¸ªäºŒè¿›åˆ¶æ•°ç»„ arrï¼Œè¦æ±‚æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼šæ•°ç»„ä¸­ 0 å‡ºç°çš„æ¬¡æ•°ä¸º zeroï¼Œ1 å‡ºç°çš„æ¬¡æ•°ä¸º oneï¼Œå¹¶ä¸”æ•°ç»„ä¸­æ¯ä¸ªé•¿åº¦è¶…è¿‡ limit çš„å­æ•°ç»„éƒ½åŒæ—¶åŒ…å« 0 å’Œ 1ã€‚æ±‚ç¨³å®šäºŒè¿›åˆ¶æ•°ç»„çš„æ€»æ•°ç›®ã€‚\nå®ç°æ€è·¯ï¼šè¿™æ˜¯ä¸€ä¸ªå…¸å‹çš„åŠ¨æ€è§„åˆ’é—®é¢˜ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨é€’å½’å‡½æ•° dfs(i, j, k) æ¥è¡¨ç¤ºä»¥ i ä¸ª 0 å’Œ j ä¸ª 1 å¼€å¤´ï¼Œå¹¶ä¸”æœ€åä¸€ä¸ªå…ƒç´ ä¸º k çš„ç¨³å®šäºŒè¿›åˆ¶æ•°ç»„çš„ä¸ªæ•°ã€‚å…¶ä¸­ï¼Œk å–å€¼ä¸º 0 æˆ– 1ï¼Œè¡¨ç¤ºæœ€åä¸€ä¸ªå…ƒç´ ä¸º 0 æˆ– 1ã€‚é€’å½’çš„è¾¹ç•Œæ¡ä»¶æ˜¯å½“ i æˆ– j ä¸º 0 æ—¶ï¼Œè¿”å› 1 æˆ– 0ï¼Œè¡¨ç¤ºå½“å‰æƒ…å†µä¸‹æœ‰ 1 ä¸ªæˆ– 0 ä¸ªç¨³å®šæ•°ç»„ã€‚åœ¨é€’å½’è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬éœ€è¦è€ƒè™‘å½“å‰å…ƒç´ æ·»åŠ ä¸º 0 æˆ– 1 æ—¶çš„æƒ…å†µï¼Œå¹¶ä¸”æ ¹æ® limit æ¥æ§åˆ¶å­æ•°ç»„çš„é•¿åº¦ï¼Œé¿å…ä¸ç¨³å®šçš„æƒ…å†µã€‚æœ€åï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡é€’å½’è®¡ç®—å¾—åˆ°æ‰€æœ‰æ»¡è¶³æ¡ä»¶çš„ç¨³å®šäºŒè¿›åˆ¶æ•°ç»„çš„ä¸ªæ•°ï¼Œå¹¶å–æ¨¡è¿”å›ã€‚\nclass Solution: def numberOfStableArrays(self, zero: int, one: int, limit: int) -\u0026gt; int: mod = int(1e9)+7 @cache def dfs(i, j, k): if i==0: return 1 if k==1 and j\u0026lt;=limit else 0 if j==0: return 1 if k==0 and i\u0026lt;=limit else 0 if k==0: return ( dfs(i-1, j, 0) + dfs(i-1, j, 1) - (dfs(i-limit-1, j, 1) if i\u0026gt;limit else 0) ) %mod else: return ( dfs(i, j-1, 0) + dfs(i, j-1, 1) - (dfs(i, j-limit-1, 0) if j\u0026gt;limit else 0) ) %mod ans = (dfs(zero, one, 1) + dfs(zero, one, 0))%mod dfs.cache_clear() # é˜²æ­¢çˆ†å†…å­˜ return ans ","permalink":"https://kennems.github.io/posts/tech/%E5%8F%8C%E5%91%A8%E8%B5%9B20230427/","summary":"åŒå‘¨èµ›20230427 ç¬¬ä¸‰/å››é¢˜3130. æ‰¾å‡ºæ‰€æœ‰ç¨³å®šçš„äºŒè¿›åˆ¶æ•°ç»„ II é¢˜ç›®å¤§æ„ï¼šç»™å®šä¸‰ä¸ªæ­£æ•´æ•° zeroã€one å’Œ limitï¼Œå®šä¹‰ä¸€ä¸ªäºŒè¿›åˆ¶æ•°ç»„","title":"LeetCodeåŒå‘¨èµ›129(240427)"},{"content":"å‘¨èµ›20230428 ç¬¬å››é¢˜134. æ‰¾å‡ºå”¯ä¸€æ€§æ•°ç»„çš„ä¸­ä½æ•° é¢˜ç›®å¤§æ„ï¼šç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„numsï¼Œå”¯ä¸€æ€§æ•°ç»„æ˜¯ä¸€ä¸ªæŒ‰å…ƒç´ ä»å°åˆ°å¤§æ’åºçš„æ•°ç»„ï¼ŒåŒ…å«äº†numsçš„æ‰€æœ‰éç©ºå­æ•°ç»„ä¸­ä¸åŒå…ƒç´ çš„ä¸ªæ•°ã€‚è¦æ±‚è¿”å›numså”¯ä¸€æ€§æ•°ç»„çš„ä¸­ä½æ•°ï¼Œå³æœ‰åºå”¯ä¸€æ€§æ•°ç»„çš„ä¸­é—´å…ƒç´ ã€‚\nå®ç°æ€è·¯ï¼šé¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦æ˜ç¡®å”¯ä¸€æ€§æ•°ç»„çš„ç”Ÿæˆæ–¹å¼ï¼Œå³é€šè¿‡éå†æ‰€æœ‰éç©ºå­æ•°ç»„ï¼Œè®¡ç®—å…¶ä¸­ä¸åŒå…ƒç´ çš„ä¸ªæ•°ã€‚ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨äºŒåˆ†æŸ¥æ‰¾çš„æ–¹æ³•ç¡®å®šå”¯ä¸€æ€§æ•°ç»„çš„ä¸­ä½æ•°ã€‚åœ¨äºŒåˆ†æŸ¥æ‰¾çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªè¾…åŠ©å‡½æ•°æ¥åˆ¤æ–­ç»™å®šçš„ä¸­ä½æ•°æ˜¯å¦æ»¡è¶³æ¡ä»¶ï¼Œå³å”¯ä¸€æ€§æ•°ç»„ä¸­ä¸åŒå…ƒç´ çš„ä¸ªæ•°å¤§äºç­‰äºä¸­ä½æ•°ã€‚å¦‚æœæ»¡è¶³æ¡ä»¶ï¼Œæˆ‘ä»¬æ›´æ–°å³è¾¹ç•Œï¼Œå¦åˆ™æ›´æ–°å·¦è¾¹ç•Œï¼Œç›´åˆ°å·¦å³è¾¹ç•Œç›¸é‡ï¼Œå³æ‰¾åˆ°äº†å”¯ä¸€æ€§æ•°ç»„çš„ä¸­ä½æ•°ã€‚\nclass Solution: def medianOfUniquenessArray(self, nums: List[int]) -\u0026gt; int: n = len(nums) k = (n * (n + 1) // 2 + 1) // 2 def check(mid): j, cnt = 0, 0 fre = Counter() for i, num in enumerate(nums): fre[num] += 1 while len(fre) \u0026gt; mid: fre[nums[j]] -= 1 if fre[nums[j]] == 0: del fre[nums[j]] j += 1 cnt += i - j + 1 return cnt \u0026gt;= k l, r = 1, len(set(nums)) while l \u0026lt; r: mid = l + r \u0026gt;\u0026gt; 1 if check(mid): r = mid else: l = mid + 1 return l ","permalink":"https://kennems.github.io/posts/tech/%E5%91%A8%E8%B5%9B240428/","summary":"å‘¨èµ›20230428 ç¬¬å››é¢˜134. æ‰¾å‡ºå”¯ä¸€æ€§æ•°ç»„çš„ä¸­ä½æ•° é¢˜ç›®å¤§æ„ï¼šç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„numsï¼Œå”¯ä¸€æ€§æ•°ç»„æ˜¯ä¸€ä¸ªæŒ‰å…ƒç´ ä»å°åˆ°å¤§æ’åºçš„æ•°ç»„ï¼ŒåŒ…å«äº†","title":"LeetCodeå‘¨èµ›395(240428)"},{"content":"Java Webå¼€å‘(3) Maven Mavenæ˜¯ä¸€æ¬¾ç®¡ç†å’Œæ„å»ºjavaé¡¹ç›®çš„å·¥å…·\nä¾èµ–ç®¡ç† ç»Ÿä¸€çš„é¡¹ç›®ç»“æ„ é¡¹ç›®æ„å»º \u0026lt;maven.compiler.source\u0026gt;11\u0026lt;/maven.compiler.source\u0026gt; \u0026lt;maven.compiler.target\u0026gt;11\u0026lt;/maven.compiler.target\u0026gt; MVNåæ ‡ Mavenä¸­çš„åæ ‡æ˜¯èµ„æºçš„å”¯ä¸€æ ‡è¯†ï¼Œé€šè¿‡è¯¥åæ ‡å¯ä»¥å”¯ä¸€å®šä½èµ„æºä½ç½® ä½¿ç”¨åæ ‡æ¥å®šä¹‰é¡¹ç›®æˆ–å¼•å…¥é¡¹ç›®ä¸­æ‰€éœ€è¦çš„ä¾èµ– Mavençš„åæ ‡ä¸»è¦ç»„æˆ\ngroupid:å®šä¹‰å½“å‰Mavené¡¹ç›®éš¶å±ç»„ç»‡åç§°ï¼ˆé€šå¸¸æ˜¯åŸŸååå†™ï¼‰ artifactIdï¼šå®šä¹‰å½“å‰Mavené¡¹ç›®åç§°ï¼ˆé€šå¸¸æ˜¯æ¨¡å—åç§°ï¼Œä¾‹å¦‚ order-service, goods-serviceï¼‰ versionï¼šå®šä¹‰å½“å‰é¡¹ç›®ç‰ˆæœ¬å· å¯¼å…¥mavenå·¥ç¨‹ï¼š\nMavenä¸­é¡¹ç›®ä¾èµ–é…ç½® åœ¨\u0026lt;dependencies\u0026gt;ä¸­æ·»åŠ \n\u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;ch.qos.logback\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;logback-classic\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.2.3\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; å¦‚æœæ‰€å¼•å…¥çš„ä¾èµ–ï¼Œåœ¨æœ¬åœ°ä»“åº“ä¸å­˜åœ¨ï¼Œå°†ä¼šè¿æ¥è¿œç¨‹ä»“åº“/ä¸­å¤®ä»“åº“ï¼Œç„¶åä¸‹è½½ä¾èµ– å¦‚æœä¸çŸ¥é“ä¾èµ–çš„åæ ‡ä¿¡æ¯ï¼Œåˆ°https://mvnrepository.com/ä¸­æœç´¢ã€‚ Mavenä¾èµ–ç®¡ç† ä¾èµ–å…·æœ‰ä¼ é€’æ€§ ç›´æ¥ä¾èµ–ï¼šåœ¨å½“å‰é¡¹ç›®ä¸­é€šè¿‡ä¾èµ–é…ç½®å»ºç«‹çš„ä¾èµ–å…³ç³» é—´æ¥ä¾èµ–ï¼šè¢«ä¾èµ–çš„èµ„æºå¦‚æœä¾èµ–å…¶ä»–èµ„æºï¼Œå½“å‰é¡¹ç›®é—´æ¥ä¾èµ–å…¶ä»–èµ„æº æ’é™¤ä¾èµ– \u0026lt;!-- æ’é™¤ä¾èµ–--\u0026gt; \u0026lt;exclusions\u0026gt; \u0026lt;exclusion\u0026gt; \u0026lt;groupId\u0026gt;junit\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;junit\u0026lt;/artifactId\u0026gt; \u0026lt;/exclusion\u0026gt; \u0026lt;/exclusions\u0026gt; ä¾èµ–èŒƒå›´ ä¾èµ–çš„jaråŒ…ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œå¯ä»¥åœ¨ä»»ä½•åœ°æ–¹ä½¿ç”¨ï¼Œå¯ä»¥é€šè¿‡\u0026lt;scope\u0026gt;...\u0026lt;/scope\u0026gt;è®¾ç½®å…¶ä½œç”¨èŒƒå›´\nä½œç”¨èŒƒå›´ï¼š ä¸»ç¨‹åºèŒƒå›´æœ‰æ•ˆã€‚ï¼ˆmainæ–‡ä»¶å¤¹èŒƒå›´å†…ï¼‰ æµ‹è¯•ç¨‹åºèŒƒå›´æœ‰æ•ˆã€‚ï¼ˆtestæ–‡ä»¶å¤¹èŒƒå›´å†…ï¼‰ æ˜¯å¦å‚ä¸æ‰“åŒ…è¿è¡Œã€‚ï¼ˆpackageæŒ‡ä»¤èŒƒå›´å†…ï¼‰ scopeå€¼ æä¾›åº“ ç¼–è¯‘æ—¶ è¿è¡Œæ—¶ èŒƒä¾‹ compile Y Y Y log4j test - Y - junit provided Y Y - servlet-api runtime - Y Y jdbcé©±åŠ¨ Mavenç”Ÿå‘½å‘¨æœŸ æ¯å¥—ç”Ÿå‘½å‘¨æœŸåŒ…å«ä¸€äº›é˜¶æ®µï¼ˆphaseï¼‰ï¼Œé˜¶æ®µæ˜¯æœ‰é¡ºåºçš„ï¼Œåé¢çš„é˜¶æ®µä¾èµ–äºå‰é¢çš„é˜¶æ®µ\nclean : ç§»é™¤ä¸Šä¸€æ¬¡æ„å»ºç”Ÿæˆçš„æ–‡ä»¶ compile : ç¼–è¯‘é¡¹ç›®æºä»£ç  test : ä½¿ç”¨åˆé€‚çš„å•å…ƒæµ‹è¯•æ¡†æ¶è¿è¡Œæµ‹è¯•ï¼ˆjunitï¼‰ package ï¼š å°†ç¼–è¯‘åçš„æ–‡ä»¶æ‰“åŒ…ï¼Œå¦‚ï¼šjar, warç­‰ install ï¼š å®‰è£…é¡¹ç›®åˆ°æœ¬åœ°ä»“åº“ åŒä¸€å¥—ç”Ÿå‘½å‘¨æœŸä¸­ï¼Œå½“è¿è¡Œåé¢çš„é˜¶æ®µæ—¶ï¼Œå‰é¢çš„é˜¶æ®µéƒ½ä¼šè¿è¡Œã€‚\nSpringBootå¼€å‘ åˆ›å»ºSpringWebå·¥ç¨‹\npackage com.showguan; import org.springframework.web.bind.annotation.RequestMapping; import org.springframework.web.bind.annotation.RestController; @RestController public class HelloController { @RequestMapping(\u0026#34;/hello\u0026#34;) public String hello() { System.out.println(\u0026#34;hello world\u0026#34;); return \u0026#34;hello world!\u0026#34;; } } HTTPåè®® Hyper Text Transfer Protocol, è¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼Œè§„å®šäº†æµè§ˆå™¨å’ŒæœåŠ¡å™¨ä¹‹é—´çš„æ•°æ®ä¼ è¾“çš„è§„åˆ™ ç‰¹ç‚¹ï¼š\nåŸºäºTCPåè®®ï¼šé¢å‘è¿æ¥ï¼Œå®‰å…¨ åŸºäºè¯·æ±‚-å“åº”æ¨¡å‹çš„ï¼šä¸€æ¬¡è¯·æ±‚å¯¹åº”ä¸€æ¬¡å“åº” HTTPåè®®æ˜¯æ— çŠ¶æ€çš„åè®®ï¼šå¯¹äºäº‹ç‰©å¤„ç†æ²¡æœ‰è®°å¿†èƒ½åŠ›ã€‚æ¯æ¬¡è¯·æ±‚-å“åº”éƒ½æ˜¯ç‹¬ç«‹çš„ã€‚ ç¼ºç‚¹ï¼šå¤šæ¬¡è¯·æ±‚é—´ä¸èƒ½å…±äº«æ•°æ® ä¼˜ç‚¹ï¼šé€Ÿåº¦å¿« HTTPè¯·æ±‚åè®® è¯·æ±‚è¡Œï¼ˆè¯·æ±‚æ–¹å¼ï¼Œèµ„æºè·¯å¾„, åè®®ï¼‰ GET /hello HTTP/1.1\rPOST /hello HTTP/1.1 è¯·æ±‚å¤´ï¼šç¬¬äºŒè¡Œå¼€å§‹ï¼Œæ ¼å¼ ï¼š key:value åç§° å€¼ Host è¯·å¡«å†™æ‚¨çš„ç½‘ç«™åŸŸå User-Agent ç”¨æˆ·ä»£ç†ï¼Œæ ‡è¯†å‘å‡ºè¯·æ±‚çš„æµè§ˆå™¨å’Œæ“ä½œç³»ç»Ÿï¼Œä¾‹å¦‚Mozilla/5.0 (Windows NT\u0026hellip;) like Gecko Accept å¯æ¥å—çš„å“åº”å†…å®¹ç±»å‹ï¼Œä¾‹å¦‚text/*, image/*ç­‰ Accept-Language å¯æ¥å—çš„å“åº”å†…å®¹è¯­è¨€ï¼Œä¾‹å¦‚zh-CN,zh;q=0.8 Accept-Encoding å¯æ¥å—çš„å“åº”å†…å®¹ç¼–ç æ–¹å¼ï¼Œä¾‹å¦‚gzip, deflateç­‰ Content-Type è¯·æ±‚ä½“çš„åª’ä½“ç±»å‹ Content-Length è¯·æ±‚ä½“çš„é•¿åº¦ï¼ˆå•ä½ï¼šå­—èŠ‚ï¼‰ è¯·æ±‚ä½“ï¼šPOSTè¯·æ±‚ï¼Œå­˜æ”¾è¯·æ±‚å‚æ•° è¯·æ±‚æ–¹å¼-GETï¼šè¯·æ±‚å‚æ•°åœ¨è¯·æ±‚è¡Œä¸­ï¼Œæ²¡æœ‰è¯·æ±‚ä½“ è¯·æ±‚æ–¹å¼-POSTï¼šè¯·æ±‚å‚æ•°åœ¨è¯·æ±‚ä½“ä¸­ï¼ŒPOSTè¯·æ±‚å¤§å°æ˜¯æ²¡æœ‰é™åˆ¶çš„ HTTPå“åº”åè®® å“åº”æ ¼å¼ å“åº”è¡Œï¼šå“åº”æ•°æ®ç¬¬ä¸€è¡Œï¼ˆåè®®ï¼ŒçŠ¶æ€ç ï¼Œæè¿°ï¼‰ çŠ¶æ€ç åˆ†ç±» è¯´æ˜ 1xx å“åº”ä¸­ \u0026mdash; ä¸´æ—¶çŠ¶æ€ç ã€‚è¡¨ç¤ºè¯·æ±‚å·²ç»æ¥å—ï¼Œå‘Šè¯‰å®¢æˆ·ç«¯åº”è¯¥ç»§ç»­è¯·æ±‚æˆ–è€…å¦‚æœå·²ç»å®Œæˆåˆ™å¿½ç•¥ 2xx æˆåŠŸ \u0026mdash; è¡¨ç¤ºè¯·æ±‚å·²ç»è¢«æˆåŠŸæ¥æ”¶ï¼Œå¤„ç†å·²å®Œæˆ 3xx é‡å®šå‘ \u0026mdash; é‡å®šå‘åˆ°å…¶å®ƒåœ°æ–¹ï¼Œè®©å®¢æˆ·ç«¯å†å‘èµ·ä¸€ä¸ªè¯·æ±‚ä»¥å®Œæˆæ•´ä¸ªå¤„ç† 4xx å®¢æˆ·ç«¯é”™è¯¯ \u0026mdash; å¤„ç†å‘ç”Ÿé”™è¯¯ï¼Œè´£ä»»åœ¨å®¢æˆ·ç«¯ï¼Œå¦‚ï¼šå®¢æˆ·ç«¯çš„è¯·æ±‚ä¸€ä¸ªä¸å­˜åœ¨çš„èµ„æºï¼Œå®¢æˆ·ç«¯æœªè¢«æˆæƒï¼Œç¦æ­¢è®¿é—®ç­‰ 5xx æœåŠ¡å™¨ç«¯é”™è¯¯ \u0026mdash; å¤„ç†å‘ç”Ÿé”™è¯¯ï¼Œè´£ä»»åœ¨æœåŠ¡ç«¯ï¼Œå¦‚ï¼šæœåŠ¡ç«¯æŠ›å‡ºå¼‚å¸¸ï¼Œè·¯ç”±å‡ºé”™ï¼ŒHTTPç‰ˆæœ¬ä¸æ”¯æŒç­‰ ä¸€ã€çŠ¶æ€ç å¤§ç±» çŠ¶æ€ç åˆ†ç±» è¯´æ˜ 1xx å“åº”ä¸­â€”â€”ä¸´æ—¶çŠ¶æ€ç ï¼Œè¡¨ç¤ºè¯·æ±‚å·²ç»æ¥å—ï¼Œå‘Šè¯‰å®¢æˆ·ç«¯åº”è¯¥ç»§ç»­è¯·æ±‚æˆ–è€…å¦‚æœå®ƒå·²ç»å®Œæˆåˆ™å¿½ç•¥å®ƒ 2xx æˆåŠŸâ€”â€”è¡¨ç¤ºè¯·æ±‚å·²ç»è¢«æˆåŠŸæ¥æ”¶ï¼Œå¤„ç†å·²å®Œæˆ 3xx é‡å®šå‘â€”â€”é‡å®šå‘åˆ°å…¶å®ƒåœ°æ–¹ï¼šå®ƒè®©å®¢æˆ·ç«¯å†å‘èµ·ä¸€ä¸ªè¯·æ±‚ä»¥å®Œæˆæ•´ä¸ªå¤„ç†ã€‚ 4xx å®¢æˆ·ç«¯é”™è¯¯â€”â€”å¤„ç†å‘ç”Ÿé”™è¯¯ï¼Œè´£ä»»åœ¨å®¢æˆ·ç«¯ï¼Œå¦‚ï¼šå®¢æˆ·ç«¯çš„è¯·æ±‚ä¸€ä¸ªä¸å­˜åœ¨çš„èµ„æºï¼Œå®¢æˆ·ç«¯æœªè¢«æˆæƒï¼Œç¦æ­¢è®¿é—®ç­‰ 5xx æœåŠ¡å™¨ç«¯é”™è¯¯â€”â€”å¤„ç†å‘ç”Ÿé”™è¯¯ï¼Œè´£ä»»åœ¨æœåŠ¡ç«¯ï¼Œå¦‚ï¼šæœåŠ¡ç«¯æŠ›å‡ºå¼‚å¸¸ï¼Œè·¯ç”±å‡ºé”™ï¼ŒHTTPç‰ˆæœ¬ä¸æ”¯æŒç­‰ äºŒã€å¸¸è§çš„å“åº”çŠ¶æ€ç  çŠ¶æ€ç  è‹±æ–‡æè¿° è§£é‡Š ==200== OK å®¢æˆ·ç«¯è¯·æ±‚æˆåŠŸï¼Œå³å¤„ç†æˆåŠŸï¼Œè¿™æ˜¯æˆ‘ä»¬æœ€æƒ³çœ‹åˆ°çš„çŠ¶æ€ç  302 Found æŒ‡ç¤ºæ‰€è¯·æ±‚çš„èµ„æºå·²ç§»åŠ¨åˆ°ç”±Locationå“åº”å¤´ç»™å®šçš„ URLï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨é‡æ–°è®¿é—®åˆ°è¿™ä¸ªé¡µé¢ 304 Not Modified å‘Šè¯‰å®¢æˆ·ç«¯ï¼Œä½ è¯·æ±‚çš„èµ„æºè‡³ä¸Šæ¬¡å–å¾—åï¼ŒæœåŠ¡ç«¯å¹¶æœªæ›´æ”¹ï¼Œä½ ç›´æ¥ç”¨ä½ æœ¬åœ°ç¼“å­˜å§ã€‚éšå¼é‡å®šå‘ 400 Bad Request å®¢æˆ·ç«¯è¯·æ±‚æœ‰è¯­æ³•é”™è¯¯ï¼Œä¸èƒ½è¢«æœåŠ¡å™¨æ‰€ç†è§£ 403 Forbidden æœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚ï¼Œä½†æ˜¯æ‹’ç»æä¾›æœåŠ¡ï¼Œæ¯”å¦‚ï¼šæ²¡æœ‰æƒé™è®¿é—®ç›¸å…³èµ„æº ==404== Not Found è¯·æ±‚èµ„æºä¸å­˜åœ¨ï¼Œä¸€èˆ¬æ˜¯URLè¾“å…¥æœ‰è¯¯ï¼Œæˆ–è€…ç½‘ç«™èµ„æºè¢«åˆ é™¤äº† 405 Method Not Allowed è¯·æ±‚æ–¹å¼æœ‰è¯¯ï¼Œæ¯”å¦‚åº”è¯¥ç”¨GETè¯·æ±‚æ–¹å¼çš„èµ„æºï¼Œç”¨äº†POST 428 Precondition Required æœåŠ¡å™¨è¦æ±‚æœ‰æ¡ä»¶çš„è¯·æ±‚ï¼Œå‘Šè¯‰å®¢æˆ·ç«¯è¦æƒ³è®¿é—®è¯¥èµ„æºï¼Œå¿…é¡»æºå¸¦ç‰¹å®šçš„è¯·æ±‚å¤´ 429 Too Many Requests æŒ‡ç¤ºç”¨æˆ·åœ¨ç»™å®šæ—¶é—´å†…å‘é€äº†å¤ªå¤šè¯·æ±‚ï¼ˆâ€œé™é€Ÿâ€ï¼‰ï¼Œé…åˆ Retry-After(å¤šé•¿æ—¶é—´åå¯ä»¥è¯·æ±‚)å“åº”å¤´ä¸€èµ·ä½¿ç”¨ 431 Request Header Fields Too Large è¯·æ±‚å¤´å¤ªå¤§ï¼ŒæœåŠ¡å™¨ä¸æ„¿æ„å¤„ç†è¯·æ±‚ï¼Œå› ä¸ºå®ƒçš„å¤´éƒ¨å­—æ®µå¤ªå¤§ã€‚è¯·æ±‚å¯ä»¥åœ¨å‡å°‘è¯·æ±‚å¤´åŸŸçš„å¤§å°åé‡æ–°æäº¤ã€‚ ==500== Internal Server Error æœåŠ¡å™¨å‘ç”Ÿä¸å¯é¢„æœŸçš„é”™è¯¯ã€‚æœåŠ¡å™¨å‡ºå¼‚å¸¸äº†ï¼Œèµ¶ç´§çœ‹æ—¥å¿—å»å§ 503 Service Unavailable æœåŠ¡å™¨å°šæœªå‡†å¤‡å¥½å¤„ç†è¯·æ±‚ï¼ŒæœåŠ¡å™¨åˆšåˆšå¯åŠ¨ï¼Œè¿˜æœªåˆå§‹åŒ–å¥½ çŠ¶æ€ç å¤§å…¨ï¼šhttps://cloud.tencent.com/developer/chapter/13553\nå“åº”å¤´ï¼šç¬¬äºŒè¡Œå¼€å§‹ï¼Œæ ¼å¼ key:value å“åº”ä½“ï¼šæœ€åä¸€éƒ¨åˆ†ï¼Œå­˜æ”¾å“åº”æ•°æ® WebæœåŠ¡å™¨ WebæœåŠ¡å™¨æ˜¯ä¸€ä¸ªè½¯ä»¶ç¨‹åºï¼Œå¯¹HTTPåè®®çš„æ“ä½œè¿›è¡Œå°è£…ï¼Œä½¿å¾—ç¨‹åºå‘˜ä¸å¿…ç›´æ¥å¯¹åè®®è¿›è¡Œæ“ä½œï¼Œè®©Webå¼€å‘æ›´åŠ ä¾¿æ·ã€‚ä¸»è¦åŠŸèƒ½æ˜¯â€œæä¾›ç½‘ä¸Šä¿¡æ¯æµè§ˆæœåŠ¡â€ã€‚\nTomCat Apacheè½¯ä»¶åŸºé‡‘ä¼šä¸€ä¸ªæ ¸å¿ƒå°æœ¨ï¼Œæ˜¯ä¸€ä¸ªå¼€æºå…è´¹çš„è½»é‡çº§WebæœåŠ¡å™¨ï¼Œæ”¯æŒServlet/JSPå°‘é‡JavaEEè§„èŒƒ TomCatä¹Ÿè¢«ç§°ä¸ºWebå®¹å™¨ï¼ŒServletå®¹å™¨ã€‚Servletç¨‹åºéœ€è¦ä¾èµ–äºTomCatæ‰èƒ½è¿è¡Œ å¯åŠ¨æ–¹å¼ï¼šbin/startup.bat\nä¿®æ”¹TomCatç«¯å£å·\nconf/server.xml\nLocalhosté»˜è®¤ç«¯å£å·å°±æ˜¯80\nç”¨tomcatéƒ¨ç½²ï¼Œå°†htmlæ–‡ä»¶å¤åˆ¶åˆ°webappsæ–‡ä»¶å¤¹ä¸­\nèµ·æ­¥ä¾èµ–ï¼š\nåŸºäºSpringBootå¼€å‘çš„webåº”ç”¨ç¨‹åºï¼Œå†…ç½®äº†tomcatæœåŠ¡å™¨ï¼Œå½“å¯åŠ¨ç±»è¿è¡Œæ—¶ï¼Œä¼šè‡ªåŠ¨å¯åŠ¨å†…åµŒçš„tomcatæœåŠ¡å™¨ è¯·æ±‚ å‰åç«¯åˆ†ç¦»å¼€å‘\nPostMan\nå®ä½“å‚æ•° å®ä½“å¯¹è±¡å‚æ•°ï¼šè¯·æ±‚å‚æ•°åä¸å½¢å‚å¯¹è±¡å±æ€§åç›¸åŒï¼Œ å³å¯ç›´æ¥é€šè¿‡POJOæ¥å—\næ•°ç»„é›†åˆå‚æ•° æ•°ç»„å‚æ•°ï¼šè¯·æ±‚å‚æ•°åä¸å½¢å‚æ•°ç»„åç§°ç›¸åŒä¸”è¯·æ±‚å‚æ•°ä¸ºå¤šä¸ªï¼Œå®šä¹‰æ•°ç»„ç±»å‹å½¢å‚å³å¯æ¥å—å‚æ•° è·¯å¾„å‚æ•° é€šè¿‡è¯·æ±‚URLç›´æ¥ä¼ é€’å‚æ•°ï¼Œä½¿ç”¨{...}æ¥æ ‡è¯†è¯¥è·¯å¾„å‚æ•°ï¼Œä½¿ç”¨@PathVariableè·å–è·¯å¾„å‚æ•° å“åº” ResponseBody\nç±»å‹ï¼šæ–¹æ³•æ³¨è§£ï¼Œç±»æ³¨è§£ ä½ç½®ï¼šControlleræ–¹æ³•ä¸Š/ç±»ä¸Š ä½œç”¨ï¼šå°†æ–¹æ³•è¿”å›å€¼ç›´æ¥å“åº”ï¼Œå¦‚æœè¿”å›å€¼ç±»å‹æ—¶ å®ä½“ç±»å‹/é›†åˆï¼Œå°†ä¼šè½¬æ¢ä¸ºJSONæ ¼å¼å“åº” è¯´æ˜ï¼š@RestController = @Controller + @ResponseBody ç»Ÿä¸€å“åº”ç»“æœ Result(code, msg, data) public class Result { private Integer code ;//1 æˆåŠŸ , 0 å¤±è´¥ private String msg; //æç¤ºä¿¡æ¯ private Object data; //æ•°æ® data } åˆ†å±‚è§£è€¦ ä¸‰å±‚æ¶æ„\ncontroller:æ§åˆ¶å±‚ï¼Œæ¥å—å‰ç«¯å‘é€çš„è¯·æ±‚ï¼Œå¯¹è¯·æ±‚è¿›è¡Œå¤„ç†ï¼Œå¹¶å“åº”æ•°æ® service:ä¸šåŠ¡é€»è¾‘å±‚ï¼Œå¤„ç†å…·ä½“çš„ä¸šåŠ¡é€»è¾‘ dao:æ•°æ®è®¿é—®å±‚ï¼ˆData Access Objectï¼‰ï¼ˆæŒä¹…å±‚ï¼‰ï¼Œè´Ÿè´£æ•°æ®è®¿é—®æ“ä½œï¼ŒåŒ…æ‹¬æ•°æ®çš„å¢ã€åˆ ã€æ”¹ã€æŸ¥ã€‚ å†…èšï¼šè½¯ä»¶ä¸­å„ä¸ªåŠŸèƒ½æ¨¡å—å†…éƒ¨çš„åŠŸèƒ½è”ç³»\nè€¦åˆï¼šè¡¡é‡è½¯ä»¶ä¸­å„ä¸ªå±‚/æ¨¡å—ä¹‹é—´çš„ä¾èµ–ã€å…³è”çš„ç¨‹åº¦\nè½¯ä»¶è®¾è®¡åŸåˆ™ï¼šé«˜å†…èšä½è€¦åˆ\næ§åˆ¶åè½¬ï¼šInversion Of Controlï¼ˆIOCï¼‰ã€‚å¯¹è±¡çš„åˆ›å»ºæ§åˆ¶æƒç”±è½¦å…‰ç»ªè‡ªèº«è½¬ç§»åˆ°å¤–éƒ¨(å®¹å™¨)ï¼Œ è¿™ç§æ€æƒ³ç§°ä¸ºæ§åˆ¶åè½¬ã€‚\nä¾èµ–æ³¨å…¥ï¼šDependency Injection, ç®€ç§°DIã€‚ å®¹å™¨ä¸ºåº”ç”¨ç¨‹åºæä¾›è¿è¡Œæ—¶ï¼Œæ‰€ä»¥æ¥çš„ç»„å‘˜ï¼Œç§°ä¹‹ä¸ºä¾èµ–æ³¨å…¥ã€‚\nBeanå¯¹è±¡ï¼šIOCå®¹å™¨ä¸­åˆ›å»ºã€ç®¡ç†çš„å¯¹è±¡ï¼Œç§°ä¹‹ä¸ºbeanã€‚\nç”¨@Componentæ ‡è¯†å®¹å™¨\nIOCæ§åˆ¶åè½¬ é™¤äº†@Componentä¹‹å¤–è¿˜æœ‰@Service, @Repositoryï¼Œ @Controller\næ³¨æ„äº‹é¡¹ï¼š\nå£°æ˜beançš„æ—¶å€™ï¼Œå¯ä»¥é€šè¿‡valueå±æ€§æŒ‡å®šbeançš„åå­—ï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®šï¼Œé»˜è®¤ä¸ºç±»åé¦–å­—æ¯å°å†™ ä½¿ç”¨ä»¥ä¸Šå››ä¸ªæ³¨è§£éƒ½å¯ä»¥å£°æ˜beanï¼Œ ä½†æ˜¯åœ¨springbootç»§æ‰¿webå¼€å‘ä¸­ï¼Œå£°æ˜æ§åˆ¶å™¨beanåªèƒ½ç”¨@Controller Beanç»„ä»¶æ‰«æï¼š\nå£°æ˜beanè‹¥è¦æƒ³ç”Ÿæ•ˆï¼Œéœ€è¦è¢«ç»„ä»¶æ‰«ææ³¨è§£@ComponentScanæ‰«æ @ComponentScanæ³¨è§£è™½ç„¶æ²¡æœ‰æ˜¾å¼é…ç½®ï¼Œä½†æ˜¯å®é™…ä¸Šå·²ç»åŒ…å«åœ¨äº†å¯åŠ¨ç±»å£°æ˜æ³¨è§£@SpringBootApplicationä¸­ï¼Œé»˜è®¤æ‰«æçš„èŒƒå›´æ—¶å¯åŠ¨ç±»æ‰€åœ¨åŒ…åŠå…¶å­åŒ… Beanæ³¨å…¥ @Autowiredæ³¨è§£ï¼Œé»˜è®¤æ—¶æŒ‰ç…§ç±»å‹è¿›è¡Œï¼Œå¦‚æœå­˜åœ¨å¤šä¸ªç›¸åŒç±»å‹çš„beanï¼Œ å°†ä¼šæŠ¥å‡ºå¦‚ä¸‹é”™è¯¯ï¼š\nå¦‚æœåŒç±»å‹çš„beanå­˜åœ¨å¤šä¸ªï¼š\n@Primary @Autowired + @Qualifier(\u0026quot;beançš„åç§°\u0026quot;) @Resource(name = \u0026quot;beançš„åç§°\u0026quot;) é¢è¯•é¢˜\n@Resourceå’Œ@Autowiredçš„åŒºåˆ«ï¼š @Autowiredæ˜¯springæ¡†æ¶æä¾›çš„æ³¨è§£ï¼Œè€Œ@Resourceæ˜¯JDKæä¾›çš„æ³¨è§£ã€‚ @Autowiredé»˜è®¤æ˜¯æŒ‰ç…§ç±»å‹æ³¨å…¥ï¼Œè€Œ@Resourceé»˜è®¤æ˜¯æŒ‰ç…§åç§°æ³¨å…¥çš„ã€‚ ","permalink":"https://kennems.github.io/posts/tech/java-web%E5%BC%80%E5%8F%913/","summary":"Java Webå¼€å‘(3) Maven Mavenæ˜¯ä¸€æ¬¾ç®¡ç†å’Œæ„å»ºjavaé¡¹ç›®çš„å·¥å…· ä¾èµ–ç®¡ç† ç»Ÿä¸€çš„é¡¹ç›®ç»“æ„ é¡¹ç›®æ„å»º \u0026lt;maven.compiler.source\u0026gt;11\u0026lt;/maven.compiler.source\u0026gt; \u0026lt;maven.compiler.target\u0026gt;11\u0026lt;/maven.compiler.target\u0026gt; MVNåæ ‡ Mavenä¸­çš„åæ ‡æ˜¯èµ„æºçš„å”¯ä¸€æ ‡","title":"Java Webå¼€å‘(3)"},{"content":"Java Webå¼€å‘(4) æ•°æ®åº“ æ•°æ®åº“ï¼šDataBase(DB) ï¼Œ æ˜¯å­˜å‚¨å’Œç®¡ç†æ•°æ®çš„ä»“åº“ DBMSï¼Œ SQL MySqlç™»å½•ï¼Œé¦–å…ˆåœ¨æœåŠ¡ä¸­å¯åŠ¨mysql\nmysql -uroot -p\u0026#34;password\u0026#34; æˆ–è€…\nmysql -uroot -p ä¹‹åè¾“å…¥å¯†ç \nè¿æ¥è¿œç¨‹æ•°æ®åº“\nmysql -h192.168.88.130 -P3306 -utopeet -p\u0026#34;password\u0026#34; æŸ¥çœ‹å½“å‰çš„æ•°æ®åº“\nselect database(); å…³ç³»å‹æ•°æ®åº“ï¼ˆRDBMSï¼‰ï¼šå»ºç«‹åœ¨å…³ç³»æ¨¡å‹åŸºç¡€ä¸Šï¼Œç”±å¤šå¼ ç›¸äº’è¿æ¥çš„äºŒç»´è¡¨ç»„æˆçš„æ•°æ®åº“\nSQLï¼šä¸€é—¨æ“ä½œå…³ç³»å‹æ•°æ®åº“çš„ç¼–ç¨‹è¯­è¨€ï¼Œå®šä¹‰æ“ä½œæ‰€æœ‰å…³ç³»å‹æ•°æ®åº“çš„ç»Ÿä¸€æ ‡å‡†\nSQLè¯­å¥å¯ä»¥å•è¡Œæˆ–å¤šè¡Œä¹¦å†™ï¼Œä»¥åˆ†å·ç»“å°¾ SQLè¯­å¥å¯ä»¥ä½¿ç”¨ç©ºæ ¼/ç¼©è¿›æ¥å¢å¼ºè¯­å¥çš„å¯è¯»æ€§ MySQLæ•°æ®åº“çš„SQLè¯­å¥ä¸åŒºåˆ†å¤§å°å†™ æ³¨é‡Šï¼š å•è¡Œæ³¨é‡Šï¼š \u0026ndash; æ³¨é‡Šå†…å®¹ æˆ–è€… #æ³¨é‡Šå†…å®¹ï¼ˆMySQLç‰¹æœ‰ï¼‰ å¤šè¡Œæ³¨é‡Šï¼š/* æ³¨é‡Šå†…å®¹ */ create database db02; DDLï¼Œ DMLï¼Œ DQLï¼Œ DCL\ncreate database if not exists db02; drop database if exists db03; show databases; select database(); show schemas; DDL åˆ›å»ºè¡¨ çº¦æŸï¼š\néç©ºçº¦æŸ not null å”¯ä¸€çº¦æŸ unique ä¸»é”®çº¦æŸ primary key ï¼ˆauto_incrementè‡ªå¢ï¼‰ é»˜è®¤çº¦æŸ default å¤–é”®çº¦æŸ foreign key (è‡³å°‘æœ‰ä¸¤å¼ è¡¨) æ•°æ®ç±»å‹ ä¸»è¦åˆ†ä¸ºä¸‰ç±»ï¼šæ•°å€¼ç±»å‹ï¼Œå­—ç¬¦ä¸²ç±»å‹ï¼Œæ—¥æœŸæ—¶é—´ç±»å‹\næ•°å€¼ç±»å‹ï¼š\nç±»å‹ å¤§å° æœ‰ç¬¦å·èŒƒå›´ æ— ç¬¦å·èŒƒå›´ æè¿° tinyint 1 ï¼ˆ-128ï¼Œ 127ï¼‰ ï¼ˆ0ï¼Œ 255ï¼‰ å°æ•´æ•°å€¼ smallint 2 ï¼ˆ-32768, 32767) ï¼ˆ0, 65535) å¤§æ•´æ•°å€¼ mediumint 3 ï¼ˆ-8388608ï¼Œ 8388607ï¼‰ ï¼ˆ0ï¼Œ 16777215ï¼‰ å¤§æ•´æ•°å€¼ int 4 ï¼ˆ-2147483647ï¼Œ 2147483648ï¼‰ ï¼ˆ0ï¼Œ 4294967295ï¼‰ å¤§æ•´æ•°å€¼ bigint 8 ï¼ˆ-2^63, 2^63-1) ï¼ˆ0ï¼Œ 2^64-1) æå¤§æ•´æ•°å€¼ float 4 å•ç²¾åº¦æµ®ç‚¹å€¼ float(5, 2)è¡¨ç¤ºæ•´ä¸ªæ•°å­—é•¿åº¦ä¸º5ï¼Œ å°æ•°ä½æ•°ä¸º2 double 8 åŒç²¾åº¦æµ®ç‚¹å€¼ decimal å°æ•°å€¼ï¼ˆç²¾åº¦æ›´é«˜ï¼‰ é‡‘é¢è®¡ç®— æŸ¥è¯¢å½“å‰æ•°æ®åº“çš„æ‰€æœ‰è¡¨ï¼š\nshow tables; æŸ¥è¯¢è¡¨ç»“æ„ï¼š\ndesc è¡¨å æŸ¥è¯¢å»ºè¡¨è¯­å¥ï¼š\nshow create table è¡¨å -- å‘˜å·¥ç®¡ç†(å¸¦çº¦æŸ) create table tb_emp ( id int unsigned primary key auto_increment comment \u0026#39;ID\u0026#39;, username varchar(20) not null unique comment \u0026#39;ç”¨æˆ·å\u0026#39;, password varchar(32) default \u0026#39;123456\u0026#39; comment \u0026#39;å¯†ç \u0026#39;, name varchar(10) not null comment \u0026#39;å§“å\u0026#39;, gender tinyint unsigned not null comment \u0026#39;æ€§åˆ«, è¯´æ˜: 1 ç”·, 2 å¥³\u0026#39;, image varchar(300) comment \u0026#39;å›¾åƒ\u0026#39;, job tinyint unsigned comment \u0026#39;èŒä½, è¯´æ˜: 1 ç­ä¸»ä»»,2 è®²å¸ˆ, 3 å­¦å·¥ä¸»ç®¡, 4 æ•™ç ”ä¸»ç®¡\u0026#39;, entrydate date comment \u0026#39;å…¥èŒæ—¶é—´\u0026#39;, create_time datetime not null comment \u0026#39;åˆ›å»ºæ—¶é—´\u0026#39;, update_time datetime not null comment \u0026#39;ä¿®æ”¹æ—¶é—´\u0026#39; ) comment \u0026#39;å‘˜å·¥è¡¨\u0026#39;; alter table tb_emp add qq varchar(11) comment \u0026#39;QQ\u0026#39;; alter table tb_emp modify qq varchar(13) comment \u0026#39;QQ\u0026#39;; alter table tb_emp change qq qq_num varchar(13) comment \u0026#39;QQ\u0026#39;; alter table tb_emp drop column qq_num; rename table tb_emp to emp; drop table if exists tb_emp; DML Data Manipulation Language(æ•°æ®æ“ä½œè¯­è¨€)ï¼Œ ç”¨æ¥å¯¹æ•°æ®åº“ä¸­è¡¨çš„æ•°æ®è®°å½•è¿›è¡Œå¢ï¼Œåˆ ï¼Œæ”¹æ“ä½œã€‚\ninsert into tb_emp(username,name,gender,create_time,update_time) values (\u0026#39;Kennem\u0026#39;, \u0026#39;å¼ æ— å¿Œ\u0026#39;, \u0026#39;1\u0026#39;,now(),now()); # æ’å…¥çš„å†…å®¹åŒ…å«æ‰€æœ‰å­—æ®µï¼ˆå¯ä»¥çœç•¥æ‰€æœ‰å­—æ®µï¼‰ insert into tb_emp(id, username, password, name, gender, image, job, entrydate, create_time, update_time) values (null, \u0026#39;zhiruo\u0026#39;, \u0026#39;123\u0026#39;, \u0026#39;kdkd\u0026#39;, 2, \u0026#39;1.jpg\u0026#39;, 1, \u0026#39;2021-01-20\u0026#39;,now(), now()); # æ’å…¥å¤šç»„æ•°æ® insert into tb_emp(username, password, name, gender, image, job, entrydate, create_time, update_time) values (\u0026#39;Oliver\u0026#39;, \u0026#39;123\u0026#39;, \u0026#39;kdkd\u0026#39;, 2, \u0026#39;1.jpg\u0026#39;, 1, \u0026#39;2021-01-20\u0026#39;,now(), now()),(\u0026#39;Linux\u0026#39;, \u0026#39;123\u0026#39;, \u0026#39;kdkd\u0026#39;, 2, \u0026#39;1.jpg\u0026#39;, 1, \u0026#39;2021-01-20\u0026#39;,now(), now()); # æ›´æ–°æ•°æ® update tb_emp set name = \u0026#39;å¼ ä¸‰\u0026#39;, update_time = now() where id = 1; # æ›´æ–°æ‰€æœ‰æ•°æ®çš„æ­¤å­—æ®µ update tb_emp set entrydate = \u0026#39;2010-01-01\u0026#39;, update_time = now(); # æ›´æ–°æ‰€æœ‰è¡Œ # åˆ é™¤id=1çš„æ•°æ® delete from emp where id=1; # åˆ é™¤æ‰€æœ‰æ•°æ® delete from emp; # deleteä¸èƒ½åˆ é™¤æŸä¸€å­—æ®µçš„å€¼ï¼Œå¯ä»¥ç”¨updateå°†è¿™ä¸€å­—æ®µè®¾ç½®ä¸ºNULL DQL Data Query Languageï¼ˆæ•°æ®æŸ¥è¯¢è¯­è¨€ï¼‰ï¼Œ ç”¨æ¥æŸ¥è¯¢æ•°æ®åº“è¡¨ä¸­çš„è®°å½• å…³é”®å­—ï¼šSELECT select from where group by having order by limit èšåˆå‡½æ•°ï¼š\ncount max min avg sum select name, entrydate from tb_emp; select tb_emp.id, tb_emp.username, tb_emp.password, tb_emp.name, tb_emp.gender, tb_emp.image, tb_emp.job, tb_emp.entrydate, tb_emp.create_time, tb_emp.update_time from tb_emp; select * from tb_emp; select name as å§“å, entrydate as å…¥èŒæ—¥æœŸ from tb_emp; select name as \u0026#39;å§“ å\u0026#39;, entrydate as å…¥èŒæ—¥æœŸ from tb_emp; select distinct job from tb_emp; -- é€‰æ‹©tb_empè¡¨ä¸­çš„nameå’Œentrydateå­—æ®µ select name, entrydate from tb_emp; -- é€‰æ‹©tb_empè¡¨ä¸­çš„æ‰€æœ‰å­—æ®µï¼Œå¹¶ä¸”æ˜¾å¼åˆ—å‡ºå®ƒä»¬ select tb_emp.id, tb_emp.username, tb_emp.password, tb_emp.name, tb_emp.gender, tb_emp.image, tb_emp.job, tb_emp.entrydate, tb_emp.create_time, tb_emp.update_time from tb_emp; -- é€‰æ‹©tb_empè¡¨ä¸­çš„æ‰€æœ‰å­—æ®µï¼ˆä¸ç›´è§‚ï¼Œæ€§èƒ½è¾ƒä½ï¼‰ select * from tb_emp; -- é€‰æ‹©tb_empè¡¨ä¸­çš„nameå’Œentrydateå­—æ®µï¼Œå¹¶å°†å®ƒä»¬é‡å‘½åä¸ºâ€œå§“åâ€å’Œâ€œå…¥èŒæ—¥æœŸâ€ select name as å§“å, entrydate as å…¥èŒæ—¥æœŸ from tb_emp; -- é€‰æ‹©tb_empè¡¨ä¸­çš„nameå’Œentrydateå­—æ®µï¼Œå¹¶å°†å®ƒä»¬é‡å‘½åä¸ºâ€œå§“ åâ€å’Œâ€œå…¥èŒæ—¥æœŸâ€ select name \u0026#39;å§“ å\u0026#39;, entrydate å…¥èŒæ—¥æœŸ from tb_emp; -- é€‰æ‹©tb_empè¡¨ä¸­ä¸åŒçš„jobå­—æ®µå€¼ select distinct job from tb_emp; -- ä»tb_empè¡¨ä¸­é€‰æ‹©nameä¸ºâ€œæ¨é€â€çš„è®°å½• select * from tb_emp where name = \u0026#39;æ¨é€\u0026#39;; -- ä»tb_empè¡¨ä¸­é€‰æ‹©idå°äºç­‰äº5çš„è®°å½• select * from tb_emp where id \u0026lt;= 5; -- ä»tb_empè¡¨ä¸­é€‰æ‹©jobå­—æ®µä¸ºnullçš„è®°å½• select * from tb_emp where job is null; -- ä»tb_empè¡¨ä¸­é€‰æ‹©jobå­—æ®µä¸ä¸ºnullçš„è®°å½• select * from tb_emp where job is not null; -- ä»tb_empè¡¨ä¸­é€‰æ‹©passwordå­—æ®µä¸ç­‰äºâ€œ123456â€çš„è®°å½• select * from tb_emp where password != \u0026#39;123456\u0026#39;; -- ä»tb_empè¡¨ä¸­é€‰æ‹©passwordå­—æ®µä¸ç­‰äºâ€œ123456â€çš„è®°å½•ï¼ˆå¦ä¸€ç§å†™æ³•ï¼‰ select * from tb_emp where password \u0026lt;\u0026gt; \u0026#39;123456\u0026#39;; -- ä»tb_empè¡¨ä¸­é€‰æ‹©entrydateåœ¨2000-01-01åˆ°2010-01-01ä¹‹é—´çš„è®°å½• select * from tb_emp where entrydate \u0026gt;= \u0026#39;2000-01-01\u0026#39; and entrydate \u0026lt;= \u0026#39;2010-01-01\u0026#39;; -- ä»tb_empè¡¨ä¸­é€‰æ‹©entrydateåœ¨2000-01-01åˆ°2010-01-01ä¹‹é—´çš„è®°å½•ï¼ˆä½¿ç”¨betweenï¼‰ select * from tb_emp where entrydate between \u0026#39;2000-01-01\u0026#39; and \u0026#39;2010-01-01\u0026#39;; -- é‡å¤çš„è¯­å¥ï¼Œé€‰æ‹©entrydateåœ¨2000-01-01åˆ°2010-01-01ä¹‹é—´çš„è®°å½•ï¼ˆä½¿ç”¨betweenï¼‰ select * from tb_emp where entrydate between \u0026#39;2000-01-01\u0026#39; and \u0026#39;2010-01-01\u0026#39;; -- é‡å¤çš„è¯­å¥ï¼Œé€‰æ‹©entrydateåœ¨2000-01-01åˆ°2010-01-01ä¹‹é—´çš„è®°å½• select * from tb_emp where entrydate \u0026gt;= \u0026#39;2000-01-01\u0026#39; and entrydate \u0026lt;= \u0026#39;2010-01-01\u0026#39;; -- ä»tb_empè¡¨ä¸­é€‰æ‹©entrydateåœ¨2000-01-01åˆ°2010-01-01ä¹‹é—´ï¼Œä¸”genderä¸º2çš„è®°å½• select * from tb_emp where entrydate \u0026gt;= \u0026#39;2000-01-01\u0026#39; and entrydate \u0026lt;= \u0026#39;2010-01-01\u0026#39; and gender = 2; -- ä»tb_empè¡¨ä¸­é€‰æ‹©jobä¸º2ã€3æˆ–4çš„è®°å½• select * from tb_emp where job = 2 or job = 3 or job = 4; -- ä»tb_empè¡¨ä¸­é€‰æ‹©jobåœ¨2, 3, 4ä¸­çš„è®°å½•ï¼ˆä½¿ç”¨inï¼‰ select * from tb_emp where job in (2, 3, 4); -- ä½¿ç”¨é€šé…ç¬¦_è¡¨ç¤ºå•ä¸ªå­—ç¬¦ï¼Œé€‰æ‹©nameå­—æ®µé•¿åº¦ä¸º2çš„è®°å½• select * from tb_emp where name like \u0026#39;__\u0026#39;; -- ä½¿ç”¨é€šé…ç¬¦_è¡¨ç¤ºå•ä¸ªå­—ç¬¦ï¼Œé€‰æ‹©nameå­—æ®µé•¿åº¦ä¸º3çš„è®°å½• select * from tb_emp where name like \u0026#39;___\u0026#39;; -- ä½¿ç”¨é€šé…ç¬¦%è¡¨ç¤ºä»»æ„ä¸ªå­—ç¬¦ï¼Œé€‰æ‹©nameä»¥â€œå¼ â€å¼€å¤´çš„è®°å½• select * from tb_emp where name like \u0026#39;å¼ %\u0026#39;; -- è®¡æ•°idå­—æ®µçš„éç©ºå€¼ select count(id) from tb_emp; -- è®¡æ•°è¡¨ä¸­çš„è®°å½•æ•°ï¼Œå¸¸é‡\u0026#39;A\u0026#39;å¯¹è®¡æ•°æ²¡æœ‰å½±å“ select count(\u0026#39;A\u0026#39;) from tb_emp; -- æ¨èçš„è®¡æ•°è¡¨ä¸­è®°å½•æ•°çš„å†™æ³• select count(*) from tb_emp; -- é€‰æ‹©tb_empè¡¨ä¸­entrydateçš„æœ€å°å€¼ select min(entrydate) from tb_emp; -- é€‰æ‹©tb_empè¡¨ä¸­entry -- é€‰æ‹©tb_empè¡¨ä¸­entrydateçš„æœ€å¤§å€¼ select max(entrydate) from tb_emp; -- è®¡ç®—tb_empè¡¨ä¸­idå­—æ®µçš„å¹³å‡å€¼ select avg(id) from tb_emp; -- è®¡ç®—tb_empè¡¨ä¸­idå­—æ®µçš„æ€»å’Œ select sum(id) from tb_emp; -- æŒ‰genderå­—æ®µåˆ†ç»„ï¼Œå¹¶è®¡æ•°æ¯ä¸ªæ€§åˆ«çš„è®°å½•æ•° select gender, count(*) from tb_emp group by gender; -- æŒ‰jobå­—æ®µåˆ†ç»„ï¼Œå¹¶é€‰æ‹©entrydateå°äºç­‰äº2015-01-01çš„è®°å½• -- åªåŒ…æ‹¬è®°å½•æ•°å¤§äºç­‰äº2çš„ç»„ select job, count(*) from tb_emp where entrydate \u0026lt;= \u0026#39;2015-01-01\u0026#39; group by job having count(*) \u0026gt;= 2; -- ä»tb_empè¡¨ä¸­é€‰æ‹©æ‰€æœ‰å­—æ®µï¼Œå¹¶æŒ‰entrydateå­—æ®µå‡åºæ’åº select * from tb_emp order by entrydate; -- ä»tb_empè¡¨ä¸­é€‰æ‹©æ‰€æœ‰å­—æ®µï¼Œå¹¶æŒ‰entrydateå­—æ®µé™åºæ’åº select * from tb_emp order by entrydate DESC; -- ä»tb_empè¡¨ä¸­é€‰æ‹©æ‰€æœ‰å­—æ®µï¼Œå…ˆæŒ‰entrydateå­—æ®µå‡åºæ’åºï¼Œ -- å¯¹äºç›¸åŒentrydateçš„è®°å½•ï¼Œå†æŒ‰update_timeå­—æ®µé™åºæ’åº select * from tb_emp order by entrydate, update_time DESC; -- ä»tb_empè¡¨ä¸­é€‰æ‹©æ‰€æœ‰å­—æ®µï¼Œåˆ†é¡µæ˜¾ç¤º -- ç¬¬äºŒé¡µçš„è®°å½•ï¼Œæ¯é¡µæ˜¾ç¤º5æ¡è®°å½• -- èµ·å§‹ç´¢å¼•ä¸º5ï¼Œå³ä»ç¬¬6æ¡è®°å½•å¼€å§‹ï¼ˆç´¢å¼•ä»0å¼€å§‹ï¼‰ select * from tb_emp limit 5, 5; -- ä»tb_empè¡¨ä¸­é€‰æ‹©æ‰€æœ‰å­—æ®µï¼Œåˆ†é¡µæ˜¾ç¤º -- ç¬¬ä¸‰é¡µçš„è®°å½•ï¼Œæ¯é¡µæ˜¾ç¤º5æ¡è®°å½• -- èµ·å§‹ç´¢å¼•ä¸º10ï¼Œå³ä»ç¬¬11æ¡è®°å½•å¼€å§‹ï¼ˆç´¢å¼•ä»0å¼€å§‹ï¼‰ select * from tb_emp limit 10, 5; é¢è¯•é¢˜ DQL-åˆ†ç»„æŸ¥è¯¢ï¼Œ whereä¸havingåŒºåˆ«\næ‰§è¡Œæ—¶æœºä¸åŒï¼šwhereæ˜¯åˆ†ç»„ä¹‹å‰è¿›è¡Œè¿‡æ»¤ï¼Œä¸æ»¡è¶³whereæ¡ä»¶ï¼Œä¸å‚ä¸åˆ†ç»„ï¼Œè€Œhavingæ˜¯åˆ†ç»„ä¹‹åå¯¹ç»“æœè¿›è¡Œè¿‡æ»¤ åˆ¤æ–­æ¡ä»¶ä¸åŒï¼šwhereä¸èƒ½å¯¹èšåˆå‡½æ•°è¿›è¡Œåˆ¤æ–­ï¼Œè€Œhavingå¯ä»¥ æ³¨æ„äº‹é¡¹ï¼š\nåˆ†ç»„ä¹‹åï¼ŒæŸ¥è¯¢çš„å­—æ®µä¸€èˆ¬ä¸ºèšåˆå‡½æ•°å’Œåˆ†ç»„å­—æ®µï¼ŒæŸ¥è¯¢å…¶ä»–å­—æ®µæ²¡æœ‰æ„ä¹‰ æ‰§è¡Œé¡ºåºï¼š where \u0026gt; èšåˆå‡½æ•° \u0026gt; having æ¡ˆä¾‹ -- ä»tb_empè¡¨ä¸­é€‰æ‹©æŒ‡å®šå­—æ®µï¼Œæ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š -- nameåŒ…å«â€œå¼ â€ï¼Œgenderä¸º1ï¼Œentrydateåœ¨2000-01-01åˆ°2015-12-31ä¹‹é—´ -- ç»“æœæŒ‰update_timeé™åºæ’åºï¼Œå¹¶åˆ†é¡µæ˜¾ç¤º -- æ˜¾ç¤ºç¬¬2é¡µçš„è®°å½•ï¼Œæ¯é¡µ10æ¡è®°å½•ï¼Œå³ä»ç¬¬11æ¡åˆ°ç¬¬20æ¡è®°å½• select tb_emp.id, tb_emp.username, tb_emp.password, tb_emp.name, tb_emp.gender, tb_emp.image, tb_emp.job, tb_emp.entrydate, tb_emp.create_time, tb_emp.update_time from tb_emp where name like \u0026#39;%å¼ %\u0026#39; and gender = 1 and entrydate between \u0026#39;2000-01-01\u0026#39; and \u0026#39;2015-12-31\u0026#39; order by update_time DESC limit 10, 10; -- ä½¿ç”¨IFå‡½æ•°ï¼Œæ ¹æ®genderå­—æ®µçš„å€¼åˆ¤æ–­æ€§åˆ«ï¼Œå¹¶è®¡æ•°æ¯ä¸ªæ€§åˆ«çš„è®°å½•æ•° -- ä½¿ç”¨IFå‡½æ•°ï¼šå¦‚æœgenderä¸º1ï¼Œåˆ™æ˜¾ç¤ºâ€œç”·æ€§å‘˜å·¥â€ï¼›å¦åˆ™æ˜¾ç¤ºâ€œå¥³æ€§å‘˜å·¥â€ select if(gender = 1, \u0026#39;ç”·æ€§å‘˜å·¥\u0026#39;, \u0026#39;å¥³æ€§å‘˜å·¥\u0026#39;) æ€§åˆ«, count(*) äººæ•° from tb_emp group by gender; -- ä½¿ç”¨CASEè¯­å¥ï¼Œæ ¹æ®jobå­—æ®µçš„å€¼ç¡®å®šèŒä½åç§°ï¼Œå¹¶è®¡æ•°æ¯ä¸ªèŒä½çš„è®°å½•æ•° -- ä½¿ç”¨CASEè¯­å¥ï¼šå½“jobä¸º1æ—¶ï¼Œæ˜¾ç¤ºâ€œç­ä¸»ä»»â€ï¼›å½“jobä¸º2æ—¶ï¼Œæ˜¾ç¤ºâ€œè®²å¸ˆâ€ï¼› -- å½“jobä¸º3æ—¶ï¼Œæ˜¾ç¤ºâ€œå­¦å·¥ä¸»ç®¡â€ï¼›å½“jobä¸º4æ—¶ï¼Œæ˜¾ç¤ºâ€œæ•™ç ”ä¸»ç®¡â€ï¼›å¦åˆ™æ˜¾ç¤ºâ€œæœªåˆ†é…èŒä½â€ select (case job when 1 then \u0026#39;ç­ä¸»ä»»\u0026#39; when 2 then \u0026#39;è®²å¸ˆ\u0026#39; when 3 then \u0026#39;å­¦å·¥ä¸»ç®¡\u0026#39; when 4 then \u0026#39;æ•™ç ”ä¸»ç®¡\u0026#39; else \u0026#39;æœªåˆ†é…èŒä½\u0026#39; end) èŒä½, count(*) äººæ•° from tb_emp group by job; å¤šè¡¨è®¾è®¡ é¡¹ç›®å¼€å‘ä¸­ï¼Œåœ¨è¿›è¡Œæ•°æ®è¡¨ç»“æ„è®¾è®¡æ—¶ï¼Œä¼šæ ¹æ®ä¸šåŠ¡éœ€æ±‚åŠä¸šåŠ¡æ¨¡å—ä¹‹é—´çš„å…³ç³»ï¼Œåˆ†æå¹¶è®¾è®¡è¡¨ç»“æ„ï¼Œç”±äºä¸šåŠ¡ä¹‹é—´ç›¸äº’å…³è”ï¼Œæ‰€ä»¥å„ä¸ªè¡¨ç»“æ„ä¹‹é—´ä¹Ÿå­˜åœ¨ç€å„ç§è”ç³»\nä¸€å¯¹å¤š(å¤šå¯¹ä¸€) å¤šå¯¹å¤š ä¸€å¯¹ä¸€ ä¸€å¯¹å¤š éƒ¨é—¨å’Œå‘˜å·¥ ç‰©ç†å¤–é”®\næ¦‚å¿µï¼šä½¿ç”¨foreign keyå®šä¹‰å¤–é”®å…³è”å¦å¤–ä¸€å¼ è¡¨ã€‚ ç¼ºç‚¹ï¼š å½±å“å¢ï¼Œåˆ ï¼Œæ”¹çš„æ•ˆç‡ï¼ˆéœ€è¦æ£€æŸ¥å¤–é”®å…³ç³»ï¼‰ ä»…ç”¨äºå•èŠ‚ç‚¹æ•°æ®åº“ï¼Œä¸é€‚ç”¨ä¸åˆ†å¸ƒå¼ï¼Œé›†ç¾¤åœºæ™¯ å®¹æ˜“å¼•å‘æ•°æ®åº“çš„æ­»é”é—®é¢˜ï¼Œæ¶ˆè€—æ€§èƒ½ alter table tb_emp add constraint tb_emp___fk_dept_id foreign key (dept_id) references tb_dept (id); é€»è¾‘å¤–é”®\næ¦‚å¿µï¼šåœ¨ä¸šåŠ¡é€»è¾‘ä¸­ï¼Œè§£å†³å¤–é”®å…³è” é€šè¿‡é€»è¾‘å¤–é”®ï¼Œå°±å¯ä»¥å¾ˆæ–¹ä¾¿çš„è§£å†³ä¸Šè¿°é—®é¢˜ ä¸€å¯¹ä¸€ æ¡ˆä¾‹ï¼šç”¨æˆ·ä¸èº«ä»½è¯ä¿¡æ¯çš„å…³ç³»\nå…³ç³»ï¼šä¸€å¯¹ä¸€å…³ç³»ï¼Œå¤šç”¨äºå•è¡¨æ‹†åˆ†ï¼Œå°†ä¸€å¼ è¡¨çš„åŸºç¡€å­—æ®µæ”¾åœ¨ä¸€å¼ è¡¨ä¸­ï¼Œå…¶ä»–å­—æ®µæ”¾åœ¨å¦ä¸€å¼ è¡¨ä¸­ï¼Œä»¥æå‡æ“ä½œæ•ˆç‡\nå®ç°ï¼šåœ¨ä»»æ„ä¸€æ–¹åŠ å…¥å¤–é”®ï¼Œå…³è”å¦å¤–ä¸€æ–¹ï¼Œå¹¶ä¸”è®¾ç½®å¤–é”®ä¸ºå”¯ä¸€çš„ï¼ˆUNIQUEï¼‰\n-- åˆ›å»ºç”¨æˆ·ä¿¡æ¯è¡¨ tb_user create table tb_user ( id int unsigned primary key auto_increment comment \u0026#39;ID\u0026#39;, -- è‡ªå¢ä¸»é”®ID name varchar(10) not null comment \u0026#39;å§“å\u0026#39;, -- ç”¨æˆ·å§“å gender tinyint unsigned not null comment \u0026#39;æ€§åˆ«, 1 ç”· 2 å¥³\u0026#39;, -- æ€§åˆ«ï¼Œ1è¡¨ç¤ºç”·ï¼Œ2è¡¨ç¤ºå¥³ phone char(11) comment \u0026#39;æ‰‹æœºå·\u0026#39;, -- æ‰‹æœºå· degree varchar(10) comment \u0026#39;å­¦å†\u0026#39; -- å­¦å† ) comment \u0026#39;ç”¨æˆ·ä¿¡æ¯è¡¨\u0026#39;; -- è¡¨æ³¨é‡Š -- æ’å…¥ç”¨æˆ·ä¿¡æ¯è¡¨ tb_user çš„æ•°æ® insert into tb_user values (1, \u0026#39;ç™½çœ‰é¹°ç‹\u0026#39;, 1, \u0026#39;18812340001\u0026#39;, \u0026#39;åˆä¸­\u0026#39;), (2, \u0026#39;é’ç¿¼è ç‹\u0026#39;, 1, \u0026#39;18812340002\u0026#39;, \u0026#39;å¤§ä¸“\u0026#39;), (3, \u0026#39;é‡‘æ¯›ç‹®ç‹\u0026#39;, 1, \u0026#39;18812340003\u0026#39;, \u0026#39;åˆä¸­\u0026#39;), (4, \u0026#39;ç´«è¡«é¾™ç‹\u0026#39;, 2, \u0026#39;18812340004\u0026#39;, \u0026#39;ç¡•å£«\u0026#39;); -- åˆ›å»ºç”¨æˆ·è¯¦ç»†ä¿¡æ¯è¡¨ tb_user_card create table tb_user_card ( id int unsigned primary key auto_increment comment \u0026#39;ID\u0026#39;, -- è‡ªå¢ä¸»é”®ID nationality varchar(10) not null comment \u0026#39;æ°‘æ—\u0026#39;, -- æ°‘æ— birthday date not null comment \u0026#39;ç”Ÿæ—¥\u0026#39;, -- ç”Ÿæ—¥ idcard char(18) not null comment \u0026#39;èº«ä»½è¯å·\u0026#39;, -- èº«ä»½è¯å· issued varchar(20) not null comment \u0026#39;ç­¾å‘æœºå…³\u0026#39;, -- ç­¾å‘æœºå…³ expire_begin date not null comment \u0026#39;æœ‰æ•ˆæœŸé™-å¼€å§‹\u0026#39;, -- æœ‰æ•ˆæœŸé™å¼€å§‹æ—¥æœŸ expire_end date comment \u0026#39;æœ‰æ•ˆæœŸé™-ç»“æŸ\u0026#39;, -- æœ‰æ•ˆæœŸé™ç»“æŸæ—¥æœŸ user_id int unsigned not null unique comment \u0026#39;ç”¨æˆ·ID\u0026#39;, -- ç”¨æˆ·IDï¼Œå”¯ä¸€ä¸”éç©º constraint fk_user_id foreign key (user_id) references tb_user (id) -- å¤–é”®çº¦æŸï¼Œå¼•ç”¨ tb_user è¡¨çš„ id å­—æ®µ ) comment \u0026#39;ç”¨æˆ·ä¿¡æ¯è¡¨\u0026#39;; -- è¡¨æ³¨é‡Š -- æ’å…¥ç”¨æˆ·è¯¦ç»†ä¿¡æ¯è¡¨ tb_user_card çš„æ•°æ® insert into tb_user_card values (1, \u0026#39;æ±‰\u0026#39;, \u0026#39;1960-11-06\u0026#39;, \u0026#39;100000100000100001\u0026#39;, \u0026#39;æœé˜³åŒºå…¬å®‰å±€\u0026#39;, \u0026#39;2000-06-10\u0026#39;, null, 1), (2, \u0026#39;æ±‰\u0026#39;, \u0026#39;1971-11-06\u0026#39;, \u0026#39;100000100000100002\u0026#39;, \u0026#39;é™å®‰åŒºå…¬å®‰å±€\u0026#39;, \u0026#39;2005-06-10\u0026#39;, \u0026#39;2025-06-10\u0026#39;, 2), (3, \u0026#39;æ±‰\u0026#39;, \u0026#39;1963-11-06\u0026#39;, \u0026#39;100000100000100003\u0026#39;, \u0026#39;æ˜Œå¹³åŒºå…¬å®‰å±€\u0026#39;, \u0026#39;2006-06-10\u0026#39;, null, 3), (4, \u0026#39;å›\u0026#39;, \u0026#39;1980-11-06\u0026#39;, \u0026#39;100000100000100004\u0026#39;, \u0026#39;æµ·æ·€åŒºå…¬å®‰å±€\u0026#39;, \u0026#39;2008-06-10\u0026#39;, \u0026#39;2028-06-10\u0026#39;, 4); å¤šå¯¹å¤š æ¡ˆä¾‹ï¼šå­¦ç”Ÿä¸è¯¾ç¨‹çš„å…³ç³»\nå…³ç³»ï¼šä¸€ä¸ªå­¦ç”Ÿå¯ä»¥é€‰ä¿®å¤šé—¨è¯¾ç¨‹ï¼Œä¸€é—¨è¯¾ç¨‹ä¹Ÿå¯ä»¥ä¾›å¤šä¸ªå­¦ç”Ÿé€‰æ‹©\nä½¿ç”¨ä¸­é—´è¡¨æ¥å¯¹åº”å¤šå¯¹å¤šçš„å…³ç³»\n-- åˆ›å»ºå­¦ç”Ÿè¡¨ tb_student create table tb_student ( id int auto_increment primary key comment \u0026#39;ä¸»é”®ID\u0026#39;, -- è‡ªå¢ä¸»é”®ID name varchar(10) comment \u0026#39;å§“å\u0026#39;, -- å­¦ç”Ÿå§“å no varchar(10) comment \u0026#39;å­¦å·\u0026#39; -- å­¦ç”Ÿå­¦å· ) comment \u0026#39;å­¦ç”Ÿè¡¨\u0026#39;; -- è¡¨æ³¨é‡Š -- æ’å…¥å­¦ç”Ÿè¡¨ tb_student çš„æ•°æ® insert into tb_student (name, no) values (\u0026#39;é»›ç»®ä¸\u0026#39;, \u0026#39;2000100101\u0026#39;), (\u0026#39;è°¢é€Š\u0026#39;, \u0026#39;2000100102\u0026#39;), (\u0026#39;æ®·å¤©æ­£\u0026#39;, \u0026#39;2000100103\u0026#39;), (\u0026#39;éŸ¦ä¸€ç¬‘\u0026#39;, \u0026#39;2000100104\u0026#39;); -- åˆ›å»ºè¯¾ç¨‹è¡¨ tb_course create table tb_course ( id int auto_increment primary key comment \u0026#39;ä¸»é”®ID\u0026#39;, -- è‡ªå¢ä¸»é”®ID name varchar(10) comment \u0026#39;è¯¾ç¨‹åç§°\u0026#39; -- è¯¾ç¨‹åç§° ) comment \u0026#39;è¯¾ç¨‹è¡¨\u0026#39;; -- è¡¨æ³¨é‡Š -- æ’å…¥è¯¾ç¨‹è¡¨ tb_course çš„æ•°æ® insert into tb_course (name) values (\u0026#39;Java\u0026#39;), (\u0026#39;PHP\u0026#39;), (\u0026#39;MySQL\u0026#39;), (\u0026#39;Hadoop\u0026#39;); -- åˆ›å»ºå­¦ç”Ÿè¯¾ç¨‹ä¸­é—´è¡¨ tb_student_courseï¼Œç”¨äºè¡¨ç¤ºå­¦ç”Ÿå’Œè¯¾ç¨‹çš„å¤šå¯¹å¤šå…³ç³» create table tb_student_course ( id int auto_increment comment \u0026#39;ä¸»é”®\u0026#39; primary key, -- è‡ªå¢ä¸»é”®ID student_id int not null comment \u0026#39;å­¦ç”ŸID\u0026#39;, -- å­¦ç”ŸIDï¼Œéç©º course_id int not null comment \u0026#39;è¯¾ç¨‹ID\u0026#39;, -- è¯¾ç¨‹IDï¼Œéç©º constraint fk_courseid foreign key (course_id) references tb_course (id), -- å¤–é”®çº¦æŸï¼Œå¼•ç”¨ tb_course è¡¨çš„ id å­—æ®µ constraint fk_studentid foreign key (student_id) references tb_student (id) -- å¤–é”®çº¦æŸï¼Œå¼•ç”¨ tb_student è¡¨çš„ id å­—æ®µ ) comment \u0026#39;å­¦ç”Ÿè¯¾ç¨‹ä¸­é—´è¡¨\u0026#39;; -- è¡¨æ³¨é‡Š -- æ’å…¥å­¦ç”Ÿè¯¾ç¨‹ä¸­é—´è¡¨ tb_student_course çš„æ•°æ®ï¼Œè¡¨ç¤ºå­¦ç”Ÿé€‰æ‹©çš„è¯¾ç¨‹ insert into tb_student_course (student_id, course_id) values (1, 1), -- å­¦ç”Ÿ ID 1 é€‰æ‹©äº†è¯¾ç¨‹ ID 1 (Java) (1, 2), -- å­¦ç”Ÿ ID 1 é€‰æ‹©äº†è¯¾ç¨‹ ID 2 (PHP) (1, 3), -- å­¦ç”Ÿ ID 1 é€‰æ‹©äº†è¯¾ç¨‹ ID 3 (MySQL) (2, 2), -- å­¦ç”Ÿ ID 2 é€‰æ‹©äº†è¯¾ç¨‹ ID 2 (PHP) (2, 3), -- å­¦ç”Ÿ ID 2 é€‰æ‹©äº†è¯¾ç¨‹ ID 3 (MySQL) (3, 4); -- å­¦ç”Ÿ ID 3 é€‰æ‹©äº†è¯¾ç¨‹ ID 4 (Hadoop) æ¡ˆä¾‹ å‚è€ƒé¡µé¢åŸå‹åŠéœ€æ±‚ï¼Œè®¾è®¡åˆç†çš„è¡¨ç»“æ„\né˜…è¯»é¡µé¢åŸå‹åŠéœ€æ±‚æ–‡æ¡£ï¼Œåˆ†æå„ä¸ªæ¨¡å—æ¶‰åŠåˆ°çš„è¡¨ç»“æ„ï¼ŒåŠè¡¨ç»“æ„ä¹‹é—´çš„å…³ç³» æ ¹æ®é¡µé¢åŸå‹åŠéœ€æ±‚æ–‡æ¡£ï¼Œåˆ†æå„ä¸ªè¡¨ç»“æ„ä¸­å…·ä½“çš„å­—æ®µåŠçº¦æŸ æ€»ç»“ ä¸€å¯¹å¤š\nåœ¨å¤šçš„ä¸€æ–¹æ·»åŠ å¤–é”®ï¼Œå…³è”å¦å¤–ä¸€æ–¹çš„ä¸»é”®\nä¸€å¯¹ä¸€\nä»»æ„ä¸€æ–¹ï¼Œæ·»åŠ å¤–é”®ï¼Œå…³è”å¦å¤–ä¸€æ–¹çš„ä¸»é”®\nå¤šå¯¹å¤š\né€šè¿‡ä¸­é—´è¡¨æ¥ç»´æŠ¤ï¼Œä¸­é—´è¡¨çš„ä¸¤ä¸ªå¤–é”®ï¼Œåˆ†åˆ«å…³è”å¦å¤–ä¸¤ä¸ªè¡¨çš„ä¸»é”®\nå¤šè¡¨æŸ¥è¯¢ ä»å¤šå¼ è¡¨ä¸­æŸ¥è¯¢æ•°æ®\nåˆ†ç±»\nè¿æ¥æŸ¥è¯¢ å†…è¿æ¥ï¼šç›¸å½“äºæŸ¥è¯¢Aï¼Œ Bäº¤é›†éƒ¨åˆ†æ•°æ® -- è¿™æ˜¯ä¸€ä¸ªç¬›å¡å°”ç§¯æŸ¥è¯¢ï¼Œè¿”å›tb_empå’Œtb_deptè¡¨çš„æ‰€æœ‰ç»„åˆã€‚ select * from tb_emp, -- tb_emp è¡¨ï¼ˆå‘˜å·¥è¡¨ï¼‰ tb_dept; -- tb_dept è¡¨ï¼ˆéƒ¨é—¨è¡¨ï¼‰ -- è¿™æ˜¯ä¸€ä¸ªå†…è¿æ¥æŸ¥è¯¢ï¼Œè¿”å›tb_empå’Œtb_deptè¡¨ä¸­æ»¡è¶³è¿æ¥æ¡ä»¶çš„æ‰€æœ‰è®°å½•ã€‚ select * from tb_emp, -- tb_emp è¡¨ï¼ˆå‘˜å·¥è¡¨ï¼‰ tb_dept -- tb_dept è¡¨ï¼ˆéƒ¨é—¨è¡¨ï¼‰ where tb_emp.dept_id = tb_dept.id; -- è¿æ¥æ¡ä»¶ï¼štb_empè¡¨ä¸­çš„dept_idç­‰äºtb_deptè¡¨ä¸­çš„id -- è¿™æ˜¯ä¸€ä¸ªå†…è¿æ¥æŸ¥è¯¢ï¼Œåªè¿”å›å‘˜å·¥çš„å§“åå’Œæ‰€å±éƒ¨é—¨çš„åç§°ã€‚ select tb_emp.name, -- tb_emp è¡¨ä¸­çš„ name åˆ—ï¼ˆå‘˜å·¥å§“åï¼‰ tb_dept.name -- tb_dept è¡¨ä¸­çš„ name åˆ—ï¼ˆéƒ¨é—¨åç§°ï¼‰ from tb_emp, -- tb_emp è¡¨ï¼ˆå‘˜å·¥è¡¨ï¼‰ tb_dept -- tb_dept è¡¨ï¼ˆéƒ¨é—¨è¡¨ï¼‰ where tb_emp.dept_id = tb_dept.id; -- è¿æ¥æ¡ä»¶ï¼štb_empè¡¨ä¸­çš„dept_idç­‰äºtb_deptè¡¨ä¸­çš„id -- è¿™æ˜¯ä¸€ä¸ªä½¿ç”¨INNER JOINå…³é”®å­—çš„å†…è¿æ¥æŸ¥è¯¢ï¼Œè¿”å›å‘˜å·¥çš„å§“åå’Œæ‰€å±éƒ¨é—¨çš„åç§°ã€‚ select tb_emp.name, -- tb_emp è¡¨ä¸­çš„ name åˆ—ï¼ˆå‘˜å·¥å§“åï¼‰ tb_dept.name -- tb_dept è¡¨ä¸­çš„ name åˆ—ï¼ˆéƒ¨é—¨åç§°ï¼‰ from tb_emp -- tb_emp è¡¨ï¼ˆå‘˜å·¥è¡¨ï¼‰ inner join tb_dept -- tb_dept è¡¨ï¼ˆéƒ¨é—¨è¡¨ï¼‰ï¼Œä½¿ç”¨INNER JOINå…³é”®å­—è¿›è¡Œè¿æ¥ on tb_emp.dept_id = tb_dept.id; -- è¿æ¥æ¡ä»¶ï¼štb_empè¡¨ä¸­çš„dept_idç­‰äºtb_deptè¡¨ä¸­çš„id -- è¿™æ˜¯ä¸€ä¸ªä½¿ç”¨JOINå…³é”®å­—çš„å†…è¿æ¥æŸ¥è¯¢ï¼Œè¿”å›å‘˜å·¥çš„å§“åå’Œæ‰€å±éƒ¨é—¨çš„åç§°ã€‚ select tb_emp.name, -- tb_emp è¡¨ä¸­çš„ name åˆ—ï¼ˆå‘˜å·¥å§“åï¼‰ tb_dept.name -- tb_dept è¡¨ä¸­çš„ name åˆ—ï¼ˆéƒ¨é—¨åç§°ï¼‰ from tb_emp -- tb_emp è¡¨ï¼ˆå‘˜å·¥è¡¨ï¼‰ join tb_dept -- tb_dept è¡¨ï¼ˆéƒ¨é—¨è¡¨ï¼‰ï¼Œä½¿ç”¨JOINå…³é”®å­—è¿›è¡Œè¿æ¥ on tb_emp.dept_id = tb_dept.id; -- è¿æ¥æ¡ä»¶ï¼štb_empè¡¨ä¸­çš„dept_idç­‰äºtb_deptè¡¨ä¸­çš„id -- è¿™æ˜¯ä¸€ä¸ªä½¿ç”¨è¡¨åˆ«åçš„å†…è¿æ¥æŸ¥è¯¢ï¼Œè¿”å›å‘˜å·¥çš„å§“åå’Œæ‰€å±éƒ¨é—¨çš„åç§°ã€‚ select e.name, -- e è¡¨ï¼ˆtb_emp è¡¨çš„åˆ«åï¼‰ä¸­çš„ name åˆ—ï¼ˆå‘˜å·¥å§“åï¼‰ p.name -- p è¡¨ï¼ˆtb_dept è¡¨çš„åˆ«åï¼‰ä¸­çš„ name åˆ—ï¼ˆéƒ¨é—¨åç§°ï¼‰ from tb_emp e, -- tb_emp è¡¨ï¼ˆå‘˜å·¥è¡¨ï¼‰ï¼Œèµ·åˆ«åä¸º e tb_dept p -- tb_dept è¡¨ï¼ˆéƒ¨é—¨è¡¨ï¼‰ï¼Œèµ·åˆ«åä¸º p where e.dept_id = p.id; -- è¿æ¥æ¡ä»¶ï¼še è¡¨ï¼ˆtb_emp è¡¨ï¼‰çš„ dept_id ç­‰äº p è¡¨ï¼ˆtb_dept è¡¨ï¼‰çš„ id å¤–è¿æ¥ï¼š å·¦å¤–è¿æ¥ï¼šæŸ¥è¯¢å·¦è¡¨æ‰€æœ‰æ•°æ®ï¼ˆåŒ…æ‹¬ä¸¤å¼ è¡¨äº¤é›†éƒ¨åˆ†æ•°æ® å³å¤–è¿æ¥ï¼šæŸ¥è¯¢å³è¡¨æ‰€æœ‰æ•°æ®ï¼ˆåŒ…æ‹¬ä¸¤å¼ è¡¨äº¤é›†éƒ¨åˆ†æ•°æ®ï¼‰ -- å·¦è¿æ¥ï¼šæŸ¥è¯¢æ‰€æœ‰å‘˜å·¥åŠå…¶æ‰€å±éƒ¨é—¨çš„åç§°ï¼ŒåŒ…å«æ²¡æœ‰éƒ¨é—¨çš„å‘˜å·¥ select e.name, -- e è¡¨ï¼ˆtb_emp è¡¨çš„åˆ«åï¼‰ä¸­çš„ name åˆ—ï¼ˆå‘˜å·¥å§“åï¼‰ p.name -- p è¡¨ï¼ˆtb_dept è¡¨çš„åˆ«åï¼‰ä¸­çš„ name åˆ—ï¼ˆéƒ¨é—¨åç§°ï¼‰ from tb_emp e -- tb_emp è¡¨ï¼ˆå‘˜å·¥è¡¨ï¼‰ï¼Œèµ·åˆ«åä¸º e left join tb_dept p on e.dept_id = p.id; -- å·¦è¿æ¥ï¼štb_empè¡¨ä¸­çš„dept_idç­‰äºtb_deptè¡¨ä¸­çš„id -- å³è¿æ¥ï¼šæŸ¥è¯¢æ‰€æœ‰éƒ¨é—¨åŠå…¶å‘˜å·¥çš„å§“åï¼ŒåŒ…å«æ²¡æœ‰å‘˜å·¥çš„éƒ¨é—¨ select e.name, -- e è¡¨ï¼ˆtb_emp è¡¨çš„åˆ«åï¼‰ä¸­çš„ name åˆ—ï¼ˆå‘˜å·¥å§“åï¼‰ p.name -- p è¡¨ï¼ˆtb_dept è¡¨çš„åˆ«åï¼‰ä¸­çš„ name åˆ—ï¼ˆéƒ¨é—¨åç§°ï¼‰ from tb_emp e -- tb_emp è¡¨ï¼ˆå‘˜å·¥è¡¨ï¼‰ï¼Œèµ·åˆ«åä¸º e right join tb_dept p on e.dept_id = p.id; -- å³è¿æ¥ï¼štb_empè¡¨ä¸­çš„dept_idç­‰äºtb_deptè¡¨ä¸­çš„id -- å·¦è¿æ¥ï¼šæŸ¥è¯¢æ‰€æœ‰éƒ¨é—¨åŠå…¶å‘˜å·¥çš„å§“åï¼ŒåŒ…å«æ²¡æœ‰å‘˜å·¥çš„éƒ¨é—¨ï¼ˆå’Œä¸Šé¢çš„å³è¿æ¥æŸ¥è¯¢ç»“æœç›¸åŒï¼‰ select e.name, -- e è¡¨ï¼ˆtb_emp è¡¨çš„åˆ«åï¼‰ä¸­çš„ name åˆ—ï¼ˆå‘˜å·¥å§“åï¼‰ p.name -- p è¡¨ï¼ˆtb_dept è¡¨çš„åˆ«åï¼‰ä¸­çš„ name åˆ—ï¼ˆéƒ¨é—¨åç§°ï¼‰ from tb_dept p -- tb_dept è¡¨ï¼ˆéƒ¨é—¨è¡¨ï¼‰ï¼Œèµ·åˆ«åä¸º p left join tb_emp e on p.id = e.dept_id; -- å·¦è¿æ¥ï¼štb_deptè¡¨ä¸­çš„idç­‰äºtb_empè¡¨ä¸­çš„dept_id å­æŸ¥è¯¢ -- å­æŸ¥è¯¢ï¼šæŸ¥è¯¢idç­‰äºæ•™ç ”éƒ¨çš„éƒ¨é—¨idçš„å‘˜å·¥ä¿¡æ¯ select * from tb_emp -- tb_emp è¡¨ï¼ˆå‘˜å·¥è¡¨ï¼‰ where id = (select id from tb_dept where tb_dept.name = \u0026#39;æ•™ç ”éƒ¨\u0026#39;); -- å­æŸ¥è¯¢ï¼šä»tb_deptè¡¨ä¸­é€‰æ‹©åç§°ä¸º\u0026#39;æ•™ç ”éƒ¨\u0026#39;çš„éƒ¨é—¨id -- æ ‡é‡å­æŸ¥è¯¢ï¼šæŸ¥è¯¢å…¥èŒæ—¥æœŸæ™šäºæ–¹ä¸œç™½çš„å‘˜å·¥ä¿¡æ¯ select * from tb_emp -- tb_emp è¡¨ï¼ˆå‘˜å·¥è¡¨ï¼‰ where entrydate \u0026gt; (select tb_emp.entrydate from tb_emp where name = \u0026#39;æ–¹ä¸œç™½\u0026#39;); -- å­æŸ¥è¯¢ï¼šä»tb_empè¡¨ä¸­é€‰æ‹©åç§°ä¸º\u0026#39;æ–¹ä¸œç™½\u0026#39;çš„å‘˜å·¥å…¥èŒæ—¥æœŸ -- åˆ—å­æŸ¥è¯¢ï¼šæŸ¥è¯¢éƒ¨é—¨ä¸ºæ•™ç ”éƒ¨æˆ–å’¨è¯¢éƒ¨çš„å‘˜å·¥ä¿¡æ¯ select * from tb_emp -- tb_emp è¡¨ï¼ˆå‘˜å·¥è¡¨ï¼‰ where dept_id in (select id from tb_dept where name in (\u0026#39;æ•™ç ”éƒ¨\u0026#39;, \u0026#39;å’¨è¯¢éƒ¨\u0026#39;)); -- å­æŸ¥è¯¢ï¼šä»tb_deptè¡¨ä¸­é€‰æ‹©åç§°ä¸º\u0026#39;æ•™ç ”éƒ¨\u0026#39;æˆ–\u0026#39;å’¨è¯¢éƒ¨\u0026#39;çš„éƒ¨é—¨id -- è¡Œå­æŸ¥è¯¢ï¼šæŸ¥è¯¢å…¥èŒæ—¥æœŸå’ŒèŒä½å‡ä¸éŸ¦ä¸€ç¬‘ç›¸åŒçš„å‘˜å·¥ä¿¡æ¯ select * from tb_emp -- tb_emp è¡¨ï¼ˆå‘˜å·¥è¡¨ï¼‰ where entrydate = (select entrydate from tb_emp where name = \u0026#39;éŸ¦ä¸€ç¬‘\u0026#39;) -- å­æŸ¥è¯¢ï¼šä»tb_empè¡¨ä¸­é€‰æ‹©åç§°ä¸º\u0026#39;éŸ¦ä¸€ç¬‘\u0026#39;çš„å‘˜å·¥å…¥èŒæ—¥æœŸ and job = (select job from tb_emp where name = \u0026#39;éŸ¦ä¸€ç¬‘\u0026#39;); -- å­æŸ¥è¯¢ï¼šä»tb_empè¡¨ä¸­é€‰æ‹©åç§°ä¸º\u0026#39;éŸ¦ä¸€ç¬‘\u0026#39;çš„å‘˜å·¥èŒä½ -- è¡Œå­æŸ¥è¯¢çš„å¦ä¸€ç§å†™æ³•ï¼šæŸ¥è¯¢å…¥èŒæ—¥æœŸå’ŒèŒä½å‡ä¸éŸ¦ä¸€ç¬‘ç›¸åŒçš„å‘˜å·¥ä¿¡æ¯ select * from tb_emp -- tb_emp è¡¨ï¼ˆå‘˜å·¥è¡¨ï¼‰ where (entrydate, job) = (select entrydate, job from tb_emp where name = \u0026#39;éŸ¦ä¸€ç¬‘\u0026#39;); -- å­æŸ¥è¯¢ï¼šä»tb_empè¡¨ä¸­é€‰æ‹©åç§°ä¸º\u0026#39;éŸ¦ä¸€ç¬‘\u0026#39;çš„å‘˜å·¥å…¥èŒæ—¥æœŸå’ŒèŒä½ -- è¡¨å­æŸ¥è¯¢ï¼šæŸ¥è¯¢å…¥èŒæ—¥æœŸåœ¨2006-01-01ä¹‹åçš„å‘˜å·¥ä¿¡æ¯ select * from tb_emp -- tb_emp è¡¨ï¼ˆå‘˜å·¥è¡¨ï¼‰ where entrydate \u0026gt; \u0026#39;2006-01-01\u0026#39;; -- æ¡ä»¶ï¼šå…¥èŒæ—¥æœŸåœ¨2006-01-01ä¹‹å -- è¡¨å­æŸ¥è¯¢çš„å¦ä¸€ç§å†™æ³•ï¼šæŸ¥è¯¢å…¥èŒæ—¥æœŸåœ¨2006-01-01ä¹‹åçš„å‘˜å·¥åŠå…¶æ‰€å±éƒ¨é—¨ä¿¡æ¯ select * from (select * from tb_emp where entrydate \u0026gt; \u0026#39;2006-01-01\u0026#39;) e, -- å­æŸ¥è¯¢ï¼šä»tb_empè¡¨ä¸­é€‰æ‹©å…¥èŒæ—¥æœŸåœ¨2006-01-01ä¹‹åçš„å‘˜å·¥ï¼Œå¹¶èµ·åˆ«åä¸º e tb_dept p -- tb_dept è¡¨ï¼ˆéƒ¨é—¨è¡¨ï¼‰ï¼Œèµ·åˆ«åä¸º p where e.dept_id = p.id; -- è¿æ¥æ¡ä»¶ï¼šå­æŸ¥è¯¢ç»“æœçš„dept_idç­‰äºtb_deptè¡¨ä¸­çš„id æ¡ˆä¾‹ å¯¹èœå“(dish)ï¼Œ å¥—é¤(setmeal)ï¼Œç±»åˆ«(category)ï¼Œèœå“å’Œå¥—é¤(setmeal_dish)å¯¹åº”å…³ç³»è¡¨è¿›è¡Œå¤šè¡¨æŸ¥è¯¢\n-- æŸ¥è¯¢ä»·æ ¼ä½äº10å…ƒçš„èœå“çš„åç§°å’Œä»·æ ¼ SELECT d.name, d.price FROM dish d WHERE d.price \u0026lt; 10; -- æŸ¥è¯¢ä»·æ ¼ä½äº10å…ƒçš„èœå“çš„åç§°ã€ä»·æ ¼ä»¥åŠæ‰€å±åˆ†ç±»çš„åç§° SELECT d.name, d.price, c.name FROM dish d, category c WHERE d.category_id = c.id -- ä½¿ç”¨category_idè¿æ¥èœå“å’Œåˆ†ç±» AND d.price \u0026lt; 10; -- è¿‡æ»¤ä»·æ ¼ä½äº10å…ƒçš„èœå“ -- æŸ¥è¯¢ä»·æ ¼åœ¨10åˆ°50å…ƒä¹‹é—´ä¸”çŠ¶æ€ä¸º1çš„èœå“çš„åç§°ã€ä»·æ ¼ä»¥åŠæ‰€å±åˆ†ç±»çš„åç§° SELECT d.name, d.price, c.name FROM dish d LEFT JOIN category c ON d.category_id = c.id -- å·¦è¿æ¥ï¼ŒåŒ…å«æ‰€æœ‰èœå“ï¼Œå³ä½¿å®ƒä»¬æ²¡æœ‰åˆ†ç±» WHERE d.price BETWEEN 10 AND 50 -- è¿‡æ»¤ä»·æ ¼åœ¨10åˆ°50å…ƒä¹‹é—´çš„èœå“ AND d.status = 1; -- è¿‡æ»¤çŠ¶æ€ä¸º1çš„èœå“ -- æŸ¥è¯¢æ‰€æœ‰æœ‰èœå“çš„åˆ†ç±»çš„åç§°ï¼ŒæŒ‰åˆ†ç±»åç§°åˆ†ç»„ SELECT c.name FROM dish d, category c WHERE d.category_id = c.id -- ä½¿ç”¨category_idè¿æ¥èœå“å’Œåˆ†ç±» GROUP BY c.name; -- æŒ‰åˆ†ç±»åç§°åˆ†ç»„ï¼Œè·å–å”¯ä¸€çš„åˆ†ç±»åç§° -- æŸ¥è¯¢æœ‰3ä¸ªæˆ–æ›´å¤šèœå“çš„åˆ†ç±»çš„åç§°åŠå…¶èœå“æ•°é‡ SELECT c.name, COUNT(*) FROM dish d, category c WHERE d.category_id = c.id -- ä½¿ç”¨category_idè¿æ¥èœå“å’Œåˆ†ç±» GROUP BY c.name -- æŒ‰åˆ†ç±»åç§°åˆ†ç»„ï¼Œè®¡ç®—æ¯ä¸ªåˆ†ç±»çš„èœå“æ•°é‡ HAVING COUNT(*) \u0026gt;= 3; -- ä»…åŒ…å«èœå“æ•°é‡å¤§äºæˆ–ç­‰äº3çš„åˆ†ç±» -- æŸ¥è¯¢æ¯ä¸ªåˆ†ç±»çš„åç§°åŠå…¶èœå“çš„æœ€é«˜ä»·æ ¼ SELECT c.name, MAX(d.price) FROM dish d, category c WHERE d.category_id = c.id -- ä½¿ç”¨category_idè¿æ¥èœå“å’Œåˆ†ç±» GROUP BY c.name; -- æŒ‰åˆ†ç±»åç§°åˆ†ç»„ï¼Œè·å–æ¯ä¸ªåˆ†ç±»çš„æœ€é«˜ä»·æ ¼ -- æŸ¥è¯¢åä¸º\u0026#39;å•†åŠ¡å¥—é¤A\u0026#39;çš„å¥—é¤åŠå…¶èœå“çš„åç§°ã€ä»·æ ¼å’Œä»½æ•° SELECT s.name, s.price, d.name, d.price, sd.copies FROM setmeal s, setmeal_dish sd, dish d WHERE s.id = sd.setmeal_id -- ä½¿ç”¨setmeal_idè¿æ¥å¥—é¤å’Œå¥—é¤èœå“ AND sd.dish_id = d.id -- ä½¿ç”¨dish_idè¿æ¥å¥—é¤èœå“å’Œèœå“ AND s.name = \u0026#39;å•†åŠ¡å¥—é¤A\u0026#39;; -- è¿‡æ»¤å‡ºåç§°ä¸º\u0026#39;å•†åŠ¡å¥—é¤A\u0026#39;çš„å¥—é¤ -- æŸ¥è¯¢ä»·æ ¼ä½äºæ‰€æœ‰èœå“å¹³å‡ä»·æ ¼çš„èœå“çš„æ‰€æœ‰åˆ— SELECT * FROM dish WHERE price \u0026lt; (SELECT AVG(d.price) FROM dish d); -- å­æŸ¥è¯¢è·å–æ‰€æœ‰èœå“çš„å¹³å‡ä»·æ ¼ äº‹ç‰© äº‹ç‰©æ˜¯ä¸€ç»„æ“ä½œçš„é›†åˆï¼Œå®ƒæ˜¯ä¸€ä¸ªä¸å¯åˆ†å‰²çš„å·¥ä½œå•ä½ï¼Œ äº‹ç‰©ä¼šæŠŠæ‰€æœ‰çš„æ“ä½œä½œä¸ºä¸€ä¸ªæ•´ä½“ä¸€èµ·å‘ç³»ç»Ÿæäº¤æˆ–æ’¤é”€æ“ä½œè¯·æ±‚ï¼Œå³è¿™äº›æ“ä½œè¦ä¹ˆåŒæ—¶æˆåŠŸï¼Œ è¦ä¹ˆåŒæ—¶å¤±è´¥ã€‚\nstart transaction; delete from tb_dept where id = 2; delete from tb_emp where dept_id = 2; commit; -- å¦‚æœåœ¨äº‹åŠ¡ä¸­çš„è¯­å¥å‡ºç°äº†é—®é¢˜ï¼Œ åˆ™ä¸èƒ½ç›´æ¥æäº¤ï¼Œéœ€è¦å›æ»šä¿è¯æ‰€æœ‰è¯­å¥éƒ½æ²¡æœ‰é—®é¢˜ rollback; å››å¤§ç‰¹æ€§ ACID\nåŸå­æ€§ï¼ˆAtomicityï¼‰ï¼šäº‹åŠ¡æ˜¯ä¸å¯åˆ†å‰²çš„æœ€å°å•å…ƒï¼Œè¦ä¹ˆå…¨éƒ¨æˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨å¤±è´¥ ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰ï¼šäº‹ç‰©å®Œæˆåï¼Œ å¿…é¡»ä½¿æ‰€æœ‰çš„æ•°æ®éƒ½ä¿æŒä¸€è‡´çŠ¶æ€ éš”ç¦»æ€§ï¼ˆIsolationï¼‰ï¼šæ•°æ®åº“ç³»ç»Ÿæä¾›çš„éš”ç¦»æœºåˆ¶ï¼Œä¿è¯äº‹ç‰©åœ¨ä¸å—å¤–éƒ¨å¹¶å‘æ“ä½œå½±å“çš„ç‹¬ç«‹ç¯å¢ƒä¸‹è¿è¡Œ æŒä¹…æ€§ï¼ˆDurabilityï¼‰ï¼šäº‹ç‰©ä¸€æ—¦æäº¤æˆ–å›æ»šï¼Œå®ƒå¯¹æ•°æ®åº“ä¸­çš„æ•°æ®çš„æ”¹å˜å°±æ˜¯æ°¸ä¹…çš„ æ•°æ®åº“ä¼˜åŒ– ç´¢å¼•ï¼ˆindexï¼‰ï¼šæ˜¯å¸®åŠ©æ•°æ®åº“é«˜æ•ˆè·å–æ•°æ®çš„æ•°æ®ç»“æ„\nç´¢å¼•ä¼˜ç¼ºç‚¹ï¼š ä¼˜ç‚¹ï¼š\næé«˜æ•°æ®æŸ¥è¯¢çš„æ•ˆç‡ï¼Œé™ä½æ•°æ®åº“çš„IOæˆæœ¬ é€šè¿‡ç´¢å¼•åˆ—å¯¹æ•°æ®è¿›è¡Œæ’åºï¼Œé™ä½æ•°æ®æ’åºçš„æˆæœ¬ï¼Œé™ä½CPUæ¶ˆè€— ç¼ºç‚¹ï¼š\nç´¢å¼•ä¼šå ç”¨å­˜å‚¨ç©ºé—´ ç´¢å¼•å¤§å¤§æé«˜äº†æŸ¥è¯¢æ•ˆç‡ï¼ŒåŒæ—¶ä¹Ÿé™ä½äº†insert, update, deleteçš„æ•ˆç‡ ç´¢å¼•çš„æ•°æ®ç»“æ„ MySQLæ•°æ®åº“æ”¯æŒçš„ç´¢å¼•ç»“æ„æœ‰å¾ˆå¤šï¼Œ å¦‚ï¼šHashç´¢å¼•ï¼Œ B+Treeç´¢å¼•ï¼Œ Full-Testç´¢å¼•ç­‰ã€‚å¦‚æœæ²¡æœ‰ç‰¹åˆ«æŒ‡æ˜ï¼Œéƒ½æ˜¯æŒ‡é»˜è®¤çš„B+Treeç»“æ„ç»„ç»‡çš„ç´¢å¼•ã€‚\né¡µæ˜¯æ•°æ®åº“å­˜å‚¨çš„æœ€å°å•ä½ï¼Œä¸€ä¸ªé¡µä¸º16KB\nB+Tree(å¤šè·¯å¹³è¡¡æœç´¢æ ‘) æ¯ä¸ªèŠ‚ç‚¹å¯ä»¥å­˜å‚¨å¤šä¸ªKeyï¼Œ æ‰€æœ‰çš„Keyéƒ½ä¼šåœ¨å¶å­èŠ‚ç‚¹ä¸­å‡ºç°\næ¯ä¸ªèŠ‚ç‚¹ï¼Œå¯ä»¥å­˜å‚¨å¤šä¸ªkeyï¼ˆæœ‰nä¸ªkeyï¼Œ å°±æœ‰nä¸ªæŒ‡é’ˆï¼‰ã€‚ æ‰€æœ‰çš„æ•°æ®éƒ½å­˜å‚¨åœ¨å¶å­èŠ‚ç‚¹å†…ï¼Œéå¶å­èŠ‚ç‚¹ä»…ç”¨äºç´¢å¼•æ•°æ®ã€‚ å¶å­èŠ‚ç‚¹å½¢æˆäº†ä¸€é¢—åŒå‘é“¾è¡¨ï¼Œä¾¿äºæ•°æ®çš„æ’åºåŠåŒºé—´èŒƒå›´æŸ¥è¯¢ã€‚ ç´¢å¼•åˆ›å»ºçš„SQL -- åœ¨tb_empè¡¨çš„nameåˆ—ä¸Šåˆ›å»ºç´¢å¼•idx_tb_emp_name CREATE INDEX idx_tb_emp_name ON tb_emp(name); -- æ˜¾ç¤ºtb_empè¡¨ä¸­çš„æ‰€æœ‰ç´¢å¼• SHOW INDEX FROM tb_emp; -- åˆ é™¤tb_empè¡¨ä¸Šçš„ç´¢å¼•idx_tb_emp_name DROP INDEX idx_tb_emp_name ON tb_emp; ","permalink":"https://kennems.github.io/posts/tech/java-web%E5%BC%80%E5%8F%914/","summary":"Java Webå¼€å‘(4) æ•°æ®åº“ æ•°æ®åº“ï¼šDataBase(DB) ï¼Œ æ˜¯å­˜å‚¨å’Œç®¡ç†æ•°æ®çš„ä»“åº“ DBMSï¼Œ SQL MySqlç™»å½•ï¼Œé¦–å…ˆåœ¨æœåŠ¡ä¸­å¯åŠ¨mysql mysql -uroot -p\u0026#34;password\u0026#34;","title":"Java Webå¼€å‘(4)"},{"content":"Java Webå¼€å‘(1) ä»€ä¹ˆæ˜¯Webï¼Ÿ Webï¼šå…¨çƒå¹¿åŸŸç½‘ï¼Œä¹Ÿæˆä¸ºä¸‡ç»´ç½‘ï¼ˆWorld Wide Web)ï¼Œèƒ½å¤Ÿé€šè¿‡æµè§ˆå™¨è®¿é—®çš„ç½‘ç«™ CRM OA ERP\nä¸è°‹å…¨å±€è€…ä¸è¶³ä»¥è°‹ä¸€åŸŸ\nå‰åç«¯åˆ†ç¦»å¼€å‘\næ··åˆå¼€å‘\nWebæ ‡å‡†ä¹Ÿæˆä¸ºç½‘é¡µæ ‡å‡†ï¼Œæœ‰ä¸€ç³»åˆ—çš„æ ‡å‡†ç»„æˆï¼Œå¤§éƒ¨åˆ†ç”±W3Cï¼ˆä¸‡ç»´ç½‘è”ç›Ÿï¼‰è´Ÿè´£åˆ¶å®š\nä¸‰ä¸ªéƒ¨åˆ† HTMLï¼šè´Ÿè´£ç½‘é¡µçš„ç»“æœï¼ˆé¡µé¢å…ƒç´ å’Œå†…å®¹ï¼‰ CSSï¼šè´Ÿè´£ç½‘é¡µçš„è¡¨ç°ï¼ˆé¡µé¢å…ƒç´ çš„å¤–è§‚ï¼Œä½ç½®ç­‰é¡µé¢æ ·å¼ï¼Œå¦‚ï¼šé¢œè‰²ï¼Œå¤§å°ç­‰ï¼‰ JavaScriptï¼šè´Ÿè´£ç½‘é¡µçš„è¡Œä¸ºï¼ˆäº¤äº’æ•ˆæœï¼‰ ä»€ä¹ˆæ˜¯HTMLï¼ŒCSSï¼Ÿ HTMLï¼ˆHyperTextMarkupLanguage):è¶…æ–‡æœ¬æ ‡è®°è¯­è¨€ã€‚ è¶…æ–‡æœ¬ï¼šè¶…è¶Šäº†æ–‡æœ¬çš„é™åˆ¶ï¼Œæ¯”æ™®é€šæ–‡æœ¬æ›´å¼ºå¤§ã€‚ æ ‡è®°è¯­è¨€ï¼šç”±æ ‡ç­¾æ„æˆçš„è¯­è¨€ HTMLæ ‡ç­¾éƒ½æ˜¯é¢„å®šä¹‰å·çš„ã€‚ä¾‹å¦‚ï¼šä½¿ç”¨\u0026lt;a\u0026gt;å±•ç¤ºè¶…é“¾æ¥ï¼Œä½¿ç”¨\u0026lt;img\u0026gt;å±•ç¤ºå›¾ç‰‡ï¼Œ\u0026lt;video\u0026gt;å±•ç¤ºè§†é¢‘ã€‚ HTMLä»£ç ç›´æ¥åœ¨æµè§ˆå™¨ä¸­å…è®¸ï¼ŒHTMLæ ‡ç­¾ç”±æµè§ˆå™¨è§£æã€‚ æ ‡ç­¾ä¸åŒºåˆ†å¤§å°ï¼Œå•åŒå¼•å·éƒ½å¯ä»¥ï¼Œè¯­æ³•ç»“æ„æ¯”è¾ƒæ¾æ•£\nCSS CSSï¼ˆCascading Style Sheetï¼‰ï¼šå±‚å æ ·å¼è¡¨ï¼Œç”¨äºæ§åˆ¶é¡µé¢çš„æ ·å¼ï¼ˆè¡¨ç°ï¼‰ CSSå¼•å…¥æ–¹å¼ï¼š è¡Œå†…æ ·å¼ï¼šå†™åœ¨æ ‡ç­¾çš„styleå±æ€§ä¸­ï¼ˆä¸æ¨èï¼‰ å†…åµŒæ ·å¼ï¼šå†™åœ¨styleæ ‡ç­¾ä¸­ï¼ˆå¯ä»¥å†™åœ¨é¡µé¢ä»»ä½•ä½ç½®ï¼Œä½†é€šå¸¸çº¦å®šå†™åœ¨headæ ‡ç­¾ä¸­ï¼‰ å¤–è”æ ·å¼ï¼Œå†™åœ¨ä¸€ä¸ªå•ç‹¬çš„.cssæ–‡ä»¶ä¸­ï¼ˆéœ€è¦é€šè¿‡linkæ ‡ç­¾åœ¨ç½‘é¡µä¸­å¼•å…¥ï¼‰ é¢œè‰²æ ‡è¯†æ³•ï¼š å…³é”®å­—ï¼šé¢„å®šä¹‰çš„é¢œè‰²åï¼ˆred, green, blue) rgbè¡¨ç¤ºæ³•ï¼šçº¢ç»¿è“ä¸‰åŸè‰²ï¼Œæ¯é¡¹å–å€¼èŒƒå›´ï¼š0~255 åå…­è¿›åˆ¶è¡¨ç¤ºæ³•ï¼š#å¼€å¤´ï¼Œå°†æ•°å­—è½¬æ¢æˆåå…­è¿›åˆ¶è¡¨ç¤ºï¼Œ#000000ï¼Œ #ff0000, #ccccccï¼Œ ç®€å†™ä¸º#000ï¼Œ #ccc \u0026lt;span\u0026gt;æ ‡ç­¾\nå¤§é‡ä½¿ç”¨æ²¡æœ‰è¯­ä¹‰çš„å¸ƒå±€æ ‡ç­¾ ç‰¹ç‚¹ï¼šä¸€è¡Œå¯ä»¥æ˜¾ç¤ºå¤šä¸ªï¼ˆç»„åˆè¡Œå†…å…ƒç´ ï¼‰ï¼Œå®½åº¦å’Œé«˜åº¦é»˜è®¤ç”±å†…å®¹æ’‘å¼€ CSSé€‰æ‹©å™¨ å…ƒç´ é€‰æ‹©å™¨ï¼šæ ‡ç­¾å{\u0026hellip;} idé€‰æ‹©å™¨ï¼š#idå±æ€§å€¼{\u0026hellip;} ç±»é€‰æ‹©å™¨ï¼š.classå±æ€§å€¼{\u0026hellip;} ä¼˜å…ˆçº§ï¼šidé€‰æ‹©å™¨ \u0026gt; ç±»é€‰æ‹©å™¨ \u0026gt; å…ƒç´ é€‰æ‹©å™¨ CSSå±æ€§ colorï¼Œ font-size(å•ä½px) è¶…é“¾æ¥\næ ‡ç­¾ï¼š\u0026lt;a\u0026gt; å±æ€§ï¼šhrefï¼šåˆ¶å®šèµ„æºè®¿é—®url target:æŒ‡å®šåœ¨ä½•å¤„æ‰“å¼€èµ„æºé“¾æ¥ _selfï¼šé»˜è®¤å€¼ï¼Œåœ¨å½“å‰é¡µé¢æ‰“å¼€ _blankï¼šåœ¨ç©ºç™½é¡µé¢æ‰“å¼€ CSSå±æ€§\ntext-decoration:è§„å®šæ·»åŠ åˆ°æ–‡æœ¬çš„ä¿®é¥°ï¼Œnoneè¡¨ç¤ºå®šä¹‰æ ‡å‡†çš„æ–‡æœ¬ colorï¼šå®šä¹‰æ–‡æœ¬çš„é¢œè‰² éŸ³é¢‘ï¼Œè§†é¢‘æ ‡ç­¾\n\u0026lt;audio\u0026gt; \u0026lt;video\u0026gt; æ¢è¡Œï¼Œæ®µè½æ ‡ç­¾\n\u0026lt;br\u0026gt;, \u0026lt;p\u0026gt; æ–‡æœ¬åŠ ç²—æ ‡ç­¾\n\u0026lt;b\u0026gt;, \u0026lt;strong\u0026gt; CSSæ ·å¼ line-height: è®¾ç½®è¡Œé«˜\ntext-indent: å®šä¹‰ç¬¬ä¸€ä¸ªè¡Œå†…å®¹çš„ç¼©è¿›\ntext-align:è§„å®šå…ƒç´ ä¸­çš„æ–‡æœ¬çš„æ°´å¹³å¯¹é½æ–¹å¼\nhtmlä¸­çš„ç©ºæ ¼å ä½ç¬¦ \u0026amp;nbsp;\né¡µé¢å¸ƒå±€ ç›’å­ï¼šé¡µé¢ä¸­çš„æ‰€æœ‰å…ƒç´ ï¼ˆæ ‡ç­¾ï¼‰ï¼Œéƒ½å¯ä»¥çœ‹æˆä¸€ä¸ªç›’å­ï¼Œ ç”±ç›’å­å°†é¡µé¢ä¸­çš„å…ƒç´ åŒ…å«åœ¨ä¸€ä¸ªçŸ©å½¢åŒºåŸŸå†…ï¼Œé€šè¿‡ç›’å­çš„è§†è§’æ›´æ–¹ä¾¿çš„è¿›è¡Œé¡µé¢å¸ƒå±€\nç›’å­æ¨¡å‹ç»„æˆï¼šå†…å®¹åŒºåŸŸï¼ˆcontentï¼‰ï¼Œ å†…è¾¹è·åŒºåŸŸï¼ˆpaddingï¼‰ï¼Œè¾¹æ¡†åŒºåŸŸï¼ˆborderï¼‰ï¼Œå¤–è¾¹è·åŒºåŸŸ(margin)\nå¸ƒå±€æ ‡ç­¾ï¼šå®é™…å¼€å‘ç½‘é¡µä¸­ï¼Œä¼šå¤§é‡é¢‘ç¹çš„ä½¿ç”¨divå’Œspanè¿™ä¸¤ä¸ªæ²¡æœ‰è¯­ä¹‰çš„å¸ƒå±€æ ‡ç­¾\næ ‡ç­¾ï¼š\u0026lt;div\u0026gt;``\u0026lt;span\u0026gt;\nç‰¹ç‚¹ï¼š\ndivæ ‡ç­¾ï¼š ä¸€è¡Œåªæ˜¾ç¤ºä¸€ä¸ªï¼ˆç‹¬å ä¸€è¡Œï¼‰ å®½åº¦é»˜è®¤æ˜¯çˆ¶å…ƒç´ çš„å®½åº¦ï¼Œé«˜åº¦é»˜è®¤ç”±å†…å®¹æ’‘å¼€ å¯ä»¥è®¾ç½®å®½é«˜ï¼ˆwidth, height) spanæ ‡ç­¾ ä¸€è¡Œå¯ä»¥æ˜¾ç¤ºå¤šä¸ª å®½åº¦å’Œé«˜åº¦é»˜è®¤ç”±å†…å®¹æ’‘å¼€ ä¸å¯è®¾ç½®å®½é«˜ï¼ˆwidth, height) æ³¨æ„ï¼šå¦‚æœåªéœ€è¦è®¾ç½®æŸä¸€ä¸ªæ–¹ä½çš„è¾¹æ¡†ï¼Œå†…è¾¹è·ï¼Œå¤–è¾¹è·ï¼Œå¯ä»¥åœ¨å±æ€§åç±³å¨œåŠ ä¸Š-ä½ç½®ï¼Œ ä¾‹å¦‚ï¼špadding-top, padding-left, padding-rightã€‚\nè¡¨æ ¼æ ‡ç­¾ åœºæ™¯ï¼šåœ¨ç½‘é¡µä¸­ä»¥è¡¨æ ¼ï¼ˆè¡Œã€åˆ—ï¼‰å½¢å¼æ•´é½å±•ç¤ºæ•°æ® æ ‡ç­¾ \u0026lt;table\u0026gt; å®šä¹‰è¡¨æ ¼æ•´ä½“ï¼Œå¯ä»¥åŒ…è£¹å¤šä¸ª\u0026lt;tr\u0026gt; border:è§„å®šè¡¨æ ¼è¾¹æ¡†çš„å®½åº¦ widthï¼šè§„å®šè¡¨æ ¼çš„å®½åº¦ cellspacingï¼šè§„å®šå•å…ƒä¹‹é—´çš„ç©ºé—´ \u0026lt;tr\u0026gt;è¡¨æ ¼çš„è¡Œï¼Œå¯ä»¥åŒ…è£¹å¤šä¸ª\u0026lt;td\u0026gt; \u0026lt;td\u0026gt;è¡¨æ ¼å•å…ƒæ ¼ï¼ˆæ™®é€šï¼‰ï¼Œ å¯ä»¥åŒ…è£¹å†…å®¹ \u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;UTF-8\u0026#34;\u0026gt; \u0026lt;meta http-equiv=\u0026#34;X-UA-Compatible\u0026#34; content=\u0026#34;IE=edge\u0026#34;\u0026gt; \u0026lt;meta name=\u0026#34;viewport\u0026#34; content=\u0026#34;width=device-width, initial-scale=1.0\u0026#34;\u0026gt; \u0026lt;title\u0026gt;HTML-è¡¨æ ¼\u0026lt;/title\u0026gt; \u0026lt;style\u0026gt; /* æ ·å¼ç¾åŒ– */ td { text-align: center; /* è®©å•å…ƒæ ¼å†…å®¹å±…ä¸­å±•ç¤º */ } \u0026lt;/style\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;table border=\u0026#34;1px\u0026#34; cellspacing=\u0026#34;0\u0026#34; width=\u0026#34;600px\u0026#34;\u0026gt; \u0026lt;tr\u0026gt; \u0026lt;!-- è¡¨å¤´ --\u0026gt; \u0026lt;th\u0026gt;åºå·\u0026lt;/th\u0026gt; \u0026lt;th\u0026gt;å“ç‰ŒLogo\u0026lt;/th\u0026gt; \u0026lt;th\u0026gt;å“ç‰Œåç§°\u0026lt;/th\u0026gt; \u0026lt;th\u0026gt;ä¼ä¸šåç§°\u0026lt;/th\u0026gt; \u0026lt;/tr\u0026gt; \u0026lt;tr\u0026gt; \u0026lt;!-- ç¬¬ä¸€è¡Œæ•°æ® --\u0026gt; \u0026lt;td\u0026gt;1\u0026lt;/td\u0026gt; \u0026lt;td\u0026gt; \u0026lt;img src=\u0026#34;img/huawei.jpg\u0026#34; width=\u0026#34;100px\u0026#34;\u0026gt; \u0026lt;/td\u0026gt; \u0026lt;!-- æ’å…¥å›¾ç‰‡ --\u0026gt; \u0026lt;td\u0026gt;åä¸º\u0026lt;/td\u0026gt; \u0026lt;td\u0026gt;åä¸ºæŠ€æœ¯æœ‰é™å…¬å¸\u0026lt;/td\u0026gt; \u0026lt;/tr\u0026gt; \u0026lt;tr\u0026gt; \u0026lt;!-- ç¬¬äºŒè¡Œæ•°æ® --\u0026gt; \u0026lt;td\u0026gt;2\u0026lt;/td\u0026gt; \u0026lt;td\u0026gt; \u0026lt;img src=\u0026#34;img/alibaba.jpg\u0026#34; width=\u0026#34;100px\u0026#34;\u0026gt; \u0026lt;/td\u0026gt; \u0026lt;!-- æ’å…¥å›¾ç‰‡ --\u0026gt; \u0026lt;td\u0026gt;é˜¿é‡Œ\u0026lt;/td\u0026gt; \u0026lt;td\u0026gt;é˜¿é‡Œå·´å·´é›†å›¢æ§è‚¡æœ‰é™å…¬å¸\u0026lt;/td\u0026gt; \u0026lt;/tr\u0026gt; \u0026lt;/table\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; è¡¨å•æ ‡ç­¾ åœºæ™¯ï¼šåœ¨ç½‘é¡µä¸­ä¸»è¦è´Ÿè´£æ•°æ®é‡‡é›†åŠŸèƒ½ï¼Œå¦‚ æ³¨å†Œï¼Œç™»å½•ç­‰æ•°æ®é‡‡é›†ã€‚\næ ‡ç­¾ï¼š\u0026lt;form\u0026gt;\nè¡¨å•é¡¹ï¼šä¸åŒç±»å‹çš„inputå…ƒç´ ï¼Œä¸‹ä¿©åˆ—è¡¨ï¼Œæ–‡æœ¬åŸŸç­‰\n\u0026lt;input\u0026gt;: å®šä¹‰è¡¨å•é¡¹ï¼Œé€šè¿‡typeå±æ€§æ§åˆ¶è¾“å…¥å½¢å¼\n\u0026lt;select\u0026gt;ï¼šå®šä¹‰ä¸‹æ‹‰åˆ—è¡¨\n\u0026lt;textarea\u0026gt;ï¼šå®šä¹‰æ–‡æœ¬åŸŸ\nå±æ€§ï¼š\nactionï¼šè§„å®šå½“æäº¤è¡¨å•æ—¶å‘ä½•å¤„å‘é€è¡¨å•æ•°æ®ï¼ŒURL\nmethodï¼šè§„å®šç”¨äºå‘é€è¡¨å•æ•°æ®çš„æ–¹å¼ã€‚\nGETè¡¨å•æ•°æ®æ‹¼æ¥åœ¨urlåé¢ï¼Œ å¤§å°æœ‰é™åˆ¶ POSTè¡¨å•æ•°æ®åœ¨è¯·æ±‚ä½“ä¸­æºå¸¦ï¼Œå¤§å°æ²¡æœ‰é™åˆ¶ è¡¨å•å¿…é¡»ç”±nameå±æ€§\n\u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;UTF-8\u0026#34;\u0026gt; \u0026lt;meta http-equiv=\u0026#34;X-UA-Compatible\u0026#34; content=\u0026#34;IE=edge\u0026#34;\u0026gt; \u0026lt;meta name=\u0026#34;viewport\u0026#34; content=\u0026#34;width=device-width, initial-scale=1.0\u0026#34;\u0026gt; \u0026lt;title\u0026gt;HTML-è¡¨å•\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;!-- formè¡¨å•å±æ€§: action: è¡¨å•æäº¤çš„URLï¼Œæ•°æ®å°†ä¼šè¢«æäº¤åˆ°æŒ‡å®šçš„URLåœ°å€ã€‚å¦‚æœæœªæŒ‡å®šï¼Œå°†é»˜è®¤æäº¤åˆ°å½“å‰é¡µé¢ã€‚ method: è¡¨å•çš„æäº¤æ–¹å¼ã€‚ get: å°†è¡¨å•æ•°æ®é™„åŠ åœ¨URLåé¢ï¼Œä¾‹å¦‚ï¼š?username=Tom\u0026amp;age=12ã€‚ç”±äºURLé•¿åº¦æœ‰é™åˆ¶ï¼Œé€‚åˆä¼ é€’å°‘é‡æ•°æ®ã€‚é»˜è®¤å€¼ã€‚ post: å°†è¡¨å•æ•°æ®åŒ…å«åœ¨æ¶ˆæ¯ä½“ï¼ˆè¯·æ±‚ä½“ï¼‰ä¸­ä¼ é€’ï¼Œæ²¡æœ‰å‚æ•°å¤§å°é™åˆ¶ï¼Œé€‚åˆä¼ é€’å¤§é‡æ•°æ®ã€‚ --\u0026gt; \u0026lt;form action=\u0026#34;\u0026#34; method=\u0026#34;post\u0026#34;\u0026gt; \u0026lt;!-- è¾“å…¥æ¡† --\u0026gt; ç”¨æˆ·å: \u0026lt;input type=\u0026#34;text\u0026#34; name=\u0026#34;username\u0026#34;\u0026gt; å¹´é¾„: \u0026lt;input type=\u0026#34;text\u0026#34; name=\u0026#34;age\u0026#34;\u0026gt; æ€§åˆ«: \u0026lt;input type=\u0026#34;text\u0026#34; name=\u0026#34;sex\u0026#34;\u0026gt; \u0026lt;!-- æäº¤æŒ‰é’® --\u0026gt; \u0026lt;input type=\u0026#34;submit\u0026#34; value=\u0026#34;æäº¤\u0026#34;\u0026gt; \u0026lt;/form\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; è¡¨å•é¡¹ \u0026lt;input\u0026gt; ï¼šè¡¨å•é¡¹ï¼šé€šè¿‡typeå±æ€§æ§åˆ¶è¾“å…¥å½¢å¼ã€‚ \u0026lt;select\u0026gt;ï¼šå®šä¹‰ä¸‹æ‹‰åˆ—è¡¨ï¼Œ\u0026lt;option\u0026gt;å®šä¹‰åˆ—è¡¨é¡¹ \u0026lt;textarea\u0026gt;ï¼šæ–‡æœ¬åŸŸ \u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;UTF-8\u0026#34;\u0026gt; \u0026lt;meta name=\u0026#34;viewport\u0026#34; content=\u0026#34;width=device-width, initial-scale=1.0\u0026#34;\u0026gt; \u0026lt;title\u0026gt;æ ‡é¢˜\u0026lt;/title\u0026gt; \u0026lt;!-- å†…åµŒæ ·å¼ --\u0026gt; \u0026lt;style\u0026gt; /* CSSæ ·å¼ */ h1 { color: #4d4f53; /* è®¾ç½®æ ‡é¢˜é¢œè‰² */ } \u0026lt;/style\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;div id=\u0026#34;center\u0026#34;\u0026gt; \u0026lt;!-- é¡µé¢å†…å®¹ --\u0026gt; \u0026lt;h1\u0026gt;æ ‡é¢˜\u0026lt;/h1\u0026gt; \u0026lt;!-- æ ‡é¢˜ --\u0026gt; \u0026lt;hr\u0026gt; \u0026lt;!-- æ°´å¹³åˆ†å‰²çº¿ --\u0026gt; \u0026lt;span id=\u0026#34;time\u0026#34;\u0026gt;2024å¹´04æœˆ24æ—¥ 16:32\u0026lt;/span\u0026gt; \u0026lt;!-- æ—¶é—´ --\u0026gt; \u0026lt;hr\u0026gt; \u0026lt;!-- æ°´å¹³åˆ†å‰²çº¿ --\u0026gt; \u0026lt;!-- è§†é¢‘å’ŒéŸ³é¢‘æ’­æ”¾å™¨ --\u0026gt; \u0026lt;video src=\u0026#34;video\\1.mp4\u0026#34; controls width=\u0026#34;950px\u0026#34;\u0026gt;\u0026lt;/video\u0026gt; \u0026lt;audio src=\u0026#34;audio\\1.mp3\u0026#34; controls\u0026gt;\u0026lt;/audio\u0026gt; \u0026lt;!-- æ–‡ç« å†…å®¹ --\u0026gt; \u0026lt;p\u0026gt; æ ‡é¢˜ \u0026lt;!-- æ›´å¤šå†…å®¹çœç•¥... --\u0026gt; \u0026lt;/p\u0026gt; \u0026lt;!-- å›¾ç‰‡ --\u0026gt; \u0026lt;img src=\u0026#34;https://n.sinaimg.cn/sinakd20240424s/66/w554h312/20240424/6365-b8bea506131b4261f579f58304a45baa.png\u0026#34;\u0026gt; \u0026lt;!-- æ›´å¤šå†…å®¹çœç•¥... --\u0026gt; \u0026lt;!-- è´£ä»»ç¼–è¾‘ --\u0026gt; \u0026lt;p id=\u0026#34;plast\u0026#34;\u0026gt; è´£ä»»ç¼–è¾‘ï¼šxxx \u0026lt;/p\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; JavaScript JSæ˜¯ä¸€é—¨è·¨å¹³å°ï¼Œé¢å‘å¯¹è±¡çš„è„šæœ¬è¯­è¨€ã€‚ç”¨æ¥æ§åˆ¶ç½‘é¡µè¡Œä¸ºçš„ï¼Œå®ƒèƒ½ä½¿ç½‘é¡µå¯ä»¥äº¤äº’ JavaScriptå¼•å…¥æ–¹å¼ å†…éƒ¨è„šæœ¬ï¼šå°†JSä»£ç å®šä¹‰åœ¨HTMlé¡µé¢ä¸­\nJavaScriptä»£ç å¿…é¡»ä½äº\u0026lt;script\u0026gt;``\u0026lt;/script\u0026gt;æ ‡ç­¾ä¹‹é—´ åœ¨HTMLæ–‡æ¡£ä¸­ï¼Œå¯ä»¥åœ¨ä»»æ„åœ°æ–¹ï¼Œæ”¾ç½®ä»»æ„æ•°é‡çš„\u0026lt;script\u0026gt; ä¸€èˆ¬ä¼šæŠŠè„šæœ¬ç½®äº\u0026lt;body\u0026gt;å…ƒç´ çš„åº•éƒ¨ï¼Œå¯æ”¹å–„æ˜¾ç¤ºé€Ÿåº¦ å¤–éƒ¨è„šæœ¬ï¼šå°†JSä»£ç å®šä¹‰åœ¨å¤–éƒ¨JSæ–‡ä»¶ä¸­ï¼Œç„¶åå¼•å…¥åˆ°HTMLé¡µé¢ä¸­\nå¤–éƒ¨JSæ–‡ä»¶ä¸­ï¼ŒåªåŒ…å«JSä»£ç ï¼Œä¸åŒ…å«\u0026lt;script\u0026gt;æ ‡ç­¾ \u0026lt;script\u0026gt;æ ‡ç­¾ä¸èƒ½è‡ªé—­å’Œ ä¹¦å†™è¯­æ³•ï¼š åŒºåˆ†å¤§å°å†™ æ¯è¡Œç»“å°¾çš„åˆ†å·å¯æœ‰å¯æ—  æ³¨é‡Š å•è¡Œæ³¨é‡Šï¼š//æ³¨é‡Šå†…å®¹ å¤šè¡Œæ³¨é‡Šï¼š/* æ³¨é‡Šå†…å®¹ */ å¤§æ‹¬å·è¡¨ç¤ºä»£ç å— JSè¾“å‡º \u0026lt;script\u0026gt; // alert(\u0026#34;H\u0026#34;) // /* æ³¨é‡Š*/ // window.alert(\u0026#34;hello js\u0026#34;) document.write(\u0026#34;hi\u0026#34;) console.log(\u0026#34;hello\u0026#34;) \u0026lt;/script\u0026gt; å˜é‡ JSä¸­ä½¿ç”¨varå…³é”®å­—æ¥å£°æ˜å˜é‡ JSæ˜¯ä¸€é—¨å¼±ç±»å‹è¯­è¨€ï¼Œå˜é‡å¯ä»¥å­˜æ”¾ä¸åŒç±»å‹çš„å€¼ å˜é‡åéœ€è¦éµå¾ªå¦‚ä¸‹è§„åˆ™ï¼š ç»„æˆå­—ç¬¦å¯ä»¥æ˜¯ä»»ä½•å­—æ¯ï¼Œæ•°å­—ï¼Œä¸‹åˆ’çº¿(_)æˆ–è€…ç¾å…ƒç¬¦å·($) æ•°å­—ä¸èƒ½å¼€å¤´ å»ºè®®ä½¿ç”¨é©¼å³°å‘½å åŸå§‹æ•°æ®ç±»å‹ï¼š\nnumberï¼šæ•°å­—ï¼ˆæ•´æ•°ï¼Œå°æ•°NaN) string : å­—ç¬¦ä¸²ï¼Œ å•åŒå¼•å·çš†å¯ booleanï¼šå¸ƒå°”ï¼Œ true, false null : å¯¹è±¡ä¸ºç©º undefinedï¼šä¸ºåˆå§‹åŒ–æ—¶ï¼Œé»˜è®¤å€¼æ—¶undefined \u0026lt;script\u0026gt; // æ³¨é‡Šç¤ºä¾‹ // æ³¨é‡Šå¯ä»¥åœ¨ä»£ç ä¸­åŠ å…¥è¯´æ˜æ€§æ–‡å­—ï¼Œä¸ä¼šè¢«æ‰§è¡Œ // å¼¹å‡ºå¯¹è¯æ¡†ï¼Œæ˜¾ç¤º\u0026#34;hello js\u0026#34; window.alert(\u0026#34;hello js\u0026#34;); // åœ¨æ–‡æ¡£ä¸­å†™å…¥\u0026#34;hi\u0026#34; document.write(\u0026#34;hi\u0026#34;); // åœ¨æ§åˆ¶å°è¾“å‡º\u0026#34;hello\u0026#34; console.log(\u0026#34;hello\u0026#34;); \u0026lt;/script\u0026gt; \u0026lt;script\u0026gt; // å˜é‡å£°æ˜å’Œèµ‹å€¼ var a = 10; a = \u0026#34;zs\u0026#34;; // å˜é‡ç±»å‹å¯ä»¥åŠ¨æ€æ”¹å˜ alert(a); // å¼¹å‡º\u0026#34;zs\u0026#34; // ä½¿ç”¨letå£°æ˜çš„å˜é‡å…·æœ‰å—çº§ä½œç”¨åŸŸ { let x = 1; alert(x); // å¼¹å‡º\u0026#34;1\u0026#34; } // ä½¿ç”¨constå£°æ˜å¸¸é‡ï¼Œå¸¸é‡å€¼ä¸å¯ä¿®æ”¹ const pi = 3.14; pi = 3.15; // ä¼šæŠ¥é”™ï¼Œå¸¸é‡å€¼ä¸å¯ä¿®æ”¹ alert(pi); // å¼¹å‡º\u0026#34;3.14\u0026#34; \u0026lt;/script\u0026gt; \u0026lt;script\u0026gt; // typeofæ“ä½œç¬¦ç”¨äºæ£€æµ‹å˜é‡æˆ–è¡¨è¾¾å¼çš„æ•°æ®ç±»å‹ alert(typeof 3); // å¼¹å‡º\u0026#34;number\u0026#34; alert(typeof 3.14); // å¼¹å‡º\u0026#34;number\u0026#34; alert(typeof \u0026#34;A\u0026#34;); // å¼¹å‡º\u0026#34;string\u0026#34; alert(typeof true); // å¼¹å‡º\u0026#34;boolean\u0026#34; alert(typeof null); // å¼¹å‡º\u0026#34;object\u0026#34;ï¼Œnullè¢«è¯¯åˆ¤ä¸ºobject var a; alert(typeof a); // å¼¹å‡º\u0026#34;undefined\u0026#34; \u0026lt;/script\u0026gt; \u0026lt;script\u0026gt; // é€»è¾‘è¿ç®—ç¬¦ \u0026amp;\u0026amp; å’Œ || çš„ä½¿ç”¨ if (0 \u0026amp;\u0026amp; NaN \u0026amp;\u0026amp; 1) { alert(\u0026#34;ok1\u0026#34;); // ä¸ä¼šæ‰§è¡Œï¼Œå› ä¸ºNaNä¸ºå‡ } if (0 || NaN || 1) { alert(\u0026#34;ok2\u0026#34;); // æ‰§è¡Œï¼Œå› ä¸ºé™¤äº†0å’ŒNaNå¤–ï¼Œå…¶ä»–éƒ½ä¸ºçœŸ } // ç©ºå­—ç¬¦ä¸²å’Œç©ºæ ¼å­—ç¬¦ä¸²ä¸ºçœŸï¼Œnullå’Œundefinedä¸ºå‡ if (\u0026#34;\u0026#34;) { alert(\u0026#34;å­—ç¬¦ä¸²ä¸ºçœŸ\u0026#34;); } if (\u0026#34; \u0026#34;) { alert(\u0026#34;å­—ç¬¦ä¸²ä¸ºçœŸ\u0026#34;); } if (null) { alert(\u0026#34;nullä¸ºçœŸ\u0026#34;); } if (undefined) { alert(\u0026#34;undefinedä¸ºçœŸ\u0026#34;); } \u0026lt;/script\u0026gt; \u0026lt;script\u0026gt; // å‡½æ•°å£°æ˜å’Œå‡½æ•°è¡¨è¾¾å¼ // function add(a, b) { // return a + b; // } var add = function (a, b) { return a + b; } var res = add(1, 2, 5, 6); // å¤šä½™çš„å‚æ•°ä¼šè¢«å¿½ç•¥ alert(res); // å¼¹å‡º\u0026#34;3\u0026#34;ï¼Œå› ä¸ºåªè®¡ç®—äº†å‰ä¸¤ä¸ªå‚æ•°çš„å’Œ \u0026lt;/script\u0026gt; JSå¯¹è±¡ Array \u0026lt;script\u0026gt; // åˆ›å»ºæ•°ç»„çš„ä¸¤ç§æ–¹å¼ï¼šä½¿ç”¨Arrayæ„é€ å‡½æ•°å’Œç›´æ¥ä½¿ç”¨æ•°ç»„å­—é¢é‡ // var arr = new Array(1, 2, 3, 4); // console.log(arr); // è¾“å‡ºæ•°ç»„[1, 2, 3, 4] // console.log(arr[1]); // è¾“å‡ºæ•°ç»„ç´¢å¼•ä¸º1çš„å…ƒç´ å€¼ï¼Œå³2 // ä½¿ç”¨æ•°ç»„å­—é¢é‡åˆ›å»ºæ•°ç»„ï¼Œå¹¶æ·»åŠ å…ƒç´  var arr = [1, 2, 3, 4]; arr[10] = 10; // æ·»åŠ å…ƒç´ åˆ°ç´¢å¼•ä¸º10çš„ä½ç½® // console.log(arr[10]); // è¾“å‡ºæ•°ç»„ç´¢å¼•ä¸º10çš„å…ƒç´ å€¼ï¼Œå³10 // console.log(arr[9]); // è¾“å‡ºæ•°ç»„ç´¢å¼•ä¸º9çš„å…ƒç´ å€¼ï¼Œç”±äºæœªå®šä¹‰ï¼Œé»˜è®¤ä¸ºundefined arr[9] = \u0026#34;A\u0026#34;; // ä¿®æ”¹ç´¢å¼•ä¸º9çš„å…ƒç´ å€¼ä¸º\u0026#34;A\u0026#34; arr[8] = \u0026#34;a;dlsfjakldjf\u0026#34;; // ä¿®æ”¹ç´¢å¼•ä¸º8çš„å…ƒç´ å€¼ // console.log(arr[8]); // è¾“å‡ºæ•°ç»„ç´¢å¼•ä¸º8çš„å…ƒç´ å€¼ // console.log(arr[9]); // è¾“å‡ºæ•°ç»„ç´¢å¼•ä¸º9çš„å…ƒç´ å€¼ // éå†æ•°ç»„çš„æ–¹å¼ï¼šforå¾ªç¯ã€forEachæ–¹æ³• // for (let i = 0; i \u0026lt; arr.length; i++) { // console.log(arr[i]); // ä½¿ç”¨forå¾ªç¯éå†æ•°ç»„å…ƒç´ å¹¶è¾“å‡º // } // arr.forEach(function (e) { // console.log(e); // ä½¿ç”¨forEachæ–¹æ³•éå†æ•°ç»„å…ƒç´ å¹¶è¾“å‡º // }); // arr.forEach(e =\u0026gt; { // console.log(e); // ä½¿ç”¨ç®­å¤´å‡½æ•°å’ŒforEachæ–¹æ³•éå†æ•°ç»„å…ƒç´ å¹¶è¾“å‡º // }); // å‘æ•°ç»„æœ«å°¾æ·»åŠ å…ƒç´ ï¼špushæ–¹æ³• arr.push(7, 8, 9); arr.forEach(e =\u0026gt; { console.log(e); // è¾“å‡ºæ·»åŠ åçš„æ•°ç»„å…ƒç´  }); console.log(\u0026#34;-----------\u0026#34;); // ä»æ•°ç»„ä¸­åˆ é™¤å…ƒç´ ï¼šspliceæ–¹æ³• arr.splice(1, 3); // ä»ç´¢å¼•ä¸º1çš„ä½ç½®å¼€å§‹åˆ é™¤3ä¸ªå…ƒç´  arr.forEach(e =\u0026gt; { console.log(e); // è¾“å‡ºåˆ é™¤åçš„æ•°ç»„å…ƒç´  }); \u0026lt;/script\u0026gt; String // åˆ›å»ºä¸€ä¸ª String å¯¹è±¡å¹¶èµ‹å€¼ä¸º \u0026#34;abc\u0026#34; var str1 = new String(\u0026#34;abc\u0026#34;); // ç›´æ¥åˆ›å»ºä¸€ä¸ªå­—ç¬¦ä¸²å˜é‡å¹¶èµ‹å€¼ä¸º \u0026#34; abccba \u0026#34; var str2 = \u0026#34; abccba \u0026#34;; // æ‰“å°å­—ç¬¦ä¸² str1 å’Œ str2 console.log(str1); console.log(str2); // è¾“å‡º str1 çš„é•¿åº¦ï¼Œå³å­—ç¬¦ä¸²ä¸­å­—ç¬¦çš„ä¸ªæ•° console.log(str1.length); // è¿”å› str1 ä¸­ç´¢å¼•ä¸º 1 çš„å­—ç¬¦ï¼Œç´¢å¼•ä» 0 å¼€å§‹ console.log(str1.charAt(1)); // è¿”å›æŒ‡å®šå­—ç¬¦åœ¨ str1 ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼Œå¦‚æœæ‰¾ä¸åˆ°åˆ™è¿”å› -1 console.log(str1.indexOf(\u0026#34;c\u0026#34;)); // å»é™¤å­—ç¬¦ä¸² str2 å¼€å¤´å’Œç»“å°¾çš„ç©ºç™½å­—ç¬¦ï¼Œå¹¶èµ‹å€¼ç»™å˜é‡ s var s = str2.trim(); console.log(s); // è¿”å› str1 ä¸­ç´¢å¼•ä» 0 åˆ° 4ï¼ˆä¸åŒ…æ‹¬ 4ï¼‰çš„å­å­—ç¬¦ä¸² console.log(str1.substring(0, 4)); JSON Java Script Object Notation, JavaScriptå¯¹è±¡æ ‡è®°æ³• JSONæ˜¯é€šè¿‡JavaScriptå¯¹è±¡æ ‡è®°æ³•ä¹¦å†™çš„æ–‡æœ¬ ç”±äºå…¶è¯­æ³•ç®€å•ï¼Œå±‚æ¬¡ç»“æ„é²œæ˜ï¼Œç°åœ¨å¤šç”¨äºæ•°æ®è½½ä½“ï¼Œåœ¨ç½‘ç»œä¸­è¿›è¡Œæ•°æ®ä¼ è¾“ // åˆ›å»ºä¸€ä¸ªåä¸º user çš„å¯¹è±¡ï¼ŒåŒ…å« nameã€ageã€gender å’Œ intro æ–¹æ³• var user = { name: \u0026#34;Tom\u0026#34;, age: 10, gender: \u0026#34;male\u0026#34;, intro: function () { alert(\u0026#34;I am \u0026#34; + this.name + \u0026#34; and I am \u0026#34; + this.age + \u0026#34; years old.\u0026#34;); } // å¦ä¸€ç§å®šä¹‰æ–¹æ³•çš„æ–¹å¼ // intro() { // alert(\u0026#34;I am \u0026#34; + this.name + \u0026#34; and I am \u0026#34; + this.age + \u0026#34; years old.\u0026#34;); // } } // å¼¹å‡º user å¯¹è±¡çš„ name å±æ€§å€¼ alert(user.name); // è°ƒç”¨ user å¯¹è±¡çš„ intro æ–¹æ³•ï¼Œå¼¹å‡ºä¸€æ®µä»‹ç»ä¿¡æ¯ user.intro(); // åˆ›å»ºä¸€ä¸ª JSON å­—ç¬¦ä¸² var jsonstr = \u0026#39;{\u0026#34;name\u0026#34;:\u0026#34;Tom\u0026#34;, \u0026#34;age\u0026#34;:10, \u0026#34;addr\u0026#34;:[\u0026#34;é’å²›\u0026#34;, \u0026#34;å—äº¬\u0026#34;]}\u0026#39;; // ä½¿ç”¨ JSON.parse() æ–¹æ³•è§£æ JSON å­—ç¬¦ä¸²ï¼Œå¹¶å°†å…¶è½¬æ¢ä¸º JavaScript å¯¹è±¡ var obj = JSON.parse(jsonstr); // å¼¹å‡ºè§£æåå¯¹è±¡çš„ name å±æ€§å€¼ alert(obj.name); // ä½¿ç”¨ JSON.stringify() æ–¹æ³•å°† JavaScript å¯¹è±¡è½¬æ¢ä¸º JSON å­—ç¬¦ä¸²ï¼Œå¹¶å¼¹å‡º alert(JSON.stringify(obj)); BOM æ¦‚å¿µï¼šBrowser Object Modelï¼Œ æµè§ˆå™¨å¯¹è±¡æ¨¡å‹ï¼Œ å…è®¸JavaScriptä¸æµè§ˆå™¨å¯¹è¯ï¼ŒJavaScriptå°†æµè§ˆå™¨çš„å„ä¸ªç»„æˆéƒ¨åˆ†å°è£…æˆå¯¹è±¡ã€‚ Window æµè§ˆå™¨çª—å£å¯¹è±¡ è·å–ï¼šç›´æ¥ä½¿ç”¨windowï¼Œå…¶ä¸­window.å¯ä»¥æˆç•¥ Location åœ°å€æ å¯¹è±¡ è·å–ï¼šä½¿ç”¨window.locationï¼Œ å…¶ä¸­window.å¯ä»¥çœç•¥ // å¼¹å‡ºä¸€ä¸ªè­¦å‘Šæ¡†æ˜¾ç¤º \u0026#34;Hello BOMWINDOWS\u0026#34; window.alert(\u0026#34;Hello BOMWINDOWS\u0026#34;); // å¼¹å‡ºä¸€ä¸ªè­¦å‘Šæ¡†æ˜¾ç¤º \u0026#34;Hello BOM\u0026#34; alert(\u0026#34;Hello BOM\u0026#34;); // å¼¹å‡ºä¸€ä¸ªç¡®è®¤æ¡†ï¼Œå¹¶æ ¹æ®ç”¨æˆ·çš„é€‰æ‹©è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œtrue è¡¨ç¤ºç¡®è®¤ï¼Œfalse è¡¨ç¤ºå–æ¶ˆ var flag = confirm(\u0026#34;ä½ ç¡®è®¤åˆ é™¤å—ï¼Ÿ\u0026#34;); alert(flag); // è®¾ç½®ä¸€ä¸ªé—´éš”å®šæ—¶å™¨ï¼Œæ¯éš” 2000 æ¯«ç§’ï¼ˆ2 ç§’ï¼‰æ‰§è¡Œä¸€æ¬¡åŒ¿åå‡½æ•°ï¼Œå¹¶åœ¨æ§åˆ¶å°æ‰“å°æ‰§è¡Œæ¬¡æ•° var i = 0; setInterval(function () { i += 1; console.log(\u0026#34;å®šæ—¶å™¨æ‰§è¡Œäº†:\u0026#34; + i + \u0026#34;æ¬¡\u0026#34;); }, 2000); // è®¾ç½®ä¸€ä¸ªå®šæ—¶å™¨ï¼Œåœ¨ 2000 æ¯«ç§’åå¼¹å‡ºä¸€ä¸ªè­¦å‘Šæ¡†æ˜¾ç¤º \u0026#34;Hello\u0026#34; setTimeout(function () { alert(\u0026#34;Hello\u0026#34;); }, 2000); // å¼¹å‡ºä¸€ä¸ªè­¦å‘Šæ¡†æ˜¾ç¤ºå½“å‰é¡µé¢çš„ URL alert(location.href); // é‡å®šå‘å½“å‰é¡µé¢åˆ°æŒ‡å®š URL location.href = \u0026#34;https://www.itcast.cn\u0026#34;; DOM Decument Object Model, æ–‡æ¡£å¯¹è±¡æ¨¡å‹ å°†æ ‡è®°è¯­è¨€çš„å„ä¸ªéƒ¨åˆ†å°è£…ä¸ºå¯¹åº”çš„å¯¹è±¡ // è·å– id ä¸º \u0026#39;h1\u0026#39; çš„å…ƒç´  var img = document.getElementById(\u0026#39;h1\u0026#39;); alert(img); // è·å–æ‰€æœ‰æ ‡ç­¾åä¸º \u0026#39;div\u0026#39; çš„å…ƒç´ å¹¶å¼¹å‡º var divs = document.getElementsByTagName(\u0026#39;div\u0026#39;); for (let i = 0; i \u0026lt; divs.length; i++) { alert(divs[i]); } // è·å–æ‰€æœ‰ name å±æ€§ä¸º \u0026#39;hobby\u0026#39; çš„å…ƒç´ å¹¶å¼¹å‡º var ins = document.getElementsByName(\u0026#34;hobby\u0026#34;); for (let i = 0; i \u0026lt; ins.length; i++) { alert(ins[i]); } // è·å–æ‰€æœ‰ç±»åä¸º \u0026#39;cls\u0026#39; çš„å…ƒç´ å¹¶å¼¹å‡º var divs = document.getElementsByClassName(\u0026#39;cls\u0026#39;); for (let i = 0; i \u0026lt; divs.length; i++) { alert(divs[i]); } // é‡æ–°è·å–ç±»åä¸º \u0026#39;cls\u0026#39; çš„å…ƒç´ é›†åˆï¼Œå¹¶å–ç¬¬ä¸€ä¸ªå…ƒç´ èµ‹å€¼ç»™ div1ï¼Œå¹¶å¼¹å‡º var divs = document.getElementsByClassName(\u0026#39;cls\u0026#39;); var div1 = divs[0]; alert(div1); // ä¿®æ”¹ div1 çš„ innerHTML å±æ€§ä¸º \u0026#34;666666\u0026#34; div1.innerHTML = \u0026#34;666666\u0026#34;; // è·å– id ä¸º \u0026#39;h1\u0026#39; çš„å…ƒç´ å¹¶ä¿®æ”¹å…¶ src å±æ€§ä¸º \u0026#34;img/on.gif\u0026#34; var img = document.getElementById(\u0026#39;h1\u0026#39;); img.src = \u0026#34;img/on.gif\u0026#34;; // ç»™æ‰€æœ‰æ ‡ç­¾åä¸º \u0026#39;div\u0026#39; çš„å…ƒç´ è¿½åŠ å†…å®¹ \u0026#34;\u0026lt;font color=\u0026#39;red\u0026#39;\u0026gt;Very Good\u0026lt;/font\u0026gt;\u0026#34; var divs = document.getElementsByTagName(\u0026#39;div\u0026#39;); for (let i = 0; i \u0026lt; divs.length; i++) { const element = divs[i]; element.innerHTML += \u0026#34;\u0026lt;font color=\u0026#39;red\u0026#39;\u0026gt;Very Good\u0026lt;/font\u0026gt;\u0026#34;; } // è·å–æ‰€æœ‰ name å±æ€§ä¸º \u0026#39;hobby\u0026#39; çš„å…ƒç´ ï¼Œå¹¶è®¾ç½®å®ƒä»¬çš„ checked å±æ€§ä¸º true var ins = document.getElementsByName(\u0026#34;hobby\u0026#34;); for (let i = 0; i \u0026lt; ins.length; i++) { const check = ins[i]; check.checked = true; } å°æ¡ˆä¾‹ \u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;UTF-8\u0026#34;\u0026gt; \u0026lt;meta http-equiv=\u0026#34;X-UA-Compatible\u0026#34; content=\u0026#34;IE=edge\u0026#34;\u0026gt; \u0026lt;meta name=\u0026#34;viewport\u0026#34; content=\u0026#34;width=device-width, initial-scale=1.0\u0026#34;\u0026gt; \u0026lt;title\u0026gt;JS-äº‹ä»¶-äº‹ä»¶ç»‘å®š\u0026lt;/title\u0026gt; \u0026lt;style\u0026gt; /* æ ·å¼ç¾åŒ– */ body { font-family: Arial, sans-serif; text-align: center; } #light { width: 100px; } .button { padding: 8px 16px; margin: 5px; font-size: 16px; cursor: pointer; } .checkbox-label { margin-right: 10px; } \u0026lt;/style\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;!-- å›¾ç‰‡æ ‡ç­¾ï¼Œç”¨äºæ˜¾ç¤ºç¯çš„çŠ¶æ€ --\u0026gt; \u0026lt;img id=\u0026#34;light\u0026#34; src=\u0026#34;img/off.gif\u0026#34; alt=\u0026#34;ç¯\u0026#34;\u0026gt; \u0026lt;br\u0026gt; \u0026lt;!-- ä¸¤ä¸ªæŒ‰é’®ï¼Œåˆ†åˆ«ç”¨äºç‚¹äº®å’Œç†„ç­ç¯ --\u0026gt; \u0026lt;button class=\u0026#34;button\u0026#34; id=\u0026#34;btnOn\u0026#34; onclick=\u0026#34;on()\u0026#34;\u0026gt;ç‚¹äº®\u0026lt;/button\u0026gt; \u0026lt;button class=\u0026#34;button\u0026#34; id=\u0026#34;btnOff\u0026#34; onclick=\u0026#34;off()\u0026#34;\u0026gt;ç†„ç­\u0026lt;/button\u0026gt; \u0026lt;!-- æ–‡å­—æ ‡ç­¾ --\u0026gt; \u0026lt;div class=\u0026#34;cls\u0026#34;\u0026gt;é»‘é©¬\u0026lt;/div\u0026gt; \u0026lt;br\u0026gt; \u0026lt;br\u0026gt; \u0026lt;!-- è¾“å…¥æ¡†ï¼Œè¾“å…¥å†…å®¹è½¬æ¢ä¸ºå¤§å†™æˆ–å°å†™ --\u0026gt; \u0026lt;input type=\u0026#34;text\u0026#34; id=\u0026#34;name\u0026#34; value=\u0026#34;itcast\u0026#34; onfocus=\u0026#34;lower()\u0026#34; onblur=\u0026#34;upper()\u0026#34;\u0026gt; \u0026lt;br\u0026gt; \u0026lt;!-- å¤šä¸ªå¤é€‰æ¡†ï¼Œç”¨äºé€‰æ‹©çˆ±å¥½ --\u0026gt; \u0026lt;label class=\u0026#34;checkbox-label\u0026#34;\u0026gt;\u0026lt;input type=\u0026#34;checkbox\u0026#34; name=\u0026#34;hobby\u0026#34;\u0026gt; ç”µå½±\u0026lt;/label\u0026gt; \u0026lt;label class=\u0026#34;checkbox-label\u0026#34;\u0026gt;\u0026lt;input type=\u0026#34;checkbox\u0026#34; name=\u0026#34;hobby\u0026#34;\u0026gt; æ—…æ¸¸\u0026lt;/label\u0026gt; \u0026lt;label class=\u0026#34;checkbox-label\u0026#34;\u0026gt;\u0026lt;input type=\u0026#34;checkbox\u0026#34; name=\u0026#34;hobby\u0026#34;\u0026gt; æ¸¸æˆ\u0026lt;/label\u0026gt; \u0026lt;br\u0026gt; \u0026lt;!-- å…¨é€‰å’Œåé€‰æŒ‰é’® --\u0026gt; \u0026lt;button class=\u0026#34;button\u0026#34; id=\u0026#34;btnCheckAll\u0026#34; onclick=\u0026#34;checkAll()\u0026#34;\u0026gt;å…¨é€‰\u0026lt;/button\u0026gt; \u0026lt;button class=\u0026#34;button\u0026#34; id=\u0026#34;btnReverse\u0026#34; onclick=\u0026#34;reverse()\u0026#34;\u0026gt;åé€‰\u0026lt;/button\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;script\u0026gt; // ç‚¹äº®ç¯å‡½æ•° function on() { var img = document.getElementById(\u0026#34;light\u0026#34;); img.src = \u0026#34;img/on.gif\u0026#34;; } // ç†„ç­ç¯å‡½æ•° function off() { var img = document.getElementById(\u0026#34;light\u0026#34;); img.src = \u0026#34;img/off.gif\u0026#34;; } // å°†è¾“å…¥å†…å®¹è½¬æ¢ä¸ºå¤§å†™ function upper() { var input = document.getElementById(\u0026#34;name\u0026#34;); input.value = input.value.toUpperCase(); } // å°†è¾“å…¥å†…å®¹è½¬æ¢ä¸ºå°å†™ function lower() { var input = document.getElementById(\u0026#34;name\u0026#34;); input.value = input.value.toLowerCase(); } // å…¨é€‰å¤é€‰æ¡†å‡½æ•° function checkAll() { var hobbys = document.getElementsByName(\u0026#34;hobby\u0026#34;); for (let i = 0; i \u0026lt; hobbys.length; i++) { const element = hobbys[i]; element.checked = true; } } // åé€‰å¤é€‰æ¡†å‡½æ•° function reverse() { var hobbys = document.getElementsByName(\u0026#34;hobby\u0026#34;); for (let i = 0; i \u0026lt; hobbys.length; i++) { const element = hobbys[i]; element.checked = !element.checked; // åˆ‡æ¢é€‰ä¸­çŠ¶æ€ } } \u0026lt;/script\u0026gt; \u0026lt;/html\u0026gt; ","permalink":"https://kennems.github.io/posts/tech/java-web%E5%BC%80%E5%8F%911/","summary":"Java Webå¼€å‘(1) ä»€ä¹ˆæ˜¯Webï¼Ÿ Webï¼šå…¨çƒå¹¿åŸŸç½‘ï¼Œä¹Ÿæˆä¸ºä¸‡ç»´ç½‘ï¼ˆWorld Wide Web)ï¼Œèƒ½å¤Ÿé€šè¿‡æµè§ˆå™¨è®¿é—®çš„ç½‘ç«™ CRM OA ERP ä¸è°‹å…¨å±€è€…ä¸è¶³ä»¥è°‹ä¸€åŸŸ","title":"Java Webå¼€å‘(1)"},{"content":"Java Webå¼€å‘(2) Vue Vueæ˜¯ä¸€å¥—å‰ç«¯æ¡†æ¶ï¼Œå…é™¤åŸç”Ÿçš„JavaScriptä¸­çš„DOMæ“ä½œï¼Œç®€åŒ–ä¹¦å†™ã€‚ åŸºäºMVVMï¼ˆModel-View-View-Modelï¼‰æ€æƒ³ï¼Œå®ç°æ•°æ®çš„åŒå‘ç»‘å®šï¼Œå°†ç¼–ç¨‹çš„å…³æ³¨ç‚¹æ”¾åœ¨æ•°æ®ä¸Šã€‚ \u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;UTF-8\u0026#34;\u0026gt; \u0026lt;meta name=\u0026#34;viewport\u0026#34; content=\u0026#34;width=device-width, initial-scale=1.0\u0026#34;\u0026gt; \u0026lt;title\u0026gt;Vue\u0026lt;/title\u0026gt; \u0026lt;!-- å¼•å…¥Vue.jsåº“ --\u0026gt; \u0026lt;script src=\u0026#34;../js/vue.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;div id=\u0026#34;app\u0026#34;\u0026gt; \u0026lt;!-- è¾“å…¥æ¡†ï¼Œä½¿ç”¨v-modelæŒ‡ä»¤å®ç°åŒå‘æ•°æ®ç»‘å®š --\u0026gt; \u0026lt;input type=\u0026#34;text\u0026#34; v-model=\u0026#34;message\u0026#34;\u0026gt; \u0026lt;!-- ä½¿ç”¨æ’å€¼è¡¨è¾¾å¼æ˜¾ç¤ºmessageå˜é‡çš„å€¼ --\u0026gt; {{ message }} \u0026lt;/div\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;script\u0026gt; // åˆ›å»ºä¸€ä¸ªVueå®ä¾‹ new Vue({ // å°†Vueå®ä¾‹æŒ‚è½½åˆ°idä¸º\u0026#34;app\u0026#34;çš„å…ƒç´ ä¸Š el: \u0026#34;#app\u0026#34;, // å®šä¹‰æ•°æ®å¯¹è±¡ data: { message: \u0026#34;Hello Vue\u0026#34; // åˆå§‹å€¼ä¸º\u0026#34;Hello Vue\u0026#34; } }) \u0026lt;/script\u0026gt; \u0026lt;/html\u0026gt; Vueå¸¸ç”¨æŒ‡ä»¤ \u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;UTF-8\u0026#34;\u0026gt; \u0026lt;meta name=\u0026#34;viewport\u0026#34; content=\u0026#34;width=device-width, initial-scale=1.0\u0026#34;\u0026gt; \u0026lt;title\u0026gt;Vue\u0026lt;/title\u0026gt; \u0026lt;!-- å¼•å…¥ Vue.js æ–‡ä»¶ --\u0026gt; \u0026lt;script src=\u0026#34;../js/vue.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;!-- Vue å®ä¾‹æŒ‚è½½çš„æ ¹èŠ‚ç‚¹ --\u0026gt; \u0026lt;div id=\u0026#34;app\u0026#34;\u0026gt; \u0026lt;table border=\u0026#34;1\u0026#34; cellspacing=\u0026#34;0\u0026#34; width=\u0026#34;60%\u0026#34;\u0026gt; \u0026lt;tr\u0026gt; \u0026lt;th\u0026gt;ç¼–å·\u0026lt;/th\u0026gt; \u0026lt;th\u0026gt;å§“å\u0026lt;/th\u0026gt; \u0026lt;th\u0026gt;å¹´é¾„\u0026lt;/th\u0026gt; \u0026lt;th\u0026gt;æ€§åˆ«\u0026lt;/th\u0026gt; \u0026lt;th\u0026gt;æˆç»©\u0026lt;/th\u0026gt; \u0026lt;th\u0026gt;ç­‰çº§\u0026lt;/th\u0026gt; \u0026lt;/tr\u0026gt; \u0026lt;!-- ä½¿ç”¨ v-for å¾ªç¯æ¸²æŸ“åˆ—è¡¨ --\u0026gt; \u0026lt;tr align=\u0026#34;center\u0026#34; v-for=\u0026#34;(user, index) in users\u0026#34;\u0026gt; \u0026lt;td\u0026gt;{{index + 1}}\u0026lt;/td\u0026gt; \u0026lt;td\u0026gt;{{user.name}}\u0026lt;/td\u0026gt; \u0026lt;td\u0026gt;{{user.age}}\u0026lt;/td\u0026gt; \u0026lt;td\u0026gt; \u0026lt;!-- ä½¿ç”¨ v-if æ¡ä»¶æ¸²æŸ“ --\u0026gt; \u0026lt;span v-if=\u0026#34;user.gender == 1\u0026#34;\u0026gt;ç”·\u0026lt;/span\u0026gt; \u0026lt;span v-if=\u0026#34;user.gender == 2\u0026#34;\u0026gt;å¥³\u0026lt;/span\u0026gt; \u0026lt;/td\u0026gt; \u0026lt;td\u0026gt;{{user.score}}\u0026lt;/td\u0026gt; \u0026lt;td\u0026gt; \u0026lt;!-- ä½¿ç”¨ v-ifã€v-else-ifã€v-else å®ç°å¤šæ¡ä»¶æ¸²æŸ“ --\u0026gt; \u0026lt;span v-if=\u0026#34;user.score \u0026gt;= 60 \u0026amp;\u0026amp; user.score \u0026lt; 85\u0026#34;\u0026gt;ä¼˜ç§€\u0026lt;/span\u0026gt; \u0026lt;span v-else-if=\u0026#34;user.score \u0026gt;= 85\u0026#34;\u0026gt;åŠæ ¼\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026#34;color:red\u0026#34; v-else\u0026gt;ä¸åŠæ ¼\u0026lt;/span\u0026gt; \u0026lt;/td\u0026gt; \u0026lt;/tr\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;script\u0026gt; // åˆ›å»º Vue å®ä¾‹ new Vue({ el: \u0026#34;#app\u0026#34;, // æŒ‡å®šå®ä¾‹æŒ‚è½½çš„æ ¹èŠ‚ç‚¹ data: { // ç”¨äºå­˜å‚¨æ•°æ®çš„å¯¹è±¡ users: [{ name: \u0026#34;Tom\u0026#34;, age: 20, gender: 1, score: 30 }, { name: \u0026#34;Rose\u0026#34;, age: 18, gender: 2, score: 99 }, { name: \u0026#34;Jerry\u0026#34;, age: 16, gender: 1, score: 98 }, { name: \u0026#34;Kennem\u0026#34;, age: 21, gender: 1, score: 100 }] }, }) \u0026lt;/script\u0026gt; \u0026lt;/html\u0026gt; Vueç”Ÿå‘½å‘¨æœŸ new new Vue({ el: \u0026#34;#app\u0026#34;, //æ¥ç®¡åŒºåŸŸ data: { }, methods: { }, mounted() { alert(\u0026#34;æŒ‚è½½å®Œæˆ!\u0026#34;); }, }) Ajax Asynchronous JavaScript And XML, å¼‚æ­¥çš„JavaScriptå’ŒXML ä½œç”¨ï¼š æ•°æ®äº¤æ¢ï¼šé€šè¿‡Ajaxå¯ä»¥ç»™æœåŠ¡å™¨å‘é€è¯·æ±‚ï¼Œå¹¶è·å–æœåŠ¡å™¨å“åº”çš„æ•°æ®ã€‚ å¼‚æ­¥äº¤äº’ï¼šå¯ä»¥åœ¨ä¸é‡æ–°åŠ è½½æ•´ä¸ªé¡µé¢çš„æƒ…å†µä¸‹ï¼Œä¸æœåŠ¡å™¨äº¤æ¢æ•°æ®å¹¶æ›´æ–°éƒ¨åˆ†ç½‘é¡µçš„æŠ€æœ¯ï¼Œå¦‚ï¼šæœç´¢è”æƒ³ï¼Œç”¨æˆ·åæ˜¯å¦å¯ç”¨çš„æ ¡éªŒç­‰ã€‚ \u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;UTF-8\u0026#34;\u0026gt; \u0026lt;meta http-equiv=\u0026#34;X-UA-Compatible\u0026#34; content=\u0026#34;IE=edge\u0026#34;\u0026gt; \u0026lt;meta name=\u0026#34;viewport\u0026#34; content=\u0026#34;width=device-width, initial-scale=1.0\u0026#34;\u0026gt; \u0026lt;title\u0026gt;åŸç”ŸAjax\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;input type=\u0026#34;button\u0026#34; value=\u0026#34;è·å–æ•°æ®\u0026#34; onclick=\u0026#34;getData()\u0026#34;\u0026gt; \u0026lt;div id=\u0026#34;div1\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;script\u0026gt; function getData() { // åˆ›å»ºXMLHttpRequestå¯¹è±¡ var xmlHttpRequest = new XMLHttpRequest(); // å‘é€å¼‚æ­¥è¯·æ±‚ xmlHttpRequest.open(\u0026#39;GET\u0026#39;, \u0026#39;https://xxx/json_demo.json\u0026#39;); xmlHttpRequest.send(); // å‘é€è¯·æ±‚ // è·å–æœåŠ¡å“åº”æ•°æ® xmlHttpRequest.onreadystatechange = function () { if (xmlHttpRequest.readyState == 4 \u0026amp;\u0026amp; xmlHttpRequest.status == 200) { document.getElementById(\u0026#39;div1\u0026#39;).innerHTML = xmlHttpRequest.responseText; } } } \u0026lt;/script\u0026gt; \u0026lt;/html\u0026gt; Axios Axioså¯¹åŸç”Ÿçš„Ajaxè¿›è¡Œäº†å°è£…ï¼Œç®€åŒ–ä¹¦å†™ï¼Œå¿«é€Ÿå¼€å‘ã€‚ \u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;UTF-8\u0026#34;\u0026gt; \u0026lt;meta http-equiv=\u0026#34;X-UA-Compatible\u0026#34; content=\u0026#34;IE=edge\u0026#34;\u0026gt; \u0026lt;meta name=\u0026#34;viewport\u0026#34; content=\u0026#34;width=device-width, initial-scale=1.0\u0026#34;\u0026gt; \u0026lt;title\u0026gt;Ajax-Axios-æ¡ˆä¾‹\u0026lt;/title\u0026gt; \u0026lt;!-- å¼•å…¥axiosåº“ --\u0026gt; \u0026lt;script src=\u0026#34;js/axios-0.18.0.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;!-- å¼•å…¥Vue.js --\u0026gt; \u0026lt;script src=\u0026#34;js/vue.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;div id=\u0026#34;app\u0026#34;\u0026gt; \u0026lt;!-- æ•°æ®å±•ç¤ºè¡¨æ ¼ --\u0026gt; \u0026lt;table border=\u0026#34;1\u0026#34; cellspacing=\u0026#34;0\u0026#34; width=\u0026#34;60%\u0026#34;\u0026gt; \u0026lt;!-- è¡¨å¤´ --\u0026gt; \u0026lt;tr\u0026gt; \u0026lt;th\u0026gt;ç¼–å·\u0026lt;/th\u0026gt; \u0026lt;th\u0026gt;å§“å\u0026lt;/th\u0026gt; \u0026lt;th\u0026gt;å›¾åƒ\u0026lt;/th\u0026gt; \u0026lt;th\u0026gt;æ€§åˆ«\u0026lt;/th\u0026gt; \u0026lt;th\u0026gt;èŒä½\u0026lt;/th\u0026gt; \u0026lt;th\u0026gt;å…¥èŒæ—¥æœŸ\u0026lt;/th\u0026gt; \u0026lt;th\u0026gt;æœ€åæ“ä½œæ—¶é—´\u0026lt;/th\u0026gt; \u0026lt;/tr\u0026gt; \u0026lt;!-- æ•°æ®è¡Œï¼Œä½¿ç”¨Vue.jsçš„v-foræŒ‡ä»¤å¾ªç¯æ¸²æŸ“ --\u0026gt; \u0026lt;tr align=\u0026#34;center\u0026#34; v-for=\u0026#34;(emp,index) in emps\u0026#34;\u0026gt; \u0026lt;td\u0026gt;{{index + 1}}\u0026lt;/td\u0026gt; \u0026lt;!-- æ˜¾ç¤ºç¼–å· --\u0026gt; \u0026lt;td\u0026gt;{{emp.name}}\u0026lt;/td\u0026gt; \u0026lt;!-- æ˜¾ç¤ºå§“å --\u0026gt; \u0026lt;td\u0026gt; \u0026lt;img :src=\u0026#34;emp.image\u0026#34; width=\u0026#34;70px\u0026#34; height=\u0026#34;50px\u0026#34;\u0026gt; \u0026lt;!-- æ˜¾ç¤ºå›¾åƒ --\u0026gt; \u0026lt;/td\u0026gt; \u0026lt;td\u0026gt; \u0026lt;span v-if=\u0026#34;emp.gender == 1\u0026#34;\u0026gt;ç”·\u0026lt;/span\u0026gt; \u0026lt;!-- æ ¹æ®æ€§åˆ«æ˜¾ç¤ºç”·æˆ–å¥³ --\u0026gt; \u0026lt;span v-if=\u0026#34;emp.gender == 2\u0026#34;\u0026gt;å¥³\u0026lt;/span\u0026gt; \u0026lt;/td\u0026gt; \u0026lt;td\u0026gt;{{emp.job}}\u0026lt;/td\u0026gt; \u0026lt;!-- æ˜¾ç¤ºèŒä½ --\u0026gt; \u0026lt;td\u0026gt;{{emp.entrydate}}\u0026lt;/td\u0026gt; \u0026lt;!-- æ˜¾ç¤ºå…¥èŒæ—¥æœŸ --\u0026gt; \u0026lt;td\u0026gt;{{emp.updatetime}}\u0026lt;/td\u0026gt; \u0026lt;!-- æ˜¾ç¤ºæœ€åæ“ä½œæ—¶é—´ --\u0026gt; \u0026lt;/tr\u0026gt; \u0026lt;/table\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;script\u0026gt; new Vue({ el: \u0026#34;#app\u0026#34;, data: { emps: [] // å­˜å‚¨å‘˜å·¥æ•°æ®çš„æ•°ç»„ }, mounted () { // åœ¨Vueå®ä¾‹mountedç”Ÿå‘½å‘¨æœŸé’©å­ä¸­å‘é€å¼‚æ­¥è¯·æ±‚åŠ è½½æ•°æ® axios.get(\u0026#34;http://yapi.smart-xwork.cn/mock/169327/emp/list\u0026#34;).then(result =\u0026gt; { // å¼‚æ­¥è¯·æ±‚æˆåŠŸåå°†æ•°æ®èµ‹å€¼ç»™empsæ•°ç»„ this.emps = result.data.data; }) } }); \u0026lt;/script\u0026gt; \u0026lt;/html\u0026gt; æ¥å£ç®¡ç†å¹³å° Yapi apifox\nä½œä¸ºæµ‹è¯•æ¥å£\nVueå¼€å‘ Vueå®‰è£… npm -g install vue/cli vue é¡¹ç›®åˆ›å»º vue create project-name Vueçš„ç»„ä»¶æ–‡ä»¶ä»¥.vueç»“å°¾ï¼Œ æ¯ä¸ªç»„ä»¶ç”±ä¸‰ä¸ªéƒ¨åˆ†ç»„æˆ\u0026lt;template\u0026gt;, \u0026lt;script\u0026gt;, \u0026lt;style\u0026gt;ã€‚ Element UI npm install element-ui@2.15.3 import ElementUI from \u0026#39;element-ui\u0026#39;; import \u0026#39;element-ui/lib/theme-chalk/index.css\u0026#39;; Vue.use(ElementUI); Vueè·¯ç”± å‰ç«¯è·¯ç”±ï¼šURLä¸­çš„hash(#)ä¸ç»„ä»¶ä¹‹é—´çš„å¯¹åº”å…³ç³»ã€‚ https://mock.apifox.cn/m1/3128855-0-default/emp/list Nginx å¤„ç†è¢«å ç”¨çš„ç«¯å£å·ï¼š\nnetstat -ano | findStr 80 å°†æµ‹è¯•å¥½çš„å‰ç«¯ç½‘é¡µå¤åˆ¶åˆ°htmlé™æ€èµ„æºä¸­\nç„¶åç›´æ¥å¯åŠ¨nginxå³å¯ã€‚\nè®¿é—®ï¼š\nhttp://localhost:80 å‘˜å·¥ç®¡ç†é¡¹ç›® main.js // å¼•å…¥Vueæ¡†æ¶ import Vue from \u0026#39;vue\u0026#39; // å¼•å…¥ElementUIç»„ä»¶åº“ import ElementUI from \u0026#39;element-ui\u0026#39;; // å¼•å…¥Vue Routerï¼Œç”¨äºç®¡ç†é¡µé¢è·¯ç”± import router from \u0026#39;./router\u0026#39; // å¼•å…¥ElementUIçš„æ ·å¼æ–‡ä»¶ import \u0026#39;element-ui/lib/theme-chalk/index.css\u0026#39;; // å¼•å…¥æ ¹ç»„ä»¶App.vue import App from \u0026#39;./App.vue\u0026#39; // åœ¨Vueä¸­ä½¿ç”¨ElementUI Vue.use(ElementUI); // å…³é—­ç”Ÿäº§æ¨¡å¼ä¸‹çš„æç¤º Vue.config.productionTip = false // åˆ›å»ºVueå®ä¾‹ new Vue({ // æ³¨å…¥è·¯ç”± router, // æ¸²æŸ“æ ¹ç»„ä»¶ render: h =\u0026gt; h(App), }).$mount(\u0026#39;#app\u0026#39;) app.vue \u0026lt;template\u0026gt; \u0026lt;div id=\u0026#34;app\u0026#34;\u0026gt; \u0026lt;!-- \u0026lt;emp-view\u0026gt; \u0026lt;/emp-view\u0026gt; --\u0026gt; \u0026lt;!-- è¿™æ˜¯ Vue Router çš„è§†å›¾æ¸²æŸ“å‡ºå£ï¼Œç”¨äºå±•ç¤ºå½“å‰åŒ¹é…çš„è§†å›¾ç»„ä»¶ --\u0026gt; \u0026lt;router-view\u0026gt; \u0026lt;/router-view\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/template\u0026gt; \u0026lt;script\u0026gt; // å¯¼å…¥ç»„ä»¶ // import EmpView from \u0026#39;./views/tlias/EmpView.vue\u0026#39; export default { // æ³¨å†Œç»„ä»¶ components: { /*EmpView*/ }, data() { // ç»„ä»¶çš„æ•°æ®å±æ€§ï¼Œå¯ä»¥åœ¨æ¨¡æ¿ä¸­ä½¿ç”¨ return { message: \u0026#34;\u0026#34; } }, methods: { // ç»„ä»¶çš„æ–¹æ³•ï¼Œç”¨äºå®šä¹‰å„ç§åŠŸèƒ½ }, } \u0026lt;/script\u0026gt; \u0026lt;style\u0026gt; /* ç»„ä»¶çš„æ ·å¼ */ #app { font-family: Consolas, Helvetica, Arial, sans-serif; -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; text-align: center; color: #2c3e50; margin-top: 60px; } \u0026lt;/style\u0026gt; EmpView.vue \u0026lt;template\u0026gt; \u0026lt;div\u0026gt; \u0026lt;!-- Element UI å¸ƒå±€å®¹å™¨ --\u0026gt; \u0026lt;el-container style=\u0026#34;height: 700px; border: 2px solid #eee\u0026#34;\u0026gt; \u0026lt;!-- å¤´éƒ¨åŒºåŸŸ --\u0026gt; \u0026lt;el-header style=\u0026#34;font-size: 48px; background-color: rgb(238, 241, 246); text-align: left;\u0026#34;\u0026gt;Tliasæ™ºèƒ½å­¦ä¹ è¾…åŠ©ç³»ç»Ÿ\u0026lt;/el-header\u0026gt; \u0026lt;el-container\u0026gt; \u0026lt;!-- ä¾§è¾¹æ åŒºåŸŸ --\u0026gt; \u0026lt;el-aside width=\u0026#34;230px\u0026#34; style=\u0026#34; border: 2px solid #eee\u0026#34;\u0026gt; \u0026lt;!-- ä¾§è¾¹æ å¯¼èˆªèœå• --\u0026gt; \u0026lt;el-menu :default-openeds=\u0026#34;[\u0026#39;1\u0026#39;, \u0026#39;3\u0026#39;]\u0026#34;\u0026gt; \u0026lt;el-submenu index=\u0026#34;1\u0026#34;\u0026gt; \u0026lt;template slot=\u0026#34;title\u0026#34;\u0026gt;\u0026lt;i class=\u0026#34;el-icon-message\u0026#34;\u0026gt;\u0026lt;/i\u0026gt;ç³»ç»Ÿä¿¡æ¯ç®¡ç†\u0026lt;/template\u0026gt; \u0026lt;el-menu-item-group\u0026gt; \u0026lt;!-- å¯¼èˆªé“¾æ¥ --\u0026gt; \u0026lt;el-menu-item index=\u0026#34;1-1\u0026#34;\u0026gt; \u0026lt;router-link to=\u0026#34;/dept\u0026#34;\u0026gt;éƒ¨é—¨ç®¡ç†\u0026lt;/router-link\u0026gt; \u0026lt;/el-menu-item\u0026gt; \u0026lt;el-menu-item index=\u0026#34;1-2\u0026#34;\u0026gt; \u0026lt;router-link to=\u0026#34;/emp\u0026#34;\u0026gt;å‘˜å·¥ç®¡ç†\u0026lt;/router-link\u0026gt; \u0026lt;/el-menu-item\u0026gt; \u0026lt;/el-menu-item-group\u0026gt; \u0026lt;/el-submenu\u0026gt; \u0026lt;/el-menu\u0026gt; \u0026lt;/el-aside\u0026gt; \u0026lt;!-- ä¸»ä½“åŒºåŸŸ --\u0026gt; \u0026lt;el-main\u0026gt; \u0026lt;!-- æŸ¥è¯¢è¡¨å• --\u0026gt; \u0026lt;el-form :inline=\u0026#34;true\u0026#34; :model=\u0026#34;searchForm\u0026#34; class=\u0026#34;demo-form-inline\u0026#34;\u0026gt; \u0026lt;el-form-item label=\u0026#34;å§“å\u0026#34;\u0026gt; \u0026lt;el-input v-model=\u0026#34;searchForm.name\u0026#34; placeholder=\u0026#34;è¾“å…¥å§“å\u0026#34;\u0026gt;\u0026lt;/el-input\u0026gt; \u0026lt;/el-form-item\u0026gt; \u0026lt;el-form-item label=\u0026#34;æ€§åˆ«\u0026#34;\u0026gt; \u0026lt;el-select v-model=\u0026#34;searchForm.gender\u0026#34; placeholder=\u0026#34;è¾“å…¥æ€§åˆ«\u0026#34;\u0026gt; \u0026lt;el-option label=\u0026#34;ç”·\u0026#34; value=\u0026#34;1\u0026#34;\u0026gt;\u0026lt;/el-option\u0026gt; \u0026lt;el-option label=\u0026#34;å¥³\u0026#34; value=\u0026#34;2\u0026#34;\u0026gt;\u0026lt;/el-option\u0026gt; \u0026lt;/el-select\u0026gt; \u0026lt;/el-form-item\u0026gt; \u0026lt;el-form-item label=\u0026#34;å…¥èŒæ—¶é—´\u0026#34;\u0026gt; \u0026lt;el-date-picker v-model=\u0026#34;searchForm.entrydate\u0026#34; type=\u0026#34;daterange\u0026#34; range-separator=\u0026#34;è‡³\u0026#34; start-placeholder=\u0026#34;å¼€å§‹æ—¥æœŸ\u0026#34; end-placeholder=\u0026#34;ç»“æŸæ—¥æœŸ\u0026#34;\u0026gt; \u0026lt;/el-date-picker\u0026gt; \u0026lt;/el-form-item\u0026gt; \u0026lt;el-form-item\u0026gt; \u0026lt;el-button type=\u0026#34;primary\u0026#34; @click=\u0026#34;onSubmit\u0026#34;\u0026gt;æŸ¥è¯¢\u0026lt;/el-button\u0026gt; \u0026lt;/el-form-item\u0026gt; \u0026lt;/el-form\u0026gt; \u0026lt;!-- è¡¨æ ¼ --\u0026gt; \u0026lt;el-table :data=\u0026#34;tableData\u0026#34; border\u0026gt; \u0026lt;el-table-column prop=\u0026#34;name\u0026#34; label=\u0026#34;å§“å\u0026#34; width=\u0026#34;180\u0026#34;\u0026gt; \u0026lt;/el-table-column\u0026gt; \u0026lt;el-table-column prop=\u0026#34;image\u0026#34; label=\u0026#34;å›¾åƒ\u0026#34; width=\u0026#34;180\u0026#34;\u0026gt; \u0026lt;!-- ä½œç”¨åŸŸæ’æ§½ --\u0026gt; \u0026lt;template slot-scope=\u0026#34;scope\u0026#34;\u0026gt; \u0026lt;img :src=\u0026#34;scope.row.image\u0026#34; width=\u0026#34;100px\u0026#34; height=\u0026#34;70px\u0026#34;\u0026gt; \u0026lt;/template\u0026gt; \u0026lt;/el-table-column\u0026gt; \u0026lt;el-table-column prop=\u0026#34;gender\u0026#34; label=\u0026#34;æ€§åˆ«\u0026#34; width=\u0026#34;140\u0026#34;\u0026gt; \u0026lt;!-- ä½œç”¨åŸŸæ’æ§½ --\u0026gt; \u0026lt;template slot-scope=\u0026#34;scope\u0026#34;\u0026gt; {{ scope.row.gender == 1 ? \u0026#34;ç”·\u0026#34; : \u0026#34;å¥³\u0026#34; }} \u0026lt;/template\u0026gt; \u0026lt;/el-table-column\u0026gt; \u0026lt;el-table-column prop=\u0026#34;job\u0026#34; label=\u0026#34;èŒä½\u0026#34; width=\u0026#34;140\u0026#34;\u0026gt; \u0026lt;/el-table-column\u0026gt; \u0026lt;el-table-column prop=\u0026#34;entrydate\u0026#34; label=\u0026#34;å…¥èŒæ—¥æœŸ\u0026#34; width=\u0026#34;180\u0026#34;\u0026gt; \u0026lt;/el-table-column\u0026gt; \u0026lt;el-table-column prop=\u0026#34;updatetime\u0026#34; label=\u0026#34;æœ€åæ“ä½œæ—¶é—´\u0026#34; width=\u0026#34;230\u0026#34;\u0026gt; \u0026lt;/el-table-column\u0026gt; \u0026lt;el-table-column label=\u0026#34;æ“ä½œ\u0026#34;\u0026gt; \u0026lt;el-button type=\u0026#34;primary\u0026#34; size=\u0026#34;mini\u0026#34;\u0026gt;ç¼–è¾‘\u0026lt;/el-button\u0026gt; \u0026lt;el-button type=\u0026#34;danger\u0026#34; size=\u0026#34;mini\u0026#34;\u0026gt;åˆ é™¤\u0026lt;/el-button\u0026gt; \u0026lt;/el-table-column\u0026gt; \u0026lt;/el-table\u0026gt; \u0026lt;!-- åˆ†é¡µæ¡ --\u0026gt; \u0026lt;el-pagination background layout=\u0026#34;sizes, prev, pager, next, jumper, total\u0026#34; @size-change=\u0026#34;handleSizeChange\u0026#34; @current-change=\u0026#34;handleCurrentChange\u0026#34; :total=\u0026#34;1000\u0026#34;\u0026gt;\u0026lt;/el-pagination\u0026gt; \u0026lt;/el-main\u0026gt; \u0026lt;/el-container\u0026gt; \u0026lt;/el-container\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/template\u0026gt; \u0026lt;script\u0026gt; import axios from \u0026#39;axios\u0026#39;; export default { data() { return { // è¡¨æ ¼æ•°æ® tableData: [], // æŸ¥è¯¢è¡¨å•æ•°æ® searchForm: { name: \u0026#34;\u0026#34;, gender: \u0026#34;\u0026#34; }, // å…¥èŒæ—¥æœŸèŒƒå›´ entrydate: [] } }, methods: { // æŸ¥è¯¢æŒ‰é’®ç‚¹å‡»äº‹ä»¶ onsubmit() { alert(\u0026#34;æŸ¥è¯¢æ•°æ®ï¼\u0026#34;); }, // åˆ†é¡µå½“å‰é¡µæ”¹å˜äº‹ä»¶ handleCurrentChange() { alert(\u0026#34;CurrentChange\u0026#34;); }, // åˆ†é¡µæ¯é¡µæ¡æ•°æ”¹å˜äº‹ä»¶ handleSizeChange() { alert(\u0026#34;SizeChange\u0026#34;); } }, mounted() { // ç»„ä»¶åˆå§‹åŒ–æ—¶ä»æ¥å£è·å–æ•°æ® axios.get(\u0026#34;https://mock.apifox.cn/m1/3128855-0-default/emp/list\u0026#34;).then((result) =\u0026gt; { this.tableData = result.data.data; }); }, } \u0026lt;/script\u0026gt; \u0026lt;style\u0026gt;\u0026lt;/style\u0026gt; DeptView.vue \u0026lt;template\u0026gt; \u0026lt;div\u0026gt; \u0026lt;!-- Element UI å¸ƒå±€å®¹å™¨ --\u0026gt; \u0026lt;el-container style=\u0026#34;height: 700px; border: 1px solid #eee\u0026#34;\u0026gt; \u0026lt;!-- å¤´éƒ¨åŒºåŸŸ --\u0026gt; \u0026lt;el-header style=\u0026#34;font-size:40px; background-color: rgb(238, 241, 246)\u0026#34;\u0026gt;tlias æ™ºèƒ½å­¦ä¹ è¾…åŠ©ç³»ç»Ÿ\u0026lt;/el-header\u0026gt; \u0026lt;el-container\u0026gt; \u0026lt;!-- ä¾§è¾¹æ åŒºåŸŸ --\u0026gt; \u0026lt;el-aside width=\u0026#34;230px\u0026#34; style=\u0026#34;border: 1px solid #eee\u0026#34;\u0026gt; \u0026lt;!-- ä¾§è¾¹æ å¯¼èˆªèœå• --\u0026gt; \u0026lt;el-menu :default-openeds=\u0026#34;[\u0026#39;1\u0026#39;, \u0026#39;3\u0026#39;]\u0026#34;\u0026gt; \u0026lt;el-submenu index=\u0026#34;1\u0026#34;\u0026gt; \u0026lt;template slot=\u0026#34;title\u0026#34;\u0026gt;\u0026lt;i class=\u0026#34;el-icon-message\u0026#34;\u0026gt;\u0026lt;/i\u0026gt;ç³»ç»Ÿä¿¡æ¯ç®¡ç†\u0026lt;/template\u0026gt; \u0026lt;!-- å¯¼èˆªé“¾æ¥ --\u0026gt; \u0026lt;el-menu-item index=\u0026#34;1-1\u0026#34;\u0026gt; \u0026lt;router-link to=\u0026#34;/dept\u0026#34;\u0026gt;éƒ¨é—¨ç®¡ç†\u0026lt;/router-link\u0026gt; \u0026lt;/el-menu-item\u0026gt; \u0026lt;el-menu-item index=\u0026#34;1-2\u0026#34;\u0026gt; \u0026lt;router-link to=\u0026#34;/emp\u0026#34;\u0026gt;å‘˜å·¥ç®¡ç†\u0026lt;/router-link\u0026gt; \u0026lt;/el-menu-item\u0026gt; \u0026lt;/el-submenu\u0026gt; \u0026lt;/el-menu\u0026gt; \u0026lt;/el-aside\u0026gt; \u0026lt;!-- ä¸»ä½“åŒºåŸŸ --\u0026gt; \u0026lt;el-main\u0026gt; \u0026lt;!-- è¡¨æ ¼ --\u0026gt; \u0026lt;el-table :data=\u0026#34;tableData\u0026#34; border\u0026gt; \u0026lt;el-table-column prop=\u0026#34;name\u0026#34; label=\u0026#34;åç§°\u0026#34; width=\u0026#34;250\u0026#34;\u0026gt;\u0026lt;/el-table-column\u0026gt; \u0026lt;el-table-column prop=\u0026#34;updatetime\u0026#34; label=\u0026#34;æœ€åæ“ä½œæ—¶é—´\u0026#34; width=\u0026#34;250\u0026#34;\u0026gt;\u0026lt;/el-table-column\u0026gt; \u0026lt;el-table-column label=\u0026#34;æ“ä½œ\u0026#34;\u0026gt; \u0026lt;el-button type=\u0026#34;primary\u0026#34; size=\u0026#34;mini\u0026#34;\u0026gt;ç¼–è¾‘\u0026lt;/el-button\u0026gt; \u0026lt;el-button type=\u0026#34;danger\u0026#34; size=\u0026#34;mini\u0026#34;\u0026gt;åˆ é™¤\u0026lt;/el-button\u0026gt; \u0026lt;/el-table-column\u0026gt; \u0026lt;/el-table\u0026gt; \u0026lt;/el-main\u0026gt; \u0026lt;/el-container\u0026gt; \u0026lt;/el-container\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/template\u0026gt; \u0026lt;script\u0026gt; export default { data() { return { // è¡¨æ ¼æ•°æ® tableData: [{ id: 1, name: \u0026#34;å­¦å·¥éƒ¨\u0026#34;, updatetime: \u0026#34;2010-01-01 12:00:00\u0026#34; }, { id: 2, name: \u0026#34;æ•™ç ”éƒ¨\u0026#34;, updatetime: \u0026#34;2010-01-01 12:00:00\u0026#34; }, { id: 3, name: \u0026#34;å°±ä¸šéƒ¨\u0026#34;, updatetime: \u0026#34;2010-01-01 12:00:00\u0026#34; }, { id: 4, name: \u0026#34;äººäº‹éƒ¨\u0026#34;, updatetime: \u0026#34;2010-01-01 12:00:00\u0026#34; }, { id: 5, name: \u0026#34;è¡Œæ”¿éƒ¨\u0026#34;, updatetime: \u0026#34;2010-01-01 12:00:00\u0026#34; }] } }, methods: { // å¯ä»¥åœ¨è¿™é‡Œå®šä¹‰ç»„ä»¶çš„æ–¹æ³• } } \u0026lt;/script\u0026gt; \u0026lt;style\u0026gt;\u0026lt;/style\u0026gt; index.js import Vue from \u0026#39;vue\u0026#39; // å¯¼å…¥ Vue Router import VueRouter from \u0026#39;vue-router\u0026#39; // ä½¿ç”¨ Vue Router æ’ä»¶ Vue.use(VueRouter) // å®šä¹‰è·¯ç”±è§„åˆ™ const routes = [{ // è·¯ç”±è·¯å¾„ä¸º /emp path: \u0026#39;/emp\u0026#39;, // è·¯ç”±åç§°ä¸º emp name: \u0026#39;emp\u0026#39;, // ä½¿ç”¨åŠ¨æ€å¯¼å…¥å»¶è¿ŸåŠ è½½ç»„ä»¶ component: () =\u0026gt; import(\u0026#39;../views/tlias/EmpView.vue\u0026#39;) }, { // è·¯ç”±è·¯å¾„ä¸º /dept path: \u0026#39;/dept\u0026#39;, // è·¯ç”±åç§°ä¸º dept name: \u0026#39;dept\u0026#39;, // ä½¿ç”¨åŠ¨æ€å¯¼å…¥å»¶è¿ŸåŠ è½½ç»„ä»¶ component: () =\u0026gt; import(\u0026#39;../views/tlias/DeptView.vue\u0026#39;) }, { // è·¯ç”±è·¯å¾„ä¸º / path: \u0026#39;/\u0026#39;, // é‡å®šå‘åˆ° /dept redirect: \u0026#39;/dept\u0026#39; //é»˜è®¤è®¿é—®dept } ] // åˆ›å»ºè·¯ç”±å®ä¾‹ const router = new VueRouter({ routes }) // å¯¼å‡ºè·¯ç”±å®ä¾‹ export default router ","permalink":"https://kennems.github.io/posts/tech/java-web%E5%BC%80%E5%8F%912/","summary":"Java Webå¼€å‘(2) Vue Vueæ˜¯ä¸€å¥—å‰ç«¯æ¡†æ¶ï¼Œå…é™¤åŸç”Ÿçš„JavaScriptä¸­çš„DOMæ“ä½œï¼Œç®€åŒ–ä¹¦å†™ã€‚ åŸºäºMVVMï¼ˆModel-View-Vie","title":"Java Webå¼€å‘(2)"},{"content":"Java20å¤©é€Ÿæˆâ€”â€”è¿›é˜¶è¯¾ç¨‹(5) ç½‘ç»œç¼–ç¨‹ å¯ä»¥è®©è®¾å¤‡ä¸­çš„ç¨‹åºä¸ç½‘ç»œä¸Šå…¶ä»–è®¾å¤‡ä¸­çš„ç¨‹åºè¿›è¡Œæ•°æ®äº¤äº’ï¼ˆå®ç°ç½‘ç»œé€šä¿¡ï¼‰ åŸºæœ¬çš„é€šä¿¡æ¶æ„\nåŸºæœ¬çš„é€šä¿¡æ¶æ„æœ‰2ä¸­å½¢å¼ï¼šCSæ¶æ„ï¼ˆClientå®¢æˆ·ç«¯/ServeræœåŠ¡ç«¯ï¼‰ã€BSæ¶æ„ï¼ˆBrowseræµè§ˆå™¨/ServeræœåŠ¡å™¨ï¼‰ æ— è®ºæ˜¯CSæ¶æ„ï¼Œè¿˜æ˜¯BSæ¶æ„çš„è½¯ä»¶éƒ½å¿…é¡»è¦ä¾èµ–ç½‘ç»œç¼–ç¨‹\nç½‘ç»œé€šä¿¡ä¸‰è¦ç´ ï¼š IPï¼ˆInternet Protocolï¼‰ï¼š è®¾å¤‡åœ¨ç½‘ç»œä¸­çš„åœ°å€ï¼Œæ˜¯å”¯ä¸€çš„æ ‡è¯†ï¼Œ å…¨ç§° â€œäº’è”ç½‘åè®®åœ°å€â€ï¼Œ æ˜¯åˆ†é…ç»™ä¸Šç½‘è®¾å¤‡çš„å”¯ä¸€æ ‡å¿—ã€‚\nä¸¤ç§å½¢å¼ï¼šIPv4(32bit), IPv6(128bit) IPv6åˆ†æˆ8æ®µè¡¨ç¤ºï¼Œæ¯æ®µæ¯å››ä½ç¼–ç æˆä¸€ä¸ªåå…­è¿›åˆ¶ä½æ ‡è¯†ï¼Œæ•°ä¹‹é—´ç”¨å†’å·(:)åˆ†å¼€ã€‚ å…¬ç½‘IPï¼Œ å†…ç½‘IP\nå…¬ç½‘IPï¼šæ˜¯å¯ä»¥è¿æ¥äº’è”ç½‘çš„IPåœ°å€ï¼› å†…ç½‘IPï¼šä¹Ÿå«å±€åŸŸç½‘IPï¼Œ åªèƒ½ç»„ç»‡æœºæ„å†…éƒ¨ä½¿ç”¨ 192.168. å¼€å¤´çš„å°±æ˜¯å¸¸è§çš„å±€åŸŸç½‘åœ°å€ï¼ŒèŒƒå›´å³ä¸º192.168.0.0--192.168.255.255ï¼Œä¸“é—¨ä½ç»„ç»‡æœºæ„å†…éƒ¨ä½¿ç”¨ 127.0.0.1 ã€localhost : ä»£è¡¨æœ¬æœºIPï¼Œåªä¼šå¯»æ‰¾å½“å‰æ‰€åœ¨çš„ä¸»æœº ç«¯å£ï¼š åº”ç”¨ç¨‹åºåœ¨è®¾å¤‡ä¸­å”¯ä¸€çš„æ ‡è¯†\næ ‡è®°æ­£åœ¨è®¡ç®—æœºè®¾å¤‡ä¸Šè¿è¡Œçš„åº”ç”¨ç¨‹åºçš„ï¼Œè¢«è§„å®šä¸ºä¸€ä¸ª16ä½çš„äºŒè¿›åˆ¶ï¼ŒèŒƒå›´æ˜¯0~65535 åˆ†ç±»ï¼š å‘¨çŸ¥ç«¯å£ï¼š0~1023ï¼š è¢«é¢„å…ˆå®šä¹‰çš„çŸ¥ååº”ç”¨å ç”¨ï¼ˆå¦‚ï¼šHTTPå ç”¨80ï¼Œ FTPå ç”¨21ï¼‰ æ³¨å†Œç«¯å£ï¼š1024~49151ï¼Œåˆ†é…ç»™ç”¨æˆ·è¿›ç¨‹æˆ–æŸäº›åº”ç”¨ç¨‹åº åŠ¨æ€ç«¯å£ï¼š49152åˆ°65535ï¼Œä¹‹æ‰€ä»¥è¢«ç§°ä¸ºåŠ¨æ€ç«¯å£ï¼Œæ˜¯å› ä¸ºå®ƒä¸€èˆ¬ä¸å›ºå®šåˆ†é…æŸç§è¿›ç¨‹ï¼Œè€Œæ˜¯åŠ¨æ€åˆ†é… åè®®ï¼š è¿æ¥å’Œæ•°æ®åœ¨ç½‘ç»œä¸­ä¼ è¾“çš„è§„åˆ™\nInetAddress ä»£è¡¨IPåœ°å€ public static void main(String[] args) throws Exception { // è·å–æœ¬åœ°ä¸»æœºçš„ InetAddress InetAddress ip1 = InetAddress.getLocalHost(); System.out.println(ip1.getHostName()); // è¾“å‡ºæœ¬åœ°ä¸»æœºçš„ä¸»æœºå System.out.println(ip1.getHostAddress()); // è¾“å‡ºæœ¬åœ°ä¸»æœºçš„ IP åœ°å€ // æ ¹æ®åŸŸåè·å– InetAddress InetAddress ip2 = InetAddress.getByName(\u0026#34;www.baidu.com\u0026#34;); System.out.println(ip2.getHostName()); // è¾“å‡ºç™¾åº¦ä¸»æœºçš„ä¸»æœºå System.out.println(ip2.getHostAddress()); // è¾“å‡ºç™¾åº¦ä¸»æœºçš„ IP åœ°å€ // æ£€æŸ¥ä¸»æœºæ˜¯å¦å¯è¾¾ï¼ˆpingï¼‰ System.out.println(ip2.isReachable(6000)); // è¾“å‡ºç™¾åº¦ä¸»æœºæ˜¯å¦å¯è¾¾ } å¼€æ”¾å¼ç½‘ç»œäº’è”æ ‡å‡†ï¼šOSIç½‘ç»œå‚è€ƒæ¨¡å‹\nOSIç½‘ç»œå‚è€ƒæ¨¡å‹ï¼šå…¨çƒç½‘ç»œäº’è”æ ‡å‡† ä¼ è¾“å±‚ UDPï¼ˆUser Datagram Protocolï¼‰ï¼šç”¨æˆ·æ•°æ®æŠ¥åè®®ï¼›TCPï¼ˆTransmission Control Protocolï¼‰ï¼šä¼ è¾“æ§åˆ¶åè®® UDPåè®® ç‰¹ç‚¹ï¼šæ— è¿æ¥ï¼Œä¸å¯é é€šä¿¡ ä¸äº‹å…ˆå»ºç«‹è¿æ¥ï¼Œæ•°æ®æŒ‰ç…§åŒ…å‘ï¼Œä¸€åŒ…æ•°æ®åŒ…å«ï¼šè‡ªå·±çš„IPï¼Œç¨‹åºç«¯å£ï¼Œç›®çš„åœ°IPï¼Œç¨‹åºç«¯å£å’Œæ•°æ®ï¼ˆé™åˆ¶åœ¨64KBå†…ï¼‰ç­‰, å‘å‡ºå»å°±ä¸ç®¡äº†ã€‚ å‘é€æ–¹ä¸ç®¡å¯¹æ–¹æ˜¯å¦åœ¨çº¿ï¼Œæ•°æ®åœ¨ä¸­é—´ä¸¢å¤±ä¹Ÿä¸ç®¡ï¼Œå¦‚æœæ¥å—æ–¹æ”¶åˆ°æ•°æ®ä¹Ÿä¸è¿”å›ç¡®è®¤ï¼Œæ‰€ä»¥ä¸å¯é çš„ UDPé€šä¿¡ package com.showguan.InternetDemo; import java.net.DatagramPacket; import java.net.DatagramSocket; import java.net.InetAddress; import java.net.SocketException; import java.util.Scanner; public class Client { public static void main(String[] args) throws Exception { DatagramSocket socket = new DatagramSocket(); // åˆ›å»ºå®¢æˆ·ç«¯ DatagramSocket å®ä¾‹ Scanner sc = new Scanner(System.in); // åˆ›å»º Scanner å¯¹è±¡ç”¨äºè¾“å…¥æ¶ˆæ¯ while (true) { System.out.println(\u0026#34;è¯·è¾“å…¥ä½ éœ€è¦å‘é€çš„æ¶ˆæ¯(exité€€å‡º)\u0026#34;); String msg = sc.nextLine(); // è¯»å–ç”¨æˆ·è¾“å…¥çš„æ¶ˆæ¯ if (msg.equals(\u0026#34;exit\u0026#34;)) { // å¦‚æœè¾“å…¥ exitï¼Œåˆ™é€€å‡ºå¾ªç¯ System.out.println(\u0026#34;é€€å‡ºæˆåŠŸ\u0026#34;); socket.close(); // å…³é—­å®¢æˆ·ç«¯ Socket break; } byte[] bytes = msg.getBytes(); // å°†æ¶ˆæ¯è½¬æ¢ä¸ºå­—èŠ‚æ•°ç»„ DatagramPacket packet = new DatagramPacket(bytes, bytes.length , InetAddress.getLocalHost(), 6666); // åˆ›å»ºè¦å‘é€çš„ DatagramPacket socket.send(packet); // å‘é€æ•°æ®æŠ¥æ–‡åˆ°æœåŠ¡å™¨ } } } package com.showguan.InternetDemo; import java.net.DatagramPacket; import java.net.DatagramSocket; import java.net.SocketException; public class Server { public static void main(String[] args) throws Exception { DatagramSocket socket = new DatagramSocket(6666); // åˆ›å»ºæœåŠ¡å™¨ç«¯ DatagramSocket å®ä¾‹ï¼Œç›‘å¬ç«¯å£ 6666 while (true) { byte[] buffer = new byte[1024*64]; // åˆ›å»ºå­—èŠ‚æ•°ç»„ç”¨äºå­˜å‚¨æ¥æ”¶çš„æ•°æ® DatagramPacket packet = new DatagramPacket(buffer, buffer.length); // åˆ›å»º DatagramPacket ç”¨äºæ¥æ”¶æ•°æ® socket.receive(packet); // æ¥æ”¶å®¢æˆ·ç«¯å‘é€çš„æ•°æ®æŠ¥æ–‡ System.out.println(packet.getAddress()); // æ‰“å°å®¢æˆ·ç«¯çš„ IP åœ°å€ System.out.println(packet.getPort()); // æ‰“å°å®¢æˆ·ç«¯çš„ç«¯å£å· int len = packet.getLength(); // è·å–æ¥æ”¶åˆ°çš„æ•°æ®é•¿åº¦ String s = new String(buffer, 0, len); // å°†æ¥æ”¶åˆ°çš„å­—èŠ‚æ•°ç»„è½¬æ¢ä¸ºå­—ç¬¦ä¸² System.out.println(s); // æ‰“å°æ¥æ”¶åˆ°çš„æ¶ˆæ¯ System.out.println(\u0026#34;--------------------\u0026#34;); } } } TCPåè®® ç‰¹ç‚¹ï¼šé¢å‘è¿æ¥ï¼Œå¯é é€šä¿¡ TCPçš„æœ€ç»ˆç›®çš„ï¼šè¦ä¿è¯åœ¨ä¸å¯é çš„ä¿¡é“ä¸Šå®ç°å¯é çš„ä¼ è¾“ TCPä¸»è¦æœ‰ä¸‰ä¸ªæ­¥éª¤å®ç°å¯é ä¼ è¾“ï¼šä¸‰æ¬¡æ¡æ‰‹å»ºç«‹è¿æ¥ï¼Œä¼ è¾“æ•°æ®è¿›è¡Œç¡®è®¤ï¼Œå››æ¬¡æŒ¥æ‰‹æ–­å¼€è¿æ¥ å¯é è¿æ¥ï¼šç¡®å®šé€šä¿¡åŒæ–¹ï¼Œæ”¶å‘æ¶ˆæ¯éƒ½æ˜¯æ­£å¸¸æ— é—®é¢˜çš„ï¼ˆå…¨åŒå·¥ï¼‰\nä¸‰æ¬¡æ¡æ‰‹æ‰èƒ½ç¡®å®šå½¼æ­¤æ”¶å‘æ¶ˆæ¯éƒ½æ˜¯æ²¡é—®é¢˜çš„ã€‚\nä¼ è¾“æ•°æ®ä¼šè¿›è¡Œç¡®è®¤ï¼Œä»¥ä¿è¯æ•°æ®ä¼ è¾“çš„å¯é æ€§\nTCPé€šä¿¡-æ”¯æŒä¸å¤šä¸ªå®¢æˆ·ç«¯åŒæ—¶é€šä¿¡ package com.showguan.CaseDemo; import java.io.DataOutputStream; import java.io.OutputStream; import java.net.Socket; import java.util.Scanner; public class Client { public static void main(String[] args) throws Exception { Socket socket = new Socket(\u0026#34;127.0.0.1\u0026#34;, 8888); // åˆ›å»ºå®¢æˆ·ç«¯ Socket å¹¶è¿æ¥æœåŠ¡å™¨ OutputStream os = socket.getOutputStream(); // è·å– Socket çš„è¾“å‡ºæµ DataOutputStream dos = new DataOutputStream(os); // åŒ…è£…è¾“å‡ºæµä¸º DataOutputStream Scanner sc = new Scanner(System.in); new ClientReaderThread(socket).start(); // å¯åŠ¨å®¢æˆ·ç«¯è¯»çº¿ç¨‹ï¼Œç”¨äºæ¥æ”¶æœåŠ¡ç«¯æ¶ˆæ¯ while (true) { System.out.println(\u0026#34;è¯·è¾“å…¥ä½ éœ€è¦å‘é€çš„æ¶ˆæ¯\u0026#34;); String msg = sc.nextLine(); // è¯»å–ç”¨æˆ·è¾“å…¥çš„æ¶ˆæ¯ if(msg.equals(\u0026#34;exit\u0026#34;)){ // å¦‚æœè¾“å…¥ exitï¼Œåˆ™é€€å‡ºå¾ªç¯ socket.close(); // å…³é—­å®¢æˆ·ç«¯ Socket System.out.println(\u0026#34;æˆåŠŸé€€å‡ºé€šä¿¡\u0026#34;); dos.close(); // å…³é—­è¾“å‡ºæµ break; } dos.writeUTF(msg); // å‘æœåŠ¡å™¨å‘é€æ¶ˆæ¯ dos.flush(); // åˆ·æ–°è¾“å‡ºæµï¼Œç¡®ä¿æ¶ˆæ¯å‘é€ } } } package com.showguan.CaseDemo; import java.io.DataInputStream; import java.io.InputStream; import java.net.Socket; public class ClientReaderThread extends Thread { private Socket socket; public ClientReaderThread(Socket socket) { this.socket = socket; // åˆå§‹åŒ– Socket } @Override public void run() { try { InputStream is = socket.getInputStream(); // è·å–è¾“å…¥æµ DataInputStream dis = new DataInputStream(is); // åŒ…è£…è¾“å…¥æµä¸º DataInputStream while (true) { try { String msg = dis.readUTF(); // è¯»å–æœåŠ¡ç«¯å‘é€çš„æ¶ˆæ¯ System.out.println(msg); // æ‰“å°æ¥æ”¶åˆ°çš„æ¶ˆæ¯ } catch (Exception e) { System.out.println(\u0026#34;æ‚¨æˆåŠŸä¸‹çº¿äº†ï¼\u0026#34;); // æ‰“å°å®¢æˆ·ç«¯ä¸‹çº¿ä¿¡æ¯ socket.close(); // å…³é—­ Socket è¿æ¥ dis.close(); // å…³é—­è¾“å…¥æµ break; // é€€å‡ºå¾ªç¯ } } } catch (Exception e) { e.printStackTrace(); } } } package com.showguan.CaseDemo; import java.io.*; import java.net.ServerSocket; import java.net.Socket; import java.util.ArrayList; import java.util.List; public class Server { public static List\u0026lt;Socket\u0026gt; onLineSockets = new ArrayList\u0026lt;\u0026gt;(); // å­˜å‚¨åœ¨çº¿çš„å®¢æˆ·ç«¯ Socket public static void main(String[] args) throws Exception { System.out.println(\u0026#34;æœåŠ¡ç«¯å¯åŠ¨æˆåŠŸï¼\u0026#34;); ServerSocket serverSocket = new ServerSocket(8888); // åˆ›å»ºæœåŠ¡å™¨ç«¯ ServerSocketï¼Œç›‘å¬ç«¯å£ 8888 while (true) { Socket socket = serverSocket.accept(); // ç­‰å¾…å®¢æˆ·ç«¯è¿æ¥ onLineSockets.add(socket); // æ·»åŠ å®¢æˆ·ç«¯ Socket åˆ°åœ¨çº¿åˆ—è¡¨ System.out.println(\u0026#34;æœ‰äººä¸Šçº¿äº†ï¼\u0026#34; + socket.getRemoteSocketAddress()); // æ‰“å°å®¢æˆ·ç«¯åœ°å€ä¿¡æ¯ ServerReaderThread serverReaderThread = new ServerReaderThread(socket); // åˆ›å»ºæœåŠ¡å™¨ç«¯è¯»çº¿ç¨‹ serverReaderThread.start(); // å¯åŠ¨æœåŠ¡å™¨ç«¯è¯»çº¿ç¨‹å¤„ç†å®¢æˆ·ç«¯æ¶ˆæ¯ } } } package com.showguan.CaseDemo; import java.io.*; import java.net.Socket; public class ServerReaderThread extends Thread { private Socket socket; public ServerReaderThread(Socket socket) { this.socket = socket; // åˆå§‹åŒ– Socket } @Override public void run() { try { InputStream is = socket.getInputStream(); // è·å–è¾“å…¥æµ DataInputStream dis = new DataInputStream(is); // åŒ…è£…è¾“å…¥æµä¸º DataInputStream while (true) { String msg = null; try { msg = dis.readUTF(); // è¯»å–å®¢æˆ·ç«¯å‘é€çš„æ¶ˆæ¯ System.out.println(msg); // æ‰“å°æ¥æ”¶åˆ°çš„æ¶ˆæ¯ sendMsgToAll(msg); // å°†æ¶ˆæ¯å‘é€ç»™æ‰€æœ‰åœ¨çº¿å®¢æˆ·ç«¯ } catch (Exception e) { System.out.println(\u0026#34;ç”¨æˆ·ï¼š \u0026#34; + socket.getRemoteSocketAddress() + \u0026#34;ä¸‹çº¿äº†\u0026#34;); // æ‰“å°å®¢æˆ·ç«¯ä¸‹çº¿ä¿¡æ¯ Server.onLineSockets.remove(socket); // ä»åœ¨çº¿åˆ—è¡¨ä¸­ç§»é™¤å®¢æˆ·ç«¯ Socket socket.close(); // å…³é—­ Socket è¿æ¥ dis.close(); // å…³é—­è¾“å…¥æµ break; // é€€å‡ºå¾ªç¯ } } } catch (Exception e) { e.printStackTrace(); } } // å°†æ¶ˆæ¯å‘é€ç»™æ‰€æœ‰åœ¨çº¿å®¢æˆ·ç«¯ private void sendMsgToAll(String msg) throws Exception { for (Socket onLineSocket : Server.onLineSockets) { // éå†åœ¨çº¿å®¢æˆ·ç«¯åˆ—è¡¨ if(onLineSocket.equals(socket)){ // æ’é™¤å½“å‰å®¢æˆ·ç«¯ continue; } OutputStream os = onLineSocket.getOutputStream(); // è·å–å®¢æˆ·ç«¯çš„è¾“å‡ºæµ DataOutputStream dos = new DataOutputStream(os); // åŒ…è£…è¾“å‡ºæµä¸º DataOutputStream dos.writeUTF(msg); // å‘é€æ¶ˆæ¯ç»™å®¢æˆ·ç«¯ dos.flush(); // åˆ·æ–°è¾“å‡ºæµ } } } BS æ¶æ„ import java.io.*; import java.net.*; import java.util.concurrent.*; /** * ä¸€ä¸ªç®€å•çš„åŸºäºSocketçš„HTTPæœåŠ¡å™¨ç¤ºä¾‹ */ public class SimpleHttpServer { public static void main(String[] args) throws Exception { // æ˜¾ç¤ºæœåŠ¡ç«¯å¯åŠ¨æˆåŠŸä¿¡æ¯ System.out.println(\u0026#34;æœåŠ¡ç«¯å¯åŠ¨æˆåŠŸï¼\u0026#34;); // åˆ›å»ºServerSocketå¹¶ç›‘å¬æŒ‡å®šç«¯å£ ServerSocket serverSocket = new ServerSocket(8081); // åˆ›å»ºçº¿ç¨‹æ± ï¼Œç”¨äºå¤„ç†å®¢æˆ·ç«¯è¯·æ±‚ ThreadPoolExecutor pool = new ThreadPoolExecutor( 12 * 2, // æ ¸å¿ƒçº¿ç¨‹æ•° 12 * 2, // æœ€å¤§çº¿ç¨‹æ•° 0, // çº¿ç¨‹ç©ºé—²è¶…æ—¶æ—¶é—´ TimeUnit.SECONDS, // æ—¶é—´å•ä½ new ArrayBlockingQueue\u0026lt;\u0026gt;(8), // ä»»åŠ¡é˜Ÿåˆ— Executors.defaultThreadFactory(), // çº¿ç¨‹å·¥å‚ new ThreadPoolExecutor.AbortPolicy()); // æ‹’ç»ç­–ç•¥ // æœåŠ¡ç«¯å¾ªç¯ç›‘å¬å®¢æˆ·ç«¯è¯·æ±‚ while (true) { Socket socket = serverSocket.accept(); // ç­‰å¾…å®¢æˆ·ç«¯è¿æ¥ System.out.println(\u0026#34;æœ‰äººè®¿é—®ç½‘é¡µï¼\u0026#34; + socket.getRemoteSocketAddress()); // æ˜¾ç¤ºå®¢æˆ·ç«¯è¿æ¥ä¿¡æ¯ pool.execute(new ServerReaderThread(socket)); // å°†è¿æ¥äº¤ç»™çº¿ç¨‹æ± å¤„ç† } } } /** * æœåŠ¡å™¨è¯»å–çº¿ç¨‹ï¼Œç”¨äºå¤„ç†å®¢æˆ·ç«¯è¯·æ±‚ */ class ServerReaderThread extends Thread { private Socket socket; // ä¸å®¢æˆ·ç«¯é€šä¿¡çš„Socketå¯¹è±¡ /** * æ„é€ æ–¹æ³•ï¼Œåˆå§‹åŒ–Socketå¯¹è±¡ * @param socket ä¸å®¢æˆ·ç«¯é€šä¿¡çš„Socketå¯¹è±¡ */ public ServerReaderThread(Socket socket) { this.socket = socket; } /** * çº¿ç¨‹è¿è¡Œæ–¹æ³•ï¼Œå¤„ç†å®¢æˆ·ç«¯è¯·æ±‚ */ @Override public void run() { try { OutputStream os = socket.getOutputStream(); // è·å–è¾“å‡ºæµ PrintStream ps = new PrintStream(os); // ä½¿ç”¨PrintStreamåŒ…è£…è¾“å‡ºæµï¼Œæ–¹ä¾¿å†™å…¥å“åº”æ•°æ® // HTTPå“åº”å¤´éƒ¨ä¿¡æ¯ ps.println(\u0026#34;HTTP/1.1 200 OK\u0026#34;); // å“åº”çŠ¶æ€ç åŠçŠ¶æ€ä¿¡æ¯ ps.println(\u0026#34;Content-Type:text/html;charset=UTF-8\u0026#34;); // å†…å®¹ç±»å‹åŠç¼–ç  ps.println(); // ç©ºè¡Œï¼Œè¡¨ç¤ºå¤´éƒ¨ä¿¡æ¯ç»“æŸ // HTTPå“åº”ä½“ï¼Œè¿”å›ä¸€ä¸ªç®€å•çš„HTMLé¡µé¢ ps.println(\u0026#34;\u0026lt;div style=\u0026#39;color:red;font-size:120px;text-align:center\u0026#39;\u0026gt;Kennem\u0026lt;div\u0026gt;\u0026#34;); // çº¢è‰²æ–‡æœ¬ ps.println(\u0026#34;\u0026lt;html\u0026gt;\u0026#34;); ps.println(\u0026#34;\u0026lt;head\u0026gt;\u0026#34;); ps.println(\u0026#34;\u0026lt;title\u0026gt;Welcome\u0026lt;/title\u0026gt;\u0026#34;); ps.println(\u0026#34;\u0026lt;/head\u0026gt;\u0026#34;); ps.println(\u0026#34;\u0026lt;body\u0026gt;\u0026#34;); ps.println(\u0026#34;\u0026lt;h1 style=\u0026#39;color:red;text-align:center;\u0026#39;\u0026gt;Welcome to my server!\u0026lt;/h1\u0026gt;\u0026#34;); ps.println(\u0026#34;\u0026lt;p style=\u0026#39;text-align:center;\u0026#39;\u0026gt;Here are some interesting links:\u0026lt;/p\u0026gt;\u0026#34;); ps.println(\u0026#34;\u0026lt;ul\u0026gt;\u0026#34;); ps.println(\u0026#34;\u0026lt;li\u0026gt;\u0026lt;a href=\u0026#39;https://www.example.com\u0026#39;\u0026gt;Example Website\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\u0026#34;); ps.println(\u0026#34;\u0026lt;li\u0026gt;\u0026lt;a href=\u0026#39;https://www.example2.com\u0026#39;\u0026gt;Another Example Website\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\u0026#34;); ps.println(\u0026#34;\u0026lt;/ul\u0026gt;\u0026#34;); ps.println(\u0026#34;\u0026lt;p style=\u0026#39;text-align:center;\u0026#39;\u0026gt;And here\u0026#39;s an image:\u0026lt;/p\u0026gt;\u0026#34;); ps.println(\u0026#34;\u0026lt;div style=\u0026#39;text-align:center;\u0026#39;\u0026gt;\u0026lt;img src=\u0026#39;https://th.bing.com/th/id/OIG3.ryWiFmseYX.jWcO7pmoz?pid=ImgGn\u0026#39; alt=\u0026#39;Example Image\u0026#39;\u0026gt;\u0026lt;/div\u0026gt;\u0026#34;); ps.println(\u0026#34;\u0026lt;/body\u0026gt;\u0026#34;); ps.println(\u0026#34;\u0026lt;/html\u0026gt;\u0026#34;); ps.close(); // å…³é—­è¾“å‡ºæµ } catch (Exception e) { e.printStackTrace(); // è¾“å‡ºå¼‚å¸¸ä¿¡æ¯ } } } å•å…ƒæµ‹è¯• å°±æ˜¯é’ˆå¯¹æœ€å°çš„åŠŸèƒ½å•å…ƒï¼ˆæ–¹æ³•ï¼‰ï¼Œç¼–å†™æµ‹è¯•ä»£ç å¯¹å…¶è¿›è¡Œæ­£ç¡®æ€§æµ‹è¯•ã€‚ Junitå•å…ƒæµ‹è¯•æ¡†æ¶\nå¯ä»¥ç”¨æ¥å¯¹æ–¹æ³•è¿›è¡Œæµ‹è¯•ï¼Œæ˜¯ç¬¬ä¸‰æ–¹å…¬å¸å¼€æºå‡ºæ¥çš„ ä¼˜ç‚¹\nå¯ä»¥çµæ´»çš„ç¼–å†™æµ‹è¯•ä»£ç ï¼Œå¯ä»¥é’ˆå¯¹æŸä¸ªæ–¹æ³•æ‰§è¡Œæµ‹è¯•ï¼Œä¹Ÿæ”¯æŒä¸€é”®å®Œæˆå¯¹å…¨éƒ¨æ–¹æ³•çš„è‡ªåŠ¨åŒ–æµ‹è¯•ï¼Œä¸”å„è‡ªç‹¬ç«‹ ä¸éœ€è¦ç¨‹åºå‘˜å»åˆ†ææµ‹è¯•çš„ç»“æœï¼Œä¼šè‡ªåŠ¨ç”Ÿæˆæµ‹è¯•æŠ¥å‘Š /** * StringUtilTest ç±»æ˜¯ç”¨äºæµ‹è¯• StringUtil ç±»ä¸­å„ä¸ªæ–¹æ³•çš„æµ‹è¯•ç±»ã€‚ * ä¸»è¦æµ‹è¯•äº† StringUtil ç±»ä¸­ printNumber() å’Œ getMaxIndex() æ–¹æ³•çš„åŠŸèƒ½å’Œæ­£ç¡®æ€§ã€‚ * * æµ‹è¯•æ–¹æ³•è¯´æ˜ï¼š * - testprintNumber(): æµ‹è¯• printNumber() æ–¹æ³•ï¼ŒéªŒè¯å…¶å¯¹è¾“å…¥å­—ç¬¦ä¸²çš„å¤„ç†æ˜¯å¦æ­£ç¡®ã€‚ * - testGetMaxIndex(): æµ‹è¯• getMaxIndex() æ–¹æ³•ï¼ŒéªŒè¯å…¶è¿”å›å­—ç¬¦ä¸²ä¸­æœ€å¤§å­—æ¯çš„ç´¢å¼•æ˜¯å¦æ­£ç¡®ã€‚ * * æµ‹è¯•ç”Ÿå‘½å‘¨æœŸæ³¨è§£è¯´æ˜ï¼š * - @BeforeClass: åœ¨è¯¥æµ‹è¯•ç±»çš„æ‰€æœ‰æµ‹è¯•æ–¹æ³•æ‰§è¡Œä¹‹å‰æ‰§è¡Œï¼Œç”¨äºåˆå§‹åŒ–é™æ€èµ„æºæˆ–æ‰§è¡Œä¸€æ¬¡æ€§è®¾ç½®ã€‚ * - test11(): æµ‹è¯• BeforeClass ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼Œç”¨äºæ‰“å° BeforeClass æ‰§è¡Œä¿¡æ¯ã€‚ * * - @Before: åœ¨æ¯ä¸ªæµ‹è¯•æ–¹æ³•æ‰§è¡Œä¹‹å‰æ‰§è¡Œï¼Œç”¨äºå‡†å¤‡æµ‹è¯•ç¯å¢ƒæˆ–æ‰§è¡ŒæŸäº›é¢„å¤„ç†æ“ä½œã€‚ * - test1(): æµ‹è¯• Before ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼Œç”¨äºæ‰“å° Before æ‰§è¡Œä¿¡æ¯ã€‚ * * - @Test: è¡¨ç¤ºè¯¥æ–¹æ³•æ˜¯ä¸€ä¸ªæµ‹è¯•æ–¹æ³•ã€‚ * - testprintNumber(): æµ‹è¯• printNumber() æ–¹æ³•ï¼ŒéªŒè¯å…¶åŠŸèƒ½æ˜¯å¦æ­£ç¡®ã€‚ * - testGetMaxIndex(): æµ‹è¯• getMaxIndex() æ–¹æ³•ï¼ŒéªŒè¯å…¶åŠŸèƒ½å’Œè¿”å›å€¼æ˜¯å¦æ­£ç¡®ã€‚ * * - @After: åœ¨æ¯ä¸ªæµ‹è¯•æ–¹æ³•æ‰§è¡Œä¹‹åæ‰§è¡Œï¼Œç”¨äºæ¸…ç†æµ‹è¯•ç¯å¢ƒæˆ–æ‰§è¡ŒæŸäº›æ”¶å°¾æ“ä½œã€‚ * - test2(): æµ‹è¯• After ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼Œç”¨äºæ‰“å° After æ‰§è¡Œä¿¡æ¯ã€‚ * * - @AfterClass: åœ¨è¯¥æµ‹è¯•ç±»çš„æ‰€æœ‰æµ‹è¯•æ–¹æ³•æ‰§è¡Œä¹‹åæ‰§è¡Œï¼Œç”¨äºæ‰§è¡Œæ¸…ç†æ“ä½œæˆ–é‡Šæ”¾èµ„æºã€‚ * - test22(): æµ‹è¯• AfterClass ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼Œç”¨äºæ‰“å° AfterClass æ‰§è¡Œä¿¡æ¯ã€‚ * * å…¶ä»–è¯´æ˜ï¼š * - ä½¿ç”¨æ–­è¨€æœºåˆ¶éªŒè¯ getMaxIndex() æ–¹æ³•çš„æ­£ç¡®æ€§ã€‚ * - åœ¨ testGetMaxIndex() æ–¹æ³•ä¸­ï¼Œä½¿ç”¨ Assert.assertEquals() æ–­è¨€æ–¹æ³•ï¼Œå¯¹æ¯”é¢„æœŸè¿”å›å€¼å’Œå®é™…è¿”å›å€¼æ˜¯å¦ç›¸ç­‰ã€‚ */ public class StringUtilTest { /** * åœ¨æ‰€æœ‰æµ‹è¯•æ–¹æ³•æ‰§è¡Œä¹‹å‰æ‰§è¡Œçš„é™æ€æ–¹æ³•ï¼Œç”¨äºåˆå§‹åŒ–é™æ€èµ„æºæˆ–æ‰§è¡Œä¸€æ¬¡æ€§è®¾ç½®ã€‚ */ @BeforeClass public static void test11() { System.out.println(\u0026#34;---test11 beforeClass æ‰§è¡Œäº†---\u0026#34;); } /** * åœ¨æ¯ä¸ªæµ‹è¯•æ–¹æ³•æ‰§è¡Œä¹‹å‰æ‰§è¡Œçš„æ–¹æ³•ï¼Œç”¨äºå‡†å¤‡æµ‹è¯•ç¯å¢ƒæˆ–æ‰§è¡ŒæŸäº›é¢„å¤„ç†æ“ä½œã€‚ */ @Before public void test1() { System.out.println(\u0026#34;---test1 before æ‰§è¡Œäº†---\u0026#34;); } /** * æµ‹è¯• printNumber() æ–¹æ³•ï¼ŒéªŒè¯å…¶å¯¹è¾“å…¥å­—ç¬¦ä¸²çš„å¤„ç†æ˜¯å¦æ­£ç¡®ã€‚ */ @Test public void testprintNumber() { StringUtil.printNumber(\u0026#34;abcdefg\u0026#34;); StringUtil.printNumber(null); } /** * æµ‹è¯• getMaxIndex() æ–¹æ³•ï¼ŒéªŒè¯å…¶è¿”å›å­—ç¬¦ä¸²ä¸­æœ€å¤§å­—æ¯çš„ç´¢å¼•æ˜¯å¦æ­£ç¡®ã€‚ */ @Test public void testGetMaxIndex() { int idx1 = StringUtil.getMaxIndex(\u0026#34;abcdefg\u0026#34;); System.out.println(idx1); int idx2 = StringUtil.getMaxIndex(null); System.out.println(idx2); // æ–­è¨€æœºåˆ¶ Assert.assertEquals(\u0026#34;æ–¹æ³•å†…éƒ¨æœ‰bug\u0026#34;, 6, idx1); } /** * åœ¨æ¯ä¸ªæµ‹è¯•æ–¹æ³•æ‰§è¡Œä¹‹åæ‰§è¡Œçš„æ–¹æ³•ï¼Œç”¨äºæ¸…ç†æµ‹è¯•ç¯å¢ƒæˆ–æ‰§è¡ŒæŸäº›æ”¶å°¾æ“ä½œã€‚ */ @After public void test2() { System.out.println(\u0026#34;---test2 after æ‰§è¡Œäº†---\u0026#34;); } /** * åœ¨æ‰€æœ‰æµ‹è¯•æ–¹æ³•æ‰§è¡Œä¹‹åæ‰§è¡Œçš„é™æ€æ–¹æ³•ï¼Œç”¨äºæ‰§è¡Œæ¸…ç†æ“ä½œæˆ–é‡Šæ”¾èµ„æºã€‚ */ @AfterClass public static void test22() { System.out.println(\u0026#34;---test22 afterClass æ‰§è¡Œäº†---\u0026#34;); } } åœ¨æµ‹è¯•æ–¹æ³•æ‰§è¡Œå‰æ‰§è¡Œçš„æ–¹æ³•ï¼šå¸¸ç”¨äºï¼šåˆå§‹åŒ–èµ„æº åœ¨æµ‹è¯•æ–¹æ³•æ‰§è¡Œå®Œåå†æ‰§è¡Œçš„æ–¹æ³•ï¼Œå¸¸ç”¨äºï¼šé‡Šæ”¾èµ„æº åœ¨Junit 5.xxxxç‰ˆæœ¬\n@Before-\u0026gt;@BeforeEach @After-\u0026gt;@AfterEach @BeforeClass-\u0026gt;@BeforeAll @AfterClass-\u0026gt;@AfterAll åå°„(Reflection) åå°„ï¼šåŠ è½½ç±»ï¼Œå¹¶å…è®¸ä»¥ç¼–ç¨‹çš„æ–¹å¼è§£å‰–ç±»ä¸­çš„å„ç§æˆåˆ†ï¼ˆæˆå‘˜å˜é‡ï¼Œæ–¹æ³•ï¼Œæ„é€ å™¨ç­‰ï¼‰ 1.åŠ è½½ç±» public class Test1Class { public static void main(String[] args) throws Exception { // 1. ç›´æ¥é€šè¿‡ç±»åè·å– Class å¯¹è±¡ Class c1 = String.class; System.out.println(c1.getName()); System.out.println(c1.getSimpleName()); // 2. é€šè¿‡ Class.forName() æ–¹æ³•æ ¹æ®ç±»çš„å…¨é™å®šåè·å– Class å¯¹è±¡ Class c2 = Class.forName(\u0026#34;com.showguan.reflect_demo.Student\u0026#34;); System.out.println(c1 == c2); // 3. é€šè¿‡å®ä¾‹å¯¹è±¡çš„ getClass() æ–¹æ³•è·å– Class å¯¹è±¡ Student s = new Student(); Class c3 = s.getClass(); System.out.println(c1 == c3); } } 2.è·å–æ„é€ å™¨ public class Test2Constructor { /** * è·å–ç±»çš„æ‰€æœ‰å…¬å…±æ„é€ æ–¹æ³•å¹¶è¾“å‡ºæ„é€ æ–¹æ³•çš„åç§°å’Œå‚æ•°ä¸ªæ•°ã€‚ */ @Test public void testGetConstructors(){ Class c = Cat.class; Constructor[] constructors = c.getConstructors(); for (Constructor constructor : constructors) { System.out.println(constructor.getName() + \u0026#34;---\u0026gt;\u0026#34; + constructor.getParameterCount()); } } /** * è·å–æŒ‡å®šæ„é€ æ–¹æ³•å¹¶é€šè¿‡ newInstance() æ–¹æ³•åˆ›å»ºå¯¹è±¡ã€‚ * ä½¿ç”¨ setAccessible(true) æ–¹æ³•è§£é™¤ç§æœ‰æ„é€ æ–¹æ³•çš„è®¿é—®é™åˆ¶ã€‚ */ @Test public void testGetConstructor() throws Exception { Class c = Cat.class; // è·å–æ— å‚æ„é€ æ–¹æ³• Constructor constructor = c.getDeclaredConstructor(); System.out.println(constructor.getName() + \u0026#34; \u0026#34; + constructor.getParameterCount()); constructor.setAccessible(true); Cat cat = (Cat) constructor.newInstance(); System.out.println(cat); // è·å–å¸¦å‚æ•°çš„æ„é€ æ–¹æ³• Constructor constructor1 = c.getDeclaredConstructor(String.class, int.class); System.out.println(constructor1.getName() + \u0026#34; \u0026#34; + constructor1.getParameterCount()); constructor1.setAccessible(true); Cat cat1 = (Cat) constructor1.newInstance(\u0026#34;å¥¶ç‰›çŒ«\u0026#34;, 3); System.out.println(cat1); } } 3.è·å–æˆå‘˜å˜é‡ public class Test4Field { /** * è·å–ç±»çš„æ‰€æœ‰å­—æ®µä¿¡æ¯ï¼Œå¹¶æ¼”ç¤ºäº†å¦‚ä½•æ“ä½œç±»çš„å­—æ®µã€‚ */ @Test public void testGetFields() throws Exception { Class c = Cat.class; // è·å–ç±»çš„æ‰€æœ‰å­—æ®µä¿¡æ¯å¹¶è¾“å‡ºå­—æ®µåå’Œç±»å‹ Field[] fields = c.getDeclaredFields(); for (Field field : fields) { System.out.println(field.getName() + \u0026#34;---\u0026gt;\u0026#34; + field.getType()); } // å®šä½åˆ°ç‰¹å®šæˆå‘˜å˜é‡ Field fAge = c.getDeclaredField(\u0026#34;age\u0026#34;); System.out.println(fAge.getName() + \u0026#34;---\u0026gt;\u0026#34; + fAge.getType()); Field fName = c.getDeclaredField(\u0026#34;name\u0026#34;); System.out.println(fName.getName() + \u0026#34;---\u0026gt;\u0026#34; + fName.getType()); // åˆ›å»º Cat å¯¹è±¡ï¼Œå¹¶é€šè¿‡åå°„æ“ä½œå­—æ®µ Cat cat = new Cat(); fName.setAccessible(true); // è®¾ç½®ç§æœ‰å­—æ®µå¯è®¿é—® fName.set(cat, \u0026#34;å¥¶ç‰›çŒ«\u0026#34;); // è®¾ç½®å­—æ®µå€¼ String name = (String) fName.get(cat); // è·å–å­—æ®µå€¼ System.out.println(name); } } 4.è·å–ç±»æ–¹æ³• public class Test4Method { /** * è·å–ç±»çš„æ‰€æœ‰æ–¹æ³•ä¿¡æ¯ï¼Œå¹¶æ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡åå°„è°ƒç”¨ç±»çš„æ–¹æ³•ã€‚ */ @Test public void testGetMethods() throws Exception { Class c = Cat.class; // è·å–ç±»çš„æ‰€æœ‰æ–¹æ³•ä¿¡æ¯å¹¶è¾“å‡ºæ–¹æ³•åã€å‚æ•°ä¸ªæ•°å’Œè¿”å›ç±»å‹ Method[] methods = c.getDeclaredMethods(); for (Method method : methods) { System.out.println(method.getName() + \u0026#34;---\u0026gt;\u0026#34; + method.getParameterCount() + \u0026#34;---\u0026gt;\u0026#34; + method.getReturnType()); } // è·å–ç‰¹å®šæ–¹æ³•ä¿¡æ¯å¹¶è¾“å‡º Method run = c.getDeclaredMethod(\u0026#34;run\u0026#34;); System.out.println(run.getName() + \u0026#34;---\u0026gt;\u0026#34; + run.getParameterCount() + \u0026#34;---\u0026gt;\u0026#34; + run.getReturnType()); Method eat = c.getDeclaredMethod(\u0026#34;eat\u0026#34;, String.class); System.out.println(eat.getName() + \u0026#34;---\u0026gt;\u0026#34; + eat.getParameterCount() + \u0026#34;---\u0026gt;\u0026#34; + eat.getReturnType()); // åˆ›å»º Cat å¯¹è±¡ï¼Œå¹¶é€šè¿‡åå°„è°ƒç”¨æ–¹æ³• Cat cat = new Cat(); run.setAccessible(true); // è®¾ç½®ç§æœ‰æ–¹æ³•å¯è®¿é—® Object invoke = run.invoke(cat); // è°ƒç”¨æ–¹æ³• System.out.println(invoke); eat.setAccessible(true); // è®¾ç½®ç§æœ‰æ–¹æ³•å¯è®¿é—® Object invoke1 = eat.invoke(cat, \u0026#34;é±¼é¥¼å¹²\u0026#34;); // è°ƒç”¨æ–¹æ³• System.out.println(invoke1); } } æ¡ˆä¾‹ public class ObjectFrame { /** * å°†å¯¹è±¡ä¿¡æ¯ä¿å­˜åˆ°æ–‡ä»¶ã€‚ * * @param obj è¦ä¿å­˜ä¿¡æ¯çš„å¯¹è±¡ * @throws Exception å¯èƒ½æŠ›å‡ºçš„å¼‚å¸¸ */ public static void saveObject(Object obj) throws Exception { // åˆ›å»º PrintStream å¯¹è±¡ï¼Œç”¨äºå†™å…¥æ–‡ä»¶ PrintStream ps = new PrintStream(new FileOutputStream(\u0026#34;junit-reflect-annotation-proxy-app\\\\src\\\\com\\\\showguan\\\\reflect_demo\\\\data.txt\u0026#34;, true)); Class c = obj.getClass(); String cName = c.getSimpleName(); ps.println(\u0026#34;--------------\u0026#34; + cName + \u0026#34;-----------------\u0026#34;); // è·å–å¯¹è±¡çš„æ‰€æœ‰å­—æ®µä¿¡æ¯ï¼Œå¹¶å†™å…¥æ–‡ä»¶ Field[] fields = c.getDeclaredFields(); for (Field field : fields) { String name = field.getName(); field.setAccessible(true); // è®¾ç½®å­—æ®µå¯è®¿é—® String value = field.get(obj) + \u0026#34;\u0026#34;; // è·å–å­—æ®µå€¼ ps.println(name + \u0026#34; \u0026#34; + value); } ps.close(); // å…³é—­æµ } } /** * Test5 ç±»æ˜¯ä¸€ä¸ªç”¨äºæµ‹è¯• ObjectFrame ç±»çš„ä¸»ç¨‹åºã€‚ * ä¸»è¦åˆ›å»ºäº†ä¸€ä¸ª Student å¯¹è±¡å’Œä¸€ä¸ª Teacher å¯¹è±¡ï¼Œå¹¶å°†å®ƒä»¬çš„ä¿¡æ¯ä¿å­˜åˆ°æ–‡ä»¶ä¸­ã€‚ */ package com.showguan.reflect_demo; public class Test5 { public static void main(String[] args) throws Exception{ // åˆ›å»º Student å¯¹è±¡å’Œ Teacher å¯¹è±¡ Student s1 = new Student(\u0026#34;Kennem\u0026#34;, \u0026#39;ç”·\u0026#39;, 21, 181.2, \u0026#34;lelele\u0026#34;); Teacher t1 = new Teacher(\u0026#34;tytytyt\u0026#34;, 21000); // å°†å¯¹è±¡ä¿¡æ¯ä¿å­˜åˆ°æ–‡ä»¶ä¸­ ObjectFrame.saveObject(s1); ObjectFrame.saveObject(t1); } } æ³¨è§£ï¼ˆAnnotationï¼‰ å°±æ˜¯Javaä»£ç é‡Œçš„ç‰¹æ®Šæ ‡è®°ï¼Œæ¯”å¦‚@Override, @Testç­‰ï¼Œä½œç”¨æ˜¯ï¼šè®©å…¶ä»–ç¨‹åºæ ¹æ®æ³¨è§£ä¿¡æ¯æ¥å†³å®šæ€ä¹ˆæ‰§è¡Œè¯¥ç¨‹åº æ³¨æ„ï¼šæ³¨è§£å¯ä»¥ç”¨åœ¨ç±»ä¸Šï¼Œæ„é€ å™¨ä¸Šï¼Œæ–¹æ³•ä¸Šï¼Œæˆå‘˜å˜é‡ä¸Šï¼Œå‚æ•°ä¸Šï¼Œç­‰ä½ç½® è‡ªå®šä¹‰æ³¨è§£ /** * MyTest1 æ³¨è§£æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰æ³¨è§£ï¼Œå…·æœ‰ä¸‰ä¸ªå±æ€§ï¼š * - aï¼šå­—ç¬¦ä¸²ç±»å‹å±æ€§ã€‚ * - bï¼šå¸ƒå°”ç±»å‹å±æ€§ï¼Œé»˜è®¤å€¼ä¸º trueã€‚ * - cï¼šå­—ç¬¦ä¸²æ•°ç»„ç±»å‹å±æ€§ã€‚ */ package com.showguan.annotation_demo; public @interface MyTest1 { String a(); boolean b() default true; String[] c(); } /** * MyTest2 æ³¨è§£æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰æ³¨è§£ï¼Œå…·æœ‰ä¸¤ä¸ªå±æ€§ï¼š * - valueï¼šå­—ç¬¦ä¸²ç±»å‹å±æ€§ã€‚ * - ageï¼šæ•´æ•°ç±»å‹å±æ€§ï¼Œé»˜è®¤å€¼ä¸º 23ã€‚ * å¦‚æœæ³¨è§£ä¸­åªæœ‰ä¸€ä¸ª value å±æ€§ï¼Œä½¿ç”¨æ³¨è§£æ—¶ï¼Œvalue åç§°å¯ä»¥ä¸å†™ã€‚ */ package com.showguan.annotation_demo; public @interface MyTest2 { // ç‰¹æ®Šå±æ€§å // å¦‚æœæ³¨è§£ä¸­åªæœ‰ä¸€ä¸ªvalueå±æ€§ï¼Œä½¿ç”¨æ³¨è§£æ—¶ï¼Œvalueåç§°å¯ä»¥ä¸å†™ String value(); int age() default 23; } /** * AnnotationTest1 ç±»æ˜¯ä¸€ä¸ªæ¼”ç¤ºæ³¨è§£çš„ä½¿ç”¨çš„ç¤ºä¾‹ç¨‹åºã€‚ * ä½¿ç”¨äº† MyTest1 å’Œ MyTest2 ä¸¤ä¸ªè‡ªå®šä¹‰æ³¨è§£ã€‚ */ package com.showguan.annotation_demo; @MyTest1(a=\u0026#34;Kennem\u0026#34;, c={\u0026#34;HTML\u0026#34;, \u0026#34;CSS\u0026#34;}) public class AnnotationTest1 { /** * ä½¿ç”¨äº† MyTest1 æ³¨è§£ï¼Œå¹¶æŒ‡å®šäº†å„å±æ€§çš„å€¼ã€‚ */ @MyTest1(a=\u0026#34;tytyt\u0026#34;, b=false, c={\u0026#34;python\u0026#34;, \u0026#34;c++\u0026#34;}) public static void main(String[] args) { } /** * ä½¿ç”¨äº† MyTest2 æ³¨è§£ï¼Œå¹¶æŒ‡å®šäº† value å±æ€§çš„å€¼ã€‚ */ @MyTest2(\u0026#34;value\u0026#34;) public static void test1(){ } } å…ƒæ³¨è§£ ä¿®é¥°æ³¨è§£çš„æ³¨è§£ /** * MyTest3 æ³¨è§£æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰æ³¨è§£ï¼Œç”¨äºæ ‡è®°ç±»ã€æ–¹æ³•å’Œå­—æ®µã€‚ * å®ƒå…·æœ‰ä»¥ä¸‹ç‰¹æ€§ï¼š * - @Target({ElementType.TYPE, ElementType.METHOD, ElementType.FIELD})ï¼šæŒ‡å®šè¯¥æ³¨è§£å¯ä»¥ç”¨äºç±»ã€æ–¹æ³•å’Œå­—æ®µä¸Šã€‚ * - @Retention(RetentionPolicy.RUNTIME)ï¼šå£°æ˜æ³¨è§£çš„ä¿ç•™å‘¨æœŸä¸ºè¿è¡Œæ—¶ï¼Œä½¿å¾—è¯¥æ³¨è§£åœ¨è¿è¡Œæ—¶å¯ä»¥é€šè¿‡åå°„è·å–åˆ°ã€‚ */ package com.showguan.annotation_demo; import java.lang.annotation.ElementType; import java.lang.annotation.Retention; import java.lang.annotation.RetentionPolicy; import java.lang.annotation.Target; @Target({ElementType.TYPE, ElementType.METHOD, ElementType.FIELD}) @Retention(RetentionPolicy.RUNTIME) public @interface MyTest3 { } /** * AnnotationTest2 ç±»æ˜¯ä¸€ä¸ªæ¼”ç¤ºæ³¨è§£çš„ä½¿ç”¨çš„ç¤ºä¾‹ç¨‹åºã€‚ * ä½¿ç”¨äº† MyTest3 æ³¨è§£ï¼Œå¹¶æ ‡è®°äº†ç±»ã€å­—æ®µå’Œæ–¹æ³•ã€‚ */ package com.showguan.annotation_demo; import org.junit.Test; @MyTest3 public class AnnotationTest2 { /** * ä½¿ç”¨äº† MyTest3 æ³¨è§£ï¼Œæ ‡è®°äº†å­—æ®µã€‚ */ @MyTest3 private int test; /** * ä½¿ç”¨äº† MyTest3 æ³¨è§£ï¼Œæ ‡è®°äº†æ–¹æ³•ã€‚ */ @MyTest3 @Test public void m() { } } æ³¨è§£çš„è§£æ\nå°±æ˜¯åˆ¤æ–­ç±»ä¸Šï¼Œæ–¹æ³•ä¸Šï¼Œæˆå‘˜å˜é‡ä¸Šæ˜¯å¦å­˜åœ¨æ³¨è§£ï¼Œå¹¶æŠŠæ³¨è§£é‡Œçš„å†…å®¹ç»™è§£æå‡ºæ¥ è§£ææ³¨è§£ package com.showguan.annotation_demo; import java.lang.annotation.ElementType; import java.lang.annotation.Retention; import java.lang.annotation.RetentionPolicy; import java.lang.annotation.Target; // å®šä¹‰ä¸€ä¸ªè‡ªå®šä¹‰æ³¨è§£ MyTest4 @Target({ElementType.TYPE, ElementType.METHOD}) // å¯ä»¥æ ‡è®°åœ¨ç±»å’Œæ–¹æ³•ä¸Š @Retention(RetentionPolicy.RUNTIME) // æ³¨è§£ä¿¡æ¯åœ¨è¿è¡Œæ—¶ä¿ç•™ public @interface MyTest4 { String value(); // å£°æ˜ä¸€ä¸ªå±æ€§ valueï¼Œç±»å‹ä¸º String double aaa() default 100; // å£°æ˜ä¸€ä¸ªå±æ€§ aaaï¼Œç±»å‹ä¸º doubleï¼Œé»˜è®¤å€¼ä¸º 100 String[] bbb(); // å£°æ˜ä¸€ä¸ªå±æ€§ bbbï¼Œç±»å‹ä¸º String æ•°ç»„ } package com.showguan.annotation_demo; // ä½¿ç”¨è‡ªå®šä¹‰æ³¨è§£ MyTest4 æ ‡è®°ç±»å’Œæ–¹æ³• @MyTest4(value = \u0026#34;Kennem\u0026#34;, aaa = 10.0, bbb = {\u0026#34;è‡³å°Šå®\u0026#34;, \u0026#34;tytt\u0026#34;}) public class Demo { // ä½¿ç”¨è‡ªå®šä¹‰æ³¨è§£ MyTest4 æ ‡è®°æ–¹æ³• @MyTest4(value = \u0026#34;yl\u0026#34;, aaa = 199.2, bbb = {\u0026#34;best\u0026#34;, \u0026#34;ç‰›å¤«äºº\u0026#34;}) public void test1(){ } } package com.showguan.annotation_demo; import org.junit.Test; import java.lang.annotation.Annotation; import java.lang.reflect.Method; import java.util.Arrays; // æµ‹è¯•è§£æè‡ªå®šä¹‰æ³¨è§£ MyTest4 public class AnnotationTest3 { // è§£æç±»ä¸Šçš„è‡ªå®šä¹‰æ³¨è§£ @Test public void parseClass(){ Class c = Demo.class; if(c.isAnnotationPresent(MyTest4.class)){ MyTest4 myTest4 = (MyTest4) c.getDeclaredAnnotation(MyTest4.class); System.out.println(myTest4.value()); System.out.println(myTest4.aaa()); System.out.println(Arrays.toString(myTest4.bbb())); } } // è§£ææ–¹æ³•ä¸Šçš„è‡ªå®šä¹‰æ³¨è§£ @Test public void parseMethod() throws Exception{ Class c = Demo.class; Method m = c.getDeclaredMethod(\u0026#34;test1\u0026#34;); if(m.isAnnotationPresent(MyTest4.class)){ MyTest4 myTest4 = (MyTest4) m.getDeclaredAnnotation(MyTest4.class); System.out.println(myTest4.value()); System.out.println(myTest4.aaa()); System.out.println(Arrays.toString(myTest4.bbb())); } } } æ¨¡æ‹ŸJunitæ¡†æ¶ package com.showguan.annotation_demo; import java.lang.annotation.ElementType; import java.lang.annotation.Retention; import java.lang.annotation.RetentionPolicy; import java.lang.annotation.Target; // å®šä¹‰ä¸€ä¸ªè‡ªå®šä¹‰æ³¨è§£ MyTestï¼Œç”¨äºæ ‡è®°æ–¹æ³• @Target(ElementType.METHOD) // å¯ä»¥æ ‡è®°åœ¨æ–¹æ³•ä¸Š @Retention(RetentionPolicy.RUNTIME) // æ³¨è§£ä¿¡æ¯åœ¨è¿è¡Œæ—¶ä¿ç•™ public @interface MyTest { } package com.showguan.annotation_demo; import org.junit.Test; import java.lang.reflect.InvocationTargetException; import java.lang.reflect.Method; // æµ‹è¯•è‡ªå®šä¹‰æ³¨è§£ MyTest public class AnnotationTest4 { // æ ‡è®°ä¸º MyTest çš„æ–¹æ³• @MyTest public void test1(){ System.out.println(\u0026#34;---test1---\u0026#34;); } // æ ‡è®°ä¸º MyTest çš„æ–¹æ³• @MyTest public void test2(){ System.out.println(\u0026#34;---test2---\u0026#34;); } // æ²¡æœ‰æ ‡è®°ä¸º MyTest çš„æ–¹æ³• public void test3(){ System.out.println(\u0026#34;---test3---\u0026#34;); } // æ²¡æœ‰æ ‡è®°ä¸º MyTest çš„æ–¹æ³• public void test4(){ System.out.println(\u0026#34;---test4---\u0026#34;); } // ä¸»æ–¹æ³•ç”¨äºè¿è¡Œæµ‹è¯•æ ‡è®°ä¸º MyTest çš„æ–¹æ³• public static void main(String[] args) throws Exception{ AnnotationTest4 a = new AnnotationTest4(); Class c = AnnotationTest4.class; Method[] methods = c.getDeclaredMethods(); for (Method method : methods) { if(method.isAnnotationPresent(MyTest.class)){ method.invoke(a); // è°ƒç”¨æ ‡è®°ä¸º MyTest çš„æ–¹æ³• } } } } åŠ¨æ€ä»£ç† Proxyç±» package com.showguan.proxy_demo; import java.lang.reflect.InvocationHandler; import java.lang.reflect.Method; import java.lang.reflect.Proxy; // ä»£ç†æ¨¡å¼ç¤ºä¾‹ public class ProxyUtil { // åˆ›å»ºä»£ç†å¯¹è±¡çš„æ–¹æ³• public static Star createProxy(BigStar bigStar) { // ä½¿ç”¨Javaçš„åŠ¨æ€ä»£ç†åˆ›å»ºä»£ç†å¯¹è±¡ Star starProxy = (Star) Proxy.newProxyInstance( ProxyUtil.class.getClassLoader(), // ä½¿ç”¨å½“å‰ç±»çš„ç±»åŠ è½½å™¨åŠ è½½ä»£ç†ç±» new Class[]{Star.class}, // æŒ‡å®šä»£ç†å¯¹è±¡å®ç°çš„æ¥å£ï¼Œè¿™é‡Œæ˜¯Staræ¥å£ new InvocationHandler() { // è®¾ç½®ä»£ç†å¯¹è±¡çš„è°ƒç”¨å¤„ç†å™¨ï¼Œå³InvocationHandler @Override public Object invoke(Object proxy, Method method, Object[] args) throws Throwable { /** * Object proxyï¼šä»£ç†å¯¹è±¡ï¼Œç”¨äºè°ƒç”¨è¢«ä»£ç†å¯¹è±¡çš„æ–¹æ³•æˆ–æ‰§è¡Œå…¶ä»–æ“ä½œã€‚ * Method methodï¼šè¡¨ç¤ºè¢«è°ƒç”¨çš„æ–¹æ³•ï¼Œå…è®¸è·å–æ–¹æ³•çš„ç›¸å…³ä¿¡æ¯æˆ–è°ƒç”¨è¯¥æ–¹æ³•ã€‚ * Object[] argsï¼šæ–¹æ³•çš„å‚æ•°æ•°ç»„ï¼ŒåŒ…å«äº†è¢«è°ƒç”¨æ–¹æ³•çš„å‚æ•°åˆ—è¡¨ï¼Œå…è®¸è·å–å’Œå¤„ç†å‚æ•°ã€‚ */ // å¯¹ä»£ç†å¯¹è±¡çš„æ–¹æ³•è¿›è¡Œæ‹¦æˆªå’Œå¢å¼º if (method.getName().equals(\u0026#34;sing\u0026#34;)) { // å¦‚æœæ˜¯singæ–¹æ³• System.out.println(\u0026#34;å‡†å¤‡è¯ç­’ï¼Œæ”¶é’±20ä¸‡\u0026#34;); // å¢å¼ºå¤„ç†ï¼šå‡†å¤‡è¯ç­’ return method.invoke(bigStar, args); // è°ƒç”¨åŸå§‹å¯¹è±¡çš„æ–¹æ³• } else if (method.getName().equals(\u0026#34;dance\u0026#34;)) { // å¦‚æœæ˜¯danceæ–¹æ³• System.out.println(\u0026#34;å‡†å¤‡åœºåœ°ï¼Œæ”¶é’±1000ä¸‡\u0026#34;); // å¢å¼ºå¤„ç†ï¼šå‡†å¤‡åœºåœ° return method.invoke(bigStar, args); // è°ƒç”¨åŸå§‹å¯¹è±¡çš„æ–¹æ³• } return method.invoke(bigStar, args); // å¯¹äºå…¶ä»–æ–¹æ³•ï¼Œç›´æ¥è°ƒç”¨åŸå§‹å¯¹è±¡çš„æ–¹æ³• } }); return starProxy; // è¿”å›åˆ›å»ºçš„ä»£ç†å¯¹è±¡ } } Staræ¥å£ package com.showguan.proxy_demo; // æ˜æ˜Ÿæ¥å£ï¼Œå®šä¹‰äº†å”±æ­Œå’Œè·³èˆçš„æ–¹æ³• public interface Star { String sing(String name); // å”±æ­Œæ–¹æ³•ï¼Œä¼ å…¥æ­Œæ›²åå­—ï¼Œè¿”å›æ„Ÿè°¢ä¿¡æ¯ void dance(); // è·³èˆæ–¹æ³• } BigStarç±» package com.showguan.proxy_demo; // å…·ä½“çš„æ˜æ˜Ÿç±»ï¼Œå®ç°äº†Staræ¥å£ public class BigStar implements Star { private String name; // æ˜æ˜Ÿçš„å§“å // æ„é€ æ–¹æ³•ï¼Œä¼ å…¥æ˜æ˜Ÿçš„å§“å public BigStar(String name) { this.name = name; } // è·å–æ˜æ˜Ÿå§“åçš„æ–¹æ³• public String getName() { return name; } // è®¾ç½®æ˜æ˜Ÿå§“åçš„æ–¹æ³• public void setName(String name) { this.name = name; } // å®ç°å”±æ­Œæ–¹æ³•ï¼Œä¼ å…¥æ­Œæ›²åå­—ï¼Œæ‰“å°å‡ºæ­Œæ‰‹åå­—å’Œæ­Œæ›²åå­—ï¼Œå¹¶è¿”å›æ„Ÿè°¢ä¿¡æ¯ @Override public String sing(String name) { System.out.println(this.name + \u0026#34;æ­£åœ¨å”±æ­Œ:\u0026#34; + name); return \u0026#34;æ„Ÿè°¢å¤§å®¶\u0026#34;; } // å®ç°è·³èˆæ–¹æ³•ï¼Œæ‰“å°å‡ºæ­Œæ‰‹åå­—å¹¶æç¤ºæ­£åœ¨è·³èˆ @Override public void dance() { System.out.println(this.name + \u0026#34;æ­£åœ¨ä¼˜ç¾çš„è·³èˆ\u0026#34;); } } Testç±» package com.showguan.proxy_demo; // æµ‹è¯•ç±» public class Test { public static void main(String[] args) { BigStar s = new BigStar(\u0026#34;ycy\u0026#34;); // åˆ›å»ºä¸€ä¸ªå…·ä½“çš„æ˜æ˜Ÿå¯¹è±¡ Star starProxy = ProxyUtil.createProxy(s); // ä½¿ç”¨ä»£ç†å·¥å…·ç±»åˆ›å»ºä»£ç†å¯¹è±¡ String rs = starProxy.sing(\u0026#34;å¡è·¯é‡Œ\u0026#34;); // è°ƒç”¨ä»£ç†å¯¹è±¡çš„å”±æ­Œæ–¹æ³• System.out.println(rs); // æ‰“å°å”±æ­Œæ–¹æ³•çš„è¿”å›å€¼ starProxy.dance(); // è°ƒç”¨ä»£ç†å¯¹è±¡çš„è·³èˆæ–¹æ³• } } ä½¿ç”¨æ¡ˆä¾‹ æ¥å£ package com.showguan.proxy_demo2; // ç”¨æˆ·æœåŠ¡æ¥å£ï¼Œå®šä¹‰äº†ç™»å½•ã€åˆ é™¤ç”¨æˆ·å’ŒæŸ¥è¯¢ç”¨æˆ·çš„æ–¹æ³• public interface UserService { void login(String loginName, String passWrod) throws Exception; // ç™»å½•æ–¹æ³•ï¼Œä¼ å…¥ç™»å½•åå’Œå¯†ç  void deleteUsers() throws Exception; // åˆ é™¤ç”¨æˆ·æ–¹æ³• String[] selectUsers() throws Exception; // æŸ¥è¯¢ç”¨æˆ·æ–¹æ³•ï¼Œè¿”å›ç”¨æˆ·æ•°ç»„ } æ¥å£å®ç° package com.showguan.proxy_demo2; // ç”¨æˆ·æœåŠ¡å®ç°ç±»ï¼Œå®ç°äº†UserServiceæ¥å£ public class UserServiceImpl implements UserService { // å®ç°ç™»å½•æ–¹æ³•ï¼ŒéªŒè¯ç”¨æˆ·åå¯†ç å¹¶è¾“å‡ºç™»å½•æˆåŠŸæˆ–å¤±è´¥ä¿¡æ¯ @Override public void login(String loginName, String passWrod) throws Exception { if (\u0026#34;admin\u0026#34;.equals(loginName) \u0026amp;\u0026amp; passWrod.equals(\u0026#34;123456\u0026#34;)) { System.out.println(\u0026#34;ç™»å½•æˆåŠŸï¼\u0026#34;); } else { System.out.println(\u0026#34;ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯ï¼\u0026#34;); } Thread.sleep(1000); // æ¨¡æ‹Ÿç™»å½•æ“ä½œè€—æ—¶ } // å®ç°åˆ é™¤ç”¨æˆ·æ–¹æ³•ï¼Œè¾“å‡ºåˆ é™¤æˆåŠŸä¿¡æ¯ @Override public void deleteUsers() throws Exception { System.out.println(\u0026#34;æˆåŠŸåˆ é™¤äº†10000ä¸ªç”¨æˆ·\u0026#34;); Thread.sleep(1000); // æ¨¡æ‹Ÿåˆ é™¤æ“ä½œè€—æ—¶ } // å®ç°æŸ¥è¯¢ç”¨æˆ·æ–¹æ³•ï¼Œè¾“å‡ºæŸ¥è¯¢ç»“æœå¹¶è¿”å›ç”¨æˆ·æ•°ç»„ @Override public String[] selectUsers() throws Exception { System.out.println(\u0026#34;æŸ¥è¯¢å‡ºä¸‰ä¸ªç”¨æˆ·ï¼š\u0026#34;); String[] names = {\u0026#34;kenene\u0026#34;, \u0026#34;Kennem\u0026#34;, \u0026#34;kkk\u0026#34;}; Thread.sleep(1000); // æ¨¡æ‹ŸæŸ¥è¯¢æ“ä½œè€—æ—¶ return names; } } ä»£ç†å·¥å…·ç±» package com.showguan.proxy_demo2; import java.lang.reflect.InvocationHandler; import java.lang.reflect.Method; import java.lang.reflect.Proxy; // ä»£ç†å·¥å…·ç±»ï¼Œç”¨äºåˆ›å»ºä»£ç†å¯¹è±¡ public class ProxyUtil { // åˆ›å»ºä»£ç†å¯¹è±¡çš„æ–¹æ³• public static UserService createProxy(UserService userService) { UserService userServiceProxy = (UserService) Proxy.newProxyInstance( ProxyUtil.class.getClassLoader(), // ä½¿ç”¨å½“å‰ç±»çš„ç±»åŠ è½½å™¨åŠ è½½ä»£ç†ç±» new Class[]{UserService.class}, // æŒ‡å®šä»£ç†å¯¹è±¡å®ç°çš„æ¥å£ï¼Œè¿™é‡Œæ˜¯UserServiceæ¥å£ new InvocationHandler() { // è®¾ç½®ä»£ç†å¯¹è±¡çš„è°ƒç”¨å¤„ç†å™¨ï¼Œå³InvocationHandler @Override public Object invoke(Object proxy, Method method, Object[] args) throws Throwable { if (method.getName().equals(\u0026#34;login\u0026#34;) || method.getName().equals(\u0026#34;deleteUsers\u0026#34;) || method.getName().equals(\u0026#34;selectUsers\u0026#34;)) { // å¦‚æœæ˜¯ç™»å½•ã€åˆ é™¤ç”¨æˆ·æˆ–æŸ¥è¯¢ç”¨æˆ·æ–¹æ³• long startTime = System.currentTimeMillis(); // è®°å½•æ–¹æ³•è°ƒç”¨å¼€å§‹æ—¶é—´ Object rs = method.invoke(userService, args); // è°ƒç”¨åŸå§‹å¯¹è±¡çš„æ–¹æ³• long endTime = System.currentTimeMillis(); // è®°å½•æ–¹æ³•è°ƒç”¨ç»“æŸæ—¶é—´ System.out.println(method.getName() + \u0026#34;æ–¹æ³•æ‰§è¡Œè€—æ—¶:\u0026#34; + (endTime - startTime) / (1000.0) + \u0026#34;s\u0026#34;); // è¾“å‡ºæ–¹æ³•æ‰§è¡Œè€—æ—¶ return rs; // è¿”å›æ–¹æ³•è°ƒç”¨ç»“æœ } else { // å¯¹äºå…¶ä»–æ–¹æ³•ï¼Œç›´æ¥è°ƒç”¨åŸå§‹å¯¹è±¡çš„æ–¹æ³• Object rs = method.invoke(userService, args); return rs; } } }); return userServiceProxy; // è¿”å›åˆ›å»ºçš„ä»£ç†å¯¹è±¡ } } æµ‹è¯•ç±» package com.showguan.proxy_demo2; // æµ‹è¯•ç±» public class Test { public static void main(String[] args) throws Exception { UserService us = ProxyUtil.createProxy(new UserServiceImpl()); // ä½¿ç”¨ä»£ç†å·¥å…·ç±»åˆ›å»ºä»£ç†å¯¹è±¡ us.login(\u0026#34;admin\u0026#34;, \u0026#34;123456\u0026#34;); // è°ƒç”¨ä»£ç†å¯¹è±¡çš„ç™»å½•æ–¹æ³• System.out.println(\u0026#34;---------------\u0026#34;); us.deleteUsers(); // è°ƒç”¨ä»£ç†å¯¹è±¡çš„åˆ é™¤ç”¨æˆ·æ–¹æ³• System.out.println(\u0026#34;---------------\u0026#34;); us.selectUsers(); // è°ƒç”¨ä»£ç†å¯¹è±¡çš„æŸ¥è¯¢ç”¨æˆ·æ–¹æ³• System.out.println(\u0026#34;---------------\u0026#34;); } } ","permalink":"https://kennems.github.io/posts/tech/java20%E5%A4%A9%E9%80%9F%E6%88%90%E8%BF%9B%E9%98%B6%E8%AF%BE%E7%A8%8B5/","summary":"Java20å¤©é€Ÿæˆâ€”â€”è¿›é˜¶è¯¾ç¨‹(5) ç½‘ç»œç¼–ç¨‹ å¯ä»¥è®©è®¾å¤‡ä¸­çš„ç¨‹åºä¸ç½‘ç»œä¸Šå…¶ä»–è®¾å¤‡ä¸­çš„ç¨‹åºè¿›è¡Œæ•°æ®äº¤äº’ï¼ˆå®ç°ç½‘ç»œé€šä¿¡ï¼‰ åŸºæœ¬çš„é€šä¿¡æ¶æ„ åŸºæœ¬çš„é€šä¿¡æ¶","title":"Java20å¤©é€Ÿæˆâ€”â€”è¿›é˜¶è¯¾ç¨‹(5)"},{"content":"åŠ›æ‰£å‘¨èµ›394(20240421) ç¬¬ä¸‰é¢˜100290. ä½¿çŸ©é˜µæ»¡è¶³æ¡ä»¶çš„æœ€å°‘æ“ä½œæ¬¡æ•° é¢˜ç›®å¤§æ„ï¼šç»™å®šä¸€ä¸ªå¤§å°ä¸º m x n çš„äºŒç»´çŸ©å½¢ gridï¼Œæ¯æ¬¡æ“ä½œå¯ä»¥å°†ä»»æ„æ ¼å­çš„å€¼ä¿®æ”¹ä¸ºä»»æ„éè´Ÿæ•´æ•°ã€‚å®Œæˆæ‰€æœ‰æ“ä½œåï¼Œéœ€è¦ç¡®ä¿æ¯ä¸ªæ ¼å­ grid[i][j] çš„å€¼æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼šå¦‚æœä¸‹é¢ç›¸é‚»æ ¼å­å­˜åœ¨çš„è¯ï¼Œå®ƒä»¬çš„å€¼ç›¸ç­‰ï¼›å¦‚æœå³è¾¹ç›¸é‚»æ ¼å­å­˜åœ¨çš„è¯ï¼Œå®ƒä»¬çš„å€¼ä¸ç›¸ç­‰ã€‚è¿”å›éœ€è¦çš„æœ€å°‘æ“ä½œæ¬¡æ•°ã€‚ è®°å¿†åŒ– å®ç°æ€è·¯ï¼šé¦–å…ˆï¼Œç»Ÿè®¡æ¯ä¸€åˆ—ä¸­å„ä¸ªæ•°å­—çš„å‡ºç°æ¬¡æ•°ã€‚ç„¶åï¼Œä½¿ç”¨åŠ¨æ€è§„åˆ’çš„æ–¹æ³•ï¼Œå®šä¹‰å‡½æ•°dfs(i, pre)ï¼Œè¡¨ç¤ºå¤„ç†åˆ°ç¬¬iåˆ—æ—¶ï¼Œå‰ä¸€åˆ—çš„å€¼ä¸ºpreæ—¶çš„æœ€å¤§æ“ä½œæ¬¡æ•°ã€‚åœ¨dfsä¸­ï¼Œå¯¹äºå½“å‰åˆ—çš„æ¯ä¸ªæ•°å­—ï¼Œè€ƒè™‘æ˜¯å¦ä¿®æ”¹å½“å‰åˆ—çš„å€¼ï¼Œç„¶åé€’å½’å¤„ç†ä¸‹ä¸€åˆ—ã€‚åˆ©ç”¨ç¼“å­˜æ¥é¿å…é‡å¤è®¡ç®—ã€‚æœ€åè¿”å›æ€»çš„æ“ä½œæ¬¡æ•°ã€‚ class Solution: # å¦‚æœä½ æƒ³ä¸å‡ºæ¥ï¼Œ1ã€ä½ ä¸çŸ¥é“è¿™ä¸ªçŸ¥è¯†ç‚¹ 2ã€ ä½ çŸ¥é“è¿™ä¸ªçŸ¥è¯†ç‚¹ä½†æ˜¯æ–¹å‘é”™äº† def minimumOperations(self, g: List[List[int]]) -\u0026gt; int: n, m = len(g), len(g[0]) cnt = [[0]*10 for _ in range(m)] for row in g: for k, v in enumerate(row): cnt[k][v]+=1 @cache def dfs(i, pre): if i\u0026lt;0: return 0 res = 0 for v in range(10): if v!=pre: res = max(res, dfs(i-1, v) + cnt[i][v]) return res return m*n - dfs(m-1, -1) é€’æ¨ å®ç°æ€è·¯ï¼šé¦–å…ˆï¼Œå¯¹æ¯ä¸€åˆ—è¿›è¡Œéå†ï¼Œå¹¶ç»Ÿè®¡æ¯åˆ—ä¸­æ¯ä¸ªæ•°å­—çš„å‡ºç°æ¬¡æ•°ã€‚ç„¶åï¼Œé€šè¿‡åŠ¨æ€è§„åˆ’çš„æ–¹æ³•ï¼Œä½¿ç”¨ä¸¤ä¸ªå˜é‡f0å’Œf1åˆ†åˆ«è¡¨ç¤ºå½“å‰åˆ—å¤„ç†æ—¶ï¼Œå‰ä¸€åˆ—æœ€å¤§èƒ½ä¿ç•™çš„ä¸ªæ•°å’Œæ¬¡å¤§èƒ½å¤Ÿä¿ç•™çš„ä¸ªæ•°ã€‚æ¥ç€ï¼Œé€šè¿‡éå†æ¯åˆ—ä¸­çš„æ¯ä¸ªæ•°å­—ï¼Œè®¡ç®—å½“å‰åˆ—çš„æœ€å¤§æ“ä½œæ¬¡æ•°ï¼Œå¹¶æ›´æ–°f0å’Œf1ã€‚æœ€åè¿”å›æ€»çš„æ“ä½œæ¬¡æ•°ã€‚ class Solution: def minimumOperations(self, grid: List[List[int]]) -\u0026gt; int: n, m = len(grid), len(grid[0]) f0, f1, pre = 0, 0, -1 for col in zip(*grid): mx, mx2, x = f0, f1, -1 for v, c in Counter(col).items(): res = (f0 if v!=pre else f1) + c if res \u0026gt; mx: mx, mx2, x = res, mx, v elif res \u0026gt; mx2: mx2 = res f0, f1, pre = mx, mx2, x return m*n - f0 ç¬¬å››é¢˜100276. æœ€çŸ­è·¯å¾„ä¸­çš„è¾¹ é¢˜ç›®å¤§æ„ï¼šç»™å®šä¸€ä¸ªåŒ…å«nä¸ªèŠ‚ç‚¹çš„æ— å‘å¸¦æƒå›¾ï¼ŒèŠ‚ç‚¹ç¼–å·ä»0åˆ°n-1ï¼Œæ€»å…±æœ‰mæ¡è¾¹ã€‚å¯¹äºèŠ‚ç‚¹0ä¸ºå‡ºå‘ç‚¹ï¼ŒèŠ‚ç‚¹n-1ä¸ºç»“æŸç‚¹çš„æ‰€æœ‰æœ€çŸ­è·¯ï¼Œéœ€è¦è¿”å›ä¸€ä¸ªé•¿åº¦ä¸ºmçš„å¸ƒå°”æ•°ç»„ï¼Œå¦‚æœedges[i]è‡³å°‘åœ¨å…¶ä¸­ä¸€æ¡æœ€çŸ­è·¯ä¸Šï¼Œåˆ™answer[i]ä¸ºtrueï¼Œå¦åˆ™ä¸ºfalseã€‚\nå®ç°æ€è·¯ï¼šé¦–å…ˆæ„å»ºå›¾çš„é‚»æ¥è¡¨è¡¨ç¤ºã€‚ç„¶åä½¿ç”¨Dijkstraç®—æ³•æ±‚è§£æœ€çŸ­è·¯å¾„ï¼Œå¹¶è®°å½•æœ€çŸ­è·¯å¾„çš„é•¿åº¦ã€‚æ¥ç€ï¼Œä»ç»“æŸç‚¹å¼€å§‹åå‘éå†æœ€çŸ­è·¯å¾„ï¼Œæ ‡è®°ç»è¿‡çš„è¾¹ã€‚æœ€åè¿”å›æ ‡è®°ç»“æœã€‚\nclass Solution: # å¤šåŠ¨è„‘å­ï¼ŒæŠŠå¤–ç•Œçš„å¹²æ‰°é™åˆ°æœ€ä½ï¼Œäººç”Ÿæ°¸è¿œå……æ»¡ç€å¹²æ‰° def findAnswer(self, n: int, edges: List[List[int]]) -\u0026gt; List[bool]: m = len(edges) g = defaultdict(list) INF = 0x3f3f3f3f dis, st = [INF]*(n+5), [False]*(n+5) for i, val in enumerate(edges): x, y, w = val g[x].append((y, w, i)) g[y].append((x, w, i)) def dijkstra(): dis[0]=0 h=[] heappush(h, (0, 0)) while h: dist, ver = heappop(h) if st[ver]: continue st[ver]=True for y, w, _ in g[ver]: if dis[y]\u0026gt;dis[ver]+w: dis[y]=dis[ver]+w heappush(h, (dis[y], y)) if dis[n-1]==INF: return -1 else: return dis[n-1] res = [False]*m dn = dijkstra() if dn==-1: return res q = deque() q.append(n-1) while q: f = q.popleft() for y, w, i in g[f]: if dis[y]+w == dis[f]: res[i]=True q.append(y) return res ","permalink":"https://kennems.github.io/posts/tech/%E5%8A%9B%E6%89%A3%E5%91%A8%E8%B5%9B39420240421/","summary":"åŠ›æ‰£å‘¨èµ›394(20240421) ç¬¬ä¸‰é¢˜100290. ä½¿çŸ©é˜µæ»¡è¶³æ¡ä»¶çš„æœ€å°‘æ“ä½œæ¬¡æ•° é¢˜ç›®å¤§æ„ï¼šç»™å®šä¸€ä¸ªå¤§å°ä¸º m x n çš„äºŒç»´çŸ©å½¢ gridï¼Œæ¯æ¬¡æ“ä½œ","title":"LeetCodeå‘¨èµ›240421"},{"content":"Java20å¤©é€Ÿæˆâ€”â€”è¿›é˜¶è¯¾ç¨‹(4) ç‰¹æ®Šæ–‡ä»¶ properties, xml\nä¸ºä»€ä¹ˆè¦ç”¨è¿™äº›ç‰¹æ®Šæ–‡ä»¶ï¼Ÿ\nå­˜å‚¨å¤šä¸ªç”¨æˆ·çš„ï¼šç”¨æˆ·åï¼Œ å¯†ç ï¼Œ å®¶ä¹¡ï¼Œ æ€§åˆ«\næ—¥å¿—æŠ€æœ¯\næŠŠç¨‹åºè¿è¡Œçš„ä¿¡æ¯ï¼Œè®°å½•åˆ°æ–‡ä»¶ä¸­ï¼Œæ–¹ä¾¿ç¨‹åºå‘˜å®šä½bugï¼Œ å¹¶äº†è§£ç¨‹åºçš„æ‰§è¡Œæƒ…å†µç­‰ã€‚\nProperties æ˜¯ä¸€ä¸ªMapé›†åˆï¼ˆé”®å€¼å¯¹é›†åˆï¼‰ï¼Œ ä½†æ˜¯ä¸€èˆ¬ä¸ä¼šå½“é›†åˆä½¿ç”¨ æ ¸å¿ƒä½œç”¨ï¼šPropertiesæ˜¯ç”¨æ¥ä»£è¡¨å±æ€§æ–‡ä»¶çš„ï¼Œé€šè¿‡Propertieså¯ä»¥è¯»å†™å±æ€§æ–‡ä»¶é‡Œé¢çš„å†…å®¹ public static void main(String[] args) throws IOException { // åˆ›å»ºä¸€ä¸ªPropertieså¯¹è±¡ Properties properties = new Properties(); // è¾“å‡ºåˆå§‹çš„Propertieså¯¹è±¡ï¼Œæ­¤æ—¶ä¸ºç©º System.out.println(properties); // ä»æ–‡ä»¶åŠ è½½Propertiesæ•°æ® properties.load(new FileReader(\u0026#34;file-io-app\\\\properties-xml-log-app\\\\src\\\\users.properties\u0026#34;)); // è¾“å‡ºåŠ è½½åçš„Propertieså¯¹è±¡ï¼ŒåŒ…å«ä»æ–‡ä»¶ä¸­è¯»å–çš„é”®å€¼å¯¹ System.out.println(properties); // æ ¹æ®æŒ‡å®šé”®å–å¾—å¯¹åº”çš„å€¼ System.out.println(properties.get(\u0026#34;ken\u0026#34;)); // è·å–Propertieså¯¹è±¡ä¸­æ‰€æœ‰çš„é”®ï¼Œå¹¶éå†è¾“å‡ºæ¯ä¸ªé”®å€¼å¯¹ Set\u0026lt;String\u0026gt; keys = properties.stringPropertyNames(); for (String key : keys) { String val = properties.getProperty(key); System.out.println(key + \u0026#34;----\u0026gt;\u0026#34; + val); } } XML æœ¬è´¨æ˜¯ä¸€ç§æ•°æ®çš„æ ¼å¼ï¼Œå¯ä»¥ç”¨æ¥å­˜å‚¨å¤æ‚çš„æ•°æ®ç»“æ„ï¼Œå’Œæ•°æ®å…³ç³» XMLç‰¹ç‚¹\nXMLä¸­çš„\u0026lt;æ ‡ç­¾å\u0026gt;ç§°ä¸ºä¸€ä¸ªæ ‡ç­¾æˆ–ä¸€ä¸ªå…ƒç´ ï¼Œä¸€èˆ¬æ˜¯æˆå¯¹å‡ºç°çš„ xmlè§£æ(dom4j) public static void main(String[] args) throws DocumentException { // åˆ›å»ºSAXReaderå¯¹è±¡ SAXReader saxReader = new SAXReader(); // ä½¿ç”¨SAXReaderè§£æXMLæ–‡ä»¶å¹¶ç”ŸæˆDocumentå¯¹è±¡ Document document = saxReader.read(\u0026#34;file-io-app\\\\properties-xml-log-app\\\\src\\\\helloworld.xml\u0026#34;); // è·å–XMLæ–‡æ¡£çš„æ ¹å…ƒç´ å¹¶è¾“å‡ºå…¶åç§° Element root = document.getRootElement(); System.out.println(root.getName()); // è·å–æ ¹å…ƒç´ ä¸‹åä¸º\u0026#34;user\u0026#34;çš„æ‰€æœ‰å­å…ƒç´ å¹¶è¾“å‡ºå®ƒä»¬çš„åç§° List\u0026lt;Element\u0026gt; elements = root.elements(\u0026#34;user\u0026#34;); for (Element element : elements) { System.out.println(element.getName()); } // è·å–åä¸º\u0026#34;people\u0026#34;çš„å…ƒç´ çš„æ–‡æœ¬å†…å®¹å¹¶è¾“å‡º Element people = root.element(\u0026#34;people\u0026#34;); System.out.println(people.getText()); // è·å–åä¸º\u0026#34;user\u0026#34;çš„å…ƒç´ ä¸‹åä¸º\u0026#34;user\u0026#34;çš„å­å…ƒç´ çš„æ–‡æœ¬å†…å®¹å¹¶è¾“å‡º Element user = root.element(\u0026#34;user\u0026#34;); System.out.println(user.elementText(\u0026#34;user\u0026#34;)); // è·å–åä¸º\u0026#34;user\u0026#34;çš„å…ƒç´ çš„åä¸º\u0026#34;id\u0026#34;çš„å±æ€§å€¼å¹¶è¾“å‡º System.out.println(user.attributeValue(\u0026#34;id\u0026#34;)); // è·å–åä¸º\u0026#34;user\u0026#34;çš„å…ƒç´ çš„åä¸º\u0026#34;id\u0026#34;çš„å±æ€§ï¼Œå¹¶è¾“å‡ºå±æ€§åå’Œå±æ€§å€¼ Attribute id = user.attribute(\u0026#34;id\u0026#34;); System.out.println(id.getName()); System.out.println(id.getValue()); // è·å–åä¸º\u0026#34;user\u0026#34;çš„å…ƒç´ çš„æ‰€æœ‰å±æ€§ï¼Œå¹¶è¾“å‡ºå®ƒä»¬çš„åå’Œå€¼ List\u0026lt;Attribute\u0026gt; attributes = user.attributes(); for (Attribute attribute : attributes) { System.out.println(attribute.getName() + attribute.getValue()); } // è¾“å‡ºåä¸º\u0026#34;user\u0026#34;çš„å…ƒç´ ä¸‹åä¸º\u0026#34;name\u0026#34;ã€\u0026#34;åœ°å€\u0026#34;å’Œ\u0026#34;password\u0026#34;çš„å­å…ƒç´ çš„æ–‡æœ¬å†…å®¹ System.out.println(user.elementText(\u0026#34;name\u0026#34;)); System.out.println(user.elementText(\u0026#34;åœ°å€\u0026#34;)); System.out.println(user.elementText(\u0026#34;password\u0026#34;)); // è·å–åä¸º\u0026#34;user\u0026#34;çš„å…ƒç´ ä¸‹åä¸º\u0026#34;data\u0026#34;çš„å­å…ƒç´ çš„æ–‡æœ¬å†…å®¹ï¼Œå¹¶è¾“å‡ºåŒ…æ‹¬å‰åç©ºæ ¼çš„æ–‡æœ¬å’Œå»é™¤å‰åç©ºæ ¼çš„æ–‡æœ¬ Element data = user.element(\u0026#34;data\u0026#34;); System.out.println(data.getText()); System.out.println(data.getTextTrim()); //å»é™¤å‰åç©ºæ ¼ } å†™å…¥XMLæ–‡ä»¶ ä½¿ç”¨ç¨‹åºæŠŠæ•°æ®å†™å‡ºåˆ°xmlä¸­\nä¸å»ºè®®ä½¿ç”¨dom4jï¼Œ æ¨èç›´æ¥æŠŠç¨‹åºé‡Œçš„æ•°æ®æ‹¼æ¥æˆxmlæ ¼å¼\npublic static void main(String[] args) throws IOException { // åˆ›å»ºä¸€ä¸ªStringBuilderå¯¹è±¡ï¼Œç”¨äºæ„å»ºXMLå†…å®¹ StringBuilder sb = new StringBuilder(); // æ„å»ºXMLå¤´éƒ¨ä¿¡æ¯å’Œæ ¹å…ƒç´  sb.append(\u0026#34;\u0026lt;?xml version=\\\u0026#34;1.0\\\u0026#34; encoding=\\\u0026#34;utf-8\\\u0026#34; ?\u0026gt;\u0026#34;); sb.append(\u0026#34;\u0026lt;book\u0026gt;\\r\\n\u0026#34;); // æ·»åŠ ä¹¦åã€ä½œè€…å’Œä»·æ ¼ä¿¡æ¯ä½œä¸ºå­å…ƒç´  sb.append(\u0026#34;\u0026lt;name\u0026gt;\u0026#34;).append(\u0026#34;ä»å…¥é—¨åˆ°åˆ åº“\u0026#34;).append(\u0026#34;\u0026lt;/name\u0026gt;\\r\\n\u0026#34;); sb.append(\u0026#34;\u0026lt;author\u0026gt;\u0026#34;).append(\u0026#34;ai\u0026#34;).append(\u0026#34;\u0026lt;/author\u0026gt;\\r\\n\u0026#34;); sb.append(\u0026#34;\u0026lt;price\u0026gt;\u0026#34;).append(999.999).append(\u0026#34;\u0026lt;/price\u0026gt;\\r\\n\u0026#34;); // å…³é—­æ ¹å…ƒç´  sb.append(\u0026#34;\u0026lt;/book\u0026gt;\\r\\n\u0026#34;); try ( // ä½¿ç”¨try-with-resourcesè¯­æ³•åˆ›å»ºBufferedWriterå¯¹è±¡ï¼Œå°†å†…å®¹å†™å…¥åˆ°æ–‡ä»¶ä¸­ BufferedWriter bw = new BufferedWriter(new FileWriter(\u0026#34;file-io-app\\\\properties-xml-log-app\\\\src\\\\test.xml\u0026#34;)); ){ bw.write(sb.toString()); // å°†StringBuilderå¯¹è±¡ä¸­çš„å†…å®¹å†™å…¥åˆ°æ–‡ä»¶ä¸­ } catch (Exception e) { e.printStackTrace(); // æ‰“å°å¼‚å¸¸ä¿¡æ¯ } } çº¦æŸXMLæ–‡ä»¶çš„ä¹¦å†™ å°±æ˜¯é™åˆ¶XMLæ–‡ä»¶åªèƒ½æŒ‰ç…§æŸç§æ ¼å¼è¿›è¡Œä¹¦å†™ çº¦æŸæ–‡æ¡£ï¼š\nä¸“é—¨ç”¨æ¥æ˜¾ç¤ºxmlä¹¦å†™æ ¼å¼çš„æ–‡æ¡£ï¼Œæ¯”å¦‚ï¼šé™åˆ¶æ ‡ç­¾ï¼Œå±æ€§è¯¥æ€ä¹ˆå†™ çº¦æŸæ–‡æ¡£çš„åˆ†ç±»\nDTDæ–‡æ¡£ Schemaæ–‡æ¡£ XMLæ–‡æ¡£ç»“æŸ-DTDçš„ä½¿ç”¨ éœ€æ±‚ï¼šåˆ©ç”¨DTDçº¦æŸæ–‡æ¡£ï¼Œçº¦æŸä¸€ä¸ªXMLæ–‡ä»¶çš„ç¼–å†™ã€‚\nDTD(çº¦æŸæ–‡æ¡£)\n\u0026lt;!ELEMENT ä¹¦æ¶ (ä¹¦+)\u0026gt; \u0026lt;!ELEMENT ä¹¦ (ä¹¦å,ä½œè€…,å”®ä»·)\u0026gt; \u0026lt;!ELEMENT ä¹¦å (#PCDATA)\u0026gt; \u0026lt;!ELEMENT ä½œè€… (#PCDATA)\u0026gt; \u0026lt;!ELEMENT å”®ä»· (#PCDATA)\u0026gt; XMLæ–‡æ¡£\n\u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34; ?\u0026gt; \u0026lt;!DOCTYPE ä¹¦æ¶ SYSTEM \u0026#34;data.dtd\u0026#34;\u0026gt; \u0026lt;ä¹¦æ¶\u0026gt; \u0026lt;ä¹¦\u0026gt; \u0026lt;ä¹¦å\u0026gt;ä»åˆ åº“åˆ°è·‘è·¯\u0026lt;/ä¹¦å\u0026gt; \u0026lt;ä½œè€…\u0026gt;Kenn\u0026lt;/ä½œè€…\u0026gt; \u0026lt;å”®ä»·\u0026gt;0.3\u0026lt;/å”®ä»·\u0026gt; \u0026lt;/ä¹¦\u0026gt; \u0026lt;/ä¹¦æ¶\u0026gt; XMLæ–‡æ¡£ç»“æŸ-schemaçš„ä½¿ç”¨ å¯ä»¥çº¦æŸXMLæ–‡ä»¶çš„ç¼–å†™ã€å’Œæ•°æ®ç±»å‹ \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34; ?\u0026gt; \u0026lt;schema xmlns=\u0026#34;http://www.w3.org/2001/XMLSchema\u0026#34; targetNamespace=\u0026#34;http://www.itcast.cn\u0026#34; elementFormDefault=\u0026#34;qualified\u0026#34; \u0026gt; \u0026lt;!-- targetNamespace:ç”³æ˜çº¦æŸæ–‡æ¡£çš„åœ°å€ï¼ˆå‘½åç©ºé—´ï¼‰--\u0026gt; \u0026lt;element name=\u0026#39;ä¹¦æ¶\u0026#39;\u0026gt; \u0026lt;!-- å†™å­å…ƒç´  --\u0026gt; \u0026lt;complexType\u0026gt; \u0026lt;!-- maxOccurs=\u0026#39;unbounded\u0026#39;: ä¹¦æ¶ä¸‹çš„å­å…ƒç´ å¯ä»¥æœ‰ä»»æ„å¤šä¸ªï¼--\u0026gt; \u0026lt;sequence maxOccurs=\u0026#39;unbounded\u0026#39;\u0026gt; \u0026lt;element name=\u0026#39;ä¹¦\u0026#39;\u0026gt; \u0026lt;!-- å†™å­å…ƒç´  --\u0026gt; \u0026lt;complexType\u0026gt; \u0026lt;sequence\u0026gt; \u0026lt;element name=\u0026#39;ä¹¦å\u0026#39; type=\u0026#39;string\u0026#39;/\u0026gt; \u0026lt;element name=\u0026#39;ä½œè€…\u0026#39; type=\u0026#39;string\u0026#39;/\u0026gt; \u0026lt;element name=\u0026#39;å”®ä»·\u0026#39; type=\u0026#39;double\u0026#39;/\u0026gt; \u0026lt;/sequence\u0026gt; \u0026lt;/complexType\u0026gt; \u0026lt;/element\u0026gt; \u0026lt;/sequence\u0026gt; \u0026lt;/complexType\u0026gt; \u0026lt;/element\u0026gt; \u0026lt;/schema\u0026gt; XML\n\u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34; ?\u0026gt; \u0026lt;ä¹¦æ¶ xmlns=\u0026#34;http://www.itcast.cn\u0026#34; xmlns:xsi=\u0026#34;http://www.w3.org/2001/XMLSchema-instance\u0026#34; xsi:schemaLocation=\u0026#34;http://www.itcast.cn data.xsd\u0026#34;\u0026gt; \u0026lt;!-- xmlns=\u0026#34;http://www.itcast.cn\u0026#34; åŸºæœ¬ä½ç½® xsi:schemaLocation=\u0026#34;http://www.itcast.cn books02.xsd\u0026#34; å…·ä½“çš„ä½ç½® --\u0026gt; \u0026lt;ä¹¦\u0026gt; \u0026lt;ä¹¦å\u0026gt;ä»å…¥é—¨åˆ°åˆ é™¤\u0026lt;/ä¹¦å\u0026gt; \u0026lt;ä½œè€…\u0026gt;dlei\u0026lt;/ä½œè€…\u0026gt; \u0026lt;å”®ä»·\u0026gt;0.03\u0026lt;/å”®ä»·\u0026gt; \u0026lt;/ä¹¦\u0026gt; \u0026lt;ä¹¦\u0026gt; \u0026lt;ä¹¦å\u0026gt;ä»å…¥é—¨åˆ°åˆ é™¤\u0026lt;/ä¹¦å\u0026gt; \u0026lt;ä½œè€…\u0026gt;dlei\u0026lt;/ä½œè€…\u0026gt; \u0026lt;å”®ä»·\u0026gt;0.9\u0026lt;/å”®ä»·\u0026gt; \u0026lt;/ä¹¦\u0026gt; \u0026lt;/ä¹¦æ¶\u0026gt; Logbackå¿«é€Ÿå…¥é—¨ éœ€æ±‚ï¼š\nä½¿ç”¨Logbackæ—¥å¿—æ¡†æ¶ï¼Œè®°å½•ç³»ç»Ÿçš„è¿è¡Œä¿¡æ¯ å®ç°æ­¥éª¤\nå¯¼å…¥Logbackæ¡†æ¶åˆ°é¡¹ç›®ä¸­å»\nslf4j-apiï¼šæ—¥å¿—æ¥å£ logback-core logback-classic å°†Logbackæ¡†æ¶çš„æ ¸å¿ƒé…ç½®æ–‡ä»¶logback.xmlç›´æ¥æ‹·è´åˆ°srcç›®å½•ä¸‹ï¼ˆå¿…é¡»æ˜¯srcä¸‹ï¼‰\nåˆ›å»ºLogbackæ¡†æ¶æä¾›çš„Loggerå¯¹è±¡ï¼Œç„¶åç”¨Loggerå¯¹è±¡è°ƒç”¨å…¶æä¾›çš„æ–¹æ³•å°±å¯è®°å½•ç³»ç»Ÿçš„æ—¥å¿—ä¿¡æ¯ã€‚\npublic static final Logger LOGGER = LoggerFactory.getLogger(\u0026#34;LogBackTest\u0026#34;); æ ¸å¿ƒé…ç½®æ–‡ä»¶logback.xml\nå¯¹Logbackæ—¥å¿—æ¡†æ¶è¿›è¡Œæ§åˆ¶ Logbackè®¾ç½®æ—¥å¿—çº§åˆ«\næ—¥å¿—çº§åˆ«æŒ‡çš„æ˜¯æ—¥å¿—ä¿¡æ¯çš„ç±»å‹ï¼Œæ—¥å¿—éƒ½ä¼šåˆ†çº§åˆ«ï¼Œå¸¸è§çš„æ—¥å¿—çº§åˆ«å¦‚ä¸‹ï¼ˆä¼˜å…ˆçº§ä¾æ¬¡å‡é«˜ï¼‰ æ—¥å¿—çº§åˆ« è¯´æ˜ trace è¿½è¸ªï¼ŒæŒ‡æ˜ç¨‹åºè¿è¡Œè½¨è¿¹ debug è°ƒè¯•ï¼Œå®é™…åº”ç”¨ä¸­ä¸€èˆ¬å°†å…¶ä½œä¸ºæœ€ä½çº§åˆ« info è¾“å‡ºé‡è¦çš„è¿è¡Œä¿¡æ¯ï¼Œæ•°æ®è¿æ¥ï¼Œç½‘ç»œè¿æ¥ï¼ŒIOæ“ä½œç­‰ç­‰ï¼Œä½¿ç”¨è¾ƒå¤š warn è­¦å‘Šä¿¡æ¯ï¼Œå¯èƒ½ä¼šå‘ç”Ÿé—®é¢˜ï¼Œä½¿ç”¨è¾ƒå¤š error é”™è¯¯ä¿¡æ¯ï¼Œä½¿ç”¨è¾ƒå¤š é…ç½®æ–‡ä»¶é…ç½®å¦‚ä¸‹ï¼š\n\u0026lt;root level=\u0026#34;debug\u0026#34;\u0026gt; \u0026lt;appender-ref ref=\u0026#34;CONSOLE\u0026#34;/\u0026gt; \u0026lt;appender-ref ref=\u0026#34;FILE\u0026#34; /\u0026gt; \u0026lt;/root\u0026gt; åªæœ‰æ—¥å¿—çš„çº§åˆ«æ˜¯å¤§äºæˆ–ç­‰äºæ ¸å¿ƒé…ç½®æ–‡ä»¶é…å€¼çš„æ—¥å¿—çº§åˆ«ï¼Œæ‰ä¼šè¢«è®°å½•ï¼Œå¦åˆ™ä¸è®°å½•ã€‚ å¤šçº¿ç¨‹ çº¿ç¨‹ï¼ˆThreadï¼‰æ˜¯ä¸€ä¸ªç¨‹åºå†…éƒ¨çš„ä¸€æ¡æ‰§è¡Œæµç¨‹ ç¨‹åºä¸­å¦‚æœåªæœ‰ä¸€æ¡æ‰§è¡Œæµç¨‹ï¼Œé‚£è¿™ä¸ªç¨‹åºå°±æ˜¯å•çº¿ç¨‹çš„ç¨‹åº å¤šçº¿ç¨‹\nå¤šçº¿ç¨‹æ˜¯æŒ‡ä»è½¯ç¡¬ä»¶ä¸Šå®ç°çš„å¤šæ¡æ‰§è¡Œæµç¨‹çš„æŠ€æœ¯ï¼ˆå¤šæ¡çº¿ç¨‹ç”±CPUè´Ÿè´£è°ƒåº¦æ‰§è¡Œï¼‰ æ–¹å¼ä¸€ï¼šç»§æ‰¿Threadç±» public class MyThread extends Thread{ @Override public void run() { for (int i = 0; i \u0026lt; 100; i++) { System.out.println(\u0026#34;å­çº¿ç¨‹MyThread\u0026#34; + i); } } } public static void main(String[] args) { MyThread t = new MyThread(); t.start(); for (int i = 0; i \u0026lt; 100; i++) { System.out.println(\u0026#34;ä¸»çº¿ç¨‹mainè¾“å‡ºï¼š\u0026#34; + i); } } ä¼˜ç¼ºç‚¹ï¼š\nä¼˜ç‚¹ï¼šç¼–ç ç®€å• ç¼ºç‚¹ï¼šçº¿ç¨‹ç±»å·²ç»ç»§æ‰¿Thread, æ— æ³•ç»§æ‰¿å…¶ä»–ç±»ï¼Œä¸åˆ©äºåŠŸèƒ½çš„æ‰©å±• æ³¨æ„äº‹é¡¹ï¼š\nè°ƒç”¨çš„æ˜¯startè€Œä¸æ˜¯run ä¸è¦æŠŠä¸»çº¿ç¨‹ä»»åŠ¡æ”¾åœ¨å¯åŠ¨å­çº¿ç¨‹ä¹‹å‰ æ–¹å¼äºŒï¼šå®ç°Runnableæ¥å£ public class Demo2 { public static void main(String[] args) { MyRunnable target = new MyRunnable(); new Thread(target).start(); for (int i = 0; i \u0026lt; 1000; i++) { System.out.println(\u0026#34;===ä¸»çº¿ç¨‹è¾“å‡º\u0026#34; + i); } } } public class MyRunnable implements Runnable{ @Override public void run() { for (int i = 0; i \u0026lt; 1000; i++) { System.out.println(\u0026#34;å­çº¿ç¨‹è¾“å‡º===\u0026#34; + i); } } } å®šä¹‰ä¸€ä¸ªçº¿ç¨‹ä»»åŠ¡ç±»MyRunnableå®ç°Runnableæ¥å£ï¼Œ é‡å†™run()æ–¹æ³• åˆ›å»ºMyRunnableä»»åŠ¡å¯¹è±¡ æŠŠMyRunnbaleä»»åŠ¡å¯¹è±¡äº¤ç»™Threadå¤„ç† ä¼˜ç¼ºç‚¹ï¼š\nä¼˜ç‚¹ï¼šå®ç°Runnableæ¥å£åï¼Œå¯ä»¥ç»§ç»­ç»§æ‰¿å…¶ä»–ç±»ï¼Œå®ç°å…¶ä»–æ¥å£ï¼Œæ‰©å±•æ€§å¼º ç¼ºç‚¹ï¼šéœ€è¦å¤šä¸€ä¸ªRunnableå¯¹è±¡ public static void main(String[] args) { // åˆ›å»ºå¹¶å¯åŠ¨ç¬¬ä¸€ä¸ªå­çº¿ç¨‹ Runnable target1 = new Runnable() { @Override public void run() { for (int i = 0; i \u0026lt; 100; i++) { System.out.println(\u0026#34;å­çº¿ç¨‹è¾“å‡º:\u0026#34; + i); } } }; new Thread(target1).start(); // ä¸»çº¿ç¨‹æ‰§è¡Œ for (int i = 0; i \u0026lt; 100; i++) { System.out.println(\u0026#34;ä¸»çº¿ç¨‹:\u0026#34; + i); } // åˆ›å»ºå¹¶å¯åŠ¨ç¬¬äºŒä¸ªå­çº¿ç¨‹ï¼Œä½¿ç”¨Lambdaè¡¨è¾¾å¼ new Thread(() -\u0026gt; { for (int i = 0; i \u0026lt; 100; i++) { System.out.println(\u0026#34;å­çº¿ç¨‹2:\u0026#34; + i); } }).start(); // ä¸»çº¿ç¨‹ç»§ç»­æ‰§è¡Œ for (int i = 0; i \u0026lt; 100; i++) { System.out.println(\u0026#34;ä¸»çº¿ç¨‹:\u0026#34; + i); } } æ–¹å¼ä¸‰ï¼šåˆ©ç”¨Callableæ¥å£ï¼ŒFutureTaskç±»æ¥å®ç° MyCallable\npackage com.showguan.ThreadDemo; import java.util.concurrent.Callable; public class MyCallable implements Callable\u0026lt;String\u0026gt; { private int n; public MyCallable() { } public MyCallable(int n) { this.n = n; } @Override public String call() throws Exception { int sum = 0; for (int i = 0; i \u0026lt; n; i++) { sum += i; } return \u0026#34;çº¿ç¨‹æ±‚å’Œç»“æœä¸º\u0026#34; + sum; } } package com.showguan.ThreadDemo; import java.util.concurrent.Callable; import java.util.concurrent.ExecutionException; import java.util.concurrent.FutureTask; public class Demo4 { public static void main(String[] args) throws ExecutionException, InterruptedException { Callable\u0026lt;String\u0026gt; call = new MyCallable(100); FutureTask\u0026lt;String\u0026gt; ft = new FutureTask\u0026lt;\u0026gt;(call); new Thread(ft).start(); Callable\u0026lt;String\u0026gt; call2 = new MyCallable(200); FutureTask\u0026lt;String\u0026gt; ft2 = new FutureTask\u0026lt;\u0026gt;(call2); new Thread(ft2).start(); String rs = ft.get(); System.out.println(rs); //çº¿ç¨‹æ±‚å’Œç»“æœä¸º4950 String rs2 = ft2.get(); System.out.println(rs2); //çº¿ç¨‹æ±‚å’Œç»“æœä¸º19900 } } ä¼˜ç‚¹ï¼š\nçº¿ç¨‹ä»»åŠ¡ç±»åªæ˜¯å®ç°æ¥å£ï¼Œå¯ä»¥ç»§ç»­ç»§æ‰¿ç±»å’Œå®ç°æ¥å£ï¼Œæ‰©å±•æ€§å¼ºï¼›å¯ä»¥åœ¨çº¿ç¨‹æ‰§è¡Œå®Œæ¯•åå»è·å–çº¿ç¨‹æ‰§è¡Œçš„ç»“æœã€‚ çº¿ç¨‹å¸¸ç”¨æ–¹æ³• ä¸ºçº¿ç¨‹è®¾ç½®åç§° public class Main { public static void main(String[] args) { // åˆ›å»ºå¹¶å¯åŠ¨çº¿ç¨‹ t1 Thread t1 = new MyThread(\u0026#34;çº¿ç¨‹ä¸€å·\u0026#34;); t1.start(); System.out.println(t1.getName()); // æ‰“å°çº¿ç¨‹ t1 çš„åç§° // åˆ›å»ºå¹¶å¯åŠ¨çº¿ç¨‹ t2 Thread t2 = new MyThread(\u0026#34;çº¿ç¨‹äºŒå·\u0026#34;); t2.start(); System.out.println(t2.getName()); // æ‰“å°çº¿ç¨‹ t2 çš„åç§° // è·å–å½“å‰çº¿ç¨‹ï¼Œå¹¶å°†å…¶åç§°è®¾ç½®ä¸º \u0026#34;maxçº¿ç¨‹\u0026#34; Thread m = Thread.currentThread(); m.setName(\u0026#34;maxçº¿ç¨‹\u0026#34;); System.out.println(m.getName()); // æ‰“å°å½“å‰çº¿ç¨‹çš„åç§° // åœ¨å½“å‰çº¿ç¨‹ä¸­æ‰§è¡Œä¸€ä¸ªç®€å•çš„ for å¾ªç¯ï¼Œæ‰“å°è¾“å‡ºå½“å‰çº¿ç¨‹çš„åç§°å’Œå¾ªç¯å˜é‡ i for (int i = 0; i \u0026lt; 100; i++) { System.out.println(m.getName() + \u0026#34;çº¿ç¨‹è¾“å‡º\u0026#34; + i); } } } // è‡ªå®šä¹‰çº¿ç¨‹ç±» MyThread package com.showguan.ThreadDemo; public class MyThread extends Thread { public MyThread() { } public MyThread(String name) { super(name); } @Override public void run() { for (int i = 0; i \u0026lt; 100; i++) { System.out.println(Thread.currentThread().getName() + \u0026#34;å¼€å§‹æ‰§è¡Œã€‚\u0026#34;); System.out.println(\u0026#34;å­çº¿ç¨‹MyThread\u0026#34; + i); } } } ä½¿ç”¨çº¿ç¨‹çš„ join() æ–¹æ³•æ¥å®ç°çº¿ç¨‹çš„é¡ºåºæ‰§è¡Œï¼Œåœ¨å¾ªç¯ä¸­ä½¿ç”¨ sleep() æ–¹æ³•æ¥æ§åˆ¶çº¿ç¨‹çš„æ‰§è¡Œ public static void main(String[] args) throws InterruptedException { // å¾ªç¯éå†æ•´æ•° 0 åˆ° 5 for (int i = 0; i \u0026lt;= 5; i++) { System.out.println(i); // æ‰“å°å½“å‰æ•´æ•°å€¼ // å¦‚æœå½“å‰æ•´æ•°å€¼ç­‰äº 3ï¼Œåˆ™è®©å½“å‰çº¿ç¨‹ä¼‘çœ  5 ç§’é’Ÿ if (i == 3) { Thread.sleep(5000); } } // åˆ›å»ºå¹¶å¯åŠ¨çº¿ç¨‹ t1ï¼Œå¹¶åœ¨ä¸»çº¿ç¨‹ä¸­ç­‰å¾… t1 çº¿ç¨‹æ‰§è¡Œå®Œæˆ Thread t1 = new MyThread(\u0026#34;1å·çº¿ç¨‹\u0026#34;); t1.start(); t1.join(); // åˆ›å»ºå¹¶å¯åŠ¨çº¿ç¨‹ t2ï¼Œå¹¶åœ¨ä¸»çº¿ç¨‹ä¸­ç­‰å¾… t2 çº¿ç¨‹æ‰§è¡Œå®Œæˆ Thread t2 = new MyThread(\u0026#34;2å·çº¿ç¨‹\u0026#34;); t2.start(); t2.join(); // åˆ›å»ºå¹¶å¯åŠ¨çº¿ç¨‹ t3ï¼Œå¹¶åœ¨ä¸»çº¿ç¨‹ä¸­ç­‰å¾… t3 çº¿ç¨‹æ‰§è¡Œå®Œæˆ Thread t3 = new MyThread(\u0026#34;3å·çº¿ç¨‹\u0026#34;); t3.start(); t3.join(); } yield, interrupt, å®ˆæŠ¤çº¿ç¨‹ï¼Œçº¿ç¨‹ä¼˜å…ˆçº§ç­‰\u0026hellip;\nçº¿ç¨‹å®‰å…¨ ä»€ä¹ˆæ˜¯çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Ÿ\nå¤šä¸ªçº¿ç¨‹ï¼ŒåŒæ—¶æ“ä½œåŒä¸€ä¸ªå…±äº«èµ„æºçš„æ—¶å€™ï¼Œå¯èƒ½ä¼šå‡ºç°ä¸šåŠ¡å®‰å…¨é—®é¢˜ package com.showguan.ThreadSafeDemo; public class Account { private String cardId; private double money; public Account() { } public Account(String cardId, double money) { this.cardId = cardId; this.money = money; } public String getCardId() { return cardId; } public void setCardId(String cardId) { this.cardId = cardId; } public double getMoney() { return money; } public void setMoney(double money) { this.money = money; } // ä½¿ç”¨ synchronized å…³é”®å­—ç¡®ä¿çº¿ç¨‹å®‰å…¨ public synchronized void drawMoney(double money) { String name = Thread.currentThread().getName(); if(this.money\u0026gt;=money){ System.out.println(name + \u0026#34;æ¥å–é’±\u0026#34; + money + \u0026#34;æˆåŠŸï¼\u0026#34;); this.money -= money; System.out.println(name + \u0026#34;å–é’±ä¹‹åï¼Œä½™é¢å‰©ä½™: \u0026#34; + this.money); }else{ System.out.println(name + \u0026#34;æ¥å–é’±ï¼Œ ä½™é¢ä¸è¶³ï¼\u0026#34;); } } } package com.showguan.ThreadSafeDemo; public class DrawThread extends Thread{ private Account acc; public DrawThread(Account acc, String name) { super(name); this.acc = acc; } @Override public void run() { acc.drawMoney(10000.0); } } public class Demo1 { public static void main(String[] args) { Account acc = new Account(\u0026#34;ICBC-10101\u0026#34;, 10000); new DrawThread(acc, \u0026#34;å°çº¢\u0026#34;).start(); new DrawThread(acc, \u0026#34;å°æ˜\u0026#34;).start(); /**è¾“å‡ºç»“æœ * å°çº¢æ¥å–é’±10000.0æˆåŠŸï¼ * å°æ˜æ¥å–é’±ï¼Œ ä½™é¢ä¸è¶³ï¼ * å°çº¢å–é’±ä¹‹åï¼Œä½™é¢å‰©ä½™: 0.0 */ } } çº¿ç¨‹åŒæ­¥çš„å¸¸è§æ–¹æ¡ˆ åŠ é”ï¼šæ¯æ¬¡åªå…è®¸ä¸€ä¸ªçº¿ç¨‹åŠ é”ï¼ŒåŠ é”åæ‰èƒ½è¿›å…¥è®¿é—®ï¼Œè®¿é—®å®Œæ¯•åè‡ªåŠ¨è§£é”ï¼Œç„¶åå…¶ä»–çº¿ç¨‹æ‰èƒ½å†åŠ é”è¿›æ¥ (1) åŒæ­¥ä»£ç å— ä½œç”¨ï¼šæŠŠè®¿é—®å…±äº«èµ„æºçš„æ ¸å¿ƒä»£ç ç»™ä¸Šé”ï¼Œä¾æ¬¡ä¿è¯çº¿ç¨‹å®‰å…¨ã€‚\nåŸç†ï¼šæ¯æ¬¡åªå…è®¸ä¸€ä¸ªçº¿ç¨‹åŠ é”åè¿›å…¥ï¼Œæ‰§è¡Œå®Œæ¯•åè‡ªåŠ¨ç»“æœï¼Œå…¶ä»–çº¿ç¨‹æ‰å¯ä»¥è¿›æ¥æ‰§è¡Œã€‚\næ³¨æ„äº‹é¡¹ï¼š\nå¯¹äºå½“å‰åŒæ—¶æ‰§è¡Œçš„çº¿ç¨‹æ¥è¯´ï¼ŒåŒæ­¥é”å¿…é¡»åŒä¸€æŠŠï¼ˆåŒä¸€ä¸ªå¯¹è±¡ï¼‰ï¼Œå¦åˆ™ä¼šå‡ºbug é”å¯¹è±¡çš„ä½¿ç”¨è§„èŒƒï¼š\nå»ºè®®ä½¿ç”¨å…±äº«èµ„æºä½œä¸ºé”å¯¹è±¡ï¼Œå¯¹äºå®ä¾‹æ–¹æ³•å»ºè®®ä½¿ç”¨thisä½œä¸ºé”å¯¹è±¡ å¯¹äºé™æ€æ–¹æ³•å»ºè®®ä½¿ç”¨å­—èŠ‚ç ï¼ˆç±»å.classï¼‰å¯¹è±¡ä½œä¸ºé”å¯¹è±¡ public void drawMoney(double money) { String name = Thread.currentThread().getName(); synchronized (this) { if(this.money\u0026gt;=money){ System.out.println(name + \u0026#34;æ¥å–é’±\u0026#34; + money + \u0026#34;æˆåŠŸï¼\u0026#34;); this.money -= money; System.out.println(name + \u0026#34;å–é’±ä¹‹åï¼Œä½™é¢å‰©ä½™: \u0026#34; + this.money); }else{ System.out.println(name + \u0026#34;æ¥å–é’±ï¼Œ ä½™é¢ä¸è¶³ï¼\u0026#34;); } } } public static void test(){ synchronized(Account.class){ } } (2) åŒæ­¥æ–¹æ³• ä½¿ç”¨synchronizedä¿®é¥°æ–¹æ³•\npublic synchronized void drawMoney(double money) { String name = Thread.currentThread().getName(); if(this.money\u0026gt;=money){ System.out.println(name + \u0026#34;æ¥å–é’±\u0026#34; + money + \u0026#34;æˆåŠŸï¼\u0026#34;); this.money -= money; System.out.println(name + \u0026#34;å–é’±ä¹‹åï¼Œä½™é¢å‰©ä½™: \u0026#34; + this.money); }else{ System.out.println(name + \u0026#34;æ¥å–é’±ï¼Œ ä½™é¢ä¸è¶³ï¼\u0026#34;); } } åŒæ­¥æ–¹æ³•åº•å±‚åŸç†\nåŒæ­¥æ–¹æ³•å…¶å®åº•å±‚ä¹Ÿæ˜¯æœ‰éšå¼å¯¹è±¡çš„ï¼Œ åªæ˜¯é”çš„èŒƒå›´æ˜¯æ•´ä¸ªæ–¹æ³•ä»£ç  åŒæ ·ï¼Œå¦‚æœæ˜¯å®ä¾‹æ–¹æ³•ï¼šåŒæ­¥æ–¹æ³•é»˜è®¤ç”¨thisä½œä¸ºé”å¯¹è±¡ï¼›å¦‚æœæ˜¯é™æ€æ–¹æ³•ï¼šåŒæ­¥æ–¹æ³•é»˜è®¤ç”¨ç±»å.classä½œä¸ºé”å¯¹è±¡ (3) Locké” private final Lock lk = new ReentrantLock(); public void drawMoney(double money) { String name = Thread.currentThread().getName(); try { lk.lock(); if(this.money\u0026gt;=money){ System.out.println(name + \u0026#34;æ¥å–é’±\u0026#34; + money + \u0026#34;æˆåŠŸï¼\u0026#34;); this.money -= money; System.out.println(name + \u0026#34;å–é’±ä¹‹åï¼Œä½™é¢å‰©ä½™: \u0026#34; + this.money); }else{ System.out.println(name + \u0026#34;æ¥å–é’±ï¼Œ ä½™é¢ä¸è¶³ï¼\u0026#34;); } } catch (Exception e) { e.printStackTrace(); } finally { lk.unlock(); } } çº¿ç¨‹é—´é€šä¿¡ /** * è¿™ä¸ªç¨‹åºæ¼”ç¤ºäº†ä½¿ç”¨ wait() å’Œ notify() æ–¹æ³•æ¥å®ç°å¤šçº¿ç¨‹é—´çš„æ¶ˆæ¯ä¼ é€’å’ŒåŒæ­¥ã€‚ * * ä¸»è¦çŸ¥è¯†ç‚¹ï¼š * 1. wait() æ–¹æ³•ï¼šä½¿å½“å‰çº¿ç¨‹ç­‰å¾…å¹¶é‡Šæ”¾æ‰€å é”ï¼Œç›´åˆ°å¦ä¸€ä¸ªçº¿ç¨‹è°ƒç”¨ notify() æ–¹æ³•æˆ– notifyAll() æ–¹æ³•æ¥å”¤é†’å®ƒã€‚ * 2. notify() æ–¹æ³•ï¼šå”¤é†’æ­£åœ¨ç­‰å¾…çš„å•ä¸ªçº¿ç¨‹ã€‚ * 3. notifyAll() æ–¹æ³•ï¼šå”¤é†’æ­£åœ¨ç­‰å¾…çš„æ‰€æœ‰çº¿ç¨‹ã€‚ * 4. ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å‹ï¼šå¤šä¸ªç”Ÿäº§è€…çº¿ç¨‹å‘å…±äº«èµ„æºä¸­ç”Ÿäº§ç‰©å“ï¼Œå¤šä¸ªæ¶ˆè´¹è€…çº¿ç¨‹ä»å…±äº«èµ„æºä¸­æ¶ˆè´¹ç‰©å“ã€‚ * 5. ä½¿ç”¨ synchronized å…³é”®å­—æ¥ç¡®ä¿çº¿ç¨‹å®‰å…¨ï¼Œé¿å…å¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®å…±äº«èµ„æºå¼•èµ·çš„æ•°æ®ä¸ä¸€è‡´æ€§é—®é¢˜ã€‚ * */ package com.showguan.ThreadMessageDemo; import java.util.ArrayList; import java.util.List; public class Desk { private List\u0026lt;String\u0026gt; list = new ArrayList\u0026lt;\u0026gt;(); /** * ç”Ÿäº§é£Ÿç‰©çš„æ–¹æ³• */ public synchronized void put() { try { String name = Thread.currentThread().getName(); // å¦‚æœæ¡Œå­ä¸Šæ²¡æœ‰é£Ÿç‰©ï¼Œåˆ™ç”Ÿäº§ä¸€ä¸ªé£Ÿç‰© if (list.size() == 0) { list.add(name + \u0026#34;åšçš„è‚‰åŒ…å­\u0026#34;); System.out.println(name + \u0026#34;åšäº†ä¸€ä¸ªè‚‰åŒ…å­\u0026#34;); Thread.sleep(2000); // æ¨¡æ‹Ÿåˆ¶ä½œæ—¶é—´ this.notifyAll(); // å”¤é†’æ‰€æœ‰ç­‰å¾…çº¿ç¨‹ this.wait(); // ç­‰å¾…è¢«å”¤é†’ } else { this.notifyAll(); // å”¤é†’æ‰€æœ‰ç­‰å¾…çº¿ç¨‹ this.wait(); // ç­‰å¾…è¢«å”¤é†’ } } catch (Exception e) { e.printStackTrace(); } } /** * æ¶ˆè´¹é£Ÿç‰©çš„æ–¹æ³• */ public synchronized void get() { try { String name = Thread.currentThread().getName(); // å¦‚æœæ¡Œå­ä¸Šæœ‰é£Ÿç‰©ï¼Œåˆ™æ¶ˆè´¹ä¸€ä¸ªé£Ÿç‰© if (list.size() == 1) { System.out.println(name + \u0026#34;åƒäº†\u0026#34; + list.get(0)); list.clear(); // æ¸…ç©ºæ¡Œå­ä¸Šçš„é£Ÿç‰© Thread.sleep(1000); // æ¨¡æ‹Ÿåƒçš„æ—¶é—´ this.notifyAll(); // å”¤é†’æ‰€æœ‰ç­‰å¾…çº¿ç¨‹ this.wait(); // ç­‰å¾…è¢«å”¤é†’ } else { this.notifyAll(); // å”¤é†’æ‰€æœ‰ç­‰å¾…çº¿ç¨‹ this.wait(); // ç­‰å¾…è¢«å”¤é†’ } } catch (Exception e) { e.printStackTrace(); } } } çº¿ç¨‹æ±  çº¿ç¨‹æ± å°±æ˜¯ä¸€ä¸ªå¯ä»¥å¤ç”¨çº¿ç¨‹çš„æŠ€æœ¯ ThreadPoolExecutoræ„é€ å™¨\npublic ThreadPoolExecutor(int corePoolSize, int maximumPoolSize, long keepAliveTime, TimeUnit unit, BlockingQueue\u0026lt;Runnable\u0026gt; workQueue) å‚æ•°ä¸€ï¼šcorePoolSizeï¼šæŒ‡å®šçº¿ç¨‹æ± çš„æ ¸å¿ƒçº¿ç¨‹çš„æ•°é‡ å‚æ•°äºŒï¼šmaximumPoolSizeï¼šæŒ‡å®šçº¿ç¨‹æ± çš„æœ€å¤§çº¿ç¨‹æ•°é‡ å‚æ•°ä¸‰ï¼škeepAliveTimeï¼šæŒ‡å®šä¸´æ—¶çº¿ç¨‹çš„å­˜æ´»æ—¶é—´ å‚æ•°å››ï¼šunit:æŒ‡å®šä¸´æ—¶çº¿ç¨‹å­˜æ´»çš„æ—¶é—´å•ä½ï¼ˆç§’ï¼Œåˆ†ï¼Œæ—¶ï¼Œå¤©ï¼‰ å‚æ•°äº”ï¼šworkQueueï¼šæŒ‡å®šçº¿ç¨‹æ± çš„ä»»åŠ¡é˜Ÿåˆ— å‚æ•°å…­ï¼šthreadFactoryï¼šæŒ‡å®šçº¿ç¨‹æ± çš„çº¿ç¨‹å·¥å‚ å‚æ•°ä¸ƒï¼šhandlerï¼šæŒ‡å®šçº¿ç¨‹æ± çš„ä»»åŠ¡æ‹’ç»ç­–ç•¥ï¼ˆçº¿ç¨‹éƒ½åœ¨å¿™ï¼Œä»»åŠ¡é˜Ÿåˆ—ä¹Ÿæ»¡äº†çš„æ—¶å€™ï¼Œæ–°ä»»åŠ¡æ¥äº†è¯¥æ€ä¹ˆå¤„ç†ï¼‰ æ³¨æ„äº‹é¡¹\nä¸´æ—¶çº¿ç¨‹ä»€ä¹ˆæ—¶å€™åˆ›å»ºï¼Ÿ æ–°ä»»åŠ¡æäº¤æ—¶å‘ç°æ ¸å¿ƒçº¿ç¨‹éƒ½åœ¨å¿™ï¼Œä»»åŠ¡é˜Ÿåˆ—ä¹Ÿæ»¡äº†ï¼Œå¹¶ä¸”è¿˜å¯ä»¥åˆ›å»ºä¸´æ—¶çº¿ç¨‹ï¼Œæ­¤æ—¶æ‰ä¼šåˆ›å»ºä¸´æ—¶çº¿ç¨‹ ä»€ä¹ˆæ—¶å€™ä¼šå¼€å§‹æ‹’ç»æ–°ä»»åŠ¡ï¼Ÿ æ ¸å¿ƒçº¿ç¨‹å’Œä¸´æ—¶çº¿ç¨‹éƒ½åœ¨å¿™ï¼Œä»»åŠ¡é˜Ÿåˆ—ä¹Ÿæ»¡äº†ï¼Œæ–°çš„ä»»åŠ¡è¿‡æ¥çš„æ—¶å€™æ‰ä¼šå¼€å§‹æ‹’ç»æ–°ä»»åŠ¡ æ–°ä»»åŠ¡æ‹’ç»ç­–ç•¥ ç­–ç•¥ è§£é‡Š ThreadPoolExecutor.AbortPolicy å½“ä»»åŠ¡æ·»åŠ åˆ°çº¿ç¨‹æ± ä¸­è¢«æ‹’ç»æ—¶ï¼ŒæŠ›å‡ºRejectedExecutionExceptionå¼‚å¸¸ã€‚ï¼ˆé»˜è®¤ç­–ç•¥ï¼‰ ThreadPoolExecutor.DiscardPolicy ä¸¢å¼ƒä»»åŠ¡ï¼Œä½†æ˜¯ä¸æŠ›å‡ºå¼‚å¸¸ï¼Œä¸æ¨è ThreadPoolExecutor.DiscardOldestPolicy æŠ›å¼ƒé˜Ÿåˆ—ä¸­ç­‰å¾…æœ€ä¹…çš„ä»»åŠ¡ï¼Œç„¶åæŠŠå½“å‰ä»»åŠ¡åŠ å…¥é˜Ÿåˆ—ä¸­ ThreadPoolExecutor.CallerRunsPolicy ç”±ä¸»çº¿ç¨‹è´Ÿè´£è°ƒç”¨ä»»åŠ¡çš„run()æ–¹æ³•ä»è€Œç»•è¿‡çº¿ç¨‹æ± ç›´æ¥æ‰§è¡Œ ExecutorServiceçš„å¸¸ç”¨æ–¹æ³• æ–¹æ³•ã€æè¿° è¯´æ˜ execute(Runnable command) æ‰§è¡ŒRunnableä»»åŠ¡ submit(Callable\u0026lt;T\u0026gt; task) æ‰§è¡ŒCallableä»»åŠ¡ï¼Œè¿”å›æœªæ¥ä»»åŠ¡å¯¹è±¡ï¼Œç”¨äºè·å–çº¿ç¨‹è¿”å›çš„ç»“æœ shutdown() ç­‰å…¨éƒ¨ä»»åŠ¡æ‰§è¡Œå®Œæ¯•åï¼Œå†å…³é—­çº¿ç¨‹æ± ï¼ List\u0026lt;Runnable\u0026gt; shutdownNow() ç«‹åˆ»å…³é—­çº¿ç¨‹æ± ï¼Œåœæ­¢æ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡ï¼Œå¹¶è¿”å›é˜Ÿåˆ—ä¸­æœªæ‰§è¡Œçš„ä»»åŠ¡ æ‰§è¡ŒRunnableä»»åŠ¡ import java.util.concurrent.*; public class Main { public static void main(String[] args) { // åˆ›å»ºçº¿ç¨‹æ±  // ä½¿ç”¨ ThreadPoolExecutor æ„é€ æ–¹æ³•è‡ªå®šä¹‰çº¿ç¨‹æ±  ExecutorService pool = new ThreadPoolExecutor( 3, // æ ¸å¿ƒçº¿ç¨‹æ•° 5, // æœ€å¤§çº¿ç¨‹æ•° 8, // çº¿ç¨‹ç©ºé—²æ—¶é—´ TimeUnit.SECONDS, // æ—¶é—´å•ä½ new ArrayBlockingQueue\u0026lt;\u0026gt;(4), // å·¥ä½œé˜Ÿåˆ— Executors.defaultThreadFactory(), // çº¿ç¨‹å·¥å‚ï¼Œ ç”¨äºåˆ›å»ºæ–°çº¿ç¨‹çš„å®ä¾‹ã€‚ new ThreadPoolExecutor.CallerRunsPolicy() // æ‹’ç»ç­–ç•¥ ); // åˆ›å»ºä»»åŠ¡ Runnable target = new MyRunnable(); // æäº¤ä»»åŠ¡ç»™çº¿ç¨‹æ± æ‰§è¡Œ pool.execute(target); // ä½¿ç”¨æ ¸å¿ƒçº¿ç¨‹æ‰§è¡Œä»»åŠ¡ pool.execute(target); // ä½¿ç”¨æ ¸å¿ƒçº¿ç¨‹æ‰§è¡Œä»»åŠ¡ pool.execute(target); // ä½¿ç”¨æ ¸å¿ƒçº¿ç¨‹æ‰§è¡Œä»»åŠ¡ pool.execute(target); // å¤ç”¨å‰é¢çš„æ ¸å¿ƒçº¿ç¨‹æ‰§è¡Œä»»åŠ¡ pool.execute(target); // å¤ç”¨å‰é¢çš„æ ¸å¿ƒçº¿ç¨‹æ‰§è¡Œä»»åŠ¡ pool.execute(target); // å¤ç”¨å‰é¢çš„æ ¸å¿ƒçº¿ç¨‹æ‰§è¡Œä»»åŠ¡ pool.execute(target); // å¤ç”¨å‰é¢çš„æ ¸å¿ƒçº¿ç¨‹æ‰§è¡Œä»»åŠ¡ pool.execute(target); // ä½¿ç”¨ä¸´æ—¶çº¿ç¨‹æ‰§è¡Œä»»åŠ¡ pool.execute(target); // ä½¿ç”¨ä¸´æ—¶çº¿ç¨‹æ‰§è¡Œä»»åŠ¡ pool.execute(target); // æ‰§è¡Œä»»åŠ¡è¢«æ‹’ç»ï¼ˆæ‹’ç»ç­–ç•¥å†³å®šï¼‰ pool.execute(target); // æ‰§è¡Œä»»åŠ¡è¢«æ‹’ç»ï¼ˆæ‹’ç»ç­–ç•¥å†³å®šï¼‰ // å…³é—­çº¿ç¨‹æ±  // pool.shutdown(); // pool.shutdownNow(); } } // è‡ªå®šä¹‰ä»»åŠ¡ class MyRunnable implements Runnable { @Override public void run() { // ä»»åŠ¡é€»è¾‘ } } æ‰§è¡ŒCallableä»»åŠ¡ import java.util.concurrent.*; public class Main { public static void main(String[] args) throws ExecutionException, InterruptedException { // åˆ›å»ºçº¿ç¨‹æ±  ExecutorService pool = new ThreadPoolExecutor( 3, // æ ¸å¿ƒçº¿ç¨‹æ•° 5, // æœ€å¤§çº¿ç¨‹æ•° 8, // çº¿ç¨‹ç©ºé—²æ—¶é—´ TimeUnit.SECONDS, // æ—¶é—´å•ä½ new ArrayBlockingQueue\u0026lt;\u0026gt;(4), // å·¥ä½œé˜Ÿåˆ— Executors.defaultThreadFactory(), // çº¿ç¨‹å·¥å‚ new ThreadPoolExecutor.CallerRunsPolicy() // æ‹’ç»ç­–ç•¥ ); // æäº¤å¯è°ƒç”¨ä»»åŠ¡ç»™çº¿ç¨‹æ± æ‰§è¡Œ Future\u0026lt;String\u0026gt; f1 = pool.submit(new MyCallable(100)); // æäº¤ä»»åŠ¡å¹¶è·å– Future å¯¹è±¡ Future\u0026lt;String\u0026gt; f2 = pool.submit(new MyCallable(200)); // æäº¤ä»»åŠ¡å¹¶è·å– Future å¯¹è±¡ Future\u0026lt;String\u0026gt; f3 = pool.submit(new MyCallable(300)); // æäº¤ä»»åŠ¡å¹¶è·å– Future å¯¹è±¡ Future\u0026lt;String\u0026gt; f4 = pool.submit(new MyCallable(400)); // æäº¤ä»»åŠ¡å¹¶è·å– Future å¯¹è±¡ // è·å–ä»»åŠ¡æ‰§è¡Œç»“æœå¹¶è¾“å‡º System.out.println(f1.get()); // é˜»å¡ç­‰å¾…ä»»åŠ¡æ‰§è¡Œå®Œæˆï¼Œå¹¶è·å–ç»“æœ System.out.println(f2.get()); // é˜»å¡ç­‰å¾…ä»»åŠ¡æ‰§è¡Œå®Œæˆï¼Œå¹¶è·å–ç»“æœ System.out.println(f3.get()); // é˜»å¡ç­‰å¾…ä»»åŠ¡æ‰§è¡Œå®Œæˆï¼Œå¹¶è·å–ç»“æœ System.out.println(f4.get()); // é˜»å¡ç­‰å¾…ä»»åŠ¡æ‰§è¡Œå®Œæˆï¼Œå¹¶è·å–ç»“æœ // å…³é—­çº¿ç¨‹æ±  pool.shutdown(); } } // è‡ªå®šä¹‰å¯è°ƒç”¨ä»»åŠ¡ class MyCallable implements Callable\u0026lt;String\u0026gt; { private int value; public MyCallable(int value) { this.value = value; } @Override public String call() throws Exception { // ä»»åŠ¡é€»è¾‘ return \u0026#34;Result: \u0026#34; + value; } } Executors æ˜¯ä¸€ä¸ªçº¿ç¨‹æ± çš„å·¥å…·ç±»ï¼Œæä¾›é‡Œå¾ˆå¤šé™æ€æ–¹æ³•ç”¨äºè¿”å›ä¸åŒç‰¹ç‚¹çš„çº¿ç¨‹æ± å¯¹è±¡ Executorsä½¿ç”¨å¯èƒ½å­˜åœ¨çš„é™·è¿›\nå¤§å‹å¹¶å‘ç³»ç»Ÿç¯å¢ƒä¸­ä½¿ç”¨Executorså¦‚æœä¸æ³¨æ„å¯èƒ½ä¼šå‡ºç°ç³»ç»Ÿé£é™© ã€å¼ºåˆ¶ã€‘çº¿ç¨‹æ± ä¸å…è®¸ä½¿ç”¨ Executors å»åˆ›å»ºï¼Œè€Œæ˜¯é€šè¿‡ ThreadPoolExecutor çš„æ–¹å¼ï¼Œè¿™ æ ·çš„å¤„ç†æ–¹å¼è®©å†™çš„åŒå­¦æ›´åŠ æ˜ç¡®çº¿ç¨‹æ± çš„è¿è¡Œè§„åˆ™ï¼Œè§„é¿èµ„æºè€—å°½çš„é£é™©ã€‚ è¯´æ˜ï¼šExecutors è¿”å›çš„çº¿ç¨‹æ± å¯¹è±¡çš„å¼Šç«¯å¦‚ä¸‹ï¼š 1ï¼‰ FixedThreadPool å’Œ SingleThreadPoolï¼š å…è®¸çš„è¯·æ±‚é˜Ÿåˆ—é•¿åº¦ä¸º Integer.MAX_VALUEï¼Œå¯èƒ½ä¼šå †ç§¯å¤§é‡çš„è¯·æ±‚ï¼Œä»è€Œå¯¼è‡´ OOM(OutOfMemoryError)ã€‚ 2ï¼‰ CachedThreadPoolï¼š å…è®¸çš„åˆ›å»ºçº¿ç¨‹æ•°é‡ä¸º Integer.MAX_VALUEï¼Œå¯èƒ½ä¼šåˆ›å»ºå¤§é‡çš„çº¿ç¨‹ï¼Œä»è€Œå¯¼è‡´ OOMã€‚ volatile å…³é”®å­— ä½œç”¨: å¯è§æ€§ä¿è¯ ï¼š å½“å¤šä¸ªçº¿ç¨‹è®¿é—®åŒä¸€ä¸ªå˜é‡æ—¶ï¼Œå¦‚æœä½¿ç”¨ä¸åŒçš„åŒæ­¥æœºåˆ¶ï¼Œçº¿ç¨‹å¯èƒ½ä¼šç¼“å­˜å˜é‡çš„å€¼ï¼Œå¹¶ä¸ä¼šç«‹å³ä»ä¸»å†…å­˜ä¸­è¯»å–æˆ–å†™å›ï¼Œä½¿ç”¨volatileä¿®é¥°çš„å˜é‡ï¼Œèƒ½å¤Ÿä¿è¯å¯¹è¯¥å˜é‡çš„æ‰€æœ‰å†™æ“ä½œéƒ½ä¼šç«‹å³è¢«åˆ·æ–°åˆ°ä¸»å†…å­˜ä¸­ï¼Œæ‰€æœ‰å¯¹å®ƒçš„è¯»å–æ“ä½œä¹Ÿä¼šç›´æ¥ä»ä¸»å†…å­˜ä¸­è¯»å–ï¼Œè€Œä¸æ˜¯ä»çº¿ç¨‹çš„æœ¬åœ°ç¼“å­˜ä¸­è¯»å–ã€‚å³ä¸€ä¸ªçº¿ç¨‹å¯¹volatileå˜é‡æ‰€åšçš„å†™æ“ä½œï¼Œå¯¹å…¶ä»–çº¿ç¨‹æ¥è¯´æ˜¯ç«‹å³å¯è§çš„ã€‚ é˜²æ­¢æŒ‡ä»¤é‡æ’ï¼šJavaç¼–è¯‘å™¨ï¼ŒJVMï¼Œå’ŒCPUåœ¨æ‰§è¡Œä»£ç æ—¶ï¼Œå¯èƒ½ä¼šä¸ºäº†æé«˜æ€§èƒ½è€Œå¯¹æŒ‡ä»¤è¿›è¡Œé‡æ’åºï¼Œè¿™å›å¯¼è‡´æŸäº›æ“ä½œçš„æ‰§è¡Œé¡ºåºå’Œä»£ç ä¸­çš„é¡ºåºä¸ä¸€æ ·ã€‚volatileä¿è¯åœ¨è¯»å–æˆ–å†™å…¥å˜é‡æ—¶ï¼Œä¹‹å‰çš„æ“ä½œä¸€å®šå·²ç»å®Œæˆï¼Œä¹‹åçš„æ“ä½œä¸€å®šä¸ä¼šè¢«é‡æ’åºåˆ°å®ƒä¹‹å‰ã€‚ æ³¨æ„ç‚¹ï¼š ä¸èƒ½ä¿è¯åŸå­æ€§ï¼švolatileä»…ä»…ä¿è¯äº†å¯è§æ€§å’Œç¦æ­¢æŒ‡ä»¤é‡æ’ï¼Œä½†å®ƒå¹¶ä¸èƒ½ä¿è¯æ“ä½œçš„åŸå­æ€§ã€‚ä¾‹å¦‚ï¼Œå¯¹äºvolatile intå˜é‡è¿›è¡Œè‡ªå¢æ“ä½œ count ++ , å¹¶ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå› ä¸ºè‡ªå¢æ“ä½œå®é™…ä¸Šåˆ†ä¸ºä¸‰æ­¥ï¼ˆè¯»å–ï¼ŒåŠ ä¸€ï¼Œå†™å›ï¼‰ï¼Œè¿™äº›æ­¥éª¤å¯èƒ½è¢«å¤šä¸ªçº¿ç¨‹åŒæ—¶æ‰§è¡Œè€Œäº’ç›¸å¹²æ‰°ã€‚ é€‚ç”¨åœºæ™¯ï¼šé€‚ç”¨äºå“ªäº›éœ€è¦ç®€å•è¯»å†™æ“ä½œçš„å…±äº«å˜é‡ï¼Œæ¯”å¦‚æ ‡å¿—ä½ï¼ŒçŠ¶æ€å˜é‡ç­‰ã€‚å¦‚æœéœ€è¦æ›´å¤æ‚çš„æ“ä½œï¼Œæœ€å¥½ä½¿ç”¨synchronizedæˆ–å…¶ä»–é”æœºåˆ¶ã€‚ å¹¶å‘ã€å¹¶è¡Œ è¿›ç¨‹\næ­£åœ¨è¿è¡Œçš„ç¨‹åºï¼ˆè½¯ä»¶ï¼‰å°±æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„è¿›ç¨‹ çº¿ç¨‹æ˜¯å±äºè¿›ç¨‹çš„ï¼Œä¸€ä¸ªè¿›ç¨‹ä¸­å¯ä»¥åŒæ—¶è¿è¡Œå¤šä¸ªçº¿ç¨‹ è¿›ç¨‹ä¸­çš„å¤šä¸ªçº¿ç¨‹å…¶å®æ˜¯å¹¶å‘å’Œå¹¶è¡Œæ‰§è¡Œçš„ å¹¶å‘çš„å«ä¹‰\nè¿›ç¨‹ä¸­çš„çº¿ç¨‹æ˜¯ç”±CPUè´Ÿè´£è°ƒåº¦æ‰§è¡Œçš„ï¼Œä½†CPUèƒ½åŒæ—¶å¤„ç†çº¿ç¨‹çš„æ•°é‡æœ‰é™ï¼Œä¸ºäº†ä¿è¯å…¨éƒ¨çº¿ç¨‹éƒ½èƒ½å¾€å‰æ‰§è¡Œï¼Œ CPUä¼šè½®è¯¢ä¸ºç³»ç»Ÿçš„æ¯ä¸ªçº¿ç¨‹æœåŠ¡ï¼Œç”±äºCPUåˆ‡æ¢çš„é€Ÿåº¦å¾ˆå¿«ï¼Œç»™æˆ‘ä»¬çš„æ„Ÿè§‰è¿™äº›çº¿ç¨‹åœ¨åŒæ—¶æ‰§è¡Œï¼Œè¿™å°±æ˜¯å¹¶å‘ å¹¶è¡Œçš„ç†è§£\nåœ¨åŒä¸€ä¸ªæ—¶åˆ»ä¸Šï¼ŒåŒæ—¶æœ‰å¤šä¸ªçº¿ç¨‹åœ¨è¢«CPUè°ƒåº¦æ‰§è¡Œ çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸ çº¿ç¨‹çš„6ç§çŠ¶æ€æ€»ç»“ çŠ¶æ€åç§° è¯´æ˜ NEW(æ–°å»º) çº¿ç¨‹åˆšè¢«åˆ›å»ºï¼Œä½†æ˜¯å¹¶æœªå¯åŠ¨ Runnable(å¯è¿è¡Œ) çº¿ç¨‹å·²ç»è°ƒç”¨äº†start()ï¼Œ ç­‰å¾…CPUè°ƒåº¦ Blocked(è¢«é˜»å¡) çº¿ç¨‹åœ¨æ‰§è¡Œçš„æ—¶å€™æœªç«äº‰åˆ°é”å¯¹è±¡ï¼Œåˆ™è¯¥çº¿ç¨‹è¿›å…¥BlockedçŠ¶æ€ Waiting(ç­‰å¾…) ä¸€ä¸ªçº¿ç¨‹è¿›å…¥WaitingçŠ¶æ€ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹éœ€è¦Notifyæˆ–è€…notifyAllæ‰èƒ½å¤Ÿå”¤é†’ã€‚ Timed Waiting (è®¡æ—¶ç­‰å¾…) åŒWaitingçŠ¶æ€ç±»ä¼¼ï¼Œæœ‰å‡ ä¸ªæ–¹æ³•ï¼ˆsleepï¼Œ waitï¼‰æœ‰è¶…æ—¶å‚æ•°ï¼Œè°ƒç”¨ä»–ä»¬å°†è¿›å…¥Timed WaitingçŠ¶æ€ Terminated (è¢«ç»ˆæ­¢) å› ä¸ºrunæ–¹æ³•æ­£å¸¸é€€å‡ºè€Œæ­»äº¡ï¼Œæˆ–è€…å› ä¸ºæ²¡æœ‰æ•è·çš„å¼‚å¸¸ç»ˆæ­¢äº†runæ–¹æ³•è€Œæ­»äº¡. æ‚²è§‚é”ã€ä¹è§‚é”åŸç† æ‚²è§‚é”ï¼šä¸€ä¸Šæ¥å°±åŠ é”ï¼Œæ²¡æœ‰å®‰å…¨æ„Ÿï¼Œæ¯æ¬¡åªèƒ½ä¸€ä¸ªçº¿ç¨‹è¿›å…¥è®¿é—®å®Œæ¯•åï¼Œå†è§£é”ï¼Œçº¿ç¨‹å®‰å…¨ï¼Œæ€§èƒ½è¾ƒå·® ä¹è§‚é”ï¼šä¸€å¼€å§‹ä¸ä¸Šé”ï¼Œè®¤ä¸ºæ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œå¤§å®¶ä¸€èµ·è·‘ï¼Œç­‰è¦å‡ºç°çº¿ç¨‹å®‰å…¨é—®é¢˜çš„æ—¶å€™æ‰å¼€å§‹æ§åˆ¶ã€‚çº¿ç¨‹å®‰å…¨ï¼Œæ€§èƒ½è¾ƒå¥½ CASç®—æ³• package com.showguan.ExtendDemo; import java.util.concurrent.atomic.AtomicInteger; /** * è¿™ä¸ªç¨‹åºæ¼”ç¤ºäº†ä¹è§‚é”çš„ä½¿ç”¨ã€‚ * * ä¹è§‚é”æ˜¯ä¸€ç§å¹¶å‘æ§åˆ¶æœºåˆ¶ï¼Œå®ƒå‡è®¾å¯¹æ•°æ®çš„è¯»å–æ“ä½œä¸ä¼šé€ æˆæ•°æ®å†²çªï¼Œå› æ­¤ä¸éœ€è¦å¯¹æ•°æ®è¿›è¡ŒåŠ é”æ“ä½œã€‚ * ç›¸åï¼Œå®ƒåœ¨æ›´æ–°æ•°æ®æ—¶æ£€æŸ¥æ˜¯å¦æœ‰å…¶ä»–çº¿ç¨‹å·²ç»ä¿®æ”¹äº†æ•°æ®ï¼Œå¦‚æœæ²¡æœ‰åˆ™è¿›è¡Œæ›´æ–°ï¼Œå¦‚æœæœ‰åˆ™è¿›è¡Œç›¸åº”çš„å¤„ç†ï¼Œæ¯”å¦‚é‡è¯•æˆ–è€…æ”¾å¼ƒæ›´æ–°ã€‚ * * åœ¨è¿™ä¸ªç¨‹åºä¸­ï¼Œæˆ‘ä»¬æ¯”è¾ƒäº†ä¸¤ç§å®ç°æ–¹å¼ï¼š * 1. ä½¿ç”¨ synchronized å…³é”®å­—å®ç°çš„æ‚²è§‚é”ï¼ˆMyRunnable ç±»ï¼‰ * 2. ä½¿ç”¨ AtomicInteger å®ç°çš„ä¹è§‚é”ï¼ˆMyRunnable2 ç±»ï¼‰ * * MyRunnable ç±»ä¸­ä½¿ç”¨äº† synchronized å…³é”®å­—æ¥ä¿è¯å¤šçº¿ç¨‹ç¯å¢ƒä¸‹å¯¹ count å˜é‡çš„å®‰å…¨è®¿é—®ï¼Œå®ƒæ˜¯ä¸€ç§æ‚²è§‚é”çš„å®ç°æ–¹å¼ï¼Œ * æ¯ä¸ªçº¿ç¨‹åœ¨è®¿é—® count å˜é‡æ—¶éƒ½éœ€è¦è·å¾—å¯¹è±¡é”ï¼Œå› æ­¤åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½å¤Ÿæ‰§è¡Œä¸´ç•ŒåŒºä»£ç ï¼Œå…¶ä»–çº¿ç¨‹éœ€è¦ç­‰å¾…é‡Šæ”¾é”æ‰èƒ½æ‰§è¡Œã€‚ * * MyRunnable2 ç±»ä¸­ä½¿ç”¨äº† AtomicInteger æ¥å®ç°ä¹è§‚é”ã€‚AtomicInteger æä¾›äº†ä¸€ç§åŸå­æ€§çš„æ›´æ–°æ“ä½œï¼Œä¿è¯äº†åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹çš„å®‰å…¨è®¿é—®ã€‚ * åœ¨è¿™ç§å®ç°æ–¹å¼ä¸­ï¼Œçº¿ç¨‹ä¸éœ€è¦è·å–é”ï¼Œè€Œæ˜¯ç›´æ¥é€šè¿‡åŸå­æ€§çš„æ“ä½œæ¥æ›´æ–° count å˜é‡ï¼Œå› æ­¤å¯ä»¥å®ç°æ›´é«˜çš„å¹¶å‘æ€§èƒ½ã€‚ * * åœ¨å®é™…åº”ç”¨ä¸­ï¼Œé€‰æ‹©åˆé€‚çš„é”æœºåˆ¶å–å†³äºå…·ä½“çš„åœºæ™¯å’Œæ€§èƒ½éœ€æ±‚ã€‚å¦‚æœå¯¹æ•°æ®çš„æ›´æ–°æ“ä½œæ¯”è¾ƒé¢‘ç¹ï¼Œä¸”ç«äº‰ä¸æ˜¯å¾ˆæ¿€çƒˆï¼Œå¯ä»¥é€‰æ‹©ä¹è§‚é”æ¥æå‡æ€§èƒ½ï¼› * å¦‚æœç«äº‰æ¯”è¾ƒæ¿€çƒˆï¼Œæˆ–è€…å¯¹æ•°æ®çš„ä¸€è‡´æ€§è¦æ±‚è¾ƒé«˜ï¼Œåˆ™å¯ä»¥é€‰æ‹©æ‚²è§‚é”æ¥ä¿è¯æ•°æ®çš„æ­£ç¡®æ€§ã€‚ */ public class Demo1 { public static void main(String[] args) { // Runnable target = new MyRunnable(); // for (int i = 1; i \u0026lt;= 100; i++) { // new Thread(target).start(); // } Runnable target = new MyRunnable2(); for (int i = 1; i \u0026lt;= 100; i++) { new Thread(target).start(); } } } package com.showguan.ExtendDemo; /** * å®ç°äº† Runnable æ¥å£çš„ç±»ï¼Œä½¿ç”¨ synchronized å…³é”®å­—å®ç°çš„æ‚²è§‚é”ã€‚ */ public class MyRunnable implements Runnable{ private int count; @Override public void run() { synchronized (this) { for (int i = 1; i \u0026lt;= 100; i++) { // System.out.println(this); System.out.println(Thread.currentThread().getName() + \u0026#34; Count: \u0026#34; + (++count)); } } } } package com.showguan.ExtendDemo; import java.util.concurrent.atomic.AtomicInteger; /** * å®ç°äº† Runnable æ¥å£çš„ç±»ï¼Œä½¿ç”¨ AtomicInteger å®ç°çš„ä¹è§‚é”ã€‚ */ public class MyRunnable2 implements Runnable{ private AtomicInteger count = new AtomicInteger(); @Override public void run() { for (int i = 1; i \u0026lt;= 100; i++) { // System.out.println(this); System.out.println(Thread.currentThread().getName() + \u0026#34; Count: \u0026#34; + (count.incrementAndGet())); } } } æ¡ˆä¾‹ package com.showguan.Test; import java.util.ArrayList; import java.util.List; import java.util.Random; public class Demo1 { public static void main(String[] args) throws InterruptedException { // åˆ›å»ºç¤¼ç‰©åˆ—è¡¨ List\u0026lt;String\u0026gt; gift = new ArrayList\u0026lt;\u0026gt;(); // å®šä¹‰ç¤¼ç‰©åç§°æ•°ç»„ String[] names = {\u0026#34;å£çº¢\u0026#34;, \u0026#34;çˆ±é©¬ä»•\u0026#34;, \u0026#34;iphone\u0026#34;, \u0026#34;æ‰‹è¡¨\u0026#34;, \u0026#34;mac\u0026#34;}; // éšæœºæ•°ç”Ÿæˆå™¨ Random r = new Random(); // å¾ªç¯æ·»åŠ ç¤¼ç‰©åˆ°åˆ—è¡¨ä¸­ for (int i = 1; i \u0026lt;= 1000; i++) { gift.add(names[r.nextInt(names.length)] + \u0026#34; \u0026#34; + (i+1)); // åœ¨ç¤¼ç‰©åˆ—è¡¨ä¸­æ·»åŠ éšæœºé€‰å–çš„ç¤¼ç‰© } System.out.println(gift); // æ‰“å°ç¤¼ç‰©åˆ—è¡¨ System.out.println(\u0026#34;-------------\u0026#34;); // åˆ›å»ºä¸¤ä¸ªå‘é€çº¿ç¨‹ï¼Œåˆ†åˆ«ä»£è¡¨å°çº¢å’Œå°æ˜ SendThread xh = new SendThread(gift, \u0026#34;å°çº¢\u0026#34;); xh.start(); SendThread xm = new SendThread(gift, \u0026#34;å°æ˜\u0026#34;); xm.start(); // ç­‰å¾…ä¸¤ä¸ªå‘é€çº¿ç¨‹ç»“æŸ xm.join(); xh.join(); // æ‰“å°ä¸¤ä¸ªå‘é€çº¿ç¨‹å‘é€çš„ç¤¼ç‰©æ•°é‡ System.out.println(\u0026#34;å°æ˜å‘å‡ºäº†ï¼š\u0026#34; + xm.getCount()); System.out.println(\u0026#34;å°çº¢å‘å‡ºäº†ï¼š\u0026#34; + xh.getCount()); } } package com.showguan.Test; import java.util.List; import java.util.Random; public class SendThread extends Thread { private List\u0026lt;String\u0026gt; gift; // ç¤¼ç‰©åˆ—è¡¨ private int count; // å‘é€çš„ç¤¼ç‰©æ•°é‡ // æ„é€ æ–¹æ³• public SendThread(List\u0026lt;String\u0026gt; gift, String name) { super(name); // è°ƒç”¨çˆ¶ç±»æ„é€ æ–¹æ³•ï¼Œè®¾ç½®çº¿ç¨‹å this.gift = gift; // åˆå§‹åŒ–ç¤¼ç‰©åˆ—è¡¨ } @Override public void run() { Random r = new Random(); // éšæœºæ•°ç”Ÿæˆå™¨ String name = Thread.currentThread().getName(); // è·å–å½“å‰çº¿ç¨‹å while (true) { synchronized (gift){ // åŒæ­¥å—ï¼Œç¡®ä¿ç¤¼ç‰©åˆ—è¡¨çš„çº¿ç¨‹å®‰å…¨ if(gift.size()\u0026lt;10){ // å½“ç¤¼ç‰©åˆ—è¡¨æ•°é‡å°äº10æ—¶ï¼Œç»“æŸå¾ªç¯ break; } String rs = gift.remove(r.nextInt(gift.size())); // ä»ç¤¼ç‰©åˆ—è¡¨ä¸­éšæœºé€‰æ‹©ä¸€ä¸ªç¤¼ç‰©ï¼Œå¹¶ç§»é™¤ System.out.println(name + \u0026#34; å‘å‡ºäº†ç¤¼å“ï¼š \u0026#34; + rs); // æ‰“å°å‘é€çš„ç¤¼ç‰©ä¿¡æ¯ count++; // è®°å½•å‘é€çš„ç¤¼ç‰©æ•°é‡ } } } // è·å–å‘é€çš„ç¤¼ç‰©æ•°é‡ public int getCount() { return count; } // è®¾ç½®å‘é€çš„ç¤¼ç‰©æ•°é‡ public void setCount(int count) { this.count = count; } } ","permalink":"https://kennems.github.io/posts/tech/java20%E5%A4%A9%E9%80%9F%E6%88%90%E8%BF%9B%E9%98%B6%E8%AF%BE%E7%A8%8B4/","summary":"Java20å¤©é€Ÿæˆâ€”â€”è¿›é˜¶è¯¾ç¨‹(4) ç‰¹æ®Šæ–‡ä»¶ properties, xml ä¸ºä»€ä¹ˆè¦ç”¨è¿™äº›ç‰¹æ®Šæ–‡ä»¶ï¼Ÿ å­˜å‚¨å¤šä¸ªç”¨æˆ·çš„ï¼šç”¨æˆ·åï¼Œ å¯†ç ï¼Œ å®¶ä¹¡ï¼Œ æ€§åˆ« æ—¥å¿—æŠ€æœ¯ æŠŠç¨‹åºè¿è¡Œçš„ä¿¡æ¯ï¼Œè®°","title":"Java20å¤©é€Ÿæˆâ€”â€”è¿›é˜¶è¯¾ç¨‹(4)"},{"content":"Java20å¤©é€Ÿæˆâ€”â€”è¿›é˜¶è¯¾ç¨‹(3) æ–‡ä»¶æ“ä½œ Fileå¯¹è±¡ å¸¸ç”¨æ–¹æ³• public static void main(String[] args) { // åˆ›å»ºFileå¯¹è±¡ï¼Œè¡¨ç¤ºæ–‡ä»¶test.txtçš„ç»å¯¹è·¯å¾„ File f1 = new File(\u0026#34;D:/JAVA/JavaSeProMax/file-io-app/src/com/showguan/FileDemo/test.txt\u0026#34;); // åˆ›å»ºFileå¯¹è±¡ï¼Œè¡¨ç¤ºæ–‡ä»¶å¤¹JavaSeProMaxçš„ç»å¯¹è·¯å¾„ File f2 = new File(\u0026#34;D:/JAVA\u0026#34;); // åˆ›å»ºFileå¯¹è±¡ï¼Œè¡¨ç¤ºä¸å­˜åœ¨çš„æ–‡ä»¶è·¯å¾„t.txt File f3 = new File(\u0026#34;D:/JAVA/t.txt\u0026#34;); // è¾“å‡ºæ–‡ä»¶f1çš„é•¿åº¦ï¼ˆå­—èŠ‚æ•°ï¼‰ System.out.println(f1.length()); // è¾“å‡ºæ–‡ä»¶å¤¹f2çš„é•¿åº¦ï¼Œç”±äºf2è¡¨ç¤ºæ–‡ä»¶å¤¹ï¼Œè€Œä¸æ˜¯æ–‡ä»¶ï¼Œå› æ­¤è¿”å›å€¼æ²¡æœ‰æ„ä¹‰ System.out.println(f2.length()); // è¾“å‡ºæ–‡ä»¶f3çš„é•¿åº¦ï¼Œç”±äºæ–‡ä»¶è·¯å¾„ä¸å­˜åœ¨ï¼Œå› æ­¤è¿”å›0 System.out.println(f3.length()); // æ£€æŸ¥æ–‡ä»¶f3æ˜¯å¦å­˜åœ¨ï¼Œè¿”å›falseï¼Œå› ä¸ºæ–‡ä»¶è·¯å¾„ä¸å­˜åœ¨ System.out.println(f3.exists()); // åˆ›å»ºFileå¯¹è±¡ï¼Œè¡¨ç¤ºç›¸å¯¹è·¯å¾„ä¸‹çš„æ–‡ä»¶test.txt // ç›¸å¯¹è·¯å¾„é»˜è®¤ä»å½“å‰å·¥ç¨‹çš„æ ¹ç›®å½•å¼€å§‹å¯»æ‰¾ï¼Œå› æ­¤æ–‡ä»¶è·¯å¾„ä¸å­˜åœ¨ File f4 = new File(\u0026#34;file-io-app\\\\src\\\\com\\\\showguan\\\\FileDemo\\\\test.txt\u0026#34;); // æ£€æŸ¥æ–‡ä»¶f4æ˜¯å¦å­˜åœ¨ï¼Œè¿”å›falseï¼Œå› ä¸ºæ–‡ä»¶è·¯å¾„ä¸å­˜åœ¨ System.out.println(f4.exists()); // è¾“å‡ºæ–‡ä»¶f4çš„é•¿åº¦ï¼Œç”±äºæ–‡ä»¶è·¯å¾„ä¸å­˜åœ¨ï¼Œå› æ­¤è¿”å›0 System.out.println(f4.length()); } public static void main(String[] args) { // åˆ›å»ºFileå¯¹è±¡ï¼Œè¡¨ç¤ºç›¸å¯¹è·¯å¾„ä¸‹çš„æ–‡ä»¶test.txt File f1 = new File(\u0026#34;file-io-app\\\\src\\\\com\\\\showguan\\\\FileDemo\\\\test.txt\u0026#34;); // åˆ›å»ºFileå¯¹è±¡ï¼Œè¡¨ç¤ºæ–‡ä»¶å¤¹file-io-appçš„è·¯å¾„ File f2 = new File(\u0026#34;file-io-app\u0026#34;); // æ£€æŸ¥æ–‡ä»¶f1æ˜¯å¦å­˜åœ¨ï¼Œè¿”å›trueï¼Œå› ä¸ºæ–‡ä»¶è·¯å¾„å­˜åœ¨ System.out.println(f1.exists()); // æ£€æŸ¥f1æ˜¯å¦è¡¨ç¤ºä¸€ä¸ªæ–‡ä»¶ï¼Œè¿”å›true System.out.println(f1.isFile()); // æ£€æŸ¥f1æ˜¯å¦è¡¨ç¤ºä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œè¿”å›false System.out.println(f1.isDirectory()); // æ£€æŸ¥f2æ˜¯å¦è¡¨ç¤ºä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œè¿”å›true System.out.println(f2.isDirectory()); // è·å–æ–‡ä»¶f1çš„åç§°ï¼Œè¾“å‡ºtest.txt System.out.println(f1.getName()); // è·å–æ–‡ä»¶f1çš„é•¿åº¦ï¼ˆå­—èŠ‚æ•°ï¼‰ System.out.println(f1.length()); // è·å–æ–‡ä»¶f1æœ€åä¿®æ”¹æ—¶é—´ long time = f1.lastModified(); // æ ¼å¼åŒ–æœ€åä¿®æ”¹æ—¶é—´å¹¶è¾“å‡º SimpleDateFormat sdf = new SimpleDateFormat(\u0026#34;yyyy/MM/dd HH:mm:ss\u0026#34;); System.out.println(sdf.format(time)); // è·å–æ–‡ä»¶f1çš„è·¯å¾„ï¼ˆåˆ›å»ºæ—¶ä½¿ç”¨çš„è·¯å¾„ï¼‰ï¼Œè¾“å‡ºç›¸å¯¹è·¯å¾„file-io-app\\src\\com\\showguan\\FileDemo\\test.txt System.out.println(f1.getPath()); // è·å–æ–‡ä»¶f1çš„ç»å¯¹è·¯å¾„ï¼Œè¾“å‡ºå®Œæ•´çš„ç»å¯¹è·¯å¾„ System.out.println(f1.getAbsolutePath()); } åˆ›å»ºæ–‡ä»¶ã€ç›®å½• import java.io.File; import java.io.IOException; public static void main(String[] args) throws IOException { // åˆ›å»ºFileå¯¹è±¡ï¼Œè¡¨ç¤ºæ–°æ–‡ä»¶test2.txtçš„è·¯å¾„ File f1 = new File(\u0026#34;file-io-app\\\\src\\\\com\\\\showguan\\\\FileDemo\\\\test2.txt\u0026#34;); // åˆ›å»ºæ–°æ–‡ä»¶test2.txtï¼Œå¦‚æœæ–‡ä»¶ä¸å­˜åœ¨åˆ™åˆ›å»ºå¹¶è¿”å›trueï¼Œå¦åˆ™è¿”å›false System.out.println(f1.createNewFile()); // åˆ›å»ºFileå¯¹è±¡ï¼Œè¡¨ç¤ºæ–°æ–‡ä»¶å¤¹aaaçš„è·¯å¾„ File f2 = new File(\u0026#34;file-io-app\\\\src\\\\com\\\\showguan\\\\FileDemo\\\\aaa\u0026#34;); // åˆ›å»ºæ–°æ–‡ä»¶å¤¹aaaï¼Œå¦‚æœæ–‡ä»¶å¤¹ä¸å­˜åœ¨åˆ™åˆ›å»ºå¹¶è¿”å›trueï¼Œå¦åˆ™è¿”å›false System.out.println(f2.mkdir()); // åˆ›å»ºFileå¯¹è±¡ï¼Œè¡¨ç¤ºæ–°æ–‡ä»¶å¤¹è·¯å¾„a\\b\\c File f3 = new File(\u0026#34;file-io-app\\\\src\\\\com\\\\showguan\\\\FileDemo\\\\a\\\\b\\\\c\u0026#34;); // åˆ›å»ºæ–°æ–‡ä»¶å¤¹è·¯å¾„a\\b\\cï¼Œå¦‚æœè·¯å¾„ä¸­çš„æ–‡ä»¶å¤¹ä¸å­˜åœ¨åˆ™é€’å½’åˆ›å»ºï¼Œåˆ›å»ºæˆåŠŸè¿”å›trueï¼Œå¦åˆ™è¿”å›false System.out.println(f3.mkdirs()); // åˆ é™¤æ–‡ä»¶test2.txtï¼Œåˆ é™¤æˆåŠŸè¿”å›trueï¼Œå¦åˆ™è¿”å›false System.out.println(f1.delete()); // åˆ é™¤æ–‡ä»¶å¤¹aï¼Œç”±äºæ–‡ä»¶å¤¹éç©ºï¼Œå› æ­¤åˆ é™¤å¤±è´¥è¿”å›false File f4 = new File(\u0026#34;file-io-app\\\\src\\\\com\\\\showguan\\\\FileDemo\\\\a\u0026#34;); System.out.println(f4.delete()); } public static void main(String[] args) { // éå†æ–¹æ³•ï¼Œåªèƒ½éå†ä¸€çº§æ–‡ä»¶ File f1 = new File(\u0026#34;D:\\\\JAVA\u0026#34;); // è·å–D:\\JAVAç›®å½•ä¸‹çš„æ‰€æœ‰ä¸€çº§æ–‡ä»¶å String[] names = f1.list(); // éå†æ‰“å°æ‰€æœ‰ä¸€çº§æ–‡ä»¶å for (String name : names) { System.out.println(name); } // è·å–D:\\JAVAç›®å½•ä¸‹çš„æ‰€æœ‰ä¸€çº§æ–‡ä»¶å¯¹è±¡ File f2 = new File(\u0026#34;D:\\\\JAVA\u0026#34;); // è·å–D:\\JAVAç›®å½•ä¸‹çš„æ‰€æœ‰ä¸€çº§æ–‡ä»¶å¯¹è±¡ File[] files = f2.listFiles(); // éå†æ‰“å°æ‰€æœ‰ä¸€çº§æ–‡ä»¶å¯¹è±¡çš„ç»å¯¹è·¯å¾„ for (File file : files) { System.out.println(file.getAbsoluteFile()); } // å°è¯•è·å–ä¸å­˜åœ¨çš„ç›®å½•çš„ä¸€çº§æ–‡ä»¶å¯¹è±¡ï¼Œè¿”å›null File f3 = new File(\u0026#34;D:\\\\JAVA1\u0026#34;); System.out.println(f3.listFiles()); // null // å°è¯•è·å–éæ–‡ä»¶å¤¹çš„ä¸€çº§æ–‡ä»¶å¯¹è±¡ï¼Œè¿”å›null File f4 = new File(\u0026#34;D:\\\\JAVA\\\\test1\u0026#34;); // å› ä¸ºf4ä»£è¡¨çš„è·¯å¾„ä¸æ˜¯æ–‡ä»¶å¤¹ï¼Œå› æ­¤listFiles()è¿”å›null File[] files4 = f4.listFiles(); System.out.println(Arrays.toString(files4)); // null } é€’å½’æŸ¥æ‰¾ public static void main(String[] args) throws IOException { searchFile(new File(\u0026#34;D:\\\\æ–‡æ¡£\u0026#34;), \u0026#34;23æš‘æœŸé’è®­è¥ç¬”è®°\u0026#34;); // è°ƒç”¨æœç´¢æ–‡ä»¶çš„æ–¹æ³• } /** * é€’å½’æœç´¢æŒ‡å®šç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œå¹¶æ‰“å°æ‰¾åˆ°çš„æ–‡ä»¶çš„ç»å¯¹è·¯å¾„ï¼Œå¹¶ä½¿ç”¨ç³»ç»Ÿé»˜è®¤ç¨‹åºæ‰“å¼€è¯¥æ–‡ä»¶ã€‚ * @param dir è¦æœç´¢çš„ç›®å½• * @param fileName è¦æœç´¢çš„æ–‡ä»¶å * @throws IOException å¦‚æœå‘ç”ŸI/Oé”™è¯¯ */ public static void searchFile(File dir, String fileName) throws IOException { // å¦‚æœç›®å½•ä¸ºç©ºã€ä¸å­˜åœ¨æˆ–è€…æ˜¯æ–‡ä»¶ï¼Œåˆ™ç›´æ¥è¿”å› if(dir==null || !dir.exists() || dir.isFile()){ return ; } // è·å–ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å’Œå­ç›®å½• File[] files = dir.listFiles(); // å¦‚æœç›®å½•ä¸‹å­˜åœ¨æ–‡ä»¶ if(files!=null \u0026amp;\u0026amp; files.length\u0026gt;0){ // éå†ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å’Œå­ç›®å½• for (File file : files) { // å¦‚æœæ˜¯æ–‡ä»¶ if(file.isFile()){ // åˆ¤æ–­æ–‡ä»¶åæ˜¯å¦åŒ…å«æŒ‡å®šçš„æ–‡ä»¶å if(file.getName().contains(fileName)){ System.out.println(\u0026#34;æ‰¾åˆ°äº†ï¼\u0026#34; + file.getAbsoluteFile()); // æ‰“å°æ‰¾åˆ°çš„æ–‡ä»¶çš„ç»å¯¹è·¯å¾„ Runtime runtime = Runtime.getRuntime(); runtime.exec(file.getAbsolutePath()); // ä½¿ç”¨ç³»ç»Ÿé»˜è®¤ç¨‹åºæ‰“å¼€è¯¥æ–‡ä»¶ return; // æ‰¾åˆ°æ–‡ä»¶åç›´æ¥è¿”å› } }else{ // å¦‚æœæ˜¯ç›®å½•ï¼Œåˆ™é€’å½’è°ƒç”¨æœç´¢æ–‡ä»¶çš„æ–¹æ³• searchFile(file, fileName); } } } } é€’å½’åˆ é™¤ public static void main(String[] args) throws IOException { File file = new File(\u0026#34;D:\\\\JAVA\\\\test1\\\\test\u0026#34;); // è¦åˆ é™¤çš„ç›®å½•çš„è·¯å¾„ deleteDir(file); // è°ƒç”¨åˆ é™¤ç›®å½•çš„æ–¹æ³• } /** * é€’å½’åˆ é™¤ç›®å½•åŠå…¶æ‰€æœ‰å­ç›®å½•å’Œæ–‡ä»¶ã€‚ * @param dir è¦åˆ é™¤çš„ç›®å½• */ public static void deleteDir(File dir){ // å¦‚æœç›®å½•ä¸ºç©ºæˆ–è€…ä¸å­˜åœ¨ï¼Œåˆ™ç›´æ¥è¿”å› if(dir==null || !dir.exists()){ return ; } // å¦‚æœæ˜¯æ–‡ä»¶ï¼Œåˆ™ç›´æ¥åˆ é™¤å¹¶è¿”å› if(dir.isFile()){ dir.delete(); return; } // è·å–ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å’Œå­ç›®å½• File[] files = dir.listFiles(); // å¦‚æœç›®å½•ä¸ºç©ºï¼Œåˆ™ç›´æ¥è¿”å› if(files==null){ return; } // éå†ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å’Œå­ç›®å½• for (File file : files) { if(file.isFile()){ // å¦‚æœæ˜¯æ–‡ä»¶ï¼Œåˆ™ç›´æ¥åˆ é™¤ file.delete(); } deleteDir(file); // é€’å½’åˆ é™¤å­ç›®å½• } dir.delete(); // åˆ é™¤å½“å‰ç›®å½• } å­—ç¬¦é›† UTF-32\næ¯ä¸ªå­—ç¬¦å 4ä¸ªå­—èŠ‚ï¼Œå­˜å‚¨ç©ºé—´å¤ªå¤§ï¼Œæ²¡æœ‰æ™®åŠ UTF-8\næ˜¯Unicodeå­—ç¬¦é›†çš„ä¸€ç§ç¼–ç æ–¹æ¡ˆï¼Œé‡‡å–å¯å˜é•¿ç¼–ç æ–¹æ¡ˆï¼Œå…±åˆ†ä¸ºå››ä¸ªé•¿åº¦åŒºï¼šä¸€ä¸ªå­—èŠ‚ï¼Œä¸¤ä¸ªå­—èŠ‚ï¼Œä¸‰ä¸ªå­—èŠ‚ï¼Œå››ä¸ªå­—èŠ‚ è‹±æ–‡å­—ç¬¦ï¼Œæ•°å­—ç­‰åªå ä¸€ä¸ªå­—èŠ‚ï¼ˆå…¼å®¹æ ‡å‡†ASCIIç¼–ç ï¼‰ï¼Œæ±‰å­—å­—ç¬¦å ç”¨3ä¸ªå­—èŠ‚ã€‚ ASCIIå­—ç¬¦é›†ï¼šåªæœ‰è‹±æ–‡ã€æ•°å­—ã€ç¬¦å·ç­‰ï¼Œå 1ä¸ªå­—èŠ‚ GBKå­—ç¬¦é›†ï¼šæ±‰å­—å 2ä¸¤ä¸ªå­—èŠ‚ï¼Œè‹±æ–‡ï¼Œæ•°å­—å 1ä¸ªå­—èŠ‚ UTF-8å­—ç¬¦é›†ï¼šæ±‰å­—å 3ä¸ªå­—èŠ‚ï¼Œè‹±æ–‡ï¼Œæ•°å­—å 1ä¸ªå­—èŠ‚ import java.io.UnsupportedEncodingException; import java.util.Arrays; public static void main(String[] args) throws UnsupportedEncodingException { String data = \u0026#34;aå•Ša\u0026#34;; // ä½¿ç”¨é»˜è®¤å­—ç¬¦é›†ï¼ˆé€šå¸¸æ˜¯UTF-8ï¼‰å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºå­—èŠ‚æ•°ç»„ byte[] bytes = data.getBytes(); System.out.println(Arrays.toString(bytes)); // ä½¿ç”¨æŒ‡å®šå­—ç¬¦é›†ï¼ˆä¾‹å¦‚GBKï¼‰å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºå­—èŠ‚æ•°ç»„ byte[] bytes1 = data.getBytes(\u0026#34;GBK\u0026#34;); System.out.println(Arrays.toString(bytes1)); // å°†å­—èŠ‚æ•°ç»„è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œä½¿ç”¨é»˜è®¤å­—ç¬¦é›†è¿›è¡Œè§£ç  String s = new String(bytes); System.out.println(s); // å°†å­—èŠ‚æ•°ç»„è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œä½¿ç”¨æŒ‡å®šå­—ç¬¦é›†è¿›è¡Œè§£ç  String s1 = new String(bytes1, \u0026#34;GBK\u0026#34;); System.out.println(s1); } IOæµ æŒ‰æµçš„æ–¹å‘åˆ†ä¸º\nè¾“å…¥æµ è¾“å‡ºæµ æŒ‰æµä¸­æ•°æ®çš„æœ€å°å•ä½ï¼Œåˆ†ä¸ºï¼š\nå­—èŠ‚æµ é€‚åˆæ“ä½œæ‰€æœ‰ç±»å‹çš„æ–‡ä»¶ æ¯”å¦‚ï¼šéŸ³é¢‘ï¼Œè§†é¢‘ï¼Œå›¾ç‰‡ï¼Œæ–‡æœ¬æ–‡ä»¶çš„å¤åˆ¶ï¼Œè½¬ç§»ç­‰ å­—ç¬¦æµ é€‚åˆæ“ä½œçº¯æ–‡æœ¬æ–‡ä»¶ æ¯”å¦‚ï¼šè¯»å†™txt, javaæ–‡ä»¶ç­‰ FileInputStream(æ–‡ä»¶å­—èŠ‚è¾“å…¥æµ) ä½œç”¨ï¼šä»¥å†…å­˜ä¸ºåŸºå‡†ï¼Œå¯ä»¥æŠŠç£ç›˜æ–‡ä»¶ä¸­çš„æ•°æ®ä»¥å­—èŠ‚çš„å½¢å¼è¯»å…¥åˆ°å†…å­˜ä¸­å» public static void main(String[] args) throws IOException { // ç”¨å¤šæ€çš„å½¢å¼åˆ›å»ºæ–‡ä»¶è¾“å…¥æµ InputStream is = new FileInputStream(\u0026#34;file-io-app\\\\src\\\\com\\\\showguan\\\\ByteStreamDemo\\\\test.txt\u0026#34;); int b; // è¯»å–æ–‡ä»¶å†…å®¹ï¼Œç›´åˆ°é‡åˆ°æ–‡ä»¶æœ«å°¾(-1) while((b = is.read()) != -1){ System.out.print((char) b); // å°†è¯»å–åˆ°çš„å­—èŠ‚è½¬æ¢ä¸ºå­—ç¬¦å¹¶æ‰“å°åˆ°æ§åˆ¶å° } is.close(); // å…³é—­æ–‡ä»¶è¾“å…¥æµ } public static void main(String[] args) throws IOException { InputStream is = new FileInputStream(\u0026#34;file-io-app\\\\src\\\\com\\\\showguan\\\\ByteStreamDemo\\\\test.txt\u0026#34;); // åˆ›å»ºæ–‡ä»¶è¾“å…¥æµ byte[] buffer = new byte[3]; // åˆ›å»ºç¼“å†²åŒº int len1 = is.read(buffer); // ä»æ–‡ä»¶ä¸­è¯»å–å­—èŠ‚åˆ°ç¼“å†²åŒºä¸­ System.out.println(\u0026#34;å½“å‰è¯»å–çš„é•¿åº¦:\u0026#34; + len1); // æ‰“å°å½“å‰è¯»å–çš„é•¿åº¦ String s = new String(buffer); // å°†ç¼“å†²åŒºä¸­çš„å­—èŠ‚è½¬æ¢ä¸ºå­—ç¬¦ä¸² System.out.println(s); // æ‰“å°å­—ç¬¦ä¸² } æ–‡ä»¶å­—èŠ‚è¾“å…¥æµï¼šä¸€æ¬¡è¯»å®Œå…¨éƒ¨å­—èŠ‚\næ–¹å¼ä¸€ï¼šå®šä¹‰ä¸€ä¸ªå­—èŠ‚æ•°ç»„ä¸è¢«è¯»å–çš„æ–‡ä»¶å¤§å°ä¸€æ ·å¤§ï¼Œç„¶åä½¿ç”¨è¯¥å­—èŠ‚æ•°ç»„ï¼Œä¸€æ¬¡è¯»å®Œæ–‡ä»¶çš„å…¨éƒ¨å­—èŠ‚ã€‚\næ–¹æ³•äºŒï¼šJavaå®˜æ–¹ä¸ºInputStreamæä¾›äº†readAllBytes()æ–¹æ³•ï¼Œ å¯ä»¥ç›´æ¥æŠŠæ–‡ä»¶çš„å…¨éƒ¨å­—èŠ‚è¯»å–åˆ°ä¸€ä¸ªå­—èŠ‚æ•°ç»„ä¸­è¿”å›ã€‚\npublic static void main(String[] args) throws IOException { // ä»æ–‡ä»¶è¯»å–æ•°æ®çš„ä¸¤ç§æ–¹æ³•ï¼šä½¿ç”¨ InputStream è¯»å–å’Œä½¿ç”¨ readAllBytes() æ–¹æ³•è¯»å– // æ–¹æ³•ä¸€ï¼šä½¿ç”¨ InputStream è¯»å–æ–‡ä»¶æ•°æ® InputStream is = new FileInputStream(\u0026#34;file-io-app\\\\src\\\\com\\\\showguan\\\\ByteStreamDemo\\\\test.txt\u0026#34;); // åˆ›å»ºæ–‡ä»¶è¾“å…¥æµ File f = new File(\u0026#34;file-io-app\\\\src\\\\com\\\\showguan\\\\ByteStreamDemo\\\\test.txt\u0026#34;); // åˆ›å»ºæ–‡ä»¶å¯¹è±¡ long size = f.length(); // è·å–æ–‡ä»¶å¤§å° byte[] buffer = new byte[(int) size]; // åˆ›å»ºå­—èŠ‚æ•°ç»„ï¼Œç”¨äºå­˜å‚¨æ–‡ä»¶å†…å®¹ï¼Œé•¿åº¦ä¸ºæ–‡ä»¶å¤§å°ï¼ˆéœ€è¦å°† long ç±»å‹å¼ºåˆ¶è½¬æ¢ä¸º int ç±»å‹ï¼‰ int len = is.read(buffer); // è¯»å–æ–‡ä»¶å†…å®¹åˆ°å­—èŠ‚æ•°ç»„ï¼Œè¿”å›å®é™…è¯»å–çš„å­—èŠ‚æ•° System.out.println(new String(buffer)); // å°†å­—èŠ‚æ•°ç»„è½¬æ¢ä¸ºå­—ç¬¦ä¸²å¹¶æ‰“å°è¾“å‡º System.out.println(size); // æ‰“å°æ–‡ä»¶å¤§å° System.out.println(len); // æ‰“å°å®é™…è¯»å–çš„å­—èŠ‚æ•° // æ–¹æ³•äºŒï¼šä½¿ç”¨ readAllBytes() æ–¹æ³•è¯»å–æ–‡ä»¶æ•°æ® InputStream is1 = new FileInputStream(\u0026#34;file-io-app\\\\src\\\\com\\\\showguan\\\\ByteStreamDemo\\\\test.txt\u0026#34;); // åˆ›å»ºæ–°çš„æ–‡ä»¶è¾“å…¥æµ byte[] buffer1 = is1.readAllBytes(); // ä½¿ç”¨ readAllBytes() æ–¹æ³•è¯»å–æ–‡ä»¶å†…å®¹åˆ°å­—èŠ‚æ•°ç»„ System.out.println(new String(buffer1)); // å°†å­—èŠ‚æ•°ç»„è½¬æ¢ä¸ºå­—ç¬¦ä¸²å¹¶æ‰“å°è¾“å‡º is.close(); // å…³é—­æ–‡ä»¶è¾“å…¥æµ } FileOutputStream(æ–‡ä»¶å­—èŠ‚è¾“å‡ºæµ) ä½œç”¨ï¼šä»¥å†…å­˜ä¸ºåŸºå‡†ï¼ŒæŠŠå†…å­˜ä¸­çš„æ•°æ®ä»¥å­—èŠ‚çš„å½¢å¼å†™å‡ºåˆ°æ–‡ä»¶ä¸­å» public static void main(String[] args) throws IOException { // åˆ›å»ºæ–‡ä»¶è¾“å‡ºæµï¼ŒæŒ‡å®šæ–‡ä»¶è·¯å¾„ï¼Œå¹¶è®¾ç½®ä¸ºè¿½åŠ æ¨¡å¼ï¼ˆtrueï¼‰ FileOutputStream os = new FileOutputStream(\u0026#34;file-io-app\\\\src\\\\com\\\\showguan\\\\ByteStreamDemo\\\\test2.txt\u0026#34;, true); os.write(97); // å‘æ–‡ä»¶ä¸­å†™å…¥ä¸€ä¸ªå­—èŠ‚ os.write(\u0026#39;a\u0026#39;); // å‘æ–‡ä»¶ä¸­å†™å…¥ä¸€ä¸ªå­—ç¬¦ byte[] bytes = \u0026#34;ä»Šå¤©æ˜¯20240419\u0026#34;.getBytes(); // å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºå­—èŠ‚æ•°ç»„ // å‘æ–‡ä»¶ä¸­å†™å…¥å­—èŠ‚æ•°ç»„çš„ä¸€éƒ¨åˆ†å†…å®¹ os.write(bytes, 0, 15); // ä»å­—èŠ‚æ•°ç»„çš„ç´¢å¼•0å¼€å§‹ï¼Œå†™å…¥é•¿åº¦ä¸º15çš„å­—èŠ‚æ•°æ® os.write(\u0026#34;\\r\\n\u0026#34;.getBytes()); // å‘æ–‡ä»¶ä¸­å†™å…¥æ¢è¡Œç¬¦ os.close(); // å…³é—­æ–‡ä»¶è¾“å‡ºæµ } æ–‡ä»¶å¤åˆ¶ public class FileCopyDemo { /** * ç¨‹åºå…¥å£ç‚¹ï¼Œå¤åˆ¶ä¸€ä¸ªæ–‡ä»¶çš„å†…å®¹åˆ°å¦ä¸€ä¸ªæ–‡ä»¶ã€‚ * @param args å‘½ä»¤è¡Œå‚æ•° * @throws IOException å¦‚æœå‘ç”ŸI/Oé”™è¯¯ */ public static void main(String[] args) throws IOException { InputStream is = new FileInputStream(\u0026#34;file-io-app\\\\src\\\\com\\\\showguan\\\\ByteStreamDemo\\\\test.jpg\u0026#34;); // åˆ›å»ºæ–‡ä»¶è¾“å…¥æµï¼Œè¯»å–æºæ–‡ä»¶ OutputStream os = new FileOutputStream(\u0026#34;D:\\\\JAVA\\\\test1\\\\img2.jpg\u0026#34;); // åˆ›å»ºæ–‡ä»¶è¾“å‡ºæµï¼Œå†™å…¥ç›®æ ‡æ–‡ä»¶ byte[] buffer = new byte[1024]; // åˆ›å»ºç¼“å†²åŒº int len; // å®šä¹‰å˜é‡ç”¨äºä¿å­˜è¯»å–çš„å­—èŠ‚æ•° // å¾ªç¯è¯»å–æºæ–‡ä»¶å†…å®¹ï¼Œå¹¶å†™å…¥ç›®æ ‡æ–‡ä»¶ while((len = is.read(buffer)) != -1){ os.write(buffer, 0, len); // å°†ç¼“å†²åŒºä¸­çš„å­—èŠ‚å†™å…¥ç›®æ ‡æ–‡ä»¶ } os.close(); // å…³é—­æ–‡ä»¶è¾“å‡ºæµ is.close(); // å…³é—­æ–‡ä»¶è¾“å…¥æµ System.out.println(\u0026#34;å¤åˆ¶å®Œæˆï¼\u0026#34;); // æ‰“å°å¤åˆ¶å®Œæˆçš„æ¶ˆæ¯ } } é‡Šæ”¾èµ„æºçš„æ–¹å¼ try-catch-finally finallyä»£ç åŒºçš„ç‰¹ç‚¹ï¼šæ— è®ºtryä¸­çš„ç¨‹åºæ˜¯å¦æ­£å¸¸æ‰§è¡Œäº†ï¼Œ è¿˜æ˜¯å‡ºç°äº†å¼‚å¸¸ï¼Œæœ€åéƒ½ä¸€å®šä¼šæ‰§è¡ŒfinallyåŒºï¼Œ é™¤éJVMç»ˆæ­¢ ä½œç”¨ï¼šä¸€èˆ¬ç”¨äºåœ¨ç¨‹åºæ‰§è¡Œå®Œæˆåè¿›è¡Œèµ„æºçš„é‡Šæ”¾æ“ä½œ(ä¸“ä¸šçº§åšæ³•) public static void main(String[] args) { // å£°æ˜è¾“å…¥å’Œè¾“å‡ºæµå¯¹è±¡ä¸ºnullï¼Œä»¥ç¡®ä¿åœ¨tryå—ä¸­å¯ä»¥è®¿é—®è¿™äº›å¯¹è±¡ InputStream is = null; OutputStream os = null; try{ // æ•…æ„äº§ç”Ÿçš„å¼‚å¸¸ï¼Œç”¨äºæ¼”ç¤ºå¼‚å¸¸æ•æ‰ System.out.println(10/0); // åˆ›å»ºä¸€ä¸ªFileInputStreamæ¥è¯»å–æ–‡ä»¶ is = new FileInputStream(\u0026#34;file-io-app\\\\src\\\\com\\\\showguan\\\\ResourceDemo\\\\test.txt\u0026#34;); // åˆ›å»ºä¸€ä¸ªFileOutputStreamæ¥å†™å…¥æ–‡ä»¶ os = new FileOutputStream(\u0026#34;file-io-app\\\\src\\\\com\\\\showguan\\\\ResourceDemo\\\\test1.txt\u0026#34;); System.out.println(10/0); // åˆ›å»ºä¸€ä¸ªå­—èŠ‚æ•°ç»„ç”¨äºæš‚å­˜ä»æ–‡ä»¶è¯»å–çš„æ•°æ® byte[] buffer = new byte[1024]; int len; // å¾ªç¯è¯»å–å¹¶å†™å…¥æ–‡ä»¶ï¼Œç›´åˆ°æ–‡ä»¶ç»“æŸ while((len=is.read(buffer))!=-1){ os.write(buffer, 0, len); } System.out.println(\u0026#34;å¤åˆ¶å®Œæˆï¼\u0026#34;); }catch (IOException e){ // æ•æ‰å¹¶å¤„ç†IOå¼‚å¸¸ e.printStackTrace(); }finally { // åœ¨finallyå—ä¸­é‡Šæ”¾èµ„æºï¼Œç¡®ä¿æ— è®ºæ˜¯å¦æœ‰å¼‚å¸¸å‘ç”Ÿï¼Œèµ„æºéƒ½è¢«é‡Šæ”¾ try { // å…³é—­è¾“å‡ºæµèµ„æº if(os!=null) os.close(); } catch (IOException e) { throw new RuntimeException(e); } try { // å…³é—­è¾“å…¥æµèµ„æº if(is!=null) is.close(); } catch (IOException e) { throw new RuntimeException(e); } } } try-with-resource public static void main(String[] args) { // ä½¿ç”¨try-with-resourcesè¯­æ³•ï¼Œè‡ªåŠ¨å…³é—­è¾“å…¥æµå’Œè¾“å‡ºæµ try ( InputStream is = new FileInputStream(\u0026#34;file-io-app\\\\src\\\\com\\\\showguan\\\\ResourceDemo\\\\test.txt\u0026#34;); // åˆ›å»ºæ–‡ä»¶è¾“å…¥æµï¼Œè¯»å–æºæ–‡ä»¶ OutputStream os = new FileOutputStream(\u0026#34;file-io-app\\\\src\\\\com\\\\showguan\\\\ResourceDemo\\\\test1.txt\u0026#34;); // åˆ›å»ºæ–‡ä»¶è¾“å‡ºæµï¼Œå†™å…¥ç›®æ ‡æ–‡ä»¶ ) { byte[] buffer = new byte[1024]; // åˆ›å»ºç¼“å†²åŒº int len; // å®šä¹‰å˜é‡ç”¨äºä¿å­˜è¯»å–çš„å­—èŠ‚æ•° // å¾ªç¯è¯»å–æºæ–‡ä»¶å†…å®¹ï¼Œå¹¶å†™å…¥ç›®æ ‡æ–‡ä»¶ while ((len = is.read(buffer)) != -1) { os.write(buffer, 0, len); // å°†ç¼“å†²åŒºä¸­çš„å­—èŠ‚å†™å…¥ç›®æ ‡æ–‡ä»¶ } System.out.println(\u0026#34;å¤åˆ¶å®Œæˆï¼\u0026#34;); // æ‰“å°å¤åˆ¶å®Œæˆçš„æ¶ˆæ¯ } catch (Exception e) { // æ•è·å¯èƒ½å‘ç”Ÿçš„å¼‚å¸¸ e.printStackTrace(); // æ‰“å°å¼‚å¸¸ä¿¡æ¯ } } æ³¨æ„ï¼š()é‡Œé¢åªèƒ½æ”¾ç½®èµ„æºå¯¹è±¡ï¼Œèµ„æºéƒ½ä¼šå®ç°AutoCloseableæ¥å£\nèµ„æºç”¨å®Œä¹‹åï¼Œä¼šè‡ªåŠ¨è°ƒç”¨closeæ–¹æ³•ã€‚\nIOå­—ç¬¦æµ FileReader public static void main(String[] args) throws FileNotFoundException { // ä½¿ç”¨try-with-resourcesè¯­æ³•ï¼Œè‡ªåŠ¨å…³é—­å­—ç¬¦æµ try ( Reader fr = new FileReader(\u0026#34;file-io-app\\\\src\\\\com\\\\showguan\\\\ResourceDemo\\\\test.txt\u0026#34;); // åˆ›å»ºå­—ç¬¦è¾“å…¥æµï¼Œè¯»å–æ–‡ä»¶ ) { // int c; // while((c=fr.read())!=-1){ // System.out.println((char) c); // } char[] buffer = new char[3]; // åˆ›å»ºç¼“å†²åŒº int len; // å®šä¹‰å˜é‡ç”¨äºä¿å­˜è¯»å–çš„å­—ç¬¦æ•° // å¾ªç¯è¯»å–æ–‡ä»¶å†…å®¹ï¼Œå¹¶æ‰“å°åˆ°æ§åˆ¶å° while((len=fr.read(buffer))!=-1){ System.out.print(new String(buffer, 0, len)); // å°†ç¼“å†²åŒºä¸­çš„å­—ç¬¦è½¬æ¢ä¸ºå­—ç¬¦ä¸²å¹¶æ‰“å° } } catch (Exception e) { // æ•è·å¯èƒ½å‘ç”Ÿçš„å¼‚å¸¸ e.printStackTrace(); // æ‰“å°å¼‚å¸¸ä¿¡æ¯ } } FileWriter public static void main(String[] args) { // ä½¿ç”¨try-with-resourcesè¯­æ³•ï¼Œè‡ªåŠ¨å…³é—­å­—ç¬¦æµ try ( FileWriter fw = new FileWriter(\u0026#34;file-io-app\\\\src\\\\com\\\\showguan\\\\CharStreamDemo\\\\test.txt\u0026#34;, true); // åˆ›å»ºå­—ç¬¦è¾“å‡ºæµï¼Œå†™å…¥æ–‡ä»¶ ){ fw.write(\u0026#34;\\r\\n\u0026#34;); // å‘æ–‡ä»¶ä¸­å†™å…¥æ¢è¡Œç¬¦ fw.write(\u0026#39;a\u0026#39;); // å‘æ–‡ä»¶ä¸­å†™å…¥å­—ç¬¦ fw.write(\u0026#34;\\r\\n\u0026#34;); // å‘æ–‡ä»¶ä¸­å†™å…¥æ¢è¡Œç¬¦ fw.write(98); // å‘æ–‡ä»¶ä¸­å†™å…¥å­—ç¬¦å¯¹åº”çš„ASCIIç  fw.write(\u0026#39;è‹±\u0026#39;); // å‘æ–‡ä»¶ä¸­å†™å…¥å­—ç¬¦ fw.write(\u0026#34;\\r\\n\u0026#34;); // å‘æ–‡ä»¶ä¸­å†™å…¥æ¢è¡Œç¬¦ fw.write(\u0026#34;\\r\\n\u0026#34;); // å‘æ–‡ä»¶ä¸­å†™å…¥æ¢è¡Œç¬¦ fw.write(\u0026#34;æˆ‘æ˜¯çš„è¯\u0026#34;); // å‘æ–‡ä»¶ä¸­å†™å…¥å­—ç¬¦ä¸² fw.write(\u0026#34;\\r\\n\u0026#34;); // å‘æ–‡ä»¶ä¸­å†™å…¥æ¢è¡Œç¬¦ fw.write(\u0026#34;fw.write\u0026#34;); // å‘æ–‡ä»¶ä¸­å†™å…¥å­—ç¬¦ä¸² char[] buffer = {\u0026#39;é»‘\u0026#39;, \u0026#39;é©¬\u0026#39;, \u0026#39;a\u0026#39;}; // åˆ›å»ºå­—ç¬¦æ•°ç»„ fw.write(buffer); // å‘æ–‡ä»¶ä¸­å†™å…¥å­—ç¬¦æ•°ç»„çš„å†…å®¹ fw.write(buffer, 0, 2); // å‘æ–‡ä»¶ä¸­å†™å…¥å­—ç¬¦æ•°ç»„çš„ä¸€éƒ¨åˆ†å†…å®¹ } catch (Exception e) { // æ•è·å¯èƒ½å‘ç”Ÿçš„å¼‚å¸¸ e.printStackTrace(); // æ‰“å°å¼‚å¸¸ä¿¡æ¯ } } flush() public static void main(String[] args) throws IOException { Writer fw = new FileWriter(\u0026#34;file-io-app\\\\src\\\\com\\\\showguan\\\\CharStreamDemo\\\\test1.txt\u0026#34;); // åˆ›å»ºå­—ç¬¦è¾“å‡ºæµï¼Œå†™å…¥æ–‡ä»¶ fw.write(\u0026#39;a\u0026#39;); // å‘æ–‡ä»¶ä¸­å†™å…¥å­—ç¬¦ \u0026#39;a\u0026#39; fw.write(\u0026#39;b\u0026#39;); // å‘æ–‡ä»¶ä¸­å†™å…¥å­—ç¬¦ \u0026#39;b\u0026#39; fw.write(\u0026#39;c\u0026#39;); // å‘æ–‡ä»¶ä¸­å†™å…¥å­—ç¬¦ \u0026#39;c\u0026#39; fw.flush(); // æ‰‹åŠ¨åˆ·æ–°ç¼“å†²åŒºï¼Œå°†ç¼“å†²åŒºä¸­çš„æ•°æ®å†™å…¥æ–‡ä»¶ fw.write(\u0026#39;a\u0026#39;); // å‘æ–‡ä»¶ä¸­å†™å…¥å­—ç¬¦ \u0026#39;a\u0026#39; fw.close(); // å…³é—­å­—ç¬¦è¾“å‡ºæµï¼Œä¼šè‡ªåŠ¨åˆ·æ–° } ç¼“å†²æµ ç¼“å†²æµï¼šæé«˜æµè¯»å†™æ•°æ®çš„æ€§èƒ½\nå­—èŠ‚ç¼“å†²æµ åŸç†ï¼šå­—èŠ‚ç¼“å†²è¾“å…¥æµè‡ªå¸¦äº†8KBç¼“å†²æ± ï¼Œå­—èŠ‚ç¼“å†²è¾“å‡ºæµä¹Ÿè‡ªå¸¦äº†8KBç¼“å†²æ±  public static void main(String[] args) throws IOException { // ä½¿ç”¨ç¼“å†²æµè¿›è¡Œæ–‡ä»¶å¤åˆ¶æ“ä½œ File f = new File(\u0026#34;file-io-app\\\\src\\\\com\\\\showguan\\\\BufferedStream\\\\test1.txt\u0026#34;); // åˆ›å»ºè¦å¤åˆ¶åˆ°çš„æ–°æ–‡ä»¶ f.createNewFile(); // å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºæ–°æ–‡ä»¶ try ( // åˆ›å»ºæ–‡ä»¶è¾“å…¥æµå’Œç¼“å†²è¾“å…¥æµï¼Œç”¨äºè¯»å–åŸå§‹æ–‡ä»¶å†…å®¹ InputStream is = new FileInputStream(\u0026#34;file-io-app\\\\src\\\\com\\\\showguan\\\\BufferedStream\\\\test.txt\u0026#34;); InputStream bis = new BufferedInputStream(is, 8192 * 2); // ä½¿ç”¨ BufferedInputStream è¿›è¡Œç¼“å†² // åˆ›å»ºæ–‡ä»¶è¾“å‡ºæµå’Œç¼“å†²è¾“å‡ºæµï¼Œç”¨äºå†™å…¥å¤åˆ¶åçš„å†…å®¹åˆ°æ–°æ–‡ä»¶ OutputStream os = new FileOutputStream(\u0026#34;file-io-app\\\\src\\\\com\\\\showguan\\\\BufferedStream\\\\test1.txt\u0026#34;); OutputStream bos = new BufferedOutputStream(os, 8192 * 2); // ä½¿ç”¨ BufferedOutputStream è¿›è¡Œç¼“å†² ) { byte[] buffer = new byte[1024]; // åˆ›å»ºå­—èŠ‚æ•°ç»„ä½œä¸ºç¼“å†²åŒº int len; while ((len = bis.read(buffer)) != -1) { // å¾ªç¯è¯»å–åŸæ–‡ä»¶å†…å®¹åˆ°ç¼“å†²åŒº bos.write(buffer, 0, len); // å°†ç¼“å†²åŒºçš„å†…å®¹å†™å…¥åˆ°æ–°æ–‡ä»¶ä¸­ System.out.println(\u0026#34;å¤åˆ¶å®Œæˆ\u0026#34;); // è¾“å‡ºæç¤ºä¿¡æ¯ï¼Œè¡¨ç¤ºå¤åˆ¶å®Œæˆ } } catch (Exception e) { e.printStackTrace(); // æ‰“å°å¼‚å¸¸ä¿¡æ¯ } } å­—ç¬¦ç¼“å†²æµ è¾“å…¥æµ import java.io.*; public class Main { public static void main(String[] args) { // ä¸¤ç§æ–¹å¼è¯»å–æ–‡ä»¶å†…å®¹å¹¶é€è¡Œæ‰“å°ï¼š try ( Reader fr = new FileReader(\u0026#34;file-io-app\\\\src\\\\com\\\\showguan\\\\BufferedStream\\\\test.txt\u0026#34;); // åˆ›å»º FileReader å¯¹è±¡ä»¥æ‰“å¼€æ–‡ä»¶è¾“å…¥æµ BufferedReader br = new BufferedReader(fr); // åˆ›å»º BufferedReader å¯¹è±¡ï¼Œå¹¶å°† FileReader å¯¹è±¡ä¼ é€’ç»™å®ƒï¼Œç”¨äºç¼“å†²è¯»å–æ“ä½œ ) { // æ™®é€šæ–¹å¼ // char[] buffer = new char[3]; // int len; // while((len=br.read(buffer))!=-1){ // System.out.println(new String(buffer, 0, len)); // } // ä½¿ç”¨ readLine() æ–¹æ³•é€è¡Œè¯»å–æ–‡ä»¶å†…å®¹ï¼Œå¹¶å°†æ¯è¡Œå†…å®¹æ‰“å°è¾“å‡º String line; while ((line = br.readLine()) != null) { System.out.println(line); // æ‰“å°æ¯è¡Œå†…å®¹ } } catch (Exception e) { e.printStackTrace(); // æ‰“å°å¼‚å¸¸ä¿¡æ¯ } } } è¾“å‡ºæµ public static void main(String[] args) throws IOException { // ä»ä¸€ä¸ªæ–‡ä»¶è¯»å–æ•°æ®ï¼Œæ’åºåå†™å…¥åˆ°å¦ä¸€ä¸ªæ–‡ä»¶ File f = new File(\u0026#34;file-io-app\\\\src\\\\com\\\\showguan\\\\BufferedStream\\\\test3.txt\u0026#34;); f.createNewFile(); // å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºæ–°æ–‡ä»¶ try ( // åˆ›å»º BufferedReader è¯»å–åŸæ–‡ä»¶å†…å®¹ï¼Œåˆ›å»º BufferedWriter å†™å…¥åˆ°æ–°æ–‡ä»¶ BufferedReader br = new BufferedReader(new FileReader(\u0026#34;file-io-app\\\\src\\\\com\\\\showguan\\\\BufferedStream\\\\test2.txt\u0026#34;)); BufferedWriter bw = new BufferedWriter(new FileWriter(\u0026#34;file-io-app\\\\src\\\\com\\\\showguan\\\\BufferedStream\\\\test3.txt\u0026#34;)); ) { List\u0026lt;String\u0026gt; data = new ArrayList\u0026lt;\u0026gt;(); // åˆ›å»º List ç”¨äºå­˜å‚¨æ–‡ä»¶å†…å®¹ String line; while ((line = br.readLine()) != null) { // é€è¡Œè¯»å–åŸæ–‡ä»¶å†…å®¹å¹¶æ·»åŠ åˆ° List ä¸­ data.add(line); } Collections.sort(data); // å¯¹ List ä¸­çš„æ•°æ®è¿›è¡Œæ’åº for (String ln : data) { // éå†æ’åºåçš„æ•°æ® System.out.println(ln); // æ‰“å°æ¯è¡Œå†…å®¹ bw.write(ln); // å°†æ¯è¡Œå†…å®¹å†™å…¥åˆ°æ–°æ–‡ä»¶ bw.newLine(); // å†™å…¥æ¢è¡Œç¬¦ } } catch (Exception e) { e.printStackTrace(); // æ‰“å°å¼‚å¸¸ä¿¡æ¯ } } ä¸åŒæµä¹‹é—´çš„æ€§èƒ½å·®å¼‚ public class Main { public static final String SRC_FILE = \u0026#34;D:\\\\JAVA\\\\test1\\\\video.mp4\u0026#34;; public static final String DEST_FILE = \u0026#34;D:\\\\JAVA\\\\Test\\\\t\u0026#34;; public static void main(String[] args) { // try { // File f = new File(DEST_FILE + \u0026#34;\u0026#34;); // f.createNewFile(); // } catch (Exception e) { // e.printStackTrace(); // } // copy1(); copy2(); // copy3(); copy4(); } public static void copy1() { // ä½¿ç”¨ä¸€ä¸ªä¸€ä¸ªå­—èŠ‚çš„æ–¹å¼å¤åˆ¶æ–‡ä»¶ long startTime = System.currentTimeMillis(); try ( InputStream is = new FileInputStream(SRC_FILE); OutputStream os = new FileOutputStream(DEST_FILE + \u0026#34;1.mp4\u0026#34;); ) { int b; while ((b = is.read()) != -1) { os.write(b); } } catch (Exception e) { e.printStackTrace(); } long endTime = System.currentTimeMillis(); System.out.println(\u0026#34;ä¸€ä¸ªä¸€ä¸ªå­—èŠ‚æµçš„å½¢å¼è€—æ—¶:\u0026#34; + (endTime-startTime) + \u0026#34;ms\u0026#34;); } public static void copy2() { // ä½¿ç”¨å­—èŠ‚æ•°ç»„çš„æ–¹å¼å¤åˆ¶æ–‡ä»¶ long startTime = System.currentTimeMillis(); try ( InputStream is = new FileInputStream(SRC_FILE); OutputStream os = new FileOutputStream(DEST_FILE + \u0026#34;2.mp4\u0026#34;); ) { int len; byte[] buffer = new byte[1024]; while ((len = is.read(buffer)) != -1) { os.write(buffer, 0, len); } } catch (Exception e) { e.printStackTrace(); } long endTime = System.currentTimeMillis(); System.out.println(\u0026#34;1kbå­—èŠ‚æµçš„å½¢å¼è€—æ—¶:\u0026#34; + (endTime-startTime)+ \u0026#34;ms\u0026#34;); //1kbå­—èŠ‚æµçš„å½¢å¼è€—æ—¶:141 } public static void copy3() { // ä½¿ç”¨ç¼“å†²æµä¸€ä¸ªä¸€ä¸ªå­—èŠ‚çš„æ–¹å¼å¤åˆ¶æ–‡ä»¶ long startTime = System.currentTimeMillis(); try ( FileInputStream is = new FileInputStream(SRC_FILE); BufferedInputStream bis = new BufferedInputStream(is); FileOutputStream os = new FileOutputStream(DEST_FILE + \u0026#34;3.mp4\u0026#34;); BufferedOutputStream bos = new BufferedOutputStream(os); ) { int b; while ((b = bis.read()) != -1) { bos.write(b); } } catch (Exception e) { e.printStackTrace(); } long endTime = System.currentTimeMillis(); System.out.println(\u0026#34;ç¼“å†²æµä½¿ç”¨ä¸€ä¸ªä¸€ä¸ªå­—èŠ‚å¤åˆ¶è€—æ—¶:\u0026#34; + (endTime-startTime)+ \u0026#34;ms\u0026#34;); } public static void copy4() { // ä½¿ç”¨ç¼“å†²æµå­—èŠ‚æ•°ç»„çš„æ–¹å¼å¤åˆ¶æ–‡ä»¶ long startTime = System.currentTimeMillis(); try ( FileInputStream is = new FileInputStream(SRC_FILE); BufferedInputStream bis = new BufferedInputStream(is); FileOutputStream os = new FileOutputStream(DEST_FILE + \u0026#34;4.mp4\u0026#34;); BufferedOutputStream bos = new BufferedOutputStream(os); ) { byte[] buffer = new byte[1024]; int len; while ((len = bis.read(buffer)) != -1) { bos.write(buffer, 0, len); } } catch (Exception e) { e.printStackTrace(); } long endTime = System.currentTimeMillis(); System.out.println(\u0026#34;ç¼“å†²æµä½¿ç”¨å­—èŠ‚æ•°ç»„å¤åˆ¶è€—æ—¶:\u0026#34; + (endTime-startTime) + \u0026#34;ms\u0026#34;); //ç¼“å†²æµä½¿ç”¨å­—èŠ‚æ•°ç»„å¤åˆ¶è€—æ—¶:45 } } è½¬æ¢æµ å­—ç¬¦è¾“å…¥è½¬æ¢æµ public static void main(String[] args) { try ( InputStream is = new FileInputStream((\u0026#34;file-io-app\\\\src\\\\com\\\\showguan\\\\BufferedStream\\\\test2.txt\u0026#34;)); // åˆ›å»ºæ–‡ä»¶è¾“å…¥æµ Reader isr = new InputStreamReader(is, \u0026#34;GBK\u0026#34;); // åˆ›å»º InputStreamReader å¯¹è±¡ï¼ŒæŒ‡å®šå­—ç¬¦ç¼–ç ä¸º GBK BufferedReader br = new BufferedReader(isr); // åˆ›å»º BufferedReader å¯¹è±¡ï¼Œç”¨äºç¼“å†²è¯»å–æ“ä½œ ) { // ä½¿ç”¨ BufferedReader é€è¡Œè¯»å–æ–‡ä»¶å†…å®¹ï¼Œå¹¶æ‰“å°è¾“å‡º String line; while ((line = br.readLine()) != null) { System.out.println(line); } } catch (Exception e) { e.printStackTrace(); // æ‰“å°å¼‚å¸¸ä¿¡æ¯ } } å­—ç¬¦è¾“å‡ºè½¬æ¢æµ public static void main(String[] args) { try( OutputStream os = new FileOutputStream(\u0026#34;file-io-app\\\\src\\\\com\\\\showguan\\\\BufferedStream\\\\test6.txt\u0026#34;,true); // åˆ›å»ºæ–‡ä»¶è¾“å‡ºæµï¼ŒæŒ‡å®šè¿½åŠ æ¨¡å¼ä¸º true Writer osw = new OutputStreamWriter(os, \u0026#34;GBK\u0026#34;); // åˆ›å»º OutputStreamWriter å¯¹è±¡ï¼ŒæŒ‡å®šå­—ç¬¦ç¼–ç ä¸º GBK BufferedWriter bw = new BufferedWriter(osw); // åˆ›å»º BufferedWriter å¯¹è±¡ï¼Œç”¨äºç¼“å†²å†™å…¥æ“ä½œ ){ bw.write(\u0026#34;ç¾å¥½\u0026#34;); // å†™å…¥å­—ç¬¦ä¸²åˆ°æ–‡ä»¶ bw.write(\u0026#34;çœŸç¾å¥½\u0026#34;); // å†æ¬¡å†™å…¥å­—ç¬¦ä¸²åˆ°æ–‡ä»¶ } catch (Exception e) { e.printStackTrace(); // æ‰“å°å¼‚å¸¸ä¿¡æ¯ } } PrintStream/PrintWriter(æ‰“å°æµ) ä½œç”¨ï¼šæ‰“å°æµå¯ä»¥å®ç°æ›´æ–¹ä¾¿ï¼Œ æ›´é«˜æ•ˆçš„æ‰“å°æ•°æ®å‡ºå»ï¼Œèƒ½å®ç°ç­”åº”ä»€ä¹ˆå‡ºå»å°±æ˜¯ä»€ä¹ˆ PrintStream public static void main(String[] args) { // ä½¿ç”¨ PrintStream å‘æ–‡ä»¶å†™å…¥å†…å®¹ï¼Œå¹¶æŒ‡å®šå­—ç¬¦ç¼–ç ä¸º GBK try ( // åˆ›å»º PrintStream å¯¹è±¡ï¼ŒæŒ‡å®šå­—ç¬¦ç¼–ç ä¸º GBK PrintStream ps = new PrintStream(\u0026#34;file-io-app\\\\src\\\\com\\\\showguan\\\\PrintDemo\\\\test.txt\u0026#34;, Charset.forName(\u0026#34;GBK\u0026#34;)); ) { // ä½¿ç”¨ println æ–¹æ³•å†™å…¥å­—ç¬¦å’Œå­—ç¬¦ä¸² ps.println(\u0026#39;3\u0026#39;); ps.println(\u0026#39;a\u0026#39;); ps.println(\u0026#34;ä½ å¥½å•Š\u0026#34;); // ä½¿ç”¨ write æ–¹æ³•å†™å…¥å­—ç¬¦ ps.write(\u0026#39;z\u0026#39;); } catch (Exception e) { e.printStackTrace(); // æ‰“å°å¼‚å¸¸ä¿¡æ¯ } } PrintWriter public static void main(String[] args) { // ä½¿ç”¨ PrintWriter å‘æ–‡ä»¶å†™å…¥å†…å®¹ï¼Œå¹¶æŒ‡å®šå­—ç¬¦ç¼–ç ä¸º GBK try ( // åˆ›å»º PrintWriter å¯¹è±¡ï¼ŒæŒ‡å®šå­—ç¬¦ç¼–ç ä¸º GBK PrintWriter pw = new PrintWriter(\u0026#34;file-io-app\\\\src\\\\com\\\\showguan\\\\PrintDemo\\\\test.txt\u0026#34;, \u0026#34;GBK\u0026#34;); // åˆ›å»º PrintWriter å¯¹è±¡ï¼Œé€šè¿‡ OutputStreamWriter åŒ…è£… FileOutputStreamï¼Œå¹¶æŒ‡å®šå­—ç¬¦ç¼–ç ä¸º GBK PrintWriter pw1 = new PrintWriter(new OutputStreamWriter(new FileOutputStream(\u0026#34;file-io-app\\\\src\\\\com\\\\showguan\\\\PrintDemo\\\\test.txt\u0026#34;, true), \u0026#34;GBK\u0026#34;)); ) { // ä½¿ç”¨ println æ–¹æ³•å†™å…¥å­—ç¬¦å’Œå­—ç¬¦ä¸² pw.println(\u0026#39;3\u0026#39;); pw.println(\u0026#39;a\u0026#39;); pw.println(\u0026#34;ä½ å¥½å•Š\u0026#34;); // ä½¿ç”¨ write æ–¹æ³•å†™å…¥å­—ç¬¦å’Œå­—ç¬¦ä¸² pw.write(\u0026#39;z\u0026#39;); pw.write(\u0026#34;abcdefghijklim\u0026#34;); } catch (Exception e) { e.printStackTrace(); // æ‰“å°å¼‚å¸¸ä¿¡æ¯ } } å¯¹æ¯”ï¼š\næ‰“å°æ•°æ®çš„åŠŸèƒ½ä¸Šæ˜¯ä¸€æ¨¡ä¸€æ ·çš„ï¼šéƒ½æ˜¯ä½¿ç”¨æ–¹ä¾¿ï¼Œæ€§èƒ½é«˜æ•ˆï¼ˆæ ¸å¿ƒä¼˜åŠ¿ï¼‰ PrintStreamç»§æ‰¿è‡ªå­—èŠ‚è¾“å‡ºæµOutputStreamï¼Œ å› æ­¤æ”¯æŒå†™å­—èŠ‚æ•°æ®çš„æ–¹æ³• PrintWriterç»§æ‰¿è‡ªå­—ç¬¦è¾“å‡ºæµWriterï¼Œ å› æ­¤æ”¯æŒå†™å­—ç¬¦æ•°æ®å‡ºå» è¾“å‡ºé‡å®šå‘ public static void main(String[] args) { // å°†è¾“å‡ºé‡å®šå‘åˆ°æ–‡ä»¶ System.out.println(\u0026#34;ä½ å¥½\u0026#34;); // åœ¨æ§åˆ¶å°æ‰“å°è¾“å‡º System.out.println(\u0026#34;å¿—åœ¨åƒé‡Œ\u0026#34;); // åœ¨æ§åˆ¶å°æ‰“å°è¾“å‡º try ( // åˆ›å»º PrintStream å¯¹è±¡ï¼Œå°†è¾“å‡ºé‡å®šå‘åˆ°æ–‡ä»¶ PrintStream ps = new PrintStream(\u0026#34;file-io-app\\\\src\\\\com\\\\showguan\\\\PrintDemo\\\\test.txt\u0026#34;); ) { System.setOut(ps); // å°†æ ‡å‡†è¾“å‡ºæµé‡å®šå‘åˆ° PrintStream å¯¹è±¡ System.out.println(\u0026#34;çƒˆå£«æš®å¹´\u0026#34;); // å°†è¾“å‡ºé‡å®šå‘åˆ°æ–‡ä»¶ä¸­ } catch (FileNotFoundException e) { throw new RuntimeException(e); } } æ•°æ®æµ æ•°æ®è¾“å‡ºæµ public static void main(String[] args) { // ä½¿ç”¨ DataOutputStream å†™å…¥ä¸åŒç±»å‹çš„æ•°æ®åˆ°æ–‡ä»¶ try ( // åˆ›å»º DataOutputStream å¯¹è±¡ï¼Œç”¨äºå†™å…¥æ•°æ®åˆ°æ–‡ä»¶ DataOutputStream dos = new DataOutputStream(new FileOutputStream(\u0026#34;file-io-app\\\\src\\\\com\\\\showguan\\\\DataStreamDemo\\\\test.txt\u0026#34;)); ){ // å†™å…¥ä¸åŒç±»å‹çš„æ•°æ®åˆ°æ–‡ä»¶ dos.write(91); // å†™å…¥ä¸€ä¸ªå­—èŠ‚ dos.writeInt(10); // å†™å…¥ä¸€ä¸ªæ•´æ•° dos.writeDouble(99.8); // å†™å…¥ä¸€ä¸ªåŒç²¾åº¦æµ®ç‚¹æ•° dos.writeBoolean(true); // å†™å…¥ä¸€ä¸ªå¸ƒå°”å€¼ dos.writeUTF(\u0026#34;999é»‘é©¬ç¨‹åºå‘˜\u0026#34;); // å†™å…¥ä¸€ä¸ª UTF-8 ç¼–ç çš„å­—ç¬¦ä¸² } catch (Exception e) { e.printStackTrace(); // æ‰“å°å¼‚å¸¸ä¿¡æ¯ } } æ•°æ®è¾“å…¥æµ public static void main(String[] args) { // ä½¿ç”¨ DataInputStream è¯»å–ä¸åŒç±»å‹çš„æ•°æ® try ( // åˆ›å»º DataInputStream å¯¹è±¡ï¼Œç”¨äºè¯»å–æ•°æ® DataInputStream dis = new DataInputStream(new FileInputStream(\u0026#34;file-io-app\\\\src\\\\com\\\\showguan\\\\DataStreamDemo\\\\test.txt\u0026#34;)); ) { // ä¾æ¬¡è¯»å–ä¸åŒç±»å‹çš„æ•°æ®å¹¶æ‰“å°è¾“å‡º int b = dis.read(); System.out.println(b); int i = dis.readInt(); System.out.println(i); double d = dis.readDouble(); System.out.println(d); boolean bool = dis.readBoolean(); System.out.println(bool); String rs = dis.readUTF(); System.out.println(rs); } catch (Exception e) { e.printStackTrace(); // æ‰“å°å¼‚å¸¸ä¿¡æ¯ } } åºåˆ—åŒ–æµ ObjectOutputStream/ObjectInputStreamå¯¹è±¡å­—èŠ‚è¾“å‡ºæµ\nå¯ä»¥æŠŠJavaå¯¹è±¡è¿›è¡Œåºåˆ—åŒ–ï¼šæŠŠjavaå¯¹è±¡å­˜å…¥åˆ°æ–‡ä»¶ä¸­å» åºåˆ—åŒ– //User public class User implements Serializable { private String loginName; private String userName; private int age; private transient String passWord; } public static void main(String[] args) { // ä½¿ç”¨ ObjectOutputStream å°†å¯¹è±¡åºåˆ—åŒ–åˆ°æ–‡ä»¶ try ( // åˆ›å»º ObjectOutputStream å¯¹è±¡ï¼Œç”¨äºå°†å¯¹è±¡åºåˆ—åŒ–åˆ°æ–‡ä»¶ ObjectOutputStream oos = new ObjectOutputStream(new FileOutputStream(\u0026#34;file-io-app\\\\src\\\\com\\\\showguan\\\\ObjectStreamDemo\\\\test1.txt\u0026#34;)); ) { // åˆ›å»º User å¯¹è±¡å¹¶åˆå§‹åŒ– User u = new User(\u0026#34;admin\u0026#34;, \u0026#34;K\u0026#34;, 18, \u0026#34;1919\u0026#34;); // æ‰“å° User å¯¹è±¡çš„å­—ç¬¦ä¸²è¡¨ç¤º System.out.println(u.toString()); // å°† User å¯¹è±¡åºåˆ—åŒ–åˆ°æ–‡ä»¶ oos.writeObject(u); System.out.println(\u0026#34;åºåˆ—åŒ–æˆåŠŸï¼\u0026#34;); // æ‰“å°åºåˆ—åŒ–æˆåŠŸæ¶ˆæ¯ } catch (IOException e) { throw new RuntimeException(e); // æŠ›å‡ºè¿è¡Œæ—¶å¼‚å¸¸å¹¶æ‰“å°å¼‚å¸¸ä¿¡æ¯ } } ååºåˆ—åŒ– public static void main(String[] args) { // ä½¿ç”¨ ObjectInputStream ä»æ–‡ä»¶ååºåˆ—åŒ–å¯¹è±¡ try ( // åˆ›å»º ObjectInputStream å¯¹è±¡ï¼Œç”¨äºä»æ–‡ä»¶è¯»å–å¯¹è±¡å¹¶ååºåˆ—åŒ– ObjectInputStream ois = new ObjectInputStream(new FileInputStream(\u0026#34;file-io-app\\\\src\\\\com\\\\showguan\\\\ObjectStreamDemo\\\\test1.txt\u0026#34;)); ){ // ä»æ–‡ä»¶ä¸­è¯»å–å¯¹è±¡å¹¶å¼ºåˆ¶è½¬æ¢ä¸º User ç±»å‹ User u = (User) ois.readObject(); // æ‰“å°ååºåˆ—åŒ–å¾—åˆ°çš„ User å¯¹è±¡çš„å­—ç¬¦ä¸²è¡¨ç¤º System.out.println(u.toString()); } catch (Exception e) { e.printStackTrace(); // æ‰“å°å¼‚å¸¸ä¿¡æ¯ } } å¦‚ä½•åºåˆ—åŒ–å¤šä¸ªå¯¹è±¡ï¼Ÿ\nç”¨ä¸€ä¸ªArrayListé›†åˆå­˜å‚¨å¤šä¸ªå¯¹è±¡ï¼Œ ç„¶åç›´æ¥å¯¹é›†åˆè¿›è¡Œåºåˆ—åŒ–å³å¯ï¼ˆArrayListé›†åˆå·²ç»å®ç°äº†åºåˆ—åŒ–æ¥å£ï¼‰\nåºåˆ—åŒ–ï¼š\npublic static void main(String[] args) { try ( ObjectOutputStream oos = new ObjectOutputStream(new FileOutputStream(\u0026#34;file-io-app\\\\src\\\\com\\\\showguan\\\\ObjectStreamDemo\\\\test1.txt\u0026#34;)); ) { List\u0026lt;User\u0026gt; users = new ArrayList\u0026lt;\u0026gt;(); for (int i = 0; i \u0026lt; 100; i++) { User u = new User(\u0026#34;admin\u0026#34; + i, \u0026#34;K\u0026#34; + i, 18, \u0026#34;1919\u0026#34; + i); users.add(u); } // ä½¿ç”¨å¾ªç¯é€ä¸ªæ‰“å°æ¯ä¸ªç”¨æˆ·å¯¹è±¡çš„å­—ç¬¦ä¸²è¡¨ç¤º for (User user : users) { System.out.println(user.toString()); } oos.writeObject(users); System.out.println(\u0026#34;åºåˆ—åŒ–æˆåŠŸï¼\u0026#34;); } catch (IOException e) { throw new RuntimeException(e); } } ååºåˆ—åŒ–\npublic static void main(String[] args) { try ( ObjectInputStream ois = new ObjectInputStream(new FileInputStream(\u0026#34;file-io-app\\\\src\\\\com\\\\showguan\\\\ObjectStreamDemo\\\\test1.txt\u0026#34;)); ){ List\u0026lt;User\u0026gt; users = (ArrayList\u0026lt;User\u0026gt;) ois.readObject(); users.forEach( user -\u0026gt; { System.out.print(user.getUserName() + \u0026#34; \u0026#34;); System.out.print(user.getLoginName() + \u0026#34; \u0026#34;); System.out.print(user.getAge() + \u0026#34; \u0026#34;); System.out.print(user.getPassWord() + \u0026#34; \u0026#34;); }); } catch (Exception e) { e.printStackTrace(); } } IOæ¡†æ¶ æ¡†æ¶\nè§£å†³æŸç±»é—®é¢˜ï¼Œç¼–å†™çš„ä¸€å¥—ç±»ã€æ¥å£ç­‰ï¼Œå¯ä»¥ç†è§£æˆä¸€ä¸ªåŠæˆå“ï¼Œå¤§å¤šæ¡†æ¶éƒ½æ˜¯ç¬¬ä¸‰æ–¹ç ”å‘çš„ å¥½å¤„ï¼šåœ¨æ¡†æ¶çš„åŸºç¡€ä¸Šå¼€å‘ï¼Œå¯ä»¥å¾—åˆ°ä¼˜ç§€çš„è½¯ä»¶æ¶æ„ï¼Œå¹¶èƒ½æé«˜å¼€å‘æ•ˆç‡ IOæ¡†æ¶\nå°è£…äº†Javaæä¾›çš„å¯¹æ–‡ä»¶ã€æ•°æ®è¿›è¡Œæ“ä½œçš„ä»£ç ï¼Œå¯¹å¤–æä¾›äº†æ›´ç®€å•çš„æ–¹å¼æ¥å¯¹æ–‡ä»¶è¿›è¡Œæ“ä½œï¼Œå¯¹æ•°æ®è¿›è¡Œè¯»å†™ã€‚ æ¡†æ¶çš„å¯¼å…¥ï¼š(Commons-IO)\nåœ¨é¡¹ç›®ä¸­åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ ï¼šlib å°†xxx.jaræ–‡ä»¶å¤åˆ¶åˆ°libæ–‡ä»¶å¤¹ åœ¨jaræ–‡ä»¶å¤¹ä¸Šç‚¹å‡»å³é”®ï¼Œé€‰æ‹©Add as Library åœ¨ç±»ä¸­å¯¼åŒ…ä½¿ç”¨ ä½¿ç”¨Commons-IO public static void main(String[] args) throws IOException { // å¤åˆ¶æ–‡ä»¶ FileUtils.copyFile(new File(\u0026#34;D:\\\\JAVA\\\\Test\\\\t3.mp4\u0026#34;), new File(\u0026#34;file-io-app\\\\src\\\\com\\\\showguan\\\\CommonsIODemo\\\\VideoTest.mp4\u0026#34;)); // å¤åˆ¶ç›®å½•åŠå…¶å†…å®¹ FileUtils.copyDirectory(new File(\u0026#34;D:\\\\JAVA\\\\test1\u0026#34;), new File(\u0026#34;file-io-app\\\\src\\\\com\\\\showguan\\\\CommonsIODemo\\\\test\\\\t\u0026#34;)); // åˆ é™¤ç›®å½•åŠå…¶å†…å®¹ FileUtils.deleteDirectory(new File(\u0026#34;file-io-app\\\\src\\\\com\\\\showguan\\\\CommonsIODemo\\\\test\\\\t\u0026#34;)); // è¯»å–æ–‡ä»¶å†…å®¹ä¸ºå­—ç¬¦ä¸² String rs = FileUtils.readFileToString(new File(\u0026#34;file-io-app\\\\src\\\\com\\\\showguan\\\\CommonsIODemo\\\\test1.txt\u0026#34;)); System.out.println(rs); // å‘æ–‡ä»¶å†™å…¥å­—ç¬¦ä¸²æ•°æ®ï¼Œè¿½åŠ åˆ°æ–‡ä»¶æœ«å°¾ FileUtils.writeStringToFile(new File(\u0026#34;file-io-app\\\\src\\\\com\\\\showguan\\\\CommonsIODemo\\\\test.txt\u0026#34;), \u0026#34;data\u0026#34;, true); } Filesä¹Ÿèƒ½åšåˆ°åŒæ ·çš„æ•ˆæœï¼Œä½†æ˜¯åŠŸèƒ½ä¸å¤Ÿå¼ºå¤§ã€‚\npublic static void main(String[] args) throws IOException { // å¤åˆ¶æ–‡ä»¶ Files.copy(Path.of(\u0026#34;file-io-app\\\\src\\\\com\\\\showguan\\\\CommonsIODemo\\\\test.txt\u0026#34;), Path.of(\u0026#34;file-io-app\\\\src\\\\com\\\\showguan\\\\CommonsIODemo\\\\test2.txt\u0026#34;)); } ","permalink":"https://kennems.github.io/posts/tech/java20%E5%A4%A9%E9%80%9F%E6%88%90%E8%BF%9B%E9%98%B6%E8%AF%BE%E7%A8%8B3/","summary":"Java20å¤©é€Ÿæˆâ€”â€”è¿›é˜¶è¯¾ç¨‹(3) æ–‡ä»¶æ“ä½œ Fileå¯¹è±¡ å¸¸ç”¨æ–¹æ³• public static void main(String[] args) { // åˆ›å»ºFileå¯¹è±¡ï¼Œè¡¨ç¤ºæ–‡ä»¶test.txtçš„ç»å¯¹è·¯å¾„ File f1 = new File(\u0026#34;D:/JAVA/JavaSeProMax/file-io-app/src/com/showguan/FileDemo/test.txt\u0026#34;);","title":"Java20å¤©é€Ÿæˆâ€”â€”è¿›é˜¶è¯¾ç¨‹(3)"},{"content":"LeetCodeç¬”è®° ç›®æ ‡ï¼š2500åˆ†\nHOT100 301. åˆ é™¤æ— æ•ˆçš„æ‹¬å· é¢˜ç›®å¤§æ„ï¼š\nç»™ä½ ä¸€ä¸ªç”±è‹¥å¹²æ‹¬å·å’Œå­—æ¯ç»„æˆçš„å­—ç¬¦ä¸² s ï¼Œåˆ é™¤æœ€å°æ•°é‡çš„æ— æ•ˆæ‹¬å·ï¼Œä½¿å¾—è¾“å…¥çš„å­—ç¬¦ä¸²æœ‰æ•ˆã€‚\nè¿”å›æ‰€æœ‰å¯èƒ½çš„ç»“æœã€‚ç­”æ¡ˆå¯ä»¥æŒ‰ ä»»æ„é¡ºåº è¿”å›ã€‚\nå›æº¯ å®ç°æ€è·¯ï¼š\nç»Ÿè®¡æ— æ•ˆæ‹¬å·æ•°é‡ï¼š\né¦–å…ˆéå†å­—ç¬¦ä¸²sï¼Œç»Ÿè®¡å·¦æ‹¬å·å’Œå³æ‹¬å·çš„æ•°é‡lå’Œrï¼Œå…¶ä¸­lè¡¨ç¤ºæœªåŒ¹é…çš„å·¦æ‹¬å·æ•°é‡ï¼Œrè¡¨ç¤ºéœ€è¦åˆ é™¤çš„å³æ‹¬å·æ•°é‡ã€‚ å›æº¯ç®—æ³•ï¼š\nç¼–å†™å›æº¯ç®—æ³•æ¥å°è¯•åˆ é™¤ä¸åŒä½ç½®çš„æ‹¬å·ï¼Œä½¿å¾—å­—ç¬¦ä¸²æœ‰æ•ˆã€‚ å›æº¯è¿‡ç¨‹ä¸­éœ€è¦æ³¨æ„ä»¥ä¸‹æƒ…å†µï¼š å·²ç»åŒ¹é…çš„æ‹¬å·æ•°é‡lnå’Œrnï¼Œä»¥åŠå½“å‰ä½ç½®iã€‚ éå†å­—ç¬¦ä¸²sçš„æ¯ä¸ªå­—ç¬¦ï¼Œå½“é‡åˆ°é‡å¤çš„å­—ç¬¦æ—¶è·³è¿‡ï¼Œä»¥é¿å…é‡å¤ç»“æœã€‚ å¦‚æœå½“å‰å­—ç¬¦ä¸ºå·¦æ‹¬å·å¹¶ä¸”lnä¸ä¸º0ï¼Œåˆ™é€’å½’è°ƒç”¨åˆ é™¤å½“å‰å·¦æ‹¬å·çš„æƒ…å†µï¼Œlnå‡ä¸€ï¼Œå¦åˆ™ç»§ç»­ã€‚ å¦‚æœå½“å‰å­—ç¬¦ä¸ºå³æ‹¬å·å¹¶ä¸”rnä¸ä¸º0ï¼Œåˆ™é€’å½’è°ƒç”¨åˆ é™¤å½“å‰å³æ‹¬å·çš„æƒ…å†µï¼Œrnå‡ä¸€ï¼Œå¦åˆ™ç»§ç»­ã€‚ æ£€æŸ¥å­—ç¬¦ä¸²æœ‰æ•ˆæ€§ï¼š\nç¼–å†™è¾…åŠ©å‡½æ•°checkæ¥æ£€æŸ¥å­—ç¬¦ä¸²æ˜¯å¦æœ‰æ•ˆï¼Œå³å·¦å³æ‹¬å·æ•°é‡æ˜¯å¦åŒ¹é…ã€‚ è¿”å›ç»“æœï¼š\nå°†æ‰€æœ‰æœ‰æ•ˆçš„å­—ç¬¦ä¸²ç»“æœæ·»åŠ åˆ°ç»“æœåˆ—è¡¨retä¸­ï¼Œå¹¶è¿”å›ã€‚ class Solution: def removeInvalidParentheses(self, s: str) -\u0026gt; List[str]: l, r = 0, 0 ret = [] n = len(s) for c in s: if c==\u0026#39;(\u0026#39;: l+=1 elif c==\u0026#39;)\u0026#39;: if l==0: r+=1 else: l-=1 def check(st): cnt=0 for c in st: if c==\u0026#39;(\u0026#39;: cnt+=1 elif c==\u0026#39;)\u0026#39;: cnt-=1 if cnt\u0026lt;0: return False return (cnt==0) def backtrace(st, start, ln, rn): if ln==0 and rn==0 and check(st): ret.append(st[:]) return for i in range(start, len(st)): if i\u0026gt;start and st[i]==st[i-1]: continue if ln+rn\u0026gt;n-1-i+1: break if ln and st[i]==\u0026#39;(\u0026#39;: backtrace(st[:i]+st[i+1:], i, ln-1, rn) elif rn and st[i]==\u0026#39;)\u0026#39;: backtrace(st[:i]+st[i+1:], i, ln, rn-1) backtrace(s, 0, l, r) return ret å¹¿æœ è¿™ä¸ªå®ç°ä½¿ç”¨äº†å¹¿åº¦ä¼˜å…ˆæœç´¢ï¼ˆBFSï¼‰çš„æ€è·¯æ¥è§£å†³é—®é¢˜ã€‚\nBFSæœç´¢ï¼š\nä½¿ç”¨ä¸€ä¸ªé›†åˆcuræ¥å­˜å‚¨å½“å‰å±‚çš„æ‰€æœ‰å­—ç¬¦ä¸²ï¼Œåˆå§‹æ—¶å°†è¾“å…¥çš„å­—ç¬¦ä¸²såŠ å…¥é›†åˆcurä¸­ã€‚ åœ¨æ¯ä¸€è½®å¾ªç¯ä¸­ï¼Œéå†å½“å‰é›†åˆcurä¸­çš„æ‰€æœ‰å­—ç¬¦ä¸²ï¼Œå¦‚æœå…¶ä¸­æœ‰å­—ç¬¦ä¸²æ˜¯æœ‰æ•ˆçš„ï¼Œåˆ™å°†å…¶åŠ å…¥ç»“æœåˆ—è¡¨retä¸­ã€‚ å¦‚æœç»“æœåˆ—è¡¨retä¸ä¸ºç©ºï¼Œåˆ™è·³å‡ºå¾ªç¯ï¼Œè¡¨ç¤ºå·²ç»æ‰¾åˆ°äº†æ‰€æœ‰æœ‰æ•ˆçš„å­—ç¬¦ä¸²ã€‚ å¦‚æœç»“æœåˆ—è¡¨retä¸ºç©ºï¼Œåˆ™éœ€è¦ç»§ç»­è¿›è¡Œä¸‹ä¸€è½®æœç´¢ï¼Œå°†å½“å‰é›†åˆcurä¸­çš„æ¯ä¸ªå­—ç¬¦ä¸²ï¼Œé€šè¿‡åˆ é™¤ä¸€ä¸ªæ‹¬å·çš„æ–¹å¼ï¼Œç”Ÿæˆæ‰€æœ‰å¯èƒ½çš„ä¸‹ä¸€å±‚å­—ç¬¦ä¸²ï¼ŒåŠ å…¥åˆ°é›†åˆnxtä¸­ã€‚ æ›´æ–°å½“å‰é›†åˆcurä¸ºnxtï¼Œç»§ç»­ä¸‹ä¸€è½®æœç´¢ã€‚ æ£€æŸ¥å­—ç¬¦ä¸²æœ‰æ•ˆæ€§ï¼š\nå®šä¹‰ä¸€ä¸ªè¾…åŠ©å‡½æ•°checkï¼Œç”¨äºæ£€æŸ¥å­—ç¬¦ä¸²æ˜¯å¦æœ‰æ•ˆã€‚ éå†å­—ç¬¦ä¸²ä¸­çš„æ¯ä¸ªå­—ç¬¦ï¼Œé‡åˆ°å·¦æ‹¬å·æ—¶å¢åŠ è®¡æ•°å™¨cntï¼Œé‡åˆ°å³æ‹¬å·æ—¶å¦‚æœcntä¸º0åˆ™è¿”å›Falseï¼ˆè¡¨ç¤ºå³æ‹¬å·æ²¡æœ‰åŒ¹é…çš„å·¦æ‹¬å·ï¼‰ï¼Œå¦åˆ™å‡å°‘cntã€‚ æœ€ç»ˆåˆ¤æ–­cntæ˜¯å¦ä¸º0ï¼Œå¦‚æœä¸º0è¡¨ç¤ºå­—ç¬¦ä¸²æœ‰æ•ˆã€‚ è¿”å›ç»“æœï¼š\nè¿”å›ç»“æœåˆ—è¡¨retï¼Œå…¶ä¸­å­˜å‚¨äº†æ‰€æœ‰æœ‰æ•ˆçš„å­—ç¬¦ä¸²ã€‚ class Solution: def removeInvalidParentheses(self, s: str) -\u0026gt; List[str]: ret = [] def check(st): cnt=0 for c in st: if c==\u0026#39;(\u0026#39;: cnt+=1 elif c==\u0026#39;)\u0026#39;: if cnt==0: return False cnt-=1 return cnt==0 cur = set([s]) while True: for st in cur: if check(st): ret.append(st) if len(ret): break nxt = set() for st in cur: for i in range(len(st)): if i\u0026gt;0 and st[i]==st[i-1]: continue if st[i]==\u0026#39;(\u0026#39; or st[i]==\u0026#39;)\u0026#39;: nxt.add(st[:i]+st[i+1:]) cur = nxt return ret 297. äºŒå‰æ ‘çš„åºåˆ—åŒ–ä¸ååºåˆ—åŒ– ä¸æ­¢ç¬¬ä¸€æ¬¡é‡åˆ°äº†ã€‚\né¢˜ç›®å¤§æ„ï¼šåºåˆ—åŒ–æ˜¯å°†ä¸€ä¸ªæ•°æ®ç»“æ„æˆ–å¯¹è±¡è½¬æ¢ä¸ºè¿ç»­çš„æ¯”ç‰¹ä½çš„æ“ä½œï¼Œä»è€Œå¯ä»¥å­˜å‚¨åœ¨æ–‡ä»¶æˆ–å†…å­˜ä¸­ï¼Œå¹¶ä¸”é€šè¿‡ç½‘ç»œä¼ è¾“åˆ°å¦ä¸€ä¸ªè®¡ç®—æœºç¯å¢ƒä¸­ã€‚æœ¬é¢˜è¦æ±‚è®¾è®¡ä¸€ä¸ªç®—æ³•æ¥å®ç°äºŒå‰æ ‘çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–ï¼Œå³å°†äºŒå‰æ ‘è½¬æ¢ä¸ºå­—ç¬¦ä¸²å¹¶å°†å­—ç¬¦ä¸²è½¬æ¢å›åŸå§‹çš„äºŒå‰æ ‘ç»“æ„ã€‚\nå®ç°æ€è·¯ï¼š\nåºåˆ—åŒ–ï¼šä½¿ç”¨é€’å½’å°†äºŒå‰æ ‘è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œæ ¹èŠ‚ç‚¹å€¼ä¸å·¦å³å­æ ‘åºåˆ—åŒ–ç»“æœä¹‹é—´ä½¿ç”¨ç©ºæ ¼åˆ†éš”ï¼Œç©ºèŠ‚ç‚¹ç”¨ \u0026lsquo;#\u0026rsquo; è¡¨ç¤ºã€‚ ååºåˆ—åŒ–ï¼šä½¿ç”¨é€’å½’å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºäºŒå‰æ ‘ã€‚é¦–å…ˆå®šä¹‰ä¸€ä¸ªè¾…åŠ©å‡½æ•° DerWork()ï¼Œç”¨äºé€’å½’æ„å»ºäºŒå‰æ ‘ã€‚åœ¨è¯¥å‡½æ•°ä¸­ï¼ŒæŒ‰ç…§å‰åºéå†çš„é¡ºåºï¼Œä¾æ¬¡æå–å­—ç¬¦ä¸²ä¸­çš„èŠ‚ç‚¹å€¼ï¼Œå¹¶æ ¹æ®èŠ‚ç‚¹å€¼æ„å»ºäºŒå‰æ ‘èŠ‚ç‚¹ã€‚å¦‚æœèŠ‚ç‚¹å€¼ä¸º \u0026lsquo;#\u0026rsquo;ï¼Œè¡¨ç¤ºç©ºèŠ‚ç‚¹ï¼Œè¿”å› Noneã€‚å¦åˆ™ï¼Œåˆ›å»ºèŠ‚ç‚¹å¹¶é€’å½’æ„å»ºå…¶å·¦å³å­æ ‘ã€‚ åœ¨ååºåˆ—åŒ–è¿‡ç¨‹ä¸­ï¼Œä½¿ç”¨ä¸€ä¸ªå…¨å±€å˜é‡ self.s æ¥è®°å½•å½“å‰å¾…å¤„ç†çš„å­—ç¬¦ä¸²ï¼Œæ¯æ¬¡é€’å½’å¤„ç†åï¼Œå°†å­—ç¬¦ä¸²ä¸­å·²ç»å¤„ç†è¿‡çš„éƒ¨åˆ†å‰”é™¤ï¼Œç»§ç»­å¤„ç†å‰©ä½™éƒ¨åˆ†ã€‚ æœ€ç»ˆè¿”å›æ ¹èŠ‚ç‚¹å³å¯ã€‚ # Definition for a binary tree node. # class TreeNode(object): # def __init__(self, x): # self.val = x # self.left = None # self.right = None class Codec: def serialize(self, root): \u0026#34;\u0026#34;\u0026#34;Encodes a tree to a single string. :type root: TreeNode :rtype: str \u0026#34;\u0026#34;\u0026#34; if not root: return \u0026#39;#\u0026#39; return str(root.val)+\u0026#39; \u0026#39;+self.serialize(root.left)+\u0026#39; \u0026#39;+self.serialize(root.right) def deserialize(self, data): \u0026#34;\u0026#34;\u0026#34;Decodes your encoded data to tree. :type data: str :rtype: TreeNode \u0026#34;\u0026#34;\u0026#34; self.s = data return self.DerWork() def DerWork(self): if len(self.s)==0: return None try: idx = self.s.index(\u0026#39; \u0026#39;) except: idx = -1 node = self.s if idx==-1 else self.s[:idx] self.s = \u0026#39;\u0026#39; if idx==-1 else self.s[idx+1:] if node==\u0026#39;#\u0026#39;: return None t = TreeNode(int(node)) t.left = self.DerWork() t.right = self.DerWork() return t # Your Codec object will be instantiated and called as such: # ser = Codec() # deser = Codec() # ans = deser.deserialize(ser.serialize(root)) 84. æŸ±çŠ¶å›¾ä¸­æœ€å¤§çš„çŸ©å½¢ é¢˜ç›®å¤§æ„ï¼šç»™å®š n ä¸ªéè´Ÿæ•´æ•°ï¼Œè¡¨ç¤ºæŸ±çŠ¶å›¾ä¸­å„ä¸ªæŸ±å­çš„é«˜åº¦ã€‚æ¯ä¸ªæŸ±å­å½¼æ­¤ç›¸é‚»ï¼Œä¸”å®½åº¦ä¸º 1ã€‚æ±‚åœ¨è¯¥æŸ±çŠ¶å›¾ä¸­ï¼Œèƒ½å¤Ÿå‹¾å‹’å‡ºçš„çŸ©å½¢çš„æœ€å¤§é¢ç§¯ã€‚\nå®ç°æ€è·¯ï¼š\nä½¿ç”¨å•è°ƒæ ˆè§£å†³é—®é¢˜ã€‚åˆ›å»ºä¸¤ä¸ªæ•°ç»„ l å’Œ rï¼Œåˆ†åˆ«è®°å½•æ¯ä¸ªæŸ±å­å‘å·¦å’Œå‘å³ç¬¬ä¸€ä¸ªæ¯”å…¶é«˜åº¦å°çš„æŸ±å­çš„ç´¢å¼•ä½ç½®ã€‚ åˆå§‹åŒ–ä¸€ä¸ªç©ºæ ˆ stkã€‚ éå†æŸ±å­çš„é«˜åº¦åˆ—è¡¨ heightsï¼š è‹¥æ ˆä¸ä¸ºç©ºä¸”å½“å‰æŸ±å­çš„é«˜åº¦å°äºæ ˆé¡¶æŸ±å­çš„é«˜åº¦ï¼Œåˆ™å°†æ ˆé¡¶å…ƒç´ å¼¹å‡ºï¼Œå¹¶æ›´æ–°æ ˆé¡¶å…ƒç´ å¯¹åº”çš„ r å€¼ä¸ºå½“å‰æŸ±å­çš„ç´¢å¼•ã€‚ è‹¥æ ˆä¸ºç©ºæˆ–è€…å½“å‰æŸ±å­çš„é«˜åº¦å¤§äºæ ˆé¡¶æŸ±å­çš„é«˜åº¦ï¼Œåˆ™å°†å½“å‰æŸ±å­çš„ç´¢å¼•å…¥æ ˆã€‚ åœ¨æ›´æ–° r å€¼çš„åŒæ—¶ï¼Œè‹¥æ ˆä¸ä¸ºç©ºï¼Œåˆ™æ›´æ–°å½“å‰æŸ±å­çš„ l å€¼ä¸ºæ ˆé¡¶å…ƒç´ çš„ç´¢å¼•ã€‚ éå†å®Œæˆåï¼Œå¯¹äºæ¯ä¸ªæŸ±å­ iï¼Œè®¡ç®—ä»¥è¯¥æŸ±å­ä¸ºé«˜åº¦çš„çŸ©å½¢é¢ç§¯ä¸º (r[i] - l[i] - 1) * heights[i]ï¼Œå–æœ€å¤§å€¼å³ä¸ºæ‰€æ±‚çš„æœ€å¤§çŸ©å½¢é¢ç§¯ã€‚ è‹¥æŸ±çŠ¶å›¾ä¸ºç©ºï¼Œåˆ™è¿”å› 0ã€‚ class Solution: def largestRectangleArea(self, heights: List[int]) -\u0026gt; int: n=len(heights) l, r = [-1]*(n+5), [n]*(n+5) stk = list() for i in range(n): while stk and heights[stk[-1]]\u0026gt;=heights[i]: r[stk[-1]]=i stk.pop() if stk: l[i]=stk[-1] stk.append(i) return max( (r[i]-l[i]-1)*heights[i] for i in range(n) ) if n\u0026gt;0 else 0 85. æœ€å¤§çŸ©å½¢ é¢˜ç›®å¤§æ„ï¼šç»™å®šä¸€ä¸ªä»…åŒ…å« 0 å’Œ 1ã€å¤§å°ä¸º rows x cols çš„äºŒç»´äºŒè¿›åˆ¶çŸ©é˜µï¼Œæ‰¾å‡ºåªåŒ…å« 1 çš„æœ€å¤§çŸ©å½¢ï¼Œå¹¶è¿”å›å…¶é¢ç§¯ã€‚\nå®ç°æ€è·¯ï¼š\nå°†é—®é¢˜è½¬åŒ–ä¸ºçŸ©å½¢æœ€å¤§é¢ç§¯é—®é¢˜ã€‚ å®šä¹‰å˜é‡ area ç”¨äºè®°å½•æœ€å¤§çŸ©å½¢çš„é¢ç§¯ã€‚ åˆ›å»ºäºŒç»´æ•°ç»„ leftï¼Œç”¨äºè®°å½•æ¯ä¸ªä½ç½® (i, j) å·¦ä¾§è¿ç»­ 1 çš„ä¸ªæ•°ã€‚ éå†äºŒç»´çŸ©é˜µï¼Œåˆå§‹åŒ– left æ•°ç»„ï¼š è‹¥å½“å‰ä½ç½®ä¸º \u0026lsquo;1\u0026rsquo;ï¼Œåˆ™ left[i][j] ç­‰äº left[i][j-1] + 1ï¼Œå¦åˆ™ä¸º 0ã€‚ éå†çŸ©é˜µçš„æ¯ä¸€åˆ—ï¼Œå¯¹äºæ¯ä¸€åˆ— jï¼Œä½¿ç”¨å•è°ƒæ ˆæ¥è®¡ç®—ä»¥å½“å‰åˆ—ä¸ºåº•è¾¹çš„æœ€å¤§çŸ©å½¢çš„é¢ç§¯ï¼š åˆå§‹åŒ–ä¸€ä¸ªç©ºæ ˆ stkã€‚ å®šä¹‰ä¸¤ä¸ªæ•°ç»„ up å’Œ downï¼Œåˆ†åˆ«è®°å½•å½“å‰ä½ç½®ä¸Šæ–¹ç¬¬ä¸€ä¸ªå°äºç­‰äºå…¶é«˜åº¦çš„ä½ç½®å’Œä¸‹æ–¹ç¬¬ä¸€ä¸ªå°äºç­‰äºå…¶é«˜åº¦çš„ä½ç½®ã€‚ éå†çŸ©é˜µçš„æ¯ä¸€è¡Œ iï¼Œè¿›è¡Œä»¥ä¸‹æ“ä½œï¼š å½“æ ˆä¸ä¸ºç©ºä¸”æ ˆé¡¶ä½ç½®å¯¹åº”çš„ left å€¼å¤§äºç­‰äºå½“å‰ä½ç½®çš„ left å€¼æ—¶ï¼Œå¼¹å‡ºæ ˆé¡¶ä½ç½®ï¼Œå¹¶æ›´æ–° down å€¼ã€‚ å¦‚æœæ ˆä¸ºç©ºï¼Œåˆ™å½“å‰ä½ç½®çš„ up å€¼ä¸º -1ï¼Œå¦åˆ™ä¸ºæ ˆé¡¶ä½ç½®ã€‚ å°†å½“å‰è¡Œç´¢å¼•å…¥æ ˆã€‚ åœ¨è®¡ç®—å½“å‰åˆ—çš„çŸ©å½¢é¢ç§¯æ—¶ï¼Œheight ä¸º down[i] - up[i] - 1ï¼Œå®½åº¦ä¸º left[i][j]ï¼Œè®¡ç®—å½“å‰åˆ—çš„æœ€å¤§é¢ç§¯å¹¶æ›´æ–° areaã€‚ è¿”å›æœ€å¤§é¢ç§¯ areaã€‚ class Solution: def maximalRectangle(self, matrix: List[List[str]]) -\u0026gt; int: # è½¬åŒ–ä¸ºçŸ©å½¢æœ€å¤§é¢ç§¯é—®é¢˜ n, m = len(matrix), len(matrix[0]) area = 0 left = [[0]*m for _ in range(n)] for i in range(n): for j in range(m): if matrix[i][j]==\u0026#39;1\u0026#39;: left[i][j] += left[i][j-1]+1 if j else 1 for j in range(m): stk = [] up, down = [-1]*n, [n]*n for i in range(n): #è¡Œ while stk and left[ stk[-1] ][j]\u0026gt;=left[i][j]: down[stk[-1]] = i stk.pop() up[i] = stk[-1] if stk else -1 stk.append(i) for i in range(n): height = down[i]-up[i]-1 area = max(area, height*left[i][j]) return area 76. æœ€å°è¦†ç›–å­ä¸² é¢˜ç›®å¤§æ„ï¼šç»™å®šå­—ç¬¦ä¸² s å’Œå­—ç¬¦ä¸² tï¼Œè¿”å› s ä¸­æ¶µç›– t æ‰€æœ‰å­—ç¬¦çš„æœ€å°å­ä¸²ã€‚å¦‚æœ s ä¸­ä¸å­˜åœ¨æ¶µç›– t æ‰€æœ‰å­—ç¬¦çš„å­ä¸²ï¼Œåˆ™è¿”å›ç©ºå­—ç¬¦ä¸² \u0026ldquo;\u0026quot;ã€‚\næ³¨æ„ï¼š\nå¯¹äº t ä¸­é‡å¤å­—ç¬¦ï¼Œå­å­—ç¬¦ä¸²ä¸­è¯¥å­—ç¬¦æ•°é‡å¿…é¡»ä¸å°‘äº t ä¸­è¯¥å­—ç¬¦æ•°é‡ã€‚\nå¦‚æœ s ä¸­å­˜åœ¨è¿™æ ·çš„å­ä¸²ï¼Œä¿è¯å®ƒæ˜¯å”¯ä¸€çš„ç­”æ¡ˆã€‚\nå®ç°æ€è·¯ï¼š\nä½¿ç”¨åŒæŒ‡é’ˆæ»‘åŠ¨çª—å£è§£å†³é—®é¢˜ã€‚ åˆå§‹åŒ– need å­—å…¸ï¼Œç”¨äºè®°å½•å­—ç¬¦ä¸² t ä¸­æ¯ä¸ªå­—ç¬¦çš„å‡ºç°æ¬¡æ•°ã€‚ åˆå§‹åŒ– needCnt ä¸º t çš„é•¿åº¦ mï¼Œè¡¨ç¤ºè¿˜éœ€è¦çš„å­—ç¬¦æ•°é‡ã€‚ åˆå§‹åŒ–å·¦æŒ‡é’ˆ left ä¸º 0ï¼Œå¹¶åˆå§‹åŒ–ç»“æœå˜é‡ res ä¸ºä¸€ä¸ªé•¿åº¦ä¸º n çš„åŒºé—´ï¼Œåˆå§‹å€¼ä¸º (0, n)ã€‚ éå†å­—ç¬¦ä¸² tï¼Œç»Ÿè®¡æ¯ä¸ªå­—ç¬¦çš„å‡ºç°æ¬¡æ•°å¹¶å­˜å‚¨åœ¨ need å­—å…¸ä¸­ã€‚ éå†å­—ç¬¦ä¸² sï¼Œä½¿ç”¨å³æŒ‡é’ˆ right éå†æ¯ä¸ªå­—ç¬¦ï¼š è‹¥å½“å‰å­—ç¬¦åœ¨ t ä¸­å‡ºç°ï¼Œåˆ™ needCnt å‡ 1ã€‚ æ›´æ–° need å­—å…¸ä¸­å½“å‰å­—ç¬¦çš„å‡ºç°æ¬¡æ•°ã€‚ è‹¥ needCnt ä¸º 0ï¼Œè¡¨ç¤ºå½“å‰çª—å£åŒ…å«äº† t ä¸­æ‰€æœ‰å­—ç¬¦ï¼Œè¿›å…¥å†…éƒ¨å¾ªç¯ï¼š ç§»åŠ¨å·¦æŒ‡é’ˆ leftï¼Œç›´åˆ°å½“å‰çª—å£ä¸å†æ»¡è¶³æ¡ä»¶ï¼ˆå³ need å­—å…¸ä¸­æŸä¸ªå­—ç¬¦çš„å‡ºç°æ¬¡æ•°å¤§äº 0ï¼‰ã€‚ æ›´æ–°ç»“æœå˜é‡ resã€‚ æ¢å¤å·¦æŒ‡é’ˆ left å’Œ needCntã€‚ è¿”å›ç»“æœå­—ç¬¦ä¸²ï¼Œè‹¥ç»“æœåŒºé—´è¶…å‡º s çš„èŒƒå›´ï¼Œåˆ™è¿”å›ç©ºå­—ç¬¦ä¸²ã€‚ class Solution: def minWindow(self, s: str, t: str) -\u0026gt; str: n, m = len(s), len(t) need = defaultdict(int) needCnt = m left = 0 res = (0, n) for ch in t: need[ch]+=1 for right, ch in enumerate(s): if need[ch]\u0026gt;0: needCnt-=1 need[ch]-=1 if needCnt==0: while need[s[left]]!=0: need[s[left]]+=1 left+=1 if right-left \u0026lt; res[1]-res[0]: res = (left, right) need[s[left]]+=1 needCnt+=1 left+=1 return \u0026#39;\u0026#39; if res[1]\u0026gt;n-1 else s[res[0]:res[1]+1] 312. æˆ³æ°”çƒ é¢˜æ„ï¼šç»™å®šnä¸ªæ•°å­—num[0~n-1],æ¯æ¬¡æˆ³ç ´ä¸€ä¸ªæ°”çƒå¯ä»¥è·å¾—nums[i-1]*nums[i]*nums[i+1]ä¸ªç¡¬å¸ï¼Œæœ€ä¸¤æ—é»˜è®¤ä¸º1ï¼Œé—®æœ€ç»ˆè·å¾—çš„æœ€å¤§ç¡¬å¸æ•°é‡ã€‚ æ€è·¯ï¼šåŒºé—´DPï¼Œé€†å‘æ€ç»´, æ€è€ƒå¦‚ä½•æ”¾æ°”çƒèƒ½ä½¿ç¡¬å¸æœ€å¤§ï¼Œf[i][j]ä»£è¡¨å¼€åŒºé—´i~jå¯ä»¥è·å¾—çš„æœ€å¤§ç¡¬å¸ï¼Œ å…ˆæšä¸¾å°åŒºé—´ï¼Œå†æšä¸¾å¤§åŒºé—´ï¼Œæšä¸¾åŒºé—´å†…æ¯ä¸ªæ•°å­—ï¼ŒçŠ¶æ€è½¬ç§»æœ‰ï¼šf[i][j] = max(f[i][j], f[i][k]+f[k][j]+nums[i]*nums[k]*nums[j])ã€‚æœ€ç»ˆè¾“å‡ºf[0][n+1] class Solution: def maxCoins(self, nums: List[int]) -\u0026gt; int: n = len(nums) nums = [1]+nums+[1] f = [[0]*(n+5) for _ in range(n+5)] # å¼€åŒºé—´ (left, right) åŒºé—´å†…èƒ½è·å¾—çš„æœ€å¤§ç¡¬å¸ for l in range(2,n+2): # len:2~n+1 for i in range(n+1-l+1): # left:0~n+1-len j=i+l # right = left + len for k in range(i+1, j): # å¼€åŒºé—´(i,j) å³[i+1, j-1] f[i][j] = max(f[i][j], f[i][k]+f[k][j]+nums[i]*nums[k]*nums[j]) return f[0][n+1] 301. åˆ é™¤æ— æ•ˆçš„æ‹¬å· é¢˜ç›®å¤§æ„ï¼šç»™å®šä¸€ä¸ªç”±å­—æ¯å’Œæ‹¬å·ç»„æˆçš„å­—ç¬¦ä¸²sï¼Œè¦æ±‚åˆ é™¤æœ€å°æ•°é‡çš„æ‹¬å·ï¼Œä½¿å¾—å­—ç¬¦ä¸²æˆä¸ºæœ‰æ•ˆçš„æ‹¬å·ç»„åˆï¼Œå¹¶è¿”å›æ‰€æœ‰å¯èƒ½çš„ç»“æœã€‚\nå®ç°æ€è·¯ï¼š\né¦–å…ˆå®šä¹‰ä¸€ä¸ªè¾…åŠ©å‡½æ•°check(st)ï¼Œç”¨äºæ£€æŸ¥å­—ç¬¦ä¸²stæ˜¯å¦ä¸ºæœ‰æ•ˆçš„æ‹¬å·ç»„åˆã€‚éå†å­—ç¬¦ä¸²ä¸­çš„æ¯ä¸ªå­—ç¬¦ï¼Œç»´æŠ¤ä¸€ä¸ªè®¡æ•°å™¨cntï¼Œé‡åˆ°å·¦æ‹¬å·å¢åŠ è®¡æ•°ï¼Œé‡åˆ°å³æ‹¬å·å‡å°‘è®¡æ•°ï¼Œè‹¥å‡ºç°cntä¸ºè´Ÿæ•°ï¼Œæˆ–è€…éå†ç»“æŸåcntä¸ä¸º0ï¼Œåˆ™è¯´æ˜æ‹¬å·ä¸åŒ¹é…ï¼Œè¿”å›Falseï¼Œå¦åˆ™è¿”å›Trueã€‚\nåˆå§‹åŒ–ä¸€ä¸ªç©ºåˆ—è¡¨retï¼Œç”¨äºå­˜å‚¨ç»“æœã€‚\nåˆå§‹åŒ–ä¸€ä¸ªé›†åˆcurï¼Œåˆå§‹æ—¶å°†è¾“å…¥å­—ç¬¦ä¸²sä½œä¸ºå”¯ä¸€å…ƒç´ åŠ å…¥å…¶ä¸­ã€‚\nä½¿ç”¨whileå¾ªç¯ï¼Œç›´åˆ°æ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„ç»“æœä¸ºæ­¢ï¼š\néå†é›†åˆcurä¸­çš„æ¯ä¸ªå­—ç¬¦ä¸²ï¼Œæ£€æŸ¥å…¶æ˜¯å¦ä¸ºæœ‰æ•ˆæ‹¬å·ç»„åˆï¼Œè‹¥æ˜¯åˆ™å°†å…¶åŠ å…¥ç»“æœåˆ—è¡¨retã€‚\nè‹¥ç»“æœåˆ—è¡¨retä¸ä¸ºç©ºï¼Œåˆ™è¯´æ˜å·²æ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„ç»“æœï¼Œç»“æŸå¾ªç¯ã€‚\nå¦åˆ™ï¼Œåˆå§‹åŒ–ä¸€ä¸ªç©ºé›†åˆnxtï¼Œç”¨äºå­˜å‚¨ä¸‹ä¸€è½®è¿­ä»£çš„å€™é€‰å­—ç¬¦ä¸²é›†åˆã€‚\néå†é›†åˆcurä¸­çš„æ¯ä¸ªå­—ç¬¦ä¸²ï¼Œå¯¹äºæ¯ä¸ªå­—ç¬¦ä¸²ï¼Œå°è¯•åˆ é™¤ä¸€ä¸ªå­—ç¬¦ï¼ˆæ‹¬å·ï¼‰ï¼Œç”Ÿæˆæ–°çš„å­—ç¬¦ä¸²ï¼Œå¹¶å°†å…¶åŠ å…¥nxtä¸­ã€‚\næ›´æ–°curä¸ºnxtï¼Œç»§ç»­ä¸‹ä¸€è½®è¿­ä»£ã€‚\nè¿”å›ç»“æœåˆ—è¡¨retã€‚\nclass Solution: def removeInvalidParentheses(self, s: str) -\u0026gt; List[str]: ret = [] def check(st): cnt=0 for c in st: if c==\u0026#39;(\u0026#39;: cnt+=1 elif c==\u0026#39;)\u0026#39;: if cnt==0: return False cnt-=1 return cnt==0 cur = set([s]) while True: for st in cur: if check(st): ret.append(st) if len(ret): break nxt = set() for st in cur: for i in range(len(st)): if i\u0026gt;0 and st[i]==st[i-1]: continue if st[i]==\u0026#39;(\u0026#39; or st[i]==\u0026#39;)\u0026#39;: nxt.add(st[:i]+st[i+1:]) cur = nxt return ret 11. ç››æœ€å¤šæ°´çš„å®¹å™¨ é¢˜ç›®å¤§æ„ï¼šç»™å®šä¸€ä¸ªé•¿åº¦ä¸ºnçš„æ•´æ•°æ•°ç»„heightï¼Œæ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ ä»£è¡¨ä¸€æ¡å‚ç›´çº¿çš„é«˜åº¦ã€‚æ‰¾å‡ºå…¶ä¸­çš„ä¸¤æ¡çº¿ï¼Œä½¿å¾—å®ƒä»¬ä¸xè½´æ„æˆçš„å®¹å™¨å¯ä»¥å®¹çº³æœ€å¤šçš„æ°´ã€‚\nå®ç°æ€è·¯ï¼šä½¿ç”¨åŒæŒ‡é’ˆæ³•ã€‚åˆå§‹åŒ–å·¦æŒ‡é’ˆlæŒ‡å‘æ•°ç»„çš„èµ·å§‹ä½ç½®ï¼Œå³æŒ‡é’ˆræŒ‡å‘æ•°ç»„çš„æœ«å°¾ä½ç½®ã€‚è®¾ç½®å˜é‡retç”¨äºè®°å½•å½“å‰æœ€å¤§å®¹é‡ï¼Œåˆå§‹åŒ–ä¸º0ã€‚åœ¨æ¯ä¸€è½®å¾ªç¯ä¸­ï¼Œè®¡ç®—å½“å‰å®¹å™¨çš„å®¹é‡ï¼Œå³min(height[l], height[r])ä¹˜ä»¥rå’Œlä¹‹é—´çš„è·ç¦»ï¼Œæ›´æ–°retã€‚ç„¶åæ ¹æ®æŒ‡é’ˆæ‰€æŒ‡å‘çš„é«˜åº¦çš„å¤§å°ï¼Œç§»åŠ¨æŒ‡é’ˆï¼Œå¦‚æœheight[l]\u0026lt;height[r]ï¼Œåˆ™ç§»åŠ¨å·¦æŒ‡é’ˆlå‘å³ä¸€æ­¥ï¼Œå¦åˆ™ç§»åŠ¨å³æŒ‡é’ˆrå‘å·¦ä¸€æ­¥ã€‚ç›´åˆ°å·¦å³æŒ‡é’ˆç›¸é‡ï¼Œå¾ªç¯ç»“æŸï¼Œè¿”å›retå³å¯ã€‚\næ­£ç¡®æ€§è¯æ˜ï¼š å¯¹äºå·¦å³ç«¯ç‚¹ $ l, r$ï¼Œ ä¸¤ç‚¹ä¹‹é—´çš„è·ç¦»ä¸º$len = r-l+1-1$(å› ä¸ºä¸¤ä¸ªç‚¹ä¹‹é—´ç®—ä¸€æ®µï¼Œæ‰€ä»¥é•¿åº¦è¦å‡ä¸€)ï¼Œ$ ret = (r-l)*min(height[l], height[r])$,å‡è®¾ $height[l]\u0026lt;height[r]$, å¯¹äºå·¦ç«¯ç‚¹ï¼Œå…¶ä½œä¸ºæŸ±å­èƒ½å®¹çº³çš„æœ€å¤šçš„æ°´çš„æ•°é‡å·²ç»ä¸ºæœ€å¤§å€¼ï¼Œä»»æ„çš„ $l\u0026lt;x\u0026lt;r$ ä½œä¸ºå³ç«¯ç‚¹ä¸€å®šæ¯”$r$åšç«¯ç‚¹æ›´å·®ï¼Œæ‰€ä»¥å¯ä»¥æ’é™¤å·¦ç«¯ç‚¹$l$ï¼Œè®¡ç®—ä¸‹ä¸€ç‚¹å³$l+1$ã€‚ä»å·¦å³ç«¯ç‚¹å¼€å§‹ï¼Œå¯¹äºæ¯æ¬¡æ’é™¤çš„ç‚¹ï¼Œå·²ç»æ‰¾åˆ°è¿™ä¸ªç«¯ç‚¹å¯èƒ½çš„æœ€å¤§å€¼ï¼Œ æ‰€ä»¥å¯ä»¥ä¿è¯ç»“æœçš„æ­£ç¡®æ€§ã€‚ class Solution: def maxArea(self, height: List[int]) -\u0026gt; int: l, r = 0, len(height)-1 ret = 0 while l\u0026lt;r: ret = max( ret, (r-l)*min(height[l], height[r]) ) if height[l]\u0026lt;height[r]: l+=1 elif height[l]\u0026gt;height[r]: r-=1 else: l+=1 r-=1 return ret 647. å›æ–‡å­ä¸² é¢˜ç›®å¤§æ„ï¼šç»™å®šä¸€ä¸ªå­—ç¬¦ä¸²sï¼Œç»Ÿè®¡å¹¶è¿”å›è¯¥å­—ç¬¦ä¸²ä¸­å›æ–‡å­ä¸²çš„æ•°ç›®ã€‚å›æ–‡å­—ç¬¦ä¸²æ˜¯æŒ‡æ­£ç€è¯»å’Œå€’è¿‡æ¥è¯»ä¸€æ ·çš„å­—ç¬¦ä¸²ã€‚å­å­—ç¬¦ä¸²æ˜¯å­—ç¬¦ä¸²ä¸­çš„ç”±è¿ç»­å­—ç¬¦ç»„æˆçš„ä¸€ä¸ªåºåˆ—ã€‚å³ä½¿æ˜¯ç”±ç›¸åŒå­—ç¬¦ç»„æˆçš„ä¸åŒå¼€å§‹ä½ç½®æˆ–ç»“æŸä½ç½®çš„å­ä¸²ï¼Œä¹Ÿä¼šè¢«è§†ä½œä¸åŒçš„å­ä¸²ã€‚\nå®ç°æ€è·¯ï¼šéå†å­—ç¬¦ä¸²sçš„æ‰€æœ‰å¯èƒ½çš„ä¸­å¿ƒä½ç½®ï¼Œå¯¹äºæ¯ä¸ªä¸­å¿ƒä½ç½®ï¼Œå‘ä¸¤è¾¹æ‰©å±•ï¼Œåˆ¤æ–­æ˜¯å¦æ˜¯å›æ–‡ä¸²ã€‚åœ¨æ‰©å±•çš„è¿‡ç¨‹ä¸­ï¼Œæ¯å½“å‘ç°ä¸€ä¸ªå›æ–‡å­ä¸²ï¼Œå°±å°†è®¡æ•°å™¨åŠ 1ã€‚æœ€ç»ˆè¿”å›è®¡æ•°å™¨çš„å€¼å³å¯ã€‚\nclass Solution: def countSubstrings(self, s: str) -\u0026gt; int: n = len(s) ans = 0 for i in range(2*n - 1): l, r = i//2, i//2 + (i\u0026amp;1) while l\u0026gt;=0 and r\u0026lt;n and s[l]==s[r]: l-=1; r+=1 ans+=1 return ans 93. å¤åŸ IP åœ°å€ é¢˜ç›®å¤§æ„ï¼šç»™å®šä¸€ä¸ªåªåŒ…å«æ•°å­—çš„å­—ç¬¦ä¸²sï¼Œè¡¨ç¤ºä¸€ä¸ªIPåœ°å€ï¼Œè¦æ±‚è¿”å›æ‰€æœ‰å¯èƒ½çš„æœ‰æ•ˆIPåœ°å€ï¼Œå³æ¯ä¸ªIPåœ°å€ç”±å››ä¸ªæ•´æ•°ç»„æˆï¼ˆæ¯ä¸ªæ•´æ•°ä½äº0åˆ°255ä¹‹é—´ï¼Œä¸”ä¸èƒ½å«æœ‰å‰å¯¼0ï¼‰ï¼Œæ•´æ•°ä¹‹é—´ç”¨\u0026rsquo;.\u0026lsquo;åˆ†éš”ã€‚ä¸èƒ½é‡æ–°æ’åºæˆ–åˆ é™¤sä¸­çš„ä»»ä½•æ•°å­—ï¼Œå¯ä»¥æŒ‰ä»»ä½•é¡ºåºè¿”å›ç­”æ¡ˆã€‚\nå®ç°æ€è·¯ï¼šä½¿ç”¨æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰ç®—æ³•ï¼Œé€’å½’åœ°æœç´¢æ‰€æœ‰å¯èƒ½çš„IPåœ°å€ç»„åˆã€‚åœ¨æœç´¢è¿‡ç¨‹ä¸­ï¼Œé¦–å…ˆç¡®å®šæ¯ä¸ªæ•´æ•°çš„èŒƒå›´ï¼Œç„¶åéå†å¯èƒ½çš„æ•°å­—ç»„åˆï¼Œé€æ­¥æ„å»ºIPåœ°å€ã€‚é€’å½’çš„ç»ˆæ­¢æ¡ä»¶æ˜¯å·²ç»æ‰¾åˆ°äº†å››ä¸ªæ•´æ•°å¹¶ä¸”å·²ç»éå†å®Œäº†æ•´ä¸ªå­—ç¬¦ä¸²sã€‚\nclass Solution: def restoreIpAddresses(self, s: str) -\u0026gt; List[str]: n = len(s) res, addr = [], [\u0026#39;0\u0026#39;]*4 def dfs(i, start): if i==4 or start==n: if i==4 and start==n: res.append(\u0026#39;.\u0026#39;.join(addr)) return if s[start]==\u0026#39;0\u0026#39;: addr[i] = \u0026#39;0\u0026#39; dfs(i+1, start+1) return num = 0 for end in range(start, n): num = num*10 + int(s[end]) if num in range(256): addr[i] = str(num) dfs(i+1, end+1) dfs(0, 0) return res 538. æŠŠäºŒå‰æœç´¢æ ‘è½¬æ¢ä¸ºç´¯åŠ æ ‘ é¢˜ç›®å¤§æ„ï¼šç»™å®šä¸€ä¸ªäºŒå‰æœç´¢æ ‘çš„æ ¹èŠ‚ç‚¹ï¼Œéœ€è¦å°†å…¶è½¬æ¢ä¸ºç´¯åŠ æ ‘ï¼Œå³æ¯ä¸ªèŠ‚ç‚¹çš„æ–°å€¼ç­‰äºåŸæ ‘ä¸­å¤§äºæˆ–ç­‰äºè¯¥èŠ‚ç‚¹å€¼çš„èŠ‚ç‚¹å€¼ä¹‹å’Œã€‚\nclass Solution: def convertBST(self, root: Optional[TreeNode]) -\u0026gt; Optional[TreeNode]: s = 0 def dfs(r): nonlocal s if not r: return 0 dfs(r.right) s += r.val r.val = s dfs(r.left) dfs(root) return root å®ç°æ€è·¯ï¼š**(Morris éå†)**ä»æ ¹èŠ‚ç‚¹å¼€å§‹ï¼Œé‡‡ç”¨åå‘ä¸­åºéå†ï¼ˆå³-æ ¹-å·¦ï¼‰çš„æ–¹å¼è¿›è¡Œéå†ã€‚åˆ©ç”¨ä¸€ä¸ªå˜é‡ s è®°å½•ç´¯åŠ å’Œï¼Œåˆå§‹å€¼ä¸º 0ã€‚å¯¹äºæ¯ä¸ªèŠ‚ç‚¹ï¼Œé¦–å…ˆåˆ¤æ–­å…¶æ˜¯å¦å­˜åœ¨å³å­èŠ‚ç‚¹ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œåˆ™å°†å…¶å€¼åŠ ä¸Šç´¯åŠ å’Œå¹¶æ›´æ–°ç´¯åŠ å’Œï¼Œç„¶åå°†å½“å‰èŠ‚ç‚¹æŒ‡å‘å…¶å·¦å­èŠ‚ç‚¹ï¼›å¦‚æœå­˜åœ¨å³å­èŠ‚ç‚¹ï¼Œåˆ™æ‰¾åˆ°å…¶ä¸­åºéå†çš„åç»§èŠ‚ç‚¹ï¼Œå³å³å­æ ‘ä¸­æœ€å·¦è¾¹çš„èŠ‚ç‚¹ã€‚å¦‚æœåç»§èŠ‚ç‚¹çš„å·¦å­èŠ‚ç‚¹ä¸ºç©ºï¼Œè¯´æ˜è¿˜æœªå¤„ç†è¿‡è¯¥èŠ‚ç‚¹ï¼Œåˆ™å°†åç»§èŠ‚ç‚¹çš„å·¦å­èŠ‚ç‚¹æŒ‡å‘å½“å‰èŠ‚ç‚¹ï¼Œå¹¶å°†å½“å‰èŠ‚ç‚¹æŒ‡å‘å…¶å³å­èŠ‚ç‚¹ï¼›å¦‚æœåç»§èŠ‚ç‚¹çš„å·¦å­èŠ‚ç‚¹ä¸ºå½“å‰èŠ‚ç‚¹ï¼Œåˆ™è¯´æ˜å·²ç»å¤„ç†è¿‡è¯¥èŠ‚ç‚¹ï¼Œåˆ™å°†åç»§èŠ‚ç‚¹çš„å·¦å­èŠ‚ç‚¹ç½®ä¸ºç©ºï¼Œå°†å½“å‰èŠ‚ç‚¹çš„å€¼åŠ ä¸Šç´¯åŠ å’Œå¹¶æ›´æ–°ç´¯åŠ å’Œï¼Œå¹¶å°†å½“å‰èŠ‚ç‚¹æŒ‡å‘å…¶å·¦å­èŠ‚ç‚¹ã€‚æœ€åè¿”å›æ ¹èŠ‚ç‚¹ã€‚\nclass Solution: def convertBST(self, root: Optional[TreeNode]) -\u0026gt; Optional[TreeNode]: def getSucc(node): succ = node.right while succ.left and succ.left!=node: succ = succ.left return succ newRoot = root s = 0 while root: if not root.right: s += root.val root.val = s root = root.left else: succ = getSucc(root) if not succ.left: succ.left = root root = root.right else: succ.left = None s += root.val root.val = s root = root.left return newRoot 15. ä¸‰æ•°ä¹‹å’Œ é¢˜ç›®å¤§æ„ï¼šç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ numsï¼Œåˆ¤æ–­æ˜¯å¦å­˜åœ¨ä¸‰å…ƒç»„ [nums[i], nums[j], nums[k]] æ»¡è¶³ i != jã€i != k ä¸” j != kï¼ŒåŒæ—¶è¿˜æ»¡è¶³ nums[i] + nums[j] + nums[k] == 0ã€‚è¿”å›æ‰€æœ‰æ»¡è¶³æ¡ä»¶çš„ä¸é‡å¤çš„ä¸‰å…ƒç»„ã€‚\nå®ç°æ€è·¯ï¼šé¦–å…ˆå¯¹æ•°ç»„ nums è¿›è¡Œæ’åºã€‚ç„¶åéå†æ•°ç»„ï¼Œå¯¹äºæ¯ä¸ªå…ƒç´  nums[i]ï¼Œè®¾å®šä¸¤ä¸ªæŒ‡é’ˆ l å’Œ r åˆ†åˆ«æŒ‡å‘ i+1 å’Œæ•°ç»„æœ«å°¾ã€‚åœ¨ l å’Œ r ä¹‹é—´å¯»æ‰¾å’Œä¸º 0 çš„ä¸¤ä¸ªæ•°ã€‚å…·ä½“åœ°ï¼Œå¦‚æœå½“å‰å…ƒç´ ä¸å‰ä¸€ä¸ªå…ƒç´ ç›¸åŒï¼Œè·³è¿‡ï¼›å¦‚æœå½“å‰å…ƒç´ ä¸ l+1 å¤„çš„å…ƒç´ ç›¸åŒï¼Œè·³è¿‡ï¼›åœ¨ l å’Œ r ä¹‹é—´åˆ©ç”¨åŒæŒ‡é’ˆçš„æ–¹å¼æ‰¾åˆ°æ»¡è¶³æ¡ä»¶çš„ä¸¤ä¸ªæ•°ï¼Œå¦‚æœæ‰¾åˆ°äº†æ»¡è¶³æ¡ä»¶çš„ä¸‰å…ƒç»„ï¼Œåˆ™æ·»åŠ åˆ°ç»“æœä¸­ã€‚æœ€åè¿”å›ç»“æœåˆ—è¡¨ resã€‚\nclass Solution: def threeSum(self, nums: List[int]) -\u0026gt; List[List[int]]: n = len(nums) nums.sort() res = [] for i in range(n): l = i r = n-1 if i and nums[i]==nums[i-1]: continue for m in range(l+1, n): if m\u0026gt;l+1 and nums[m]==nums[m-1]: continue while r\u0026gt;m and nums[r]+nums[m]+nums[l]\u0026gt;0: r-=1 if m==r: break if nums[r]+nums[m]+nums[l]==0: res.append([nums[l], nums[m], nums[r]]) return res å®ç°æ€è·¯ï¼šé¦–å…ˆï¼Œåˆ©ç”¨ Counter å‡½æ•°ç»Ÿè®¡æ¯ä¸ªæ•°å‡ºç°çš„æ¬¡æ•°ï¼Œå¹¶æ£€æŸ¥æ˜¯å¦æœ‰ 0 å‡ºç°è‡³å°‘ä¸‰æ¬¡ï¼Œå¦‚æœæ˜¯åˆ™å°† [0, 0, 0] æ·»åŠ åˆ°ç»“æœä¸­ã€‚ç„¶åï¼Œå¯¹ä¸é‡å¤çš„æ•°è¿›è¡Œæ’åºã€‚éå†æ’åºåçš„æ•°ï¼Œå¯¹äºæ¯ä¸ªæ•° numï¼Œå¦‚æœ num ä¸ç­‰äº 0 ä¸” num å‡ºç°æ¬¡æ•°å¤§äº 1 ä¸” -num*2 ä¹Ÿåœ¨ Counter ä¸­ï¼Œåˆ™å°† [num, num, -num*2] æ·»åŠ åˆ°ç»“æœä¸­ã€‚ç„¶åï¼Œåœ¨è´Ÿæ•°éƒ¨åˆ†ï¼Œåˆ©ç”¨åŒæŒ‡é’ˆçš„æ–¹å¼å¯»æ‰¾æ»¡è¶³æ¡ä»¶çš„ä¸¤ä¸ªæ•°ã€‚æœ€åè¿”å›ç»“æœåˆ—è¡¨ resã€‚\nclass Solution: def threeSum(self, nums: List[int]) -\u0026gt; List[List[int]]: res = [] c = Counter(nums) if 0 in c and c[0] \u0026gt;= 3: res.append([0,0,0]) no_repeat_nums = sorted(c.keys()) for i,num in enumerate(no_repeat_nums): if num != 0 and c[num] \u0026gt; 1 and -num*2 in c: res.append([num,num,-num*2]) if num \u0026lt; 0: for num3 in no_repeat_nums[ bisect_left(no_repeat_nums,((-num+1)/2)) : bisect_right(no_repeat_nums,-num*2-1) ]: num2 = -num-num3 if num2 in c: res.append([num,num2,num3]) return res 494. ç›®æ ‡å’Œ é¢˜ç›®å¤§æ„ï¼šç»™å®šä¸€ä¸ªéè´Ÿæ•´æ•°æ•°ç»„ nums å’Œä¸€ä¸ªç›®æ ‡æ•´æ•° targetï¼Œé€šè¿‡ç»™æ•°ç»„ä¸­çš„æ¯ä¸ªæ•´æ•°å‰æ·»åŠ  \u0026lsquo;+\u0026rsquo; æˆ– \u0026lsquo;-\u0026rsquo;ï¼Œç„¶åä¸²è”èµ·æ¥æ„é€ è¡¨è¾¾å¼ï¼Œè¿”å›å¯ä»¥æ„é€ çš„è¡¨è¾¾å¼æ•°ç›®ï¼Œä½¿å…¶è¿ç®—ç»“æœç­‰äºç›®æ ‡æ•°ã€‚\nè®°å¿†åŒ–æœç´¢ å®ç°æ€è·¯ï¼šè¿™ä¸ªé—®é¢˜å¯ä»¥è½¬åŒ–ä¸ºä¸€ä¸ªèƒŒåŒ…é—®é¢˜ã€‚æˆ‘ä»¬å¯ä»¥å°†é—®é¢˜è½¬åŒ–ä¸ºåœ¨æ•°ç»„ä¸­é€‰å–ä¸€äº›æ•°ï¼Œä½¿å¾—å®ƒä»¬çš„å’Œç­‰äº targetã€‚å®šä¹‰ä¸€ä¸ªé€’å½’å‡½æ•° dfs(i, s)ï¼Œè¡¨ç¤ºåœ¨æ•°ç»„ nums ä¸­è€ƒè™‘ç¬¬ i ä¸ªæ•°ï¼Œä½¿å¾—ç›®å‰çš„å’Œä¸º s çš„è¡¨è¾¾å¼æ•°ç›®ã€‚é€’å½’çš„ç»ˆæ­¢æ¡ä»¶æ˜¯éå†å®Œæ‰€æœ‰æ•°ï¼Œå¦‚æœ s ç­‰äº 0ï¼Œè¡¨ç¤ºæ‰¾åˆ°äº†ä¸€ç§æ„é€ æ–¹å¼ï¼Œè¿”å› 1ï¼Œå¦åˆ™è¿”å› 0ã€‚é€’å½’è¿‡ç¨‹ä¸­ï¼Œå¦‚æœ s å°äºå½“å‰æ•° nums[i]ï¼Œè¯´æ˜æ— æ³•é€‰å–å½“å‰æ•°ï¼Œç›´æ¥è·³è¿‡ï¼›å¦åˆ™ï¼Œé€’å½’è€ƒè™‘é€‰å–å½“å‰æ•°å’Œä¸é€‰å–å½“å‰æ•°ä¸¤ç§æƒ…å†µã€‚åˆ©ç”¨ç¼“å­˜è£…é¥°å™¨ @cache å¯ä»¥å°†é‡å¤è®¡ç®—çš„ç»“æœè¿›è¡Œç¼“å­˜ï¼Œæé«˜è®¡ç®—æ•ˆç‡ã€‚æœ€åè¿”å› dfs(0, target) å³å¯å¾—åˆ°ç»“æœã€‚\nclass Solution: def findTargetSumWays(self, nums: List[int], target: int) -\u0026gt; int: target += sum(nums) if target\u0026lt;0 or target\u0026amp;1: return 0 target//=2 @cache def dfs(i, s): if i==len(nums): return 1 if s==0 else 0 if s\u0026lt;nums[i]: return dfs(i+1, s) else: return dfs(i+1, s) + dfs(i+1, s-nums[i]) return dfs(0, target) åŠ¨æ€è§„åˆ’ å®ç°æ€è·¯ï¼šè¿™é‡Œé‡‡ç”¨åŠ¨æ€è§„åˆ’æ¥è§£å†³ã€‚é¦–å…ˆå°†ç›®æ ‡æ•° target åŠ ä¸Šæ•°ç»„ nums çš„æ€»å’Œï¼Œå¦‚æœæ€»å’Œä¸ºè´Ÿæ•°æˆ–è€…æ˜¯å¥‡æ•°ï¼Œåˆ™æ— æ³•é€šè¿‡è°ƒæ•´ç¬¦å·å¾—åˆ°ç›®æ ‡æ•°ï¼Œç›´æ¥è¿”å› 0ã€‚å¦åˆ™ï¼Œå°†ç›®æ ‡æ•°é™¤ä»¥ 2ï¼Œç„¶åå®šä¹‰ä¸€ä¸ªäºŒç»´æ•°ç»„ fï¼Œå…¶ä¸­ f[i][j] è¡¨ç¤ºåœ¨è€ƒè™‘å‰ i ä¸ªæ•°æ—¶ï¼Œæ„é€ å’Œä¸º j çš„è¡¨è¾¾å¼çš„æ•°ç›®ã€‚åˆå§‹åŒ– f[0][0] = 1ã€‚ç„¶åï¼Œéå†æ•°ç»„ numsï¼Œå¹¶ä¸”æ›´æ–° f[i][j]ã€‚å½“ j å°äºå½“å‰æ•° nums[i-1] æ—¶ï¼Œè¡¨ç¤ºæ— æ³•é€‰å–å½“å‰æ•°ï¼Œåˆ™ f[i][j] ç­‰äºä¸Šä¸€ä¸ªçŠ¶æ€çš„å€¼ï¼›å½“ j å¤§äºç­‰äºå½“å‰æ•° nums[i-1] æ—¶ï¼Œå¯ä»¥é€‰æ‹©åŠ ä¸Šæˆ–å‡å»å½“å‰æ•°ï¼Œåˆ™ f[i][j] ç­‰äºä¸Šä¸€ä¸ªçŠ¶æ€åŠ ä¸Šä¸é€‰å–å½“å‰æ•°çš„å€¼ä»¥åŠä¸Šä¸€ä¸ªçŠ¶æ€åŠ ä¸Šé€‰å–å½“å‰æ•°çš„å€¼ã€‚æœ€åè¿”å› f[n][target]ï¼Œå…¶ä¸­ n æ˜¯æ•°ç»„ nums çš„é•¿åº¦ã€‚\nclass Solution: def findTargetSumWays(self, nums: List[int], target: int) -\u0026gt; int: target+=sum(nums) if target\u0026lt;0 or target%2: return 0 target//=2 n = len(nums) f = [[0]*(target+1) for _ in range(n+1)] f[0][0] = 1 for i in range(1, n+1): for j in range(target+1): if j\u0026lt;nums[i-1]: f[i][j] = f[i-1][j] else: f[i][j] = f[i-1][j] + f[i-1][j-nums[i-1]] return f[n][target] 581. æœ€çŸ­æ— åºè¿ç»­å­æ•°ç»„ é¢˜ç›®å¤§æ„ï¼šç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ numsï¼Œæ‰¾å‡ºä¸€ä¸ªè¿ç»­å­æ•°ç»„ï¼Œä½¿å¾—å¯¹è¯¥å­æ•°ç»„è¿›è¡Œå‡åºæ’åºåï¼Œæ•´ä¸ªæ•°ç»„éƒ½å˜ä¸ºå‡åºæ’åºã€‚è¦æ±‚æ‰¾å‡ºç¬¦åˆé¢˜æ„çš„æœ€çŸ­å­æ•°ç»„ï¼Œå¹¶è¾“å‡ºå…¶é•¿åº¦ã€‚\nå®ç°æ€è·¯ï¼šä½¿ç”¨ä¸¤ä¸ªæŒ‡é’ˆleftå’Œrightï¼Œåˆå§‹åŒ–ä¸º-1ï¼Œéå†æ•°ç»„numsã€‚é¦–å…ˆï¼Œä»å·¦åˆ°å³æ‰¾åˆ°ç¬¬ä¸€ä¸ªæ— åºçš„å…ƒç´ ï¼Œå³å½“å‰å…ƒç´ å°äºå‰é¢å·²éå†è¿‡çš„æœ€å¤§å…ƒç´ ï¼Œæ­¤æ—¶æ›´æ–°rightæŒ‡é’ˆä¸ºå½“å‰ä½ç½®iï¼›ç„¶åï¼Œä»å³åˆ°å·¦æ‰¾åˆ°ç¬¬ä¸€ä¸ªæ— åºçš„å…ƒç´ ï¼Œå³å½“å‰å…ƒç´ å¤§äºåé¢å·²éå†è¿‡çš„æœ€å°å…ƒç´ ï¼Œæ­¤æ—¶æ›´æ–°leftæŒ‡é’ˆä¸ºå½“å‰ä½ç½®n-i-1ã€‚æœ€ç»ˆè¿”å›right-left+1å³ä¸ºæœ€çŸ­æ— åºè¿ç»­å­æ•°ç»„çš„é•¿åº¦ã€‚\nclass Solution: def findUnsortedSubarray(self, nums: List[int]) -\u0026gt; int: n = len(nums) ma, right = -inf, -1 mi, left = inf, -1 for i in range(n): if ma\u0026gt;nums[i]: right = i else: ma = nums[i] if mi\u0026lt;nums[n-i-1]: left = n-i-1 else: mi = nums[n-i-1] return 0 if right==-1 else right-left+1 416. åˆ†å‰²ç­‰å’Œå­é›† é¢˜ç›®å¤§æ„ï¼šç»™å®šä¸€ä¸ªéç©ºæ•°ç»„ numsï¼Œæ•°ç»„ä¸­åªåŒ…å«æ­£æ•´æ•°ã€‚è¦æ±‚åˆ¤æ–­æ˜¯å¦èƒ½å°†è¯¥æ•°ç»„åˆ†å‰²æˆä¸¤ä¸ªå­é›†ï¼Œä½¿å¾—è¿™ä¸¤ä¸ªå­é›†çš„å…ƒç´ å’Œç›¸ç­‰ã€‚\nå®ç°æ€è·¯ï¼š\né¦–å…ˆè®¡ç®—æ•°ç»„ nums çš„æ€»å’Œ sã€‚ å¦‚æœæ€»å’Œ s ä¸ºå¥‡æ•°ï¼Œé‚£ä¹ˆæ— æ³•åˆ†å‰²æˆä¸¤ä¸ªå’Œç›¸ç­‰çš„å­é›†ï¼Œç›´æ¥è¿”å› Falseã€‚ å¦‚æœæ•°ç»„ä¸­çš„æœ€å¤§å€¼å¤§äºæ€»å’Œçš„ä¸€åŠï¼Œåˆ™æ— æ³•åˆ†å‰²æˆä¸¤ä¸ªå’Œç›¸ç­‰çš„å­é›†ï¼Œç›´æ¥è¿”å› Falseã€‚ åˆå§‹åŒ–ä¸€ä¸ªå¤§å°ä¸ºæ€»å’Œä¸€åŠåŠ ä¸€çš„å¸ƒå°”æ•°ç»„ fï¼Œf[i] è¡¨ç¤ºæ˜¯å¦å­˜åœ¨å­é›†çš„å’Œä¸º iã€‚ å°† f[0] åˆå§‹åŒ–ä¸º Trueï¼Œè¡¨ç¤ºå­é›†çš„å’Œä¸º 0ã€‚ éå†æ•°ç»„ numsï¼Œå¯¹äºæ¯ä¸ªæ­£æ•´æ•° numï¼Œä»æ€»å’Œä¸€åŠå¼€å§‹å‘å‰éå†ï¼Œæ›´æ–°æ•°ç»„ fï¼Œå¦‚æœ f[j-num] ä¸º Trueï¼Œåˆ™è¯´æ˜å­˜åœ¨ä¸€ä¸ªå­é›†çš„å’Œä¸º j-numï¼ŒåŠ ä¸Šå½“å‰çš„ num åï¼Œå’Œä¸º jï¼Œå› æ­¤ f[j] ä¹Ÿä¸º Trueã€‚ æœ€ç»ˆè¿”å› f[s//2]ï¼Œè¡¨ç¤ºæ˜¯å¦å­˜åœ¨ä¸€ä¸ªå­é›†çš„å’Œä¸ºæ€»å’Œä¸€åŠï¼Œå³æ˜¯å¦èƒ½åˆ†å‰²æˆä¸¤ä¸ªå’Œç›¸ç­‰çš„å­é›†ã€‚ class Solution: def canPartition(self, nums: List[int]) -\u0026gt; bool: s = sum(nums) if s\u0026amp;1: return False ma = max(nums) t = s//2 if ma\u0026gt;t: return False n = len(nums) f = [False]*(t+1) f[0] = True for i, num in enumerate(nums): for j in range(t, num-1, -1): f[j] |= f[j-num] return f[t] 394. å­—ç¬¦ä¸²è§£ç  é¢˜ç›®å¤§æ„ï¼šç»™å®šä¸€ä¸ªç»è¿‡ç¼–ç çš„å­—ç¬¦ä¸²ï¼Œå…¶ä¸­ç¼–ç è§„åˆ™ä¸ºk[encoded_string]ï¼Œè¡¨ç¤ºencoded_stringä¸­çš„å†…å®¹é‡å¤kæ¬¡ã€‚è¦æ±‚è§£ç è¯¥å­—ç¬¦ä¸²ã€‚\nå®ç°æ€è·¯ï¼šä½¿ç”¨é€’å½’æ¥è§£ç å­—ç¬¦ä¸²ã€‚éå†è¾“å…¥å­—ç¬¦ä¸²ï¼Œæ ¹æ®ä¸åŒæƒ…å†µè¿›è¡Œå¤„ç†ï¼š\nè‹¥é‡åˆ°æ•°å­—ï¼Œåˆ™ç´¯åŠ æ•°å­—ç›´è‡³é‡åˆ°éæ•°å­—å­—ç¬¦ã€‚ è‹¥é‡åˆ°å­—æ¯ï¼Œåˆ™ç›´æ¥åŠ å…¥å½“å‰è§£ç çš„å­—ç¬¦ä¸²ä¸­ã€‚ è‹¥é‡åˆ°å·¦æ‹¬å·\u0026rsquo;[\u0026rsquo;ï¼Œåˆ™é€’å½’è°ƒç”¨è§£ç å‡½æ•°ï¼Œå¤„ç†æ‹¬å·å†…çš„å†…å®¹ï¼Œç›´è‡³é‡åˆ°å³æ‹¬å·\u0026rsquo;]\u0026rsquo;ã€‚å°†æ‹¬å·å†…çš„è§£ç ç»“æœä¹˜ä»¥å‰é¢ç´¯ç§¯çš„æ•°å­—ï¼Œå¹¶åŠ å…¥å½“å‰è§£ç çš„å­—ç¬¦ä¸²ä¸­ã€‚ è‹¥é‡åˆ°å³æ‹¬å·\u0026rsquo;]\u0026rsquo;ï¼Œåˆ™è¿”å›å½“å‰è§£ç çš„å­—ç¬¦ä¸²å’Œå½“å‰ç´¢å¼•ã€‚ è¿”å›æœ€ç»ˆè§£ç ç»“æœã€‚ class Solution: def decodeString(self, s: str) -\u0026gt; str: def decode(i, n): cur = \u0026#34;\u0026#34;; num = 0 while i\u0026lt;len(s): if s[i].isdigit(): num = num*10 + int(s[i]) elif s[i].isalpha(): cur += s[i] elif s[i] == \u0026#39;[\u0026#39;: ns, ni = decode(i+1, num) # next str, next index cur += ns; i = ni num = 0 elif s[i]==\u0026#39;]\u0026#39;: return cur*n, i i += 1 return cur*n, i res, _ = decode(0, 1) return res 72. ç¼–è¾‘è·ç¦» é¢˜ç›®å¤§æ„ï¼š ç»™å®šä¸¤ä¸ªå•è¯ word1 å’Œ word2ï¼Œæ±‚é€šè¿‡æ’å…¥ã€åˆ é™¤æˆ–æ›¿æ¢å­—ç¬¦ï¼Œå°† word1 è½¬æ¢æˆ word2 æ‰€éœ€çš„æœ€å°‘æ“ä½œæ•°ã€‚\nè®°å¿†åŒ–æœç´¢ è¿™æ®µä»£ç ä½¿ç”¨äº†é€’å½’çš„æ–¹å¼æ±‚è§£ï¼Œå…¶ä¸­ dfs å‡½æ•°è¡¨ç¤ºå°† s çš„å‰ i ä¸ªå­—ç¬¦è½¬æ¢ä¸º t çš„å‰ j ä¸ªå­—ç¬¦æ‰€éœ€çš„æœ€å°‘æ“ä½œæ•°ã€‚é€’å½’çš„åŸºæœ¬æƒ…å†µæ˜¯å½“ i å°äº 0 æ—¶ï¼Œè¡¨ç¤º s å·²ç»éå†å®Œï¼Œéœ€è¦æ’å…¥ t çš„å‰ j+1 ä¸ªå­—ç¬¦ï¼›å½“ j å°äº 0 æ—¶ï¼Œè¡¨ç¤º t å·²ç»éå†å®Œï¼Œéœ€è¦åˆ é™¤ s çš„å‰ i+1 ä¸ªå­—ç¬¦ï¼›å½“ s[i] ç­‰äº t[j] æ—¶ï¼Œä¸éœ€è¦é¢å¤–æ“ä½œï¼Œç›´æ¥é€’å½’å¤„ç† i-1 å’Œ j-1ï¼›å½“ s[i] ä¸ç­‰äº t[j] æ—¶ï¼Œå¯ä»¥é€‰æ‹©æ’å…¥ã€åˆ é™¤æˆ–æ›¿æ¢æ“ä½œï¼Œé€‰æ‹©æ“ä½œæ•°æœ€å°çš„æ–¹æ¡ˆã€‚é€’å½’çš„è¿‡ç¨‹ä¸­åˆ©ç”¨äº†ç¼“å­˜è£…é¥°å™¨ @cache æ¥æé«˜æ•ˆç‡ã€‚\nclass Solution: def minDistance(self, s: str, t: str) -\u0026gt; int: n, m = len(s), len(t) @cache def dfs(i, j): if i\u0026lt;0: return j+1 if j\u0026lt;0: return i+1 if s[i]==t[j]: return dfs(i-1, j-1) return min(dfs(i-1, j), dfs(i, j-1), dfs(i-1, j-1)) + 1 return dfs(n-1, m-1) é€’æ¨ å®ç°æ€è·¯ï¼š å¯ä»¥ä½¿ç”¨åŠ¨æ€è§„åˆ’æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚å®šä¹‰ä¸€ä¸ªäºŒç»´æ•°ç»„ fï¼Œå…¶ä¸­ f[i][j] è¡¨ç¤ºå°† word1 çš„å‰ i ä¸ªå­—ç¬¦è½¬æ¢ä¸º word2 çš„å‰ j ä¸ªå­—ç¬¦æ‰€éœ€çš„æœ€å°‘æ“ä½œæ•°ã€‚åˆå§‹æ—¶ï¼Œf[i][0] è¡¨ç¤ºå°† word1 çš„å‰ i ä¸ªå­—ç¬¦å…¨éƒ¨åˆ é™¤ï¼Œéœ€è¦çš„æ“ä½œæ•°ä¸º iï¼Œè€Œ f[0][j] è¡¨ç¤ºå°† word2 çš„å‰ j ä¸ªå­—ç¬¦å…¨éƒ¨æ’å…¥åˆ° word1 ä¸­ï¼Œéœ€è¦çš„æ“ä½œæ•°ä¸º jã€‚ ç„¶åï¼Œæ ¹æ®åŠ¨æ€è§„åˆ’çš„çŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼Œé€æ­¥è®¡ç®— f[i][j] çš„å€¼ã€‚è‹¥ word1[i] ç­‰äº word2[j]ï¼Œåˆ™ f[i][j] ç­‰äº f[i-1][j-1]ï¼Œå³ä¸éœ€è¦é¢å¤–æ“ä½œï¼›è‹¥ä¸ç›¸ç­‰ï¼Œåˆ™å¯ä»¥è€ƒè™‘æ’å…¥ã€åˆ é™¤æˆ–æ›¿æ¢æ“ä½œï¼Œé€‰æ‹©æ“ä½œæ•°æœ€å°çš„æ–¹æ¡ˆã€‚æœ€ç»ˆï¼Œè¿”å› f[n][m]ï¼Œå…¶ä¸­ n å’Œ m åˆ†åˆ«ä¸º word1 å’Œ word2 çš„é•¿åº¦ã€‚\nclass Solution: def minDistance(self, s: str, t: str) -\u0026gt; int: n, m = len(s), len(t) f = [[0]*(m+1) for _ in range(n+1)] f[0] = list(range(m+1)) # f[0][j] = j for i in range(n): f[i+1][0] = i+1 for j in range(m): if s[i]==t[j]: f[i+1][j+1] = f[i][j] else: f[i+1][j+1] = min(f[i][j+1], f[i+1][j], f[i][j]) + 1 return f[n][m] 96. ä¸åŒçš„äºŒå‰æœç´¢æ ‘ class Solution: def numTrees(self, n: int) -\u0026gt; int: f = [0]*(n+1) f[0] = 1; f[1] = 1 for i in range(2, n+1): for j in range(1, i+1): f[i] += f[i-j]*f[j-1] return f[n] 160. ç›¸äº¤é“¾è¡¨ class Solution: def getIntersectionNode(self, headA: ListNode, headB: ListNode) -\u0026gt; Optional[ListNode]: l1, l2 = headA, headB while l1 != l2: l1 = headB if not l1 else l1.next l2 = headA if not l2 else l2.next return l1 31. ä¸‹ä¸€ä¸ªæ’åˆ— é¢˜ç›®å¤§æ„ï¼šç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ï¼Œè¦æ±‚æ‰¾å‡ºè¿™ä¸ªæ•°ç»„çš„ä¸‹ä¸€ä¸ªæ’åˆ—ï¼Œå³æ¯”å½“å‰æ’åˆ—å¤§çš„ä¸‹ä¸€ä¸ªæ’åˆ—ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™è¿”å›å­—å…¸åºæœ€å°çš„æ’åˆ—ã€‚\nå®ç°æ€è·¯ï¼šè¦æ‰¾åˆ°ä¸‹ä¸€ä¸ªæ’åˆ—ï¼Œå¯ä»¥éµå¾ªä»¥ä¸‹æ­¥éª¤ï¼š\nä»æ•°ç»„æœ«å°¾å¼€å§‹ï¼Œæ‰¾åˆ°ç¬¬ä¸€ä¸ªç›¸é‚»çš„ä¸¤ä¸ªæ•°ï¼Œæ»¡è¶³ nums[i] \u0026lt; nums[i+1]ã€‚ å¦‚æœæ‰¾åˆ°äº†è¿™æ ·çš„ä¸€å¯¹æ•°ï¼Œè¯´æ˜å½“å‰æ’åˆ—è¿˜ä¸æ˜¯æœ€å¤§çš„æ’åˆ—ï¼Œå¯ä»¥è¿›è¡Œä¸‹ä¸€æ­¥æ“ä½œã€‚ åœ¨ä»å³å¾€å·¦æ‰¾åˆ°çš„ç¬¬ä¸€ä¸ªä½ç½®è®°ä¸º iï¼Œå†ä»æ•°ç»„æœ«å°¾å¼€å§‹ï¼Œæ‰¾åˆ°ç¬¬ä¸€ä¸ªå¤§äº nums[i] çš„æ•°ï¼Œè®°ä¸º jã€‚ äº¤æ¢ nums[i] å’Œ nums[j]ã€‚ å°†ä» i+1 ä½ç½®å¼€å§‹åˆ°æ•°ç»„æœ«å°¾çš„æ•°é€†åºæ’åˆ—ï¼Œä»¥å¾—åˆ°å­—å…¸åºæœ€å°çš„æ’åˆ—ã€‚ å¦‚æœæ­¥éª¤1ä¸­æ²¡æœ‰æ‰¾åˆ°ç›¸é‚»çš„ä¸¤ä¸ªæ•°ï¼Œåˆ™è¯´æ˜å½“å‰æ’åˆ—å·²ç»æ˜¯æœ€å¤§çš„æ’åˆ—ï¼Œç›´æ¥å°†æ•´ä¸ªæ•°ç»„é€†åºæ’åˆ—å³å¯ã€‚ class Solution: def nextPermutation(self, nums: List[int]) -\u0026gt; None: \u0026#34;\u0026#34;\u0026#34; Do not return anything, modify nums in-place instead. \u0026#34;\u0026#34;\u0026#34; n = len(nums) i = n-2 while i\u0026gt;=0 and nums[i] \u0026gt;= nums[i+1]: i-=1 if i\u0026gt;=0: j = n-1 while j\u0026gt;=i and nums[j] \u0026lt;= nums[i]: j-=1 nums[i], nums[j] = nums[j], nums[i] nums[i+1:] = reversed(nums[i+1:]) 33. æœç´¢æ—‹è½¬æ’åºæ•°ç»„ é¢˜ç›®å¤§æ„ï¼š ç»™å®šä¸€ä¸ªæŒ‰å‡åºæ’åˆ—çš„æ•´æ•°æ•°ç»„ numsï¼Œæ•°ç»„ä¸­çš„å€¼äº’ä¸ç›¸åŒã€‚è¯¥æ•°ç»„ç»è¿‡æœªçŸ¥çš„æŸä¸ªä¸‹æ ‡æ—‹è½¬ï¼Œå³åŸæœ¬æ’åœ¨æ•°ç»„å¼€å¤´çš„ä¸€éƒ¨åˆ†å…ƒç´ è¢«ç§»åŠ¨åˆ°æ•°ç»„æœ«å°¾ã€‚ç»™å®šä¸€ä¸ªç›®æ ‡å€¼ targetï¼Œå¦‚æœè¯¥ç›®æ ‡å€¼å­˜åœ¨äºæ—‹è½¬åçš„æ•°ç»„ä¸­ï¼Œåˆ™è¿”å›å…¶ä¸‹æ ‡ï¼Œå¦åˆ™è¿”å› -1ã€‚è¦æ±‚è®¾è®¡ä¸€ä¸ªæ—¶é—´å¤æ‚åº¦ä¸º O(log n) çš„ç®—æ³•è§£å†³æ­¤é—®é¢˜ã€‚\nå®ç°æ€è·¯ï¼š\nä½¿ç”¨äºŒåˆ†æŸ¥æ‰¾ç®—æ³•æ¥è§£å†³æ­¤é—®é¢˜ï¼Œä»¥æ»¡è¶³ O(log n) çš„æ—¶é—´å¤æ‚åº¦è¦æ±‚ã€‚ åˆå§‹åŒ–å·¦å³æŒ‡é’ˆ l å’Œ r åˆ†åˆ«æŒ‡å‘æ•°ç»„çš„é¦–å°¾å…ƒç´ ã€‚ åœ¨å¾ªç¯ä¸­ï¼Œè®¡ç®—ä¸­é—´ä½ç½® midï¼Œåˆ¤æ–­ nums[mid] æ˜¯å¦ç­‰äºç›®æ ‡å€¼ targetï¼Œè‹¥æ˜¯åˆ™ç›´æ¥è¿”å› midã€‚ è‹¥ nums[0] \u0026lt;= nums[mid]ï¼Œè¯´æ˜å·¦åŠæ®µæ˜¯æœ‰åºçš„ï¼Œæ­¤æ—¶åˆ¤æ–­ç›®æ ‡å€¼æ˜¯å¦åœ¨å·¦åŠæ®µèŒƒå›´å†…ï¼Œè‹¥æ˜¯åˆ™å°†å³æŒ‡é’ˆç§»åˆ° mid-1ï¼Œå¦åˆ™å°†å·¦æŒ‡é’ˆç§»åˆ° mid+1ã€‚ è‹¥ nums[0] \u0026gt; nums[mid]ï¼Œè¯´æ˜å³åŠæ®µæ˜¯æœ‰åºçš„ï¼Œæ­¤æ—¶åˆ¤æ–­ç›®æ ‡å€¼æ˜¯å¦åœ¨å³åŠæ®µèŒƒå›´å†…ï¼Œè‹¥æ˜¯åˆ™å°†å·¦æŒ‡é’ˆç§»åˆ° mid+1ï¼Œå¦åˆ™å°†å³æŒ‡é’ˆç§»åˆ° mid-1ã€‚ è‹¥å¾ªç¯ç»“æŸä»æœªæ‰¾åˆ°ç›®æ ‡å€¼ï¼Œåˆ™è¿”å› -1ã€‚ class Solution: def search(self, nums: List[int], target: int) -\u0026gt; int: if not nums: return -1 n = len(nums) l, r = 0, n-1 while l\u0026lt;=r: mid = l+r\u0026gt;\u0026gt;1 if nums[mid]==target: return mid if nums[0]\u0026lt;=nums[mid]: if nums[0] \u0026lt;= target \u0026lt; nums[mid]: r = mid-1 else: l = mid+1 else: if nums[mid] \u0026lt; target \u0026lt;= nums[n-1]: l = mid+1 else: r = mid-1 return -1 19. åˆ é™¤é“¾è¡¨çš„å€’æ•°ç¬¬ N ä¸ªç»“ç‚¹ é¢˜ç›®å¤§æ„ï¼šç»™å®šä¸€ä¸ªé“¾è¡¨ï¼Œè¦æ±‚åˆ é™¤å€’æ•°ç¬¬nä¸ªèŠ‚ç‚¹ï¼Œå¹¶è¿”å›é“¾è¡¨çš„å¤´ç»“ç‚¹ã€‚\nå®ç°æ€è·¯ï¼šä½¿ç”¨åŒæŒ‡é’ˆï¼Œé¦–å…ˆè®©ç¬¬ä¸€ä¸ªæŒ‡é’ˆä»å¤´èŠ‚ç‚¹å¼€å§‹å‘åç§»åŠ¨næ­¥ï¼Œç„¶ååŒæ—¶ç§»åŠ¨ç¬¬ä¸€ä¸ªæŒ‡é’ˆå’Œç¬¬äºŒä¸ªæŒ‡é’ˆï¼Œç›´åˆ°ç¬¬ä¸€ä¸ªæŒ‡é’ˆåˆ°è¾¾é“¾è¡¨æœ«å°¾ã€‚è¿™æ ·ç¬¬äºŒä¸ªæŒ‡é’ˆæ‰€æŒ‡çš„ä½ç½®å°±æ˜¯å€’æ•°ç¬¬nä¸ªèŠ‚ç‚¹çš„å‰ä¸€ä¸ªèŠ‚ç‚¹ï¼Œç„¶åè¿›è¡Œåˆ é™¤æ“ä½œå³å¯ã€‚éœ€è¦æ³¨æ„çš„æ˜¯è¦è€ƒè™‘è¾¹ç•Œæƒ…å†µï¼Œæ¯”å¦‚é“¾è¡¨é•¿åº¦ä¸º1ï¼Œåˆ é™¤å¤´èŠ‚ç‚¹ç­‰æƒ…å†µã€‚\n# Definition for singly-linked list. # class ListNode: # def __init__(self, val=0, next=None): # self.val = val # self.next = next class Solution: def removeNthFromEnd(self, head: Optional[ListNode], n: int) -\u0026gt; Optional[ListNode]: if not head.next: return None p1 = head n-=1 while n: p1 = p1.next n-=1 pre = p2 = head while p1.next: p1 = p1.next pre = p2 p2 = p2.next if p2==head: head = head.next else: pre.next = pre.next.next return head 148. æ’åºé“¾è¡¨ é¢˜ç›®å¤§æ„ï¼šç»™å®šä¸€ä¸ªé“¾è¡¨çš„å¤´ç»“ç‚¹headï¼Œè¦æ±‚å°†é“¾è¡¨æŒ‰å‡åºæ’åˆ—ï¼Œå¹¶è¿”å›æ’åºåçš„é“¾è¡¨ã€‚\nå®ç°æ€è·¯ï¼š\nä½¿ç”¨å½’å¹¶æ’åºçš„æ€æƒ³å¯¹é“¾è¡¨è¿›è¡Œæ’åºã€‚ ç¼–å†™é€’å½’å‡½æ•°sortFun(head, tail)ï¼Œå…¶ä¸­headè¡¨ç¤ºå½“å‰å¾…æ’åºçš„å­é“¾è¡¨çš„å¤´ç»“ç‚¹ï¼Œtailè¡¨ç¤ºå½“å‰å¾…æ’åºçš„å­é“¾è¡¨çš„å°¾ç»“ç‚¹çš„ä¸‹ä¸€ä¸ªç»“ç‚¹ï¼ˆå³å°¾ç»“ç‚¹çš„åç»§ç»“ç‚¹ï¼‰ã€‚ åœ¨sortFunå‡½æ•°ä¸­ï¼Œä½¿ç”¨å¿«æ…¢æŒ‡é’ˆæ‰¾åˆ°å½“å‰å¾…æ’åºå­é“¾è¡¨çš„ä¸­é—´ç»“ç‚¹midï¼Œå¹¶å°†é“¾è¡¨åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œå·¦è¾¹éƒ¨åˆ†ç”±headåˆ°mid-1ï¼Œå³è¾¹éƒ¨åˆ†ç”±midåˆ°tail-1ã€‚ é€’å½’è°ƒç”¨sortFunå‡½æ•°å¯¹å·¦å³ä¸¤éƒ¨åˆ†è¿›è¡Œæ’åºï¼Œç›´è‡³æ’åºå®Œæˆã€‚ ç¼–å†™mergeå‡½æ•°ï¼Œå°†å·²ç»æ’å¥½åºçš„å·¦å³ä¸¤éƒ¨åˆ†é“¾è¡¨è¿›è¡Œåˆå¹¶ï¼Œåˆå¹¶è¿‡ç¨‹ä¸­æŒ‰ç…§ç»“ç‚¹çš„å€¼å¤§å°è¿›è¡Œæ¯”è¾ƒï¼Œå°†è¾ƒå°çš„ç»“ç‚¹è¿æ¥åˆ°ç»“æœé“¾è¡¨ä¸­ã€‚ è¿”å›åˆå¹¶åçš„é“¾è¡¨ã€‚ # Definition for singly-linked list. # class ListNode: # def __init__(self, val=0, next=None): # self.val = val # self.next = next class Solution: def sortList(self, head: Optional[ListNode]) -\u0026gt; Optional[ListNode]: def sortFun(head, tail): if not head: return head if head.next == tail: head.next = None return head slow = fast = head while fast != tail: fast = fast.next slow = slow.next if fast != tail: fast = fast.next mid = slow return merge(sortFun(head, mid), sortFun(mid, tail)) def merge(h1, h2): dummy = ListNode(-1) cur = dummy while h1 and h2: if h1.val\u0026lt;=h2.val: cur.next = h1 h1 = h1.next else: cur.next = h2 h2 = h2.next cur = cur.next if h1: cur.next = h1 if h2: cur.next = h2 return dummy.next return sortFun(head, None) 581. æœ€çŸ­æ— åºè¿ç»­å­æ•°ç»„ é¢˜ç›®å¤§æ„ï¼šç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„numsï¼Œæ‰¾å‡ºä¸€ä¸ªè¿ç»­å­æ•°ç»„ï¼Œä½¿å¾—å¯¹è¯¥å­æ•°ç»„è¿›è¡Œå‡åºæ’åºåï¼Œæ•´ä¸ªæ•°ç»„éƒ½å˜ä¸ºå‡åºæ’åºã€‚è¦æ±‚æ‰¾å‡ºç¬¦åˆæ¡ä»¶çš„æœ€çŸ­å­æ•°ç»„ï¼Œå¹¶è¾“å‡ºå…¶é•¿åº¦ã€‚\nå®ç°æ€è·¯ï¼š\né¦–å…ˆåˆå§‹åŒ–æœ€å¤§å€¼mxä¸ºè´Ÿæ— ç©·ï¼Œæœ€å°å€¼mnä¸ºæ­£æ— ç©·ï¼Œä»¥åŠæœ€çŸ­å­æ•°ç»„çš„å·¦å³è¾¹ç•Œleftå’Œrightåˆ†åˆ«ä¸º-1ã€‚ éå†æ•°ç»„numsï¼Œä»å·¦å‘å³å¯»æ‰¾å³è¾¹ç•Œrightï¼Œå¦‚æœå½“å‰å…ƒç´ å°äºå‰é¢çš„æœ€å¤§å€¼mxï¼Œåˆ™æ›´æ–°rightä¸ºå½“å‰ç´¢å¼•ï¼›å¦åˆ™æ›´æ–°æœ€å¤§å€¼mxä¸ºå½“å‰å…ƒç´ ã€‚ åŒæ—¶ï¼Œä»å³å‘å·¦å¯»æ‰¾å·¦è¾¹ç•Œleftï¼Œå¦‚æœå½“å‰å…ƒç´ å¤§äºåé¢çš„æœ€å°å€¼mnï¼Œåˆ™æ›´æ–°leftä¸ºå½“å‰ç´¢å¼•ï¼›å¦åˆ™æ›´æ–°æœ€å°å€¼mnä¸ºå½“å‰å…ƒç´ ã€‚ æœ€åè¿”å›å³è¾¹ç•Œå’Œå·¦è¾¹ç•Œçš„å·®åŠ 1ï¼Œå³ä¸ºæœ€çŸ­å­æ•°ç»„çš„é•¿åº¦ã€‚å¦‚æœå·¦è¾¹ç•Œä»ä¸ºåˆå§‹å€¼-1ï¼Œåˆ™è¿”å›0è¡¨ç¤ºæ•´ä¸ªæ•°ç»„å·²ç»æœ‰åºã€‚ class Solution: def findUnsortedSubarray(self, nums: List[int]) -\u0026gt; int: n = len(nums) mx, right = -inf, -1 mn, left = inf, -1 for i in range(n): if mx\u0026gt;nums[i]: right = i else: mx = nums[i] if mn\u0026lt;nums[n-1-i]: left = n-1-i else: mn = nums[n-1-i] return 0 if left==-1 else right-left+1 çº¿æ®µæ ‘ 729. æˆ‘çš„æ—¥ç¨‹å®‰æ’è¡¨ I é¢˜ç›®å¤§æ„ï¼šè¿™ä¸ªé¢˜ç›®æ˜¯å…³äºè®¾è®¡ä¸€ä¸ªæ—¥ç¨‹å®‰æ’ç±» MyCalendarï¼Œå®ƒèƒ½å¤Ÿå­˜å‚¨æ—¥ç¨‹ï¼Œå¹¶åˆ¤æ–­æ˜¯å¦ä¼šæœ‰é‡å¤é¢„è®¢ã€‚æ—¥ç¨‹ä»¥åŠå¼€åŒºé—´ [start, end) è¡¨ç¤ºï¼Œå½“ä¸¤ä¸ªæ—¥ç¨‹æ—¶é—´æœ‰äº¤å æ—¶å°±ä¼šäº§ç”Ÿé‡å¤é¢„è®¢ã€‚ å®ç°æ€è·¯ï¼š\nä½¿ç”¨çº¿æ®µæ ‘ï¼š\næˆ‘ä»¬å¯ä»¥ä½¿ç”¨çº¿æ®µæ ‘æ¥è¡¨ç¤ºæ—¶é—´æ®µçš„é¢„è®¢æƒ…å†µã€‚æ¯ä¸ªèŠ‚ç‚¹ä»£è¡¨ä¸€ä¸ªæ—¶é—´æ®µï¼ŒèŠ‚ç‚¹å€¼è¡¨ç¤ºè¿™ä¸ªæ—¶é—´æ®µæ˜¯å¦è¢«é¢„è®¢ã€‚ å¯¹äºæ¯ä¸ªèŠ‚ç‚¹ï¼Œæˆ‘ä»¬ç»´æŠ¤ä¸¤ä¸ªé›†åˆï¼Œself.tree è¡¨ç¤ºå·²ç»é¢„è®¢çš„èŠ‚ç‚¹ï¼Œself.lazy è¡¨ç¤ºå·²ç»è¢«æ ‡è®°ä¸ºé¢„è®¢ä½†å°šæœªè¢«æ›´æ–°çš„èŠ‚ç‚¹ã€‚ æŸ¥è¯¢åŠŸèƒ½ï¼š\nå½“éœ€è¦æŸ¥è¯¢æŸä¸ªæ—¶é—´æ®µæ˜¯å¦è¢«é¢„è®¢æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨çº¿æ®µæ ‘ä¸Šè¿›è¡ŒæŸ¥è¯¢ã€‚å¦‚æœæŸ¥è¯¢åˆ°æŸä¸ªèŠ‚ç‚¹è¢«æ ‡è®°ä¸ºå·²é¢„è®¢ï¼ˆåŒ…æ‹¬è¢«æ ‡è®°ä¸ºé¢„è®¢ä½†å°šæœªæ›´æ–°çš„èŠ‚ç‚¹ï¼‰ï¼Œåˆ™è¿”å›é¢„è®¢ï¼›å¦åˆ™è¿”å›æœªé¢„è®¢ã€‚ æ›´æ–°åŠŸèƒ½ï¼š\nå½“è¦é¢„è®¢æŸä¸ªæ—¶é—´æ®µæ—¶ï¼Œæˆ‘ä»¬åœ¨çº¿æ®µæ ‘ä¸Šè¿›è¡Œæ›´æ–°æ“ä½œã€‚é¦–å…ˆä»æ ¹èŠ‚ç‚¹å¼€å§‹ï¼Œé€’å½’åœ°å‘ä¸‹æ›´æ–°ï¼Œå°†è¯¥æ—¶é—´æ®µçš„èŠ‚ç‚¹æ ‡è®°ä¸ºå·²é¢„è®¢ï¼Œå¹¶å°†ç»è¿‡çš„èŠ‚ç‚¹åŠ å…¥ self.tree ä¸­ã€‚ åŒæ—¶ï¼Œå¦‚æœè¯¥èŠ‚ç‚¹çš„ä¸¤ä¸ªå­èŠ‚ç‚¹éƒ½è¢«æ ‡è®°ä¸ºå·²é¢„è®¢ï¼Œåˆ™å°†è¯¥èŠ‚ç‚¹ä¹Ÿæ ‡è®°ä¸ºå·²é¢„è®¢ï¼ŒåŒæ—¶åŠ å…¥ self.lazy ä¸­ï¼Œè¡¨ç¤ºå…¶ä¸‹çš„æ‰€æœ‰èŠ‚ç‚¹éƒ½å·²ç»è¢«é¢„è®¢ä½†å°šæœªæ›´æ–°ã€‚ book æ–¹æ³•ï¼š\nåœ¨ book æ–¹æ³•ä¸­ï¼Œé¦–å…ˆåˆ¤æ–­è¦é¢„è®¢çš„æ—¶é—´æ®µæ˜¯å¦å·²ç»è¢«é¢„è®¢ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› Falseï¼›å¦åˆ™ï¼Œè°ƒç”¨ update æ–¹æ³•è¿›è¡Œæ›´æ–°ï¼Œå¹¶è¿”å› Trueã€‚ class MyCalendar: def __init__(self): self.tree = set() self.lazy = set() def query(self, start: int, end: int, l: int, r: int, idx: int) -\u0026gt; bool: if r \u0026lt; start or end \u0026lt; l: return False if idx in self.lazy: # å¦‚æœè¯¥åŒºé—´å·²è¢«é¢„è®¢ï¼Œåˆ™ç›´æ¥è¿”å› return True if start \u0026lt;= l and r \u0026lt;= end: return idx in self.tree mid = (l + r) // 2 return self.query(start, end, l, mid, 2 * idx) or \\ self.query(start, end, mid + 1, r, 2 * idx + 1) def update(self, start, end, l, r, idx): if start\u0026gt;r or end\u0026lt;l: return False if start\u0026lt;=l and r\u0026lt;=end: self.tree.add(idx) self.lazy.add(idx) else: mid = (l+r)\u0026gt;\u0026gt;1 self.update(start, end, l, mid, idx*2) self.update(start, end, mid+1, r, idx*2+1) self.tree.add(idx) if 2*idx in self.lazy and 2*idx+1 in self.lazy: self.lazy.add(idx) def book(self, start: int, end: int) -\u0026gt; bool: if self.query(start, end-1, 0, 10**9, 1): return False self.update(start, end-1, 0, 10**9, 1) return True 2286. ä»¥ç»„ä¸ºå•ä½è®¢éŸ³ä¹ä¼šçš„é—¨ç¥¨ é¢˜ç›®å¤§æ„ï¼š è®¾è®¡ä¸€ä¸ªä¹°ç¥¨ç³»ç»Ÿï¼Œé’ˆå¯¹éŸ³ä¹ä¼šçš„åº§ä½å®‰æ’ã€‚éŸ³ä¹ä¼šæ€»å…±æœ‰næ’åº§ä½ï¼Œæ¯æ’æœ‰mä¸ªåº§æ¤…ã€‚ç³»ç»Ÿéœ€è¦å¤„ç†ä¸¤ç§æƒ…å†µï¼š\ngather(k, maxRow): è¿”å›é•¿åº¦ä¸º2çš„æ•°ç»„ï¼Œè¡¨ç¤ºkä¸ªæˆå‘˜ä¸­ç¬¬ä¸€ä¸ªåº§ä½çš„æ’æ•°å’Œåº§ä½ç¼–å·ï¼Œè¿™kä½æˆå‘˜å¿…é¡»ååœ¨åŒä¸€æ’åº§ä½ï¼Œä¸”åº§ä½è¿ç»­ã€‚å¦‚æœæ— æ³•å®‰æ’åº§ä½ï¼Œè¿”å›ç©ºæ•°ç»„ã€‚ scatter(k, maxRow): å¦‚æœç»„é‡Œæ‰€æœ‰kä¸ªæˆå‘˜ä¸ä¸€å®šè¦ååœ¨ä¸€èµ·çš„å‰æä¸‹ï¼Œéƒ½èƒ½åœ¨ç¬¬0æ’åˆ°ç¬¬maxRowæ’ä¹‹é—´æ‰¾åˆ°åº§ä½ï¼Œè¿”å›trueï¼›å¦åˆ™è¿”å›falseã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œæ¯ä¸ªæˆå‘˜éƒ½ä¼˜å…ˆæ‰¾æ’æ•°æœ€å°ï¼Œç„¶åæ˜¯åº§ä½ç¼–å·æœ€å°çš„åº§ä½ã€‚ å®ç°æ€è·¯ï¼š\nå¯¹äºgather(k, maxRow)ï¼Œå¯ä»¥åˆ©ç”¨çº¿æ®µæ ‘æ¥å®ç°ã€‚ çº¿æ®µæ ‘èŠ‚ç‚¹ç»´æŠ¤æœ€å°å€¼å’Œæ€»å’Œï¼Œç”¨äºæŸ¥æ‰¾æœ€å°å€¼ä»¥åŠæŸ¥è¯¢æ€»å’Œã€‚ ä½¿ç”¨äºŒåˆ†æŸ¥æ‰¾ç¡®å®šç¬¦åˆæ¡ä»¶çš„æœ€å°æ’æ•°ï¼Œå¹¶æ›´æ–°åº§ä½ä¿¡æ¯ã€‚ å¯¹äºscatter(k, maxRow)ï¼ŒåŒæ ·ä½¿ç”¨çº¿æ®µæ ‘æ¥ç»´æŠ¤åº§ä½ä¿¡æ¯ã€‚ éå†æ’æ•°ï¼Œæ ¹æ®å½“å‰æ’çš„å‰©ä½™åº§ä½æ•°é‡å’Œéœ€æ±‚kè¿›è¡Œåˆ¤æ–­ã€‚ è‹¥å½“å‰æ’å‰©ä½™åº§ä½æ•°è¶³å¤Ÿï¼Œå®‰æ’kä¸ªåº§ä½å¹¶è¿”å›trueï¼›è‹¥ä¸è¶³å¤Ÿï¼Œç»§ç»­å‘ä¸‹ä¸€æ’å°è¯•ã€‚ class BookMyShow: def __init__(self, n: int, m: int): self.n, self.m = n, m N = 1 \u0026lt;\u0026lt; n.bit_length() + 1 self.mn = [0] * N # min self.sm = [0] * N # sum def modify(self, u, l, r, x, v): if l == r: self.mn[u] += v self.sm[u] += v else: mid = l + r \u0026gt;\u0026gt; 1 if x \u0026lt;= mid: self.modify(u \u0026lt;\u0026lt; 1, l, mid, x, v) else: self.modify(u \u0026lt;\u0026lt; 1 | 1, mid + 1, r, x, v) self.mn[u] = min(self.mn[u \u0026lt;\u0026lt; 1], self.mn[u \u0026lt;\u0026lt; 1 | 1]) self.sm[u] = self.sm[u \u0026lt;\u0026lt; 1] + self.sm[u \u0026lt;\u0026lt; 1 | 1] def query(self, u, l, r, ql, qr): if l \u0026gt;= ql and r \u0026lt;= qr: return self.sm[u] mid = l + r \u0026gt;\u0026gt; 1 res = 0 if ql \u0026lt;= mid: res = self.query(u \u0026lt;\u0026lt; 1, l, mid, ql, qr) if qr \u0026gt; mid: res += self.query(u \u0026lt;\u0026lt; 1 | 1, mid + 1, r, ql, qr) return res def index(self, u, l, r, qr, v): if self.mn[u] \u0026gt; v: return 0 if l == r: return l mid = l + r \u0026gt;\u0026gt; 1 if self.mn[u \u0026lt;\u0026lt; 1] \u0026lt;= v: return self.index(u \u0026lt;\u0026lt; 1, l, mid, qr, v) if qr \u0026gt; mid: return self.index(u \u0026lt;\u0026lt; 1 | 1, mid + 1, r, qr, v) return 0 def gather(self, k: int, maxRow: int) -\u0026gt; List[int]: i = self.index(1, 1, self.n, maxRow + 1, self.m - k) if i == 0: return [] col = self.query(1, 1, self.n, i, i) self.modify(1, 1, self.n, i, k) return [i - 1, col] def scatter(self, k: int, maxRow: int) -\u0026gt; bool: if self.m * (maxRow + 1) - self.query(1, 1, self.n, 1, maxRow + 1) \u0026lt; k: return False i = self.index(1, 1, self.n, maxRow + 1, self.m - 1) while True: rest = self.m - self.query(1, 1, self.n, i, i) if k \u0026lt;= rest: self.modify(1, 1, self.n, i, k) return True self.modify(1, 1, self.n, i, rest) k -= rest i += 1 å…¶ä»–é¢˜ç›® 3031. å°†å•è¯æ¢å¤åˆå§‹çŠ¶æ€æ‰€éœ€çš„æœ€çŸ­æ—¶é—´ II Zå‡½æ•° é¢˜ç›®å¤§æ„ï¼š ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸² word å’Œä¸€ä¸ªæ•´æ•° kï¼Œæ¯ç§’éœ€è¦æ‰§è¡Œä¸¤ç§æ“ä½œï¼šç§»é™¤å­—ç¬¦ä¸² word çš„å‰ k ä¸ªå­—ç¬¦ï¼Œå¹¶åœ¨å­—ç¬¦ä¸²æœ«å°¾æ·»åŠ  k ä¸ªä»»æ„å­—ç¬¦ã€‚è¦æ±‚è¿”å›å°† word æ¢å¤åˆ°åˆå§‹çŠ¶æ€æ‰€éœ€çš„æœ€çŸ­æ—¶é—´ã€‚\nå®ç°æ€è·¯ï¼š é¦–å…ˆï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ Z å‡½æ•°ï¼ˆZ algorithmï¼‰æ¥æ‰¾åˆ°å­—ç¬¦ä¸²çš„æœ€é•¿å‰ç¼€åç¼€åŒ¹é…é•¿åº¦ã€‚ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ Z å‡½æ•°çš„æ€§è´¨ï¼Œå°†å­—ç¬¦ä¸²åˆ†å‰²æˆä¸åŒçš„å‰ç¼€å­ä¸²ï¼Œæ‰¾åˆ°æ»¡è¶³æ¡ä»¶çš„æœ€å°æ—¶é—´ã€‚\nå…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š\nåˆå§‹åŒ–ä¸€ä¸ªæ•°ç»„ zï¼Œç”¨äºå­˜å‚¨å­—ç¬¦ä¸² s çš„ Z å‡½æ•°å€¼ã€‚ ä½¿ç”¨åŒæŒ‡é’ˆ l å’Œ r æ¥ç»´æŠ¤å½“å‰åŒ¹é…çš„å­ä¸²ã€‚ éå†å­—ç¬¦ä¸² sï¼Œè®¡ç®— z[i] çš„å€¼ï¼Œå³ä»¥ç¬¬ i ä¸ªå­—ç¬¦ä¸ºèµ·å§‹çš„æœ€é•¿å‰ç¼€åç¼€åŒ¹é…é•¿åº¦ã€‚ åœ¨æ¯æ¬¡éå†ä¸­ï¼Œæ›´æ–° l å’Œ r çš„å€¼ï¼Œä¿æŒå½“å‰åŒ¹é…çš„å­ä¸²èŒƒå›´ã€‚ å¦‚æœå½“å‰ä½ç½® i èƒ½å¤Ÿæ»¡è¶³æ¡ä»¶ï¼šå³ i æ˜¯ k çš„å€æ•°ä¸” z[i] ç­‰äºå‰©ä½™å­—ç¬¦ä¸²çš„é•¿åº¦ï¼ˆn - iï¼‰ï¼Œåˆ™è¿”å› i é™¤ä»¥ kã€‚ è‹¥éå†å®Œå­—ç¬¦ä¸²åä»æœªæ‰¾åˆ°æ»¡è¶³æ¡ä»¶çš„ä½ç½®ï¼Œåˆ™è¿”å› (n - 1) é™¤ä»¥ k å†åŠ  1ï¼Œè¡¨ç¤ºéœ€è¦æŠŠå‰©ä½™çš„å­—ç¬¦ä¸²éƒ½ç§»é™¤å¹¶æ·»åŠ åˆ°æœ«å°¾ã€‚ class Solution: def minimumTimeToInitialState(self, s: str, k: int) -\u0026gt; int: n = len(s) z = [0] * n l, r = 0, 0 for i in range(1, n): if i \u0026lt;= r and z[i - l] \u0026lt; r - i + 1: z[i] = z[i - l] else: z[i] = max(0, r - i + 1) while i + z[i] \u0026lt; n and s[z[i]] == s[i + z[i]]: z[i] += 1 if i + z[i] - 1 \u0026gt; r: l = i r = i + z[i] - 1 if i%k==0 and z[i] == n-i: return i//k return (n-1)//k+1 5. æœ€é•¿å›æ–‡å­ä¸²é©¬æ‹‰è½¦ç®—æ³• é¢˜æ„ï¼šæ±‚å­—ç¬¦ä¸²å†…çš„æœ€å¤§å›æ–‡ä¸²é•¿åº¦ æ€è·¯ï¼šé©¬æ‹‰è½¦ç®—æ³•ï¼Œç”±å½“å‰å·²çŸ¥çš„æœ€å¤§å›æ–‡ä¸²é•¿åº¦ï¼Œæˆ‘ä»¬å¯ä»¥ç”±å·²çŸ¥çš„å›æ–‡ä¸²é•¿åº¦ï¼Œæ¨å‡ºå…¶è¦†ç›–çš„ç‚¹çš„æœ€å¤§å›æ–‡ä¸²é•¿åº¦ã€‚å¦‚ä¸‹å›¾ï¼Œp[i]ä½ç½®çš„å›æ–‡ä¸²é•¿åº¦å¯ä»¥ç”±æœ€é•¿çš„å›æ–‡ä¸²(ä»¥aä¸ºä¸­å¿ƒ)å¾—å‡ºï¼Œå› ä¸ºå›æ–‡ä¸²ä¸¤è¾¹æ˜¯å¯¹ç§°çš„ï¼Œæ‰€ä»¥p[i] = p[c + c-i], ä½†æ˜¯å¯¹äºè¦†ç›–ä¸åˆ°çš„éƒ¨åˆ†ï¼Œéœ€è¦å–ä¸‹é™r-iã€‚ class Solution: # æ¨èæ•™å­¦è§†é¢‘ ï¼šhttps://www.bilibili.com/video/BV1Sx4y1k7jG/?spm_id_from=333.337.search-card.all.click\u0026amp;vd_source=a4a2b56f746715b34521bfb853094cf4 def longestPalindrome(self, s: str) -\u0026gt; str: s = \u0026#39;#\u0026#39; + \u0026#39;#\u0026#39;.join(list(s)) + \u0026#39;#\u0026#39; n = len(s) p = [0]*n #æ¯ä¸ªç‚¹çš„ æœ€é•¿å›æ–‡å­—ä¸² èƒ½åˆ°çš„ å³ä¾§ä½ç½® c, r = 0, 0 # å³è¾¹èƒ½åˆ°è¾¾æœ€è¿œçš„è˜‘è‡çš„ä½ç½® å’Œ å…¶æœ€å³è¾¹èƒ½è¾¾åˆ°çš„ä½ç½® for i in range(n): if i\u0026lt;=r: p[i] = min(r-i, p[c + c-i]) # ç”±å·²çŸ¥æ¡ä»¶å¾—åˆ°å½“å‰ä½ç½®èƒ½è¾¾åˆ°çš„æœ€å¤§å³ä¾§è·ç¦»( éœ€è¦å–min(é•œåƒä½ç½®çš„å€¼, å½“å‰æœ€å¤§è˜‘è‡èƒ½è¦†ç›–åˆ°çš„æœ€å¤§å€¼) ) while i+p[i]+1 \u0026lt; n and s[i-p[i]-1] == s[i+p[i]+1]: p[i]+=1 if p[i]+i \u0026gt; r: r = p[i] + i c = i ma = max(p) idx = p.index(ma) return s[idx-ma+1:idx+ma+1:2] ","permalink":"https://kennems.github.io/posts/tech/leetcode%E7%AC%94%E8%AE%B0/","summary":"LeetCodeç¬”è®° ç›®æ ‡ï¼š2500åˆ† HOT100 301. åˆ é™¤æ— æ•ˆçš„æ‹¬å· é¢˜ç›®å¤§æ„ï¼š ç»™ä½ ä¸€ä¸ªç”±è‹¥å¹²æ‹¬å·å’Œå­—æ¯ç»„æˆçš„å­—ç¬¦ä¸² s ï¼Œåˆ é™¤æœ€å°æ•°é‡çš„æ— æ•ˆæ‹¬å·ï¼Œä½¿å¾—è¾“å…¥çš„å­—","title":" LeetCodeç¬”è®°"},{"content":"Linux å¿«æ·é”®ï¼š\nctrl + l æ¸…ç©ºå±å¹•\nLinuxæ–‡ä»¶ç³»ç»Ÿ FHS3.0ï¼ˆFile system Hierarchy Standardï¼‰ / etc é…ç½®æ–‡ä»¶ bin å¿…è¦å‘½ä»¤ usr äºŒçº§ç›®å½• home å®¶ç›®å½• var åŠ¨æ€æ•°æ® VFSè™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿ å†…æ ¸å±‚æŠ½è±¡å‡ºé€šç”¨çš„æ–‡ä»¶ç³»ç»Ÿæ¥å£\næ”¯æŒæ–‡ä»¶ã€ç½‘ç»œã€ç‰¹æ®Šæ–‡ä»¶ç³»ç»Ÿ\næŠ½è±¡å¯¹è±¡ï¼š\nè¶…çº§å¿«ï¼šæ–‡ä»¶ç³»ç»Ÿ ç›®å½•é¡¹ï¼šæ–‡ä»¶è·¯å¾„ ç´¢å¼•èŠ‚ç‚¹ï¼šå…·ä½“æ–‡ä»¶ æ–‡ä»¶ï¼šè¿›ç¨‹æ‰“å¼€çš„æ–‡ä»¶ å±æ€§åˆ†å±‚ç»“æ„\nä¸€åˆ‡çš†æ–‡ä»¶\næ•°æ®ç›˜æŒ‚è½½ fdisk -l inode ï¼šå­˜å‚¨æ•°æ®çš„å…ƒæ•°æ®\nLinuxæ²¡æœ‰ç›˜ç¬¦çš„æ¦‚å¿µï¼Œåªæœ‰ä¸€ä¸ªæ ¹ç›®å½•/ï¼Œæ‰€æœ‰æ–‡ä»¶éƒ½åœ¨å…¶ä¸‹\n/\næ ¹ç›®å½• å±‚çº§å…³ç³» å‘½ä»¤ é€šç”¨æ ¼å¼ï¼š\ncommand [-options] [parameter] command ï¼šå‘½ä»¤æœ¬èº« -optionsï¼š [å¯é€‰ï¼Œéå¿…å¡«] å‘½ä»¤çš„ä¸€äº›é€‰é¡¹ï¼Œå¯ä»¥é€šè¿‡é€‰é¡¹æ§åˆ¶å‘½ä»¤çš„è¡Œä¸ºç»†èŠ‚ parameterï¼š [å¯é€‰ï¼Œéå¿…å¡«]å‘½ä»¤çš„å‚æ•°ï¼Œå¤šæ•°ç”¨äºå‘½ä»¤çš„æŒ‡å‘ç›®æ ‡ç­‰ è¯­æ³•ä¸­[]è¡¨ç¤ºå¯é€‰\nls ls [-a -l -h] [Linuxè·¯å¾„] -a all å‰é¢å¸¦.çš„æ–‡ä»¶ä½¿éšè—æ–‡ä»¶/æ–‡ä»¶å¤¹ï¼Œåªæœ‰é€šè¿‡-aé€‰é¡¹æ‰èƒ½çœ‹åˆ° -l ä»¥åˆ—è¡¨ï¼ˆç«–å‘æ’åˆ—ï¼‰ -h è¡¨ç¤ºä»¥æ˜“äºé˜…è¯»çš„å½¢å¼ï¼Œåˆ—å‡ºæ–‡ä»¶å¤§å°ï¼Œå¦‚Kï¼ŒMï¼ŒG /home/ç”¨æˆ·å\nç»„åˆä½¿ç”¨\ncd change directory\ncd [Linuxè·¯å¾„] ä¸å†™å‚æ•°å›åˆ°ç”¨æˆ·çš„HOMEç›®å½•ä¸‹\nç»å¯¹è·¯å¾„ ç›¸å¯¹è·¯å¾„ . è¡¨ç¤ºå½“å‰ç›®å½•\n.. è¡¨ç¤ºä¸Šä¸€çº§ç›®å½•\n~ è¡¨ç¤ºHOMEç›®å½•\nmkdir åˆ›å»ºç›®å½•\nmkdir [-p] è·¯å¾„ -på¯é€‰ï¼Œåˆ›å»ºå¤šçº§ä¸å­˜åœ¨çš„ç›®å½•æ—¶ä½¿ç”¨\ntouch åˆ›å»ºæ–‡ä»¶\ntouch è·¯å¾„\ncat æŸ¥çœ‹å†…å®¹\ncat è·¯å¾„\nmore æŸ¥çœ‹å†…å®¹ï¼Œæ”¯æŒç¿»é¡µï¼Œç©ºæ ¼ç¿»é¡µï¼Œqé€€å‡º\nmore è·¯å¾„\ncp å¯ä»¥ç”¨äºå¤åˆ¶æ–‡ä»¶\\æ–‡ä»¶å¤¹\ncp [-r] å‚æ•°1 å‚æ•°2 -ré€‰é¡¹ï¼Œå¯é€‰ï¼Œç”¨äºå¤åˆ¶æ–‡ä»¶å¤¹ä½¿ç”¨ï¼Œè¡¨ç¤ºé€’å½’ å‚æ•°1ï¼ŒLinuxè·¯å¾„ï¼Œè¡¨ç¤ºè¢«å¤åˆ¶çš„æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹ å‚æ•°2ï¼ŒLinuxè·¯å¾„ï¼Œè¡¨ç¤ºè¦å¤åˆ¶å»çš„åœ°æ–¹ mv mv å‚æ•°1 å‚æ•°2 å¯ä»¥ç”¨äºæ”¹å\nrm åˆ é™¤æ–‡ä»¶ï¼Œæ–‡ä»¶å¤¹\nrm [-r -f] å‚æ•°1 å‚æ•°2 å‚æ•°n -rï¼Œ åˆ é™¤æ–‡ä»¶å¤¹ -fï¼Œforceï¼Œå¼ºåˆ¶åˆ é™¤ï¼ˆä¸ä¼šå¼¹å‡ºæç¤ºä¿¡æ¯ï¼‰ æ™®é€šç”¨æˆ·åˆ é™¤å†…å®¹ä¸ä¼šå¼¹å‡ºæç¤ºï¼Œåªæœ‰rootç®¡ç†å‘˜ç”¨æˆ·åˆ é™¤å†…å®¹ä¼šæœ‰æç¤º æ‰€ä»¥ä¸€èˆ¬æ™®é€šç”¨æˆ·ç”¨ä¸åˆ°-f å‚æ•°1ï¼Œå‚æ•°2ï¼Œ \u0026hellip;ï¼Œå‚æ•°n è¡¨ç¤ºè¦åˆ é™¤çš„æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹è·¯å¾„ï¼ŒæŒ‰ç…§ç©ºæ ¼éš”å¼€ã€‚ æ”¯æŒç”¨é€šé…ç¬¦æ¥æ¨¡ç³ŠåŒ¹é…\nå›æ”¶ç«™å¼åˆ é™¤Trash-Cli rmå¤ªå±é™©äº†ï¼Œ ä¸ºäº†é¿å…å‡ºé”™ï¼Œ åœ¨~/.bashrcä¸­æ·»åŠ \nalias rm=\u0026#39;echo \u0026#34;This is not the command you are looking for.\u0026#34;; false\u0026#39; ç„¶å source ~/.bashrc\nä½¿ç”¨ Trash-Cli trash-putï¼š åˆ é™¤æ–‡ä»¶å’Œç›®å½•ï¼ˆä»…æ”¾å…¥å›æ”¶ç«™ä¸­ï¼‰ trash-list ï¼šåˆ—å‡ºè¢«åˆ é™¤äº†çš„æ–‡ä»¶å’Œç›®å½• trash-restoreï¼šä»å›æ”¶ç«™ä¸­æ¢å¤æ–‡ä»¶æˆ–ç›®å½• trash. trash-rmï¼šåˆ é™¤å›æ”¶ç«™ä¸­çš„æ–‡ä»¶ trash-emptyï¼šæ¸…ç©ºå›æ”¶ç«™ pwd Print Work Directory\ntree æ ‘çŠ¶ç›®å½•\nwhich Linuxå‘½ä»¤æœ¬ä½“å°±æ˜¯ä¸€ä¸ªä¸ªçš„äºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶\nwhich å‘½ä»¤ find find èµ·å§‹è·¯å¾„ -name \u0026#34;è¢«æŸ¥æ‰¾æ–‡ä»¶å\u0026#34; find èµ·å§‹è·¯å¾„ -size + | -n[kMG] +, - è¡¨ç¤ºå¤§äºå’Œå°äº nè¡¨ç¤ºå¤§å°æ•°å­— kMGè¡¨ç¤ºå¤§å°å•ä½ï¼Œkè¡¨ç¤ºkb,Mè¡¨ç¤ºMBï¼ŒGè¡¨ç¤ºGB grep é€šè¿‡grepå‘½ä»¤ï¼Œä»æ–‡ä»¶ä¸­é€šè¿‡å…³é”®å­—è¿‡æ»¤æ–‡ä»¶è¡Œ\ngrep [-n] å…³é”®å­— æ–‡ä»¶è·¯å¾„ é€‰é¡¹ -n å¯é€‰ï¼Œè¡¨ç¤ºåœ¨ç»“æœä¸­æ˜¾ç¤ºåŒ¹é…çš„è¡Œçš„è¡Œå·\nå‚æ•°ï¼Œå…³é”®å­—ï¼Œå¿…å¡«ï¼Œè¡¨ç¤ºè¿‡æ»¤çš„å…³é”®å­—ï¼Œå¸¦æœ‰ç©ºæ ¼æˆ–å…¶å®ƒç‰¹æ®Šç¬¦å·ï¼Œå»ºè®®ä½¿ç”¨â€œ â€å°†å…³é”®å­—åŒ…å›´èµ·æ¥\nå‚æ•°ï¼Œæ–‡ä»¶è·¯å¾„ï¼Œå¿…å¡«ï¼Œè¡¨ç¤ºè¦è¿‡æ»¤å†…å®¹çš„æ–‡ä»¶è·¯å¾„ï¼Œå¯ä½œä¸ºå†…å®¹è¾“å…¥ç«¯å£\nwc wc [-c -m -l -w] æ–‡ä»¶è·¯å¾„ é€‰é¡¹ï¼Œ -cï¼Œ ç»Ÿè®¡bytesæ•°é‡ é€‰é¡¹ï¼Œ-mï¼Œç»Ÿè®¡å­—ç¬¦æ•°é‡ é€‰é¡¹ï¼Œ-lï¼Œç»Ÿè®¡è¡Œæ•° é€‰é¡¹ï¼Œ-wï¼Œç»Ÿè®¡å•è¯æ•°é‡ å‚æ•°ï¼Œæ–‡ä»¶è·¯å¾„ï¼Œ è¢«ç»Ÿè®¡çš„æ–‡ä»¶ï¼Œå¯ä½œä¸ºå†…å®¹è¾“å…¥ç«¯å£ é»˜è®¤è¡Œæ•°ã€å­—æ•°ã€å­—ç¬¦æ•°\nç®¡é“ç¬¦ å·¦ | å³ã€‚ å°†å·¦è¾¹çš„ç»“æœä½œä¸ºå³è¾¹çš„è¾“å…¥\necho å‘½ä»¤è¡Œå†…è¾“å‡ºæŒ‡å®šå†…å®¹\nåå¼•å·` åœ¨echoä¸­ï¼Œç”¨``æ‹¬èµ·æ¥è¡¨ç¤ºå‘½ä»¤ä¿¡æ¯\necho `pwd` é‡å®šå‘ç¬¦å· \u0026gt; å°†å·¦ä¾§å‘½ä»¤çš„ç»“æœï¼Œè¦†ç›–å†™å…¥åˆ°ç¬¦å·å³ä¾§æŒ‡å®šçš„æ–‡ä»¶ä¸­ \u0026gt;\u0026gt; å°†å·¦ä¾§å‘½ä»¤çš„ç»“æœï¼Œè¿½åŠ å†™å…¥åˆ°ç¬¦å·å³ä¾§æŒ‡å®šçš„æ–‡ä»¶ä¸­ tail tail [-f -num] å‚æ•° å‚æ•°ï¼Œlinuxå‘½ä»¤ï¼Œè¡¨ç¤ºè¢«è·Ÿè¸ªçš„æ–‡ä»¶è·¯å¾„ é€‰é¡¹ï¼Œ-fï¼Œè¡¨ç¤ºæŒç»­è·Ÿè¸ª é€‰é¡¹ï¼Œ-numï¼Œè¡¨ç¤ºå°¾éƒ¨å¤šå°‘è¡Œï¼Œä¸å¡«é»˜è®¤10è¡Œ awk ç¼–å†™è§„åˆ™ï¼Œæ ¹æ®è¾“å…¥çš„æ–‡æœ¬æ•°æ®æ¥æ‰§è¡Œç‰¹å®šçš„æ“ä½œ\næ‰“å°æ•´è¡Œï¼š\nawk \u0026#39;{print}\u0026#39; file.txt è¿™ä¸ªå‘½ä»¤å°†æ‰“å°æ–‡ä»¶file.txtä¸­çš„æ¯ä¸€è¡Œã€‚\næ ¹æ®å­—æ®µè¿›è¡ŒåŒ¹é…å’Œæ“ä½œï¼š\nawk \u0026#39;$1 == \u0026#34;pattern\u0026#34; {print $2}\u0026#39; file.txt è¿™ä¸ªå‘½ä»¤å°†æ‰“å°æ–‡ä»¶file.txtä¸­ç¬¬ä¸€ä¸ªå­—æ®µä¸º\u0026quot;pattern\u0026quot;çš„è¡Œçš„ç¬¬äºŒä¸ªå­—æ®µã€‚\nä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼è¿›è¡ŒåŒ¹é…ï¼š\nawk \u0026#39;/pattern/ {print}\u0026#39; file.txt è¿™ä¸ªå‘½ä»¤å°†æ‰“å°æ–‡ä»¶file.txtä¸­åŒ…å«\u0026quot;pattern\u0026quot;çš„æ¯ä¸€è¡Œã€‚\nè®¡ç®—å­—æ®µçš„æ€»å’Œæˆ–å¹³å‡å€¼ï¼š\nawk \u0026#39;{sum+=$1} END {print \u0026#34;Sum:\u0026#34;, sum}\u0026#39; file.txt è¿™ä¸ªå‘½ä»¤å°†è®¡ç®—æ–‡ä»¶file.txtä¸­ç¬¬ä¸€ä¸ªå­—æ®µçš„æ€»å’Œï¼Œå¹¶åœ¨æ–‡ä»¶å¤„ç†ç»“æŸæ—¶æ‰“å°å‡ºæ¥ã€‚\nè‡ªå®šä¹‰å­—æ®µåˆ†éš”ç¬¦ï¼š\nawk -F\u0026#39;,\u0026#39; \u0026#39;{print $1}\u0026#39; file.csv è¿™ä¸ªå‘½ä»¤å°†ä½¿ç”¨é€—å·ä½œä¸ºå­—æ®µåˆ†éš”ç¬¦ï¼Œå¹¶æ‰“å°æ–‡ä»¶file.csvä¸­çš„æ¯ä¸€è¡Œçš„ç¬¬ä¸€ä¸ªå­—æ®µã€‚\nä½¿ç”¨å†…ç½®å‡½æ•°ï¼š\nawk \u0026#39;{print toupper($1)}\u0026#39; file.txt è¿™ä¸ªå‘½ä»¤å°†å°†æ–‡ä»¶file.txtä¸­çš„ç¬¬ä¸€ä¸ªå­—æ®µè½¬æ¢ä¸ºå¤§å†™å¹¶æ‰“å°å‡ºæ¥ã€‚\nè¿‡æ»¤å¹¶å¤„ç†æ–‡ä»¶å†…å®¹ï¼š\nawk \u0026#39;$3 \u0026gt; 10 {print $1, $2 * $3}\u0026#39; file.txt è¿™ä¸ªå‘½ä»¤å°†æ‰“å°æ–‡ä»¶file.txtä¸­ç¬¬ä¸‰ä¸ªå­—æ®µå¤§äº10çš„è¡Œçš„ç¬¬ä¸€ä¸ªå’Œç¬¬äºŒä¸ªå­—æ®µçš„ä¹˜ç§¯ã€‚\nè‡ªå®šä¹‰è¾“å‡ºæ ¼å¼ï¼š\nawk \u0026#39;{printf \u0026#34;%-10s %-5s\\n\u0026#34;, $1, $2}\u0026#39; file.txt è¿™ä¸ªå‘½ä»¤å°†æŒ‰ç…§æŒ‡å®šçš„æ ¼å¼æ‰“å°æ–‡ä»¶file.txtä¸­çš„æ¯ä¸€è¡Œçš„å‰ä¸¤ä¸ªå­—æ®µã€‚\nVim å‘½ä»¤æ¨¡å¼ i : åœ¨å½“å‰å…‰æ ‡ä½ç½®è¿›å…¥è¾“å…¥æ¨¡å¼\na : åœ¨å½“å‰å…‰æ ‡ä½ç½® ä¹‹å è¿›å…¥è¾“å…¥æ¨¡å¼\nI ï¼š åœ¨å½“å‰è¡Œçš„å¼€å¤´ï¼Œè¿›å…¥è¾“å…¥æ¨¡å¼\nA ï¼š åœ¨å½“å‰è¡Œçš„ç»“å°¾ï¼Œè¿›å…¥è¾“å…¥æ¨¡å¼\no : åœ¨å½“å‰è¡Œçš„ä¸‹ä¸€è¡Œè¿›å…¥è¾“å…¥æ¨¡å¼\nO ï¼š åœ¨å½“å‰è¡Œçš„ä¸Šä¸€è¡Œè¿›å…¥è¾“å…¥æ¨¡å¼\n0 : ç§»åŠ¨å…‰æ ‡è‡³å¼€å¤´\n$ : ç§»åŠ¨ç»™å…‰æ ‡è‡³è¡Œç»“å°¾\npageup : å‘ä¸Šç¿»é¡µ\npagedown : å‘ä¸‹ç¿»é¡µ\n/ ï¼š è¿›å…¥æœç´¢æ¨¡å¼\nn : å‘ä¸‹ç»§ç»­æœç´¢\nN : å‘ä¸Šç»§ç»­æœç´¢\ndd ï¼š åˆ é™¤å…‰æ ‡æ‰€åœ¨çš„è¡Œ\nndd : næ˜¯æ•°å­—ï¼Œè¡¨ç¤ºåˆ é™¤å½“å‰å…‰æ ‡å‘ä¸‹nè¡Œ\nyy : å¤åˆ¶å½“å‰è¡Œ\nnyy ï¼š å¤åˆ¶å½“å‰è¡Œå’Œä¸‹é¢çš„nè¡Œ\np : ç²˜è´´å¤åˆ¶çš„å†…å®¹\nu : æ’¤é”€ä¿®æ”¹\nctrl + r ï¼š åå‘æ’¤é”€ä¿®æ”¹\ngg ï¼š è·³åˆ°é¦–è¡Œ\nG ï¼š è·³åˆ°å°¾è¡Œ\ndG : ä»å½“å‰è¡Œå¼€å§‹ï¼Œå‘ä¸‹å…¨éƒ¨åˆ é™¤\ndgg ï¼š ä»å½“å‰è¡Œå¼€å§‹ï¼Œå‘ä¸Šå…¨éƒ¨åˆ é™¤\ndS : ä»å½“å‰å…‰æ ‡å¼€å§‹ï¼Œåˆ é™¤åˆ°æœ¬è¡Œçš„ç»“å°¾\nd0 ï¼š ä»å½“å‰å…‰æ ‡å¼€å§‹ï¼Œåˆ é™¤åˆ°æœ¬è¡Œçš„å¼€å¤´\nåº•çº¿å‘½ä»¤æ¨¡å¼ : wq ä¿å­˜å¹¶é€€å‡º q ä»…é€€å‡º\nq! å¼ºåˆ¶é€€å‡º\n:w ä»…ä¿å­˜\n:set nu æ˜¾ç¤ºè¡Œå·\n:set paste è®¾ç½®ç²˜è´´æ¨¡å¼\nCtrl + Rä½¿ç”¨ Ctrl + R : åå‘æœç´¢ï¼ˆreverse-i-search) è¿ç»­æŒ‰é”®ç»§ç»­æœç´¢\nCtrl + S : æ­£å‘æœç´¢ ï¼ˆi-search) è¿ç»­æŒ‰é”®ç»§ç»­æœç´¢\nEnterè¾“å…¥è¯¥å‘½ä»¤\nCtrl + G æˆ– Ctrl + Cé€€å‡ºåå‘æœç´¢æ¨¡å¼\nAlt + . æ’å…¥æœ€åä¸€ä¸ªå‚æ•°ï¼Œæ’å…¥å‰ä¸€ä¸ªå‘½ä»¤çš„æœ€åä¸€ä¸ªå‚æ•°\nCtrl + J é€‰æ‹©å½“å‰å‘½ä»¤\nCtrl + O ç›´æ¥æ‰§è¡Œå½“å‰å‘½ä»¤ï¼Œå¹¶é€‰æ‹©å½“å‰å‘½ä»¤çš„ä¸‹ä¸€æ¡å‘½ä»¤\nç¦ç”¨Ctrl + S ç¦ç”¨ XON/XOFF æµæ§åˆ¶\næ‰“å¼€ç»ˆç«¯é…ç½®æ–‡ä»¶\n~/.bashrc æˆ–\n~/.bash_profile ç„¶åæ·»åŠ ä»¥ä¸‹è¡Œï¼š\nstty -ixon ä¿å­˜æ–‡ä»¶å¹¶é‡æ–°åŠ è½½é…ç½®ï¼š\nsource ~/.bashrc å‘½ä»¤è¡Œç»ˆç«¯å·¦å³ç§»åŠ¨\nCtrl + A ç§»åŠ¨å…‰æ ‡åˆ°è¡Œé¦–\nCtrl + E ç§»åŠ¨å…‰æ ‡åˆ°è¡Œå°¾\nCtrl + B å‘å·¦ç§»åŠ¨å…‰æ ‡\nCtrl + F å‘å³ç§»åŠ¨å…‰æ ‡\nAlt + B å‘å·¦ç§»åŠ¨ä¸€ä¸ªå•è¯\nAlt + F å‘å³ç§»åŠ¨ä¸€ä¸ªå•è¯\nWSL ä¸ windowså‰ªåˆ‡æ¿é€šä¿¡ visualæ¨¡å¼é€‰ä¸­æ–‡æœ¬ï¼Œä¹‹å :'\u0026lt;,'\u0026gt;w !clip.exe å¤åˆ¶é€‰æ‹©çš„æ–‡æœ¬\n:w !clip.exe å¤åˆ¶æ•´ä¸ªæ–‡æœ¬\nLinuxæƒé™å’Œç”¨æˆ· su su [-] [ç”¨æˆ·å] sudo æ™®é€šç”¨æˆ·ä½¿ç”¨sudoä½¿ç”¨rootæƒé™\nç”¨æˆ·ä¸ç”¨æˆ·ç»„\nç”¨æˆ·å’Œç”¨æˆ·ç»„ groupadd åˆ›å»ºç”¨æˆ·ç»„ groupdel ç”¨æˆ·ç»„å useradd [-g -d] ç”¨æˆ·å é€‰é¡¹ï¼š -gæŒ‡å®šç”¨æˆ·çš„ç»„ï¼Œä¸æŒ‡å®š-gï¼Œä¼šåˆ›å»ºåŒåç»„åŠ å…¥ï¼ŒæŒ‡å®š-géœ€è¦ç»„å·²ç»å­˜åœ¨ï¼Œå¦‚å·²å­˜åœ¨åŒåç»„ï¼Œå¿…é¡»ä½¿ç”¨-gã€‚ é€‰é¡¹ï¼š -dæŒ‡å®šç”¨æˆ·HOMEè·¯å¾„ï¼Œä¸æŒ‡å®šï¼ŒHOMEç›®å½•é»˜è®¤åœ¨ï¼š /home/ç”¨æˆ·å userdel [-r] ç”¨æˆ·å é€‰é¡¹ï¼š-rï¼Œåˆ é™¤ç”¨æˆ·çš„HOMEç›®å½•ï¼Œä¸ä½¿ç”¨-rï¼Œåˆ é™¤ç›®å½•æ—¶ï¼ŒHOMEç›®å½•ä¿ç•™ id [ç”¨æˆ·å] å‚æ•°ï¼šç”¨æˆ·åï¼Œè¢«æŸ¥çœ‹çš„ç”¨æˆ·ï¼Œå¦‚æœä¸æä¾›åˆ™æŸ¥çœ‹è‡ªèº«ã€‚ usermod -aG ç”¨æˆ·ç»„ ç”¨æˆ·å å°†æŒ‡å®šç”¨æˆ·åŠ å…¥æŒ‡å®šç”¨æˆ·ç»„ getent passwd\rgetent group ä½¿ç”¨getentå‘½ä»¤ï¼Œå¯ä»¥æŸ¥çœ‹å½“å‰ç³»ç»Ÿå†…æœ‰é‚£äº›å‘½ä»¤\nä¸ƒä»½ä¿¡æ¯ï¼š\nç”¨æˆ·å ï¼š å¯†ç ï¼ˆXï¼‰ ï¼š ç”¨æˆ·ID ï¼š ç»„ID ï¼š æè¿°ä¿¡æ¯ï¼ˆæ— ç”¨ï¼‰ ï¼š HOMEç›®å½• ï¼š æ‰§è¡Œç»ˆç«¯ï¼ˆé»˜è®¤bashï¼‰\næŸ¥çœ‹æƒé™ç®¡æ§ä¿¡æ¯ æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹çš„æ§åˆ¶ä¿¡æ¯\næ–‡ä»¶æˆ–æ–‡ä»¶å¤¹æ‰€å±ç”¨æˆ·\næ–‡ä»¶æˆ–æ–‡ä»¶å¤¹æ‰€å±ç”¨æˆ·ç»„\nç¬¬ä¸€ä¸ªdè¡¨ç¤ºæ–‡ä»¶å¤¹ æ‰€å±ç”¨æˆ· æ‰€æœ‰ç”¨æˆ·ç»„ æ‰€å±å…¶ä»–ç”¨æˆ· rä»£è¡¨è¯» æ–‡ä»¶å¤¹è¡¨ç¤ºå¯ä»¥æŸ¥çœ‹æ–‡ä»¶å¤¹å†…å®¹ wä»£è¡¨å†™ æ–‡ä»¶å¤¹è¡¨ç¤ºå¯ä»¥åœ¨æ–‡ä»¶å¤¹å†…ï¼šåˆ›å»ºï¼Œåˆ é™¤ï¼Œæ”¹åç­‰æ“ä½œ xä»£è¡¨å¯æ‰§è¡Œæƒé™ï¼Œé’ˆå¯¹æ–‡ä»¶è¡¨ç¤ºå¯ä»¥å°†æ–‡ä»¶ä½œä¸ºç¨‹åºæ‰§è¡Œ é’ˆå¯¹æ–‡ä»¶å¤¹ï¼Œè¡¨ç¤ºå¯ä»¥æ›´æ”¹å·¥ä½œç›®å½•åˆ°æ­¤æ–‡ä»¶å¤¹ï¼Œå³cdè¿›å…¥ chmod ä¿®æ”¹æ–‡ä»¶æˆ–ç›®å½•çš„æƒé™ã€‚\nchmod u = rwx, g = rx, o = x hello.txt -Ré€‰é¡¹å¯ä»¥å°†æ–‡ä»¶å¤¹ä»¥åŠæ–‡ä»¶å¤¹å†…å…¨éƒ¨å†…å®¹æƒé™è®¾ç½®ä¸ºï¼šrwxrwxrwx\nchmod -R u=rwx, g=rwx, o=rwx hello.tx ä½¿ç”¨æ•°å­—åºå·\nchmod 751 hello.txt chown æ›´æ”¹æ–‡ä»¶æˆ–ç›®å½•çš„æ‰€æœ‰è€…ä¸ºæŒ‡å®šçš„ç”¨æˆ·æˆ–ç”¨æˆ·ç»„ã€‚\nchown [-R] [ç”¨æˆ·] [:] [ç”¨æˆ·ç»„] æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹ é€‰é¡¹ï¼Œ-Rï¼ŒåŒchmodï¼Œå¯¹æ–‡ä»¶å¤¹å†…å…¨éƒ¨å†…å®¹åº”ç”¨ç›¸åŒè§„åˆ™ é€‰é¡¹ï¼Œç”¨æˆ·ï¼Œä¿®æ”¹æ‰€å±ç”¨æˆ· é€‰é¡¹ï¼Œç”¨æˆ·ç»„ï¼Œä¿®æ”¹æ‰€å±ç”¨æˆ·ç»„ ï¼š ç”¨äºåˆ†éš”ç”¨æˆ·å’Œç”¨æˆ·ç»„ æ™®é€šç”¨æˆ·æ— æ³•ä½¿ç”¨ï¼Œåªèƒ½ç”¨rootç”¨æˆ·\nLinuxä½¿ç”¨æ“ä½œ å¿«æ·é”®ï¼š ctrl + c å¼ºåˆ¶åœæ­¢,é€€å‡ºå½“å‰å‘½ä»¤è¾“å…¥ ctrl + d é€€å‡ºè´¦æˆ·çš„ç™»å½• history æŸ¥çœ‹å†å²è¾“å…¥çš„å‘½ä»¤ !æœç´¢å†å²å‘½ä»¤ï¼Œè‡ªåŠ¨åŒ¹é…ï¼Œä¾‹å¦‚ï¼py ctrl + aï¼Œè·³åˆ°å‘½ä»¤å¼€å¤´ ctrl + b, backward ctrl + f, forward esc + f, forward a word esc + b, backward a word ctrl + eï¼Œè·³åˆ°å‘½ä»¤ç»“å°¾ ctrl + \u0026lt;-ï¼Œ å‘å·¦è·³ä¸€ä¸ªå•è¯ ctrl + -\u0026gt;ï¼Œ å‘å³è·³ä¸€ä¸ªå•è¯ ctrl + l æ¸…ç©ºç»ˆç«¯å†…å®¹ clear æ¸…ç©ºç»ˆç«¯å†…å®¹ è½¯ä»¶å®‰è£… yum ï¼š RPMè½¯ä»¶ç®¡ç†å™¨ï¼Œç”¨äºè‡ªåŠ¨åŒ–å®‰è£…é…ç½®Linuxè½¯ä»¶ï¼Œå¹¶å¯ä»¥è‡ªåŠ¨è§£å†³ä¾èµ–é—®é¢˜ã€‚\nyum [-y] [install | remove | search] è½¯ä»¶åç§° -y è‡ªåŠ¨ç¡®è®¤ï¼Œæ— éœ€æ‰‹åŠ¨ç¡®è®¤å®‰è£…æˆ–å¸è½½è¿‡ç¨‹ yumå‘½ä»¤éœ€è¦rootæƒé™ï¼Œå¯ä»¥suåˆ‡æ¢åˆ°rootï¼Œæˆ–ä½¿ç”¨sudoæƒé™ï¼Œyumå‘½ä»¤éœ€è¦è”ç½‘\nUbuntu apt [-y] [install | remove | search] wget systemctl systemctl start | stop | status | enable | disable æœåŠ¡å NetworkManager, ä¸»ç½‘ç»œæœåŠ¡ newwork, å‰¯ç½‘ç»œæœåŠ¡ firewalld , é˜²ç«å¢™æœåŠ¡ sshd, sshæœåŠ¡ï¼ˆFinalShellè¿œç¨‹ç™»å½•Linuxä½¿ç”¨çš„å°±æ˜¯æ­¤æœåŠ¡ï¼‰ é™¤äº†å†…ç½®çš„æœåŠ¡ä»¥å¤–ï¼Œéƒ¨åˆ†ç¬¬ä¸‰æ–¹è½¯ä»¶å®‰è£…åä¹Ÿå¯ä»¥ç”¨systemctlè¿›è¡Œæ§åˆ¶\nè½¯é“¾æ¥ åœ¨ç³»ç»Ÿä¸­åˆ›å»ºè½¯é“¾æ¥ï¼Œå¯ä»¥å°†æ–‡ä»¶ã€æ–‡ä»¶å¤¹é“¾æ¥åˆ°å…¶ä»–ä½ç½®ã€‚ç±»ä¼¼å¿«æ·æ–¹å¼\nln -s å‚æ•°1 å‚æ•°2 -s ï¼Œåˆ›å»ºè½¯é“¾æ¥ å‚æ•°1 ï¼š è¢«é“¾æ¥çš„æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹ å‚æ•°2 ï¼š è¦é“¾æ¥å»çš„ç›®çš„åœ° æ—¥æœŸï¼Œæ—¶åŒº date [-d] [+æ ¼å¼åŒ–å­—ç¬¦ä¸²] -dæŒ‰ç…§ç»™å®šçš„å­—ç¬¦ä¸²æ˜¾ç¤ºæ—¥æœŸï¼Œä¸€èˆ¬ç”¨äºæ—¥æœŸè®¡ç®—\næ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼š é€šè¿‡ç‰¹å®šçš„å­—ç¬¦ä¸²æ ‡è®°ï¼Œæ¥æ§åˆ¶æ˜¾ç¤ºçš„æ—¥æœŸæ ¼å¼\n%Y ï¼Œ å¹´ %y,ï¼Œ å¹´ä»½åä¸¤ä½æ•°å­—ï¼ˆ00ï¼Œ99ï¼‰ %M æœˆä»½ ï¼ˆ01ï¼Œ12ï¼‰ %d æ—¥(01,31) %H å°æ—¶ï¼ˆ00ï¼Œ23ï¼‰ %M åˆ†é’Ÿï¼ˆ00ï¼Œ59ï¼‰ %S ç§’ï¼ˆ00ï¼Œ59ï¼‰ %s è‡ª1970-01-01 00:00:00åˆ°ç°åœ¨çš„ç§’æ•° ä½¿ç”¨-dæ”¯æŒçš„æ—¶é—´æ ‡è®°ï¼š(åŒæ ·æ”¯æŒæ ¼å¼åŒ–å­—ç¬¦ä¸²)\nyear å¹´ month æœˆ day å¤© hour å°æ—¶ minute åˆ†é’Ÿ second ç§’ ntp å¯ä»¥è‡ªåŠ¨è”ç½‘åŒæ­¥æ—¶é—´ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ntp -u ntp.aliyun.com æ‰‹åŠ¨æ ¡å‡†æ—¶é—´\nIPåœ°å€ DHCP : åŠ¨æ€è·å–IPåœ°å€ï¼Œå³æ¯æ¬¡é‡å¯è®¾å¤‡åéƒ½ä¼šè·å–ä¸€æ¬¡ï¼Œå¯èƒ½å¯¼è‡´IPåœ°å€é¢‘ç¹å˜æ›´\næ¯ä¸€å°è”ç½‘çš„ç”µè„‘éƒ½ä¼šæœ‰ä¸€ä¸ªåœ°å€ï¼Œç”¨äºå’Œå…¶ä»–è®¡ç®—æœºè¿›è¡Œé€šä¿¡ï¼ŒIPåœ°å€ä¸»è¦æœ‰ä¸¤ä¸ªç‰ˆæœ¬ï¼ŒV4å’ŒV6ç‰ˆæœ¬\nIPv4çš„åœ°å€æ ¼å¼ä¸ºa.b.c.dï¼Œå…¶ä¸­abcdè¡¨ç¤º0~255çš„æ•°å­—ï¼Œå¦‚192.168.88.101\né€šè¿‡ipconfigæŸ¥çœ‹æœ¬æœºçš„IPåœ°å€ã€‚\n127.0.0.1è¡¨ç¤ºæœ¬æœº\n0.0.0.0\nå¯ä»¥ç”¨äºæŒ‡ä»£æœ¬æœº å¯ä»¥åœ¨ç«¯å£ç»‘å®šä¸­ç”¨æ¥ç¡®å®šç»‘å®šå…³ç³» åœ¨ä¸€äº›IPåœ°å€ä¸­ï¼Œè¡¨ç¤ºæ‰€æœ‰IPçš„æ„æ€ï¼Œå¦‚æ”¾è¡Œè§„åˆ™è®¾ç½®ä¸º0.0.0.0ï¼Œè¡¨ç¤ºå…è®¸ä»»æ„IPè®¿é—® ä¸»æœºå hostname ä¿®æ”¹ä¸»æœºå\nhostnamectl set-hostname name åŸŸåè§£æ ping å¯ä»¥é€šè¿‡pingå‘½ä»¤æ¥æ£€æŸ¥æŒ‡å®šçš„ç½‘ç»œæœåŠ¡å™¨æ˜¯å¦æ˜¯å¯è”é€šçš„ã€‚\nping [-c num] ipæˆ–ä¸»æœºå é€‰é¡¹ï¼Œ -cï¼Œæ£€æŸ¥çš„æ¬¡æ•°ï¼Œä¸é€‚ç”¨-cé€‰é¡¹ï¼Œå°†æ— é™æ¬¡æ•°æŒç»­æ£€æŸ¥ å‚æ•°ï¼šipæˆ–ä¸»æœºåï¼Œè¢«æ£€æŸ¥çš„æœåŠ¡å™¨çš„ipåœ°å€æˆ–ä¸»æœºååœ°å€ wget éäº¤äº’å¼çš„æ–‡ä»¶ä¸‹è½½å™¨ï¼Œå¯ä»¥åœ¨å‘½ä»¤è¡Œå†…ä¸‹è½½ç½‘ç»œæ–‡ä»¶\nwget [-b] url é€‰é¡¹ ï¼š -b ï¼Œåå°ä¸‹è½½ï¼Œä¼šå°†æ—¥å¿—å†™å…¥åˆ°å½“å‰å·¥ä½œç›®å½•çš„wget-logæ–‡ä»¶ å‚æ•°ï¼šurlï¼Œä¸‹è½½é“¾æ¥ curl å‘é€httpç½‘ç»œè¯·æ±‚ï¼Œå¯ç”¨äºä¸‹è½½æ–‡ä»¶ï¼Œè·å–ä¿¡æ¯ç­‰\ncurl [-O] url é€‰é¡¹ï¼š-Oï¼Œç”¨äºä¸‹è½½æ–‡ä»¶ï¼Œå½“urlæ˜¯ä¸‹è½½é“¾æ¥æ—¶ï¼Œå¯ä»¥ä½¿ç”¨æ­¤é€‰é¡¹ä¿å­˜æ–‡ä»¶ å‚æ•°ï¼šurlï¼Œè¦å‘èµ·è¯·æ±‚çš„ç½‘ç»œåœ°å€ ç«¯å£ ç«¯å£ï¼Œæ˜¯è®¾å¤‡ä¸å¤–ç•Œé€šè®¯äº¤æµçš„å‡ºå…¥å£ï¼Œç«¯å£å¯ä»¥åˆ†ä¸ºç‰©ç†ç«¯å£å’Œè™šæ‹Ÿç«¯å£\nç‰©ç†ç«¯å£ï¼šåˆå¯ç§°ä¹‹ä¸ºæ¥å£ï¼Œæ˜¯å¯è§çš„ç«¯å£ï¼Œå¦‚USBæ¥å£ï¼ŒRJ45ç½‘å£ï¼ŒHDMIç«¯å£ç­‰ è™šæ‹Ÿç«¯å£ï¼šæ˜¯æŒ‡è®¡ç®—æœºå†…éƒ¨çš„ç«¯å£ï¼Œæ˜¯ä¸å¯è§çš„ï¼Œæ˜¯ç”¨æ¥æ“ä½œç³»ç»Ÿå’Œå¤–éƒ¨è¿›è¡Œäº¤äº’ä½¿ç”¨çš„ Linuxæ”¯æŒ65535ä¸ªç«¯å£ï¼Œåˆ†ä¸º3ç±»è¿›è¡Œä½¿ç”¨ï¼š\nå…¬è®¤ç«¯å£ï¼š1~1023ï¼Œé€šå¸¸ç”¨äºä¸€äº›ç³»ç»Ÿå†…ç½®æˆ–çŸ¥åç¨‹åºçš„é¢„ç•™ä½¿ç”¨ï¼Œå¦‚SSHæœåŠ¡çš„22ç«¯å£ï¼ŒHTTPSæœåŠ¡çš„443ç«¯å£ï¼Œéç‰¹æ®Šéœ€è¦ï¼Œä¸è¦å ç”¨è¿™ä¸ªèŒƒå›´çš„ç«¯å£ æ³¨å†Œç«¯å£ï¼š1024~49151ï¼Œé€šå¸¸å¯ä»¥éšæ„ä½¿ç”¨ï¼Œç”¨äºæ¾æ•£çš„ç»‘å®šä¸€äº›ç¨‹åº/æœåŠ¡ åŠ¨æ€ç«¯å£ï¼š49152~65535ï¼Œé€šå¸¸ä¸ä¼šå›ºå®šç»‘å®šç¨‹åºï¼Œè€Œæ˜¯å½“ç¨‹åºå¯¹å¤–è¿›è¡Œç½‘ç»œé“¾æ¥æ—¶ï¼Œç”¨äºä¸´æ—¶ä½¿ç”¨ã€‚ è¿›ç¨‹ç®¡ç† ps [-e -f] -e æ˜¾ç¤ºå‡ºå…¨éƒ¨çš„è¿›ç¨‹ -f ä»¥å®Œå…¨æ ¼å¼åŒ–çš„å½¢å¼å±•ç¤ºä¿¡æ¯ï¼ˆå±•ç¤ºå…¨éƒ¨ä¿¡æ¯ï¼‰ ä¸€èˆ¬æ¥è¯´ï¼Œå›ºå®šç”¨æ³•å°±æ˜¯ ps -ef åˆ—å‡ºå…¨éƒ¨è¿›ç¨‹çš„å…¨éƒ¨ä¿¡æ¯ UID ï¼š è¿›ç¨‹æ‰€å±çš„ç”¨æˆ·ID\nPID ï¼š è¿›ç¨‹çš„è¿›ç¨‹å·ID\nPPID ï¼š è¿›ç¨‹çš„çˆ¶IDï¼ˆå¯åŠ¨æ­¤è¿›ç¨‹çš„å…¶ä»–è¿›ç¨‹ï¼‰\nC ï¼š æ­¤è¿›ç¨‹çš„CPUå ç”¨ç‡ï¼ˆç™¾åˆ†æ¯”ï¼‰\nSTIME ï¼š è¿›ç¨‹çš„å¯åŠ¨æ—¶é—´\nTTY ï¼š å¯åŠ¨æ­¤è¿›ç¨‹çš„ç»ˆç«¯åºå·ï¼Œå¦‚æœæ˜¾ç¤ºï¼Ÿï¼Œè¡¨ç¤ºéç»ˆç«¯å¯åŠ¨\nTIME ï¼š è¿›ç¨‹å¯ç”¨CPUçš„æ—¶é—´\nCMD ï¼š è¿›ç¨‹å¯¹åº”çš„åç§°æˆ–å¯åŠ¨è·¯å¾„å’Œå¯åŠ¨å‘½ä»¤\nå…³é—­è¿›ç¨‹ kill -9 è¿›ç¨‹ID -9, è¡¨ç¤ºå¼ºåˆ¶å…³é—­è¿›ç¨‹ï¼Œä¸é€‚ç”¨æ­¤é€‰é¡¹ä¼šå‘è¿›ç¨‹å‘é€ä¿¡å·è¦æ±‚å…¶å…³é—­ï¼Œä½†æ˜¯å¦å…³é—­çœ‹è¿›ç¨‹è‡ªèº«çš„å¤„ç†æœºåˆ¶ ä¸»æœºçŠ¶æ€ æŸ¥çœ‹CPUï¼Œå†…å­˜ä½¿ç”¨æƒ…å†µ\ntop ç¬¬ä¸€è¡Œ ï¼š\ntop ï¼š å‘½ä»¤åç§°\n14ï¼š08 ï¼š23 å½“å‰ç³»ç»Ÿæ—¶é—´ï¼Œup 6minï¼šå¯åŠ¨äº†å…­åˆ†é’Ÿ\n2 users : 2ä¸ªç”¨æˆ·ç™»å½•ï¼Œ load ï¼š15åˆ†é’Ÿè´Ÿè½½\nç¬¬äºŒè¡Œï¼š\nTasks : 175ä¸ªè¿›ç¨‹ 1 running : 1ä¸ªå­è¿›ç¨‹åœ¨è¿è¡Œ\n174 sleeping : 174ä¸ªè¿›ç¨‹ç¡çœ ï¼Œ0ä¸ªåœæ­¢è¿›ç¨‹ï¼Œ 0ä¸ªåƒµå°¸è¿›ç¨‹\nç¬¬ä¸‰è¡Œï¼š\n%Cpu(s) : CPUä½¿ç”¨ç‡ï¼Œusï¼šç”¨æˆ·CPUä½¿ç”¨ç‡ï¼Œsy ï¼šç³»ç»ŸCPUä½¿ç”¨ç‡ï¼Œniï¼šé«˜ä¼˜å…ˆçº§è¿›ç¨‹å ç”¨CPUæ—¶é—´ç™¾åˆ†æ¯”ï¼Œidï¼šç©ºé—²CPUç‡ï¼Œwaï¼šIOç­‰å¾…CPUå ç”¨ç‡ï¼Œhiï¼šCPUç¡¬ä»¶ä¸­æ–­ç‡ï¼Œsiï¼šCPUè½¯ä»¶ä¸­æ–­ç‡ï¼Œstï¼šå¼ºåˆ¶ç­‰å¾…å ç”¨CPUç‡\nç¬¬å››ã€äº”è¡Œ\nKib Mem : ç‰©ç†å†…å­˜ï¼Œtotal : æ€»é‡ï¼Œ free : ç©ºé—²ï¼Œ used ï¼š ä½¿ç”¨ï¼Œ buff/cache : buffå’Œcacheå ç”¨\nKibSwap : è™šæ‹Ÿå†…å­˜ï¼ˆäº¤æ¢ç©ºé—´ï¼‰ï¼Œtotal : æ€»é‡ï¼Œfree : ç©ºé—²ï¼Œusedï¼šä½¿ç”¨ï¼Œbuff/cache : buffå’Œcacheå ç”¨\nPID ï¼š è¿›ç¨‹ID USER ï¼š è¿›ç¨‹æ‰€å±ç”¨æˆ· PR ï¼š è¿›ç¨‹ä¼˜å…ˆçº§ï¼Œè¶Šå°è¶Šå¥½ NI ï¼š è´Ÿå€¼è¡¨ç¤ºé«˜ä¼˜å…ˆçº§ï¼Œæ­£è¡¨ç¤ºä½ä¼˜å…ˆçº§ VIRT ï¼š è¿›ç¨‹ä½¿ç”¨è™šæ‹Ÿå†…å­˜ï¼Œå•ä½KB RES ï¼š è¿›ç¨‹ä½¿ç”¨ç‰©ç†å†…å­˜ï¼Œå•ä½KB SHR ï¼š è¿›ç¨‹ä½¿ç”¨å…±äº«å†…å­˜ï¼Œ å•ä½KB S ï¼š è¿›ç¨‹çŠ¶æ€(Sä¼‘çœ ï¼ŒRè¿è¡Œï¼ŒZåƒµæ­»çŠ¶æ€ï¼ŒNè´Ÿæ•°ä¼˜å…ˆçº§ï¼ŒIç©ºé—²çŠ¶æ€) %CPU ï¼š è¿›ç¨‹å ç”¨CPUç‡ %MEMï¼š è¿›ç¨‹å ç”¨å†…å­˜ç‡ TIME+ ï¼š è¿›ç¨‹ä½¿ç”¨CPUæ—¶é—´æ€»è®¡ï¼Œå•ä½10æ¯«ç§’ COMMAND ï¼š è¿›ç¨‹çš„å‘½ä»¤æˆ–åç§°æˆ–ç¨‹åºæ–‡ä»¶è·¯å¾„ -p : åªæ˜¾ç¤ºæŸä¸ªè¿›ç¨‹ä¿¡æ¯ -d : è®¾ç½®åˆ·æ–°æ—¶é—´ï¼Œé»˜è®¤ä¸º5s -c : æ˜¾ç¤ºäº§ç”Ÿè¿›ç¨‹çš„å®Œæ•´å‘½ä»¤ï¼Œé»˜è®¤æ˜¯è¿›ç¨‹å -n : åˆ¶å®šåˆ·æ–°æ¬¡æ•°ï¼Œæ¯”å¦‚ top -n 3 æ˜¯æ–°è¾“å‡ºä¸‰æ¬¡åé€€å‡º -b : ä»¥éäº¤äº’éå…¨å±æ¨¡å¼è¿è¡Œï¼Œä»¥æ‰¹æ¬¡çš„æ–¹å¼æ‰§è¡Œtopï¼Œä¸€èˆ¬é…åˆ-nåˆ¶å®šè¾“å‡ºå‡ æ¬¡ç»Ÿè®¡ä¿¡æ¯ï¼Œå°†è¾“å‡ºé‡å®šå‘åˆ°åˆ¶å®šæ–‡ä»¶ï¼Œæ¯”å¦‚ top -b -n 3 \u0026gt; /tmp/top.tmp -i : ä¸æ˜¾ç¤ºä»»ä½•é—²ç½®ï¼ˆidleï¼‰æˆ–æ— ç”¨çš„è¿›ç¨‹ -u ï¼š æŸ¥æ‰¾ç‰¹å®šç”¨æˆ·å¯åŠ¨çš„è¿›ç¨‹ topä»¥äº¤äº’å¼è¿è¡Œï¼š\nh ï¼š æŒ‰ä¸‹hé”®ï¼Œä¼šæ˜¾ç¤ºå¸®åŠ©ç”»é¢ c ï¼š æŒ‰ä¸‹cé”®ï¼Œä¼šæ˜¾ç¤ºäº§ç”Ÿè¿›ç¨‹çš„å®Œæ•´å‘½ä»¤ï¼Œç­‰åŒäº-cå‚æ•° f ï¼š å¯ä»¥é€‰æ‹©éœ€è¦å±•ç¤ºçš„é¡¹ç›® M ï¼š æ ¹æ®é©»ç•™å†…å­˜å¤§å°ï¼ˆRESï¼‰æ’åº T ï¼š æ ¹æ®CPUä½¿ç”¨ç™¾åˆ†æ¯”å¤§å°è¿›è¡Œæ’åº T ï¼š æ ¹æ®æ—¶é—´/ç´¯è®¡æ—¶é—´è¿›è¡Œæ’åº E ï¼š åˆ‡æ¢é¡¶éƒ¨å†…å­˜æ˜¾ç¤ºå•ä½ e ï¼š åˆ‡æ¢è¿›ç¨‹å†…å­˜æ˜¾ç¤ºå•ä½ l ï¼š åˆ‡æ¢æ˜¾ç¤ºå¹³å‡è´Ÿè½½å’Œå¯åŠ¨æ—¶é—´ä¿¡æ¯ i ï¼š ä¸æ˜¾ç¤ºé—²ç½®æˆ–æ— ç”¨çš„è¿›ç¨‹ï¼Œç­‰åŒäº-iå‚æ•° t ï¼š åˆ‡æ¢æ˜¾ç¤ºCPUçŠ¶æ€ä¿¡æ¯ m ï¼š åˆ‡æ¢æ˜¾ç¤ºå†…å­˜ä¿¡æ¯ ç¡¬ç›˜ä½¿ç”¨æƒ…å†µï¼š\ndf -h -hï¼Œ ä»¥æ›´åŠ äººæ€§åŒ–çš„å•ä½æ˜¾ç¤º ç£ç›˜ä¿¡æ¯ç›‘æ§ï¼š\niostat [-x] [num1] [num2] ç½‘ç»œçŠ¶æ€ç›‘æ§ï¼š\nå¯ä»¥ä½¿ç”¨sarå‘½ä»¤æŸ¥çœ‹ç½‘ç»œçš„ç›¸å…³ç»Ÿè®¡ sar -n DEV num1 num2 -n æŸ¥çœ‹ç½‘ç»œï¼ŒDEVè¡¨ç¤ºæŸ¥çœ‹ç½‘ç»œæ¥å£ num1 : åˆ·æ–°é—´éš”ï¼ˆä¸å¡«å°±æŸ¥çœ‹ä¸€æ¬¡é˜¶æ•°ï¼‰num2 : æŸ¥çœ‹æ¬¡æ•°ï¼ˆä¸å¡«æ— é™æ¬¡æ•°ï¼‰ ç¯å¢ƒå˜é‡ ç¯å¢ƒå˜é‡æ˜¯ä¸€ç»„ä¿¡æ¯è®°å½•ï¼Œç±»å‹æ˜¯Key Valueç±»å‹ï¼ˆåç§°=å€¼ï¼‰ï¼Œç”¨äºæ“ä½œç³»ç»Ÿè¿è¡Œçš„æ—¶å€™è®°å½•å…³é”®ä¿¡æ¯\nenv æŸ¥çœ‹ç¯å¢ƒå˜é‡\nç¯å¢ƒå˜é‡ï¼š PATHï¼Œé€šè¿‡$å–å‡ºç¯å¢ƒå˜é‡çš„å€¼\nç¯å¢ƒå˜é‡PATHä¼šè®°å½•ä¸€ç»„ç›®å½•ï¼Œç›®å½•ä¹‹é—´ç”¨ï¼šéš”å¼€ã€‚è®°å½•çš„æ˜¯å‘½ä»¤çš„æœç´¢è·¯å¾„ã€‚å½“æ‰§è¡Œå‘½ä»¤ä¼šä»è®°å½•ä¸­è®°å½•çš„ç›®å½•ä¸­æŒ¨ä¸ªæœç´¢è¦æ‰§è¡Œçš„å‘½ä»¤å¹¶æ‰§è¡Œ\nå¯ä»¥é€šè¿‡è¿™ä¸ªé¡¹ç›®çš„å€¼ï¼ŒåŠ å…¥è‡ªå®šä¹‰çš„å‘½ä»¤æœç´¢è·¯å¾„\nå¦‚\nexport PATH=$PATH:ç›®å½• ä¿®æ”¹ç¯å¢ƒå˜é‡\nä¸´æ—¶ç”Ÿæ•ˆ ï¼š export åç§° = å€¼ æ°¸ä¹…ç”Ÿæ•ˆ é’ˆå¯¹ç”¨æˆ· ï¼š ~/.bashrcæ–‡ä»¶ä¸­é…ç½® é’ˆå¯¹å…¨éƒ¨ç”¨æˆ· æ–‡ä»¶ä¸Šä¼ å’Œä¸‹è½½ é€šè¿‡finalShellæˆ–è€…xshell ä¸Šä¼ æˆ–ä¸‹è½½ï¼Œæ‹–åŠ¨\nå‹ç¼©å’Œè§£å‹ .tar ç§°ä¹‹ä¸ºtarballï¼Œç®€å•çš„å°†æ–‡ä»¶ç»„è£…åˆ°ä¸€ä¸ª.tarçš„æ–‡ä»¶ä¸­ï¼Œå¹¶æ²¡æœ‰å¤ªå¤šæ–‡ä»¶ä½“ç§¯çš„å‡å°‘ï¼Œä»…ä»…æ˜¯ç®€å•çš„å°è£… .gzï¼Œä¹Ÿå¸¸è§ä¸º.tar.gzï¼Œgzipæ ¼å¼å‹ç¼©æ–‡ä»¶ï¼Œå³ä½¿ç”¨gzipå‹ç¼©ç®—æ³•å°†æ–‡ä»¶å‹ç¼©åˆ°ä¸€ä¸ªæ–‡ä»¶å†…ï¼Œå¯ä»¥æå¤§çš„å‡å°‘å‹ç¼©åçš„ä½“ç§¯ tar [-c -v -x -f -z -C] å‚æ•°1 å‚æ•°2 ... å‚æ•°N -c åˆ›å»ºå‹ç¼©æ–‡ä»¶ï¼Œç”¨äºå‹ç¼©æ¨¡å¼ -v æ˜¾ç¤ºå‹ç¼©ï¼Œè§£å‹è¿‡ç¨‹ï¼Œç”¨äºæŸ¥çœ‹è¿›åº¦ -x è§£å‹æ¨¡å¼ -f è¦åˆ›å»ºçš„æ–‡ä»¶ï¼Œæˆ–è€…è¦è§£å‹çš„æ–‡ä»¶ï¼Œ-fé€‰é¡¹å¿…é¡»åœ¨æ‰€æœ‰é€‰é¡¹ä¸­ä½ç½®å¤„äºæœ€åä¸€ä¸ª -z gzipæ¨¡å¼ï¼Œä¸é€‚ç”¨-zå°±æ˜¯æ™®é€šçš„tarballæ¨¡å¼ -C é€‰æ‹©è§£å‹çš„ç›®çš„åœ°ï¼Œç”¨äºè§£å‹æ¨¡å¼ 1. å‹ç¼©å¹¶æ‰“åŒ…æ–‡ä»¶æˆ–ç›®å½• ä½¿ç”¨ -czf å‚æ•°å°†æ–‡ä»¶æˆ–ç›®å½•æ‰“åŒ…å¹¶å‹ç¼©æˆ .tar.gz æ ¼å¼ï¼š\ntar -czf å‹ç¼©åŒ…å.tar.gz è¦å‹ç¼©çš„æ–‡ä»¶æˆ–ç›®å½• ä¾‹å¦‚ï¼Œå°†ç›®å½• my_folder å‹ç¼©æˆ archive.tar.gzï¼š\ntar -czf archive.tar.gz my_folder 2. è§£å‹ .tar.gz æ–‡ä»¶ ä½¿ç”¨ -xzf å‚æ•°è§£å‹ .tar.gz æ–‡ä»¶ï¼š\ntar -xzf å‹ç¼©åŒ…å.tar.gz ä¾‹å¦‚ï¼Œè§£å‹ archive.tar.gz åˆ°å½“å‰ç›®å½•ï¼š\ntar -xzf archive.tar.gz 3. åˆ—å‡º .tar.gz æ–‡ä»¶å†…å®¹ ä½¿ç”¨ -tzf å‚æ•°æŸ¥çœ‹ .tar.gz æ–‡ä»¶ä¸­çš„å†…å®¹ï¼Œè€Œä¸è§£å‹ï¼š\ntar -tzf å‹ç¼©åŒ…å.tar.gz 4. æ‰“åŒ…ä½†ä¸å‹ç¼© å¦‚æœä¸éœ€è¦å‹ç¼©ï¼Œåªæƒ³æ‰“åŒ…æˆ .tar æ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨ -cf å‚æ•°ï¼š\ntar -cf åŒ…å.tar è¦æ‰“åŒ…çš„æ–‡ä»¶æˆ–ç›®å½• ä¾‹å¦‚ï¼Œå°† my_folder æ‰“åŒ…æˆ archive.tarï¼š\ntar -cf archive.tar my_folder 5. è§£åŒ… .tar æ–‡ä»¶ ä½¿ç”¨ -xf å‚æ•°è§£åŒ… .tar æ–‡ä»¶ï¼š\ntar -xf åŒ…å.tar zip [-r] å‚æ•° -r å‹ç¼©æ–‡ä»¶å¤¹ä½¿ç”¨ unzip unzip [-d] å‚æ•°\n-d åˆ¶å®šè§£å‹çš„ç›®å½• 7z 1. å‹ç¼©æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹ ä½¿ç”¨ 7z å‘½ä»¤åˆ›å»º .7z æ ¼å¼çš„å‹ç¼©æ–‡ä»¶ï¼š\n7z a å‹ç¼©æ–‡ä»¶å.7z è¦å‹ç¼©çš„æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹ å°† my_folder å‹ç¼©æˆ archive.7zï¼š\n7z a archive.7z my_folder/ 2. è§£å‹ç¼© .7z æ–‡ä»¶ è¦è§£å‹ç¼© .7z æ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨ï¼š\n7z x å‹ç¼©æ–‡ä»¶å.7z ä¾‹å¦‚ï¼Œè§£å‹ç¼© archive.7z åˆ°å½“å‰ç›®å½•ï¼š\n7z x archive.7z 3. åˆ—å‡º .7z æ–‡ä»¶å†…å®¹ å¦‚æœä½ æƒ³æŸ¥çœ‹å‹ç¼©æ–‡ä»¶ä¸­çš„å†…å®¹ï¼Œè€Œä¸è§£å‹ç¼©å®ƒï¼Œå¯ä»¥ä½¿ç”¨ l å‚æ•°ï¼š\n7z l å‹ç¼©æ–‡ä»¶å.7z 4. è§£å‹ç¼©åˆ°æŒ‡å®šç›®å½• ä½ å¯ä»¥é€šè¿‡ -o é€‰é¡¹å°†æ–‡ä»¶è§£å‹ç¼©åˆ°æŒ‡å®šç›®å½•ï¼š\n7z x å‹ç¼©æ–‡ä»¶å.7z -oè¾“å‡ºç›®å½• ä¾‹å¦‚ï¼Œå°† archive.7z è§£å‹ç¼©åˆ° my_folder ç›®å½•ä¸‹ï¼š\n7z x archive.7z -o./my_folder 6. å…¶ä»–å¸¸ç”¨é€‰é¡¹ -t7zï¼šæŒ‡å®šå‹ç¼©ç±»å‹ä¸º .7zï¼ˆé»˜è®¤ï¼‰ã€‚ -mx=9ï¼šæœ€å¤§å‹ç¼©çº§åˆ«ï¼Œ9 è¡¨ç¤ºæœ€å¼ºå‹ç¼©ã€‚ ä¾‹å¦‚ï¼š\n7z a -t7z -mx=9 å‹ç¼©æ–‡ä»¶å.7z æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹ Mysql wget --no-check-certificate https: /dlcdn.apache.org/tomcat/tomcat10/v10.0.27/bin/apache-tomcat-10.0.27.tar.gz Redis ElasticSearch Tomcat Nginx RabbitMq ","permalink":"https://kennems.github.io/posts/tech/linux/","summary":"Linux å¿«æ·é”®ï¼š ctrl + l æ¸…ç©ºå±å¹• Linuxæ–‡ä»¶ç³»ç»Ÿ FHS3.0ï¼ˆFile system Hierarchy Standardï¼‰ / etc é…ç½®æ–‡ä»¶ bin å¿…è¦å‘½ä»¤ usr äºŒçº§ç›®å½• home å®¶ç›®å½• var åŠ¨æ€æ•°æ® VF","title":" Linux"},{"content":"LeetCode Hot 100 ç²¾ç»ƒğŸ¥¸(1) è®°å¿†ä¸­çš„ä¸œè¥¿ä¸€å®šä¼šæ¶ˆé€€ï¼ŒçœŸæ­£ç•™ä¸‹çš„æ‰æ˜¯å­¦åˆ°çš„ï¼Œä¸€å®šè¦åŠæ—¶å›é¡¾ã€‚\n11. ç››æœ€å¤šæ°´çš„å®¹å™¨ é¢˜ç›®å¤§æ„ï¼šç»™å®šä¸€ä¸ªé•¿åº¦ä¸ºnçš„æ•´æ•°æ•°ç»„heightï¼Œæ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ ä»£è¡¨ä¸€æ¡å‚ç›´çº¿çš„é«˜åº¦ã€‚æ‰¾å‡ºå…¶ä¸­çš„ä¸¤æ¡çº¿ï¼Œä½¿å¾—å®ƒä»¬ä¸xè½´æ„æˆçš„å®¹å™¨å¯ä»¥å®¹çº³æœ€å¤šçš„æ°´ã€‚\nå®ç°æ€è·¯ï¼šä½¿ç”¨åŒæŒ‡é’ˆæ³•ã€‚åˆå§‹åŒ–å·¦æŒ‡é’ˆlæŒ‡å‘æ•°ç»„çš„èµ·å§‹ä½ç½®ï¼Œå³æŒ‡é’ˆræŒ‡å‘æ•°ç»„çš„æœ«å°¾ä½ç½®ã€‚è®¾ç½®å˜é‡retç”¨äºè®°å½•å½“å‰æœ€å¤§å®¹é‡ï¼Œåˆå§‹åŒ–ä¸º0ã€‚åœ¨æ¯ä¸€è½®å¾ªç¯ä¸­ï¼Œè®¡ç®—å½“å‰å®¹å™¨çš„å®¹é‡ï¼Œå³min(height[l], height[r])ä¹˜ä»¥rå’Œlä¹‹é—´çš„è·ç¦»ï¼Œæ›´æ–°retã€‚ç„¶åæ ¹æ®æŒ‡é’ˆæ‰€æŒ‡å‘çš„é«˜åº¦çš„å¤§å°ï¼Œç§»åŠ¨æŒ‡é’ˆï¼Œå¦‚æœheight[l]\u0026lt;height[r]ï¼Œåˆ™ç§»åŠ¨å·¦æŒ‡é’ˆlå‘å³ä¸€æ­¥ï¼Œå¦åˆ™ç§»åŠ¨å³æŒ‡é’ˆrå‘å·¦ä¸€æ­¥ã€‚ç›´åˆ°å·¦å³æŒ‡é’ˆç›¸é‡ï¼Œå¾ªç¯ç»“æŸï¼Œè¿”å›retå³å¯ã€‚\næ­£ç¡®æ€§è¯æ˜ï¼š å¯¹äºå·¦å³ç«¯ç‚¹ $ l, r$ï¼Œ ä¸¤ç‚¹ä¹‹é—´çš„è·ç¦»ä¸º$len = r-l+1-1$(å› ä¸ºä¸¤ä¸ªç‚¹ä¹‹é—´ç®—ä¸€æ®µï¼Œæ‰€ä»¥é•¿åº¦è¦å‡ä¸€)ï¼Œ$ ret = (r-l)*min(height[l], height[r])$,å‡è®¾ $height[l]\u0026lt;height[r]$, å¯¹äºå·¦ç«¯ç‚¹ï¼Œå…¶ä½œä¸ºæŸ±å­èƒ½å®¹çº³çš„æœ€å¤šçš„æ°´çš„æ•°é‡å·²ç»ä¸ºæœ€å¤§å€¼ï¼Œä»»æ„çš„ $l\u0026lt;x\u0026lt;r$ ä½œä¸ºå³ç«¯ç‚¹ä¸€å®šæ¯”$r$åšç«¯ç‚¹æ›´å·®ï¼Œæ‰€ä»¥å¯ä»¥æ’é™¤å·¦ç«¯ç‚¹$l$ï¼Œè®¡ç®—ä¸‹ä¸€ç‚¹å³$l+1$ã€‚ä»å·¦å³ç«¯ç‚¹å¼€å§‹ï¼Œå¯¹äºæ¯æ¬¡æ’é™¤çš„ç‚¹ï¼Œå·²ç»æ‰¾åˆ°è¿™ä¸ªç«¯ç‚¹å¯èƒ½çš„æœ€å¤§å€¼ï¼Œ æ‰€ä»¥å¯ä»¥ä¿è¯ç»“æœçš„æ­£ç¡®æ€§ã€‚ class Solution: def maxArea(self, height: List[int]) -\u0026gt; int: l, r = 0, len(height) - 1 res = 0 while l \u0026lt; r: res = max(res, (r - l) * min(height[l], height[r])) if height[l] \u0026lt; height[r]: l += 1 elif height[l] \u0026gt; height[r]: r -= 1 else: l += 1 r -= 1 return res 15. ä¸‰æ•°ä¹‹å’Œ é¢˜ç›®å¤§æ„ï¼šç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ numsï¼Œåˆ¤æ–­æ˜¯å¦å­˜åœ¨ä¸‰å…ƒç»„ [nums[i], nums[j], nums[k]] æ»¡è¶³ i != jã€i != k ä¸” j != kï¼ŒåŒæ—¶è¿˜æ»¡è¶³ nums[i] + nums[j] + nums[k] == 0ã€‚è¿”å›æ‰€æœ‰æ»¡è¶³æ¡ä»¶çš„ä¸é‡å¤çš„ä¸‰å…ƒç»„ã€‚\næšä¸¾ å®ç°æ€è·¯ï¼šé¦–å…ˆå¯¹æ•°ç»„ nums è¿›è¡Œæ’åºã€‚ç„¶åéå†æ•°ç»„ï¼Œå¯¹äºæ¯ä¸ªå…ƒç´  nums[i]ï¼Œè®¾å®šä¸¤ä¸ªæŒ‡é’ˆ l å’Œ r åˆ†åˆ«æŒ‡å‘ i+1 å’Œæ•°ç»„æœ«å°¾ã€‚åœ¨ l å’Œ r ä¹‹é—´å¯»æ‰¾å’Œä¸º 0 çš„ä¸¤ä¸ªæ•°ã€‚å…·ä½“åœ°ï¼Œå¦‚æœå½“å‰å…ƒç´ ä¸å‰ä¸€ä¸ªå…ƒç´ ç›¸åŒï¼Œè·³è¿‡ï¼›å¦‚æœå½“å‰å…ƒç´ ä¸ l+1 å¤„çš„å…ƒç´ ç›¸åŒï¼Œè·³è¿‡ï¼›åœ¨ l å’Œ r ä¹‹é—´åˆ©ç”¨åŒæŒ‡é’ˆçš„æ–¹å¼æ‰¾åˆ°æ»¡è¶³æ¡ä»¶çš„ä¸¤ä¸ªæ•°ï¼Œå¦‚æœæ‰¾åˆ°äº†æ»¡è¶³æ¡ä»¶çš„ä¸‰å…ƒç»„ï¼Œåˆ™æ·»åŠ åˆ°ç»“æœä¸­ã€‚æœ€åè¿”å›ç»“æœåˆ—è¡¨ resã€‚\nclass Solution: def threeSum(self, nums: List[int]) -\u0026gt; List[List[int]]: n = len(nums) nums.sort() res = [] for i in range(n): l = i r = n-1 if i and nums[i]==nums[i-1]: continue for m in range(l+1, n): if m\u0026gt;l+1 and nums[m]==nums[m-1]: continue while r\u0026gt;m and nums[r]+nums[m]+nums[l]\u0026gt;0: r-=1 if m==r: break if nums[r]+nums[m]+nums[l]==0: res.append([nums[l], nums[m], nums[r]]) return res è®¡æ•°æ’åºåŒæŒ‡é’ˆ å®ç°æ€è·¯ï¼šé¦–å…ˆï¼Œåˆ©ç”¨ Counter å‡½æ•°ç»Ÿè®¡æ¯ä¸ªæ•°å‡ºç°çš„æ¬¡æ•°ï¼Œå¹¶æ£€æŸ¥æ˜¯å¦æœ‰ 0 å‡ºç°è‡³å°‘ä¸‰æ¬¡ï¼Œå¦‚æœæ˜¯åˆ™å°† [0, 0, 0] æ·»åŠ åˆ°ç»“æœä¸­ã€‚ç„¶åï¼Œå¯¹ä¸é‡å¤çš„æ•°è¿›è¡Œæ’åºã€‚éå†æ’åºåçš„æ•°ï¼Œå¯¹äºæ¯ä¸ªæ•° numï¼Œå¦‚æœ num ä¸ç­‰äº 0 ä¸” num å‡ºç°æ¬¡æ•°å¤§äº 1 ä¸” -num*2 ä¹Ÿåœ¨ Counter ä¸­ï¼Œåˆ™å°† [num, num, -num*2] æ·»åŠ åˆ°ç»“æœä¸­ã€‚ç„¶åï¼Œåœ¨è´Ÿæ•°éƒ¨åˆ†ï¼Œåˆ©ç”¨åŒæŒ‡é’ˆçš„æ–¹å¼å¯»æ‰¾æ»¡è¶³æ¡ä»¶çš„ä¸¤ä¸ªæ•°ã€‚æœ€åè¿”å›ç»“æœåˆ—è¡¨ resã€‚\nclass Solution: def threeSum(self, nums: List[int]) -\u0026gt; List[List[int]]: res = [] c = Counter(nums) if 0 in c and c[0] \u0026gt;= 3: res.append([0,0,0]) no_repeat_nums = sorted(c.keys()) for i,num in enumerate(no_repeat_nums): if num != 0 and c[num] \u0026gt; 1 and -num*2 in c: res.append([num,num,-num*2]) if num \u0026lt; 0: for num3 in no_repeat_nums[ bisect_left(no_repeat_nums,((-num+1)/2)) : bisect_right(no_repeat_nums,-num*2-1) ]: num2 = -num-num3 if num2 in c: res.append([num,num2,num3]) return res 19. åˆ é™¤é“¾è¡¨çš„å€’æ•°ç¬¬ N ä¸ªç»“ç‚¹ é¢˜ç›®å¤§æ„ï¼šç»™å®šä¸€ä¸ªé“¾è¡¨ï¼Œè¦æ±‚åˆ é™¤å€’æ•°ç¬¬nä¸ªèŠ‚ç‚¹ï¼Œå¹¶è¿”å›é“¾è¡¨çš„å¤´ç»“ç‚¹ã€‚\nå®ç°æ€è·¯ï¼šä½¿ç”¨åŒæŒ‡é’ˆï¼Œé¦–å…ˆè®©ç¬¬ä¸€ä¸ªæŒ‡é’ˆä»å¤´èŠ‚ç‚¹å¼€å§‹å‘åç§»åŠ¨næ­¥ï¼Œç„¶ååŒæ—¶ç§»åŠ¨ç¬¬ä¸€ä¸ªæŒ‡é’ˆå’Œç¬¬äºŒä¸ªæŒ‡é’ˆï¼Œç›´åˆ°ç¬¬ä¸€ä¸ªæŒ‡é’ˆåˆ°è¾¾é“¾è¡¨æœ«å°¾ã€‚è¿™æ ·ç¬¬äºŒä¸ªæŒ‡é’ˆæ‰€æŒ‡çš„ä½ç½®å°±æ˜¯å€’æ•°ç¬¬nä¸ªèŠ‚ç‚¹çš„å‰ä¸€ä¸ªèŠ‚ç‚¹ï¼Œç„¶åè¿›è¡Œåˆ é™¤æ“ä½œå³å¯ã€‚éœ€è¦æ³¨æ„çš„æ˜¯è¦è€ƒè™‘è¾¹ç•Œæƒ…å†µï¼Œæ¯”å¦‚é“¾è¡¨é•¿åº¦ä¸º1ï¼Œåˆ é™¤å¤´èŠ‚ç‚¹ç­‰æƒ…å†µã€‚\nclass Solution: def removeNthFromEnd(self, head: Optional[ListNode], n: int) -\u0026gt; Optional[ListNode]: if not head.next: return None p1 = head n -= 1 while n: p1 = p1.next n -= 1 pre = p2 = head while p1.next: p1 = p1.next pre = p2 p2 = p2.next if p2 == head: head = head.next else: pre.next = pre.next.next return head 31. ä¸‹ä¸€ä¸ªæ’åˆ— é¢˜ç›®å¤§æ„ï¼šç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ï¼Œè¦æ±‚æ‰¾å‡ºè¿™ä¸ªæ•°ç»„çš„ä¸‹ä¸€ä¸ªæ’åˆ—ï¼Œå³æ¯”å½“å‰æ’åˆ—å¤§çš„ä¸‹ä¸€ä¸ªæ’åˆ—ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™è¿”å›å­—å…¸åºæœ€å°çš„æ’åˆ—ã€‚\nå®ç°æ€è·¯ï¼šè¦æ‰¾åˆ°ä¸‹ä¸€ä¸ªæ’åˆ—ï¼Œå¯ä»¥éµå¾ªä»¥ä¸‹æ­¥éª¤ï¼š\nä»æ•°ç»„æœ«å°¾å¼€å§‹ï¼Œæ‰¾åˆ°ç¬¬ä¸€ä¸ªç›¸é‚»çš„ä¸¤ä¸ªæ•°ï¼Œæ»¡è¶³ nums[i] \u0026lt; nums[i+1]ã€‚ å¦‚æœæ‰¾åˆ°äº†è¿™æ ·çš„ä¸€å¯¹æ•°ï¼Œè¯´æ˜å½“å‰æ’åˆ—è¿˜ä¸æ˜¯æœ€å¤§çš„æ’åˆ—ï¼Œå¯ä»¥è¿›è¡Œä¸‹ä¸€æ­¥æ“ä½œã€‚ åœ¨ä»å³å¾€å·¦æ‰¾åˆ°çš„ç¬¬ä¸€ä¸ªä½ç½®è®°ä¸º iï¼Œå†ä»æ•°ç»„æœ«å°¾å¼€å§‹ï¼Œæ‰¾åˆ°ç¬¬ä¸€ä¸ªå¤§äº nums[i] çš„æ•°ï¼Œè®°ä¸º jã€‚ äº¤æ¢ nums[i] å’Œ nums[j]ã€‚ å°†ä» i+1 ä½ç½®å¼€å§‹åˆ°æ•°ç»„æœ«å°¾çš„æ•°é€†åºæ’åˆ—ï¼Œä»¥å¾—åˆ°å­—å…¸åºæœ€å°çš„æ’åˆ—ã€‚ å¦‚æœæ­¥éª¤1ä¸­æ²¡æœ‰æ‰¾åˆ°ç›¸é‚»çš„ä¸¤ä¸ªæ•°ï¼Œåˆ™è¯´æ˜å½“å‰æ’åˆ—å·²ç»æ˜¯æœ€å¤§çš„æ’åˆ—ï¼Œç›´æ¥å°†æ•´ä¸ªæ•°ç»„é€†åºæ’åˆ—å³å¯ã€‚ class Solution: def nextPermutation(self, nums: List[int]) -\u0026gt; None: n = len(nums) i = n - 2 while i \u0026gt;= 0 and nums[i] \u0026gt;= nums[i + 1]: i -= 1 if i \u0026gt;= 0: j = n - 1 while j \u0026gt;= i and nums[j] \u0026lt;= nums[i]: j -= 1 nums[i], nums[j] = nums[j], nums[i] nums[i + 1 :] = reversed(nums[i + 1 :]) 33. æœç´¢æ—‹è½¬æ’åºæ•°ç»„ é¢˜ç›®å¤§æ„ï¼š ç»™å®šä¸€ä¸ªæŒ‰å‡åºæ’åˆ—çš„æ•´æ•°æ•°ç»„ numsï¼Œæ•°ç»„ä¸­çš„å€¼äº’ä¸ç›¸åŒã€‚è¯¥æ•°ç»„ç»è¿‡æœªçŸ¥çš„æŸä¸ªä¸‹æ ‡æ—‹è½¬ï¼Œå³åŸæœ¬æ’åœ¨æ•°ç»„å¼€å¤´çš„ä¸€éƒ¨åˆ†å…ƒç´ è¢«ç§»åŠ¨åˆ°æ•°ç»„æœ«å°¾ã€‚ç»™å®šä¸€ä¸ªç›®æ ‡å€¼ targetï¼Œå¦‚æœè¯¥ç›®æ ‡å€¼å­˜åœ¨äºæ—‹è½¬åçš„æ•°ç»„ä¸­ï¼Œåˆ™è¿”å›å…¶ä¸‹æ ‡ï¼Œå¦åˆ™è¿”å› -1ã€‚è¦æ±‚è®¾è®¡ä¸€ä¸ªæ—¶é—´å¤æ‚åº¦ä¸º O(log n) çš„ç®—æ³•è§£å†³æ­¤é—®é¢˜ã€‚\nå®ç°æ€è·¯ï¼š\nä½¿ç”¨äºŒåˆ†æŸ¥æ‰¾ç®—æ³•æ¥è§£å†³æ­¤é—®é¢˜ï¼Œä»¥æ»¡è¶³ O(log n) çš„æ—¶é—´å¤æ‚åº¦è¦æ±‚ã€‚ åˆå§‹åŒ–å·¦å³æŒ‡é’ˆ l å’Œ r åˆ†åˆ«æŒ‡å‘æ•°ç»„çš„é¦–å°¾å…ƒç´ ã€‚ åœ¨å¾ªç¯ä¸­ï¼Œè®¡ç®—ä¸­é—´ä½ç½® midï¼Œåˆ¤æ–­ nums[mid] æ˜¯å¦ç­‰äºç›®æ ‡å€¼ targetï¼Œè‹¥æ˜¯åˆ™ç›´æ¥è¿”å› midã€‚ è‹¥ nums[0] \u0026lt;= nums[mid]ï¼Œè¯´æ˜å·¦åŠæ®µæ˜¯æœ‰åºçš„ï¼Œæ­¤æ—¶åˆ¤æ–­ç›®æ ‡å€¼æ˜¯å¦åœ¨å·¦åŠæ®µèŒƒå›´å†…ï¼Œè‹¥æ˜¯åˆ™å°†å³æŒ‡é’ˆç§»åˆ° mid-1ï¼Œå¦åˆ™å°†å·¦æŒ‡é’ˆç§»åˆ° mid+1ã€‚ è‹¥ nums[0] \u0026gt; nums[mid]ï¼Œè¯´æ˜å³åŠæ®µæ˜¯æœ‰åºçš„ï¼Œæ­¤æ—¶åˆ¤æ–­ç›®æ ‡å€¼æ˜¯å¦åœ¨å³åŠæ®µèŒƒå›´å†…ï¼Œè‹¥æ˜¯åˆ™å°†å·¦æŒ‡é’ˆç§»åˆ° mid+1ï¼Œå¦åˆ™å°†å³æŒ‡é’ˆç§»åˆ° mid-1ã€‚ è‹¥å¾ªç¯ç»“æŸä»æœªæ‰¾åˆ°ç›®æ ‡å€¼ï¼Œåˆ™è¿”å› -1ã€‚ class Solution: def search(self, nums: List[int], target: int) -\u0026gt; int: if not nums: return -1 n = len(nums) l, r = 0, n - 1 while l \u0026lt;= r: mid = l + r \u0026gt;\u0026gt; 1 if nums[mid] == target: return mid if nums[0] \u0026lt;= nums[mid]: if nums[0] \u0026lt;= target \u0026lt; nums[mid]: r = mid - 1 else: l = mid + 1 else: if nums[mid] \u0026lt; target \u0026lt;= nums[n - 1]: l = mid + 1 else: r = mid - 1 return -1 76. æœ€å°è¦†ç›–å­ä¸² é¢˜ç›®å¤§æ„ï¼šç»™ä½ ä¸€ä¸ªå­—ç¬¦ä¸² s ã€ä¸€ä¸ªå­—ç¬¦ä¸² t ã€‚è¿”å› s ä¸­æ¶µç›– t æ‰€æœ‰å­—ç¬¦çš„æœ€å°å­ä¸²ã€‚å¦‚æœ s ä¸­ä¸å­˜åœ¨æ¶µç›– t æ‰€æœ‰å­—ç¬¦çš„å­ä¸²ï¼Œåˆ™è¿”å›ç©ºå­—ç¬¦ä¸² \u0026quot;\u0026quot; ã€‚\næ€è·¯ï¼šåŒæŒ‡é’ˆï¼Œä¸ºäº†ä¿è¯å¯¹äºæ¯ä¸€ä¸ªå³ç«¯ç‚¹ï¼Œéƒ½èƒ½æ‰¾åˆ°æœ€ä¼˜çš„å·¦ç«¯ç‚¹ï¼Œå¯¹æ‰€æœ‰çš„å·²ç»éå†çš„å­—ç¬¦éƒ½è¦è®¡æ•°-1ï¼Œ è¿™æ ·åœ¨æ¯ä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„å³ç«¯ç‚¹åˆ¤æ–­æ¯ä¸ªå­—ç¬¦æ˜¯å¦æœ‰å¤šä½™ï¼Œè¿™æ ·ç¡®ä¿å·¦ç«¯ç‚¹æœ€ä¼˜ã€‚\nclass Solution: def minWindow(self, s: str, t: str) -\u0026gt; str: m, n = len(s), len(t) needCnt = n need = Counter(t) res = (0, m) left = 0 for right, ch in enumerate(s): if need[ch] \u0026gt; 0: needCnt -= 1 need[ch] -= 1 # å…³é”®ç‚¹ if needCnt == 0: while need[s[left]]!=0: # ä¿è¯å¯¹äºæ¯ä¸ªç¬¦åˆçš„å³ç«¯ç‚¹ï¼Œéƒ½å¯ä»¥æ‰¾åˆ°æœ€ä¼˜çš„å·¦ç«¯ç‚¹ need[s[left]] += 1 left += 1 if right - left + 1 \u0026lt; res[1] - res[0] + 1: res = (left, right) needCnt += 1 need[s[left]] += 1 left += 1 return s[res[0]:res[1]+1] if res[1] \u0026lt; m else \u0026#34;\u0026#34; 301. åˆ é™¤æ— æ•ˆçš„æ‹¬å· é¢˜ç›®å¤§æ„ï¼š\nç»™ä½ ä¸€ä¸ªç”±è‹¥å¹²æ‹¬å·å’Œå­—æ¯ç»„æˆçš„å­—ç¬¦ä¸² s ï¼Œåˆ é™¤æœ€å°æ•°é‡çš„æ— æ•ˆæ‹¬å·ï¼Œä½¿å¾—è¾“å…¥çš„å­—ç¬¦ä¸²æœ‰æ•ˆã€‚\nè¿”å›æ‰€æœ‰å¯èƒ½çš„ç»“æœã€‚ç­”æ¡ˆå¯ä»¥æŒ‰ ä»»æ„é¡ºåº è¿”å›ã€‚\nå›æº¯ å®ç°æ€è·¯ï¼š\nç»Ÿè®¡æ— æ•ˆæ‹¬å·æ•°é‡ï¼š\né¦–å…ˆéå†å­—ç¬¦ä¸²sï¼Œç»Ÿè®¡å·¦æ‹¬å·å’Œå³æ‹¬å·çš„æ•°é‡lå’Œrï¼Œå…¶ä¸­lè¡¨ç¤ºæœªåŒ¹é…çš„å·¦æ‹¬å·æ•°é‡ï¼Œrè¡¨ç¤ºéœ€è¦åˆ é™¤çš„å³æ‹¬å·æ•°é‡ã€‚ å›æº¯ç®—æ³•ï¼š\nç¼–å†™å›æº¯ç®—æ³•æ¥å°è¯•åˆ é™¤ä¸åŒä½ç½®çš„æ‹¬å·ï¼Œä½¿å¾—å­—ç¬¦ä¸²æœ‰æ•ˆã€‚ å›æº¯è¿‡ç¨‹ä¸­éœ€è¦æ³¨æ„ä»¥ä¸‹æƒ…å†µï¼š å·²ç»åŒ¹é…çš„æ‹¬å·æ•°é‡lnå’Œrnï¼Œä»¥åŠå½“å‰ä½ç½®iã€‚ éå†å­—ç¬¦ä¸²sçš„æ¯ä¸ªå­—ç¬¦ï¼Œå½“é‡åˆ°é‡å¤çš„å­—ç¬¦æ—¶è·³è¿‡ï¼Œä»¥é¿å…é‡å¤ç»“æœã€‚ å¦‚æœå½“å‰å­—ç¬¦ä¸ºå·¦æ‹¬å·å¹¶ä¸”lnä¸ä¸º0ï¼Œåˆ™é€’å½’è°ƒç”¨åˆ é™¤å½“å‰å·¦æ‹¬å·çš„æƒ…å†µï¼Œlnå‡ä¸€ï¼Œå¦åˆ™ç»§ç»­ã€‚ å¦‚æœå½“å‰å­—ç¬¦ä¸ºå³æ‹¬å·å¹¶ä¸”rnä¸ä¸º0ï¼Œåˆ™é€’å½’è°ƒç”¨åˆ é™¤å½“å‰å³æ‹¬å·çš„æƒ…å†µï¼Œrnå‡ä¸€ï¼Œå¦åˆ™ç»§ç»­ã€‚ æ£€æŸ¥å­—ç¬¦ä¸²æœ‰æ•ˆæ€§ï¼š\nç¼–å†™è¾…åŠ©å‡½æ•°checkæ¥æ£€æŸ¥å­—ç¬¦ä¸²æ˜¯å¦æœ‰æ•ˆï¼Œå³å·¦å³æ‹¬å·æ•°é‡æ˜¯å¦åŒ¹é…ã€‚ è¿”å›ç»“æœï¼š\nå°†æ‰€æœ‰æœ‰æ•ˆçš„å­—ç¬¦ä¸²ç»“æœæ·»åŠ åˆ°ç»“æœåˆ—è¡¨retä¸­ï¼Œå¹¶è¿”å›ã€‚ class Solution: def removeInvalidParentheses(self, s: str) -\u0026gt; List[str]: l, r = 0, 0 ret = [] n = len(s) for c in s: if c==\u0026#39;(\u0026#39;: l+=1 elif c==\u0026#39;)\u0026#39;: if l==0: r+=1 else: l-=1 def check(st): cnt=0 for c in st: if c==\u0026#39;(\u0026#39;: cnt+=1 elif c==\u0026#39;)\u0026#39;: cnt-=1 if cnt\u0026lt;0: return False return (cnt==0) def backtrace(st, start, ln, rn): if ln==0 and rn==0 and check(st): ret.append(st[:]) return for i in range(start, len(st)): if i\u0026gt;start and st[i]==st[i-1]: continue if ln+rn\u0026gt;n-1-i+1: break if ln and st[i]==\u0026#39;(\u0026#39;: backtrace(st[:i]+st[i+1:], i, ln-1, rn) elif rn and st[i]==\u0026#39;)\u0026#39;: backtrace(st[:i]+st[i+1:], i, ln, rn-1) backtrace(s, 0, l, r) return ret å¹¿æœ è¿™ä¸ªå®ç°ä½¿ç”¨äº†å¹¿åº¦ä¼˜å…ˆæœç´¢ï¼ˆBFSï¼‰çš„æ€è·¯æ¥è§£å†³é—®é¢˜ã€‚\nBFSæœç´¢ï¼š\nä½¿ç”¨ä¸€ä¸ªé›†åˆcuræ¥å­˜å‚¨å½“å‰å±‚çš„æ‰€æœ‰å­—ç¬¦ä¸²ï¼Œåˆå§‹æ—¶å°†è¾“å…¥çš„å­—ç¬¦ä¸²såŠ å…¥é›†åˆcurä¸­ã€‚ åœ¨æ¯ä¸€è½®å¾ªç¯ä¸­ï¼Œéå†å½“å‰é›†åˆcurä¸­çš„æ‰€æœ‰å­—ç¬¦ä¸²ï¼Œå¦‚æœå…¶ä¸­æœ‰å­—ç¬¦ä¸²æ˜¯æœ‰æ•ˆçš„ï¼Œåˆ™å°†å…¶åŠ å…¥ç»“æœåˆ—è¡¨retä¸­ã€‚ å¦‚æœç»“æœåˆ—è¡¨retä¸ä¸ºç©ºï¼Œåˆ™è·³å‡ºå¾ªç¯ï¼Œè¡¨ç¤ºå·²ç»æ‰¾åˆ°äº†æ‰€æœ‰æœ‰æ•ˆçš„å­—ç¬¦ä¸²ã€‚ å¦‚æœç»“æœåˆ—è¡¨retä¸ºç©ºï¼Œåˆ™éœ€è¦ç»§ç»­è¿›è¡Œä¸‹ä¸€è½®æœç´¢ï¼Œå°†å½“å‰é›†åˆcurä¸­çš„æ¯ä¸ªå­—ç¬¦ä¸²ï¼Œé€šè¿‡åˆ é™¤ä¸€ä¸ªæ‹¬å·çš„æ–¹å¼ï¼Œç”Ÿæˆæ‰€æœ‰å¯èƒ½çš„ä¸‹ä¸€å±‚å­—ç¬¦ä¸²ï¼ŒåŠ å…¥åˆ°é›†åˆnxtä¸­ã€‚ æ›´æ–°å½“å‰é›†åˆcurä¸ºnxtï¼Œç»§ç»­ä¸‹ä¸€è½®æœç´¢ã€‚ æ£€æŸ¥å­—ç¬¦ä¸²æœ‰æ•ˆæ€§ï¼š\nå®šä¹‰ä¸€ä¸ªè¾…åŠ©å‡½æ•°checkï¼Œç”¨äºæ£€æŸ¥å­—ç¬¦ä¸²æ˜¯å¦æœ‰æ•ˆã€‚ éå†å­—ç¬¦ä¸²ä¸­çš„æ¯ä¸ªå­—ç¬¦ï¼Œé‡åˆ°å·¦æ‹¬å·æ—¶å¢åŠ è®¡æ•°å™¨cntï¼Œé‡åˆ°å³æ‹¬å·æ—¶å¦‚æœcntä¸º0åˆ™è¿”å›Falseï¼ˆè¡¨ç¤ºå³æ‹¬å·æ²¡æœ‰åŒ¹é…çš„å·¦æ‹¬å·ï¼‰ï¼Œå¦åˆ™å‡å°‘cntã€‚ æœ€ç»ˆåˆ¤æ–­cntæ˜¯å¦ä¸º0ï¼Œå¦‚æœä¸º0è¡¨ç¤ºå­—ç¬¦ä¸²æœ‰æ•ˆã€‚ è¿”å›ç»“æœï¼š\nè¿”å›ç»“æœåˆ—è¡¨retï¼Œå…¶ä¸­å­˜å‚¨äº†æ‰€æœ‰æœ‰æ•ˆçš„å­—ç¬¦ä¸²ã€‚ class Solution: def removeInvalidParentheses(self, s: str) -\u0026gt; List[str]: ret = [] def check(st): cnt=0 for c in st: if c==\u0026#39;(\u0026#39;: cnt+=1 elif c==\u0026#39;)\u0026#39;: if cnt==0: return False cnt-=1 return cnt==0 cur = set([s]) while True: for st in cur: if check(st): ret.append(st) if len(ret): break nxt = set() for st in cur: for i in range(len(st)): if i\u0026gt;0 and st[i]==st[i-1]: continue if st[i]==\u0026#39;(\u0026#39; or st[i]==\u0026#39;)\u0026#39;: nxt.add(st[:i]+st[i+1:]) cur = nxt return ret 297. äºŒå‰æ ‘çš„åºåˆ—åŒ–ä¸ååºåˆ—åŒ– ä¸æ­¢ç¬¬ä¸€æ¬¡é‡åˆ°äº†ã€‚\né¢˜ç›®å¤§æ„ï¼šåºåˆ—åŒ–æ˜¯å°†ä¸€ä¸ªæ•°æ®ç»“æ„æˆ–å¯¹è±¡è½¬æ¢ä¸ºè¿ç»­çš„æ¯”ç‰¹ä½çš„æ“ä½œï¼Œä»è€Œå¯ä»¥å­˜å‚¨åœ¨æ–‡ä»¶æˆ–å†…å­˜ä¸­ï¼Œå¹¶ä¸”é€šè¿‡ç½‘ç»œä¼ è¾“åˆ°å¦ä¸€ä¸ªè®¡ç®—æœºç¯å¢ƒä¸­ã€‚æœ¬é¢˜è¦æ±‚è®¾è®¡ä¸€ä¸ªç®—æ³•æ¥å®ç°äºŒå‰æ ‘çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–ï¼Œå³å°†äºŒå‰æ ‘è½¬æ¢ä¸ºå­—ç¬¦ä¸²å¹¶å°†å­—ç¬¦ä¸²è½¬æ¢å›åŸå§‹çš„äºŒå‰æ ‘ç»“æ„ã€‚\nå®ç°æ€è·¯ï¼š\nåºåˆ—åŒ–ï¼šä½¿ç”¨é€’å½’å°†äºŒå‰æ ‘è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œæ ¹èŠ‚ç‚¹å€¼ä¸å·¦å³å­æ ‘åºåˆ—åŒ–ç»“æœä¹‹é—´ä½¿ç”¨ç©ºæ ¼åˆ†éš”ï¼Œç©ºèŠ‚ç‚¹ç”¨ \u0026lsquo;#\u0026rsquo; è¡¨ç¤ºã€‚ ååºåˆ—åŒ–ï¼šä½¿ç”¨é€’å½’å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºäºŒå‰æ ‘ã€‚é¦–å…ˆå®šä¹‰ä¸€ä¸ªè¾…åŠ©å‡½æ•° DerWork()ï¼Œç”¨äºé€’å½’æ„å»ºäºŒå‰æ ‘ã€‚åœ¨è¯¥å‡½æ•°ä¸­ï¼ŒæŒ‰ç…§å‰åºéå†çš„é¡ºåºï¼Œä¾æ¬¡æå–å­—ç¬¦ä¸²ä¸­çš„èŠ‚ç‚¹å€¼ï¼Œå¹¶æ ¹æ®èŠ‚ç‚¹å€¼æ„å»ºäºŒå‰æ ‘èŠ‚ç‚¹ã€‚å¦‚æœèŠ‚ç‚¹å€¼ä¸º \u0026lsquo;#\u0026rsquo;ï¼Œè¡¨ç¤ºç©ºèŠ‚ç‚¹ï¼Œè¿”å› Noneã€‚å¦åˆ™ï¼Œåˆ›å»ºèŠ‚ç‚¹å¹¶é€’å½’æ„å»ºå…¶å·¦å³å­æ ‘ã€‚ åœ¨ååºåˆ—åŒ–è¿‡ç¨‹ä¸­ï¼Œä½¿ç”¨ä¸€ä¸ªå…¨å±€å˜é‡ self.s æ¥è®°å½•å½“å‰å¾…å¤„ç†çš„å­—ç¬¦ä¸²ï¼Œæ¯æ¬¡é€’å½’å¤„ç†åï¼Œå°†å­—ç¬¦ä¸²ä¸­å·²ç»å¤„ç†è¿‡çš„éƒ¨åˆ†å‰”é™¤ï¼Œç»§ç»­å¤„ç†å‰©ä½™éƒ¨åˆ†ã€‚ æœ€ç»ˆè¿”å›æ ¹èŠ‚ç‚¹å³å¯ã€‚ class Codec: def serialize(self, root): if not root: return \u0026#34;#\u0026#34; return ( str(root.val) + \u0026#34; \u0026#34; + self.serialize(root.left) + \u0026#34; \u0026#34; + self.serialize(root.right) ) def deserialize(self, data): self.s = data return self.DerWork() def DerWork(self): if len(self.s) == 0: return None try: idx = self.s.index(\u0026#34; \u0026#34;) except: idx = -1 node = self.s if idx == -1 else self.s[:idx] self.s = \u0026#34;\u0026#34; if idx == -1 else self.s[idx + 1 :] if node == \u0026#34;#\u0026#34;: return None t = TreeNode(int(node)) t.left = self.DerWork() t.right = self.DerWork() return t 84. æŸ±çŠ¶å›¾ä¸­æœ€å¤§çš„çŸ©å½¢ é¢˜ç›®å¤§æ„ï¼šç»™å®š n ä¸ªéè´Ÿæ•´æ•°ï¼Œè¡¨ç¤ºæŸ±çŠ¶å›¾ä¸­å„ä¸ªæŸ±å­çš„é«˜åº¦ã€‚æ¯ä¸ªæŸ±å­å½¼æ­¤ç›¸é‚»ï¼Œä¸”å®½åº¦ä¸º 1ã€‚æ±‚åœ¨è¯¥æŸ±çŠ¶å›¾ä¸­ï¼Œèƒ½å¤Ÿå‹¾å‹’å‡ºçš„çŸ©å½¢çš„æœ€å¤§é¢ç§¯ã€‚\nå®ç°æ€è·¯ï¼š\nä½¿ç”¨å•è°ƒæ ˆè§£å†³é—®é¢˜ã€‚åˆ›å»ºä¸¤ä¸ªæ•°ç»„ l å’Œ rï¼Œåˆ†åˆ«è®°å½•æ¯ä¸ªæŸ±å­å‘å·¦å’Œå‘å³ç¬¬ä¸€ä¸ªæ¯”å…¶é«˜åº¦å°çš„æŸ±å­çš„ç´¢å¼•ä½ç½®ã€‚ åˆå§‹åŒ–ä¸€ä¸ªç©ºæ ˆ stkã€‚ éå†æŸ±å­çš„é«˜åº¦åˆ—è¡¨ heightsï¼š è‹¥æ ˆä¸ä¸ºç©ºä¸”å½“å‰æŸ±å­çš„é«˜åº¦å°äºæ ˆé¡¶æŸ±å­çš„é«˜åº¦ï¼Œåˆ™å°†æ ˆé¡¶å…ƒç´ å¼¹å‡ºï¼Œå¹¶æ›´æ–°æ ˆé¡¶å…ƒç´ å¯¹åº”çš„ r å€¼ä¸ºå½“å‰æŸ±å­çš„ç´¢å¼•ã€‚ è‹¥æ ˆä¸ºç©ºæˆ–è€…å½“å‰æŸ±å­çš„é«˜åº¦å¤§äºæ ˆé¡¶æŸ±å­çš„é«˜åº¦ï¼Œåˆ™å°†å½“å‰æŸ±å­çš„ç´¢å¼•å…¥æ ˆã€‚ åœ¨æ›´æ–° r å€¼çš„åŒæ—¶ï¼Œè‹¥æ ˆä¸ä¸ºç©ºï¼Œåˆ™æ›´æ–°å½“å‰æŸ±å­çš„ l å€¼ä¸ºæ ˆé¡¶å…ƒç´ çš„ç´¢å¼•ã€‚ éå†å®Œæˆåï¼Œå¯¹äºæ¯ä¸ªæŸ±å­ iï¼Œè®¡ç®—ä»¥è¯¥æŸ±å­ä¸ºé«˜åº¦çš„çŸ©å½¢é¢ç§¯ä¸º (r[i] - l[i] - 1) * heights[i]ï¼Œå–æœ€å¤§å€¼å³ä¸ºæ‰€æ±‚çš„æœ€å¤§çŸ©å½¢é¢ç§¯ã€‚ è‹¥æŸ±çŠ¶å›¾ä¸ºç©ºï¼Œåˆ™è¿”å› 0ã€‚ class Solution: def largestRectangleArea(self, heights: List[int]) -\u0026gt; int: # å•è°ƒæ ˆï¼Œæ‰¾åˆ°æ¯ä¸ªé«˜åº¦èƒ½ç»„æˆçš„æœ€å¤§çŸ©å½¢ # å¾€å·¦å³ä¸¤é¢æ‰¾åˆ°ç¬¬ä¸€ä¸ªå°äº è‡ªèº«é«˜åº¦çš„æŸ±å­ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªæŸ±å­ä¹‹é—´çš„æŸ±å­ä¸€å®šå¯ä»¥è¾¾åˆ°è‡ªèº«çš„é«˜åº¦ï¼Œæ‰€ä»¥æ˜¯è‡ªèº«é«˜åº¦å¯ä»¥ç»„æˆçš„æœ€å¤§é¢ç§¯ n = len(heights) l, r = [-1]*n, [n]*n res = 0 stk = [] for i in range(n): h = heights[i] while stk and heights[stk[-1]] \u0026gt;= h: r[stk[-1]] = i stk.pop() if stk: l[i] = stk[-1] stk.append(i) # stk = [] # for i in range(n-1, -1, -1): # h = heights[i] # while stk and heights[stk[-1]] \u0026gt;= h: # stk.pop() # if stk: # r[i] = stk[-1] # stk.append(i) for i in range(n): if heights[i] * (r[i]-l[i]-1) \u0026gt; res: res = heights[i] * (r[i]-l[i]-1) return res 85. æœ€å¤§çŸ©å½¢ é¢˜ç›®å¤§æ„ï¼šç»™å®šä¸€ä¸ªä»…åŒ…å« 0 å’Œ 1ã€å¤§å°ä¸º rows x cols çš„äºŒç»´äºŒè¿›åˆ¶çŸ©é˜µï¼Œæ‰¾å‡ºåªåŒ…å« 1 çš„æœ€å¤§çŸ©å½¢ï¼Œå¹¶è¿”å›å…¶é¢ç§¯ã€‚\nå®ç°æ€è·¯ï¼š\nå°†é—®é¢˜è½¬åŒ–ä¸ºçŸ©å½¢æœ€å¤§é¢ç§¯é—®é¢˜ã€‚ å®šä¹‰å˜é‡ area ç”¨äºè®°å½•æœ€å¤§çŸ©å½¢çš„é¢ç§¯ã€‚ åˆ›å»ºäºŒç»´æ•°ç»„ leftï¼Œç”¨äºè®°å½•æ¯ä¸ªä½ç½® (i, j) å·¦ä¾§è¿ç»­ 1 çš„ä¸ªæ•°ã€‚ éå†äºŒç»´çŸ©é˜µï¼Œåˆå§‹åŒ– left æ•°ç»„ï¼š è‹¥å½“å‰ä½ç½®ä¸º \u0026lsquo;1\u0026rsquo;ï¼Œåˆ™ left[i][j] ç­‰äº left[i][j-1] + 1ï¼Œå¦åˆ™ä¸º 0ã€‚ éå†çŸ©é˜µçš„æ¯ä¸€åˆ—ï¼Œå¯¹äºæ¯ä¸€åˆ— jï¼Œä½¿ç”¨å•è°ƒæ ˆæ¥è®¡ç®—ä»¥å½“å‰åˆ—ä¸ºåº•è¾¹çš„æœ€å¤§çŸ©å½¢çš„é¢ç§¯ï¼š åˆå§‹åŒ–ä¸€ä¸ªç©ºæ ˆ stkã€‚ å®šä¹‰ä¸¤ä¸ªæ•°ç»„ up å’Œ downï¼Œåˆ†åˆ«è®°å½•å½“å‰ä½ç½®ä¸Šæ–¹ç¬¬ä¸€ä¸ªå°äºç­‰äºå…¶é«˜åº¦çš„ä½ç½®å’Œä¸‹æ–¹ç¬¬ä¸€ä¸ªå°äºç­‰äºå…¶é«˜åº¦çš„ä½ç½®ã€‚ éå†çŸ©é˜µçš„æ¯ä¸€è¡Œ iï¼Œè¿›è¡Œä»¥ä¸‹æ“ä½œï¼š å½“æ ˆä¸ä¸ºç©ºä¸”æ ˆé¡¶ä½ç½®å¯¹åº”çš„ left å€¼å¤§äºç­‰äºå½“å‰ä½ç½®çš„ left å€¼æ—¶ï¼Œå¼¹å‡ºæ ˆé¡¶ä½ç½®ï¼Œå¹¶æ›´æ–° down å€¼ã€‚ å¦‚æœæ ˆä¸ºç©ºï¼Œåˆ™å½“å‰ä½ç½®çš„ up å€¼ä¸º -1ï¼Œå¦åˆ™ä¸ºæ ˆé¡¶ä½ç½®ã€‚ å°†å½“å‰è¡Œç´¢å¼•å…¥æ ˆã€‚ åœ¨è®¡ç®—å½“å‰åˆ—çš„çŸ©å½¢é¢ç§¯æ—¶ï¼Œheight ä¸º down[i] - up[i] - 1ï¼Œå®½åº¦ä¸º left[i][j]ï¼Œè®¡ç®—å½“å‰åˆ—çš„æœ€å¤§é¢ç§¯å¹¶æ›´æ–° areaã€‚ è¿”å›æœ€å¤§é¢ç§¯ areaã€‚ class Solution: def maximalRectangle(self, matrix: List[List[str]]) -\u0026gt; int: # è½¬åŒ–ä¸ºçŸ©å½¢æœ€å¤§é¢ç§¯é—®é¢˜ n, m = len(matrix), len(matrix[0]) area = 0 left = [[0]*m for _ in range(n)] for i in range(n): for j in range(m): if matrix[i][j]==\u0026#39;1\u0026#39;: left[i][j] += left[i][j-1]+1 if j else 1 for j in range(m): stk = [] up, down = [-1]*n, [n]*n for i in range(n): #è¡Œ while stk and left[ stk[-1] ][j]\u0026gt;=left[i][j]: down[stk[-1]] = i stk.pop() up[i] = stk[-1] if stk else -1 stk.append(i) for i in range(n): height = down[i]-up[i]-1 area = max(area, height*left[i][j]) return area 312. æˆ³æ°”çƒ é¢˜æ„ï¼šç»™å®šnä¸ªæ•°å­—num[0~n-1],æ¯æ¬¡æˆ³ç ´ä¸€ä¸ªæ°”çƒå¯ä»¥è·å¾—nums[i-1]*nums[i]*nums[i+1]ä¸ªç¡¬å¸ï¼Œæœ€ä¸¤æ—é»˜è®¤ä¸º1ï¼Œé—®æœ€ç»ˆè·å¾—çš„æœ€å¤§ç¡¬å¸æ•°é‡ã€‚ æ€è·¯ï¼šåŒºé—´DPï¼Œé€†å‘æ€ç»´, æ€è€ƒå¦‚ä½•æ”¾æ°”çƒèƒ½ä½¿ç¡¬å¸æœ€å¤§ï¼Œf[i][j]ä»£è¡¨å¼€åŒºé—´i~jå¯ä»¥è·å¾—çš„æœ€å¤§ç¡¬å¸ï¼Œ å…ˆæšä¸¾å°åŒºé—´ï¼Œå†æšä¸¾å¤§åŒºé—´ï¼Œæšä¸¾åŒºé—´å†…æ¯ä¸ªæ•°å­—ï¼ŒçŠ¶æ€è½¬ç§»æœ‰ï¼šf[i][j] = max(f[i][j], f[i][k]+f[k][j]+nums[i]*nums[k]*nums[j])ã€‚æœ€ç»ˆè¾“å‡ºf[0][n+1] class Solution: def maxCoins(self, nums: List[int]) -\u0026gt; int: n = len(nums) nums = [1] + nums + [1] f = [[0] * (n + 5) for _ in range(n + 5)] # å¼€åŒºé—´ (left, right) åŒºé—´å†…èƒ½è·å¾—çš„æœ€å¤§ç¡¬å¸ for l in range(2, n + 2): # len:2~n+1 for i in range(n + 1 - l + 1): # left:0~n+1-len j = i + l # right = left + len for k in range(i + 1, j): # å¼€åŒºé—´(i,j) å³[i+1, j-1] f[i][j] = max( f[i][j], f[i][k] + f[k][j] + nums[i] * nums[k] * nums[j] ) return f[0][n + 1] 301. åˆ é™¤æ— æ•ˆçš„æ‹¬å· é¢˜ç›®å¤§æ„ï¼šç»™å®šä¸€ä¸ªç”±å­—æ¯å’Œæ‹¬å·ç»„æˆçš„å­—ç¬¦ä¸²sï¼Œè¦æ±‚åˆ é™¤æœ€å°æ•°é‡çš„æ‹¬å·ï¼Œä½¿å¾—å­—ç¬¦ä¸²æˆä¸ºæœ‰æ•ˆçš„æ‹¬å·ç»„åˆï¼Œå¹¶è¿”å›æ‰€æœ‰å¯èƒ½çš„ç»“æœã€‚\nå®ç°æ€è·¯ï¼š\né¦–å…ˆå®šä¹‰ä¸€ä¸ªè¾…åŠ©å‡½æ•°check(st)ï¼Œç”¨äºæ£€æŸ¥å­—ç¬¦ä¸²stæ˜¯å¦ä¸ºæœ‰æ•ˆçš„æ‹¬å·ç»„åˆã€‚éå†å­—ç¬¦ä¸²ä¸­çš„æ¯ä¸ªå­—ç¬¦ï¼Œç»´æŠ¤ä¸€ä¸ªè®¡æ•°å™¨cntï¼Œé‡åˆ°å·¦æ‹¬å·å¢åŠ è®¡æ•°ï¼Œé‡åˆ°å³æ‹¬å·å‡å°‘è®¡æ•°ï¼Œè‹¥å‡ºç°cntä¸ºè´Ÿæ•°ï¼Œæˆ–è€…éå†ç»“æŸåcntä¸ä¸º0ï¼Œåˆ™è¯´æ˜æ‹¬å·ä¸åŒ¹é…ï¼Œè¿”å›Falseï¼Œå¦åˆ™è¿”å›Trueã€‚\nåˆå§‹åŒ–ä¸€ä¸ªç©ºåˆ—è¡¨retï¼Œç”¨äºå­˜å‚¨ç»“æœã€‚\nåˆå§‹åŒ–ä¸€ä¸ªé›†åˆcurï¼Œåˆå§‹æ—¶å°†è¾“å…¥å­—ç¬¦ä¸²sä½œä¸ºå”¯ä¸€å…ƒç´ åŠ å…¥å…¶ä¸­ã€‚\nä½¿ç”¨whileå¾ªç¯ï¼Œç›´åˆ°æ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„ç»“æœä¸ºæ­¢ï¼š\néå†é›†åˆcurä¸­çš„æ¯ä¸ªå­—ç¬¦ä¸²ï¼Œæ£€æŸ¥å…¶æ˜¯å¦ä¸ºæœ‰æ•ˆæ‹¬å·ç»„åˆï¼Œè‹¥æ˜¯åˆ™å°†å…¶åŠ å…¥ç»“æœåˆ—è¡¨retã€‚\nè‹¥ç»“æœåˆ—è¡¨retä¸ä¸ºç©ºï¼Œåˆ™è¯´æ˜å·²æ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„ç»“æœï¼Œç»“æŸå¾ªç¯ã€‚\nå¦åˆ™ï¼Œåˆå§‹åŒ–ä¸€ä¸ªç©ºé›†åˆnxtï¼Œç”¨äºå­˜å‚¨ä¸‹ä¸€è½®è¿­ä»£çš„å€™é€‰å­—ç¬¦ä¸²é›†åˆã€‚\néå†é›†åˆcurä¸­çš„æ¯ä¸ªå­—ç¬¦ä¸²ï¼Œå¯¹äºæ¯ä¸ªå­—ç¬¦ä¸²ï¼Œå°è¯•åˆ é™¤ä¸€ä¸ªå­—ç¬¦ï¼ˆæ‹¬å·ï¼‰ï¼Œç”Ÿæˆæ–°çš„å­—ç¬¦ä¸²ï¼Œå¹¶å°†å…¶åŠ å…¥nxtä¸­ã€‚\næ›´æ–°curä¸ºnxtï¼Œç»§ç»­ä¸‹ä¸€è½®è¿­ä»£ã€‚\nè¿”å›ç»“æœåˆ—è¡¨retã€‚\nclass Solution: def removeInvalidParentheses(self, s: str) -\u0026gt; List[str]: ret = [] def check(st): cnt=0 for c in st: if c==\u0026#39;(\u0026#39;: cnt+=1 elif c==\u0026#39;)\u0026#39;: if cnt==0: return False cnt-=1 return cnt==0 cur = set([s]) while True: for st in cur: if check(st): ret.append(st) if len(ret): break nxt = set() for st in cur: for i in range(len(st)): if i\u0026gt;0 and st[i]==st[i-1]: continue if st[i]==\u0026#39;(\u0026#39; or st[i]==\u0026#39;)\u0026#39;: nxt.add(st[:i]+st[i+1:]) cur = nxt return ret 647. å›æ–‡å­ä¸² é¢˜ç›®å¤§æ„ï¼šç»™å®šä¸€ä¸ªå­—ç¬¦ä¸²sï¼Œç»Ÿè®¡å¹¶è¿”å›è¯¥å­—ç¬¦ä¸²ä¸­å›æ–‡å­ä¸²çš„æ•°ç›®ã€‚å›æ–‡å­—ç¬¦ä¸²æ˜¯æŒ‡æ­£ç€è¯»å’Œå€’è¿‡æ¥è¯»ä¸€æ ·çš„å­—ç¬¦ä¸²ã€‚å­å­—ç¬¦ä¸²æ˜¯å­—ç¬¦ä¸²ä¸­çš„ç”±è¿ç»­å­—ç¬¦ç»„æˆçš„ä¸€ä¸ªåºåˆ—ã€‚å³ä½¿æ˜¯ç”±ç›¸åŒå­—ç¬¦ç»„æˆçš„ä¸åŒå¼€å§‹ä½ç½®æˆ–ç»“æŸä½ç½®çš„å­ä¸²ï¼Œä¹Ÿä¼šè¢«è§†ä½œä¸åŒçš„å­ä¸²ã€‚\nå®ç°æ€è·¯ï¼šéå†å­—ç¬¦ä¸²sçš„æ‰€æœ‰å¯èƒ½çš„ä¸­å¿ƒä½ç½®ï¼Œå¯¹äºæ¯ä¸ªä¸­å¿ƒä½ç½®ï¼Œå‘ä¸¤è¾¹æ‰©å±•ï¼Œåˆ¤æ–­æ˜¯å¦æ˜¯å›æ–‡ä¸²ã€‚åœ¨æ‰©å±•çš„è¿‡ç¨‹ä¸­ï¼Œæ¯å½“å‘ç°ä¸€ä¸ªå›æ–‡å­ä¸²ï¼Œå°±å°†è®¡æ•°å™¨åŠ 1ã€‚æœ€ç»ˆè¿”å›è®¡æ•°å™¨çš„å€¼å³å¯ã€‚\nclass Solution: def countSubstrings(self, s: str) -\u0026gt; int: n = len(s) ans = 0 for i in range(2*n - 1): l, r = i//2, i//2 + (i\u0026amp;1) while l\u0026gt;=0 and r\u0026lt;n and s[l]==s[r]: l-=1; r+=1 ans+=1 return ans 93. å¤åŸ IP åœ°å€ é¢˜ç›®å¤§æ„ï¼šç»™å®šä¸€ä¸ªåªåŒ…å«æ•°å­—çš„å­—ç¬¦ä¸²sï¼Œè¡¨ç¤ºä¸€ä¸ªIPåœ°å€ï¼Œè¦æ±‚è¿”å›æ‰€æœ‰å¯èƒ½çš„æœ‰æ•ˆIPåœ°å€ï¼Œå³æ¯ä¸ªIPåœ°å€ç”±å››ä¸ªæ•´æ•°ç»„æˆï¼ˆæ¯ä¸ªæ•´æ•°ä½äº0åˆ°255ä¹‹é—´ï¼Œä¸”ä¸èƒ½å«æœ‰å‰å¯¼0ï¼‰ï¼Œæ•´æ•°ä¹‹é—´ç”¨'.'åˆ†éš”ã€‚ä¸èƒ½é‡æ–°æ’åºæˆ–åˆ é™¤sä¸­çš„ä»»ä½•æ•°å­—ï¼Œå¯ä»¥æŒ‰ä»»ä½•é¡ºåºè¿”å›ç­”æ¡ˆã€‚\nå®ç°æ€è·¯ï¼šä½¿ç”¨æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰ç®—æ³•ï¼Œé€’å½’åœ°æœç´¢æ‰€æœ‰å¯èƒ½çš„IPåœ°å€ç»„åˆã€‚åœ¨æœç´¢è¿‡ç¨‹ä¸­ï¼Œé¦–å…ˆç¡®å®šæ¯ä¸ªæ•´æ•°çš„èŒƒå›´ï¼Œç„¶åéå†å¯èƒ½çš„æ•°å­—ç»„åˆï¼Œé€æ­¥æ„å»ºIPåœ°å€ã€‚é€’å½’çš„ç»ˆæ­¢æ¡ä»¶æ˜¯å·²ç»æ‰¾åˆ°äº†å››ä¸ªæ•´æ•°å¹¶ä¸”å·²ç»éå†å®Œäº†æ•´ä¸ªå­—ç¬¦ä¸²sã€‚\nclass Solution: def restoreIpAddresses(self, s: str) -\u0026gt; List[str]: n = len(s) res, addr = [], [\u0026#39;0\u0026#39;]*4 def dfs(i, start): if i==4 or start==n: if i==4 and start==n: res.append(\u0026#39;.\u0026#39;.join(addr)) return if s[start]==\u0026#39;0\u0026#39;: addr[i] = \u0026#39;0\u0026#39; dfs(i+1, start+1) return num = 0 for end in range(start, n): num = num*10 + int(s[end]) if num in range(256): addr[i] = str(num) dfs(i+1, end+1) dfs(0, 0) return res 538. æŠŠäºŒå‰æœç´¢æ ‘è½¬æ¢ä¸ºç´¯åŠ æ ‘ é¢˜ç›®å¤§æ„ï¼šç»™å®šä¸€ä¸ªäºŒå‰æœç´¢æ ‘çš„æ ¹èŠ‚ç‚¹ï¼Œéœ€è¦å°†å…¶è½¬æ¢ä¸ºç´¯åŠ æ ‘ï¼Œå³æ¯ä¸ªèŠ‚ç‚¹çš„æ–°å€¼ç­‰äºåŸæ ‘ä¸­å¤§äºæˆ–ç­‰äºè¯¥èŠ‚ç‚¹å€¼çš„èŠ‚ç‚¹å€¼ä¹‹å’Œã€‚\nå®ç°æ€è·¯ï¼š\né€’å½’è§£æ³• class Solution: def convertBST(self, root: Optional[TreeNode]) -\u0026gt; Optional[TreeNode]: s = 0 def dfs(r): nonlocal s if not r: return 0 dfs(r.right) s += r.val r.val = s dfs(r.left) dfs(root) return root (Morris éå†) ä»æ ¹èŠ‚ç‚¹å¼€å§‹ï¼Œé‡‡ç”¨åå‘ä¸­åºéå†ï¼ˆå³-æ ¹-å·¦ï¼‰çš„æ–¹å¼è¿›è¡Œéå†ã€‚åˆ©ç”¨ä¸€ä¸ªå˜é‡ s è®°å½•ç´¯åŠ å’Œï¼Œåˆå§‹å€¼ä¸º 0ã€‚å¯¹äºæ¯ä¸ªèŠ‚ç‚¹ï¼Œé¦–å…ˆåˆ¤æ–­å…¶æ˜¯å¦å­˜åœ¨å³å­èŠ‚ç‚¹ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œåˆ™å°†å…¶å€¼åŠ ä¸Šç´¯åŠ å’Œå¹¶æ›´æ–°ç´¯åŠ å’Œï¼Œç„¶åå°†å½“å‰èŠ‚ç‚¹æŒ‡å‘å…¶å·¦å­èŠ‚ç‚¹ï¼›å¦‚æœå­˜åœ¨å³å­èŠ‚ç‚¹ï¼Œåˆ™æ‰¾åˆ°å…¶ä¸­åºéå†çš„åç»§èŠ‚ç‚¹ï¼Œå³å³å­æ ‘ä¸­æœ€å·¦è¾¹çš„èŠ‚ç‚¹ã€‚å¦‚æœåç»§èŠ‚ç‚¹çš„å·¦å­èŠ‚ç‚¹ä¸ºç©ºï¼Œè¯´æ˜è¿˜æœªå¤„ç†è¿‡è¯¥èŠ‚ç‚¹ï¼Œåˆ™å°†åç»§èŠ‚ç‚¹çš„å·¦å­èŠ‚ç‚¹æŒ‡å‘å½“å‰èŠ‚ç‚¹ï¼Œå¹¶å°†å½“å‰èŠ‚ç‚¹æŒ‡å‘å…¶å³å­èŠ‚ç‚¹ï¼›å¦‚æœåç»§èŠ‚ç‚¹çš„å·¦å­èŠ‚ç‚¹ä¸ºå½“å‰èŠ‚ç‚¹ï¼Œåˆ™è¯´æ˜å·²ç»å¤„ç†è¿‡è¯¥èŠ‚ç‚¹ï¼Œåˆ™å°†åç»§èŠ‚ç‚¹çš„å·¦å­èŠ‚ç‚¹ç½®ä¸ºç©ºï¼Œå°†å½“å‰èŠ‚ç‚¹çš„å€¼åŠ ä¸Šç´¯åŠ å’Œå¹¶æ›´æ–°ç´¯åŠ å’Œï¼Œå¹¶å°†å½“å‰èŠ‚ç‚¹æŒ‡å‘å…¶å·¦å­èŠ‚ç‚¹ã€‚æœ€åè¿”å›æ ¹èŠ‚ç‚¹ã€‚\nclass Solution: def convertBST(self, root: Optional[TreeNode]) -\u0026gt; Optional[TreeNode]: def getSucc(node): succ = node.right while succ.left and succ.left!=node: succ = succ.left return succ newRoot = root s = 0 while root: if not root.right: s += root.val root.val = s root = root.left else: succ = getSucc(root) if not succ.left: succ.left = root root = root.right else: succ.left = None s += root.val root.val = s root = root.left return newRoot 494. ç›®æ ‡å’Œ é¢˜ç›®å¤§æ„ï¼šç»™å®šä¸€ä¸ªéè´Ÿæ•´æ•°æ•°ç»„ nums å’Œä¸€ä¸ªç›®æ ‡æ•´æ•° targetï¼Œé€šè¿‡ç»™æ•°ç»„ä¸­çš„æ¯ä¸ªæ•´æ•°å‰æ·»åŠ  \u0026lsquo;+\u0026rsquo; æˆ– \u0026lsquo;-\u0026rsquo;ï¼Œç„¶åä¸²è”èµ·æ¥æ„é€ è¡¨è¾¾å¼ï¼Œè¿”å›å¯ä»¥æ„é€ çš„è¡¨è¾¾å¼æ•°ç›®ï¼Œä½¿å…¶è¿ç®—ç»“æœç­‰äºç›®æ ‡æ•°ã€‚\nè®°å¿†åŒ–æœç´¢ å®ç°æ€è·¯ï¼šè¿™ä¸ªé—®é¢˜å¯ä»¥è½¬åŒ–ä¸ºä¸€ä¸ªèƒŒåŒ…é—®é¢˜ã€‚æˆ‘ä»¬å¯ä»¥å°†é—®é¢˜è½¬åŒ–ä¸ºåœ¨æ•°ç»„ä¸­é€‰å–ä¸€äº›æ•°ï¼Œä½¿å¾—å®ƒä»¬çš„å’Œç­‰äº targetã€‚å®šä¹‰ä¸€ä¸ªé€’å½’å‡½æ•° dfs(i, s)ï¼Œè¡¨ç¤ºåœ¨æ•°ç»„ nums ä¸­è€ƒè™‘ç¬¬ i ä¸ªæ•°ï¼Œä½¿å¾—ç›®å‰çš„å’Œä¸º s çš„è¡¨è¾¾å¼æ•°ç›®ã€‚é€’å½’çš„ç»ˆæ­¢æ¡ä»¶æ˜¯éå†å®Œæ‰€æœ‰æ•°ï¼Œå¦‚æœ s ç­‰äº 0ï¼Œè¡¨ç¤ºæ‰¾åˆ°äº†ä¸€ç§æ„é€ æ–¹å¼ï¼Œè¿”å› 1ï¼Œå¦åˆ™è¿”å› 0ã€‚é€’å½’è¿‡ç¨‹ä¸­ï¼Œå¦‚æœ s å°äºå½“å‰æ•° nums[i]ï¼Œè¯´æ˜æ— æ³•é€‰å–å½“å‰æ•°ï¼Œç›´æ¥è·³è¿‡ï¼›å¦åˆ™ï¼Œé€’å½’è€ƒè™‘é€‰å–å½“å‰æ•°å’Œä¸é€‰å–å½“å‰æ•°ä¸¤ç§æƒ…å†µã€‚åˆ©ç”¨ç¼“å­˜è£…é¥°å™¨ @cache å¯ä»¥å°†é‡å¤è®¡ç®—çš„ç»“æœè¿›è¡Œç¼“å­˜ï¼Œæé«˜è®¡ç®—æ•ˆç‡ã€‚æœ€åè¿”å› dfs(0, target) å³å¯å¾—åˆ°ç»“æœã€‚\nclass Solution: def findTargetSumWays(self, nums: List[int], target: int) -\u0026gt; int: target += sum(nums) if target\u0026lt;0 or target\u0026amp;1: return 0 target//=2 @cache def dfs(i, s): if i==len(nums): return 1 if s==0 else 0 if s\u0026lt;nums[i]: return dfs(i+1, s) else: return dfs(i+1, s) + dfs(i+1, s-nums[i]) return dfs(0, target) åŠ¨æ€è§„åˆ’ å®ç°æ€è·¯ï¼š\né—®é¢˜è½¬åŒ–ï¼šå‡è®¾æ•°ç»„ nums çš„å…ƒç´ å’Œä¸º sï¼Œæˆ‘ä»¬å¸Œæœ›æ‰¾åˆ°ä¸€ç§æ–¹å¼ä½¿å¾—åŠ æ­£å·å’Œè´Ÿå·çš„å’Œç­‰äº targetã€‚é€šè¿‡æ¨å¯¼ï¼Œå¾—åˆ°ç›®æ ‡é—®é¢˜è½¬åŒ–ä¸ºï¼š$p + n = s$ï¼Œ $p - n = target$ ä»æ•°ç»„ä¸­é€‰å‡ºå’Œä¸º (s + target) / 2 çš„å­é›†ã€‚å¦‚æœ s + target ä¸ºè´Ÿæ•°æˆ–å¥‡æ•°ï¼Œç›´æ¥è¿”å› 0ã€‚ èƒŒåŒ…é—®é¢˜ï¼šå°†é—®é¢˜è½¬åŒ–ä¸ºä¸€ä¸ªç»å…¸çš„ 0-1 èƒŒåŒ…é—®é¢˜ã€‚æˆ‘ä»¬éœ€è¦æ±‚è§£ä» nums ä¸­é€‰å–ä¸€äº›å…ƒç´ ï¼Œä½¿å¾—å®ƒä»¬çš„å’Œæ°å¥½ä¸º (s + target) / 2ã€‚ åŠ¨æ€è§„åˆ’ï¼šå®šä¹‰ dp[j] ä¸ºå’Œä¸º j çš„å­é›†æ•°ç›®ã€‚åˆå§‹åŒ– dp[0] = 1ï¼Œè¡¨ç¤ºå’Œä¸º 0 çš„æ–¹æ¡ˆæœ‰ 1 ç§ã€‚ç„¶åéå†æ¯ä¸ªå…ƒç´ ï¼Œå¹¶æ›´æ–° dp æ•°ç»„ã€‚ class Solution: def findTargetSumWays(self, nums: List[int], target: int) -\u0026gt; int: target += sum(nums) if target \u0026lt; 0 or target % 2: return 0 target //= 2 n = len(nums) f = [[0] * (target + 1) for _ in range(n + 1)] f[0][0] = 1 for i in range(1, n + 1): for j in range(target + 1): if j \u0026lt; nums[i - 1]: f[i][j] = f[i - 1][j] else: f[i][j] = f[i - 1][j] + f[i - 1][j - nums[i - 1]] return f[n][target] 416. åˆ†å‰²ç­‰å’Œå­é›† é¢˜ç›®å¤§æ„ï¼šç»™å®šä¸€ä¸ªéç©ºæ•°ç»„ numsï¼Œæ•°ç»„ä¸­åªåŒ…å«æ­£æ•´æ•°ã€‚è¦æ±‚åˆ¤æ–­æ˜¯å¦èƒ½å°†è¯¥æ•°ç»„åˆ†å‰²æˆä¸¤ä¸ªå­é›†ï¼Œä½¿å¾—è¿™ä¸¤ä¸ªå­é›†çš„å…ƒç´ å’Œç›¸ç­‰ã€‚\nå®ç°æ€è·¯ï¼š\né¦–å…ˆè®¡ç®—æ•°ç»„ nums çš„æ€»å’Œ sã€‚ å¦‚æœæ€»å’Œ s ä¸ºå¥‡æ•°ï¼Œé‚£ä¹ˆæ— æ³•åˆ†å‰²æˆä¸¤ä¸ªå’Œç›¸ç­‰çš„å­é›†ï¼Œç›´æ¥è¿”å› Falseã€‚ å¦‚æœæ•°ç»„ä¸­çš„æœ€å¤§å€¼å¤§äºæ€»å’Œçš„ä¸€åŠï¼Œåˆ™æ— æ³•åˆ†å‰²æˆä¸¤ä¸ªå’Œç›¸ç­‰çš„å­é›†ï¼Œç›´æ¥è¿”å› Falseã€‚ åˆå§‹åŒ–ä¸€ä¸ªå¤§å°ä¸ºæ€»å’Œä¸€åŠåŠ ä¸€çš„å¸ƒå°”æ•°ç»„ fï¼Œf[i] è¡¨ç¤ºæ˜¯å¦å­˜åœ¨å­é›†çš„å’Œä¸º iã€‚ å°† f[0] åˆå§‹åŒ–ä¸º Trueï¼Œè¡¨ç¤ºå­é›†çš„å’Œä¸º 0ã€‚ éå†æ•°ç»„ numsï¼Œå¯¹äºæ¯ä¸ªæ­£æ•´æ•° numï¼Œä»æ€»å’Œä¸€åŠå¼€å§‹å‘å‰éå†ï¼Œæ›´æ–°æ•°ç»„ fï¼Œå¦‚æœ f[j-num] ä¸º Trueï¼Œåˆ™è¯´æ˜å­˜åœ¨ä¸€ä¸ªå­é›†çš„å’Œä¸º j-numï¼ŒåŠ ä¸Šå½“å‰çš„ num åï¼Œå’Œä¸º jï¼Œå› æ­¤ f[j] ä¹Ÿä¸º Trueã€‚ æœ€ç»ˆè¿”å› f[s//2]ï¼Œè¡¨ç¤ºæ˜¯å¦å­˜åœ¨ä¸€ä¸ªå­é›†çš„å’Œä¸ºæ€»å’Œä¸€åŠï¼Œå³æ˜¯å¦èƒ½åˆ†å‰²æˆä¸¤ä¸ªå’Œç›¸ç­‰çš„å­é›†ã€‚ class Solution: def canPartition(self, nums: List[int]) -\u0026gt; bool: s = sum(nums) if s \u0026amp; 1: return False mx = max(nums) t = s // 2 if mx \u0026gt; t: return False n = len(nums) f = [False] * (t + 1) f[0] = True for i, num in enumerate(nums): for j in range(t, num - 1, -1): f[j] |= f[j - num] return f[t] 394. å­—ç¬¦ä¸²è§£ç  é¢˜ç›®å¤§æ„ï¼šç»™å®šä¸€ä¸ªç»è¿‡ç¼–ç çš„å­—ç¬¦ä¸²ï¼Œå…¶ä¸­ç¼–ç è§„åˆ™ä¸ºk[encoded_string]ï¼Œè¡¨ç¤ºencoded_stringä¸­çš„å†…å®¹é‡å¤kæ¬¡ã€‚è¦æ±‚è§£ç è¯¥å­—ç¬¦ä¸²ã€‚\nå®ç°æ€è·¯ï¼šä½¿ç”¨é€’å½’æ¥è§£ç å­—ç¬¦ä¸²ã€‚éå†è¾“å…¥å­—ç¬¦ä¸²ï¼Œæ ¹æ®ä¸åŒæƒ…å†µè¿›è¡Œå¤„ç†ï¼š\nè‹¥é‡åˆ°æ•°å­—ï¼Œåˆ™ç´¯åŠ æ•°å­—ç›´è‡³é‡åˆ°éæ•°å­—å­—ç¬¦ã€‚ è‹¥é‡åˆ°å­—æ¯ï¼Œåˆ™ç›´æ¥åŠ å…¥å½“å‰è§£ç çš„å­—ç¬¦ä¸²ä¸­ã€‚ è‹¥é‡åˆ°å·¦æ‹¬å·\u0026rsquo;[\u0026rsquo;ï¼Œåˆ™é€’å½’è°ƒç”¨è§£ç å‡½æ•°ï¼Œå¤„ç†æ‹¬å·å†…çš„å†…å®¹ï¼Œç›´è‡³é‡åˆ°å³æ‹¬å·\u0026rsquo;]\u0026rsquo;ã€‚å°†æ‹¬å·å†…çš„è§£ç ç»“æœä¹˜ä»¥å‰é¢ç´¯ç§¯çš„æ•°å­—ï¼Œå¹¶åŠ å…¥å½“å‰è§£ç çš„å­—ç¬¦ä¸²ä¸­ã€‚ è‹¥é‡åˆ°å³æ‹¬å·\u0026rsquo;]\u0026rsquo;ï¼Œåˆ™è¿”å›å½“å‰è§£ç çš„å­—ç¬¦ä¸²å’Œå½“å‰ç´¢å¼•ã€‚ è¿”å›æœ€ç»ˆè§£ç ç»“æœã€‚ class Solution: def decodeString(self, s: str) -\u0026gt; str: def decode(i, n): cur = \u0026#34;\u0026#34; num = 0 while i \u0026lt; len(s): if s[i].isdigit(): num = num * 10 + int(s[i]) elif s[i].isalpha(): cur += s[i] elif s[i] == \u0026#34;[\u0026#34;: ns, ni = decode(i + 1, num) # next str, next index cur += ns i = ni num = 0 elif s[i] == \u0026#34;]\u0026#34;: return cur * n, i i += 1 return cur * n, i res, _ = decode(0, 1) return res 72. ç¼–è¾‘è·ç¦» é¢˜ç›®å¤§æ„ï¼š ç»™å®šä¸¤ä¸ªå•è¯ word1 å’Œ word2ï¼Œæ±‚é€šè¿‡æ’å…¥ã€åˆ é™¤æˆ–æ›¿æ¢å­—ç¬¦ï¼Œå°† word1 è½¬æ¢æˆ word2 æ‰€éœ€çš„æœ€å°‘æ“ä½œæ•°ã€‚\nè®°å¿†åŒ–æœç´¢ è¿™æ®µä»£ç ä½¿ç”¨äº†é€’å½’çš„æ–¹å¼æ±‚è§£ï¼Œå…¶ä¸­ dfs å‡½æ•°è¡¨ç¤ºå°† s çš„å‰ i ä¸ªå­—ç¬¦è½¬æ¢ä¸º t çš„å‰ j ä¸ªå­—ç¬¦æ‰€éœ€çš„æœ€å°‘æ“ä½œæ•°ã€‚é€’å½’çš„åŸºæœ¬æƒ…å†µæ˜¯å½“ i å°äº 0 æ—¶ï¼Œè¡¨ç¤º s å·²ç»éå†å®Œï¼Œéœ€è¦æ’å…¥ t çš„å‰ j+1 ä¸ªå­—ç¬¦ï¼›å½“ j å°äº 0 æ—¶ï¼Œè¡¨ç¤º t å·²ç»éå†å®Œï¼Œéœ€è¦åˆ é™¤ s çš„å‰ i+1 ä¸ªå­—ç¬¦ï¼›å½“ s[i] ç­‰äº t[j] æ—¶ï¼Œä¸éœ€è¦é¢å¤–æ“ä½œï¼Œç›´æ¥é€’å½’å¤„ç† i-1 å’Œ j-1ï¼›å½“ s[i] ä¸ç­‰äº t[j] æ—¶ï¼Œå¯ä»¥é€‰æ‹©æ’å…¥ã€åˆ é™¤æˆ–æ›¿æ¢æ“ä½œï¼Œé€‰æ‹©æ“ä½œæ•°æœ€å°çš„æ–¹æ¡ˆã€‚é€’å½’çš„è¿‡ç¨‹ä¸­åˆ©ç”¨äº†ç¼“å­˜è£…é¥°å™¨ @cache æ¥æé«˜æ•ˆç‡ã€‚\nclass Solution: def minDistance(self, s: str, t: str) -\u0026gt; int: n, m = len(s), len(t) @cache def dfs(i, j): if i \u0026lt; 0: return j + 1 if j \u0026lt; 0: return i + 1 if s[i] == t[j]: return dfs(i - 1, j - 1) return min(dfs(i - 1, j), dfs(i, j - 1), dfs(i - 1, j - 1)) + 1 return dfs(n - 1, m - 1) é€’æ¨ å®ç°æ€è·¯ï¼š å¯ä»¥ä½¿ç”¨åŠ¨æ€è§„åˆ’æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚å®šä¹‰ä¸€ä¸ªäºŒç»´æ•°ç»„ fï¼Œå…¶ä¸­ f[i][j] è¡¨ç¤ºå°† word1 çš„å‰ i ä¸ªå­—ç¬¦è½¬æ¢ä¸º word2 çš„å‰ j ä¸ªå­—ç¬¦æ‰€éœ€çš„æœ€å°‘æ“ä½œæ•°ã€‚åˆå§‹æ—¶ï¼Œf[i][0] è¡¨ç¤ºå°† word1 çš„å‰ i ä¸ªå­—ç¬¦å…¨éƒ¨åˆ é™¤ï¼Œéœ€è¦çš„æ“ä½œæ•°ä¸º iï¼Œè€Œ f[0][j] è¡¨ç¤ºå°† word2 çš„å‰ j ä¸ªå­—ç¬¦å…¨éƒ¨æ’å…¥åˆ° word1 ä¸­ï¼Œéœ€è¦çš„æ“ä½œæ•°ä¸º jã€‚ ç„¶åï¼Œæ ¹æ®åŠ¨æ€è§„åˆ’çš„çŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼Œé€æ­¥è®¡ç®— f[i][j] çš„å€¼ã€‚è‹¥ word1[i] ç­‰äº word2[j]ï¼Œåˆ™ f[i][j] ç­‰äº f[i-1][j-1]ï¼Œå³ä¸éœ€è¦é¢å¤–æ“ä½œï¼›è‹¥ä¸ç›¸ç­‰ï¼Œåˆ™å¯ä»¥è€ƒè™‘æ’å…¥ã€åˆ é™¤æˆ–æ›¿æ¢æ“ä½œï¼Œé€‰æ‹©æ“ä½œæ•°æœ€å°çš„æ–¹æ¡ˆã€‚æœ€ç»ˆï¼Œè¿”å› f[n][m]ï¼Œå…¶ä¸­ n å’Œ m åˆ†åˆ«ä¸º word1 å’Œ word2 çš„é•¿åº¦ã€‚\nclass Solution: def minDistance(self, s: str, t: str) -\u0026gt; int: n, m = len(s), len(t) f = [[0] * (m + 1) for _ in range(n + 1)] f[0] = list(range(m + 1)) # f[0][j] = j for i in range(n): f[i + 1][0] = i + 1 for j in range(m): if s[i] == t[j]: f[i + 1][j + 1] = f[i][j] else: f[i + 1][j + 1] = min(f[i][j + 1], f[i + 1][j], f[i][j]) + 1 return f[n][m] 96. ä¸åŒçš„äºŒå‰æœç´¢æ ‘ é¢˜ç›®å¤§æ„ï¼š ç»™å®šä¸€ä¸ªæ•´æ•° nï¼Œè¦æ±‚è®¡ç®—ç”± n ä¸ªèŠ‚ç‚¹ç»„æˆçš„äºŒå‰æœç´¢æ ‘ï¼ˆBSTï¼‰çš„æ•°é‡ï¼ŒèŠ‚ç‚¹çš„å€¼ä» 1 åˆ° n ä¸”äº’ä¸ç›¸åŒã€‚è¿”å›æ»¡è¶³æ¡ä»¶çš„äºŒå‰æœç´¢æ ‘çš„ç§æ•°ã€‚\nè§£é¢˜æ€è·¯ï¼š äºŒå‰æœç´¢æ ‘çš„æ€§è´¨ï¼š å¯¹äºäºŒå‰æœç´¢æ ‘ï¼Œä»»æ„èŠ‚ç‚¹çš„å·¦å­æ ‘ä¸­çš„å€¼éƒ½å°äºè¯¥èŠ‚ç‚¹çš„å€¼ï¼Œå³å­æ ‘ä¸­çš„å€¼éƒ½å¤§äºè¯¥èŠ‚ç‚¹çš„å€¼ã€‚ ç»™å®šä¸€ä¸ªæ ¹èŠ‚ç‚¹ iï¼ˆèŒƒå›´ä» 1 åˆ° nï¼‰ï¼Œå…¶å·¦å­æ ‘çš„èŠ‚ç‚¹å€¼æ¥è‡ª [1, i-1]ï¼Œå³å­æ ‘çš„èŠ‚ç‚¹å€¼æ¥è‡ª [i+1, n]ã€‚ é€šè¿‡é€’å½’è®¡ç®—å·¦å­æ ‘å’Œå³å­æ ‘çš„ä¸åŒæ„é€ æ–¹å¼ï¼Œå¯ä»¥å¾—åˆ°å½“å‰æ ¹èŠ‚ç‚¹ i æ—¶ï¼Œæ•´ä¸ªäºŒå‰æœç´¢æ ‘çš„æ•°é‡ã€‚ åŠ¨æ€è§„åˆ’ï¼š ç”¨ f[i] è¡¨ç¤º i ä¸ªèŠ‚ç‚¹å¯ä»¥ç»„æˆçš„ä¸åŒäºŒå‰æœç´¢æ ‘çš„æ•°é‡ã€‚ åˆå§‹æ¡ä»¶ï¼šf[0] = 1ï¼Œf[1] = 1ï¼Œè¿™åˆ†åˆ«è¡¨ç¤º0ä¸ªèŠ‚ç‚¹å’Œ1ä¸ªèŠ‚ç‚¹çš„äºŒå‰æœç´¢æ ‘åªæœ‰1ç§ï¼ˆç©ºæ ‘å’Œå•ä¸ªèŠ‚ç‚¹ï¼‰ã€‚ å·¦å­æ ‘çš„èŠ‚ç‚¹æ•°ä¸º j-1ï¼Œå³å­æ ‘çš„èŠ‚ç‚¹æ•°ä¸º i-jã€‚ å…¶ä¸­ï¼Œf[j-1] è¡¨ç¤ºå·¦å­æ ‘æœ‰ j-1 ä¸ªèŠ‚ç‚¹æ—¶çš„äºŒå‰æœç´¢æ ‘ç§æ•°ï¼Œf[i-j] è¡¨ç¤ºå³å­æ ‘æœ‰ i-j ä¸ªèŠ‚ç‚¹æ—¶çš„äºŒå‰æœç´¢æ ‘ç§æ•°ã€‚ ç®—æ³•æ­¥éª¤ï¼š ä½¿ç”¨åŠ¨æ€è§„åˆ’æ•°ç»„ f æ¥å­˜å‚¨ä» 0 åˆ° n ä¸ªèŠ‚ç‚¹çš„ä¸åŒäºŒå‰æœç´¢æ ‘çš„æ•°é‡ã€‚ é€šè¿‡é€’æ¨å…³ç³»æ¥å¡«å……æ•°ç»„ fã€‚ æœ€ç»ˆ f[n] å°±æ˜¯æ‰€æ±‚çš„ç»“æœã€‚ f[i] += f[j - 1] * f[i - j] è¡¨ç¤ºå½“å‰æ ¹èŠ‚ç‚¹ j æ—¶ï¼Œå·¦å­æ ‘å’Œå³å­æ ‘çš„ç§æ•°ä¹˜ç§¯ï¼Œç´¯åŠ åˆ° f[i]ã€‚ class Solution: def numTrees(self, n: int) -\u0026gt; int: f = [0]*(n+1) f[0] = 1; f[1] = 1 for i in range(2, n+1): for j in range(1, i+1): f[i] += f[i-j]*f[j-1] return f[n] 160. ç›¸äº¤é“¾è¡¨ é¢˜ç›®å¤§æ„ï¼š\nç»™å®šä¸¤ä¸ªå•é“¾è¡¨çš„å¤´èŠ‚ç‚¹ headA å’Œ headBï¼Œè¦æ±‚æ‰¾å‡ºå¹¶è¿”å›è¿™ä¸¤ä¸ªé“¾è¡¨ç›¸äº¤çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ã€‚å¦‚æœä¸¤ä¸ªé“¾è¡¨ä¸ç›¸äº¤ï¼Œè¿”å› null\nè§£é¢˜æ€è·¯:\nåˆå§‹åŒ–ä¸¤ä¸ªæŒ‡é’ˆ l1 å’Œ l2ï¼Œåˆ†åˆ«æŒ‡å‘ headA å’Œ headBã€‚\nè®©ä¸¤ä¸ªæŒ‡é’ˆäº¤æ›¿éå†ä¸¤ä¸ªé“¾è¡¨ï¼šå½“ä¸€ä¸ªæŒ‡é’ˆåˆ°è¾¾é“¾è¡¨å°¾éƒ¨æ—¶ï¼Œé‡æ–°æŒ‡å‘å¦ä¸€ä¸ªé“¾è¡¨çš„å¤´éƒ¨ã€‚è¿™æ ·ï¼Œä¸¤ä¸ªæŒ‡é’ˆä¼šåŒæ­¥éå†å‰©ä½™éƒ¨åˆ†ï¼Œä¸”ç›¸äº¤çš„èŠ‚ç‚¹ä¼šåœ¨ç›¸åŒçš„æ­¥æ•°å†…è¢«æ‰¾åˆ°ã€‚\nå¦‚æœä¸¤ä¸ªé“¾è¡¨ç›¸äº¤ï¼Œæœ€ç»ˆä¸¤ä¸ªæŒ‡é’ˆä¼šç›¸é‡åœ¨ç›¸äº¤çš„èŠ‚ç‚¹ã€‚å¦‚æœæ²¡æœ‰äº¤ç‚¹ï¼Œä¸¤ä¸ªæŒ‡é’ˆéƒ½ä¼šå˜ä¸º nullã€‚\nclass Solution: def getIntersectionNode(self, headA: ListNode, headB: ListNode) -\u0026gt; Optional[ListNode]: l1, l2 = headA, headB while l1 != l2: # å½“ l1 åˆ°è¾¾å°¾éƒ¨æ—¶ï¼Œé‡æ–°æŒ‡å‘ headBï¼›å½“ l2 åˆ°è¾¾å°¾éƒ¨æ—¶ï¼Œé‡æ–°æŒ‡å‘ headA l1 = headB if not l1 else l1.next l2 = headA if not l2 else l2.next return l1 148. æ’åºé“¾è¡¨ é¢˜ç›®å¤§æ„ï¼šç»™å®šä¸€ä¸ªé“¾è¡¨çš„å¤´ç»“ç‚¹headï¼Œè¦æ±‚å°†é“¾è¡¨æŒ‰å‡åºæ’åˆ—ï¼Œå¹¶è¿”å›æ’åºåçš„é“¾è¡¨ã€‚\nå®ç°æ€è·¯ï¼š\nä½¿ç”¨å½’å¹¶æ’åºçš„æ€æƒ³å¯¹é“¾è¡¨è¿›è¡Œæ’åºã€‚ ç¼–å†™é€’å½’å‡½æ•°sortFun(head, tail)ï¼Œå…¶ä¸­headè¡¨ç¤ºå½“å‰å¾…æ’åºçš„å­é“¾è¡¨çš„å¤´ç»“ç‚¹ï¼Œtailè¡¨ç¤ºå½“å‰å¾…æ’åºçš„å­é“¾è¡¨çš„å°¾ç»“ç‚¹çš„ä¸‹ä¸€ä¸ªç»“ç‚¹ï¼ˆå³å°¾ç»“ç‚¹çš„åç»§ç»“ç‚¹ï¼‰ã€‚ åœ¨sortFunå‡½æ•°ä¸­ï¼Œä½¿ç”¨å¿«æ…¢æŒ‡é’ˆæ‰¾åˆ°å½“å‰å¾…æ’åºå­é“¾è¡¨çš„ä¸­é—´ç»“ç‚¹midï¼Œå¹¶å°†é“¾è¡¨åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œå·¦è¾¹éƒ¨åˆ†ç”±headåˆ°mid-1ï¼Œå³è¾¹éƒ¨åˆ†ç”±midåˆ°tail-1ã€‚ é€’å½’è°ƒç”¨sortFunå‡½æ•°å¯¹å·¦å³ä¸¤éƒ¨åˆ†è¿›è¡Œæ’åºï¼Œç›´è‡³æ’åºå®Œæˆã€‚ ç¼–å†™mergeå‡½æ•°ï¼Œå°†å·²ç»æ’å¥½åºçš„å·¦å³ä¸¤éƒ¨åˆ†é“¾è¡¨è¿›è¡Œåˆå¹¶ï¼Œåˆå¹¶è¿‡ç¨‹ä¸­æŒ‰ç…§ç»“ç‚¹çš„å€¼å¤§å°è¿›è¡Œæ¯”è¾ƒï¼Œå°†è¾ƒå°çš„ç»“ç‚¹è¿æ¥åˆ°ç»“æœé“¾è¡¨ä¸­ã€‚ è¿”å›åˆå¹¶åçš„é“¾è¡¨ã€‚ class Solution: def sortList(self, head: Optional[ListNode]) -\u0026gt; Optional[ListNode]: def sortFun(head, tail): if not head: return head if head.next == tail: head.next = None return head slow = fast = head while fast != tail: fast = fast.next slow = slow.next if fast != tail: fast = fast.next mid = slow return merge(sortFun(head, mid), sortFun(mid, tail)) def merge(h1, h2): dummy = ListNode(-1) cur = dummy while h1 and h2: if h1.val\u0026lt;=h2.val: cur.next = h1 h1 = h1.next else: cur.next = h2 h2 = h2.next cur = cur.next if h1: cur.next = h1 if h2: cur.next = h2 return dummy.next return sortFun(head, None) 581. æœ€çŸ­æ— åºè¿ç»­å­æ•°ç»„ é¢˜ç›®å¤§æ„ï¼šç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„numsï¼Œæ‰¾å‡ºä¸€ä¸ªè¿ç»­å­æ•°ç»„ï¼Œä½¿å¾—å¯¹è¯¥å­æ•°ç»„è¿›è¡Œå‡åºæ’åºåï¼Œæ•´ä¸ªæ•°ç»„éƒ½å˜ä¸ºå‡åºæ’åºã€‚è¦æ±‚æ‰¾å‡ºç¬¦åˆæ¡ä»¶çš„æœ€çŸ­å­æ•°ç»„ï¼Œå¹¶è¾“å‡ºå…¶é•¿åº¦ã€‚\nå®ç°æ€è·¯ï¼š\né¦–å…ˆåˆå§‹åŒ–æœ€å¤§å€¼mxä¸ºè´Ÿæ— ç©·ï¼Œæœ€å°å€¼mnä¸ºæ­£æ— ç©·ï¼Œä»¥åŠæœ€çŸ­å­æ•°ç»„çš„å·¦å³è¾¹ç•Œleftå’Œrightåˆ†åˆ«ä¸º-1ã€‚ éå†æ•°ç»„numsï¼Œä»å·¦å‘å³å¯»æ‰¾å³è¾¹ç•Œrightï¼Œå¦‚æœå½“å‰å…ƒç´ å°äºå‰é¢çš„æœ€å¤§å€¼mxï¼Œåˆ™æ›´æ–°rightä¸ºå½“å‰ç´¢å¼•ï¼›å¦åˆ™æ›´æ–°æœ€å¤§å€¼mxä¸ºå½“å‰å…ƒç´ ã€‚ åŒæ—¶ï¼Œä»å³å‘å·¦å¯»æ‰¾å·¦è¾¹ç•Œleftï¼Œå¦‚æœå½“å‰å…ƒç´ å¤§äºåé¢çš„æœ€å°å€¼mnï¼Œåˆ™æ›´æ–°leftä¸ºå½“å‰ç´¢å¼•ï¼›å¦åˆ™æ›´æ–°æœ€å°å€¼mnä¸ºå½“å‰å…ƒç´ ã€‚ æœ€åè¿”å›å³è¾¹ç•Œå’Œå·¦è¾¹ç•Œçš„å·®åŠ 1ï¼Œå³ä¸ºæœ€çŸ­å­æ•°ç»„çš„é•¿åº¦ã€‚å¦‚æœå·¦è¾¹ç•Œä»ä¸ºåˆå§‹å€¼-1ï¼Œåˆ™è¿”å›0è¡¨ç¤ºæ•´ä¸ªæ•°ç»„å·²ç»æœ‰åºã€‚ class Solution: def findUnsortedSubarray(self, nums: List[int]) -\u0026gt; int: n = len(nums) mx, right = -inf, -1 mn, left = inf, -1 for i in range(n): if mx \u0026gt; nums[i]: right = i else: mx = nums[i] if mn \u0026lt; nums[n-1-i]: left = n-1-i else: mn = nums[n-1-i] return 0 if left == -1 else right-left+1 ","permalink":"https://kennems.github.io/posts/tech/leetcode-hot-100-1/","summary":"LeetCode Hot 100 ç²¾ç»ƒğŸ¥¸(1) è®°å¿†ä¸­çš„ä¸œè¥¿ä¸€å®šä¼šæ¶ˆé€€ï¼ŒçœŸæ­£ç•™ä¸‹çš„æ‰æ˜¯å­¦åˆ°çš„ï¼Œä¸€å®šè¦åŠæ—¶å›é¡¾ã€‚ 11. ç››æœ€å¤šæ°´çš„å®¹å™¨ é¢˜ç›®å¤§æ„ï¼šç»™å®šä¸€ä¸ªé•¿åº¦ä¸ºnçš„æ•´æ•°æ•°ç»„heig","title":"LeetCode Hot 100 ç²¾ç»ƒğŸ¥¸(1)"},{"content":"æ¯æ—¥ä¸€é¢˜ï¼ˆ202404ï¼‰ 2009. ä½¿æ•°ç»„è¿ç»­çš„æœ€å°‘æ“ä½œæ•° é¢˜æ„ï¼šç»™å®šä¸€ä¸ªå¯èƒ½æœ‰é‡å¤å…ƒç´ çš„æ•°ç»„ï¼Œå¯ä»¥ä¿®æ”¹æ•°ç»„ä¸­å€¼ä¸ºä»»æ„å…¶ä»–å€¼ï¼Œé—®ä½¿æ•°ç»„è¿ç»­çš„æœ€å°æ“ä½œæ•°ã€‚\næ€è·¯ï¼šç”±äºåªèƒ½æ”¹åŠ¨å…ƒç´ ï¼Œæ‰€ä»¥æœ€åçš„å…ƒç´ ä¸ªæ•°ä¸å˜ï¼Œå»é‡åï¼Œæšä¸¾æ¯ä¸ªå€¼ä½œä¸ºå·¦ç«¯ç‚¹ï¼Œåˆ™å³ç«¯ç‚¹ä¸ºnums[i]+n-1, ç”¨åŒæŒ‡é’ˆè®¡ç®—åœ¨åŒºé—´å†…çš„å…ƒç´ ä¸ªæ•°å³ä¸ºå¯ä»¥ä¿ç•™çš„æ•°å­—ï¼Œå…¶ä»–æ•°å­—ä¿®æ”¹å…ƒç´ å€¼å¡«æ»¡ç©ºéš™å³å¯ã€‚\nclass Solution: def minOperations(self, nums: List[int]) -\u0026gt; int: n = len(nums) nums = sorted(set(nums)) j, ans = 0, 0 for i in range(len(nums)): right = nums[i]+ n-1 if len(nums)-1 - i + 1 \u0026lt;= ans: break while j\u0026lt;len(nums) and nums[j]\u0026lt;=right: j+=1 ans = max(ans, j-i) return n-ans 1600. ç‹ä½ç»§æ‰¿é¡ºåº é¢˜æ„ï¼šå›½ç‹ç»§æ‰¿æ¬¡åºæŒ‰å«¡é•¿å­æ¬¡åºï¼Œå®ç°ThroneInheritance(string kingName)åˆå§‹åŒ–,void birth(string parentName, string childName) å‡ºç”Ÿï¼Œvoid death(string name)äººæ­»äº¡ï¼Œstring[] getInheritanceOrder() è¿”å› é™¤å» æ­»äº¡äººå‘˜çš„å½“å‰ç»§æ‰¿é¡ºåºåˆ—è¡¨ã€‚\næ€è·¯ï¼šç±»ä¼¼æ ‘å½¢ç»“æ„ï¼Œå›½ç‹å…ˆç»§æ‰¿ï¼Œä¹‹åæ˜¯å›½ç‹çš„é•¿å­ï¼Œä¹‹åæ˜¯é•¿å­çš„é•¿å­ï¼Œ å¦‚æœä¸å­˜åœ¨åˆ™ä¸ºå›½ç‹çš„æ¬¡å­ä»¥æ­¤ç±»æ¨ï¼Œ æ‰€ä»¥å¯ä»¥ç”¨defaultdict()å­˜å‚¨æ¯ä¸ªçš„å„¿å­æƒ…å†µï¼Œç„¶åæŸ¥è¯¢æ—¶ï¼Œå…ˆå°†è‡ªå·±å…¥ç»“æœåˆ—è¡¨ï¼Œç„¶åæ˜¯ç¬¬ä¸€ä¸ªå„¿å­\u0026hellip;ï¼›å¹¶è®°å½•æ¯ä¸ªäººçš„å­˜æ´»æƒ…å†µï¼Œæ’é™¤æ‰å·²ç»æ­»æ‰çš„äººã€‚\nclass ThroneInheritance: def __init__(self, kingName: str): self.son = defaultdict(list) self.die = set() self.king = kingName def birth(self, parentName: str, childName: str) -\u0026gt; None: self.son[parentName].append(childName) def death(self, name: str) -\u0026gt; None: self.die.add(name) def getInheritanceOrder(self) -\u0026gt; List[str]: ret = [] def dfs(root): if root not in self.die: ret.append(root) for child in self.son[root]: dfs(child) dfs(self.king) return ret 1483. æ ‘èŠ‚ç‚¹çš„ç¬¬ K ä¸ªç¥–å…ˆ é¢˜æ„ï¼šç»™å®šnä¸ªç‚¹(0~n-1)æ¯ä¸ªç‚¹çš„çˆ¶äº²èŠ‚ç‚¹ï¼Œå¿«é€ŸæŸ¥è¯¢æ¯ä¸ªèŠ‚ç‚¹çš„ç¬¬kä¸ªç¥–å®—èŠ‚ç‚¹ã€‚\næ€è·¯ï¼šLCAå€å¢åŸç†ï¼Œ$ancestor[j][i] = ancestor[ ancestor[j][i-1] ][i-1]$ èŠ‚ç‚¹jçš„ç¬¬$2^i$ä¸ªç¥–å®—èŠ‚ç‚¹ä¸ºèŠ‚ç‚¹ç¬¬$2^{i-1}$ä¸ªç¥–å®—çš„ç¬¬$2^{i-1}$ä¸ªç¥–å®—ï¼Œå³$2^{i-1}*2$ä¸ªç¥–å®—èŠ‚ç‚¹ï¼Œ æ‰€ä»¥å…ˆé¢„å¤„ç†å¥½æ¯ä¸ªèŠ‚ç‚¹çš„å„ä¸ªäºŒè¿›åˆ¶ä½ä¸Šçš„ç¥–å®—èŠ‚ç‚¹æ˜¯è°ï¼Œä¹‹ååˆ†è§£äºŒè¿›åˆ¶ä½æ®å¯ä»¥å¾—çŸ¥ä»»æ„ç¬¬kä¸ªç¥–å®—èŠ‚ç‚¹æ˜¯è°ã€‚\nclass TreeAncestor: def __init__(self, n: int, parent: List[int]): self.level = 16 self.ancestor = [[-1]*self.level for _ in range(n)] for i in range(1, n): self.ancestor[i][0] = parent[i] for i in range(1, self.level): for j in range(1, n): if self.ancestor[j][i-1]!=-1: self.ancestor[j][i] = self.ancestor[ self.ancestor[j][i-1] ][i-1] def getKthAncestor(self, node: int, k: int) -\u0026gt; int: while k: t = k\u0026amp;-k k -= t t = t.bit_length()-1 node = self.ancestor[node][t] if node==-1: return -1 return node é¢è¯•é¢˜ 08.12. å…«çš‡å é¢˜ç›®å¤§æ„ï¼š\nè¿™é“é¢˜ç›®æ˜¯ç»å…¸çš„å…«çš‡åé—®é¢˜çš„æ‰©å±•ï¼Œéœ€è¦è®¾è®¡ä¸€ä¸ªç®—æ³•æ¥æ‰“å° N çš‡ååœ¨ N Ã— N æ£‹ç›˜ä¸Šçš„å„ç§æ‘†æ³•ï¼Œå…¶ä¸­æ¯ä¸ªçš‡åéƒ½ä¸åœ¨åŒä¸€è¡Œã€åŒä¸€åˆ—ï¼Œä¹Ÿä¸åœ¨ä»»ä½•å¯¹è§’çº¿ä¸Šã€‚\nå®ç°æ€è·¯ï¼š\nå›æº¯ç®—æ³•ï¼š\nä½¿ç”¨å›æº¯ç®—æ³•æ¥å°è¯•æ‰€æœ‰å¯èƒ½çš„çš‡åæ‘†æ”¾æ–¹å¼ã€‚ ä»ç¬¬ä¸€è¡Œå¼€å§‹ï¼Œä¾æ¬¡å°è¯•æ¯ä¸€åˆ—æ”¾ç½®çš‡åï¼Œç„¶åç»§ç»­é€’å½’åœ°å°è¯•ä¸‹ä¸€è¡Œçš„æ”¾ç½®ï¼Œç›´åˆ°æ‰€æœ‰è¡Œéƒ½æ”¾ç½®å®Œæ¯•ã€‚ åœ¨é€’å½’è¿‡ç¨‹ä¸­ï¼Œé€šè¿‡æ£€æŸ¥æ¯ä¸ªä½ç½®çš„åˆ—ã€ä¸»å¯¹è§’çº¿å’Œå‰¯å¯¹è§’çº¿æ˜¯å¦å·²ç»å­˜åœ¨çš‡åæ¥ç¡®å®šæ˜¯å¦å¯ä»¥æ”¾ç½®çš‡åã€‚ ç”Ÿæˆæ£‹ç›˜ï¼š\nå½“ç¡®å®šäº†ä¸€ç§åˆæ³•çš„çš‡åæ‘†æ”¾æ–¹å¼æ—¶ï¼Œå°†å…¶è½¬æ¢ä¸ºæ£‹ç›˜çš„å½¢å¼ï¼Œå¹¶å°†å…¶æ·»åŠ åˆ°ç»“æœåˆ—è¡¨ä¸­ã€‚ å¯¹äºæ¯è¡Œä¸­çš‡åçš„ä½ç½®ï¼Œç”¨ \u0026lsquo;Q\u0026rsquo; è¡¨ç¤ºï¼Œå…¶ä»–ä½ç½®ç”¨ \u0026lsquo;.\u0026rsquo; è¡¨ç¤ºã€‚ è¾…åŠ©å‡½æ•°ï¼š\nsolve: é€’å½’å‡½æ•°ï¼Œå°è¯•åœ¨æ¯è¡Œæ”¾ç½®çš‡åã€‚ generate: å°†åˆæ³•çš„çš‡åæ‘†æ”¾æ–¹å¼è½¬æ¢ä¸ºæ£‹ç›˜å½¢å¼å¹¶æ·»åŠ åˆ°ç»“æœåˆ—è¡¨ä¸­ã€‚ å‰ªæä¼˜åŒ–ï¼š\nä½¿ç”¨ä½è¿ç®—æ¥è¡¨ç¤ºåˆ—ã€ä¸»å¯¹è§’çº¿å’Œå‰¯å¯¹è§’çº¿çš„å ç”¨æƒ…å†µï¼Œå¯ä»¥å¿«é€Ÿåˆ¤æ–­æŸä¸ªä½ç½®æ˜¯å¦å¯ä»¥æ”¾ç½®çš‡åï¼Œä»è€Œæé«˜æ•ˆç‡ã€‚ åœ¨æ¯æ¬¡é€’å½’æ—¶ï¼Œåˆ©ç”¨ä½è¿ç®—è¿›è¡Œå‰ªæï¼Œæ’é™¤ä¸å¯èƒ½çš„ä½ç½®ã€‚ class Solution: def solveNQueens(self, n: int) -\u0026gt; List[List[str]]: def generate(): board = [] for r in range(n): c = pos[r] row[c] = \u0026#39;Q\u0026#39; board.append(\u0026#34;\u0026#34;.join(row)) row[c] = \u0026#39;.\u0026#39; ret.append(board) def solve(row, column, diag1, diag2): if row==n: generate() else: avail = ( (1\u0026lt;\u0026lt;n)-1) \u0026amp; ( ~(column|diag1|diag2) ) while avail: colPos = avail\u0026amp;(-avail) avail -= colPos colNum = bin(colPos-1).count(\u0026#34;1\u0026#34;) pos[row]=colNum solve(row+1, column|colPos, (diag1|colPos)\u0026lt;\u0026lt;1, (diag2|colPos)\u0026gt;\u0026gt;1) pos = [0]*n ret = [] row = [\u0026#39;.\u0026#39;]*n solve(0, 0, 0, 0) return ret 1702. ä¿®æ”¹åçš„æœ€å¤§äºŒè¿›åˆ¶å­—ç¬¦ä¸² é¢˜æ„ï¼šç»™å®šä¸€ä¸ªäºŒè¿›åˆ¶å­—ç¬¦ä¸²00-\u0026gt;10, 10-\u0026gt;01é—®ä»»æ„æ¬¡æ“ä½œåèƒ½è¾¾åˆ°çš„æœ€å¤§äºŒè¿›åˆ¶å­—ç¬¦ä¸²ã€‚\næ€è·¯ï¼šæ„é€ ï¼Œæ ¹æ®æ¡ä»¶æ¨è¿‡ç¨‹ï¼Œ10-\u0026gt;01å¯ä»¥çœ‹ä½œåé¢çš„0æµ®åˆ°å‰é¢ï¼Œæ‰€æœ‰çš„0èšåˆ°ä¸€èµ·å¯ä»¥å˜æˆ10ä¸²ï¼Œæ‰€ä»¥æœ€åè‡³å¤šåªæœ‰ä¸€ä¸ª0ã€‚æ ¹æ®æ„é€ æ¥åšï¼Œç»Ÿè®¡ç¬¬ä¸€ä¸ª0çš„ä½ç½®å’Œ0çš„ä¸ªæ•°ï¼Œæœ€åæ„é€ å‡ºæœ€åçš„0çš„ä½ç½®ï¼›åŒæŒ‡é’ˆæ¥åšï¼šé‡åˆ°0æ—¶æ‰¾åˆ°åé¢ç¬¬ä¸€ä¸ª0çš„ä½ç½®ï¼Œå°†å…¶æµ®åˆ°æ—è¾¹ï¼Œå¹¶æ¢æˆ10ã€‚\næ„é€ ï¼š\nclass Solution: def maximumBinaryString(self, binary: str) -\u0026gt; str: cnt = binary.count(\u0026#39;0\u0026#39;) if cnt\u0026lt;=1: return binary n = len(binary) ans = [\u0026#39;1\u0026#39;]*n index = binary.index(\u0026#39;0\u0026#39;) ans[index+cnt-1]=\u0026#39;0\u0026#39; return \u0026#39;\u0026#39;.join(ans) åŒæŒ‡é’ˆï¼š\nclass Solution: def maximumBinaryString(self, binary: str) -\u0026gt; str: n = len(binary) s = list(binary) j = 0 for i in range(n): if s[i]==\u0026#39;0\u0026#39;: while j\u0026lt;=i or (j\u0026lt;n and s[j]==\u0026#39;1\u0026#39;): j+=1 if j\u0026lt;n: s[i], s[j], s[i+1] = \u0026#39;1\u0026#39;, \u0026#39;1\u0026#39;, \u0026#39;0\u0026#39; return \u0026#39;\u0026#39;.join(s) 24. ä¸¤ä¸¤äº¤æ¢é“¾è¡¨ä¸­çš„èŠ‚ç‚¹ é¢˜æ„ï¼šç»™å®šä¸€ä¸ªé“¾è¡¨ï¼Œåˆ†åˆ«ä¸¤ä¸ªä¸€ç»„äº¤æ¢ç›¸å¯¹ä½ç½®ã€‚\næ€è·¯ï¼šé“¾è¡¨äº¤æ¢nextæŒ‡é’ˆæ“ä½œï¼Œprev-\u0026gt;A-\u0026gt;B-\u0026gt;Cå˜æˆprev-\u0026gt;B-\u0026gt;A-\u0026gt;Cï¼Œä¸€å…±è¦å˜ä¸‰æ¡è¾¹ã€‚éœ€è¦è®°å½•å‰é¢çš„ç‚¹ï¼Œåé¢çš„ç‚¹ã€‚\nclass Solution: def swapPairs(self, head: Optional[ListNode]) -\u0026gt; Optional[ListNode]: dummy = head prev = None while head and head.next: tmp = head.next.next #A-\u0026gt;B å˜æˆ B-\u0026gt;A nxt = head.next #nxtæ˜¯B, headæ˜¯A nxt.next = head head.next = tmp if prev: prev.next = nxt prev = nxt.next #æ˜¯å¤´èŠ‚ç‚¹(å³æ²¡æœ‰å‰é¢çš„ç‚¹)çš„æ—¶å€™ä¸éœ€è¦è¿™ä¸€æ­¥ if dummy==head: dummy = nxt prev = nxt.next head = tmp return dummy 25. K ä¸ªä¸€ç»„ç¿»è½¬é“¾è¡¨ é¢˜æ„ï¼šæ¯éš”kä¸ªæ•°å­—ç¿»è½¬é“¾è¡¨ã€‚\næ€è·¯ï¼šé“¾è¡¨äº¤æ¢æŒ‡é’ˆæ“ä½œã€‚\n# Definition for singly-linked list. # class ListNode: # def __init__(self, val=0, next=None): # self.val = val # self.next = next class Solution: def reverseKGroup(self, head: Optional[ListNode], k: int) -\u0026gt; Optional[ListNode]: def reverse(head, tail): # A-\u0026gt;B-\u0026gt;C å˜æˆ C-\u0026gt;B-\u0026gt;A cur = tail.next dummy = head while cur != tail: nxt = dummy.next dummy.next = cur cur = dummy dummy = nxt return tail, head # åŸæ¥çš„tailå’Œheadä½ç½®æ²¡å˜ï¼Œä½†ä¸­é—´ç‚¹çš„æŒ‡å‘å…³ç³»å˜äº† hair = ListNode(-1) # ä¼ªå¤´èŠ‚ç‚¹ hair.next = head pre = hair while head: tail = pre for i in range(k): # èµ°è¿‡kä¸ªç‚¹ tail = tail.next if not tail: return hair.next head, tail = reverse(head, tail) pre.next = head # pre-\u0026gt;C pre = tail # preå˜æˆå°¾èŠ‚ç‚¹ head = tail.next # å¤´èŠ‚ç‚¹å˜æˆå½“å‰å°¾èŠ‚ç‚¹çš„ä¸‹ä¸ªä¸€ä¸ªèŠ‚ç‚¹ return hair.next 1766. äº’è´¨æ ‘ é¢˜æ„ï¼šç»™å®šä¸€æ£µæ ‘0~n-1å…±nä¸ªèŠ‚ç‚¹ï¼Œ æ¯ä¸ªèŠ‚ç‚¹æœ‰ä¸€ä¸ªå€¼ï¼Œè¿”å›æ¯ä¸ªèŠ‚ç‚¹çš„ æœ€è¿‘çš„ ä¸è‡ªå·±äº’è´¨çš„(gcd(a,b)=1) ç¥–å®—èŠ‚ç‚¹çš„ç¼–å·ã€‚å€¼çš„èŒƒå›´ä¸º[1,50] æ€è·¯ï¼šDFSï¼Œ éå†ä¸€éæ ‘ï¼Œç»´æŠ¤ä¸€ä¸ªç¥–å®—èŠ‚ç‚¹çš„åˆ—è¡¨ï¼Œåˆ¤æ–­å½“å‰èŠ‚ç‚¹ä¸ç¥–å®—èŠ‚ç‚¹çš„äº’è´¨å…³ç³»ã€‚ä½†æœ´ç´ çš„å°†æ‰€æœ‰çš„ç¥–å®—èŠ‚ç‚¹éƒ½åŠ å…¥åˆ—è¡¨ä¸­ï¼Œåˆ°æ·±å±‚çš„å­èŠ‚ç‚¹æ—¶ä¼šéå†æ•´ä¸ªåˆ—è¡¨ï¼Œä¼šè¶…æ—¶ã€‚ç”±äºå€¼çš„èŒƒå›´æœ€å¤§ä¸º50ï¼Œæ‰€ä»¥å¯ä»¥å…ˆé¢„å¤„ç†50èŒƒå›´ä»¥å†…çš„äº’è´¨å…³ç³»ï¼Œå¯¹äºæ¯ä¸ªèŠ‚ç‚¹ï¼Œåªéœ€è¦åˆ¤æ–­ç¥–å®—èŠ‚ç‚¹é‡Œé¢æœ‰æ²¡æœ‰è¿™äº›äº’è´¨çš„æ•°å³å¯ï¼Œä½†æ˜¯éœ€è¦çš„æ˜¯æœ€è¿‘çš„ç¥–å®—èŠ‚ç‚¹ï¼Œæ‰€ä»¥è¿˜è¦æ·»åŠ ä¸€ä¸ªæ·±åº¦ä¿¡æ¯ï¼Œè¿™æ ·æ‰èƒ½ä¿è¯åœ¨ç›¸åŒå€¼çš„ç¥–å®—èŠ‚ç‚¹ä¸­é€‰æ‹©ç¦»è‡ªå·±æœ€è¿‘çš„ç¥–å®—èŠ‚ç‚¹ã€‚ class Solution: def getCoprimes(self, nums: List[int], edges: List[List[int]]) -\u0026gt; List[int]: n = len(nums) g = [[]*n for _ in range(n)] ret = [-1]*n store = [[] for _ in range(51)] mem = [(-1, -1)]*(51) for i in range(1, 51): for j in range(1, 51): if gcd(i, j)==1: store[i].append(j) for u, v in edges: g[u].append(v) g[v].append(u) def dfs(u, last, level): ret[u] = max(mem[i] for i in store[nums[u]])[1] tmp = mem[nums[u]] mem[nums[u]] = (level, u) for son in g[u]: if son==last: continue dfs(son, u, level+1) mem[nums[u]] = tmp dfs(0, -1, 0) return ret 924. å°½é‡å‡å°‘æ¶æ„è½¯ä»¶çš„ä¼ æ’­ é¢˜ç›®å¤§æ„ï¼šç»™å®šä¸€ä¸ªç”±nä¸ªèŠ‚ç‚¹ç»„æˆçš„ç½‘ç»œï¼Œç”¨n x nä¸ªé‚»æ¥çŸ©é˜µå›¾graphè¡¨ç¤ºã€‚èŠ‚ç‚¹ä¹‹é—´å­˜åœ¨ç›´æ¥è¿æ¥å½“ä¸”ä»…å½“graph[i][j] = 1ã€‚ä¸€äº›èŠ‚ç‚¹initialæœ€åˆè¢«æ¶æ„è½¯ä»¶æ„ŸæŸ“ï¼Œå¦‚æœä¸¤ä¸ªèŠ‚ç‚¹ç›´æ¥è¿æ¥ä¸”è‡³å°‘ä¸€ä¸ªèŠ‚ç‚¹è¢«æ„ŸæŸ“ï¼Œåˆ™ä¸¤ä¸ªèŠ‚ç‚¹éƒ½å°†è¢«æ„ŸæŸ“ã€‚ç§»é™¤ä¸€ä¸ªèŠ‚ç‚¹åï¼Œè¿”å›ä½¿å¾—æ•´ä¸ªç½‘ç»œä¸­æ„ŸæŸ“æ¶æ„è½¯ä»¶çš„æœ€ç»ˆèŠ‚ç‚¹æ•°æœ€å°çš„èŠ‚ç‚¹ï¼Œè‹¥æœ‰å¤šä¸ªèŠ‚ç‚¹æ»¡è¶³æ¡ä»¶ï¼Œåˆ™è¿”å›ç´¢å¼•æœ€å°çš„èŠ‚ç‚¹ã€‚\nå®ç°æ€è·¯ï¼šé¦–å…ˆä½¿ç”¨å¹¶æŸ¥é›†å°†èŠ‚ç‚¹åˆ†ç»„ï¼Œç„¶åè®¡ç®—æ¯ä¸ªåˆ†ç»„çš„å¤§å°å’Œå…¶ä¸­æ„ŸæŸ“èŠ‚ç‚¹çš„æ•°é‡ã€‚éå†initialåˆ—è¡¨ï¼Œæ‰¾åˆ°ä½¿å¾—å…¶æ‰€åœ¨åˆ†ç»„ä¸­åªæœ‰ä¸€ä¸ªæ„ŸæŸ“èŠ‚ç‚¹ä¸”åˆ†ç»„å¤§å°æœ€å¤§çš„èŠ‚ç‚¹ï¼Œè¿”å›å…¶ç´¢å¼•ã€‚\nclass Solution: def minMalwareSpread(self, g: List[List[int]], initial: List[int]) -\u0026gt; int: n, m = len(g), len(initial) f = [i for i in range(n)] size = [1 for _ in range(n)] # è¿é€šå—å†…çš„ç‚¹æ•° num = [0 for _ in range(n)] # è¿é€šå—å†…çš„æ„ŸæŸ“ç‚¹æ•° for x in initial: num[x]=1 def find(x): if f[x] != x: f[x] = find(f[x]) return f[x] for i in range(n): for j in range(i+1, n): if g[i][j]: fi, fj = find(i), find(j) if fi!=fj: f[fi] = fj num[fj] += num[fi] size[fj] += size[fi] ma = -1 initial.sort() idx = initial[0] for x in initial: if num[find(x)]==1 and size[find(x)]\u0026gt;ma: ma = size[find(x)] idx = x return idx 928. å°½é‡å‡å°‘æ¶æ„è½¯ä»¶çš„ä¼ æ’­ II é¢˜ç›®å¤§æ„ï¼šç»™å®šä¸€ä¸ªç”±nä¸ªèŠ‚ç‚¹ç»„æˆçš„ç½‘ç»œï¼Œç”¨n x nä¸ªé‚»æ¥çŸ©é˜µgraphè¡¨ç¤ºã€‚èŠ‚ç‚¹ä¹‹é—´å­˜åœ¨ç›´æ¥è¿æ¥å½“ä¸”ä»…å½“graph[i][j] = 1ã€‚ä¸€äº›èŠ‚ç‚¹initialæœ€åˆè¢«æ¶æ„è½¯ä»¶æ„ŸæŸ“ï¼Œå¦‚æœä¸¤ä¸ªèŠ‚ç‚¹ç›´æ¥è¿æ¥ä¸”è‡³å°‘ä¸€ä¸ªèŠ‚ç‚¹è¢«æ„ŸæŸ“ï¼Œåˆ™ä¸¤ä¸ªèŠ‚ç‚¹éƒ½å°†è¢«æ„ŸæŸ“ã€‚ç§»é™¤ä¸€ä¸ªèŠ‚ç‚¹åŠå…¶è¿æ¥åï¼Œè¿”å›ç§»é™¤åèƒ½ä½¿æ•´ä¸ªç½‘ç»œä¸­æ„ŸæŸ“æ¶æ„è½¯ä»¶çš„æœ€ç»ˆèŠ‚ç‚¹æ•°æœ€å°çš„èŠ‚ç‚¹ï¼Œè‹¥æœ‰å¤šä¸ªèŠ‚ç‚¹æ»¡è¶³æ¡ä»¶ï¼Œåˆ™è¿”å›ç´¢å¼•æœ€å°çš„èŠ‚ç‚¹ã€‚\nå®ç°æ€è·¯ï¼šé¦–å…ˆé€šè¿‡å¹¶æŸ¥é›†å°†ä¸åœ¨initialä¸­çš„èŠ‚ç‚¹è¿›è¡Œåˆå¹¶ï¼Œç„¶åè®¡ç®—æ¯ä¸ªinitialèŠ‚ç‚¹çš„ç›´æ¥æ„ŸæŸ“èŠ‚ç‚¹æ•°ã€‚æœ€åé€‰æ‹©ä½¿å¾—æ„ŸæŸ“èŠ‚ç‚¹æ•°æœ€å°ä¸”ç´¢å¼•æœ€å°çš„initialèŠ‚ç‚¹è¿”å›ã€‚\nclass Solution: def minMalwareSpread(self, g: List[List[int]], initial: List[int]) -\u0026gt; int: n = len(g) def find(x): if f[x] != x: f[x] = find(f[x]) return f[x] f = [i for i in range(n)] source = [[] for _ in range(n)] cnt = [0]*n init = [0]*n for i in initial: init[i] = 1 for i in range(n): if init[i]: continue for j in range(n): if init[j] or not g[i][j]: continue fi, fj = find(i), find(j) if fi!=fj: f[fi] = fj for x in initial: infected = [0]*n for j in range(n): if not g[x][j] or init[j] or infected[find(j)]: continue infected[find(j)] = 1 for j in range(n): if infected[j]: source[j].append(x) for i in range(n): if len(source[i])==1: root = source[i][0] for j in range(n): if find(i)==find(j): # æ˜¯ä¸€ä¸ªè¿é€šå— cnt[root]+=1 idx = initial[0] for x in initial: if cnt[x]\u0026gt;cnt[idx] or (cnt[x]==cnt[idx] and x\u0026lt;idx): idx = x return idx 2007. ä»åŒå€æ•°ç»„ä¸­è¿˜åŸåŸæ•°ç»„ é¢˜ç›®å¤§æ„ï¼šç»™å®šä¸€ä¸ªæ•°ç»„ changedï¼Œé€šè¿‡ä»¥ä¸‹æ–¹å¼æ„é€ åŸå§‹æ•°ç»„ originalï¼šå°† changed ä¸­çš„æ¯ä¸ªå…ƒç´ ä¹˜ä»¥2ï¼Œå¹¶å°†ç»“æœéšæœºæ‰“ä¹±ï¼Œç„¶åè¿”å›åŸå§‹æ•°ç»„ originalã€‚å¦‚æœæ— æ³•æ„é€ åŸå§‹æ•°ç»„ï¼Œåˆ™è¿”å›ç©ºæ•°ç»„ã€‚\nå®ç°æ€è·¯ï¼šé¦–å…ˆåˆ¤æ–­æ•°ç»„ changed çš„é•¿åº¦æ˜¯å¦ä¸ºå¶æ•°ï¼Œå¦‚æœä¸æ˜¯å¶æ•°ï¼Œåˆ™æ— æ³•æ„é€ åŸå§‹æ•°ç»„ï¼Œç›´æ¥è¿”å›ç©ºæ•°ç»„ã€‚æ¥ç€ä½¿ç”¨ä¸€ä¸ªå­—å…¸è®°å½•æ•°ç»„ changed ä¸­å„ä¸ªå…ƒç´ çš„å‡ºç°æ¬¡æ•°ã€‚ç„¶åéå†æ•°ç»„ changedï¼Œå¯¹äºæ¯ä¸ªå…ƒç´  iï¼Œåˆ¤æ–­æ˜¯å¦å­˜åœ¨ i çš„ä¸¤å€çš„å…ƒç´ ï¼Œè‹¥å­˜åœ¨ï¼Œåˆ™å°† i å’Œå…¶ä¸¤å€çš„å…ƒç´ éƒ½ä»å­—å…¸ä¸­å‡å»ä¸€ä¸ªï¼Œå¹¶å°† i åŠ å…¥ç»“æœæ•°ç»„ä¸­ã€‚æœ€ååˆ¤æ–­ç»“æœæ•°ç»„çš„é•¿åº¦æ˜¯å¦è¾¾åˆ°äº†åŸå§‹æ•°ç»„çš„ä¸€åŠï¼Œå¦‚æœè¾¾åˆ°äº†åˆ™è¿”å›ç»“æœæ•°ç»„çš„å‰ä¸€åŠï¼Œå¦åˆ™è¿”å›ç©ºæ•°ç»„ã€‚\nclass Solution: def findOriginalArray(self, changed: List[int]) -\u0026gt; List[int]: n = len(changed) if n\u0026amp;1: return [] d = defaultdict(int) res = [] cnt = 0 changed.sort() for i in changed: d[i]+=1 for i in changed: if not d[i]: continue x = i*2 if i==x: # 0*2 = 0 d[x]-=1 if d[x]: d[x]-=1 # åŒ¹é…æˆåŠŸ cnt+=1 res.append(i) else: if d[x]: d[x]-=1 # åŒ¹é…æˆåŠŸ d[i]-=1 cnt+=1 res.append(i) if cnt\u0026gt;=n//2: return res[:n//2] return [] å®ç°æ€è·¯ï¼šé¦–å…ˆä½¿ç”¨ Counter ç»Ÿè®¡æ•°ç»„ changed ä¸­å„ä¸ªå…ƒç´ çš„å‡ºç°æ¬¡æ•°ã€‚ç„¶åå°†å­—å…¸ä¸­é”®ä¸º 0 çš„å…ƒç´ ï¼ˆå¦‚æœå­˜åœ¨ï¼‰å¼¹å‡ºï¼Œå› ä¸ºåŸå§‹æ•°ç»„ä¸­ä¸å¯èƒ½æœ‰ 0ã€‚æ¥ç€åˆ¤æ–­å­—å…¸ä¸­é”®ä¸º 0 çš„å…ƒç´ å‡ºç°æ¬¡æ•°æ˜¯å¦ä¸ºå¶æ•°ï¼Œå¦‚æœä¸æ˜¯å¶æ•°åˆ™æ— æ³•æ„é€ åŸå§‹æ•°ç»„ï¼Œç›´æ¥è¿”å›ç©ºæ•°ç»„ã€‚ç„¶ååˆå§‹åŒ–ä¸€ä¸ªç”± 0 ç»„æˆçš„æ•°ç»„ ansï¼Œé•¿åº¦ä¸º cnt_0 çš„ä¸€åŠã€‚æ¥ä¸‹æ¥éå†å­—å…¸ä¸­çš„é”®å€¼å¯¹ï¼Œå¯¹äºæ¯ä¸ªé”® xï¼Œåˆ¤æ–­æ˜¯å¦å­˜åœ¨å…¶ä¸€åŠçš„é”®å€¼å¯¹ï¼Œå¹¶å°† x åŠ å…¥ç»“æœæ•°ç»„ ans ä¸­ç›¸åº”æ¬¡æ•°ã€‚æœ€åè¿”å›ç»“æœæ•°ç»„ ansã€‚\nclass Solution: def findOriginalArray(self, changed: List[int]) -\u0026gt; List[int]: cnt = Counter(changed) cnt_0 = cnt.pop(0, 0) if cnt_0\u0026amp;1: return [] ans = [0]*(cnt_0//2) for x in cnt: if x%2==0 and cnt[x//2]: continue while x in cnt: if cnt[2*x]\u0026lt;cnt[x]: return [] ans.extend([x]*(cnt[x])) if cnt[2*x]\u0026gt;cnt[x]: cnt[2*x]-=cnt[x] x*=2 else: x*=4 return ans 1883. å‡†æ—¶æŠµè¾¾ä¼šè®®ç°åœºçš„æœ€å°è·³è¿‡ä¼‘æ¯æ¬¡æ•° é¢˜ç›®å¤§æ„ï¼šé¢˜ç›®ç»™å‡ºäº†ä¸€ç»„é“è·¯çš„é•¿åº¦å’Œè¡Œé©¶é€Ÿåº¦ï¼Œä»¥åŠå‰©ä½™å¯ç”¨æ—¶é—´ã€‚è¦æ±‚è®¡ç®—åœ¨ç»™å®šçš„æ—¶é—´å†…ï¼Œæœ€å°‘è·³è¿‡ä¼‘æ¯æ¬¡æ•°ï¼Œä»¥å‡†æ—¶æŠµè¾¾ä¼šè®®ç°åœºã€‚\nå®ç°æ€è·¯ï¼šåŠ¨æ€è§„åˆ’ã€‚ä½¿ç”¨äºŒç»´æ•°ç»„dp[i][j]è¡¨ç¤ºåˆ°è¾¾ç¬¬iæ¡è·¯ï¼Œè·³è¿‡jæ¬¡ä¼‘æ¯çš„æœ€å°è·ç¦»ã€‚åˆå§‹åŒ–dpæ•°ç»„ï¼Œç„¶åéå†æ¯ä¸€æ¡è·¯ï¼Œåœ¨éå†çš„è¿‡ç¨‹ä¸­æ›´æ–°dpæ•°ç»„ã€‚æœ€åæ£€æŸ¥æ˜¯å¦æœ‰æ–¹æ¡ˆå¯ä»¥åœ¨è§„å®šæ—¶é—´å†…åˆ°è¾¾ä¼šè®®ç°åœºï¼Œå¦‚æœæœ‰ï¼Œè¿”å›è·³è¿‡ä¼‘æ¯çš„æœ€å°æ¬¡æ•°ï¼Œå¦åˆ™è¿”å›-1ã€‚\nclass Solution: def minSkips(self, dist: List[int], speed: int, hoursBefore: int) -\u0026gt; int: n = len(dist) if sum(dist) \u0026gt; hoursBefore * speed: return -1 dp = [[inf] * (n + 1) for _ in range(n + 1)] dp[0][0] = 0 for i in range(1, n): for j in range(i+1): # åˆ°ç¬¬iæ¡è·¯ï¼Œè·³è¿‡æ¬¡æ•°ä¸ºjçš„æœ€å°è·ç¦» # ä¸è·³è¿‡ç¬¬ i æ¡è·¯ dp[i][j] = min(dp[i][j], (dp[i-1][j] + dist[i-1] + speed -1)//speed*speed) # è·³è¿‡ç¬¬ i æ¡è·¯ if j: dp[i][j] = min(dp[i][j], dp[i - 1][j -1] + dist[i-1]) for j in range(n): # å¯ä»¥è·³0~n-1æ¬¡(æœ€åä¸€æ¡è¾¹ä¸ç”¨è·³) if dp[n-1][j]+dist[-1] \u0026lt;= hoursBefore * speed: return j return -1 39. ç»„åˆæ€»å’Œ é¢˜ç›®å¤§æ„ ï¼šç»™å®šä¸€ä¸ªæ— é‡å¤å…ƒç´ çš„æ•´æ•°æ•°ç»„ candidates å’Œä¸€ä¸ªç›®æ ‡æ•´æ•° targetï¼Œæ‰¾å‡º candidates ä¸­å¯ä»¥ä½¿æ•°å­—å’Œä¸ºç›®æ ‡æ•° target çš„æ‰€æœ‰ä¸åŒç»„åˆï¼Œå¹¶ä»¥åˆ—è¡¨å½¢å¼è¿”å›ã€‚å¯ä»¥æ— é™åˆ¶é‡å¤é€‰æ‹© candidates ä¸­çš„åŒä¸€ä¸ªæ•°å­—ã€‚\nå®ç°æ€è·¯ ï¼š\nä½¿ç”¨æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰è¿›è¡Œç»„åˆæœç´¢ã€‚ å®šä¹‰ä¸€ä¸ªè¾…åŠ©å‡½æ•° dfs(i, s)ï¼Œå…¶ä¸­ i è¡¨ç¤ºå½“å‰éå†åˆ°çš„ candidates æ•°ç»„çš„ç´¢å¼•ï¼Œs è¡¨ç¤ºå½“å‰å·²ç»é€‰å–çš„æ•°å­—çš„å’Œã€‚ åœ¨ dfs å‡½æ•°ä¸­ï¼Œå¦‚æœ s å¤§äºç­‰äº target æˆ–è€…å·²ç»éå†åˆ°æ•°ç»„æœ«å°¾ï¼Œåˆ™è¿›è¡Œä»¥ä¸‹åˆ¤æ–­ï¼š å¦‚æœ s ç­‰äº targetï¼Œåˆ™å°†å½“å‰çš„ç»„åˆ ls åŠ å…¥ç»“æœåˆ—è¡¨ ret ä¸­ã€‚ å¦‚æœ s å¤§äº target æˆ–è€…å·²ç»éå†åˆ°æ•°ç»„æœ«å°¾ï¼Œåˆ™ç›´æ¥è¿”å›ã€‚ åœ¨ dfs å‡½æ•°ä¸­ï¼Œåˆ†åˆ«å°è¯•ä¸¤ç§æƒ…å†µï¼š ä¸é€‰æ‹©å½“å‰æ•°å­—ï¼Œç»§ç»­å‘åæœç´¢ï¼šdfs(i+1, s)ã€‚ é€‰æ‹©å½“å‰æ•°å­—ï¼Œç»§ç»­å‘åæœç´¢ï¼šå°†å½“å‰æ•°å­—åŠ å…¥ç»„åˆ ls ä¸­ï¼Œæ›´æ–° sï¼Œå¹¶é€’å½’è°ƒç”¨ dfs(i, s+c[i])ã€‚ åœ¨é€’å½’è°ƒç”¨ä¹‹åï¼Œéœ€è¦å°†å½“å‰é€‰æ‹©çš„æ•°å­—ä»ç»„åˆ ls ä¸­å¼¹å‡ºï¼Œä¿è¯ä¸å½±å“åç»­æœç´¢ã€‚ æœ€ç»ˆè¿”å›ç»“æœåˆ—è¡¨ retã€‚ class Solution: def combinationSum(self, c: List[int], t: int) -\u0026gt; List[List[int]]: n = len(c) ret, ls = [], [] def dfs(i, s): if s\u0026gt;=t or i==n: if s==t: ret.append(ls[:]) return dfs(i+1, s) ls.append(c[i]) dfs(i, s+c[i]) ls.pop() dfs(0, 0) return ret 216. ç»„åˆæ€»å’Œ III é¢˜ç›®å¤§æ„ï¼šæ‰¾å‡ºæ‰€æœ‰ç›¸åŠ ä¹‹å’Œä¸ºnçš„kä¸ªæ•°çš„ç»„åˆï¼Œè¦æ±‚ä½¿ç”¨æ•°å­—1åˆ°9ï¼Œæ¯ä¸ªæ•°å­—æœ€å¤šä½¿ç”¨ä¸€æ¬¡ï¼Œè¿”å›æ‰€æœ‰å¯èƒ½çš„æœ‰æ•ˆç»„åˆçš„åˆ—è¡¨ã€‚åˆ—è¡¨ä¸èƒ½åŒ…å«ç›¸åŒçš„ç»„åˆä¸¤æ¬¡ï¼Œç»„åˆå¯ä»¥ä»¥ä»»ä½•é¡ºåºè¿”å›ã€‚\nå®ç°æ€è·¯ï¼šä½¿ç”¨æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰çš„æ–¹æ³•ï¼Œä»1åˆ°9çš„æ•°å­—ä¸­è¿›è¡Œéå†ï¼Œæ¯æ¬¡é€‰æ‹©ä¸€ä¸ªæ•°å­—æˆ–ä¸é€‰æ‹©ï¼Œç›´åˆ°æ»¡è¶³æ¡ä»¶ä¸ºæ­¢ã€‚é€’å½’è¿‡ç¨‹ä¸­ï¼Œç»´æŠ¤ä¸€ä¸ªåˆ—è¡¨lsï¼Œè®°å½•å½“å‰å·²é€‰æ•°å­—çš„é›†åˆï¼Œå¦‚æœå½“å‰é›†åˆçš„æ•°å­—ä¸ªæ•°ç­‰äºkä¸”å®ƒä»¬çš„å’Œç­‰äºnï¼Œåˆ™å°†å…¶åŠ å…¥ç»“æœåˆ—è¡¨retä¸­ã€‚\nclass Solution: def combinationSum3(self, k: int, n: int) -\u0026gt; List[List[int]]: ret, ls = [], [] def dfs(i, s, cnt): if i==10 or s\u0026gt;=n or cnt\u0026gt;=k: if s==n and cnt==k: ret.append(ls[:]) return dfs(i+1, s, cnt) ls.append(i) dfs(i+1, s+i, cnt+1) ls.pop() dfs(1, 0, 0) return ret 377. ç»„åˆæ€»å’Œ â…£ é¢˜ç›®å¤§æ„ï¼šç»™å®šä¸€ä¸ªç”±ä¸åŒæ•´æ•°ç»„æˆçš„æ•°ç»„numså’Œä¸€ä¸ªç›®æ ‡æ•´æ•°targetï¼Œè¦æ±‚ä»numsä¸­æ‰¾å‡ºæ€»å’Œä¸ºtargetçš„å…ƒç´ ç»„åˆçš„ä¸ªæ•°ã€‚\nå®ç°æ€è·¯ï¼šè¿™æ˜¯ä¸€ä¸ªå…¸å‹çš„åŠ¨æ€è§„åˆ’é—®é¢˜ã€‚ä½¿ç”¨é€’å½’+è®°å¿†åŒ–æœç´¢ï¼ˆMemoizationï¼‰çš„æ–¹æ³•æ¥è§£å†³ã€‚å®šä¹‰dfså‡½æ•°ï¼Œå‚æ•°ä¸ºå½“å‰çš„å’Œsï¼Œå‡½æ•°è¿”å›å½“å‰å’Œsèƒ½å¤Ÿç»„æˆçš„ç»„åˆæ•°ç›®ã€‚é€’å½’çš„ç»ˆæ­¢æ¡ä»¶æ˜¯å½“å‰å’Œså¤§äºç­‰äºç›®æ ‡targetï¼Œåˆ™è¿”å›1ï¼ˆå¦‚æœsç­‰äºtargetï¼Œåˆ™è¡¨ç¤ºæ‰¾åˆ°ä¸€ç§ç»„åˆï¼‰ã€‚å¦åˆ™ï¼Œéå†æ•°ç»„numsä¸­çš„æ¯ä¸ªæ•°ï¼Œå¯¹æ¯ä¸ªæ•°è¿›è¡Œé€’å½’è°ƒç”¨dfs(s+i)ï¼Œç´¯åŠ å¾—åˆ°çš„ç»„åˆæ•°ç›®ã€‚ä½¿ç”¨cacheè£…é¥°å™¨å¯¹dfså‡½æ•°è¿›è¡Œè®°å¿†åŒ–æœç´¢ï¼Œé¿å…é‡å¤è®¡ç®—ã€‚æœ€ç»ˆè¿”å›dfs(0)ï¼Œå³ä»åˆå§‹å’Œä¸º0å¼€å§‹çš„ç»„åˆæ•°ç›®ã€‚\nclass Solution: def combinationSum4(self, nums: List[int], target: int) -\u0026gt; int: @cache def dfs(s): if s\u0026gt;=target: if s==target: return 1 return 0 cnt = 0 for i in nums: cnt += dfs(s+i) return cnt return dfs(0) 1146. å¿«ç…§æ•°ç»„ é¢˜ç›®å¤§æ„ï¼šå®ç°ä¸€ä¸ªæ”¯æŒå¿«ç…§çš„æ•°ç»„æ•°æ®ç»“æ„SnapshotArrayï¼Œå…·ä½“åŒ…æ‹¬ä»¥ä¸‹æ¥å£ï¼š\nSnapshotArray(length)ï¼šåˆå§‹åŒ–ä¸€ä¸ªä¸æŒ‡å®šé•¿åº¦ç›¸ç­‰çš„ç±»æ•°ç»„çš„æ•°æ®ç»“æ„ï¼Œåˆå§‹æ—¶æ¯ä¸ªå…ƒç´ éƒ½ä¸º0ã€‚ set(index, val)ï¼šå°†æŒ‡å®šç´¢å¼•indexå¤„çš„å…ƒç´ è®¾ç½®ä¸ºvalã€‚ snap()ï¼šè·å–è¯¥æ•°ç»„çš„å¿«ç…§ï¼Œå¹¶è¿”å›å¿«ç…§çš„ç¼–å·snap_idï¼ˆå¿«ç…§å·æ˜¯è°ƒç”¨snap()çš„æ€»æ¬¡æ•°å‡å»1ï¼‰ã€‚ get(index, snap_id)ï¼šæ ¹æ®æŒ‡å®šçš„snap_idé€‰æ‹©å¿«ç…§ï¼Œå¹¶è¿”å›è¯¥å¿«ç…§æŒ‡å®šç´¢å¼•indexçš„å€¼ã€‚ å®ç°æ€è·¯ï¼šä½¿ç”¨ä¸€ä¸ªå­—å…¸å­˜å‚¨æ¯ä¸ªç´¢å¼•å¤„çš„å¿«ç…§å†å²è®°å½•ï¼Œé”®ä¸ºç´¢å¼•ï¼Œå€¼ä¸ºä¸€ä¸ªåˆ—è¡¨ï¼Œåˆ—è¡¨ä¸­æ¯ä¸ªå…ƒç´ æ˜¯ä¸€ä¸ªå…ƒç»„ï¼Œå…ƒç»„ç¬¬ä¸€ä¸ªå€¼æ˜¯å¿«ç…§çš„ç¼–å·ï¼Œç¬¬äºŒä¸ªå€¼æ˜¯è¯¥å¿«ç…§å¯¹åº”ç´¢å¼•çš„å€¼ã€‚å¯¹äºsetæ“ä½œï¼Œç›´æ¥å°†å¿«ç…§ç¼–å·å’Œå€¼æ·»åŠ åˆ°å¯¹åº”ç´¢å¼•çš„åˆ—è¡¨ä¸­ï¼›å¯¹äºsnapæ“ä½œï¼Œè®°å½•å¿«ç…§ç¼–å·å¹¶è¿”å›ï¼›å¯¹äºgetæ“ä½œï¼Œåˆ©ç”¨äºŒåˆ†æŸ¥æ‰¾æ‰¾åˆ°snap_idå¯¹åº”çš„å¿«ç…§ï¼Œè¿”å›å¿«ç…§ä¸­è¯¥ç´¢å¼•çš„å€¼ã€‚\nclass SnapshotArray: def __init__(self, length: int): self.id = 0 self.arr = defaultdict(list) def set(self, index: int, val: int) -\u0026gt; None: self.arr[index].append((self.id, val)) def snap(self) -\u0026gt; int: self.id+=1 return self.id-1 def get(self, index: int, snap_id: int) -\u0026gt; int: # if not len(self.arr[index]): # return 0 # l, r = 0, len(self.arr[index])-1 # while l\u0026lt;r: # mid = (l+r+1)\u0026gt;\u0026gt;1 # if self.arr[index][mid][0] \u0026lt;= snap_id: # l = mid # else: # r = mid-1 # return self.arr[index][r][1] if self.arr[index][r][0] \u0026lt;= snap_id else 0 l = bisect.bisect_right(self.arr[index], (snap_id, inf)) - 1 return self.arr[index][l][1] if l\u0026gt;=0 else 0 857. é›‡ä½£ K åå·¥äººçš„æœ€ä½æˆæœ¬ é¢˜ç›®å¤§æ„ï¼šç»™å®šä¸€ç»„å·¥äººï¼Œæ¯ä¸ªå·¥äººæœ‰å·¥ä½œè´¨é‡å’Œæœ€ä½æœŸæœ›å·¥èµ„ï¼Œç°åœ¨è¦é›‡ä½£ k åå·¥äººç»„æˆä¸€ä¸ªå·¥èµ„ç»„ã€‚é›‡ä½£å·¥äººæ—¶ï¼ŒæŒ‰ç…§æ¯åå·¥äººçš„å·¥ä½œè´¨é‡ä¸åŒç»„å…¶ä»–å·¥äººçš„å·¥ä½œè´¨é‡çš„æ¯”ä¾‹æ¥æ”¯ä»˜å·¥èµ„ï¼Œæ¯åå·¥äººè‡³å°‘åº”å¾—åˆ°å…¶æœ€ä½æœŸæœ›å·¥èµ„ã€‚æ±‚ç»„æˆæ»¡è¶³æ¡ä»¶çš„ä»˜è´¹ç¾¤ä½“æ‰€éœ€çš„æœ€å°é‡‘é¢ã€‚\nå®ç°æ€è·¯ï¼šé¦–å…ˆæŒ‰ç…§å·¥èµ„ä¸å·¥ä½œè´¨é‡çš„æ¯”ä¾‹å¯¹å·¥äººè¿›è¡Œæ’åºï¼Œç„¶åä½¿ç”¨æœ€å°å †æ¥ç»´æŠ¤ä¸€ä¸ªå¤§å°ä¸º k çš„å †ï¼Œå †ä¸­å­˜æ”¾çš„æ˜¯è´Ÿçš„å·¥ä½œè´¨é‡ã€‚åˆå§‹åŒ–å †æ—¶ï¼Œå°†å‰ k åå·¥äººçš„è´¨é‡æ”¾å…¥å †ä¸­ã€‚è®¡ç®—å½“å‰å †ä¸­æ‰€æœ‰å·¥äººçš„æ€»è´¨é‡ï¼Œå¹¶è®¡ç®—ä»¥å½“å‰å·¥èµ„æ ‡å‡†ä¸‹çš„æ€»æ”¯ä»˜é‡‘é¢ã€‚ç„¶åéå†å‰©ä½™çš„å·¥äººï¼Œæ¯æ¬¡å°†å †é¡¶çš„è´¨é‡å¼¹å‡ºï¼ŒåŠ ä¸Šæ–°çš„å·¥äººçš„è´¨é‡ï¼Œè®¡ç®—æ–°çš„æ€»è´¨é‡ï¼Œå¹¶æ›´æ–°æ€»æ”¯ä»˜é‡‘é¢ã€‚æ‰¾å‡ºæ‰€æœ‰æƒ…å†µä¸‹çš„æœ€å°æ€»æ”¯ä»˜é‡‘é¢å³å¯ã€‚\nclass Solution: def mincostToHireWorkers(self, quality: List[int], wage: List[int], k: int) -\u0026gt; float: emp = sorted(zip(wage, quality), key = lambda e:e[0]/e[1]) h = [-q for _, q in emp[:k]] heapify(h) sum_q = -sum(h) ans = sum_q*(emp[k-1][0]/emp[k-1][1]) for w, q in emp[k:]: sum_q += heapreplace(h, -q) + q ans = min(ans, sum_q*w/q) return ans ","permalink":"https://kennems.github.io/posts/tech/leetcode%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98202404/","summary":"æ¯æ—¥ä¸€é¢˜ï¼ˆ202404ï¼‰ 2009. ä½¿æ•°ç»„è¿ç»­çš„æœ€å°‘æ“ä½œæ•° é¢˜æ„ï¼šç»™å®šä¸€ä¸ªå¯èƒ½æœ‰é‡å¤å…ƒç´ çš„æ•°ç»„ï¼Œå¯ä»¥ä¿®æ”¹æ•°ç»„ä¸­å€¼ä¸ºä»»æ„å…¶ä»–å€¼ï¼Œé—®ä½¿æ•°ç»„è¿ç»­çš„æœ€å°æ“ä½œæ•°ã€‚","title":"LeetCodeæ¯æ—¥ä¸€é¢˜ï¼ˆ202404ï¼‰"},{"content":"æ¯æ—¥ä¸€é¢˜ï¼ˆ202404ï¼‰ 2009. ä½¿æ•°ç»„è¿ç»­çš„æœ€å°‘æ“ä½œæ•° é¢˜æ„ï¼šç»™å®šä¸€ä¸ªå¯èƒ½æœ‰é‡å¤å…ƒç´ çš„æ•°ç»„ï¼Œå¯ä»¥ä¿®æ”¹æ•°ç»„ä¸­å€¼ä¸ºä»»æ„å…¶ä»–å€¼ï¼Œé—®ä½¿æ•°ç»„è¿ç»­çš„æœ€å°æ“ä½œæ•°ã€‚\næ€è·¯ï¼šç”±äºåªèƒ½æ”¹åŠ¨å…ƒç´ ï¼Œæ‰€ä»¥æœ€åçš„å…ƒç´ ä¸ªæ•°ä¸å˜ï¼Œå»é‡åï¼Œæšä¸¾æ¯ä¸ªå€¼ä½œä¸ºå·¦ç«¯ç‚¹ï¼Œåˆ™å³ç«¯ç‚¹ä¸ºnums[i]+n-1, ç”¨åŒæŒ‡é’ˆè®¡ç®—åœ¨åŒºé—´å†…çš„å…ƒç´ ä¸ªæ•°å³ä¸ºå¯ä»¥ä¿ç•™çš„æ•°å­—ï¼Œå…¶ä»–æ•°å­—ä¿®æ”¹å…ƒç´ å€¼å¡«æ»¡ç©ºéš™å³å¯ã€‚\nclass Solution: def minOperations(self, nums: List[int]) -\u0026gt; int: n = len(nums) nums = sorted(set(nums)) j, ans = 0, 0 for i in range(len(nums)): right = nums[i]+ n-1 if len(nums)-1 - i + 1 \u0026lt;= ans: break while j\u0026lt;len(nums) and nums[j]\u0026lt;=right: j+=1 ans = max(ans, j-i) return n-ans 1600. ç‹ä½ç»§æ‰¿é¡ºåº é¢˜æ„ï¼šå›½ç‹ç»§æ‰¿æ¬¡åºæŒ‰å«¡é•¿å­æ¬¡åºï¼Œå®ç°ThroneInheritance(string kingName)åˆå§‹åŒ–,void birth(string parentName, string childName) å‡ºç”Ÿï¼Œvoid death(string name)äººæ­»äº¡ï¼Œstring[] getInheritanceOrder() è¿”å› é™¤å» æ­»äº¡äººå‘˜çš„å½“å‰ç»§æ‰¿é¡ºåºåˆ—è¡¨ã€‚\næ€è·¯ï¼šç±»ä¼¼æ ‘å½¢ç»“æ„ï¼Œå›½ç‹å…ˆç»§æ‰¿ï¼Œä¹‹åæ˜¯å›½ç‹çš„é•¿å­ï¼Œä¹‹åæ˜¯é•¿å­çš„é•¿å­ï¼Œ å¦‚æœä¸å­˜åœ¨åˆ™ä¸ºå›½ç‹çš„æ¬¡å­ä»¥æ­¤ç±»æ¨ï¼Œ æ‰€ä»¥å¯ä»¥ç”¨defaultdict()å­˜å‚¨æ¯ä¸ªçš„å„¿å­æƒ…å†µï¼Œç„¶åæŸ¥è¯¢æ—¶ï¼Œå…ˆå°†è‡ªå·±å…¥ç»“æœåˆ—è¡¨ï¼Œç„¶åæ˜¯ç¬¬ä¸€ä¸ªå„¿å­\u0026hellip;ï¼›å¹¶è®°å½•æ¯ä¸ªäººçš„å­˜æ´»æƒ…å†µï¼Œæ’é™¤æ‰å·²ç»æ­»æ‰çš„äººã€‚\nclass ThroneInheritance: def __init__(self, kingName: str): self.son = defaultdict(list) self.die = set() self.king = kingName def birth(self, parentName: str, childName: str) -\u0026gt; None: self.son[parentName].append(childName) def death(self, name: str) -\u0026gt; None: self.die.add(name) def getInheritanceOrder(self) -\u0026gt; List[str]: ret = [] def dfs(root): if root not in self.die: ret.append(root) for child in self.son[root]: dfs(child) dfs(self.king) return ret 1483. æ ‘èŠ‚ç‚¹çš„ç¬¬ K ä¸ªç¥–å…ˆ é¢˜æ„ï¼šç»™å®šnä¸ªç‚¹(0~n-1)æ¯ä¸ªç‚¹çš„çˆ¶äº²èŠ‚ç‚¹ï¼Œå¿«é€ŸæŸ¥è¯¢æ¯ä¸ªèŠ‚ç‚¹çš„ç¬¬kä¸ªç¥–å®—èŠ‚ç‚¹ã€‚\næ€è·¯ï¼šLCAå€å¢åŸç†ï¼Œ$ancestor[j][i] = ancestor[ ancestor[j][i-1] ][i-1]$ èŠ‚ç‚¹jçš„ç¬¬$2^i$ä¸ªç¥–å®—èŠ‚ç‚¹ä¸ºèŠ‚ç‚¹ç¬¬$2^{i-1}$ä¸ªç¥–å®—çš„ç¬¬$2^{i-1}$ä¸ªç¥–å®—ï¼Œå³$2^{i-1}*2$ä¸ªç¥–å®—èŠ‚ç‚¹ï¼Œ æ‰€ä»¥å…ˆé¢„å¤„ç†å¥½æ¯ä¸ªèŠ‚ç‚¹çš„å„ä¸ªäºŒè¿›åˆ¶ä½ä¸Šçš„ç¥–å®—èŠ‚ç‚¹æ˜¯è°ï¼Œä¹‹ååˆ†è§£äºŒè¿›åˆ¶ä½æ®å¯ä»¥å¾—çŸ¥ä»»æ„ç¬¬kä¸ªç¥–å®—èŠ‚ç‚¹æ˜¯è°ã€‚\nclass TreeAncestor: def __init__(self, n: int, parent: List[int]): self.level = 16 self.ancestor = [[-1]*self.level for _ in range(n)] for i in range(1, n): self.ancestor[i][0] = parent[i] for i in range(1, self.level): for j in range(1, n): if self.ancestor[j][i-1]!=-1: self.ancestor[j][i] = self.ancestor[ self.ancestor[j][i-1] ][i-1] def getKthAncestor(self, node: int, k: int) -\u0026gt; int: while k: t = k\u0026amp;-k k -= t t = t.bit_length()-1 node = self.ancestor[node][t] if node==-1: return -1 return node é¢è¯•é¢˜ 08.12. å…«çš‡å é¢˜ç›®å¤§æ„ï¼š\nè¿™é“é¢˜ç›®æ˜¯ç»å…¸çš„å…«çš‡åé—®é¢˜çš„æ‰©å±•ï¼Œéœ€è¦è®¾è®¡ä¸€ä¸ªç®—æ³•æ¥æ‰“å° N çš‡ååœ¨ N Ã— N æ£‹ç›˜ä¸Šçš„å„ç§æ‘†æ³•ï¼Œå…¶ä¸­æ¯ä¸ªçš‡åéƒ½ä¸åœ¨åŒä¸€è¡Œã€åŒä¸€åˆ—ï¼Œä¹Ÿä¸åœ¨ä»»ä½•å¯¹è§’çº¿ä¸Šã€‚\nå®ç°æ€è·¯ï¼š\nå›æº¯ç®—æ³•ï¼š\nä½¿ç”¨å›æº¯ç®—æ³•æ¥å°è¯•æ‰€æœ‰å¯èƒ½çš„çš‡åæ‘†æ”¾æ–¹å¼ã€‚ ä»ç¬¬ä¸€è¡Œå¼€å§‹ï¼Œä¾æ¬¡å°è¯•æ¯ä¸€åˆ—æ”¾ç½®çš‡åï¼Œç„¶åç»§ç»­é€’å½’åœ°å°è¯•ä¸‹ä¸€è¡Œçš„æ”¾ç½®ï¼Œç›´åˆ°æ‰€æœ‰è¡Œéƒ½æ”¾ç½®å®Œæ¯•ã€‚ åœ¨é€’å½’è¿‡ç¨‹ä¸­ï¼Œé€šè¿‡æ£€æŸ¥æ¯ä¸ªä½ç½®çš„åˆ—ã€ä¸»å¯¹è§’çº¿å’Œå‰¯å¯¹è§’çº¿æ˜¯å¦å·²ç»å­˜åœ¨çš‡åæ¥ç¡®å®šæ˜¯å¦å¯ä»¥æ”¾ç½®çš‡åã€‚ ç”Ÿæˆæ£‹ç›˜ï¼š\nå½“ç¡®å®šäº†ä¸€ç§åˆæ³•çš„çš‡åæ‘†æ”¾æ–¹å¼æ—¶ï¼Œå°†å…¶è½¬æ¢ä¸ºæ£‹ç›˜çš„å½¢å¼ï¼Œå¹¶å°†å…¶æ·»åŠ åˆ°ç»“æœåˆ—è¡¨ä¸­ã€‚ å¯¹äºæ¯è¡Œä¸­çš‡åçš„ä½ç½®ï¼Œç”¨ \u0026lsquo;Q\u0026rsquo; è¡¨ç¤ºï¼Œå…¶ä»–ä½ç½®ç”¨ \u0026lsquo;.\u0026rsquo; è¡¨ç¤ºã€‚ è¾…åŠ©å‡½æ•°ï¼š\nsolve: é€’å½’å‡½æ•°ï¼Œå°è¯•åœ¨æ¯è¡Œæ”¾ç½®çš‡åã€‚ generate: å°†åˆæ³•çš„çš‡åæ‘†æ”¾æ–¹å¼è½¬æ¢ä¸ºæ£‹ç›˜å½¢å¼å¹¶æ·»åŠ åˆ°ç»“æœåˆ—è¡¨ä¸­ã€‚ å‰ªæä¼˜åŒ–ï¼š\nä½¿ç”¨ä½è¿ç®—æ¥è¡¨ç¤ºåˆ—ã€ä¸»å¯¹è§’çº¿å’Œå‰¯å¯¹è§’çº¿çš„å ç”¨æƒ…å†µï¼Œå¯ä»¥å¿«é€Ÿåˆ¤æ–­æŸä¸ªä½ç½®æ˜¯å¦å¯ä»¥æ”¾ç½®çš‡åï¼Œä»è€Œæé«˜æ•ˆç‡ã€‚ åœ¨æ¯æ¬¡é€’å½’æ—¶ï¼Œåˆ©ç”¨ä½è¿ç®—è¿›è¡Œå‰ªæï¼Œæ’é™¤ä¸å¯èƒ½çš„ä½ç½®ã€‚ class Solution: def solveNQueens(self, n: int) -\u0026gt; List[List[str]]: def generate(): board = [] for r in range(n): c = pos[r] row[c] = \u0026#39;Q\u0026#39; board.append(\u0026#34;\u0026#34;.join(row)) row[c] = \u0026#39;.\u0026#39; ret.append(board) def solve(row, column, diag1, diag2): if row==n: generate() else: avail = ( (1\u0026lt;\u0026lt;n)-1) \u0026amp; ( ~(column|diag1|diag2) ) while avail: colPos = avail\u0026amp;(-avail) avail -= colPos colNum = bin(colPos-1).count(\u0026#34;1\u0026#34;) pos[row]=colNum solve(row+1, column|colPos, (diag1|colPos)\u0026lt;\u0026lt;1, (diag2|colPos)\u0026gt;\u0026gt;1) pos = [0]*n ret = [] row = [\u0026#39;.\u0026#39;]*n solve(0, 0, 0, 0) return ret 1702. ä¿®æ”¹åçš„æœ€å¤§äºŒè¿›åˆ¶å­—ç¬¦ä¸² é¢˜æ„ï¼šç»™å®šä¸€ä¸ªäºŒè¿›åˆ¶å­—ç¬¦ä¸²00-\u0026gt;10, 10-\u0026gt;01é—®ä»»æ„æ¬¡æ“ä½œåèƒ½è¾¾åˆ°çš„æœ€å¤§äºŒè¿›åˆ¶å­—ç¬¦ä¸²ã€‚\næ€è·¯ï¼šæ„é€ ï¼Œæ ¹æ®æ¡ä»¶æ¨è¿‡ç¨‹ï¼Œ10-\u0026gt;01å¯ä»¥çœ‹ä½œåé¢çš„0æµ®åˆ°å‰é¢ï¼Œæ‰€æœ‰çš„0èšåˆ°ä¸€èµ·å¯ä»¥å˜æˆ10ä¸²ï¼Œæ‰€ä»¥æœ€åè‡³å¤šåªæœ‰ä¸€ä¸ª0ã€‚æ ¹æ®æ„é€ æ¥åšï¼Œç»Ÿè®¡ç¬¬ä¸€ä¸ª0çš„ä½ç½®å’Œ0çš„ä¸ªæ•°ï¼Œæœ€åæ„é€ å‡ºæœ€åçš„0çš„ä½ç½®ï¼›åŒæŒ‡é’ˆæ¥åšï¼šé‡åˆ°0æ—¶æ‰¾åˆ°åé¢ç¬¬ä¸€ä¸ª0çš„ä½ç½®ï¼Œå°†å…¶æµ®åˆ°æ—è¾¹ï¼Œå¹¶æ¢æˆ10ã€‚\næ„é€ ï¼š\nclass Solution: def maximumBinaryString(self, binary: str) -\u0026gt; str: cnt = binary.count(\u0026#39;0\u0026#39;) if cnt\u0026lt;=1: return binary n = len(binary) ans = [\u0026#39;1\u0026#39;]*n index = binary.index(\u0026#39;0\u0026#39;) ans[index+cnt-1]=\u0026#39;0\u0026#39; return \u0026#39;\u0026#39;.join(ans) åŒæŒ‡é’ˆï¼š\nclass Solution: def maximumBinaryString(self, binary: str) -\u0026gt; str: n = len(binary) s = list(binary) j = 0 for i in range(n): if s[i]==\u0026#39;0\u0026#39;: while j\u0026lt;=i or (j\u0026lt;n and s[j]==\u0026#39;1\u0026#39;): j+=1 if j\u0026lt;n: s[i], s[j], s[i+1] = \u0026#39;1\u0026#39;, \u0026#39;1\u0026#39;, \u0026#39;0\u0026#39; return \u0026#39;\u0026#39;.join(s) 24. ä¸¤ä¸¤äº¤æ¢é“¾è¡¨ä¸­çš„èŠ‚ç‚¹ é¢˜æ„ï¼šç»™å®šä¸€ä¸ªé“¾è¡¨ï¼Œåˆ†åˆ«ä¸¤ä¸ªä¸€ç»„äº¤æ¢ç›¸å¯¹ä½ç½®ã€‚\næ€è·¯ï¼šé“¾è¡¨äº¤æ¢nextæŒ‡é’ˆæ“ä½œï¼Œprev-\u0026gt;A-\u0026gt;B-\u0026gt;Cå˜æˆprev-\u0026gt;B-\u0026gt;A-\u0026gt;Cï¼Œä¸€å…±è¦å˜ä¸‰æ¡è¾¹ã€‚éœ€è¦è®°å½•å‰é¢çš„ç‚¹ï¼Œåé¢çš„ç‚¹ã€‚\nclass Solution: def swapPairs(self, head: Optional[ListNode]) -\u0026gt; Optional[ListNode]: dummy = head prev = None while head and head.next: tmp = head.next.next #A-\u0026gt;B å˜æˆ B-\u0026gt;A nxt = head.next #nxtæ˜¯B, headæ˜¯A nxt.next = head head.next = tmp if prev: prev.next = nxt prev = nxt.next #æ˜¯å¤´èŠ‚ç‚¹(å³æ²¡æœ‰å‰é¢çš„ç‚¹)çš„æ—¶å€™ä¸éœ€è¦è¿™ä¸€æ­¥ if dummy==head: dummy = nxt prev = nxt.next head = tmp return dummy 25. K ä¸ªä¸€ç»„ç¿»è½¬é“¾è¡¨ é¢˜æ„ï¼šæ¯éš”kä¸ªæ•°å­—ç¿»è½¬é“¾è¡¨ã€‚\næ€è·¯ï¼šé“¾è¡¨äº¤æ¢æŒ‡é’ˆæ“ä½œã€‚\n# Definition for singly-linked list. # class ListNode: # def __init__(self, val=0, next=None): # self.val = val # self.next = next class Solution: def reverseKGroup(self, head: Optional[ListNode], k: int) -\u0026gt; Optional[ListNode]: def reverse(head, tail): # A-\u0026gt;B-\u0026gt;C å˜æˆ C-\u0026gt;B-\u0026gt;A cur = tail.next dummy = head while cur != tail: nxt = dummy.next dummy.next = cur cur = dummy dummy = nxt return tail, head # åŸæ¥çš„tailå’Œheadä½ç½®æ²¡å˜ï¼Œä½†ä¸­é—´ç‚¹çš„æŒ‡å‘å…³ç³»å˜äº† hair = ListNode(-1) # ä¼ªå¤´èŠ‚ç‚¹ hair.next = head pre = hair while head: tail = pre for i in range(k): # èµ°è¿‡kä¸ªç‚¹ tail = tail.next if not tail: return hair.next head, tail = reverse(head, tail) pre.next = head # pre-\u0026gt;C pre = tail # preå˜æˆå°¾èŠ‚ç‚¹ head = tail.next # å¤´èŠ‚ç‚¹å˜æˆå½“å‰å°¾èŠ‚ç‚¹çš„ä¸‹ä¸ªä¸€ä¸ªèŠ‚ç‚¹ return hair.next 1766. äº’è´¨æ ‘ é¢˜æ„ï¼šç»™å®šä¸€æ£µæ ‘0~n-1å…±nä¸ªèŠ‚ç‚¹ï¼Œ æ¯ä¸ªèŠ‚ç‚¹æœ‰ä¸€ä¸ªå€¼ï¼Œè¿”å›æ¯ä¸ªèŠ‚ç‚¹çš„ æœ€è¿‘çš„ ä¸è‡ªå·±äº’è´¨çš„(gcd(a,b)=1) ç¥–å®—èŠ‚ç‚¹çš„ç¼–å·ã€‚å€¼çš„èŒƒå›´ä¸º[1,50] æ€è·¯ï¼šDFSï¼Œ éå†ä¸€éæ ‘ï¼Œç»´æŠ¤ä¸€ä¸ªç¥–å®—èŠ‚ç‚¹çš„åˆ—è¡¨ï¼Œåˆ¤æ–­å½“å‰èŠ‚ç‚¹ä¸ç¥–å®—èŠ‚ç‚¹çš„äº’è´¨å…³ç³»ã€‚ä½†æœ´ç´ çš„å°†æ‰€æœ‰çš„ç¥–å®—èŠ‚ç‚¹éƒ½åŠ å…¥åˆ—è¡¨ä¸­ï¼Œåˆ°æ·±å±‚çš„å­èŠ‚ç‚¹æ—¶ä¼šéå†æ•´ä¸ªåˆ—è¡¨ï¼Œä¼šè¶…æ—¶ã€‚ç”±äºå€¼çš„èŒƒå›´æœ€å¤§ä¸º50ï¼Œæ‰€ä»¥å¯ä»¥å…ˆé¢„å¤„ç†50èŒƒå›´ä»¥å†…çš„äº’è´¨å…³ç³»ï¼Œå¯¹äºæ¯ä¸ªèŠ‚ç‚¹ï¼Œåªéœ€è¦åˆ¤æ–­ç¥–å®—èŠ‚ç‚¹é‡Œé¢æœ‰æ²¡æœ‰è¿™äº›äº’è´¨çš„æ•°å³å¯ï¼Œä½†æ˜¯éœ€è¦çš„æ˜¯æœ€è¿‘çš„ç¥–å®—èŠ‚ç‚¹ï¼Œæ‰€ä»¥è¿˜è¦æ·»åŠ ä¸€ä¸ªæ·±åº¦ä¿¡æ¯ï¼Œè¿™æ ·æ‰èƒ½ä¿è¯åœ¨ç›¸åŒå€¼çš„ç¥–å®—èŠ‚ç‚¹ä¸­é€‰æ‹©ç¦»è‡ªå·±æœ€è¿‘çš„ç¥–å®—èŠ‚ç‚¹ã€‚ class Solution: def getCoprimes(self, nums: List[int], edges: List[List[int]]) -\u0026gt; List[int]: n = len(nums) g = [[]*n for _ in range(n)] ret = [-1]*n store = [[] for _ in range(51)] mem = [(-1, -1)]*(51) for i in range(1, 51): for j in range(1, 51): if gcd(i, j)==1: store[i].append(j) for u, v in edges: g[u].append(v) g[v].append(u) def dfs(u, last, level): ret[u] = max(mem[i] for i in store[nums[u]])[1] tmp = mem[nums[u]] mem[nums[u]] = (level, u) for son in g[u]: if son==last: continue dfs(son, u, level+1) mem[nums[u]] = tmp dfs(0, -1, 0) return ret 924. å°½é‡å‡å°‘æ¶æ„è½¯ä»¶çš„ä¼ æ’­ é¢˜ç›®å¤§æ„ï¼šç»™å®šä¸€ä¸ªç”±nä¸ªèŠ‚ç‚¹ç»„æˆçš„ç½‘ç»œï¼Œç”¨n x nä¸ªé‚»æ¥çŸ©é˜µå›¾graphè¡¨ç¤ºã€‚èŠ‚ç‚¹ä¹‹é—´å­˜åœ¨ç›´æ¥è¿æ¥å½“ä¸”ä»…å½“graph[i][j] = 1ã€‚ä¸€äº›èŠ‚ç‚¹initialæœ€åˆè¢«æ¶æ„è½¯ä»¶æ„ŸæŸ“ï¼Œå¦‚æœä¸¤ä¸ªèŠ‚ç‚¹ç›´æ¥è¿æ¥ä¸”è‡³å°‘ä¸€ä¸ªèŠ‚ç‚¹è¢«æ„ŸæŸ“ï¼Œåˆ™ä¸¤ä¸ªèŠ‚ç‚¹éƒ½å°†è¢«æ„ŸæŸ“ã€‚ç§»é™¤ä¸€ä¸ªèŠ‚ç‚¹åï¼Œè¿”å›ä½¿å¾—æ•´ä¸ªç½‘ç»œä¸­æ„ŸæŸ“æ¶æ„è½¯ä»¶çš„æœ€ç»ˆèŠ‚ç‚¹æ•°æœ€å°çš„èŠ‚ç‚¹ï¼Œè‹¥æœ‰å¤šä¸ªèŠ‚ç‚¹æ»¡è¶³æ¡ä»¶ï¼Œåˆ™è¿”å›ç´¢å¼•æœ€å°çš„èŠ‚ç‚¹ã€‚\nå®ç°æ€è·¯ï¼šé¦–å…ˆä½¿ç”¨å¹¶æŸ¥é›†å°†èŠ‚ç‚¹åˆ†ç»„ï¼Œç„¶åè®¡ç®—æ¯ä¸ªåˆ†ç»„çš„å¤§å°å’Œå…¶ä¸­æ„ŸæŸ“èŠ‚ç‚¹çš„æ•°é‡ã€‚éå†initialåˆ—è¡¨ï¼Œæ‰¾åˆ°ä½¿å¾—å…¶æ‰€åœ¨åˆ†ç»„ä¸­åªæœ‰ä¸€ä¸ªæ„ŸæŸ“èŠ‚ç‚¹ä¸”åˆ†ç»„å¤§å°æœ€å¤§çš„èŠ‚ç‚¹ï¼Œè¿”å›å…¶ç´¢å¼•ã€‚\nclass Solution: def minMalwareSpread(self, g: List[List[int]], initial: List[int]) -\u0026gt; int: n, m = len(g), len(initial) f = [i for i in range(n)] size = [1 for _ in range(n)] # è¿é€šå—å†…çš„ç‚¹æ•° num = [0 for _ in range(n)] # è¿é€šå—å†…çš„æ„ŸæŸ“ç‚¹æ•° for x in initial: num[x]=1 def find(x): if f[x] != x: f[x] = find(f[x]) return f[x] for i in range(n): for j in range(i+1, n): if g[i][j]: fi, fj = find(i), find(j) if fi!=fj: f[fi] = fj num[fj] += num[fi] size[fj] += size[fi] ma = -1 initial.sort() idx = initial[0] for x in initial: if num[find(x)]==1 and size[find(x)]\u0026gt;ma: ma = size[find(x)] idx = x return idx 928. å°½é‡å‡å°‘æ¶æ„è½¯ä»¶çš„ä¼ æ’­ II é¢˜ç›®å¤§æ„ï¼šç»™å®šä¸€ä¸ªç”±nä¸ªèŠ‚ç‚¹ç»„æˆçš„ç½‘ç»œï¼Œç”¨n x nä¸ªé‚»æ¥çŸ©é˜µgraphè¡¨ç¤ºã€‚èŠ‚ç‚¹ä¹‹é—´å­˜åœ¨ç›´æ¥è¿æ¥å½“ä¸”ä»…å½“graph[i][j] = 1ã€‚ä¸€äº›èŠ‚ç‚¹initialæœ€åˆè¢«æ¶æ„è½¯ä»¶æ„ŸæŸ“ï¼Œå¦‚æœä¸¤ä¸ªèŠ‚ç‚¹ç›´æ¥è¿æ¥ä¸”è‡³å°‘ä¸€ä¸ªèŠ‚ç‚¹è¢«æ„ŸæŸ“ï¼Œåˆ™ä¸¤ä¸ªèŠ‚ç‚¹éƒ½å°†è¢«æ„ŸæŸ“ã€‚ç§»é™¤ä¸€ä¸ªèŠ‚ç‚¹åŠå…¶è¿æ¥åï¼Œè¿”å›ç§»é™¤åèƒ½ä½¿æ•´ä¸ªç½‘ç»œä¸­æ„ŸæŸ“æ¶æ„è½¯ä»¶çš„æœ€ç»ˆèŠ‚ç‚¹æ•°æœ€å°çš„èŠ‚ç‚¹ï¼Œè‹¥æœ‰å¤šä¸ªèŠ‚ç‚¹æ»¡è¶³æ¡ä»¶ï¼Œåˆ™è¿”å›ç´¢å¼•æœ€å°çš„èŠ‚ç‚¹ã€‚\nå®ç°æ€è·¯ï¼šé¦–å…ˆé€šè¿‡å¹¶æŸ¥é›†å°†ä¸åœ¨initialä¸­çš„èŠ‚ç‚¹è¿›è¡Œåˆå¹¶ï¼Œç„¶åè®¡ç®—æ¯ä¸ªinitialèŠ‚ç‚¹çš„ç›´æ¥æ„ŸæŸ“èŠ‚ç‚¹æ•°ã€‚æœ€åé€‰æ‹©ä½¿å¾—æ„ŸæŸ“èŠ‚ç‚¹æ•°æœ€å°ä¸”ç´¢å¼•æœ€å°çš„initialèŠ‚ç‚¹è¿”å›ã€‚\nclass Solution: def minMalwareSpread(self, g: List[List[int]], initial: List[int]) -\u0026gt; int: n = len(g) def find(x): if f[x] != x: f[x] = find(f[x]) return f[x] f = [i for i in range(n)] source = [[] for _ in range(n)] cnt = [0]*n init = [0]*n for i in initial: init[i] = 1 for i in range(n): if init[i]: continue for j in range(n): if init[j] or not g[i][j]: continue fi, fj = find(i), find(j) if fi!=fj: f[fi] = fj for x in initial: infected = [0]*n for j in range(n): if not g[x][j] or init[j] or infected[find(j)]: continue infected[find(j)] = 1 for j in range(n): if infected[j]: source[j].append(x) for i in range(n): if len(source[i])==1: root = source[i][0] for j in range(n): if find(i)==find(j): # æ˜¯ä¸€ä¸ªè¿é€šå— cnt[root]+=1 idx = initial[0] for x in initial: if cnt[x]\u0026gt;cnt[idx] or (cnt[x]==cnt[idx] and x\u0026lt;idx): idx = x return idx 2007. ä»åŒå€æ•°ç»„ä¸­è¿˜åŸåŸæ•°ç»„ é¢˜ç›®å¤§æ„ï¼šç»™å®šä¸€ä¸ªæ•°ç»„ changedï¼Œé€šè¿‡ä»¥ä¸‹æ–¹å¼æ„é€ åŸå§‹æ•°ç»„ originalï¼šå°† changed ä¸­çš„æ¯ä¸ªå…ƒç´ ä¹˜ä»¥2ï¼Œå¹¶å°†ç»“æœéšæœºæ‰“ä¹±ï¼Œç„¶åè¿”å›åŸå§‹æ•°ç»„ originalã€‚å¦‚æœæ— æ³•æ„é€ åŸå§‹æ•°ç»„ï¼Œåˆ™è¿”å›ç©ºæ•°ç»„ã€‚\nå®ç°æ€è·¯ï¼šé¦–å…ˆåˆ¤æ–­æ•°ç»„ changed çš„é•¿åº¦æ˜¯å¦ä¸ºå¶æ•°ï¼Œå¦‚æœä¸æ˜¯å¶æ•°ï¼Œåˆ™æ— æ³•æ„é€ åŸå§‹æ•°ç»„ï¼Œç›´æ¥è¿”å›ç©ºæ•°ç»„ã€‚æ¥ç€ä½¿ç”¨ä¸€ä¸ªå­—å…¸è®°å½•æ•°ç»„ changed ä¸­å„ä¸ªå…ƒç´ çš„å‡ºç°æ¬¡æ•°ã€‚ç„¶åéå†æ•°ç»„ changedï¼Œå¯¹äºæ¯ä¸ªå…ƒç´  iï¼Œåˆ¤æ–­æ˜¯å¦å­˜åœ¨ i çš„ä¸¤å€çš„å…ƒç´ ï¼Œè‹¥å­˜åœ¨ï¼Œåˆ™å°† i å’Œå…¶ä¸¤å€çš„å…ƒç´ éƒ½ä»å­—å…¸ä¸­å‡å»ä¸€ä¸ªï¼Œå¹¶å°† i åŠ å…¥ç»“æœæ•°ç»„ä¸­ã€‚æœ€ååˆ¤æ–­ç»“æœæ•°ç»„çš„é•¿åº¦æ˜¯å¦è¾¾åˆ°äº†åŸå§‹æ•°ç»„çš„ä¸€åŠï¼Œå¦‚æœè¾¾åˆ°äº†åˆ™è¿”å›ç»“æœæ•°ç»„çš„å‰ä¸€åŠï¼Œå¦åˆ™è¿”å›ç©ºæ•°ç»„ã€‚\nclass Solution: def findOriginalArray(self, changed: List[int]) -\u0026gt; List[int]: n = len(changed) if n\u0026amp;1: return [] d = defaultdict(int) res = [] cnt = 0 changed.sort() for i in changed: d[i]+=1 for i in changed: if not d[i]: continue x = i*2 if i==x: # 0*2 = 0 d[x]-=1 if d[x]: d[x]-=1 # åŒ¹é…æˆåŠŸ cnt+=1 res.append(i) else: if d[x]: d[x]-=1 # åŒ¹é…æˆåŠŸ d[i]-=1 cnt+=1 res.append(i) if cnt\u0026gt;=n//2: return res[:n//2] return [] å®ç°æ€è·¯ï¼šé¦–å…ˆä½¿ç”¨ Counter ç»Ÿè®¡æ•°ç»„ changed ä¸­å„ä¸ªå…ƒç´ çš„å‡ºç°æ¬¡æ•°ã€‚ç„¶åå°†å­—å…¸ä¸­é”®ä¸º 0 çš„å…ƒç´ ï¼ˆå¦‚æœå­˜åœ¨ï¼‰å¼¹å‡ºï¼Œå› ä¸ºåŸå§‹æ•°ç»„ä¸­ä¸å¯èƒ½æœ‰ 0ã€‚æ¥ç€åˆ¤æ–­å­—å…¸ä¸­é”®ä¸º 0 çš„å…ƒç´ å‡ºç°æ¬¡æ•°æ˜¯å¦ä¸ºå¶æ•°ï¼Œå¦‚æœä¸æ˜¯å¶æ•°åˆ™æ— æ³•æ„é€ åŸå§‹æ•°ç»„ï¼Œç›´æ¥è¿”å›ç©ºæ•°ç»„ã€‚ç„¶ååˆå§‹åŒ–ä¸€ä¸ªç”± 0 ç»„æˆçš„æ•°ç»„ ansï¼Œé•¿åº¦ä¸º cnt_0 çš„ä¸€åŠã€‚æ¥ä¸‹æ¥éå†å­—å…¸ä¸­çš„é”®å€¼å¯¹ï¼Œå¯¹äºæ¯ä¸ªé”® xï¼Œåˆ¤æ–­æ˜¯å¦å­˜åœ¨å…¶ä¸€åŠçš„é”®å€¼å¯¹ï¼Œå¹¶å°† x åŠ å…¥ç»“æœæ•°ç»„ ans ä¸­ç›¸åº”æ¬¡æ•°ã€‚æœ€åè¿”å›ç»“æœæ•°ç»„ ansã€‚\nclass Solution: def findOriginalArray(self, changed: List[int]) -\u0026gt; List[int]: cnt = Counter(changed) cnt_0 = cnt.pop(0, 0) if cnt_0\u0026amp;1: return [] ans = [0]*(cnt_0//2) for x in cnt: if x%2==0 and cnt[x//2]: continue while x in cnt: if cnt[2*x]\u0026lt;cnt[x]: return [] ans.extend([x]*(cnt[x])) if cnt[2*x]\u0026gt;cnt[x]: cnt[2*x]-=cnt[x] x*=2 else: x*=4 return ans 1883. å‡†æ—¶æŠµè¾¾ä¼šè®®ç°åœºçš„æœ€å°è·³è¿‡ä¼‘æ¯æ¬¡æ•° é¢˜ç›®å¤§æ„ï¼šé¢˜ç›®ç»™å‡ºäº†ä¸€ç»„é“è·¯çš„é•¿åº¦å’Œè¡Œé©¶é€Ÿåº¦ï¼Œä»¥åŠå‰©ä½™å¯ç”¨æ—¶é—´ã€‚è¦æ±‚è®¡ç®—åœ¨ç»™å®šçš„æ—¶é—´å†…ï¼Œæœ€å°‘è·³è¿‡ä¼‘æ¯æ¬¡æ•°ï¼Œä»¥å‡†æ—¶æŠµè¾¾ä¼šè®®ç°åœºã€‚\nå®ç°æ€è·¯ï¼šåŠ¨æ€è§„åˆ’ã€‚ä½¿ç”¨äºŒç»´æ•°ç»„dp[i][j]è¡¨ç¤ºåˆ°è¾¾ç¬¬iæ¡è·¯ï¼Œè·³è¿‡jæ¬¡ä¼‘æ¯çš„æœ€å°è·ç¦»ã€‚åˆå§‹åŒ–dpæ•°ç»„ï¼Œç„¶åéå†æ¯ä¸€æ¡è·¯ï¼Œåœ¨éå†çš„è¿‡ç¨‹ä¸­æ›´æ–°dpæ•°ç»„ã€‚æœ€åæ£€æŸ¥æ˜¯å¦æœ‰æ–¹æ¡ˆå¯ä»¥åœ¨è§„å®šæ—¶é—´å†…åˆ°è¾¾ä¼šè®®ç°åœºï¼Œå¦‚æœæœ‰ï¼Œè¿”å›è·³è¿‡ä¼‘æ¯çš„æœ€å°æ¬¡æ•°ï¼Œå¦åˆ™è¿”å›-1ã€‚\nclass Solution: def minSkips(self, dist: List[int], speed: int, hoursBefore: int) -\u0026gt; int: n = len(dist) if sum(dist) \u0026gt; hoursBefore * speed: return -1 dp = [[inf] * (n + 1) for _ in range(n + 1)] dp[0][0] = 0 for i in range(1, n): for j in range(i+1): # åˆ°ç¬¬iæ¡è·¯ï¼Œè·³è¿‡æ¬¡æ•°ä¸ºjçš„æœ€å°è·ç¦» # ä¸è·³è¿‡ç¬¬ i æ¡è·¯ dp[i][j] = min(dp[i][j], (dp[i-1][j] + dist[i-1] + speed -1)//speed*speed) # è·³è¿‡ç¬¬ i æ¡è·¯ if j: dp[i][j] = min(dp[i][j], dp[i - 1][j -1] + dist[i-1]) for j in range(n): # å¯ä»¥è·³0~n-1æ¬¡(æœ€åä¸€æ¡è¾¹ä¸ç”¨è·³) if dp[n-1][j]+dist[-1] \u0026lt;= hoursBefore * speed: return j return -1 39. ç»„åˆæ€»å’Œ é¢˜ç›®å¤§æ„ ï¼šç»™å®šä¸€ä¸ªæ— é‡å¤å…ƒç´ çš„æ•´æ•°æ•°ç»„ candidates å’Œä¸€ä¸ªç›®æ ‡æ•´æ•° targetï¼Œæ‰¾å‡º candidates ä¸­å¯ä»¥ä½¿æ•°å­—å’Œä¸ºç›®æ ‡æ•° target çš„æ‰€æœ‰ä¸åŒç»„åˆï¼Œå¹¶ä»¥åˆ—è¡¨å½¢å¼è¿”å›ã€‚å¯ä»¥æ— é™åˆ¶é‡å¤é€‰æ‹© candidates ä¸­çš„åŒä¸€ä¸ªæ•°å­—ã€‚\nå®ç°æ€è·¯ ï¼š\nä½¿ç”¨æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰è¿›è¡Œç»„åˆæœç´¢ã€‚ å®šä¹‰ä¸€ä¸ªè¾…åŠ©å‡½æ•° dfs(i, s)ï¼Œå…¶ä¸­ i è¡¨ç¤ºå½“å‰éå†åˆ°çš„ candidates æ•°ç»„çš„ç´¢å¼•ï¼Œs è¡¨ç¤ºå½“å‰å·²ç»é€‰å–çš„æ•°å­—çš„å’Œã€‚ åœ¨ dfs å‡½æ•°ä¸­ï¼Œå¦‚æœ s å¤§äºç­‰äº target æˆ–è€…å·²ç»éå†åˆ°æ•°ç»„æœ«å°¾ï¼Œåˆ™è¿›è¡Œä»¥ä¸‹åˆ¤æ–­ï¼š å¦‚æœ s ç­‰äº targetï¼Œåˆ™å°†å½“å‰çš„ç»„åˆ ls åŠ å…¥ç»“æœåˆ—è¡¨ ret ä¸­ã€‚ å¦‚æœ s å¤§äº target æˆ–è€…å·²ç»éå†åˆ°æ•°ç»„æœ«å°¾ï¼Œåˆ™ç›´æ¥è¿”å›ã€‚ åœ¨ dfs å‡½æ•°ä¸­ï¼Œåˆ†åˆ«å°è¯•ä¸¤ç§æƒ…å†µï¼š ä¸é€‰æ‹©å½“å‰æ•°å­—ï¼Œç»§ç»­å‘åæœç´¢ï¼šdfs(i+1, s)ã€‚ é€‰æ‹©å½“å‰æ•°å­—ï¼Œç»§ç»­å‘åæœç´¢ï¼šå°†å½“å‰æ•°å­—åŠ å…¥ç»„åˆ ls ä¸­ï¼Œæ›´æ–° sï¼Œå¹¶é€’å½’è°ƒç”¨ dfs(i, s+c[i])ã€‚ åœ¨é€’å½’è°ƒç”¨ä¹‹åï¼Œéœ€è¦å°†å½“å‰é€‰æ‹©çš„æ•°å­—ä»ç»„åˆ ls ä¸­å¼¹å‡ºï¼Œä¿è¯ä¸å½±å“åç»­æœç´¢ã€‚ æœ€ç»ˆè¿”å›ç»“æœåˆ—è¡¨ retã€‚ class Solution: def combinationSum(self, c: List[int], t: int) -\u0026gt; List[List[int]]: n = len(c) ret, ls = [], [] def dfs(i, s): if s\u0026gt;=t or i==n: if s==t: ret.append(ls[:]) return dfs(i+1, s) ls.append(c[i]) dfs(i, s+c[i]) ls.pop() dfs(0, 0) return ret 216. ç»„åˆæ€»å’Œ III é¢˜ç›®å¤§æ„ï¼šæ‰¾å‡ºæ‰€æœ‰ç›¸åŠ ä¹‹å’Œä¸ºnçš„kä¸ªæ•°çš„ç»„åˆï¼Œè¦æ±‚ä½¿ç”¨æ•°å­—1åˆ°9ï¼Œæ¯ä¸ªæ•°å­—æœ€å¤šä½¿ç”¨ä¸€æ¬¡ï¼Œè¿”å›æ‰€æœ‰å¯èƒ½çš„æœ‰æ•ˆç»„åˆçš„åˆ—è¡¨ã€‚åˆ—è¡¨ä¸èƒ½åŒ…å«ç›¸åŒçš„ç»„åˆä¸¤æ¬¡ï¼Œç»„åˆå¯ä»¥ä»¥ä»»ä½•é¡ºåºè¿”å›ã€‚\nå®ç°æ€è·¯ï¼šä½¿ç”¨æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰çš„æ–¹æ³•ï¼Œä»1åˆ°9çš„æ•°å­—ä¸­è¿›è¡Œéå†ï¼Œæ¯æ¬¡é€‰æ‹©ä¸€ä¸ªæ•°å­—æˆ–ä¸é€‰æ‹©ï¼Œç›´åˆ°æ»¡è¶³æ¡ä»¶ä¸ºæ­¢ã€‚é€’å½’è¿‡ç¨‹ä¸­ï¼Œç»´æŠ¤ä¸€ä¸ªåˆ—è¡¨lsï¼Œè®°å½•å½“å‰å·²é€‰æ•°å­—çš„é›†åˆï¼Œå¦‚æœå½“å‰é›†åˆçš„æ•°å­—ä¸ªæ•°ç­‰äºkä¸”å®ƒä»¬çš„å’Œç­‰äºnï¼Œåˆ™å°†å…¶åŠ å…¥ç»“æœåˆ—è¡¨retä¸­ã€‚\nclass Solution: def combinationSum3(self, k: int, n: int) -\u0026gt; List[List[int]]: ret, ls = [], [] def dfs(i, s, cnt): if i==10 or s\u0026gt;=n or cnt\u0026gt;=k: if s==n and cnt==k: ret.append(ls[:]) return dfs(i+1, s, cnt) ls.append(i) dfs(i+1, s+i, cnt+1) ls.pop() dfs(1, 0, 0) return ret 377. ç»„åˆæ€»å’Œ â…£ é¢˜ç›®å¤§æ„ï¼šç»™å®šä¸€ä¸ªç”±ä¸åŒæ•´æ•°ç»„æˆçš„æ•°ç»„numså’Œä¸€ä¸ªç›®æ ‡æ•´æ•°targetï¼Œè¦æ±‚ä»numsä¸­æ‰¾å‡ºæ€»å’Œä¸ºtargetçš„å…ƒç´ ç»„åˆçš„ä¸ªæ•°ã€‚\nå®ç°æ€è·¯ï¼šè¿™æ˜¯ä¸€ä¸ªå…¸å‹çš„åŠ¨æ€è§„åˆ’é—®é¢˜ã€‚ä½¿ç”¨é€’å½’+è®°å¿†åŒ–æœç´¢ï¼ˆMemoizationï¼‰çš„æ–¹æ³•æ¥è§£å†³ã€‚å®šä¹‰dfså‡½æ•°ï¼Œå‚æ•°ä¸ºå½“å‰çš„å’Œsï¼Œå‡½æ•°è¿”å›å½“å‰å’Œsèƒ½å¤Ÿç»„æˆçš„ç»„åˆæ•°ç›®ã€‚é€’å½’çš„ç»ˆæ­¢æ¡ä»¶æ˜¯å½“å‰å’Œså¤§äºç­‰äºç›®æ ‡targetï¼Œåˆ™è¿”å›1ï¼ˆå¦‚æœsç­‰äºtargetï¼Œåˆ™è¡¨ç¤ºæ‰¾åˆ°ä¸€ç§ç»„åˆï¼‰ã€‚å¦åˆ™ï¼Œéå†æ•°ç»„numsä¸­çš„æ¯ä¸ªæ•°ï¼Œå¯¹æ¯ä¸ªæ•°è¿›è¡Œé€’å½’è°ƒç”¨dfs(s+i)ï¼Œç´¯åŠ å¾—åˆ°çš„ç»„åˆæ•°ç›®ã€‚ä½¿ç”¨cacheè£…é¥°å™¨å¯¹dfså‡½æ•°è¿›è¡Œè®°å¿†åŒ–æœç´¢ï¼Œé¿å…é‡å¤è®¡ç®—ã€‚æœ€ç»ˆè¿”å›dfs(0)ï¼Œå³ä»åˆå§‹å’Œä¸º0å¼€å§‹çš„ç»„åˆæ•°ç›®ã€‚\nclass Solution: def combinationSum4(self, nums: List[int], target: int) -\u0026gt; int: @cache def dfs(s): if s\u0026gt;=target: if s==target: return 1 return 0 cnt = 0 for i in nums: cnt += dfs(s+i) return cnt return dfs(0) ","permalink":"https://kennems.github.io/posts/tech/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98202404/","summary":"æ¯æ—¥ä¸€é¢˜ï¼ˆ202404ï¼‰ 2009. ä½¿æ•°ç»„è¿ç»­çš„æœ€å°‘æ“ä½œæ•° é¢˜æ„ï¼šç»™å®šä¸€ä¸ªå¯èƒ½æœ‰é‡å¤å…ƒç´ çš„æ•°ç»„ï¼Œå¯ä»¥ä¿®æ”¹æ•°ç»„ä¸­å€¼ä¸ºä»»æ„å…¶ä»–å€¼ï¼Œé—®ä½¿æ•°ç»„è¿ç»­çš„æœ€å°æ“ä½œæ•°ã€‚","title":"LeetCodeæ¯æ—¥ä¸€é¢˜ï¼ˆ202404ï¼‰"},{"content":"å‰‘æŒ‡Offer æ•°æ®æµä¸­çš„ä¸­ä½æ•° ç”¨ä¸¤ä¸ªå †æ¨¡æ‹Ÿï¼Œ å·¦è¾¹å¤§é¡¶å †ï¼Œå³è¾¹å°é¡¶å †ï¼Œåˆ™ä¸¤ä¸ªå †é¡¶æ˜¯æœ€ä¸­é—´çš„æ•°å­—ã€‚\næ·»åŠ æ•°å­—æ—¶ï¼š\nå¦‚æœè¾“å…¥çš„æ˜¯ç¬¬å¥‡æ•°ä¸ªï¼ˆæ¯”å¦‚ç¬¬ä¸€ä¸ªï¼Œåˆ™Nåˆå§‹åŒ–ä¸º0ï¼Œæ’å…¥åNä¸º1ï¼Œä»£è¡¨ä¸€å…±æœ‰ä¸€ä¸ªæ•°å­—ï¼‰ï¼Œåˆ™å…ˆæ’å…¥å¤§é¡¶å †ï¼Œç„¶åæŠŠå †é¡¶æ’å…¥å°é¡¶å †ã€‚ä¿è¯å°é¡¶å †çš„ä»»æ„ä¸€ä¸ªå€¼éƒ½æ¯”å¤§é¡¶å †å¤§ã€‚ åŒæ ·ï¼Œå¦‚æœè¾“å…¥çš„æ˜¯ç¬¬å¶æ•°ä¸ªï¼ˆç¬¬äºŒä¸ªï¼‰ï¼Œåˆ™å…ˆæ’å…¥å°é¡¶å †ï¼Œç„¶åå°†å°é¡¶å †æœ€å°å€¼æ’å…¥å¤§é¡¶å †ã€‚åŒæ ·æ˜¯ä¿è¯å°é¡¶å †çš„ä»»æ„ä¸€ä¸ªå€¼éƒ½æ¯”å¤§é¡¶å †å¤§ã€‚ è‡³äºå…ˆæ’å…¥å“ªä¸€ä¸ªå †æ˜¯æ²¡æœ‰å…³ç³»çš„ï¼Œåªè¦ä¿è¯äº¤æ›¿æ’å…¥ä¸åŒçš„å †å³å¯ï¼Œå¹¶ä¸”è¦ç¡®ä¿è¾¹ç•Œé—®é¢˜ï¼ˆæ¯”å¦‚åœ¨å¥‡æ•°ä¸ªå…ƒç´ çš„çš„ä¸­ä½æ•°ï¼Œ åªæœ‰ä¸€ä¸ªæ•°æ®æ—¶åº”è¿”å›å…ˆæ’å…¥çš„å †é¡¶å€¼ï¼Œ å¦åˆ™å †ä¸ºç©ºä¼šæŠ¥é”™ï¼‰ã€‚\nimport heapq as hp class Solution: heapl = [] # å¤§æ ¹å † heapr = [] # å°æ ¹å † N = 0 def insert(self, num): \u0026#34;\u0026#34;\u0026#34; :type num: int :rtype: void \u0026#34;\u0026#34;\u0026#34; if self.N % 2 ==0: hp.heappush(self.heapl, -num) hp.heappush(self.heapr, -hp.heappop(self.heapl)) else: hp.heappush(self.heapr, num) hp.heappush(self.heapl, -hp.heappop(self.heapr)) self.N += 1 def getMedian(self): \u0026#34;\u0026#34;\u0026#34; :rtype: float \u0026#34;\u0026#34;\u0026#34; if self.N %2==0: return (-self.heapl[0]+self.heapr[0])/2.0 else: return self.heapr[0]*1.0 å­—ç¬¦æµä¸­ç¬¬ä¸€ä¸ªåªå‡ºç°ä¸€æ¬¡çš„å­—ç¬¦ import collections class Solution: d = collections.defaultdict(int) q = collections.deque() def firstAppearingOnce(self): \u0026#34;\u0026#34;\u0026#34; :rtype: str \u0026#34;\u0026#34;\u0026#34; return \u0026#39;#\u0026#39; if not self.q else self.q[0] def insert(self, char): \u0026#34;\u0026#34;\u0026#34; :type char: str :rtype: void \u0026#34;\u0026#34;\u0026#34; self.d[char]+=1 self.q.append(char) while self.q and self.d[self.q[0]]\u0026gt;1: self.q.popleft() æœ€é•¿ä¸å«é‡å¤å­—ç¬¦çš„å­å­—ç¬¦ä¸² class Solution: def longestSubstringWithoutDuplication(self, s): \u0026#34;\u0026#34;\u0026#34; :type s: str :rtype: int \u0026#34;\u0026#34;\u0026#34; char_index = {} # å­˜å‚¨å­—ç¬¦çš„æœ€è¿‘å‡ºç°ä½ç½® ans = 0 start = 0 for i, char in enumerate(s): if char in char_index and char_index[char] \u0026gt;= start: start = char_index[char] + 1 char_index[char] = i ans = max(ans, i - start + 1) return ans éª°å­çš„ç‚¹æ•° çº¿æ€§DP ï¼š\næ³¨æ„ç‚¹ï¼š ç®—æ³•å…ˆä»æœ€ç®€å•çš„æ–¹æ³•æƒ³èµ·ï¼ŒDPå…ˆç”¨äºŒç»´æƒ³ï¼Œå®ç°å®Œä¹‹åå†ä¼˜åŒ–ã€‚\nå› ä¸ºæ¯æ¬¡è®¡ç®—çŠ¶æ€æ—¶ä¼šä¿®æ”¹$ j-1, j-2, j-3, j-4, j-5, j-6$, è€Œ$j+1$ä¼šè®¡ç®— $j+1-1=j, j+1-2=j-1, \u0026hellip; j-1$ä¼šè®¡ç®—$j-1-1=j-2,j-1-2=j-3,\u0026hellip;$æ²¡æœ‰å•è°ƒæ€§ï¼Œæ‰€ä»¥ä¸èƒ½ä¼˜åŒ–ç¬¬ä¸€ç»´ç©ºé—´\nclass Solution(object): def numberOfDice(self, n): \u0026#34;\u0026#34;\u0026#34; :type n: int :rtype: List[int] \u0026#34;\u0026#34;\u0026#34; N = 6*n+10 f = [[0]*N for _ in range(N)] f[0][0]=1 for i in range(1,n+1): for j in range(1,n*6+1): for k in range(1,min(j, 6)+1): f[i][j] += f[i-1][j-k] return f[n][1*n:6*n+1] æ•°ç»„ä¸­æ•°å€¼å’Œä¸‹æ ‡ç›¸ç­‰çš„å…ƒç´  class Solution(object): def getNumberSameAsIndex(self, nums): \u0026#34;\u0026#34;\u0026#34; :type nums: List[int] :rtype: int \u0026#34;\u0026#34;\u0026#34; l, r = 0, len(nums)-1 while l\u0026lt;r: mid = l+r+1\u0026gt;\u0026gt;1 if nums[mid]\u0026gt;mid: r=mid-1 elif nums[mid]\u0026lt;mid: l=mid else: return mid break return l if nums[l]==l else -1 å¤æ‚é“¾è¡¨çš„å¤åˆ» class Solution(object): def copyRandomList(self, head): hash = {} hash[None] = None cloneHead = ListNode(-1) cur = cloneHead while head: if head not in hash: hash[head] = ListNode(head.val) if head.random not in hash: hash[head.random] = ListNode(head.random.val) cur.next = hash[head] cur = cur.next cur.random = hash[head.random] head = head.next return cloneHead.next çŸ©é˜µä¸­çš„è·¯å¾„ class Solution(object): def hasPath(self, matrix, string): if not matrix or not(matrix[0]): return False dx = [1, 0, -1, 0] dy = [0, 1, 0, -1] def dfs(x, y, idx): if matrix[x][y]!=string[idx]: return False if idx==len(string)-1: return True for h,v in zip(dx, dy): xx, yy = x+h, y+v if xx\u0026lt;0 or xx\u0026gt;=len(matrix) or yy\u0026lt;0 or yy\u0026gt;=len(matrix[0]): continue memo = matrix[x][y] matrix[x][y] = \u0026#39;#\u0026#39; if dfs(xx,yy,idx+1): return True matrix[x][y] = memo return False for i in range(len(matrix)): for j in range(len(matrix[0])): if matrix[i][j]==string[0]: if dfs(i,j,0): return True return False æ­£åˆ™è¡¨è¾¾å¼åŒ¹é… DP:\nclass Solution(object): def isMatch(self, s, p): \u0026#34;\u0026#34;\u0026#34; :type s: str :type p: str :rtype: bool \u0026#34;\u0026#34;\u0026#34; n, m = len(s), len(p) s, p = \u0026#39; \u0026#39;+s, \u0026#39; \u0026#39;+p f = [[False]*(m+1) for _ in range(n+1)] f[0][0] = True for i in range(2,m+1): if p[i]==\u0026#39;*\u0026#39;: f[0][i] = f[0][i-2] for i in range(1,n+1): for j in range(1,m+1): if s[i]==p[j] or p[j]==\u0026#39;.\u0026#39;: f[i][j] = f[i-1][j-1] elif p[j]==\u0026#39;*\u0026#39;: if s[i]==p[j-1] or p[j-1]==\u0026#39;.\u0026#39;: f[i][j] = f[i-1][j] f[i][j] |= f[i][j-2] return f[n][m] LCR 168. ä¸‘æ•° é¢˜ç›®å¤§æ„ï¼šç»™å®šä¸€ä¸ªæ•´æ•° $n$ï¼Œæ‰¾å‡ºå¹¶è¿”å›ç¬¬ $n$ ä¸ªä¸‘æ•°ã€‚ä¸‘æ•°æ˜¯åªåŒ…å«è´¨å› æ•°$ 2$ã€$3$ å’Œ/æˆ– 5 çš„æ­£æ•´æ•°ï¼Œ$1$ æ˜¯ä¸‘æ•°ã€‚\nå®ç°æ€è·¯ï¼š\nåˆå§‹åŒ–ä¸€ä¸ªæ•°ç»„ $f$ï¼Œç”¨äºå­˜å‚¨å‰$ n$ ä¸ªä¸‘æ•°ï¼Œåˆå§‹åŒ– $f[1] = 1$ã€‚ åˆå§‹åŒ–ä¸‰ä¸ªæŒ‡é’ˆ $i2$ã€$i3$ã€$i5$ï¼Œåˆ†åˆ«è¡¨ç¤ºä¸‹ä¸€ä¸ªä¸‘æ•°æ˜¯é€šè¿‡ä¹˜ä»¥$2ã€3ã€5$å¾—åˆ°çš„ã€‚ åˆå§‹åŒ–ä¸‰ä¸ªå˜é‡ $n2ã€n3ã€n5$ï¼Œåˆ†åˆ«è¡¨ç¤ºé€šè¿‡æŒ‡é’ˆ $i2ã€i3ã€i5$ å¾—åˆ°çš„ä¸‹ä¸€ä¸ªä¸‘æ•°çš„å€™é€‰å€¼ã€‚ ä»ç¬¬$ 2 $ä¸ªä¸‘æ•°å¼€å§‹éå†åˆ°ç¬¬ $n $ä¸ªä¸‘æ•°ï¼š è®¡ç®—ä¸‹ä¸€ä¸ªä¸‘æ•°çš„å€™é€‰å€¼ï¼š$n2=f[i2]*2$ï¼Œ$n3=f[i3]*3$ï¼Œ$n5=f[i5]*5$ã€‚ å°†ä¸‹ä¸€ä¸ªä¸‘æ•°æ›´æ–°ä¸ºä¸‰ä¸ªå€™é€‰å€¼ä¸­çš„æœ€å°å€¼ï¼š$f[i]=min(n2,n3,n5)$ã€‚ å¦‚æœæœ€å°å€¼ç­‰äº $n2$ï¼Œåˆ™æŒ‡é’ˆ $i2$ å¾€åç§»åŠ¨ä¸€ä½ï¼›å¦‚æœæœ€å°å€¼ç­‰äº $n3$ï¼Œåˆ™æŒ‡é’ˆ $i3$ å¾€åç§»åŠ¨ä¸€ä½ï¼›å¦‚æœæœ€å°å€¼ç­‰äº $n5$ï¼Œåˆ™æŒ‡é’ˆ i5 å¾€åç§»åŠ¨ä¸€ä½ã€‚ éå†ç»“æŸåï¼Œè¿”å›ç¬¬ $n$ ä¸ªä¸‘æ•°$ f[n]$ã€‚ class Solution: def nthUglyNumber(self, n: int) -\u0026gt; int: if n\u0026lt;=6: return n f=[0 for _ in range(n+1)] f[1]=1 i2,i3,i5,n2,n3,n5=1,1,1,0,0,0 for i in range(2,n+1): n2,n3,n5=f[i2]*2,f[i3]*3,f[i5]*5 f[i]=min(n2,n3,n5) if f[i]==n2: i2+=1 if f[i]==n3: i3+=1 if f[i]==n5: i5+=1 return f[n] ","permalink":"https://kennems.github.io/posts/tech/%E5%89%91%E6%8C%87offer/","summary":"å‰‘æŒ‡Offer æ•°æ®æµä¸­çš„ä¸­ä½æ•° ç”¨ä¸¤ä¸ªå †æ¨¡æ‹Ÿï¼Œ å·¦è¾¹å¤§é¡¶å †ï¼Œå³è¾¹å°é¡¶å †ï¼Œåˆ™ä¸¤ä¸ªå †é¡¶æ˜¯æœ€ä¸­é—´çš„æ•°å­—ã€‚ æ·»åŠ æ•°å­—æ—¶ï¼š å¦‚æœè¾“å…¥çš„æ˜¯ç¬¬å¥‡æ•°ä¸ªï¼ˆæ¯”å¦‚ç¬¬ä¸€ä¸ªï¼Œ","title":"å‰‘æŒ‡Offer"},{"content":"Java20å¤©é€Ÿæˆâ€”â€”è¿›é˜¶è¯¾ç¨‹(2) æ­£åˆ™è¡¨è¾¾å¼ ç¬¦å· å«ä¹‰ ä¸¾ä¾‹ [] åŒ¹é…æ–¹æ‹¬å·å†…çš„ä»»ä¸€å­—ç¬¦ [abc] ^ åŒ¹é…é™¤æŒ‡å®šå­—ç¬¦å¤–çš„ä»»æ„å­—ç¬¦ [^abc] \u0026amp;\u0026amp; åŒ¹é…ä¸¤ä¸ªå­—ç¬¦é›†çš„äº¤é›†ï¼Œéœ€ä½œä¸ºæ•´ä½“å‡ºç° [a-z\u0026amp;\u0026amp;m-p] . åŒ¹é…é™¤æ¢è¡Œç¬¦å¤–çš„ä»»æ„å­—ç¬¦ a.b ï¼ˆåŒ¹é… \u0026ldquo;a\u0026rdquo; åæ¥ä»»æ„å­—ç¬¦ï¼Œå†æ¥ \u0026ldquo;b\u0026rdquo;ï¼‰ \\ è½¬ä¹‰å­—ç¬¦ï¼Œç”¨äºåŒ¹é…ç‰¹æ®Šå­—ç¬¦ \\\\d \\\\d åŒ¹é…æ•°å­— 0-9 \\\\d+ \\\\D åŒ¹é…éæ•°å­—å­—ç¬¦ \\\\D+ \\\\s åŒ¹é…ç©ºç™½å­—ç¬¦ \\såŒ¹é…ç©ºæ ¼ã€åˆ¶è¡¨ç¬¦ã€æ¢è¡Œç¬¦ç­‰ç­‰ \\\\S åŒ¹é…éç©ºç™½å­—ç¬¦ \\\\S+ ï¼ˆåŒ¹é…éç©ºç™½å­—ç¬¦åºåˆ—ï¼‰ \\\\w åŒ¹é…å•è¯å­—ç¬¦ [a-zA-Z_0-9] \\\\W åŒ¹é…éå•è¯å­—ç¬¦ [^\\w] * åŒ¹é…å‰é¢çš„å…ƒç´ é›¶æ¬¡æˆ–å¤šæ¬¡ï¼Œå³å¯æœ‰å¯æ—  a*b ï¼ˆåŒ¹é… \u0026ldquo;b\u0026rdquo;ã€\u0026ldquo;ab\u0026rdquo;ã€\u0026ldquo;aab\u0026rdquo;ã€ç­‰ç­‰ï¼‰ ? åŒ¹é…å‰é¢çš„å…ƒç´ é›¶æ¬¡æˆ–ä¸€æ¬¡ï¼Œå³å¯æœ‰å¯æ—  colou?r ï¼ˆåŒ¹é… \u0026ldquo;color\u0026rdquo; æˆ– \u0026ldquo;colour\u0026rdquo;ï¼‰ () åˆ†ç»„ï¼Œå°†å…¶ä¸­çš„å­—ç¬¦è§†ä¸ºä¸€ä¸ªå•å…ƒ a(bc)+ \\f åŒ¹é…æ¢é¡µç¬¦ \\f | `|` | æˆ–ï¼Œç”¨äºåŒ¹é…å¤šä¸ªæ¨¡å¼ä¸­çš„ä»»æ„ä¸€ä¸ª | `ab\\|AB` | public static void method1() { // ç»™å®šçš„å­—ç¬¦ä¸²åŒ…å«äº†ç”µè¯å·ç å’Œé‚®ç®±åœ°å€çš„ä¿¡æ¯ String data = \u0026#34; æ¥é»‘é©¬ç¨‹åºå‘˜å­¦ä¹ Javaï¼Œ\\n\u0026#34; + \u0026#34; ç”µè¯ï¼š1866668888ï¼Œ18699997777\\n\u0026#34; + \u0026#34; æˆ–è€…è”ç³»é‚®ç®±ï¼šboniu@itcast.cnï¼Œ\\n\u0026#34; + \u0026#34; åº§æœºç”µè¯ï¼š01036517895ï¼Œ010-98951256\\n\u0026#34; + \u0026#34; é‚®ç®±ï¼šbozai@itcast.cnï¼Œ\\n\u0026#34; + \u0026#34; é‚®ç®±ï¼šdlei0009@163.comï¼Œ\\n\u0026#34; + \u0026#34; çƒ­çº¿ç”µè¯ï¼š400-618-9090 ï¼Œ400-618-4000ï¼Œ4006184000ï¼Œ4006189090\u0026#34;; // å®šä¹‰æ­£åˆ™è¡¨è¾¾å¼æ¥åŒ¹é…ç”µè¯å·ç å’Œé‚®ç®±åœ°å€ String regex = \u0026#34;(1[3-9]\\\\d{9})|\u0026#34; + \u0026#34;(0\\\\d{2,9}-?\\\\d{7,18})|\u0026#34; // åŒ¹é…å›ºå®šç”µè¯å·ç ï¼ŒåŒ…æ‹¬åŒºå·å’Œåˆ†æœºå· + \u0026#34;(\\\\w{2,}@\\\\w{2,20}(\\\\.\\\\w{2,10}){1,2})|\u0026#34; // åŒ¹é…é‚®ç®±åœ°å€ + \u0026#34;(400-?\\\\d{3,7}-?\\\\d{3,7})\u0026#34;; // åŒ¹é…400ç”µè¯å·ç ï¼ŒåŒ…æ‹¬å¯èƒ½çš„åˆ†æœºå· // ç¼–è¯‘æ­£åˆ™è¡¨è¾¾å¼ Pattern pattern = Pattern.compile(regex); // åˆ›å»ºåŒ¹é…å™¨å¯¹è±¡ Matcher matcher = pattern.matcher(data); // å¾ªç¯æŸ¥æ‰¾åŒ¹é…é¡¹å¹¶æ‰“å° while(matcher.find()){ String res = matcher.group(); // è·å–åŒ¹é…åˆ°çš„å­—ç¬¦ä¸² System.out.println(res); } } String s1 = \u0026#34;å¤åŠ›å¨œæ‰ai8888è¿ªä¸½çƒ­å·´999aa5566é©¬å°”æ‰å“ˆfbbfsfs42425å¡å°”æ‰å·´\u0026#34;; System.out.println(s1.replaceAll(\u0026#34;\\\\w+\u0026#34;, \u0026#34;-\u0026#34;)); String s2 = \u0026#34;æˆ‘æˆ‘æˆ‘å–œæ¬¢ç¼–ç¼–ç¼–ç¼–ç¼–ç¼–ç¼–ç¼–ç¼–ç¼–ç¼–ç¼–ç¨‹ç¨‹ç¨‹\u0026#34;; System.out.println(s2.replaceAll(\u0026#34;(.)\\\\1+\u0026#34;, \u0026#34;$1\u0026#34;)); String s3 = \u0026#34;å¤åŠ›å¨œæ‰ai8888è¿ªä¸½çƒ­å·´999aa5566é©¬å°”æ‰å“ˆfbbfsfs42425å¡å°”æ‰å·´\u0026#34;; String[] names = s3.split(\u0026#34;\\\\w+\u0026#34;); System.out.println(Arrays.toString(names)); å¼‚å¸¸ Errorï¼š ä»£è¡¨çš„ç³»ç»Ÿçº§åˆ«é”™è¯¯ï¼ˆå±äºä¸¥é‡é—®é¢˜ï¼‰ï¼Œ ä¹Ÿå°±æ˜¯è¯´ç³»ç»Ÿä¸€æ—¦å‡ºç°é—®é¢˜ï¼Œsunå…¬å¸ä¼šæŠŠè¿™äº›é—®é¢˜å°è£…æˆErrorå¯¹è±¡ç»™å‡ºäº†ï¼Œå³Erroræ˜¯Sunå…¬å¸è‡ªå·±ç”¨çš„ï¼Œè€Œä¸æ˜¯ç»™ç¨‹åºå‘˜ç”¨çš„\nExceptionï¼šå¼‚å¸¸ï¼Œå®ƒä»£è¡¨çš„æ‰æ˜¯ç¨‹åºå¯èƒ½å‡ºç°çš„é”™è¯¯ï¼Œæ‰€ä»¥é€šå¸¸ä¼šç”¨Exceptionä»¥åŠå®ƒçš„å­ç±»æ¥å°è£…ç¨‹åºå‡ºç°çš„é”™è¯¯\nè¿è¡Œæ—¶å¼‚å¸¸ï¼šRuntimeExceptionåŠå…¶å­ç±»ï¼Œç¼–è¯‘é˜¶æ®µä¸ä¼šå‡ºç°é”™è¯¯æé†’ï¼Œè¿è¡Œæ—¶å‡ºç°çš„å¼‚å¸¸ï¼ˆæ•°ç»„ç´¢å¼•è¶Šç•Œå¼‚å¸¸ï¼‰ ç¼–è¯‘æ—¶å¼‚å¸¸ï¼šç¼–è¯‘é˜¶æ®µå°±ä¼šå‡ºç°çš„é”™è¯¯æé†’ã€‚ï¼ˆæ—¥æœŸè§£æå¼‚å¸¸ï¼‰ è‡ªå®šä¹‰å¼‚å¸¸ è¿è¡Œæ—¶å¼‚å¸¸ package com.showguan.Exception; // è‡ªå®šä¹‰è¿è¡Œæ—¶å¼‚å¸¸ç±»ï¼Œç”¨äºè¡¨ç¤ºå¹´é¾„ä¸åˆæ³•çš„æƒ…å†µ public class AgeIllegalRuntimeException extends RuntimeException { // é»˜è®¤æ„é€ å‡½æ•° public AgeIllegalRuntimeException() { } // å¸¦æœ‰æ¶ˆæ¯å‚æ•°çš„æ„é€ å‡½æ•°ï¼Œç”¨äºä¼ é€’å¼‚å¸¸ä¿¡æ¯ public AgeIllegalRuntimeException(String message) { super(message); } } public class Main { // ä¿å­˜å¹´é¾„çš„æ–¹æ³•ï¼Œå¦‚æœå¹´é¾„ä¸åˆæ³•åˆ™æŠ›å‡ºè‡ªå®šä¹‰çš„è¿è¡Œæ—¶å¼‚å¸¸ public static void saveAge(int age) { if (age \u0026gt; 0 \u0026amp;\u0026amp; age \u0026lt; 150) { System.out.println(\u0026#34;å¹´é¾„åˆæ³•\u0026#34;); } else { throw new AgeIllegalRuntimeException(\u0026#34;/age is illegal, your age is \u0026#34; + age); } } public static void main(String[] args) { try { // è°ƒç”¨ä¿å­˜å¹´é¾„çš„æ–¹æ³•ï¼Œä¼ å…¥ä¸€ä¸ªä¸åˆæ³•çš„å¹´é¾„å€¼ saveAge(-1); System.out.println(\u0026#34;åº•å±‚æ‰§è¡ŒæˆåŠŸäº†\u0026#34;); } catch (Exception e) { // æ•è·è‡ªå®šä¹‰çš„å¼‚å¸¸å¹¶æ‰“å°å¼‚å¸¸ä¿¡æ¯ e.printStackTrace(); System.out.println(\u0026#34;åº•å±‚å‡ºç°äº†å¼‚å¸¸\u0026#34;); } } } ç¼–è¯‘æ—¶å¼‚å¸¸ package com.showguan.Exception; // è‡ªå®šä¹‰å¼‚å¸¸ç±»ï¼Œç»§æ‰¿è‡ªExceptionç±»ï¼Œç”¨äºè¡¨ç¤ºå¹´é¾„ä¸åˆæ³•çš„æƒ…å†µ public class AgeIllegalException extends Exception { // é»˜è®¤æ„é€ å‡½æ•° public AgeIllegalException() { } // å¸¦æœ‰æ¶ˆæ¯å‚æ•°çš„æ„é€ å‡½æ•°ï¼Œç”¨äºä¼ é€’å¼‚å¸¸ä¿¡æ¯ public AgeIllegalException(String message) { super(message); } } public class Main { // ä¿å­˜å¹´é¾„çš„æ–¹æ³•ï¼Œå¦‚æœå¹´é¾„ä¸åˆæ³•åˆ™æŠ›å‡ºè‡ªå®šä¹‰çš„å—æ£€æŸ¥å¼‚å¸¸ public static void saveAge2(int age) throws AgeIllegalException { if (age \u0026gt; 0 \u0026amp;\u0026amp; age \u0026lt; 150) { System.out.println(\u0026#34;å¹´é¾„åˆæ³•\u0026#34;); } else { throw new AgeIllegalException(\u0026#34;/age is illegal, your age is \u0026#34; + age); } } public static void main(String[] args) { try { // è°ƒç”¨ä¿å­˜å¹´é¾„çš„æ–¹æ³•ï¼Œä¼ å…¥ä¸€ä¸ªåˆæ³•çš„å¹´é¾„å€¼ saveAge2(1); System.out.println(\u0026#34;åº•å±‚æ‰§è¡ŒæˆåŠŸäº†\u0026#34;); } catch (Exception e) { // æ•è·è‡ªå®šä¹‰çš„å¼‚å¸¸å¹¶æ‰“å°å¼‚å¸¸ä¿¡æ¯ e.printStackTrace(); System.out.println(\u0026#34;åº•å±‚å‡ºç°äº†å¼‚å¸¸\u0026#34;); } } } public class Demo2 { public static void main(String[] args) { try { // è°ƒç”¨test1æ–¹æ³•ï¼Œè¯¥æ–¹æ³•å£°æ˜äº†å¯èƒ½æŠ›å‡ºParseExceptionå’ŒFileNotFoundExceptionå¼‚å¸¸ test1(); } catch (ParseException e) { // æ•è·ParseExceptionå¼‚å¸¸ï¼Œå¹¶è¾“å‡ºé”™è¯¯æç¤ºä¿¡æ¯ System.out.println(\u0026#34;æ—¥æœŸæ ¼å¼é”™è¯¯ï¼Œè¯·æ£€æŸ¥æ—¥æœŸæ ¼å¼\u0026#34;); // æŠ›å‡ºä¸€ä¸ªæ–°çš„RuntimeExceptionå¼‚å¸¸ï¼Œå°†åŸå§‹å¼‚å¸¸ä½œä¸ºå…¶cause throw new RuntimeException(e); } catch (FileNotFoundException e) { // æ•è·FileNotFoundExceptionå¼‚å¸¸ï¼Œå¹¶è¾“å‡ºé”™è¯¯æç¤ºä¿¡æ¯ System.out.println(\u0026#34;æŒ‡å®šæ–‡ä»¶å¤¹å†…æ²¡æœ‰è¯¥æ–‡ä»¶ï¼Œè¯·æ£€æŸ¥æ–‡ä»¶è·¯å¾„\u0026#34;); // æŠ›å‡ºä¸€ä¸ªæ–°çš„RuntimeExceptionå¼‚å¸¸ï¼Œå°†åŸå§‹å¼‚å¸¸ä½œä¸ºå…¶cause throw new RuntimeException(e); } } // test1æ–¹æ³•å£°æ˜äº†å¯èƒ½æŠ›å‡ºParseExceptionå’ŒFileNotFoundExceptionå¼‚å¸¸ public static void test1() throws ParseException, FileNotFoundException { // åˆ›å»ºSimpleDateFormatå¯¹è±¡ï¼Œç”¨äºè§£ææ—¥æœŸå­—ç¬¦ä¸² SimpleDateFormat sdf = new SimpleDateFormat(\u0026#34;yyyy-MM-dd HH:mm:ss\u0026#34;); // è§£ææ—¥æœŸå­—ç¬¦ä¸²ï¼Œå¦‚æœæ—¥æœŸæ ¼å¼ä¸æ­£ç¡®ä¼šæŠ›å‡ºParseExceptionå¼‚å¸¸ Date d = sdf.parse(\u0026#34;2077-09-23 10:34:22\u0026#34;); System.out.println(d); // è°ƒç”¨test2æ–¹æ³•ï¼Œè¯¥æ–¹æ³•å£°æ˜äº†å¯èƒ½æŠ›å‡ºFileNotFoundExceptionå¼‚å¸¸ test2(); } // test2æ–¹æ³•å£°æ˜äº†å¯èƒ½æŠ›å‡ºFileNotFoundExceptionå¼‚å¸¸ public static void test2() throws FileNotFoundException { // åˆ›å»ºFileInputStreamå¯¹è±¡ï¼Œå¦‚æœæŒ‡å®šæ–‡ä»¶ä¸å­˜åœ¨ä¼šæŠ›å‡ºFileNotFoundExceptionå¼‚å¸¸ InputStream is = new FileInputStream(\u0026#34;D:/Java.txt\u0026#34;); } } package com.showguan.Exception; import java.io.FileInputStream; import java.io.FileNotFoundException; import java.io.InputStream; import java.text.ParseException; import java.text.SimpleDateFormat; import java.util.Date; public class Demo3 { public static void main(String[] args) { try { // è°ƒç”¨test1æ–¹æ³•ï¼Œè¯¥æ–¹æ³•å£°æ˜äº†å¯èƒ½æŠ›å‡ºExceptionå¼‚å¸¸ test1(); } catch (Exception e) { // æ•è·Exceptionå¼‚å¸¸ï¼Œå¹¶è¾“å‡ºé”™è¯¯æç¤ºä¿¡æ¯ System.out.println(\u0026#34;æ“ä½œæœ‰è¯¯\u0026#34;); // æŠ›å‡ºä¸€ä¸ªæ–°çš„RuntimeExceptionå¼‚å¸¸ï¼Œå°†åŸå§‹å¼‚å¸¸ä½œä¸ºå…¶cause throw new RuntimeException(e); } } // test1æ–¹æ³•å£°æ˜äº†å¯èƒ½æŠ›å‡ºExceptionå¼‚å¸¸ public static void test1() throws Exception { // åˆ›å»ºSimpleDateFormatå¯¹è±¡ï¼Œç”¨äºè§£ææ—¥æœŸå­—ç¬¦ä¸² SimpleDateFormat sdf = new SimpleDateFormat(\u0026#34;yyyy-MM-dd HH:mm:ss\u0026#34;); // è§£ææ—¥æœŸå­—ç¬¦ä¸²ï¼Œå¦‚æœæ—¥æœŸæ ¼å¼ä¸æ­£ç¡®ä¼šæŠ›å‡ºParseExceptionå¼‚å¸¸ Date d = sdf.parse(\u0026#34;2077-09-23 10:34:22\u0026#34;); System.out.println(d); // è°ƒç”¨test2æ–¹æ³•ï¼Œè¯¥æ–¹æ³•å£°æ˜äº†å¯èƒ½æŠ›å‡ºExceptionå¼‚å¸¸ test2(); } // test2æ–¹æ³•å£°æ˜äº†å¯èƒ½æŠ›å‡ºExceptionå¼‚å¸¸ public static void test2() throws Exception { // åˆ›å»ºFileInputStreamå¯¹è±¡ï¼Œå¦‚æœæŒ‡å®šæ–‡ä»¶ä¸å­˜åœ¨ä¼šæŠ›å‡ºFileNotFoundExceptionå¼‚å¸¸ InputStream is = new FileInputStream(\u0026#34;D:/Java.txt\u0026#34;); } } é›†åˆ Collectioné›†åˆç‰¹ç‚¹ï¼š\nListç³»åˆ—é›†åˆï¼šæ·»åŠ çš„å…ƒç´ æ˜¯æœ‰åºã€å¯é‡å¤ã€æœ‰ç´¢å¼•çš„ã€‚\nArrayList, LinkedListï¼šæœ‰åºã€å¯é‡å¤ã€æœ‰ç´¢å¼• Setç³»åˆ—é›†åˆï¼šæ·»åŠ çš„å…ƒç´ æ˜¯æ— åºã€ä¸é‡å¤ã€æ— ç´¢å¼•\nHashSet: æ— åºã€ä¸é‡å¤ã€æ— ç´¢å¼• LinkedHashSet: æœ‰åºã€ä¸é‡å¤ã€æ— ç´¢å¼• TreeSet : æŒ‰ç…§å¤§å°é»˜è®¤å‡åºæ’åˆ—ã€ä¸é‡å¤ã€æ— ç´¢å¼• Collection import java.util.ArrayList; import java.util.Arrays; import java.util.Collection; public class Main { public static void main(String[] args) { // åˆ›å»ºä¸€ä¸ªArrayListå¯¹è±¡ï¼Œå¹¶å‘å…¶ä¸­æ·»åŠ å…ƒç´  Collection\u0026lt;String\u0026gt; c = new ArrayList\u0026lt;\u0026gt;(); c.add(\u0026#34;java1\u0026#34;); c.add(\u0026#34;java2\u0026#34;); c.add(\u0026#34;java3\u0026#34;); c.add(\u0026#34;java1\u0026#34;); // å¯ä»¥æ·»åŠ é‡å¤å…ƒç´  System.out.println(c); // è¾“å‡ºé›†åˆä¸­çš„æ‰€æœ‰å…ƒç´  // æ¸…ç©ºé›†åˆä¸­çš„æ‰€æœ‰å…ƒç´  // c.clear(); System.out.println(c); // åˆ¤æ–­é›†åˆæ˜¯å¦ä¸ºç©º System.out.println(c.isEmpty()); // è·å–é›†åˆä¸­å…ƒç´ çš„ä¸ªæ•° System.out.println(c.size()); // åˆ¤æ–­é›†åˆæ˜¯å¦åŒ…å«æŒ‡å®šå…ƒç´  System.out.println(c.contains(\u0026#34;java1\u0026#34;)); // ç§»é™¤é›†åˆä¸­çš„æŒ‡å®šå…ƒç´  c.remove(\u0026#34;java1\u0026#34;); System.out.println(c); // å°†é›†åˆè½¬æ¢ä¸ºæ•°ç»„ Object[] arr = c.toArray(); System.out.println(Arrays.toString(arr)); // å°†é›†åˆè½¬æ¢ä¸ºæŒ‡å®šç±»å‹çš„æ•°ç»„ String[] arr2 = c.toArray(new String[c.size()]); System.out.println(Arrays.toString(arr2)); // åˆ›å»ºå¦ä¸€ä¸ªé›†åˆï¼Œå¹¶å°†å…¶å…ƒç´ å…¨éƒ¨æ·»åŠ åˆ°å½“å‰é›†åˆä¸­ Collection\u0026lt;String\u0026gt; c2 = new ArrayList\u0026lt;\u0026gt;(); c2.add(\u0026#34;Java8\u0026#34;); c2.add(\u0026#34;java9\u0026#34;); c.addAll(c2); System.out.println(c); } } è¿­ä»£å™¨ import java.util.ArrayList; import java.util.Collection; import java.util.function.Consumer; public class Main { public static void main(String[] args) { // åˆ›å»ºä¸€ä¸ª ArrayList é›†åˆå¯¹è±¡ Collection\u0026lt;String\u0026gt; c = new ArrayList\u0026lt;\u0026gt;(); // å‘é›†åˆä¸­æ·»åŠ å…ƒç´  c.add(\u0026#34;Kennem\u0026#34;); c.add(\u0026#34;999\u0026#34;); c.add(\u0026#34;show\u0026#34;); // ä½¿ç”¨ forEach æ–¹æ³•éå†é›†åˆï¼Œä¼ ç»Ÿæ–¹å¼ c.forEach(new Consumer\u0026lt;String\u0026gt;() { @Override public void accept(String s) { System.out.println(s); } }); // ä½¿ç”¨ Lambda è¡¨è¾¾å¼éå†é›†åˆï¼ŒLambda å‚æ•°ç±»å‹æ¨æ–­ c.forEach((String s) -\u0026gt; { System.out.println(s); }); // ä½¿ç”¨ Lambda è¡¨è¾¾å¼éå†é›†åˆï¼Œç®€åŒ–å‚æ•°ç±»å‹ c.forEach((String s) -\u0026gt; System.out.println(s)); // ä½¿ç”¨æ–¹æ³•å¼•ç”¨éå†é›†åˆï¼Œç­‰åŒäº Lambda è¡¨è¾¾å¼ System.out::println c.forEach( System.out::println ) ; } } public class Main { public static void main(String[] args) { // åˆ›å»ºä¸€ä¸ª Movie ç±»å‹çš„é›†åˆå¯¹è±¡ Collection\u0026lt;Movie\u0026gt; movies = new ArrayList\u0026lt;\u0026gt;(); // å‘é›†åˆä¸­æ·»åŠ  Movie å¯¹è±¡ movies.add(new Movie(\u0026#34;ã€Šé˜¿ç”˜æ­£ä¼ ã€‹\u0026#34;, 9.5, \u0026#34;æ±¤å§†\u0026#34;)); // æ‰“å°é›†åˆå†…å®¹ System.out.println(movies); // ä½¿ç”¨å¢å¼ºå‹ for å¾ªç¯éå†é›†åˆä¸­çš„ Movie å¯¹è±¡ for (Movie movie : movies) { // è·å–ç”µå½±åç§°å¹¶æ‰“å° System.out.println(movie.getName()); // è·å–ç”µå½±è¯„åˆ†å¹¶æ‰“å° System.out.println(movie.getScore()); // è·å–ä¸»æ¼”åç§°å¹¶æ‰“å° System.out.println(movie.getActor()); } } } List() ArrayList() æ·»åŠ å…ƒç´ ï¼šadd(E e) å’Œ add(int index, E element)\nåˆ é™¤å…ƒç´ ï¼šremove(int index) å’Œ remove(Object o)\nè·å–å…ƒç´ ï¼šget(int index)\nä¿®æ”¹å…ƒç´ ï¼šset(int index, E element)\næ£€æŸ¥å…ƒç´ æ˜¯å¦å­˜åœ¨ï¼šcontains(Object o)\nè·å–åˆ—è¡¨å¤§å°ï¼šsize()\nè·å–å…ƒç´ ä½ç½®ï¼šindexOf(Object o) å’Œ lastIndexOf(Object o)\néå†åˆ—è¡¨ï¼šä½¿ç”¨ for-each å¾ªç¯å’Œ Iterator\nè½¬æ¢ä¸ºæ•°ç»„ï¼štoArray()\nè·å–å­åˆ—è¡¨ï¼šsubList(int fromIndex, int toIndex)\næ¸…ç©ºåˆ—è¡¨ï¼šclear()\nåˆ¤æ–­åˆ—è¡¨æ˜¯å¦ä¸ºç©ºï¼šisEmpty()\nimport java.util.ArrayList; import java.util.List; public class Main { public static void main(String[] args) { // åˆ›å»ºä¸€ä¸ª ArrayList å¯¹è±¡ ls List\u0026lt;String\u0026gt; ls = new ArrayList\u0026lt;\u0026gt;(); // å‘ ls ä¸­æ·»åŠ å…ƒç´  ls.add(\u0026#34;Kennem\u0026#34;); ls.add(\u0026#34;K\u0026#34;); ls.add(\u0026#34;è‡³å°Šå®\u0026#34;); ls.add(\u0026#34;ç‰›å¤«äºº\u0026#34;); // æ‰“å° ls çš„å†…å®¹ System.out.println(\u0026#34;Initial list: \u0026#34; + ls); // åœ¨ç´¢å¼•ä½ç½® 2 æ’å…¥å…ƒç´  \u0026#34;ç´«éœä»™å­\u0026#34; ls.add(2, \u0026#34;ç´«éœä»™å­\u0026#34;); System.out.println(\u0026#34;After adding \u0026#39;ç´«éœä»™å­\u0026#39; at index 2: \u0026#34; + ls); // ç§»é™¤ç´¢å¼•ä½ç½® 2 å¤„çš„å…ƒç´ å¹¶æ‰“å°ç§»é™¤çš„å…ƒç´  System.out.println(\u0026#34;Removed element: \u0026#34; + ls.remove(2)); System.out.println(\u0026#34;After removal: \u0026#34; + ls); // è·å–ç´¢å¼•ä½ç½® 2 å¤„çš„å…ƒç´ å¹¶æ‰“å° System.out.println(\u0026#34;Element at index 2: \u0026#34; + ls.get(2)); // å°†ç´¢å¼•ä½ç½® 1 å¤„çš„å…ƒç´ ä¿®æ”¹ä¸º \u0026#34;ç‰›é­”ç‹\u0026#34;ï¼Œå¹¶æ‰“å°è¢«æ›¿æ¢æ‰çš„å…ƒç´  System.out.println(\u0026#34;Replaced element: \u0026#34; + ls.set(1, \u0026#34;ç‰›é­”ç‹\u0026#34;)); System.out.println(\u0026#34;After setting \u0026#39;ç‰›é­”ç‹\u0026#39; at index 1: \u0026#34; + ls); // æ£€æŸ¥åˆ—è¡¨ä¸­æ˜¯å¦åŒ…å«æŸä¸ªå…ƒç´  System.out.println(\u0026#34;Contains \u0026#39;è‡³å°Šå®\u0026#39;: \u0026#34; + ls.contains(\u0026#34;è‡³å°Šå®\u0026#34;)); System.out.println(\u0026#34;Contains \u0026#39;ç´«éœä»™å­\u0026#39;: \u0026#34; + ls.contains(\u0026#34;ç´«éœä»™å­\u0026#34;)); // è·å–åˆ—è¡¨å¤§å° System.out.println(\u0026#34;List size: \u0026#34; + ls.size()); // è·å–æŸä¸ªå…ƒç´ çš„ç´¢å¼• System.out.println(\u0026#34;Index of \u0026#39;ç‰›é­”ç‹\u0026#39;: \u0026#34; + ls.indexOf(\u0026#34;ç‰›é­”ç‹\u0026#34;)); System.out.println(\u0026#34;Index of \u0026#39;è‡³å°Šå®\u0026#39;: \u0026#34; + ls.indexOf(\u0026#34;è‡³å°Šå®\u0026#34;)); // éå†åˆ—è¡¨ System.out.println(\u0026#34;List elements:\u0026#34;); for (String element : ls) { System.out.println(element); } // è½¬æ¢ä¸ºæ•°ç»„ Object[] array = ls.toArray(); System.out.println(\u0026#34;Array elements:\u0026#34;); for (Object obj : array) { System.out.println(obj); } // è·å–å­åˆ—è¡¨ List\u0026lt;String\u0026gt; subList = ls.subList(1, 3); System.out.println(\u0026#34;Sublist (from index 1 to 3): \u0026#34; + subList); // ä½¿ç”¨è¿­ä»£å™¨éå†åˆ—è¡¨ System.out.println(\u0026#34;List elements using iterator:\u0026#34;); for (var iterator = ls.iterator(); iterator.hasNext();) { System.out.println(iterator.next()); } // æ¸…ç©ºåˆ—è¡¨ ls.clear(); System.out.println(\u0026#34;Is list empty after clear? \u0026#34; + ls.isEmpty()); } } LinkedList() æ·»åŠ å…ƒç´ ï¼šadd(E e) å’Œ add(int index, E element)\nåˆ é™¤å…ƒç´ ï¼šremove(int index) å’Œ remove(Object o)\nè·å–å…ƒç´ ï¼šget(int index)\nä¿®æ”¹å…ƒç´ ï¼šset(int index, E element)\næ£€æŸ¥å…ƒç´ æ˜¯å¦å­˜åœ¨ï¼šcontains(Object o)\nè·å–åˆ—è¡¨å¤§å°ï¼šsize()\nè·å–å…ƒç´ ä½ç½®ï¼šindexOf(Object o) å’Œ lastIndexOf(Object o)\néå†åˆ—è¡¨ï¼šä½¿ç”¨ for-each å¾ªç¯å’Œ Iterator\nè½¬æ¢ä¸ºæ•°ç»„ï¼štoArray()\nè·å–å­åˆ—è¡¨ï¼šsubList(int fromIndex, int toIndex)\næ¸…ç©ºåˆ—è¡¨ï¼šclear()\nåˆ¤æ–­åˆ—è¡¨æ˜¯å¦ä¸ºç©ºï¼šisEmpty()\nç‰¹æœ‰æ–¹æ³•ï¼šaddFirst(E e)ï¼ŒaddLast(E e)ï¼ŒgetFirst()ï¼ŒgetLast()ï¼ŒremoveFirst()ï¼ŒremoveLast()\nimport java.util.LinkedList; import java.util.Iterator; public class LinkedListExample { public static void main(String[] args) { LinkedList\u0026lt;String\u0026gt; list = new LinkedList\u0026lt;\u0026gt;(); // æ·»åŠ å…ƒç´  list.add(\u0026#34;element1\u0026#34;); list.add(\u0026#34;element2\u0026#34;); list.add(1, \u0026#34;element1.5\u0026#34;); list.addFirst(\u0026#34;firstElement\u0026#34;); list.addLast(\u0026#34;lastElement\u0026#34;); // è®¿é—®å…ƒç´  System.out.println(\u0026#34;First element: \u0026#34; + list.getFirst()); System.out.println(\u0026#34;Last element: \u0026#34; + list.getLast()); System.out.println(\u0026#34;Element at index 1: \u0026#34; + list.get(1)); // åˆ é™¤å…ƒç´  list.remove(1); list.remove(\u0026#34;element1\u0026#34;); list.removeFirst(); list.removeLast(); // æ›¿æ¢å…ƒç´  list.set(1, \u0026#34;newElement\u0026#34;); // æ£€æŸ¥å…ƒç´ æ˜¯å¦å­˜åœ¨ System.out.println(\u0026#34;Contains \u0026#39;element2\u0026#39;: \u0026#34; + list.contains(\u0026#34;element2\u0026#34;)); // è·å–åˆ—è¡¨å¤§å° System.out.println(\u0026#34;List size: \u0026#34; + list.size()); // éå†åˆ—è¡¨ System.out.println(\u0026#34;Elements in the list:\u0026#34;); for (String element : list) { System.out.println(element); } // è½¬æ¢ä¸ºæ•°ç»„ Object[] array = list.toArray(); System.out.println(\u0026#34;Array: \u0026#34;); for (Object obj : array) { System.out.println(obj); } // è·å–å­åˆ—è¡¨ List\u0026lt;String\u0026gt; subList = list.subList(0, 1); System.out.println(\u0026#34;Sublist: \u0026#34; + subList); // æ¸…ç©ºåˆ—è¡¨ list.clear(); System.out.println(\u0026#34;Is list empty? \u0026#34; + list.isEmpty()); } } LinkedList()ç‰¹æœ‰æ–¹æ³• import java.util.LinkedList; public class LinkedListExample { public static void main(String[] args) { LinkedList\u0026lt;String\u0026gt; linkedList = new LinkedList\u0026lt;\u0026gt;(); // æ·»åŠ å…ƒç´ åˆ°å¼€å¤´å’Œæœ«å°¾ linkedList.addFirst(\u0026#34;firstElement\u0026#34;); linkedList.addLast(\u0026#34;lastElement\u0026#34;); System.out.println(\u0026#34;After adding elements to first and last: \u0026#34; + linkedList); // è·å–ç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªå…ƒç´  System.out.println(\u0026#34;First element: \u0026#34; + linkedList.getFirst()); System.out.println(\u0026#34;Last element: \u0026#34; + linkedList.getLast()); // åˆ é™¤ç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªå…ƒç´  System.out.println(\u0026#34;Removed first element: \u0026#34; + linkedList.removeFirst()); System.out.println(\u0026#34;Removed last element: \u0026#34; + linkedList.removeLast()); System.out.println(\u0026#34;After removing first and last elements: \u0026#34; + linkedList); // æ ˆæ“ä½œ linkedList.push(\u0026#34;stackElement\u0026#34;); System.out.println(\u0026#34;After push: \u0026#34; + linkedList); System.out.println(\u0026#34;Popped element: \u0026#34; + linkedList.pop()); System.out.println(\u0026#34;After pop: \u0026#34; + linkedList); // æ·»åŠ å…ƒç´ åˆ°é˜Ÿåˆ—ä¸¤ç«¯ linkedList.offerFirst(\u0026#34;offerFirstElement\u0026#34;); linkedList.offerLast(\u0026#34;offerLastElement\u0026#34;); System.out.println(\u0026#34;After offering elements: \u0026#34; + linkedList); // è·å–å¹¶ç§»é™¤é˜Ÿåˆ—ä¸¤ç«¯çš„å…ƒç´  System.out.println(\u0026#34;Polled first element: \u0026#34; + linkedList.pollFirst()); System.out.println(\u0026#34;Polled last element: \u0026#34; + linkedList.pollLast()); System.out.println(\u0026#34;After polling elements: \u0026#34; + linkedList); } } ArrayList() å’Œ LinkedList() åŒºåˆ« ArrayList å’Œ LinkedList éƒ½å®ç°äº† List æ¥å£ï¼Œå› æ­¤æœ‰è®¸å¤šç›¸åŒçš„æ–¹æ³•ã€‚\nLinkedList è¿˜å®ç°äº† Deque æ¥å£ï¼Œå› æ­¤æœ‰è®¸å¤šç‰¹æœ‰çš„æ–¹æ³•ï¼Œè¿™äº›æ–¹æ³•åœ¨ ArrayList ä¸­ä¸å­˜åœ¨ã€‚\nArrayList åœ¨éšæœºè®¿é—®æ€§èƒ½ä¸Šä¼˜äº LinkedListï¼Œè€Œ LinkedList åœ¨é¢‘ç¹æ’å…¥å’Œåˆ é™¤æ“ä½œæ—¶è¡¨ç°æ›´ä¼˜ã€‚\nSet() HashSet() å“ˆå¸Œå€¼\nå°±æ˜¯ä¸€ä¸ªintç±»å‹çš„æ•°å€¼ï¼ŒJavaä¸­æ¯ä¸ªå¯¹è±¡éƒ½æœ‰ä¸€ä¸ªå“ˆå¸Œå€¼ Javaä¸­çš„æ‰€æœ‰å¯¹è±¡ï¼Œéƒ½å¯ä»¥è°ƒç”¨Objectç±»æä¾›çš„hashCodeæ–¹æ³•ï¼Œè¿”å›è¯¥å¯¹è±¡è‡ªå·±çš„å“ˆå¸Œå€¼ å“ˆå¸Œè¡¨\nJDK 8ä¹‹å‰ï¼Œ åŸºäºæ•°ç»„+é“¾è¡¨\nåˆ›å»ºä¸€ä¸ªé»˜è®¤é•¿åº¦ä¸º16çš„æ•°ç»„ï¼Œé»˜è®¤åŠ è½½å› å­ä¸º0.75ï¼Œ æ•°ç»„åä¸ºtable ä½¿ç”¨å…ƒç´ çš„å“ˆå¸Œå€¼å¯¹æ•°ç»„é•¿åº¦æ±‚ä½™è®¡ç®—å‡ºåº”å­˜å…¥çš„ä½ç½® åˆ¤æ–­å½“å‰ä½ç½®æ˜¯å¦ä¸ºnullï¼Œ å¦‚æœæ˜¯nullç›´æ¥å­˜å…¥ å¦‚æœä¸ä¸ºnullï¼Œ è¡¨ç¤ºæœ‰å…ƒç´ ï¼Œåˆ™è°ƒç”¨equalsæ–¹æ³•æ¯”è¾ƒ è‹¥ç›¸ç­‰åˆ™ä¸å­˜å…¥ï¼Œå¦åˆ™å­˜å…¥ JDK 8ä¹‹å‰ï¼Œæ–°å…ƒç´ å­˜å…¥æ•°ç»„ï¼Œå è€å…ƒç´ ä½ç½®ï¼Œè€å…ƒç´ æŒ‚ä¸‹é¢ JDK 8å¼€å§‹ä¹‹åï¼Œ æ–°å…ƒç´ ç›´æ¥æŒ‚åœ¨è€å…ƒç´ ä¸‹é¢ JDK 8å¼€å§‹ä¹‹åï¼Œå“ˆå¸Œè¡¨ä¸­å¼•å…¥äº†çº¢é»‘æ ‘ï¼Œè¿›ä¸€æ­¥æé«˜äº†æ“ä½œæ•°æ®çš„æ€§èƒ½\næ ‘ï¼š\näºŒå‰æ ‘ä¸­ï¼Œä»»æ„èŠ‚ç‚¹çš„åº¦\u0026lt;=2\nåº¦ï¼šæ¯ä¸€ä¸ªèŠ‚ç‚¹çš„å­èŠ‚ç‚¹æ•°é‡ æ ‘é«˜ï¼šæ ‘çš„æ€»å±‚æ•° æ ¹èŠ‚ç‚¹ï¼šæœ€é¡¶å±‚çš„èŠ‚ç‚¹ äºŒå‰æŸ¥æ‰¾æ ‘ï¼ˆäºŒå‰æ’åºæ ‘ï¼‰\nè§„åˆ™ï¼šå°çš„å­˜å·¦è¾¹ï¼Œå¤§çš„å­˜å³è¾¹ï¼Œä¸€æ ·çš„ä¸å­˜\nå¹³è¡¡äºŒå‰æ ‘ï¼šå·¦å³å­æ ‘çš„é«˜åº¦å·®ä¸è¶…è¿‡1\nçº¢é»‘æ ‘ï¼šå¯ä»¥è‡ªå¹³è¡¡çš„äºŒå‰æ ‘, æ˜¯ä¸€ç§å¢åˆ æ”¹æŸ¥æ€§èƒ½éƒ½ç›¸å¯¹è¾ƒå¥½çš„ç»“æ„\nä»JDK8å¼€å§‹ï¼Œå½“é“¾è¡¨çš„é•¿åº¦è¶…è¿‡8ï¼Œä¸”æ•°ç»„é•¿åº¦\u0026gt;=64æ—¶ï¼Œè‡ªåŠ¨å°†é“¾è¡¨è½¬æˆçº¢é»‘æ ‘\npublic static void main(String[] args) { // åˆ›å»ºä¸€ä¸ª HashSet å¯¹è±¡ï¼Œç”¨äºå­˜å‚¨æ•´æ•°æ•°æ® Set\u0026lt;Integer\u0026gt; set = new HashSet\u0026lt;\u0026gt;(); // å¾€ HashSet ä¸­æ·»åŠ æ•´æ•°å…ƒç´  // HashSet ä¼šè‡ªåŠ¨å»é‡ï¼Œä¸ä¼šå­˜å‚¨é‡å¤çš„å…ƒç´  set.add(999); // æ·»åŠ æ•´æ•° 999 set.add(999); // æ·»åŠ é‡å¤çš„æ•´æ•° 999ï¼Œä½†ç”±äº HashSet ä¸å…è®¸é‡å¤å…ƒç´ ï¼Œæ­¤æ¬¡æ·»åŠ æ— æ•ˆ set.add(777); // æ·»åŠ æ•´æ•° 777 // æ‰“å° HashSet ä¸­çš„å…ƒç´  // è¾“å‡ºç»“æœï¼š[777, 999] // HashSet ä¸­çš„å…ƒç´ æ— åºï¼Œå¹¶ä¸”å·²ç»å»é‡äº†ï¼Œåªä¿ç•™äº†ä¸€ä¸ª 999 System.out.println(set); } LinkedHashSet public static void main(String[] args) { // åˆ›å»ºä¸€ä¸ª LinkedHashSet å¯¹è±¡ï¼Œç”¨äºå­˜å‚¨æ•´æ•°æ•°æ®ï¼Œå¹¶ä¿æŒå…ƒç´ çš„æ’å…¥é¡ºåº Set\u0026lt;Integer\u0026gt; set = new LinkedHashSet\u0026lt;\u0026gt;(); // å¾€ LinkedHashSet ä¸­æ·»åŠ æ•´æ•°å…ƒç´  // LinkedHashSet ä¼šä¿æŒå…ƒç´ çš„æ’å…¥é¡ºåºï¼Œå¹¶ä¸”ä¼šè‡ªåŠ¨å»é‡ï¼Œä¸ä¼šå­˜å‚¨é‡å¤çš„å…ƒç´  // æ·»åŠ é¡ºåºï¼š999, 000, 777, 888 // ç”±äº LinkedHashSet ä¼šä¿æŒæ’å…¥é¡ºåºï¼Œå› æ­¤æ‰“å°æ—¶ä¹Ÿä¼šæŒ‰ç…§æ·»åŠ é¡ºåºè¾“å‡º set.add(999); set.add(000); // æ³¨æ„ï¼šæ•´æ•° 000 åœ¨æ‰“å°æ—¶ä¼šè‡ªåŠ¨å»æ‰å‰å¯¼é›¶ï¼Œå˜æˆ 0 set.add(777); set.add(888); set.add(999); // é‡å¤å…ƒç´ ä¸ä¼šè¢«æ·»åŠ è¿› LinkedHashSet // æ‰“å° LinkedHashSet ä¸­çš„å…ƒç´  // è¾“å‡ºç»“æœï¼š[999, 0, 777, 888] // LinkedHashSet ä¸­çš„å…ƒç´ æŒ‰ç…§æ’å…¥é¡ºåºæ’åˆ—ï¼Œå¹¶ä¸”å»é‡äº† System.out.println(set); } TreeSet() åŸºäºçº¢é»‘æ ‘å®ç°æ’åºï¼Œ\npublic static void main(String[] args) { // åˆ›å»ºä¸€ä¸ª TreeSet å¯¹è±¡ï¼Œç”¨äºå­˜å‚¨æ•´æ•°æ•°æ®ï¼Œå¹¶æŒ‰ç…§è‡ªç„¶é¡ºåºè¿›è¡Œæ’åº Set\u0026lt;Integer\u0026gt; set = new TreeSet\u0026lt;\u0026gt;(); // å¾€ TreeSet ä¸­æ·»åŠ æ•´æ•°å…ƒç´  // TreeSet ä¼šè‡ªåŠ¨å»é‡ï¼Œä¸ä¼šå­˜å‚¨é‡å¤çš„å…ƒç´  // æ·»åŠ é¡ºåºï¼š999, 000, 777, 888 // ç”±äº TreeSet æ˜¯æœ‰åºçš„ï¼Œå®ƒä¼šæ ¹æ®è‡ªç„¶é¡ºåºï¼ˆä»å°åˆ°å¤§ï¼‰å¯¹å…ƒç´ è¿›è¡Œæ’åº set.add(999); set.add(000); // æ³¨æ„ï¼šæ•´æ•° 000 åœ¨æ‰“å°æ—¶ä¼šè‡ªåŠ¨å»æ‰å‰å¯¼é›¶ï¼Œå˜æˆ 0 set.add(777); set.add(888); set.add(999); // é‡å¤å…ƒç´ ä¸ä¼šè¢«æ·»åŠ è¿› TreeSet // æ‰“å° TreeSet ä¸­çš„å…ƒç´  // è¾“å‡ºç»“æœï¼š[0, 777, 888, 999] // TreeSet ä¸­çš„å…ƒç´ å·²ç»æŒ‰ç…§è‡ªç„¶é¡ºåºæ’å¥½åºï¼Œå¹¶ä¸”å»é‡äº† System.out.println(set); } å¯¹äºè‡ªå®šä¹‰å¯¹è±¡ï¼Œç¡®ä¿å­˜å‚¨çš„å€¼ç›¸åŒå°±é‡å¤ï¼Œé‡å†™hashCodeæ–¹æ³•\n@Override public int hashCode() { return Objects.hash(name, age, height);//åªè¦å†…å®¹ä¸€æ ·ï¼Œå“ˆå¸Œå€¼å°±ç›¸åŒ } è‡ªå®šä¹‰æ’åºè§„åˆ™ï¼š TreeSeté›†åˆå­˜å‚¨è‡ªå®šä¹‰ç±»å‹çš„å¯¹è±¡æ—¶ï¼Œ å¿…é¡»æŒ‡å®šæ’åºè§„åˆ™ï¼Œæ”¯æŒå¦‚ä¸‹ä¸¤ç§æ–¹å¼æ¥æŒ‡å®šæ¯”è¾ƒè§„åˆ™ æ–¹å¼ä¸€\nè®©è‡ªå®šä¹‰çš„ç±»ï¼ˆå¦‚å­¦ç”Ÿç±»ï¼‰å®ç°Comparableæ¥å£ï¼Œé‡å†™é‡Œé¢çš„compareToæ–¹æ³•æ¥æ‰§è¡Œæ¯”è¾ƒè§„åˆ™ @Override public int compareTo(Student o) { return this.age - o.age; } æ–¹å¼äºŒ\né€šè¿‡è°ƒç”¨TreeSeté›†åˆæœ‰å‚æ•°æ„é€ å™¨ï¼Œå¯ä»¥è®¾ç½®Comparatorå¯¹è±¡ï¼ˆæ¯”è¾ƒå™¨å¯¹è±¡ï¼Œç”¨äºæŒ‡å®šæ¯”è¾ƒè§„åˆ™ã€‚ï¼‰ // å°±è¿‘é€‰æ‹©è‡ªå·±è‡ªå¸¦çš„æ¯”è¾ƒå™¨è¿›è¡Œæ¯”è¾ƒ // Set\u0026lt;Student\u0026gt; students = new TreeSet\u0026lt;\u0026gt;(new Comparator\u0026lt;Student\u0026gt;() { // @Override // public int compare(Student o1, Student o2) { // return Double.compare(o1.getHeight(), o2.getHeight()); // } // }); Set\u0026lt;Student\u0026gt; students = new TreeSet\u0026lt;\u0026gt;( (o1, o2) -\u0026gt; Double.compare(o1.getHeight(), o2.getHeight())); é›†åˆçš„å¹¶å‘ä¿®æ”¹å¼‚å¸¸ public static void main(String[] args) { // åˆ›å»ºä¸€ä¸ªå­—ç¬¦ä¸²åˆ—è¡¨ List\u0026lt;String\u0026gt; list = new ArrayList\u0026lt;\u0026gt;(); list.add(\u0026#34;å°æå­\u0026#34;); list.add(\u0026#34;åˆ©ç›çª¦\u0026#34;); list.add(\u0026#34;èƒ¡é£äº‘\u0026#34;); list.add(\u0026#34;èƒ¡é¢ä¸Š\u0026#34;); list.add(\u0026#34;èƒ¡æ¤’ç²‰\u0026#34;); list.add(\u0026#34;kennem\u0026#34;); list.add(\u0026#34;ç™¾äº‹å¿«\u0026#34;); System.out.println(list); // ä½¿ç”¨è¿­ä»£å™¨éå†åˆ—è¡¨å¹¶ç§»é™¤åŒ…å«ç‰¹å®šå­—ç¬¦çš„å…ƒç´  Iterator\u0026lt;String\u0026gt; it = list.iterator(); while (it.hasNext()) { String name = it.next(); if (name.contains(\u0026#34;èƒ¡\u0026#34;)) { it.remove(); // è§£å†³é›†åˆçš„å¹¶å‘ä¿®æ”¹å¼‚å¸¸ } } System.out.println(list); // ä½¿ç”¨æ™®é€šforå¾ªç¯éå†åˆ—è¡¨å¹¶ç§»é™¤åŒ…å«ç‰¹å®šå­—ç¬¦çš„å…ƒç´  // é€šè¿‡ç»´æŠ¤ç´¢å¼•ï¼Œé¿å…å¹¶å‘ä¿®æ”¹å¼‚å¸¸ /* for (int i = 0; i \u0026lt; list.size(); i++) { String name = list.get(i); if (name.contains(\u0026#34;èƒ¡\u0026#34;)) { list.remove(name); i--; // è§£å†³é›†åˆçš„å¹¶å‘ä¿®æ”¹å¼‚å¸¸ } } System.out.println(list); */ // ä½¿ç”¨å¢å¼ºforå¾ªç¯éå†åˆ—è¡¨å¹¶ç§»é™¤åŒ…å«ç‰¹å®šå­—ç¬¦çš„å…ƒç´  // ä¸æ¨èï¼Œä¼šå¯¼è‡´ConcurrentModificationExceptionå¼‚å¸¸ /* for (String s : list) { if (s.contains(\u0026#34;èƒ¡\u0026#34;)) { list.remove(s); } } System.out.println(list); */ } å¯å˜å‚æ•° public static void main(String[] args) { // è°ƒç”¨testæ–¹æ³•ï¼Œä¼ å…¥å•ä¸ªæ•´æ•°å‚æ•° test(1); // è°ƒç”¨testæ–¹æ³•ï¼Œä¼ å…¥å•ä¸ªæ•´æ•°å‚æ•° test(10); // è°ƒç”¨testæ–¹æ³•ï¼Œä¼ å…¥å¤šä¸ªæ•´æ•°å‚æ•°ï¼Œå…¶ä¸­æœ€åä¸€ä¸ªå‚æ•°ä¸ºå¯å˜å‚æ•° test(100, 10, 0); // è°ƒç”¨testæ–¹æ³•ï¼Œä¼ å…¥ä¸€ä¸ªæ•´æ•°å‚æ•°å’Œä¸€ä¸ªæ•´æ•°æ•°ç»„å‚æ•° test(1, new int[] {1, 2, 4, 4, 3, 3, 3, 3, 4, 3}); } // 1. ä¸€ä¸ªå½¢å‚åˆ—è¡¨ä¸­ï¼Œåªèƒ½æœ‰ä¸€ä¸ªå¯å˜å‚æ•° // 2. å¯å˜å‚æ•°å¿…é¡»æ”¾åœ¨å½¢å‚åˆ—è¡¨çš„æœ€åé¢ public static void test(int age, int...nums){ // æ‰“å°å¯å˜å‚æ•°æ•°ç»„ System.out.println(Arrays.toString(nums)); // æ‰“å°å¯å˜å‚æ•°æ•°ç»„çš„é•¿åº¦ System.out.println(nums.length); // æ‰“å°åˆ†éš”çº¿ System.out.println(\u0026#34;----------\u0026#34;); } Collections public static void main(String[] args) { // åˆ›å»ºä¸€ä¸ªå­—ç¬¦ä¸²åˆ—è¡¨ List\u0026lt;String\u0026gt; names = new ArrayList\u0026lt;\u0026gt;(); // å‘åˆ—è¡¨ä¸­æ·»åŠ å…ƒç´  Collections.addAll(names, \u0026#34;Kennem\u0026#34;, \u0026#34;å¼ ä¸€\u0026#34;,\u0026#34;æä¸‰\u0026#34;,\u0026#34;ç‹å…­\u0026#34;); // æ‰“å°åˆ—è¡¨å†…å®¹ System.out.println(names); // æ‰“ä¹±åˆ—è¡¨ä¸­å…ƒç´ çš„é¡ºåº Collections.shuffle(names); // æ‰“å°æ‰“ä¹±åçš„åˆ—è¡¨å†…å®¹ System.out.println(names); // åˆ›å»ºä¸€ä¸ªæ•´æ•°åˆ—è¡¨ List\u0026lt;Integer\u0026gt; list = new ArrayList\u0026lt;\u0026gt;(); // å‘åˆ—è¡¨ä¸­æ·»åŠ å…ƒç´  list.add(3); list.add(4); list.add(1); // å¯¹åˆ—è¡¨ä¸­çš„å…ƒç´ è¿›è¡Œæ’åº Collections.sort(list); // æ‰“å°æ’åºåçš„åˆ—è¡¨å†…å®¹ System.out.println(list); // åˆ›å»ºä¸€ä¸ªå­¦ç”Ÿå¯¹è±¡åˆ—è¡¨ List\u0026lt;Student\u0026gt; students = new ArrayList\u0026lt;\u0026gt;(); // åˆ›å»ºå­¦ç”Ÿå¯¹è±¡å¹¶æ·»åŠ åˆ°åˆ—è¡¨ä¸­ Student s1 = new Student(\u0026#34;è‡³å°Šå®\u0026#34;, 21, 181.9); Student s2 = new Student(\u0026#34;èœ˜è››ç²¾\u0026#34;, 21, 188); Student s3 = new Student(\u0026#34;ç‰›é­”ç‹\u0026#34;, 20, 165.3); Student s4 = new Student(\u0026#34;èå­ç²¾\u0026#34;, 20, 165.3); Student s5 = new Student(\u0026#34;è‘«èŠ¦å¨ƒ\u0026#34;, 20, 165.3); Student s6 = new Student(\u0026#34;è‡³å°Šå®\u0026#34;, 21, 181); students.add(s1); students.add(s2); students.add(s3); students.add(s4); students.add(s5); students.add(s6); // æ‰“å°å­¦ç”Ÿåˆ—è¡¨å†…å®¹ System.out.println(students); // ä½¿ç”¨Lambdaè¡¨è¾¾å¼å¯¹å­¦ç”Ÿåˆ—è¡¨æŒ‰èº«é«˜è¿›è¡Œæ’åº Collections.sort(students, (o1, o2) -\u0026gt; Double.compare(o1.getHeight(), o2.getHeight())); // æ‰“å°æŒ‰èº«é«˜æ’åºåçš„å­¦ç”Ÿåˆ—è¡¨å†…å®¹ System.out.println(students); } Map HashMap ï¼šæ— åºã€ä¸é‡å¤ã€æ— ç´¢å¼•ï¼›ï¼ˆç”¨çš„æœ€å¤šï¼‰ LinkedHashMapï¼šç”±é”®å†³å®šçš„ç‰¹ç‚¹ï¼šæœ‰åºï¼Œä¸é‡å¤ï¼Œæ— ç´¢å¼• TreeMap:æŒ‰ç…§å¤§å°é»˜è®¤å‡åºæ’åºï¼Œä¸é‡å¤ï¼Œæ— ç´¢å¼• public static void main(String[] args) { // åˆ›å»ºä¸€ä¸ªHashMapå¯¹è±¡ Map\u0026lt;String, Integer\u0026gt; map = new HashMap\u0026lt;\u0026gt;(); // å‘mapä¸­æ·»åŠ é”®å€¼å¯¹ map.put(\u0026#34;æ‰‹è¡¨\u0026#34;, 100); map.put(\u0026#34;æ‰‹æœº\u0026#34;, 20); map.put(\u0026#34;Java\u0026#34;, 120); map.put(null, null); // å…è®¸é”®å’Œå€¼ä¸ºnull // æ‰“å°mapçš„å†…å®¹ System.out.println(map); // è·å–mapçš„å¤§å° System.out.println(map.size()); // æ¸…ç©ºmap // map.clear(); // æ‰“å°æ¸…ç©ºåçš„map System.out.println(map); // åˆ¤æ–­mapæ˜¯å¦ä¸ºç©º System.out.println(map.isEmpty()); // è·å–æŒ‡å®šé”®å¯¹åº”çš„å€¼ System.out.println(map.get(\u0026#34;æ‰‹æœº\u0026#34;)); // è·å–ä¸€ä¸ªä¸å­˜åœ¨çš„é”®å¯¹åº”çš„å€¼ System.out.println(map.get(\u0026#34;666\u0026#34;)); // ç§»é™¤æŒ‡å®šé”®å¯¹åº”çš„é”®å€¼å¯¹ï¼Œå¹¶è¿”å›å¯¹åº”çš„å€¼ System.out.println(map.remove(\u0026#34;æ‰‹æœº\u0026#34;)); // åˆ¤æ–­mapä¸­æ˜¯å¦åŒ…å«æŒ‡å®šçš„é”® System.out.println(map.containsKey(\u0026#34;æ‰‹æœº\u0026#34;)); System.out.println(map.containsKey(\u0026#34;æ‰‹æœº\u0026#34;)); // è·å–mapä¸­æ‰€æœ‰çš„é”®ï¼Œå¹¶å­˜å‚¨åˆ°Seté›†åˆä¸­ Set\u0026lt;String\u0026gt; keys = map.keySet(); System.out.println(keys); // è·å–mapä¸­æ‰€æœ‰çš„å€¼ï¼Œå¹¶å­˜å‚¨åˆ°Collectioné›†åˆä¸­ Collection\u0026lt;Integer\u0026gt; values = map.values(); System.out.println(values); // åˆ›å»ºå¦ä¸€ä¸ªHashMapå¯¹è±¡ Map\u0026lt;String, Integer\u0026gt; map1 = new HashMap\u0026lt;\u0026gt;(); map1.put(\u0026#34;Java1\u0026#34;, 100); map1.put(\u0026#34;Java2\u0026#34;, 200); map1.put(\u0026#34;Java3\u0026#34;, 300); // åˆ›å»ºå¦ä¸€ä¸ªHashMapå¯¹è±¡ Map\u0026lt;String, Integer\u0026gt; map2 = new HashMap\u0026lt;\u0026gt;(); map2.put(\u0026#34;Java3\u0026#34;, 400); map2.put(\u0026#34;Java4\u0026#34;, 500); // æ‰“å°map1å’Œmap2çš„å†…å®¹ System.out.println(map1); System.out.println(map2); // å°†map2ä¸­çš„é”®å€¼å¯¹å…¨éƒ¨æ·»åŠ åˆ°map1ä¸­ map1.putAll(map2); // æ‰“å°åˆå¹¶åçš„map1 System.out.println(map1); } éå†Map public class Main { public static void main(String[] args) { // åˆ›å»ºä¸€ä¸ªHashMapå¯¹è±¡ï¼Œé”®ä¸ºStringç±»å‹ï¼Œå€¼ä¸ºDoubleç±»å‹ Map\u0026lt;String, Double\u0026gt; map = new HashMap\u0026lt;\u0026gt;(); // å‘mapä¸­æ·»åŠ é”®å€¼å¯¹ map.put(\u0026#34;èœ˜è››ç²¾\u0026#34;, 167.2); // å¦‚æœé”®å·²å­˜åœ¨ï¼Œåˆ™è¦†ç›–åŸæœ‰å€¼ map.put(\u0026#34;èœ˜è››ç²¾\u0026#34;, 169.2); map.put(\u0026#34;è‡³å°Šå®\u0026#34;, 164.2); map.put(\u0026#34;ç‰›é­”ç‹\u0026#34;, 187.2); // è·å–mapä¸­æ‰€æœ‰çš„é”®ï¼Œå¹¶å­˜å‚¨åœ¨Seté›†åˆä¸­ Set\u0026lt;String\u0026gt; keys = map.keySet(); // æ‰“å°æ‰€æœ‰çš„é”® System.out.println(keys); // éå†Seté›†åˆï¼Œè·å–æ¯ä¸ªé”®å¯¹åº”çš„å€¼ï¼Œå¹¶æ‰“å°é”®å€¼å¯¹ for (String key : keys) { double value = map.get(key); System.out.println(key + \u0026#34; \u0026#34; + map.get(key)); } } } entryéå†æ–¹å¼ // è·å–mapä¸­æ‰€æœ‰çš„é”®å€¼å¯¹ï¼Œå¹¶å­˜å‚¨åœ¨Seté›†åˆä¸­ Set\u0026lt;Map.Entry\u0026lt;String, Double\u0026gt;\u0026gt; entries = map.entrySet(); // éå†Seté›†åˆï¼Œè·å–æ¯ä¸ªé”®å€¼å¯¹ï¼Œå¹¶æ‰“å°é”®å€¼å¯¹ for (Map.Entry\u0026lt;String, Double\u0026gt; entry : entries) { String key = entry.getKey(); double value = entry.getValue(); System.out.println(key + \u0026#34;-----\u0026gt;\u0026#34; + value); } forEachæ–¹å¼éå†\n// ä½¿ç”¨forEachæ–¹æ³•éå†mapï¼Œæ‰“å°æ¯ä¸ªé”®å€¼å¯¹ map.forEach((k, v) -\u0026gt; { System.out.println(k + \u0026#34;---\u0026gt;\u0026#34; + v); }); LinkedHashMap ç±»ä¼¼LinkedHashSet(), è€Œä¸”LinkedHashSet()åº•å±‚ä½¿ç”¨çš„å°±æ˜¯linkedHashMap()\npublic static void main(String[] args) { // åˆ›å»ºä¸€ä¸ªLinkedHashMapå¯¹è±¡ï¼Œé”®ä¸ºStudentç±»å‹ï¼Œå€¼ä¸ºIntegerç±»å‹ Map\u0026lt;Student, Integer\u0026gt; lmap = new LinkedHashMap\u0026lt;\u0026gt;(); // å‘lmapä¸­æ·»åŠ é”®å€¼å¯¹ï¼Œå…¶ä¸­é”®ä¸ºStudentå¯¹è±¡ï¼Œå€¼ä¸ºIntegerå¯¹è±¡ // æ³¨æ„ï¼šStudentç±»éœ€è¦æ­£ç¡®å®ç°equals()å’ŒhashCode()æ–¹æ³•ä»¥ç¡®ä¿å¯¹è±¡çš„å”¯ä¸€æ€§ lmap.put(new Student(\u0026#34;Ken\u0026#34;, 25, 150), 100); lmap.put(new Student(\u0026#34;Mary\u0026#34;, 23, 182), 123300); lmap.put(new Student(\u0026#34;Bob\u0026#34;, 21, 1180), 12300); lmap.put(new Student(\u0026#34;Paul\u0026#34;, 22, 130), 12); lmap.put(new Student(\u0026#34;Sam\u0026#34;, 15, 280), 120); lmap.put(new Student(\u0026#34;Ken\u0026#34;, 25, 150), 10); // æ³¨æ„ï¼šä¸ç¬¬ä¸€ä¸ªKenå¯¹è±¡ç›¸åŒï¼Œä½†æ˜¯å€¼ä¸åŒ // ä½¿ç”¨forEachæ–¹æ³•éå†lmapï¼Œæ‰“å°æ¯ä¸ªé”®å€¼å¯¹ lmap.forEach((k, v) -\u0026gt; { System.out.println(k + \u0026#34; \u0026#34; + v); }); } é‡å†™equalsæ–¹æ³•å¯ä»¥å»é™¤é‡å¤å€¼\n@Override public boolean equals(Object o) { if (this == o) return true; if (o == null || getClass() != o.getClass()) return false; Student student = (Student) o; return age == student.age \u0026amp;\u0026amp; Double.compare(height, student.height) == 0 \u0026amp;\u0026amp; Objects.equals(name, student.name); } TreeMap æ¯”è¾ƒè§„åˆ™ç”¨é‡å†™Comparableæ¥å£ï¼Œæˆ–è€…é‡å†™Comparatoræ–¹æ³•\npublic static void main(String[] args) { // åˆ›å»ºä¸€ä¸ªTreeMapå¯¹è±¡ï¼Œé”®ä¸ºStudentç±»å‹ï¼Œå€¼ä¸ºIntegerç±»å‹ // åœ¨æ„é€ TreeMapå¯¹è±¡æ—¶ï¼Œä¼ å…¥ä¸€ä¸ªComparatorå¯¹è±¡ï¼Œç”¨äºæŒ‰ç…§å­¦ç”Ÿèº«é«˜è¿›è¡Œæ’åº Map\u0026lt;Student, Integer\u0026gt; tmap = new TreeMap\u0026lt;\u0026gt;((o1, o2) -\u0026gt; Double.compare(o1.getHeight(), o2.getHeight())); // å‘tmapä¸­æ·»åŠ é”®å€¼å¯¹ï¼Œå…¶ä¸­é”®ä¸ºStudentå¯¹è±¡ï¼Œå€¼ä¸ºIntegerå¯¹è±¡ // æ³¨æ„ï¼šStudentç±»éœ€è¦æ­£ç¡®å®ç°equals()å’ŒhashCode()æ–¹æ³•ä»¥ç¡®ä¿å¯¹è±¡çš„å”¯ä¸€æ€§ tmap.put(new Student(\u0026#34;Ken\u0026#34;, 25, 150), 100); tmap.put(new Student(\u0026#34;Mary\u0026#34;, 23, 182), 123300); tmap.put(new Student(\u0026#34;Bob\u0026#34;, 21, 1180), 12300); tmap.put(new Student(\u0026#34;Paul\u0026#34;, 22, 130), 12); tmap.put(new Student(\u0026#34;Sam\u0026#34;, 15, 280), 120); tmap.put(new Student(\u0026#34;Ken\u0026#34;, 25, 150), 10); // ä¸ç¬¬ä¸€ä¸ªKenå¯¹è±¡ç›¸åŒï¼Œä½†æ˜¯å€¼ä¸åŒ // ä½¿ç”¨forEachæ–¹æ³•éå†tmapï¼Œæ‰“å°æ¯ä¸ªé”®å€¼å¯¹ tmap.forEach((k, v) -\u0026gt; { System.out.println(k + \u0026#34; \u0026#34; + v); }); } é‡å†™Comparableä¸­çš„compareToæ–¹æ³•\n@Override public int compareTo(Student o) { return this.age - o.age; } é›†åˆçš„åµŒå¥— public static void main(String[] args) { // åˆ›å»ºä¸€ä¸ªHashMapå¯¹è±¡ï¼Œé”®ä¸ºStringç±»å‹ï¼Œå€¼ä¸ºList\u0026lt;String\u0026gt;ç±»å‹ Map\u0026lt;String, List\u0026lt;String\u0026gt;\u0026gt; map = new HashMap\u0026lt;\u0026gt;(); // åˆ›å»ºç¬¬ä¸€ä¸ªåŸå¸‚åˆ—è¡¨ï¼Œå­˜å‚¨æ±Ÿè‹çœçš„åŸå¸‚ä¿¡æ¯ List\u0026lt;String\u0026gt; cities1 = new ArrayList\u0026lt;\u0026gt;(); // ä½¿ç”¨Collections.addAllæ–¹æ³•å‘cities1ä¸­æ·»åŠ å¤šä¸ªå…ƒç´  Collections.addAll(cities1, \u0026#34;å—äº¬å¸‚\u0026#34;, \u0026#34;æ‰¬å·å¸‚\u0026#34;, \u0026#34;è‹å·å¸‚\u0026#34;, \u0026#34;æ— é”¡å¸‚\u0026#34;, \u0026#34;å¸¸å·å¸‚\u0026#34;); // å°†é”®å€¼å¯¹æ·»åŠ åˆ°mapä¸­ï¼Œé”®ä¸º\u0026#34;æ±Ÿè‹çœ\u0026#34;ï¼Œå€¼ä¸ºcities1åˆ—è¡¨ map.put(\u0026#34;æ±Ÿè‹çœ\u0026#34;, cities1); // åˆ›å»ºç¬¬äºŒä¸ªåŸå¸‚åˆ—è¡¨ï¼Œå­˜å‚¨æ¹–åŒ—çœçš„åŸå¸‚ä¿¡æ¯ List\u0026lt;String\u0026gt; cities2 = new ArrayList\u0026lt;\u0026gt;(); Collections.addAll(cities2, \u0026#34;æ­¦æ±‰å¸‚\u0026#34;, \u0026#34;å­æ„Ÿå¸‚\u0026#34;, \u0026#34;åå °å¸‚\u0026#34;, \u0026#34;å®œæ˜Œå¸‚\u0026#34;, \u0026#34;é„‚å·å¸‚\u0026#34;); map.put(\u0026#34;æ¹–åŒ—çœ\u0026#34;, cities2); // æ‰“å°æ•´ä¸ªmap System.out.println(map); // æ‰“å°æ¹–åŒ—çœå¯¹åº”çš„åŸå¸‚åˆ—è¡¨ System.out.println(map.get(\u0026#34;æ¹–åŒ—çœ\u0026#34;)); // ä½¿ç”¨å¢å¼ºforå¾ªç¯éå†ç¬¬äºŒä¸ªåŸå¸‚åˆ—è¡¨ï¼Œæ‰“å°å…¶ä¸­çš„åŸå¸‚ä¿¡æ¯ for (String s : cities2) { System.out.println(s); } // ä½¿ç”¨forEachæ–¹æ³•éå†mapï¼Œæ‰“å°æ¯ä¸ªçœä»½åŠå…¶å¯¹åº”çš„åŸå¸‚åˆ—è¡¨ map.forEach((k, v) -\u0026gt; System.out.println(k + \u0026#34;---\u0026gt;\u0026#34; + v)); } Stream import java.util.ArrayList; import java.util.Collections; import java.util.List; import java.util.stream.Collectors; public class Main { public static void main(String[] args) { // åˆ›å»ºä¸€ä¸ªå­—ç¬¦ä¸²åˆ—è¡¨ List\u0026lt;String\u0026gt; names = new ArrayList\u0026lt;\u0026gt;(); // å‘åˆ—è¡¨ä¸­æ·»åŠ å¤šä¸ªå…ƒç´  Collections.addAll(names, \u0026#34;å¼ æŸ\u0026#34;, \u0026#34;å¼ äº”ä¸€\u0026#34;, \u0026#34;å¼ æ— å¿Œ\u0026#34;, \u0026#34;å¼ ä¸‰ä¸°\u0026#34;, \u0026#34;Kennem\u0026#34;); // æ‰“å°åˆ—è¡¨ä¸­çš„æ‰€æœ‰å…ƒç´  System.out.println(names); // åˆ›å»ºä¸€ä¸ªæ–°çš„åˆ—è¡¨ï¼Œç”¨äºå­˜å‚¨ä»¥\u0026#34;å¼ \u0026#34;å¼€å¤´ä¸”é•¿åº¦ä¸º3çš„å­—ç¬¦ä¸² List\u0026lt;String\u0026gt; list = new ArrayList\u0026lt;\u0026gt;(); // ä½¿ç”¨å¢å¼ºforå¾ªç¯éå†åŸå§‹åˆ—è¡¨ for (String name : names) { // å¦‚æœå­—ç¬¦ä¸²ä»¥\u0026#34;å¼ \u0026#34;å¼€å¤´ä¸”é•¿åº¦ä¸º3ï¼Œåˆ™æ·»åŠ åˆ°æ–°åˆ—è¡¨ä¸­ if (name.startsWith(\u0026#34;å¼ \u0026#34;) \u0026amp;\u0026amp; name.length() == 3) { list.add(name); } } // æ‰“å°æ–°åˆ—è¡¨ä¸­çš„å…ƒç´  System.out.println(list); // ä½¿ç”¨æµè¿›è¡Œç­›é€‰ï¼Œè·å–ä»¥\u0026#34;å¼ \u0026#34;å¼€å¤´ä¸”é•¿åº¦ä¸º3çš„å­—ç¬¦ä¸²ï¼Œç„¶åæ”¶é›†åˆ°æ–°çš„åˆ—è¡¨ä¸­ List\u0026lt;String\u0026gt; list2 = names.stream() .filter(s -\u0026gt; s.startsWith(\u0026#34;å¼ \u0026#34;)) // ç­›é€‰ä»¥\u0026#34;å¼ \u0026#34;å¼€å¤´çš„å­—ç¬¦ä¸² .filter(a -\u0026gt; a.length() == 3) // ç­›é€‰é•¿åº¦ä¸º3çš„å­—ç¬¦ä¸² .collect(Collectors.toList()); // æ”¶é›†åˆ°æ–°çš„åˆ—è¡¨ä¸­ // æ‰“å°æ–°åˆ—è¡¨ä¸­çš„å…ƒç´  System.out.println(list2); } } ArrayList, HashSet, Mapçš„Streamæµ public static void main(String[] args) { // åˆ›å»ºä¸€ä¸ªå­—ç¬¦ä¸²åˆ—è¡¨ List\u0026lt;String\u0026gt; names = new ArrayList\u0026lt;\u0026gt;(); // å‘åˆ—è¡¨ä¸­æ·»åŠ å¤šä¸ªå…ƒç´  Collections.addAll(names, \u0026#34;å¼ ä¸‰ä¸°\u0026#34;, \u0026#34;å¼ æŸäºº\u0026#34;, \u0026#34;å¼ æŸæŸ\u0026#34;, \u0026#34;å¼ æŸ\u0026#34;, \u0026#34;å¼ æŸæŸäºº\u0026#34;); // åˆ›å»ºä¸€ä¸ªæµï¼Œå¹¶å¯¹å…¶ä¸­åŒ…å«\u0026#34;æŸ\u0026#34;çš„å…ƒç´ è¿›è¡Œç­›é€‰å¹¶æ‰“å° Stream\u0026lt;String\u0026gt; stream1 = names.stream(); stream1.filter(s -\u0026gt; s.contains(\u0026#34;æŸ\u0026#34;)).forEach(System.out::println); // åˆ›å»ºä¸€ä¸ªHashSeté›†åˆï¼Œå¹¶å°†å¤šä¸ªå…ƒç´ æ·»åŠ åˆ°å…¶ä¸­ Set\u0026lt;String\u0026gt; set = new HashSet\u0026lt;\u0026gt;(); Collections.addAll(set, \u0026#34;å¼ ä¸‰ä¸°\u0026#34;, \u0026#34;å¼ æŸäºº\u0026#34;, \u0026#34;å¼ æŸæŸ\u0026#34;, \u0026#34;å¼ æŸ\u0026#34;, \u0026#34;å¼ æŸæŸäºº\u0026#34;); // åˆ›å»ºä¸€ä¸ªæµï¼Œå¹¶å¯¹å…¶ä¸­åŒ…å«\u0026#34;æŸ\u0026#34;çš„å…ƒç´ è¿›è¡Œç­›é€‰å¹¶æ‰“å° Stream\u0026lt;String\u0026gt; stream2 = set.stream(); stream2.filter(s -\u0026gt; s.contains(\u0026#34;æŸ\u0026#34;)).forEach(System.out::println); // åˆ›å»ºä¸€ä¸ªHashMapå¯¹è±¡ï¼Œå¹¶å‘å…¶ä¸­æ·»åŠ é”®å€¼å¯¹ Map\u0026lt;String, Double\u0026gt; map = new HashMap\u0026lt;\u0026gt;(); map.put(\u0026#34;å¼ æŸ\u0026#34;, 165.3); map.put(\u0026#34;Kennem\u0026#34;, 181.2); map.put(\u0026#34;Karl\u0026#34;, 180.1); // è·å–mapä¸­æ‰€æœ‰å€¼çš„é›†åˆ Collection\u0026lt;Double\u0026gt; values = map.values(); // åˆ›å»ºä¸€ä¸ªæµï¼Œå¹¶å¯¹å…¶ä¸­åŒ…å«\u0026#34;æŸ\u0026#34;çš„é”®å€¼å¯¹è¿›è¡Œç­›é€‰å¹¶æ‰“å° Set\u0026lt;Map.Entry\u0026lt;String, Double\u0026gt;\u0026gt; entries = map.entrySet(); Stream\u0026lt;Map.Entry\u0026lt;String, Double\u0026gt;\u0026gt; stream3 = entries.stream(); stream3.filter(e -\u0026gt; e.getKey().contains(\u0026#34;æŸ\u0026#34;)) .forEach(e -\u0026gt; System.out.println(e.getKey() + \u0026#34;--\u0026gt;\u0026#34; + e.getValue())); // åˆ›å»ºä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„ï¼Œå¹¶å°†å¤šä¸ªå…ƒç´ æ·»åŠ åˆ°å…¶ä¸­ String[] names2 = {\u0026#34;å¼ æŸäºº\u0026#34;, \u0026#34;ä¸œæ–¹ä¸è´¥\u0026#34;}; // ä½¿ç”¨Arrays.streamæ–¹æ³•åˆ›å»ºä¸€ä¸ªæµï¼Œå¹¶å¯¹å…¶ä¸­çš„å…ƒç´ è¿›è¡Œæ‰“å° Stream\u0026lt;String\u0026gt; stream4 = Arrays.stream(names2); stream4.forEach(System.out::println); // ä½¿ç”¨Stream.ofæ–¹æ³•åˆ›å»ºä¸€ä¸ªæµï¼Œå¹¶å¯¹å…¶ä¸­çš„å…ƒç´ è¿›è¡Œæ‰“å° Stream\u0026lt;String\u0026gt; names21 = Stream.of(names2); names21.forEach(System.out::println); } æ’åºä»¥åŠç­›é€‰ public static void main(String[] args) { // åˆ›å»ºä¸€ä¸ªDoubleç±»å‹çš„åˆ—è¡¨ï¼Œå­˜å‚¨è€ƒè¯•æˆç»© List\u0026lt;Double\u0026gt; scores = new ArrayList\u0026lt;\u0026gt;(); Collections.addAll(scores, 88.5, 89.5, 90.0, 12.0, 1.0); // ä½¿ç”¨æµå¯¹è€ƒè¯•æˆç»©è¿›è¡Œç­›é€‰ï¼Œåªæ‰“å°åŠæ ¼çš„æˆç»© scores.stream().filter(s -\u0026gt; s \u0026gt;= 60) .forEach(System.out::println); System.out.println(\u0026#34;---------------\u0026#34;); // åˆ›å»ºä¸€ä¸ªStudentå¯¹è±¡çš„åˆ—è¡¨ï¼Œå­˜å‚¨å­¦ç”Ÿä¿¡æ¯ List\u0026lt;Student\u0026gt; students = new ArrayList\u0026lt;\u0026gt;(); // åˆ›å»ºå¤šä¸ªStudentå¯¹è±¡ï¼Œå¹¶æ·»åŠ åˆ°åˆ—è¡¨ä¸­ Student s1 = new Student(\u0026#34;è‡³å°Šå®\u0026#34;, 21, 181.2); Student s2 = new Student(\u0026#34;èœ˜è››ç²¾\u0026#34;, 21, 181.3); Student s3 = new Student(\u0026#34;ç‰›é­”ç‹\u0026#34;, 20, 165.3); Student s4 = new Student(\u0026#34;èå­ç²¾\u0026#34;, 20, 165.2); Student s5 = new Student(\u0026#34;èœ˜è››ç²¾\u0026#34;, 22, 181.3); Collections.addAll(students, s1, s2, s3, s4, s5); // ä½¿ç”¨æµå¯¹å­¦ç”Ÿä¿¡æ¯è¿›è¡Œç­›é€‰å’Œæ’åºï¼Œå¹¶æ‰“å°ç»“æœ students.stream().filter(s -\u0026gt; s.getAge() \u0026gt;= 10 \u0026amp;\u0026amp; s.getAge() \u0026lt;= 30) .sorted((o1, o2) -\u0026gt; o2.getAge() - o1.getAge()) .forEach(System.out::println); System.out.println(\u0026#34;--------------\u0026#34;); // ä½¿ç”¨æµå¯¹å­¦ç”Ÿä¿¡æ¯æŒ‰èº«é«˜è¿›è¡Œæ’åºï¼Œå¹¶æ‰“å°èº«é«˜æœ€é«˜çš„å‰ä¸‰åå­¦ç”Ÿ students.stream().sorted(((o1, o2) -\u0026gt; Double.compare(o2.getHeight(), o1.getHeight()))) .limit(3) .forEach(System.out::println); System.out.println(\u0026#34;---------------\u0026#34;); // ä½¿ç”¨æµå¯¹å­¦ç”Ÿä¿¡æ¯æŒ‰èº«é«˜è¿›è¡Œæ’åºï¼Œå¹¶æ‰“å°èº«é«˜æœ€ä½çš„ä¸¤åå­¦ç”Ÿ students.stream().sorted(((o1, o2) -\u0026gt; Double.compare(o2.getHeight(), o1.getHeight()))) .skip(students.size() - 2) .forEach(System.out::println); System.out.println(\u0026#34;-----------------\u0026#34;); // ä½¿ç”¨æµå¯¹å­¦ç”Ÿä¿¡æ¯è¿›è¡Œç­›é€‰ï¼Œæ‰¾å‡ºèº«é«˜å¤§äº168çš„å­¦ç”Ÿï¼Œå¹¶æ‰“å°ä»–ä»¬çš„å§“åï¼ˆå»é‡ï¼‰ students.stream() .filter(s -\u0026gt; s.getHeight() \u0026gt; 168) .map(Student::getName) .distinct() .forEach(System.out::println); // ä½¿ç”¨Stream.concatæ–¹æ³•å°†ä¸¤ä¸ªæµåˆå¹¶ï¼Œç„¶åæ‰“å°åˆå¹¶åçš„ç»“æœ Stream\u0026lt;Student\u0026gt; s11 = Stream.of(s1, s2); Stream\u0026lt;Student\u0026gt; s12 = Stream.of(s3, s4); Stream\u0026lt;Student\u0026gt; concat = Stream.concat(s11, s12); concat.forEach(System.out::println); } Streamç»ˆç»“æ–¹æ³• public static void main(String[] args) { // åˆ›å»ºå­¦ç”Ÿåˆ—è¡¨ List\u0026lt;Student\u0026gt; students = new ArrayList\u0026lt;\u0026gt;(); // åˆ›å»ºå­¦ç”Ÿå¯¹è±¡å¹¶æ·»åŠ åˆ°åˆ—è¡¨ä¸­ Student s1 = new Student(\u0026#34;è‡³å°Šå®\u0026#34;, 21, 181.2); Student s2 = new Student(\u0026#34;èœ˜è››ç²¾\u0026#34;, 21, 181.3); Student s3 = new Student(\u0026#34;ç‰›é­”ç‹\u0026#34;, 20, 165.3); Student s4 = new Student(\u0026#34;èå­ç²¾\u0026#34;, 20, 165.2); Student s5 = new Student(\u0026#34;èœ˜è››ç²¾\u0026#34;, 21, 181.3); Collections.addAll(students, s1, s2, s3, s4, s5); // ä½¿ç”¨æµè¿‡æ»¤èº«é«˜å¤§äº168çš„å­¦ç”Ÿï¼Œå¹¶å°†ç»“æœæ”¶é›†åˆ°åˆ—è¡¨ä¸­ List\u0026lt;Student\u0026gt; res1 = students.stream() .filter(s -\u0026gt; s.getHeight() \u0026gt; 168) .collect(Collectors.toList()); System.out.println(res1); // ä½¿ç”¨æµè¿‡æ»¤èº«é«˜å¤§äº168çš„å­¦ç”Ÿï¼Œå¹¶å°†ç»“æœæ”¶é›†åˆ°é›†åˆä¸­ Set\u0026lt;Student\u0026gt; res2 = students.stream() .filter(s -\u0026gt; s.getHeight() \u0026gt; 168) .collect(Collectors.toSet()); System.out.println(res2); // ä½¿ç”¨æµè¿‡æ»¤èº«é«˜å¤§äº168çš„å­¦ç”Ÿï¼Œå»é™¤é‡å¤çš„å­¦ç”Ÿå¯¹è±¡ï¼Œå¹¶å°†å§“åå’Œèº«é«˜æ˜ å°„åˆ°Mapä¸­ Map\u0026lt;String, Double\u0026gt; res3 = students.stream() .filter(s -\u0026gt; s.getHeight() \u0026gt; 168) .distinct() .collect(Collectors.toMap(a -\u0026gt; a.getName(), a -\u0026gt; a.getHeight())); System.out.println(res3); // ä½¿ç”¨æµè¿‡æ»¤èº«é«˜å¤§äº168çš„å­¦ç”Ÿï¼Œå»é™¤é‡å¤çš„å­¦ç”Ÿå¯¹è±¡ï¼Œå¹¶å°†ç»“æœè½¬æ¢ä¸ºå¯¹è±¡æ•°ç»„ Object[] res4 = students.stream() .filter(s -\u0026gt; s.getHeight() \u0026gt; 168) .distinct() .toArray(); System.out.println(Arrays.toString(res4)); // ä½¿ç”¨æµè¿‡æ»¤èº«é«˜å¤§äº168çš„å­¦ç”Ÿï¼Œå»é™¤é‡å¤çš„å­¦ç”Ÿå¯¹è±¡ï¼Œå¹¶å°†ç»“æœè½¬æ¢ä¸ºæŒ‡å®šé•¿åº¦çš„å­¦ç”Ÿæ•°ç»„ Student[] res5 = students.stream() .filter(s -\u0026gt; s.getHeight() \u0026gt; 168) .distinct() .toArray(len -\u0026gt; new Student[len]); System.out.println(Arrays.toString(res5)); } æ€»ç»“ç¨‹åºçš„çŸ¥è¯†ç‚¹ï¼Œå¹¶å°†çŸ¥è¯†ç‚¹å†™åˆ°ç¨‹åºæ³¨é‡Šä¸­å» ","permalink":"https://kennems.github.io/posts/tech/java20%E5%A4%A9%E9%80%9F%E6%88%90%E8%BF%9B%E9%98%B6%E8%AF%BE%E7%A8%8B2/","summary":"Java20å¤©é€Ÿæˆâ€”â€”è¿›é˜¶è¯¾ç¨‹(2) æ­£åˆ™è¡¨è¾¾å¼ ç¬¦å· å«ä¹‰ ä¸¾ä¾‹ [] åŒ¹é…æ–¹æ‹¬å·å†…çš„ä»»ä¸€å­—ç¬¦ [abc] ^ åŒ¹é…é™¤æŒ‡å®šå­—ç¬¦å¤–çš„ä»»æ„å­—ç¬¦ [^abc] \u0026amp;\u0026amp; åŒ¹é…ä¸¤ä¸ªå­—ç¬¦é›†çš„äº¤é›†ï¼Œéœ€","title":"Java20å¤©é€Ÿæˆâ€”â€”è¿›é˜¶è¯¾ç¨‹(2)"},{"content":"LeetCodeç¬¬ 393 åœºå‘¨èµ› ç¬¬ä¸‰é¢˜3116. å•é¢å€¼ç»„åˆçš„ç¬¬ K å°é‡‘é¢ é¢˜ç›®å¤§æ„ï¼š ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„coinsè¡¨ç¤ºä¸åŒé¢é¢çš„ç¡¬å¸ï¼Œå¦ç»™å®šä¸€ä¸ªæ•´æ•°kã€‚ä½ æœ‰æ— é™é‡çš„æ¯ç§é¢é¢çš„ç¡¬å¸ï¼Œä½†æ˜¯ï¼Œä½ ä¸èƒ½ç»„åˆä½¿ç”¨ä¸åŒé¢é¢çš„ç¡¬å¸ã€‚è¦æ±‚è¿”å›ä½¿ç”¨è¿™äº›ç¡¬å¸èƒ½åˆ¶é€ çš„ç¬¬kthå°é‡‘é¢ã€‚\nå®ç°æ€è·¯ï¼š\né¦–å…ˆï¼Œå¯¹äºç»™å®šçš„ç¡¬å¸æ•°ç»„ï¼Œæˆ‘ä»¬éœ€è¦æ±‚å‡ºå®ƒä»¬çš„æ‰€æœ‰å¯èƒ½çš„ç»„åˆæ–¹å¼ã€‚ ä½¿ç”¨ä½è¿ç®—æ¥æšä¸¾æ‰€æœ‰çš„ç»„åˆæ–¹å¼ï¼Œå¯¹äºæ•°ç»„ä¸­çš„æ¯ä¸ªç¡¬å¸ï¼Œåˆ†åˆ«è€ƒè™‘é€‰å–å’Œä¸é€‰å–ä¸¤ç§æƒ…å†µï¼Œé€šè¿‡ä½è¿ç®—å°†è¿™ä¸¤ç§æƒ…å†µæšä¸¾å‡ºæ¥ã€‚ å¯¹äºæ¯ç§ç»„åˆæ–¹å¼ï¼Œè®¡ç®—å…¶å¯¹åº”çš„æœ€å°å…¬å€æ•°ï¼ˆLCMï¼‰ä½œä¸ºè¯¥ç»„åˆçš„é‡‘é¢ã€‚ æ ¹æ®ç»„åˆçš„å¥‡å¶æ€§ï¼Œå°†é‡‘é¢çš„æ­£è´Ÿå·è®°å½•ä¸‹æ¥ï¼Œå¹¶å­˜å‚¨åœ¨åˆ—è¡¨lsä¸­ã€‚ åˆ©ç”¨äºŒåˆ†æŸ¥æ‰¾æ¥æ±‚è§£ç¬¬kthå°çš„é‡‘é¢ï¼Œé€šè¿‡ä¸æ–­è°ƒæ•´å·¦å³è¾¹ç•Œï¼Œç›´åˆ°æ‰¾åˆ°æ»¡è¶³æ¡ä»¶çš„é‡‘é¢ã€‚ è¿”å›æœ€ç»ˆæ‰¾åˆ°çš„é‡‘é¢ä½œä¸ºç»“æœã€‚ è¿™ç§æ–¹æ³•åˆ©ç”¨äº†ä½è¿ç®—å’ŒäºŒåˆ†æŸ¥æ‰¾çš„æ€æƒ³ï¼Œå¯ä»¥åœ¨è¾ƒçŸ­çš„æ—¶é—´å†…æ±‚è§£å‡ºç»“æœã€‚\nclass Solution: def findKthSmallest(self, coins: List[int], k: int) -\u0026gt; int: n = len(coins) ls = [] for i in range(1, 1\u0026lt;\u0026lt;n): Lcm = 1 for j, x in enumerate(coins): if i\u0026gt;\u0026gt;j \u0026amp; 1: Lcm = lcm(Lcm, x) ls.append((1, Lcm)) if i.bit_count()\u0026amp;1 else ls.append((-1, Lcm)) l, r = 1, int(5e10) while l\u0026lt;r: mid = l+r\u0026gt;\u0026gt;1 cnt = 0 for sign, val in ls: cnt += sign*(mid//val) if cnt\u0026gt;=k: r = mid else: l = mid+1 return l ç¬¬å››é¢˜3117. åˆ’åˆ†æ•°ç»„å¾—åˆ°æœ€å°çš„å€¼ä¹‹å’Œ é¢˜ç›®å¤§æ„ï¼š ç»™å®šä¸¤ä¸ªæ•°ç»„numså’ŒandValuesï¼Œé•¿åº¦åˆ†åˆ«ä¸ºnå’Œmã€‚æ•°ç»„çš„å€¼ç­‰äºè¯¥æ•°ç»„çš„æœ€åä¸€ä¸ªå…ƒç´ ã€‚éœ€è¦å°†numsåˆ’åˆ†ä¸ºmä¸ªä¸ç›¸äº¤çš„è¿ç»­å­æ•°ç»„ï¼Œå¯¹äºç¬¬ithä¸ªå­æ•°ç»„[li, ri]ï¼Œå­æ•°ç»„å…ƒç´ çš„æŒ‰ä½ANDè¿ç®—ç»“æœç­‰äºandValues[i]ã€‚è¿”å›å°†numsåˆ’åˆ†ä¸ºmä¸ªå­æ•°ç»„æ‰€èƒ½å¾—åˆ°çš„å¯èƒ½çš„æœ€å°å­æ•°ç»„å€¼ä¹‹å’Œã€‚å¦‚æœæ— æ³•å®Œæˆè¿™æ ·çš„åˆ’åˆ†ï¼Œåˆ™è¿”å›-1ã€‚\nå®ç°æ€è·¯ï¼š\nä½¿ç”¨åŠ¨æ€è§„åˆ’æ¥è§£å†³æ­¤é—®é¢˜ï¼Œå…·ä½“æ¥è¯´ï¼Œå¯ä»¥é‡‡ç”¨é€’å½’åŠ è®°å¿†åŒ–æœç´¢çš„æ–¹æ³•ã€‚ å®šä¹‰dfså‡½æ•°ç”¨äºé€’å½’æ±‚è§£ï¼Œå…¶ä¸­iè¡¨ç¤ºå½“å‰å¤„ç†åˆ°numsçš„ç¬¬iä¸ªå…ƒç´ ï¼Œjè¡¨ç¤ºå½“å‰å¤„ç†åˆ°andValuesçš„ç¬¬jä¸ªå…ƒç´ ï¼Œkè¡¨ç¤ºå½“å‰å­æ•°ç»„çš„æŒ‰ä½ANDè¿ç®—ç»“æœã€‚ åœ¨dfså‡½æ•°ä¸­ï¼Œé¦–å…ˆè¿›è¡Œè¾¹ç•Œæ¡ä»¶çš„åˆ¤æ–­ï¼Œå¦‚æœiç­‰äºnï¼Œè¡¨ç¤ºnumså·²ç»å¤„ç†å®Œæ¯•ï¼Œåˆ™è¿”å›0ï¼ˆå¦‚æœjç­‰äºmï¼‰æˆ–è€…æ­£æ— ç©·ï¼ˆå¦‚æœjä¸ç­‰äºmï¼‰ã€‚ ç„¶åï¼Œå¯¹å½“å‰nums[i]è¿›è¡ŒæŒ‰ä½ANDè¿ç®—ï¼Œå¹¶æ›´æ–°kçš„å€¼ã€‚å¦‚æœæ›´æ–°åçš„kå°äºandValues[j]ï¼Œåˆ™è¿”å›æ­£æ— ç©·ã€‚ å¦‚æœæ›´æ–°åçš„kç­‰äºandValues[j]ï¼Œåˆ™é€’å½’è°ƒç”¨dfså‡½æ•°ç»§ç»­å¤„ç†ä¸‹ä¸€ä¸ªå…ƒç´ ï¼ŒåŒæ—¶æ›´æ–°iå’Œjï¼Œå¹¶å°†ké‡ç½®ä¸º-1ã€‚é€’å½’è°ƒç”¨çš„ç»“æœåŠ ä¸Šnums[i]çš„å€¼å³ä¸ºå½“å‰åˆ’åˆ†æƒ…å†µçš„å­æ•°ç»„å€¼ä¹‹å’Œã€‚ æœ€åï¼Œè¿”å›æ‰€æœ‰åˆ’åˆ†æƒ…å†µä¸­çš„æœ€å°å€¼ä½œä¸ºç­”æ¡ˆï¼Œå¦‚æœç­”æ¡ˆä¸ºæ­£æ— ç©·ï¼Œåˆ™è¿”å›-1ã€‚ è¿™ç§æ–¹æ³•åˆ©ç”¨äº†é€’å½’å’Œè®°å¿†åŒ–æœç´¢çš„æ€æƒ³ï¼Œé¿å…äº†é‡å¤è®¡ç®—ï¼Œæé«˜äº†æ•ˆç‡ã€‚\nclass Solution: def minimumValueSum(self, nums: List[int], andValues: List[int]) -\u0026gt; int: n = len(nums) m = len(andValues) @cache def dfs(i, j, k): if i==n: return 0 if j==m else inf if j==m: return inf k\u0026amp;=nums[i] if k\u0026lt;andValues[j]: return inf res = dfs(i+1, j, k) if k==andValues[j]: res = min(res, dfs(i+1, j+1, -1)+nums[i]) return res ans = dfs(0, 0, -1) return ans if ans\u0026lt;inf else -1 ","permalink":"https://kennems.github.io/posts/tech/leetcode%E7%AC%AC-393-%E5%9C%BA%E5%91%A8%E8%B5%9B/","summary":"LeetCodeç¬¬ 393 åœºå‘¨èµ› ç¬¬ä¸‰é¢˜3116. å•é¢å€¼ç»„åˆçš„ç¬¬ K å°é‡‘é¢ é¢˜ç›®å¤§æ„ï¼š ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„coinsè¡¨ç¤ºä¸åŒé¢é¢çš„ç¡¬å¸ï¼Œå¦ç»™å®šä¸€ä¸ªæ•´æ•°kã€‚ä½ ","title":"LeetCodeå‘¨èµ›240414"},{"content":"è¿›é˜¶è¯¾ç¨‹(1) OOP static é™æ€ï¼Œ å¯ä»¥ä¿®é¥°æˆå‘˜å˜é‡ï¼Œæˆå‘˜æ–¹æ³• æˆå‘˜å˜é‡æŒ‰ç…§æœ‰æ— staticä¿®é¥°ï¼Œåˆ†ä¸ºä¸¤ç§ ç±»å˜é‡ ï¼š æœ‰staticä¿®é¥°ï¼Œå±äºç±»ï¼Œåœ¨è®¡ç®—æœºé‡Œåªæœ‰ä¸€ä»½ï¼Œä¼šè¢«ç±»çš„å…¨éƒ¨å¯¹è±¡å…±äº« å®ä¾‹å˜é‡ï¼ˆå¯¹è±¡çš„å˜é‡ï¼‰ï¼šæ— staticä¿®é¥°ï¼Œå±äºæ¯ä¸ªå¯¹è±¡ // ç±»å˜é‡æ¨èèµ‹å€¼æ–¹å¼ Student.name = \u0026#34;Java\u0026#34;; // ä¸æ¨èèµ‹å€¼æ–¹å¼ Student s1 = new Student(); s1.name = \u0026#34;True Java\u0026#34;; Student s2 = new Student(); s2.name = \u0026#34;False Java\u0026#34;; System.out.println(s2.name); //False Java System.out.println(Student.name); //False Java // æˆå‘˜å˜é‡ s1.age = 25; s2.age = 15; System.out.println(s1.age); //25 System.out.println(s2.age); //15 //Userç±» public static int number; public User(){ number+=1; //ç±»ä¸­è®¿é—®è‡ªå·±çš„å˜é‡å¯ä»¥ä¸å†™ User(). } //Testç±» public static void main(String[] args) { User u1 = new User(); User u2 = new User(); User u3 = new User(); System.out.println(User.number); //3 } ç±»æ–¹æ³•ï¼šæœ‰staticä¿®é¥°çš„æˆå‘˜æ–¹æ³•ï¼Œå±äºç±»ã€‚ å®ä¾‹æ–¹æ³•ï¼šæ— staticä¿®é¥°çš„æˆå‘˜æ–¹æ³•ï¼Œå±äºå¯¹è±¡ //Student double score; public static void printHelloWorld(){ System.out.println(\u0026#34;Hello World\u0026#34;); System.out.println(\u0026#34;Hello World\u0026#34;); } public void printPass(){ System.out.println(\u0026#34;æˆç»©ï¼š\u0026#34; + (score \u0026gt;= 60 ? \u0026#34;åŠæ ¼\u0026#34; : \u0026#34;ä¸åŠæ ¼\u0026#34;)); } //Test Student.printHelloWorld();//Hello World Hello World Student s = new Student(); s.score = 100; s.printPass(); //æˆç»©ï¼šåŠæ ¼ ç±»æ–¹æ³•çš„å¸¸è§åº”ç”¨æ¡ˆä¾‹ ç±»æ–¹æ³•æœ€å¸¸è§çš„åº”ç”¨åœºæ™¯æ˜¯åšå·¥å…·ç±» å·¥å…·ç±»ï¼šå·¥å…·ç±»ä¸­çš„æ–¹æ³•éƒ½æ˜¯ä¸€äº›ç±»æ–¹æ³•ï¼Œæ¯ä¸ªæ–¹æ³•éƒ½æ˜¯ç”¨æ¥å®Œæˆä¸€ä¸ªåŠŸèƒ½çš„ï¼Œå·¥å…·ç±»æ˜¯ç»™å¼€å‘äººå‘˜å…±åŒä½¿ç”¨çš„\nå¯ä»¥æé«˜ä»£ç å¤ç”¨æ€§ï¼šè°ƒç”¨æ–¹ä¾¿ï¼Œæé«˜äº†å¼€å‘æ•ˆç‡\nä½¿ç”¨ç±»æ–¹æ³•ã€å®ä¾‹æ–¹æ³•æ—¶çš„å‡ ç‚¹æ³¨æ„äº‹é¡¹\nç±»æ–¹æ³•ä¸­å¯ä»¥ç›´æ¥è®¿é—®ç±»çš„æˆå‘˜ï¼Œä¸å¯ä»¥ç›´æ¥è®¿é—®å®ä¾‹æˆå‘˜ å®ä¾‹æ–¹æ³•ä¸­æ—¢å¯ä»¥ç›´æ¥è®¿é—®ç±»æˆå‘˜ï¼Œä¹Ÿå¯ä»¥ç›´æ¥è®¿é—®å®ä¾‹æˆå‘˜ å®ä¾‹æ–¹æ³•ä¸­å¯ä»¥å‡ºç°thiså…³é”®å­—ï¼Œç±»æ–¹æ³•ä¸­ä¸å¯ä»¥å‡ºç°thiså…³é”®å­— ä»£ç å— é™æ€ä»£ç å— æ ¼å¼ ï¼š static{ } ç‰¹ç‚¹ï¼šç±»åŠ è½½æ—¶è‡ªåŠ¨æ‰§è¡Œï¼Œç”±äºç±»åªä¼šåŠ è½½ä¸€æ¬¡ï¼Œæ‰€ä»¥é™æ€ä»£ç å—åªä¼šæ‰§è¡Œä¸€æ¬¡ ä½œç”¨ï¼šå®Œæˆç±»çš„åˆå§‹åŒ–ï¼Œä¾‹å¦‚ï¼šå¯¹ç±»å˜é‡çš„åˆå§‹åŒ–èµ‹å€¼ å®ä¾‹ä»£ç å—ï¼š æ ¼å¼ï¼š{ } ç‰¹ç‚¹ï¼šæ¯æ¬¡åˆ›å»ºå¯¹è±¡æ—¶ï¼Œæ‰§è¡Œå®ä¾‹ä»£ç å—ï¼Œå¹¶åœ¨æ„é€ å™¨å‰æ‰§è¡Œ ä½œç”¨ï¼šå’Œæ„é€ å™¨ä¸€æ ·ï¼Œéƒ½æ˜¯ç”¨æ¥å®Œæˆå¯¹è±¡çš„åˆå§‹åŒ–çš„ï¼Œä¾‹å¦‚ï¼šå¯¹å®ä¾‹å˜é‡è¿›è¡Œåˆå§‹åŒ–èµ‹å€¼ å•ä¾‹è®¾è®¡æ¨¡å¼ è®¾è®¡æ¨¡å¼ï¼ˆDesign patternï¼‰ å°±æ˜¯è§£å†³é—®é¢˜çš„æœ€ä¼˜è§£ã€‚\nå•ä¾‹è®¾è®¡æ¨¡å¼ï¼šç¡®ä¿ä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªå¯¹è±¡\né¥¿æ±‰å¼å•ä¾‹ç±»\næŠŠç±»çš„æ„é€ å™¨ç§æœ‰ å®šä¹‰ä¸€ä¸ªç±»å˜é‡è®°ä¸ºç±»çš„ä¸€ä¸ªå¯¹è±¡ å®šä¹‰ä¸€ä¸ªç±»æ–¹æ³•ï¼Œè¿”å›å¯¹è±¡ public class A { private static A a = new A(); private A(){ } public static A getObject(){ return a; } } ç»§æ‰¿ ç»§æ‰¿çš„å¥½å¤„ï¼šå‡å°‘é‡å¤ä»£ç çš„ç¼–å†™\npublic class people { private String name; public String getName(){ return this.name; } public void setName(String name){ this.name = name; } } public class teacher extends people{ private String skill; public String getSkill() { return skill; } public void setSkill(String skill) { this.skill = skill; } public void printInfo(){ System.out.println(getName() + \u0026#34;å…·å¤‡çš„æŠ€èƒ½ ï¼š \u0026#34; + skill); } } public class Test { public static void main(String[] args) { teacher t1 = new teacher(); t1.setName(\u0026#34;Kennem\u0026#34;); t1.setSkill(\u0026#34;Java\u0026#34;); System.out.println(t1.getName()); //Kennem System.out.println(t1.getSkill()); //Java t1.printInfo(); //Kennemå…·å¤‡çš„æŠ€èƒ½ ï¼š Java } } ç»§æ‰¿çš„æ³¨æ„äº‹é¡¹ï¼š\næƒé™ä¿®é¥°ç¬¦ å•ç»§æ‰¿ï¼ŒObjectç±» æ–¹æ³•é‡å†™ å­ç±»ä¸­è®¿é—®å…¶ä»–æˆå‘˜çš„ç‰¹ç‚¹ å­ç±»æ„é€ å™¨çš„ç‰¹ç‚¹ æ³¨æ„äº‹é¡¹çš„å°ç»“ ä¿®é¥°ç¬¦ æœ¬ç±»ä¸­ åŒä¸€ä¸ªåŒ…ä¸‹çš„å…¶ä»–ç±»ç»§æ‰¿ ä»»æ„åŒ…ä¸‹çš„å­ç±»ç»§æ‰¿ ä»»æ„åŒ…ä¸‹çš„ä»»ä½•ç±»ç»§æ‰¿ private âœ“ ç¼ºçœ âœ“ âœ“ protected âœ“ âœ“ âœ“ public âœ“ âœ“ âœ“ âœ“ æ³¨æ„ï¼šç”¨protectedä¿®é¥°ï¼Œåªèƒ½åœ¨å­ç±»ä¸­è®¿é—®ï¼Œè€Œä¸æ˜¯å­ç±»çš„å¯¹è±¡è®¿é—®\nå•ç»§æ‰¿ Javaä¸æ”¯æŒå¤šç»§æ‰¿ï¼Œæ”¯æŒå¤šå±‚ç»§æ‰¿\nObjectç±» Objectç±»æ˜¯ä»»ä½•ç±»çš„çˆ¶ç±»ã€‚\næ–¹æ³•é‡å†™ é‡å†™æ³¨æ„äº‹é¡¹\nä½¿ç”¨Overrideæ³¨è§£\n@Override public void print(){ System.out.println(\u0026#34;88888888\u0026#34;); } @Override public void print2(){ System.out.println(\u0026#34;8\u0026#34;); } å­ç±»å¤å†™çˆ¶ç±»æ–¹æ³•æ—¶ï¼Œè®¿é—®æƒé™å¿…é¡»å¤§äºæˆ–è€…ç­‰äºçˆ¶ç±»è¯¥æ–¹æ³•çš„æƒé™ï¼ˆpublc -\u0026gt; protected -\u0026gt; ç¼ºçœï¼‰\né‡å†™çš„æ–¹æ³•è¿”å›å€¼ç±»å‹ï¼Œå¿…é¡»ä¸è¢«é‡å†™æ–¹æ³•çš„è¿”å›å€¼ç±»å‹ä¸€è‡´ï¼Œæˆ–è€…èŒƒå›´æ›´å°\nç§æœ‰æ–¹æ³•ã€é™æ€æ–¹æ³•ä¸èƒ½è¢«é‡å†™\nå£°æ˜ä¸å˜ï¼Œé‡æ–°å®ç°\ntoString()æ–¹æ³•é‡å†™\n@Override public String toString() { return \u0026#34;Student{\u0026#34; + \u0026#34;name=\u0026#39;\u0026#34; + name + \u0026#39;\\\u0026#39;\u0026#39; + \u0026#34;, age=\u0026#34; + age + \u0026#39;}\u0026#39;; } å­åˆ—æ„é€ å™¨çš„ç‰¹ç‚¹ï¼š\nå­ç±»çš„å…¨éƒ¨æ„é€ å™¨ï¼Œéƒ½ä¼šå…ˆè°ƒç”¨çˆ¶ç±»çš„æ„é€ å™¨ï¼Œå†æ‰§è¡Œè‡ªå·±çš„æ„é€ å™¨ã€‚ å­ç±»æ„é€ å™¨æ˜¯ç¬¦åˆå®ç°è°ƒç”¨çˆ¶ç±»æ„é€ å™¨çš„ï¼š é»˜è®¤æƒ…å†µä¸‹ï¼Œå­ç±»å…¨éƒ¨æ„é€ å™¨çš„ç¬¬ä¸€è¡Œéƒ½æ˜¯super()ï¼ˆé»˜è®¤éƒ½æœ‰ï¼‰ï¼Œå®ƒä¼šè°ƒç”¨çˆ¶ç±»çš„æ— å‚æ•°æ„é€ å™¨ã€‚ å¦‚æœçˆ¶ç±»æ²¡æœ‰æ— å‚æ•°æ„é€ å™¨ï¼Œåˆ™æˆ‘ä»¬å¿…é¡»å†å­ç±»æ„é€ å™¨çš„ç¬¬ä¸€è¡Œæ‰‹å†™super(...)ï¼Œ æŒ‡å®šå»è°ƒç”¨çˆ¶ç±»çš„æœ‰å‚æ•°æ„é€ å™¨ã€‚ class Student extends People{ private String skill; public Student(String name, int age, String skill){ super(name, age); //è°ƒç”¨çˆ¶ç±»çš„æœ‰å‚æ„é€ å™¨ çˆ¶ç±»ä¸­nameå’Œageæ„é€ å™¨ this.skill = skill; } public String getSkill() { return skill; } public void setSkill(String skill) { this.skill = skill; } } è¡¥å……çŸ¥è¯†ï¼šthis(...)è°ƒç”¨å…„å¼Ÿæ„é€ å™¨\nä»»æ„ç±»çš„æ„é€ å™¨ä¸­ï¼Œæ˜¯å¯ä»¥é€šè¿‡this(...)å»è°ƒç”¨è¯¥ç±»çš„å…¶ä»–æ„é€ å™¨çš„ã€‚ this(...) å’Œ super(...) ä½¿ç”¨æ—¶çš„æ³¨æ„äº‹é¡¹ this(...)ã€super(...)éƒ½åªèƒ½æ”¾åœ¨æ„é€ å™¨çš„ç¬¬ä¸€è¡Œï¼Œå› æ­¤ï¼Œæœ‰äº†this(...)å°±ä¸èƒ½å†™super(...)äº†ï¼Œåä¹‹äº¦ç„¶ public Boy(String name, int age) { this(name, age, \u0026#34;é»‘é©¬ç¨‹åºå‘˜\u0026#34;); } public Boy(String name, int age, String schoolName) { this.name = name; this.age = age; this.schoolName = schoolName; } å¤šæ€ å¤šæ€æ˜¯åœ¨ç»§æ‰¿/å®ç°æƒ…å†µä¸‹çš„ä¸€ç§ç°è±¡ï¼Œè¡¨ç°ä¸ºï¼šå¯¹è±¡å¤šæ€ï¼Œè¡Œä¸ºå¤šæ€ã€‚\nåœ¨å¤šæ€å½¢å¼ä¸‹ï¼Œå³è¾¹å¯¹è±¡æ˜¯è§£è€¦åˆçš„ï¼Œæ›´åäºæ‰©å±•å’Œç»´æŠ¤ã€‚ public class People { public String name = \u0026#34;æˆ‘æ˜¯äºº\u0026#34;; public void run(){ System.out.println(\u0026#34;äººå¯ä»¥è·‘\u0026#34;); } } public class Student extends People{ public String name = \u0026#34;æˆ‘æ˜¯å­¦ç”Ÿ\u0026#34;; @Override public void run() { System.out.println(\u0026#34;å­¦ç”Ÿè·‘å¾—å¾ˆå¿«ï¼\u0026#34;); } public void test(){ System.out.println(\u0026#34;å­¦ç”Ÿè¦è€ƒè¯•...\u0026#34;); } } public class Teacher extends People{ public String name = \u0026#34;æˆ‘æ˜¯è€å¸ˆ\u0026#34;; @Override public void run() { System.out.println(\u0026#34;è€å¸ˆè·‘çš„æ°”å–˜ååï¼\u0026#34;); } } public class Test { public static void main(String[] args) { People p = new People(); System.out.println(p.name); People p1 = new Student(); System.out.println(p1.name); p1.run(); //ç¼–è¯‘çœ‹çˆ¶ç±»ï¼Œ è¿è¡Œçœ‹å­ç±» People p2 = new Teacher(); System.out.println(p2.name); p2.run(); } } if(p instanceof Student){ Student s = (Student) p; s.test(); }else if(p instanceof Teacher){ Teacher t = (Teacher) p; t.work(); } public class People { public String name = \u0026#34;æˆ‘æ˜¯äºº\u0026#34;; public void run(){ System.out.println(\u0026#34;äººå¯ä»¥è·‘\u0026#34;); } } public class Student extends People { public String name = \u0026#34;æˆ‘æ˜¯å­¦ç”Ÿ\u0026#34;; @Override public void run() { System.out.println(\u0026#34;å­¦ç”Ÿè·‘å¾—å¾ˆå¿«ï¼\u0026#34;); } public void test(){ System.out.println(\u0026#34;å­¦ç”Ÿè¦è€ƒè¯•\u0026#34;); } } public class Teacher extends People { public String name = \u0026#34;æˆ‘æ˜¯è€å¸ˆ\u0026#34;; @Override public void run() { System.out.println(\u0026#34;è€å¸ˆè·‘çš„æ°”å–˜ååï¼\u0026#34;); } public void work(){ System.out.println(\u0026#34;è€å¸ˆè¦ä¸Šç­\u0026#34;); } } final finalå…³é”®å­—æ˜¯æœ€ç»ˆçš„æ„æ€ï¼Œå¯ä»¥ä¿®é¥°ï¼ˆç±»ï¼Œ æ–¹æ³•ï¼Œ å˜é‡ï¼‰ ä¿®é¥°ç±»ï¼šè¯¥ç±»è¢«æˆä¸ºæœ€ç»ˆç±»ï¼Œç‰¹ç‚¹æ˜¯ä¸èƒ½è¢«ç»§æ‰¿äº† ä¿®é¥°æ–¹æ³•ï¼šè¯¥æ–¹æ³•è¢«ç§°ä¸ºæœ€ç»ˆæ–¹æ³•ï¼Œç‰¹ç‚¹æ˜¯ä¸èƒ½è¢«é‡å†™äº† ä¿®é¥°å˜é‡ï¼šè¯¥å˜é‡åªèƒ½è¢«èµ‹å€¼ä¸€æ¬¡ public class Test { // 3.å¸¸é‡ï¼Œå»ºè®®åç§°å…¨éƒ¨å¤§å†™ï¼Œå¤šä¸ªå•è¯ä¸‹åˆ’çº¿è¿æ¥ public static final String CURRENT_NAME = \u0026#34;Kennem\u0026#34;; public static void main(String[] args) { // final double pi = 3.14; //pi = 3.1; æŠ¥é”™ï¼Œfinalä¿®é¥°çš„å˜é‡ä¸èƒ½ä¿®æ”¹ final int[] arr = {11, 22, 33}; arr[1] = 13; // 4.finalä¿®é¥°çš„åœ°å€ä¸èƒ½å˜ï¼Œä½†åœ°å€å†…çš„å†…å®¹å¯ä»¥å˜ } } final class A{ // 1.final ä¿®é¥°ç±»ï¼Œç±»ä¸èƒ½è¢«ç»§æ‰¿äº† } // 2.final ä¿®é¥°æ–¹æ³•ï¼Œæ–¹æ³•ä¸èƒ½è¢«é‡å†™äº† class C{ public final void test(){ } } class D extends C{ } å¸¸é‡ ä½¿ç”¨äº†static finalä¿®é¥°çš„æˆå‘˜å˜é‡è¢«ç§°ä¸ºå¸¸é‡\nä½œç”¨ï¼šé€šå¸¸ç”¨äºè®°å½•ç³»ç»Ÿçš„é…ç½®ä¿¡æ¯\nä½¿ç”¨å¸¸é‡è®°å½•ç³»ç»Ÿé…ç½®ä¿¡æ¯çš„ä¼˜åŠ¿ï¼Œæ‰§è¡ŒåŸç†\nä»£ç å¯è¯»æ€§æ›´å¥½ï¼Œå¯ç»´æŠ¤æ€§ä¹Ÿæ›´å¥½ ç¨‹åºç¼–è¯‘åï¼Œå¸¸é‡ä¼šè¢«\u0026quot;å®æ›¿æ¢\u0026quot;ï¼›å‡ºç°å¸¸é‡çš„åœ°æ–¹å…¨éƒ¨ä¼šè¢«æ›¿æ¢æˆå…¶è®°ä½çš„å­—é¢é‡ï¼Œè¿™æ ·å¯ä»¥ä¿è¯ä½¿ç”¨å¸¸é‡å’Œç›´æ¥ç”¨å­—é¢é‡çš„æ€§èƒ½æ˜¯ä¸€æ ·çš„ã€‚ æŠ½è±¡ç±» public abstract class A { private String name; public static String schoolName; public abstract void run(); } public class B extends A{ @Override public void run() { System.out.println(\u0026#34;run\u0026#34;); } } æŠ½è±¡ç±»çš„å¥½å¤„ï¼š\nçˆ¶ç±»çŸ¥é“æ¯ä¸ªå­ç±»éƒ½è¦åšæŸä¸ªè¡Œä¸ºï¼Œä½†æ¯ä¸ªå­ç±»è¦åšçš„æƒ…å†µä¸ä¸€æ ·ï¼Œçˆ¶ç±»å°±å®šä¹‰æˆæŠ½è±¡æ–¹æ³•ï¼Œäº¤ç»™å­ç±»å»é‡å†™å®ç°ï¼Œæˆ‘ä»¬è®¾è®¡è¿™æ ·çš„æŠ½è±¡ç±»ï¼Œå°±æ˜¯ä¸ºäº†æ›´å¥½çš„æ”¯æŒå¤šæ€ã€‚ æŠ½è±¡ç±»å¯ä»¥åˆ¶ä½œæ¨¡æ¿ç±»\næ¨¡æ¿ç±» public abstract class People { public abstract String write(); public final void WriteOn(){ System.out.println(\u0026#34;\\t\\tä»Šå¤©æ˜¯2023/04/14\u0026#34;); System.out.println(\u0026#34;\\tèº«ä»½:\u0026#34;); System.out.println(write()); System.out.println(\u0026#34;ä»¥ä¸Šå°±æ˜¯æˆ‘å‘è¡¨çš„å†…å®¹\u0026#34;); System.out.println(\u0026#34;\\t\\tæ„Ÿè°¢å¤§å®¶ï¼\u0026#34;); } } public class Teacher extends People { @Override public String write() { //åªç”¨é‡å†™æ¯ä¸ªç±»ä¸­éœ€è¦ä¸åŒå®ç°çš„æ–¹æ³•å³å¯ return \u0026#34;æˆ‘æ˜¯è€å¸ˆï¼Œè¿™é‡Œæ˜¯è€å¸ˆç±»\u0026#34;; } } public class Student extends People { @Override public String write() { return \u0026#34;æˆ‘æ˜¯å­¦ç”Ÿï¼Œè¿™é‡Œæ˜¯å­¦ç”Ÿç±»\u0026#34;; } } public class Test { public static void main(String[] args) { Teacher t = new Teacher(); t.WriteOn(); Student s = new Student(); s.WriteOn(); } } å»ºè®®ä½¿ç”¨finalå…³é”®å­—ä¿®é¥°æ¨¡æ¿ç±»\næ¨¡æ¿æ–¹æ³•æ˜¯ç»™å¯¹è±¡ç›´æ¥ä½¿ç”¨çš„ä¸èƒ½è¢«ä¿®æ”¹ ä¸€æ—¦å­ç±»é‡å†™äº†æ¨¡æ¿æ–¹æ³•ï¼Œæ¨¡æ¿æ–¹æ³•å°±å¤±æ•ˆäº† æ¥å£ Javaæä¾›äº†ä¸€ä¸ªå…³é”®å­—interface public class Test { public static void main(String[] args) { Driver d = new A(); d.drive(); } } class A extends Student implements Driver, Singer{ @Override public void drive() { } @Override public void sing() { } } class Student{ } interface Driver{ void drive(); } interface Singer{ void sing(); } æ¥å£çš„å¥½å¤„ï¼š\nå¯ä»¥è§£å†³ç±»å•ç»§æ‰¿çš„é—®é¢˜ï¼Œé€šè¿‡æ¥å£ï¼Œ å¯ä»¥è®©ä¸€ä¸ªç±»æœ‰ä¸€ä¸ªç»§æ‰¿çˆ¶ç±»çš„åŒæ—¶ï¼Œè¿˜å¯ä»¥å»æ‰¾å¤šä¸ªæ¥å£å»æ‹“å±•è‡ªå·±çš„åŠŸèƒ½ å› ä¸ºé€šè¿‡æ¥å£å¯ä»¥æ˜¾æ€§çš„çŸ¥é“ä½ æ˜¯è° ä¸€ä¸ªç±»å¯ä»¥å®ç°å¤šä¸ªæ¥å£ï¼ŒåŒæ ·ï¼Œä¸€ä¸ªæ¥å£ä¹Ÿå¯ä»¥è¢«å¤šä¸ªç±»å®ç°ï¼Œè¿™æ ·çš„å¥½å¤„æ˜¯æˆ‘ä»¬çš„ç¨‹åºå¯ä»¥é¢å‘æ¥å£ç¼–ç¨‹äº†ï¼Œè¿™æ ·ç¨‹åºå‘˜å°±å¯ä»¥å¾ˆæ–¹ä¾¿çš„çµæ´»åˆ‡æ¢å„ç§ä¸šåŠ¡å®ç°äº†ã€‚ æ¥å£çš„ç»¼åˆæ¡ˆä¾‹:\nä½¿ç”¨æ¥å£(StudentOperator)ä¹‹åï¼Œåœ¨ä¸åŒçš„ç»§æ‰¿æ¥å£çš„ç±»(StudentOperatorImpl1, StudentOperatorImpl2)é‡Œé¢ç¼–å†™ä¸åŒçš„ç¨‹åºï¼Œç”¨æ¥å£å¯¹è±¡å®ç°æ“ä½œæ—¶ï¼Œä»…éœ€è¦æ”¹å˜ä¸åŒçš„å®ç°ç±»å³å¯ã€‚\næ¥å£çš„å…¶ä»–æ–¹æ³• public class Student { private String name; private char sex; private int score; public Student() { } } public interface StudentOperator { void printInfo(ArrayList\u0026lt;Student\u0026gt; students); void printAverageScore(ArrayList\u0026lt;Student\u0026gt; students); } public class StudentOperatorImpl1 implements StudentOperator{ @Override public void printInfo(ArrayList\u0026lt;Student\u0026gt; students) { System.out.println(\u0026#34;==å…¨ç­å…¨éƒ¨ä¿¡æ¯å¦‚ä¸‹==\u0026#34;); for (int i = 0; i \u0026lt; students.size(); i++) { Student s = students.get(i); System.out.println(\u0026#34;å§“åä¸º ï¼š \u0026#34; + s.getName() + \u0026#34;, æ€§åˆ«ä¸º ï¼š \u0026#34; + s.getSex() + \u0026#34;, å¾—åˆ†ä¸º ï¼š \u0026#34; + s.getScore()); } System.out.println(\u0026#34;-------------------\u0026#34;); } @Override public void printAverageScore(ArrayList\u0026lt;Student\u0026gt; students) { double total = 0; for (int i = 0; i \u0026lt; students.size(); i++) { Student s = students.get(i); total += s.getScore(); } System.out.println(\u0026#34;ç­çº§å¹³å‡åˆ†ä¸º ï¼š \u0026#34; + (total/(students.size()))); } } public class StudentOperatorImpl2 implements StudentOperator{ @Override public void printInfo(ArrayList\u0026lt;Student\u0026gt; students) { System.out.println(\u0026#34;==å…¨ç­å…¨éƒ¨ä¿¡æ¯å¦‚ä¸‹==\u0026#34;); int count1 = 0; for (int i = 0; i \u0026lt; students.size(); i++) { Student s = students.get(i); System.out.println(\u0026#34;å§“åä¸º ï¼š \u0026#34; + s.getName() + \u0026#34;, æ€§åˆ«ä¸º ï¼š \u0026#34; + s.getSex() + \u0026#34;, å¾—åˆ†ä¸º ï¼š \u0026#34; + s.getScore()); if(s.getSex()==\u0026#39;ç”·\u0026#39;){ count1+=1; } } System.out.println(\u0026#34;ç”·ç”Ÿäººæ•°ä¸º ï¼š \u0026#34; + count1 + \u0026#34;, å¥³ç”Ÿäººæ•°ä¸º ï¼š \u0026#34; + (students.size()-count1)); System.out.println(\u0026#34;ç­çº§æ€»äººæ•°ä¸º : \u0026#34; + (students.size())); System.out.println(\u0026#34;-------------------\u0026#34;); } @Override public void printAverageScore(ArrayList\u0026lt;Student\u0026gt; students) { double total = 0; double max = students.get(0).getScore(); double min = students.get(0).getScore(); for (int i = 0; i \u0026lt; students.size(); i++) { Student s = students.get(i); total += s.getScore(); if(s.getScore()\u0026gt;max){ max = s.getScore(); } else if(s.getScore()\u0026lt;min){ min = s.getScore(); } } System.out.println(\u0026#34;å­¦ç”Ÿçš„æœ€é«˜åˆ†ä¸º ï¼š \u0026#34; + max + \u0026#34;, å­¦ç”Ÿçš„æœ€ä½åˆ†ä¸º\u0026#34; + min); System.out.println(\u0026#34;å»é™¤æœ€ä½åˆ†å’Œæœ€é«˜åˆ†åï¼Œç­çº§å¹³å‡åˆ†ä¸º ï¼š \u0026#34; + (total/(students.size()))); } } public class ClassManagement { private ArrayList\u0026lt;Student\u0026gt; students = new ArrayList\u0026lt;\u0026gt;(); StudentOperator so = new StudentOperatorImpl2(); public ClassManagement() { students.add(new Student(\u0026#34;å°æ˜\u0026#34;, \u0026#39;ç”·\u0026#39;, 99)); students.add(new Student(\u0026#34;å°é»„\u0026#34;, \u0026#39;å¥³\u0026#39;, 100)); students.add(new Student(\u0026#34;å°ç™½\u0026#34;, \u0026#39;ç”·\u0026#39;, 94)); students.add(new Student(\u0026#34;å°äº®\u0026#34;, \u0026#39;å¥³\u0026#39;, 90)); } public void printInfo(){ so.printInfo(students); } public void printScore(){ so.printAverageScore(students); } } public class Test { public static void main(String[] args) { ClassManagement cm = new ClassManagement(); cm.printInfo(); cm.printScore(); } } æ¥å£çš„å…¶ä»–æ–¹æ³•ï¼š\n/** 1. é»˜è®¤æ–¹æ³•ï¼šå¿…é¡»ä½¿ç”¨ default ä¿®é¥°ï¼Œé»˜è®¤ä¼šè¢« public ä¿®é¥° * */ default void test1(){ System.out.println(\u0026#34;===é»˜è®¤æ–¹æ³•===\u0026#34;); test2(); } /** 2. ç§æœ‰æ–¹æ³•ï¼šå¿…é¡»ä½¿ç”¨ private ä¿®é¥°ï¼Œï¼ˆJDK9å¼€å§‹æ”¯æŒï¼‰ * å®ä¾‹æ–¹æ³•å¯¹è±¡çš„æ–¹æ³• */ private void test2(){ System.out.println(\u0026#34;===ç§æœ‰æ–¹æ³•===\u0026#34;); } /** * 3. é™æ€æ–¹æ³•ï¼Œå¿…é¡»ä½¿ç”¨ static ä¿®é¥°ï¼Œé»˜è®¤ä¼šè¢« public ä¿®é¥° */ public static void test3(){ System.out.println(\u0026#34;===é™æ€æ–¹æ³•===\u0026#34;); } æ¥å£çš„å¤šç»§æ‰¿ ä¸€ä¸ªæ¥å£å¯ä»¥åŒæ—¶ç»§æ‰¿å¤šä¸ªæ¥å£\nä¸€ä¸ªæ¥å£ç»§æ‰¿å¤šä¸ªæ¥å£ï¼Œå¦‚æœå¤šä¸ªæ¥å£ä¸­å­˜åœ¨æ–¹æ³•åå†²çªï¼Œåˆ™æ­¤æ—¶ä¸æ”¯æŒå¤šç»§æ‰¿\ninterface I{ void test1(); } interface J{ void test1(); } interface C implements I, J{ //æŠ¥é”™ } ä¸€ä¸ªç±»å®ç°å¤šä¸ªæ¥å£ï¼Œå¦‚æœå¤šä¸ªæ¥å£å­˜åœ¨æ–¹æ³•åå†²çªï¼Œåˆ™æ­¤æ—¶ä¸æ”¯æŒå¤šå®ç°\ninterface I{ void test1(); } interface J{ void test1(); } class C implements I, J{ //æŠ¥é”™ } ä¸€ä¸ªç±»ç»§æ‰¿äº†çˆ¶ç±»ï¼Œåˆå®ç°äº†æ¥å£ï¼Œçˆ¶ç±»ä¸­å’Œæ¥å£ä¸­æœ‰åŒåçš„é»˜è®¤æ–¹æ³•ï¼Œå®ç°ç±»ä¼šä¼˜å…ˆä½¿ç”¨çˆ¶ç±»çš„\nclass Fu{ public void run(){ System.out.println(\u0026#34;===çˆ¶ç±»çš„runæ–¹æ³•æ‰§è¡Œäº†\u0026#34;); } } interface IT{ default void run(){ System.out.println(\u0026#34;===æ¥å£ITä¸­çš„runæ–¹æ³•æ‰§è¡Œäº†\u0026#34;); } } class Zi extends Fu implements IT{ } public class Demo2 { public static void main(String[] args) { Zi zi = new Zi(); zi.run(); //===çˆ¶ç±»çš„runæ–¹æ³•æ‰§è¡Œäº† } } ä¸€ä¸ªç±»å®ç°å¤šä¸ªæ¥å£ï¼Œå¤šä¸ªæ¥å£ä¸­å­˜åœ¨åŒåçš„é»˜è®¤æ–¹æ³•ï¼Œå¯ä»¥ä¸å†²çªï¼Œ è¿™ä¸ªç±»é‡å†™è¯¥æ–¹æ³•å³å¯\ninterface I{ void test1(); } interface J{ void test1(); } //interface C implements I, J{ //æŠ¥é”™ // //} class C implements I, J{ @Override public void test1() { } //é‡å†™åä¸ä¼šæŠ¥é”™ } å†…éƒ¨ç±» æˆå‘˜å†…éƒ¨ç±» public class Outer { private String outerName; private int age=88; public static int outerNumber; public class Inner{ private String name; public static int number; // JDK16æ‰å¼€å§‹æ”¯æŒ private int age=99; public void test(){ } public void test2(){ System.out.println(outerName); System.out.println(outerNumber); int age = 66; System.out.println(age); System.out.println(this.age); System.out.println(Outer.this.age); } public Inner() { System.out.println(\u0026#34;Inner has been created.\u0026#34;); } public String getName() { return name; } public void setName(String name) { this.name = name; } public static int getNumber() { return number; } public static void setNumber(int number) { Inner.number = number; } } } public static void main(String[] args) { Outer.Inner in = new Outer().new Inner(); in.test2(); /** * Inner has been created. * null * 0 * 66 * 99 * 88 */ } é™æ€å†…éƒ¨ç±» å¯ä»¥ç›´æ¥è®¿é—®å¤–éƒ¨ç±»çš„é™æ€å˜é‡ï¼Œè€Œä¸èƒ½è®¿é—®å¤–éƒ¨ç±»çš„å®ä¾‹å˜é‡\npublic class StaticInner { private String name; // å®ä¾‹å˜é‡ï¼Œåªèƒ½ç”±å¤–éƒ¨å¯¹è±¡æ¥è®¿é—® public static int age; // é™æ€å˜é‡ï¼Œå¯ä»¥ç”±ç±»åç›´æ¥è®¿é—® // é™æ€å†…éƒ¨ç±» public static class Inner { // åœ¨é™æ€å†…éƒ¨ç±»ä¸­è®¿é—®å¤–éƒ¨ç±»çš„é™æ€å˜é‡æ˜¯åˆæ³•çš„ public void test() { System.out.println(age); // æ— æ³•åœ¨é™æ€å†…éƒ¨ç±»ä¸­ç›´æ¥è®¿é—®å¤–éƒ¨ç±»çš„å®ä¾‹å˜é‡ï¼Œä¼šå¯¼è‡´ç¼–è¯‘é”™è¯¯ //System.out.println(name); } } } å±€éƒ¨å†…éƒ¨ç±»ï¼šå®šä¹‰åœ¨æ–¹æ³•ï¼Œä»£ç å—ï¼Œæ„é€ å™¨ä¸­ã€‚\nåŒ¿åå†…éƒ¨ç±» åˆ›å»ºä¸€ä¸ªç±»çš„å®ä¾‹çš„ä¸€ç§æ–¹å¼ï¼ŒåŒæ—¶å®šä¹‰å¹¶å®ç°è¯¥ç±»ã€‚\npublic class Demo1 { public static void main(String[] args) { Animal cat = new Animal(){ //catç±»å¯ä»¥ä¸ç”¨å•å¦æ–°åˆ›å»ºï¼Œå®ç°çš„åŒæ—¶å®šä¹‰è¯¥ç±»å³å¯ @Override public void cry() { System.out.println(\u0026#34;çŒ«å–µå–µå–µçš„å«~~\u0026#34;); } }; cat.cry(); } } // ç”¨æŠ½è±¡æ–¹æ³•å®ç°åŒ¿åå†…éƒ¨ç±» abstract class Animal{ public abstract void cry(); } public class Demo2 { public static void main(String[] args) { go(new Swimming() { @Override public void swim() { System.out.println(\u0026#34;ç‹—æ¸¸çš„å¾ˆå¿«ï¼\u0026#34;); } }); } public static void go(Swimming s){ System.out.println(\u0026#34;===GO====\u0026#34;); s.swim(); } } // ç”¨æ¥å£å®ç°åŒ¿åå†…éƒ¨ç±» interface Swimming{ void swim(); } public class Demo3 { public static void main(String[] args) { JFrame win = new JFrame(\u0026#34;ç™»å½•ç•Œé¢\u0026#34;); JPanel panel = new JPanel(); win.add(panel); JButton btn = new JButton(\u0026#34;ç™»å½•\u0026#34;); panel.add(btn); //åŒ¿åå†…éƒ¨ç±»çš„å®é™…ä½¿ç”¨åœºæ™¯ btn.addActionListener(new ActionListener() { @Override public void actionPerformed(ActionEvent e) { JOptionPane.showConfirmDialog(win, \u0026#34;ä½ ç‚¹å‡»äº†ç™»å½•æŒ‰é’®\u0026#34;); } }); win.setSize(400, 800); win.setLocationRelativeTo(null); win.setDefaultCloseOperation(WindowConstants.EXIT_ON_CLOSE); win.setVisible(true); } } æšä¸¾ æšä¸¾æ˜¯ä¸€ç§ç‰¹æ®Šçš„ç±»\næšä¸¾ç±»çš„ç¬¬ä¸€è¡Œï¼Œåªèƒ½å†™ä¸€äº›åˆæ³•çš„æ ‡è¯†ç¬¦ï¼ˆåç§°ï¼‰ï¼Œ å¤šä¸ªåç§°ç”¨é€—å·éš”å¼€ è¿™äº›åç§°ï¼Œæœ¬è´¨æ˜¯å¸¸é‡ï¼Œæ¯ä¸ªå¸¸é‡éƒ½ä¼šè®°ä½æšä¸¾ç±»çš„ä¸€ä¸ªå¯¹è±¡ public enum A { X, Y, Z; private String name; public String getName() { return name; } public void setName(String name) { this.name = name; } } public class Test { public static void main(String[] args) { A a1 = A.X; System.out.println(a1); //X A a2 = A.Y; A[] as = A.values(); System.out.println(as); //[Lcom.showguan.Enum.A;@3b07d329 A a3 = A.valueOf(\u0026#34;Z\u0026#34;); System.out.println(a3); //Z System.out.println(a3.ordinal()); //2 æ¬¡åº } } æšä¸¾ç±»çš„ç‰¹ç‚¹ï¼š\næšä¸¾ç±»çš„ç¬¬ä¸€è¡Œåªèƒ½ç½—åˆ—ä¸€äº›åç§°ï¼Œè¿™äº›åç§°éƒ½æ˜¯å¸¸é‡ï¼Œå¹¶ä¸”æ¯ä¸ªå¸¸é‡è®°ä½çš„éƒ½æ˜¯æšä¸¾ç±»çš„ä¸€ä¸ªå¯¹è±¡ æšä¸¾éƒ½æ˜¯æœ€ç»ˆç±»ï¼Œä¸å¯ä»¥è¢«ç»§æ‰¿ æšä¸¾ç±»ä¸­ï¼Œä»ç¬¬äºŒè¡Œå¼€å§‹ï¼Œå¯ä»¥å®šä¹‰ç±»çš„å…¶ä»–å„ç§æˆå‘˜ ç¼–è¯‘å™¨ä¸ºæšä¸¾ç±»æ–°å¢äº†å‡ ä¸ªæ–¹æ³•ï¼Œå¹¶ä¸”æšä¸¾ç±»éƒ½æ˜¯ç»§æ‰¿ ï¼šjava.lang.Enumç±»çš„ï¼Œä»enumç±»ä¹Ÿä¼šç»§æ‰¿åˆ°ä¸€äº›æ–¹æ³• æšä¸¾çš„å®é™…ä½œç”¨ï¼š\npublic enum Constant2 { BOY, GIRL; } public static void check(Constant2 sex) { switch (sex) { case BOY: System.out.println(\u0026#34;ä½ æ˜¯ä¸ªç”·å­©ï¼\u0026#34;); break; case GIRL: System.out.println(\u0026#34;ä½ æ˜¯ä¸ªå¥³å­©ï¼\u0026#34;); break; } } public static void main(String[] args) { check(Constant2.BOY); } æ³›å‹ å®šä¹‰ç±»ï¼Œæ¥å£ï¼Œæ–¹æ³•æ—¶ï¼ŒåŒæ—¶å£°æ˜ä¸€ä¸ªæˆ–è€…å¤šä¸ªç±»å‹å˜é‡ï¼ˆå¦‚\u0026lt;E\u0026gt;)ï¼Œæˆä¸ºæ³›å‹ç±»ï¼Œæ³›å‹æ¥å£ï¼Œæ³›å‹æ–¹æ³•ï¼Œå®ƒä»¬ç»Ÿç§°ä¸ºæ³›å‹ã€‚ public class Test { public static void main(String[] args) { ArrayList list = new ArrayList(); list.add(\u0026#34;Java1\u0026#34;); list.add(\u0026#34;Java2\u0026#34;); list.add(\u0026#34;Java3\u0026#34;); list.add(new Cat()); for (int i = 0; i \u0026lt; list.size(); i++) { // Object o = list.get(i); // String s = (String) list.get(i); //æŠ¥é”™ Cat()å¯¹è±¡æ—¶Objectç±»å‹ï¼Œä¸èƒ½è½¬æ¢æˆStringç±»å‹ // System.out.println(s); } ArrayList\u0026lt;String\u0026gt; list2 = new ArrayList(); //æ³›å‹ä¸ºString list2.add(\u0026#34;Java1\u0026#34;); list2.add(\u0026#34;Java2\u0026#34;); list2.add(\u0026#34;Java3\u0026#34;); // list2.add(new Cat()); //åœ¨ç¼–è¯‘é˜¶æ®µå°±é™åˆ¶æ·»åŠ å¯¹è±¡çš„ç±»å‹ ArrayList\u0026lt;Cat\u0026gt; list3 = new ArrayList(); //æ³›å‹ä¸ºCat() } } æ‹“å±•:\npublic class MyArrayList\u0026lt;E, T\u0026gt; //å¯ä»¥å¤šä¸ªç±»å‹ public class MyArrayList\u0026lt;E, T extends Animal\u0026gt; //æŒ‡å®šç±»å‹éœ€è¦ç»§æ‰¿æŸä¸ªç±» æ³›å‹æ¥å£ public interface Data\u0026lt;E\u0026gt;{ void get(E e); ArrayList\u0026lt;E\u0026gt; getName(String name); } public class TeacherData implements Data\u0026lt;Teacher\u0026gt;{ //æŒ‡å®šæ³›å‹ç±»å‹åï¼Œé‡å†™çš„æ–¹æ³•éƒ½ä¼šè‡ªåŠ¨æ¢æˆè¯¥ç±»å‹ @Override public void get(Teacher teacher) { } @Override public ArrayList\u0026lt;Teacher\u0026gt; getName(String name) { return null; } } ä½¿ç”¨é€šé…ç¬¦ ?\npublic static void main(String[] args) { System.out.println(test(\u0026#34;Java\u0026#34;)); Dog d = test(new Dog()); ArrayList\u0026lt;Car\u0026gt; cars = new ArrayList\u0026lt;\u0026gt;(); cars.add(new Car()); cars.add(new Car()); cars.add(new Car()); go(cars); ArrayList\u0026lt;BMW\u0026gt; bmws = new ArrayList\u0026lt;\u0026gt;(); bmws.add(new BMW()); bmws.add(new BMW()); bmws.add(new BMW()); bmws.add(new BMW()); go(bmws); ArrayList\u0026lt;BENZ\u0026gt; benzs = new ArrayList\u0026lt;\u0026gt;(); benzs.add(new BENZ()); benzs.add(new BENZ()); benzs.add(new BENZ()); go(benzs); } public static \u0026lt;T\u0026gt; T test(T t){ return t; } public static void go(ArrayList\u0026lt;? extends Car\u0026gt; cars){ } } API toString()æ–¹æ³•å’Œequals() @Override public String toString() { return \u0026#34;Student{\u0026#34; + \u0026#34;name=\u0026#39;\u0026#34; + name + \u0026#39;\\\u0026#39;\u0026#39; + \u0026#34;, age=\u0026#34; + age + \u0026#39;}\u0026#39;; } @Override public boolean equals(Object o) { if (this == o) return true; if (o == null || getClass() != o.getClass()) return false; Student student = (Student) o; return age == student.age \u0026amp;\u0026amp; Objects.equals(name, student.name); } clone() public static void main(String[] args) throws CloneNotSupportedException { Student s1 = new Student(\u0026#34;Kennem\u0026#34;, 21, new double[]{0.0}); System.out.println(s1.toString()); System.out.println(s1.getName()); System.out.println(s1.getAge()); System.out.println(s1); System.out.println(s1.getClass()); System.out.println(s1.getScores()); /** * Student{name=\u0026#39;Kennem\u0026#39;, age=21} * Kennem * 21 * Student{name=\u0026#39;Kennem\u0026#39;, age=21} * class com.showguan.APIObject.Student * [D@27d6c5e0 */ Student s2 = new Student(\u0026#34;Kennem\u0026#34;, 21, new double[]{0.0}); System.out.println(s1.equals(s2)); //true Student s3 = (Student) s1.clone(); System.out.println(s3.getName()); System.out.println(s3.getAge()); System.out.println(s3); System.out.println(s3.getClass()); System.out.println(s3.getScores()); /** * Kennem * 21 * Student{name=\u0026#39;Kennem\u0026#39;, age=21} * class com.showguan.APIObject.Student * [D@4f3f5b24 */ } @Override protected Object clone() throws CloneNotSupportedException { Student tmp = (Student) super.clone(); tmp.scores = tmp.scores.clone(); return tmp; } Objects.\npublic static void main(String[] args) { String s1 = \u0026#34;Java\u0026#34;; String s2 = null; System.out.println(s1.equals(s2)); // System.out.println(s2.equals(s1)); //ç©ºæŒ‡é’ˆå¼‚å¸¸ System.out.println(Objects.equals(s1, s2)); //é˜²æ­¢ç©ºæŒ‡é’ˆå¼‚å¸¸ System.out.println(Objects.isNull(s1)); //false System.out.println(Objects.nonNull(s1)); //true System.out.println(Objects.isNull(s2)); //true System.out.println(Objects.nonNull(s2)); //false } åŒ…è£…ç±» public static void main(String[] args) { Integer a = Integer.valueOf(12); Integer b = 12; int c = b; ArrayList\u0026lt;Integer\u0026gt; arr = new ArrayList\u0026lt;\u0026gt;(); arr.add(12); arr.add(10); arr.get(1); Integer d = 25; String s1 = Integer.toString(d); System.out.println(s1); String s2 = d.toString(); String s3 = d + \u0026#34;\u0026#34;; System.out.println(s2); System.out.println(s3); String s4 = \u0026#34;29\u0026#34;; // int age = Integer.parseInt(s4); int age = Integer.valueOf(s4); System.out.println(age); String s5 = \u0026#34;99.9\u0026#34;; // double score = Double.parseDouble(s5); double score = Double.valueOf(s5); System.out.println(score+0.1); } StringBuilder é€‚åˆå¤šæ¬¡æ‹¼æ¥ï¼Œä¿®æ”¹\npublic static void main(String[] args) { StringBuilder s = new StringBuilder(); s.append(\u0026#34;Java\u0026#34;); s.append(\u0026#34;666\u0026#34;).append(\u0026#34;888\u0026#34;).append(\u0026#34;999\u0026#34;); System.out.println(s); s.reverse(); System.out.println(s); System.out.println(s.length()); String ss = s.toString(); System.out.println(ss); /** * Java666888999 * 999888666avaJ * 13 * 999888666avaJ */ } StringBufferæ–¹æ³•å’ŒStringBuilderç±»ä¼¼ï¼Œä½†æ˜¯æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œè€ŒStringBuilderæ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„\nStringJoiner StringJoiner sj = new StringJoiner(\u0026#34;,\u0026#34;, \u0026#34;[\u0026#34;, \u0026#34;]\u0026#34;); sj.add(\u0026#34;1\u0026#34;); sj.add(\u0026#34;2\u0026#34;); sj.add(\u0026#34;3\u0026#34;); sj.add(\u0026#34;4\u0026#34;); System.out.println(sj); System public class Main { public static void main(String[] args) { // ä¸»å‡½æ•°å…¥å£ // ä»¥ä¸‹ä»£ç å—è¢«æ³¨é‡Šæ‰ï¼Œä½¿ç”¨ System.exit(0) å¯ä»¥ç«‹å³ç»ˆæ­¢ç¨‹åºçš„æ‰§è¡Œ // System.exit(0); // æ‰“å°åˆ†éš”çº¿ System.out.println(\u0026#34;----------------\u0026#34;); // ä»¥ä¸‹ä»£ç å—è¢«æ³¨é‡Šæ‰ï¼Œç”¨äºæ‰“å°å½“å‰æ—¶é—´çš„æ¯«ç§’è¡¨ç¤º // System.out.println(System.currentTimeMillis()); // è®°å½•ç¨‹åºå¼€å§‹æ—¶é—´ long t1 = System.currentTimeMillis(); // åˆå§‹åŒ–ä¸€ä¸ªç©ºå­—ç¬¦ä¸² String s = \u0026#34;\u0026#34;; // å¾ªç¯å°†å­—ç¬¦ä¸²\u0026#34;abc\u0026#34;è¿½åŠ åˆ°å­—ç¬¦ä¸²sä¸­ï¼Œé‡å¤200000æ¬¡ for (int i = 0; i \u0026lt; 200000; i++) { s += \u0026#34;abc\u0026#34;; } // è®°å½•ç¨‹åºç»“æŸæ—¶é—´ long t2 = System.currentTimeMillis(); // è®¡ç®—ç¨‹åºæ‰§è¡Œæ—¶é—´å¹¶å°†ç»“æœä»¥ç§’ä¸ºå•ä½æ‰“å°å‡ºæ¥ System.out.println((t2 - t1) / 1000.0 + \u0026#34;s\u0026#34;); //4.656s } } BigDecimal public class Main { public static void main(String[] args) { // ä¸»å‡½æ•°å…¥å£ // ä½¿ç”¨åŒç²¾åº¦æµ®ç‚¹æ•°è¿›è¡Œè¿ç®— double a = 0.1; double b = 0.2; double c = a + b; // ç›´æ¥ç›¸åŠ  System.out.println(c); // è¾“å‡ºç»“æœ // ä½¿ç”¨ BigDecimal ç±»è¿›è¡Œç²¾ç¡®è¿ç®— BigDecimal a1 = BigDecimal.valueOf(a); // å°†åŒç²¾åº¦æµ®ç‚¹æ•°è½¬æ¢ä¸º BigDecimal ç±»å‹ BigDecimal b1 = BigDecimal.valueOf(b); // ä½¿ç”¨ BigDecimal çš„ multiply æ–¹æ³•è¿›è¡Œä¹˜æ³•è¿ç®— BigDecimal c1 = a1.multiply(b1); System.out.println(c1); // è¾“å‡ºç»“æœ // ä½¿ç”¨ BigDecimal çš„ add æ–¹æ³•è¿›è¡ŒåŠ æ³•è¿ç®— BigDecimal c2 = a1.add(b1); System.out.println(c2); // è¾“å‡ºç»“æœ // ä½¿ç”¨ BigDecimal çš„ subtract æ–¹æ³•è¿›è¡Œå‡æ³•è¿ç®— BigDecimal c3 = a1.subtract(b1); System.out.println(c3); // è¾“å‡ºç»“æœ // ä½¿ç”¨ BigDecimal çš„ divide æ–¹æ³•è¿›è¡Œé™¤æ³•è¿ç®— BigDecimal c4 = a1.divide(b1); System.out.println(c4); // è¾“å‡ºç»“æœ // ä½¿ç”¨ BigDecimal è¿›è¡Œé™¤æ³•è¿ç®—ï¼Œå¹¶è®¾ç½®ç²¾ç¡®åº¦å’Œèˆå…¥æ¨¡å¼ BigDecimal i = BigDecimal.valueOf(0.1); BigDecimal j = BigDecimal.valueOf(0.3); BigDecimal k = i.divide(j, 2, RoundingMode.HALF_UP); // è®¾ç½®ç²¾ç¡®åº¦ä¸º2ä½å°æ•°ï¼Œé‡‡ç”¨å››èˆäº”å…¥æ¨¡å¼ System.out.println(k); // è¾“å‡ºç»“æœï¼Œ0.33 } } Date parseæ–¹æ³•å’Œformatæ–¹æ³•\nimport java.text.ParseException; import java.text.SimpleDateFormat; import java.util.Date; public class DateFormatExample { public static void main(String[] args) { // åˆ›å»ºä¸€ä¸ªæ—¥æœŸå¯¹è±¡ Date d = new Date(); // å®šä¹‰æ—¥æœŸæ ¼å¼ SimpleDateFormat sdf = new SimpleDateFormat(\u0026#34;yyyyå¹´MMæœˆddæ—¥ HH:mm:ss EEE a\u0026#34;); // æ ¼å¼åŒ–å½“å‰æ—¥æœŸå¹¶è¾“å‡º String rs = sdf.format(d); System.out.println(\u0026#34;å½“å‰æ—¥æœŸæ ¼å¼åŒ–è¾“å‡º: \u0026#34; + rs); // å†æ¬¡æ ¼å¼åŒ–å½“å‰æ—¥æœŸå¹¶è¾“å‡ºï¼ˆå¯ä»¥çœç•¥æ­¤æ­¥éª¤ï¼Œä»…ä¸ºå±•ç¤ºï¼‰ String rs2 = sdf.format(d); System.out.println(\u0026#34;å†æ¬¡æ ¼å¼åŒ–å½“å‰æ—¥æœŸ: \u0026#34; + rs2); // å°†å­—ç¬¦ä¸²è§£æä¸ºæ—¥æœŸå¯¹è±¡ String dateStr = \u0026#34;2022-12-12 12:12:11\u0026#34;; SimpleDateFormat sdf2 = new SimpleDateFormat(\u0026#34;yyyy-MM-dd HH:mm:ss\u0026#34;); try { Date d2 = sdf2.parse(dateStr); System.out.println(\u0026#34;è§£æåçš„æ—¥æœŸ: \u0026#34; + d2); } catch (ParseException e) { e.printStackTrace(); } } } public static void main(String[] args) throws ParseException { String start = \u0026#34;2024å¹´12æœˆ12æ—¥ 00:00:00\u0026#34;; String end = \u0026#34;2024å¹´12æœˆ12æ—¥ 00:10:00\u0026#34;; String xj = \u0026#34;2024å¹´12æœˆ12æ—¥ 00:01:18\u0026#34;; String xp = \u0026#34;2024å¹´12æœˆ12æ—¥ 00:10:57\u0026#34;; SimpleDateFormat sdf = new SimpleDateFormat(\u0026#34;yyyyå¹´MMæœˆddæ—¥ HH:mm:ss\u0026#34;); Date startDt = sdf.parse(start); Date endDt = sdf.parse(end); Date xjDt = sdf.parse(xj); Date xpDt = sdf.parse(xp); long startTime = startDt.getTime(); long endTime = endDt.getTime(); long xjTime = xjDt.getTime(); long xpTime = xpDt.getTime(); if(xjTime\u0026gt;=startTime \u0026amp;\u0026amp; xjTime\u0026lt;=endTime){ System.out.println(\u0026#34;å°è´¾ä½ ç§’æ€æˆåŠŸäº†\u0026#34;); }else{ System.out.println(\u0026#34;å°è´¾ä½ ç§’æ€å¤±è´¥äº†\u0026#34;); } if(xpTime\u0026gt;=startTime \u0026amp;\u0026amp; xpTime\u0026lt;=endTime){ System.out.println(\u0026#34;å°çš®ä½ ç§’æ€æˆåŠŸäº†\u0026#34;); }else{ System.out.println(\u0026#34;å°çš®ä½ ç§’æ€å¤±è´¥äº†\u0026#34;); } } Calendar public class Main { public static void main(String[] args) { // è·å–å½“å‰æ—¥æœŸå’Œæ—¶é—´çš„ Calendar å¯¹è±¡ Calendar now = Calendar.getInstance(); System.out.println(\u0026#34;å½“å‰æ—¥æœŸå’Œæ—¶é—´ï¼š\u0026#34; + now); // è·å–å½“å‰å¹´ä»½ int year = now.get(Calendar.YEAR); System.out.println(\u0026#34;å½“å‰å¹´ä»½ï¼š\u0026#34; + year); // è·å–ä¸€å¹´ä¸­çš„ç¬¬å‡ å¤© int days = now.get(Calendar.DAY_OF_YEAR); System.out.println(\u0026#34;ä¸€å¹´ä¸­çš„ç¬¬å‡ å¤©ï¼š\u0026#34; + days); // è·å–Dateå¯¹è±¡ Date d = now.getTime(); System.out.println(\u0026#34;Dateå¯¹è±¡ï¼š\u0026#34; + d); // è·å–æ—¶é—´æˆ³ long time = now.getTimeInMillis(); System.out.println(\u0026#34;æ—¶é—´æˆ³ï¼š\u0026#34; + time); // è®¾ç½®æœˆä»½ä¸º4æœˆï¼Œæ—¥æœŸä¸º4æœˆ1æ—¥ now.set(Calendar.MONTH, Calendar.APRIL); now.set(Calendar.DAY_OF_MONTH, 1); System.out.println(\u0026#34;è®¾ç½®åçš„æ—¥æœŸï¼š\u0026#34; + now.getTime()); // è·å–è®¾ç½®åçš„æ—¥æœŸ Date d1 = now.getTime(); System.out.println(\u0026#34;è®¾ç½®åçš„Dateå¯¹è±¡ï¼š\u0026#34; + d1); // å¢åŠ 105å¤© now.add(Calendar.DAY_OF_YEAR, 105); Date d2 = now.getTime(); System.out.println(\u0026#34;å¢åŠ 105å¤©åçš„æ—¥æœŸï¼š\u0026#34; + d2); } } JDKä¹‹åæ–°å¢çš„æ—¶é—´\nè®¾è®¡æ›´åˆç†ï¼ŒåŠŸèƒ½ä¸°å¯Œï¼Œä½¿ç”¨æ›´æ–¹ä¾¿ éƒ½æ˜¯ä¸å¯å˜å¯¹è±¡ï¼Œä¿®æ”¹åä¼šè¿”å›æ–°çš„å®è·µå¯¹è±¡ï¼Œä¸ä¼šä¸¢å¤±æœ€å¼€å§‹çš„æ—¶é—´ çº¿ç¨‹å®‰å…¨ èƒ½ç²¾ç¡®åˆ°æ¯«ç§’ã€çº³ç§’ LocalDateï¼Œ LocalTime, LocalDateTime LocalDate public static void main(String[] args) { // è·å–å½“å‰æ—¥æœŸ LocalDate ld = LocalDate.now(); System.out.println(ld); // è·å–æ—¥æœŸçš„å¹´ã€æœˆã€æ—¥ã€å¹´ä¸­çš„ç¬¬å‡ å¤©ã€æ˜ŸæœŸå‡ ç­‰ä¿¡æ¯ int year = ld.getYear(); int month = ld.getMonthValue(); int day = ld.getDayOfMonth(); int dayOfYear = ld.getDayOfYear(); int dayOfWeek = ld.getDayOfWeek().getValue(); System.out.println(year); System.out.println(month); System.out.println(day); System.out.println(dayOfYear); System.out.println(dayOfWeek); // ä½¿ç”¨ with æ–¹æ³•è®¾ç½®æ—¥æœŸçš„å¹´ã€æœˆ LocalDate ld2 = ld.withYear(2077); LocalDate ld3 = ld.withMonth(11); System.out.println(ld2); System.out.println(ld3); // ä½¿ç”¨ plus æ–¹æ³•å¢åŠ æ—¥æœŸçš„å¤©æ•°ã€æœˆæ•° LocalDate ld4 = ld.plusDays(2); LocalDate ld5 = ld.plusMonths(3); // ä½¿ç”¨ minus æ–¹æ³•å‡å°‘æ—¥æœŸçš„å¤©æ•°ã€æœˆæ•° LocalDate ld6 = ld.minusDays(10); LocalDate ld7 = ld.minusMonths(2); // ä½¿ç”¨ of æ–¹æ³•åˆ›å»ºæŒ‡å®šæ—¥æœŸçš„ LocalDate å¯¹è±¡ LocalDate ld8 = LocalDate.of(2077, 12, 12); // ä½¿ç”¨ equalsã€isAfterã€isBefore æ–¹æ³•æ¯”è¾ƒæ—¥æœŸ System.out.println(ld5.equals(ld6)); System.out.println(ld5.isAfter(ld6)); System.out.println(ld5.isBefore(ld6)); } LocalTime public static void main(String[] args) { // 0ã€è·å–æœ¬åœ°æ—¶é—´å¯¹è±¡ LocalTime lt = LocalTime.now(); // è·å–å½“å‰æ—¶é—´ System.out.println(lt); // 1ã€è·å–æ—¶é—´ä¸­çš„ä¿¡æ¯ int hour = lt.getHour(); // è·å–å°æ—¶ int minute = lt.getMinute(); // è·å–åˆ†é’Ÿ int second = lt.getSecond(); // è·å–ç§’ int nano = lt.getNano(); // è·å–çº³ç§’ // 2ã€ä¿®æ”¹æ—¶é—´ï¼šwithHourã€withMinuteã€withSecondã€withNano LocalTime lt3 = lt.withHour(10); // è®¾ç½®å°æ—¶ä¸º10 LocalTime lt4 = lt.withMinute(10); // è®¾ç½®åˆ†é’Ÿä¸º10 LocalTime lt5 = lt.withSecond(10); // è®¾ç½®ç§’ä¸º10 LocalTime lt6 = lt.withNano(10); // è®¾ç½®çº³ç§’ä¸º10 // 3ã€åŠ å¤šå°‘ï¼šplusHoursã€plusMinutesã€plusSecondsã€plusNanos LocalTime lt7 = lt.plusHours(10); // å¢åŠ 10å°æ—¶ LocalTime lt8 = lt.plusMinutes(10); // å¢åŠ 10åˆ†é’Ÿ LocalTime lt9 = lt.plusSeconds(10); // å¢åŠ 10ç§’ LocalTime lt10 = lt.plusNanos(10); // å¢åŠ 10çº³ç§’ // 4ã€å‡å¤šå°‘ï¼šminusHoursã€minusMinutesã€minusSecondsã€minusNanos LocalTime lt11 = lt.minusHours(10); // å‡å°‘10å°æ—¶ LocalTime lt12 = lt.minusMinutes(10); // å‡å°‘10åˆ†é’Ÿ LocalTime lt13 = lt.minusSeconds(10); // å‡å°‘10ç§’ LocalTime lt14 = lt.minusNanos(10); // å‡å°‘10çº³ç§’ // 5ã€è·å–æŒ‡å®šæ—¶é—´çš„LocalTimeå¯¹è±¡ï¼š // public static LocalTime of(int hour, int minute, int second) LocalTime lt15 = LocalTime.of(12, 12, 12); // åˆ›å»ºæŒ‡å®šæ—¶é—´çš„LocalTimeå¯¹è±¡ LocalTime lt16 = LocalTime.of(12, 12, 12); // åˆ›å»ºæŒ‡å®šæ—¶é—´çš„LocalTimeå¯¹è±¡ // 6ã€åˆ¤æ–­2ä¸ªæ—¶é—´å¯¹è±¡ï¼Œæ˜¯å¦ç›¸ç­‰ï¼Œåœ¨å‰è¿˜æ˜¯åœ¨åï¼š equals isBefore isAfter System.out.println(lt15.equals(lt16)); // åˆ¤æ–­ä¸¤ä¸ªæ—¶é—´æ˜¯å¦ç›¸ç­‰ System.out.println(lt15.isAfter(lt)); // åˆ¤æ–­lt15æ˜¯å¦åœ¨ltä¹‹å System.out.println(lt15.isBefore(lt)); // åˆ¤æ–­lt15æ˜¯å¦åœ¨ltä¹‹å‰ } LocalDateTime public static void main(String[] args) { // è·å–å½“å‰æ—¥æœŸå’Œæ—¶é—´ LocalDateTime ldt = LocalDateTime.now(); System.out.println(\u0026#34;å½“å‰æ—¥æœŸå’Œæ—¶é—´ï¼š\u0026#34; + ldt); // è·å–æ—¥æœŸå’Œæ—¶é—´ä¸­çš„ä¿¡æ¯ int year = ldt.getYear(); // å¹´ä»½ int month = ldt.getMonthValue(); // æœˆä»½ int day = ldt.getDayOfMonth(); // æ—¥ int hour = ldt.getHour(); // å°æ—¶ int minute = ldt.getMinute(); // åˆ†é’Ÿ int second = ldt.getSecond(); // ç§’ int nano = ldt.getNano(); // çº³ç§’ System.out.println(\u0026#34;å¹´ä»½ï¼š\u0026#34; + year); System.out.println(\u0026#34;æœˆä»½ï¼š\u0026#34; + month); System.out.println(\u0026#34;æ—¥ï¼š\u0026#34; + day); System.out.println(\u0026#34;å°æ—¶ï¼š\u0026#34; + hour); System.out.println(\u0026#34;åˆ†é’Ÿï¼š\u0026#34; + minute); System.out.println(\u0026#34;ç§’ï¼š\u0026#34; + second); System.out.println(\u0026#34;çº³ç§’ï¼š\u0026#34; + nano); // è®¾ç½®æ—¥æœŸå’Œæ—¶é—´ LocalDateTime ldt2 = ldt.withYear(2025) .withMonth(6) .withDayOfMonth(15) .withHour(18) .withMinute(30) .withSecond(0) .withNano(0); System.out.println(\u0026#34;ä¿®æ”¹åçš„æ—¥æœŸå’Œæ—¶é—´ï¼š\u0026#34; + ldt2); // å¢åŠ å’Œå‡å°‘æ—¥æœŸå’Œæ—¶é—´ LocalDateTime ldt3 = ldt.plusDays(10) .plusHours(2) .minusMinutes(15); System.out.println(\u0026#34;å¢åŠ å’Œå‡å°‘åçš„æ—¥æœŸå’Œæ—¶é—´ï¼š\u0026#34; + ldt3); // åˆ›å»ºæŒ‡å®šæ—¥æœŸå’Œæ—¶é—´çš„ LocalDateTime å¯¹è±¡ LocalDateTime ldt4 = LocalDateTime.of(2030, 12, 31, 23, 59, 59); System.out.println(\u0026#34;æŒ‡å®šæ—¥æœŸå’Œæ—¶é—´ï¼š\u0026#34; + ldt4); // åˆ¤æ–­ä¸¤ä¸ª LocalDateTime å¯¹è±¡çš„å…³ç³» System.out.println(\u0026#34;å½“å‰æ—¥æœŸå’Œæ—¶é—´æ˜¯å¦åœ¨æŒ‡å®šæ—¥æœŸå’Œæ—¶é—´ä¹‹åï¼š\u0026#34; + ldt.isAfter(ldt4)); System.out.println(\u0026#34;å½“å‰æ—¥æœŸå’Œæ—¶é—´æ˜¯å¦åœ¨æŒ‡å®šæ—¥æœŸå’Œæ—¶é—´ä¹‹å‰ï¼š\u0026#34; + ldt.isBefore(ldt4)); } Arrays å¯¹äºè‡ªå®šä¹‰å¯¹è±¡çš„æ’åºï¼š\n@Override public int compareTo(Student o) { // if(this.age \u0026gt; o.age){ //å·¦è¾¹å¤§ï¼Œæ­£æ•´æ•° // return 1; // } // else if(this.age \u0026lt; o.age){ //å³è¾¹å¤§ï¼Œ è´Ÿæ•´æ•° // return -1; // } // return 0; //ç›¸ç­‰ 0 return o.age-this.age; } @Override public String toString() { return \u0026#34;Student{\u0026#34; + \u0026#34;name=\u0026#39;\u0026#34; + name + \u0026#39;\\\u0026#39;\u0026#39; + \u0026#34;, height=\u0026#34; + height + \u0026#34;, age=\u0026#34; + age + \u0026#39;}\u0026#39;; } Student[] students = new Student[4]; students[0] = new Student(\u0026#34;Kenn\u0026#34;, 180, 21); students[1] = new Student(\u0026#34;ken\u0026#34;, 181, 22); students[2] = new Student(\u0026#34;ken\u0026#34;, 189, 22); students[3] = new Student(\u0026#34;k\u0026#34;, 168, 20); Arrays.sort(students); System.out.println(Arrays.toString(students)); Arrays.sort(students, new Comparator\u0026lt;Student\u0026gt;() { @Override public int compare(Student o1, Student o2) { return Integer.compare(o1.getAge(), o2.getAge()); } }); Lambdaè¡¨è¾¾å¼ Lambdaè¡¨è¾¾å¼åªèƒ½ç®€åŒ–å‡½æ•°å¼æ¥å£çš„åŒ¿åå†…éƒ¨ç±»ï¼\nå‡½æ•°å¼æ¥å£ï¼š\næœ‰ä¸”ä»…æœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•çš„æ¥å£ æ³¨æ„ï¼šå°†æ¥è§åˆ°çš„å¤§éƒ¨åˆ†å‡½æ•°å¼æ¥å£ï¼Œä¸Šé¢éƒ½å¯èƒ½ä¼šæœ‰ä¸€ä¸ª@FunctionalInterfaceçš„æ³¨è§£ï¼Œæœ‰è¯¥æ³¨è§£çš„æ¥å£å¿…å®šæ˜¯å‡½æ•°å¼æ¥å£ // Arrays.sort(students, new Comparator\u0026lt;Student\u0026gt;() { // @Override // public int compare(Student o1, Student o2) { // return Integer.compare(o1.getAge(), o2.getAge()); // } // }); // Arrays.sort(students, (Student o1, Student o2) -\u0026gt;{ // return Double.compare(o1.getHeight(), o2.getHeight()); // }); Arrays.sort(students, (o1, o2) -\u0026gt; { return Double.compare(o1.getHeight(), o2.getHeight()); }); Arrays.sort(students, (o1, o2) -\u0026gt; Double.compare(o1.getHeight(), o2.getHeight())); // Arrays.setAll(prices, new IntToDoubleFunction() { // @Override // public double applyAsDouble(int value) { // return prices[value]*0.8; // } // }); // Arrays.setAll(prices, (int value) -\u0026gt; { // return prices[value]*0.8; // }); // Arrays.setAll(prices, value -\u0026gt; { // return prices[value]*0.8; // }); Arrays.setAll(prices, value -\u0026gt; prices[value]*0.8); æ–¹æ³•å¼•ç”¨ æ–¹æ³•å¼•ç”¨æ˜¯Java 8å¼•å…¥çš„ä¸€ç§ç®€æ´è¯­æ³•ï¼Œå…è®¸æˆ‘ä»¬ä½¿ç”¨ç°æœ‰çš„æ–¹æ³•å®šä¹‰æ¥åˆ›å»ºLambdaè¡¨è¾¾å¼ã€‚è¿™ç§æ–¹å¼ä½¿å¾—ä»£ç æ›´ç®€æ´ã€æ˜“è¯»ã€‚æ–¹æ³•å¼•ç”¨å¯ä»¥çœ‹ä½œæ˜¯Lambdaè¡¨è¾¾å¼çš„ç®€åŒ–å½¢å¼ï¼Œä¸»è¦ç”¨äºå¢å¼ºä»£ç çš„å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚\né™æ€æ–¹æ³•çš„å¼•ç”¨ é™æ€æ–¹æ³•å¼•ç”¨ç”¨äºå¼•ç”¨ç±»çš„é™æ€æ–¹æ³•ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å¼•ç”¨äº†CompareByAgeç±»çš„é™æ€æ–¹æ³•comparByAgeã€‚\n// CompareByAge.java public class CompareByAge { public static int comparByAge(Student o1, Student o2) { return o1.getAge() - o2.getAge(); } } // Test.java Student[] students = ... // å‡è®¾å·²ç»åˆå§‹åŒ–çš„å­¦ç”Ÿæ•°ç»„ // ä½¿ç”¨Lambdaè¡¨è¾¾å¼æ’åº Arrays.sort(students, (o1, o2) -\u0026gt; CompareByAge.comparByAge(o1, o2)); // ä½¿ç”¨æ–¹æ³•å¼•ç”¨æ’åºï¼Œä¸ä¸Šé¢çš„ä½œç”¨ç›¸åŒ Arrays.sort(students, CompareByAge::comparByAge); è¯´æ˜ï¼šé€šè¿‡ä½¿ç”¨CompareByAge::comparByAgeæ–¹æ³•å¼•ç”¨ï¼Œæˆ‘ä»¬å¯ä»¥ç®€åŒ–Lambdaè¡¨è¾¾å¼ã€‚\nå®ä¾‹æ–¹æ³•å¼•ç”¨ å®ä¾‹æ–¹æ³•å¼•ç”¨ç”¨äºå¼•ç”¨æŸä¸ªç‰¹å®šå¯¹è±¡çš„å®ä¾‹æ–¹æ³•ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å¼•ç”¨äº†CompareByHeightç±»çš„å®ä¾‹æ–¹æ³•comparebyHeightã€‚\npublic class CompareByHeight { public int comparebyHeight(Student o1, Student o2) { return (int) (o2.getHeight() - o1.getHeight()); } } // Test.java CompareByHeight cmpH = new CompareByHeight(); Student[] students = ... // å‡è®¾å·²ç»åˆå§‹åŒ–çš„å­¦ç”Ÿæ•°ç»„ // ä½¿ç”¨Lambdaè¡¨è¾¾å¼æ’åº Arrays.sort(students, (o1, o2) -\u0026gt; cmpH.comparebyHeight(o1, o2)); // ä½¿ç”¨æ–¹æ³•å¼•ç”¨æ’åºï¼Œä¸ä¸Šé¢çš„ä½œç”¨ç›¸åŒ Arrays.sort(students, cmpH::comparebyHeight); è¯´æ˜ï¼šé€šè¿‡ä½¿ç”¨cmpH::comparebyHeightæ–¹æ³•å¼•ç”¨ï¼Œæˆ‘ä»¬å¯ä»¥ç®€åŒ–Lambdaè¡¨è¾¾å¼ã€‚\nç‰¹å®šç±»å‹çš„æ–¹æ³•å¼•ç”¨ ç‰¹å®šç±»å‹çš„æ–¹æ³•å¼•ç”¨ç”¨äºå¼•ç”¨æŸä¸ªç‰¹å®šç±»å‹çš„å®ä¾‹æ–¹æ³•ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å¼•ç”¨äº†Stringç±»çš„å®ä¾‹æ–¹æ³•compareToIgnoreCaseã€‚\nString[] names = ... // å‡è®¾å·²ç»åˆå§‹åŒ–çš„å­—ç¬¦ä¸²æ•°ç»„ // ä½¿ç”¨Lambdaè¡¨è¾¾å¼æ’åº Arrays.sort(names, (o1, o2) -\u0026gt; o1.compareToIgnoreCase(o2)); // ä½¿ç”¨æ–¹æ³•å¼•ç”¨æ’åºï¼Œä¸ä¸Šé¢çš„ä½œç”¨ç›¸åŒ Arrays.sort(names, String::compareToIgnoreCase); è¯´æ˜ï¼šé€šè¿‡ä½¿ç”¨String::compareToIgnoreCaseæ–¹æ³•å¼•ç”¨ï¼Œæˆ‘ä»¬å¯ä»¥ç®€åŒ–Lambdaè¡¨è¾¾å¼ã€‚\næ„é€ å™¨å¼•ç”¨ æ„é€ å™¨å¼•ç”¨ç”¨äºå¼•ç”¨ç±»çš„æ„é€ æ–¹æ³•ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å¼•ç”¨äº†Carç±»çš„æ„é€ æ–¹æ³•ã€‚\npublic class Car { private String name; private double price; public Car(String name, double price) { this.name = name; this.price = price; } // çœç•¥getterå’Œsetteræ–¹æ³• } @FunctionalInterface interface CreateCar { Car create(String name, double price); } // Test.java // ä½¿ç”¨åŒ¿åå†…éƒ¨ç±» CreateCar cc1 = new CreateCar() { @Override public Car create(String name, double price) { return new Car(name, price); } }; // ä½¿ç”¨Lambdaè¡¨è¾¾å¼ CreateCar cc2 = (name, price) -\u0026gt; new Car(name, price); // ä½¿ç”¨æ„é€ å™¨å¼•ç”¨ CreateCar cc3 = Car::new; è¯´æ˜ï¼šé€šè¿‡ä½¿ç”¨Car::newæ„é€ å™¨å¼•ç”¨ï¼Œæˆ‘ä»¬å¯ä»¥ç®€åŒ–Lambdaè¡¨è¾¾å¼ã€‚\næ€»ç»“ æ–¹æ³•å¼•ç”¨å’Œæ„é€ å™¨å¼•ç”¨ä½¿å¾—ä»£ç æ›´ç®€æ´æ˜“è¯»ã€‚ä»¥ä¸‹æ˜¯å››ç§å¸¸è§çš„å¼•ç”¨æ–¹å¼ï¼š\né™æ€æ–¹æ³•å¼•ç”¨ï¼šClassName::staticMethodName å®ä¾‹æ–¹æ³•å¼•ç”¨ï¼šinstance::instanceMethodName ç‰¹å®šç±»å‹çš„æ–¹æ³•å¼•ç”¨ï¼šClassName::instanceMethodName æ„é€ å™¨å¼•ç”¨ï¼šClassName::new å¼•ç”¨æ–¹å¼å‡å°‘äº†æ ·æ¿ä»£ç ï¼Œå¢å¼ºäº†ä»£ç çš„å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚\nç»¼åˆæ¡ˆä¾‹ Hospital ","permalink":"https://kennems.github.io/posts/tech/java20%E5%A4%A9%E9%80%9F%E6%88%90%E8%BF%9B%E9%98%B6%E8%AF%BE%E7%A8%8B1/","summary":"è¿›é˜¶è¯¾ç¨‹(1) OOP static é™æ€ï¼Œ å¯ä»¥ä¿®é¥°æˆå‘˜å˜é‡ï¼Œæˆå‘˜æ–¹æ³• æˆå‘˜å˜é‡æŒ‰ç…§æœ‰æ— staticä¿®é¥°ï¼Œåˆ†ä¸ºä¸¤ç§ ç±»å˜é‡ ï¼š æœ‰staticä¿®é¥°ï¼Œå±äºç±»ï¼Œåœ¨è®¡ç®—æœºé‡Œåª","title":"Java20å¤©é€Ÿæˆâ€”â€”è¿›é˜¶è¯¾ç¨‹(1)"},{"content":"JAVA 20å¤©é€Ÿæˆ æœ‰å¿—è€…äº‹ç«Ÿæˆ\næ²¡æœ‰å®Œå®Œå…¨å…¨çš„æŠ•å…¥ï¼Œæ£€æµ‹ï¼Œå­¦ä¹ æ˜¯å­¦ä¸åˆ°ä¸œè¥¿çš„ã€‚\nè‡ªæ¬ºæ¬ºäººï¼Œçœ¼é«˜æ‰‹ä½æ˜¯ç»å¯¹æ²¡æœ‰ä»»ä½•ä½œç”¨çš„ã€‚\nJAVAèƒŒæ™¯ä¿¡æ¯ JAVAæ˜¯ä¸€é—¨é«˜çº§ç¼–ç¨‹è¯­è¨€ã€‚\nå±äºORACLEå…¬å¸\nJAVAä¹‹çˆ¶â€”â€”è©¹å§†æ–¯Â·é«˜æ–¯æ—\nJAVAä¸»è¦åšäº’è”ç½‘ç³»ç»Ÿçš„å¼€å‘\nä¸»è¦æŠ€æœ¯å¹³å°ï¼šJAVASEï¼Œ JAVAEEï¼Œ JAVAME\nJDKçš„å‘å±•å² Java Development Kit å¼€å‘è€…å·¥å…·åŒ…\nå½“å‰ä½¿ç”¨æ›´å¤šçš„æ˜¯JDK-8ï¼ŒJDK-11\næ•™å­¦åªç”¨JDK-17\næŠ€æœ¯ç±»ç½‘ç«™ ï¼š å®‰è£…è·¯å¾„ä¸‹ä¸è¦åŒ…å«ä¸­æ–‡å’Œç©ºæ ¼\næ‰€æœ‰çš„å¼€å‘å·¥å…·æœ€å¥½å®‰è£…åˆ°ç»Ÿä¸€ç›®å½•\nç”µè„‘å†…JAVAå®‰è£…è·¯å¾„ï¼š\nF:\\Java\\jdk17\nF:\\Java\\jdk11\njavac.exe : ç¼–è¯‘å·¥å…· java.exe : æ‰§è¡Œå·¥å…·\nå¸¸ç”¨å‘½ä»¤\nclsï¼š æ¸…å± é€€å›åˆ°ç›˜ç¬¦æ ¹ç›®å½• ï¼š cd\\ å…ˆåˆ‡æ¢ç›˜ç¬¦åœ¨åˆ‡æ¢ç›®å½• Java ç¨‹åºè¦ç»å†çš„æ­¥éª¤ï¼š\nç¼–å†™ã€ç¼–è¯‘ï¼ˆjavac), è¿è¡Œ(java) Javaä»£ç ç¼–å†™æœ‰ä»€ä¹ˆåŸºæœ¬è¦æ±‚ï¼Ÿ\næ–‡ä»¶åç§°å’Œåç¼€å¿…é¡»æ˜¯javaç»“å°¾ æ–‡ä»¶åç§°å¿…é¡»ä¸ä»£ç çš„ç±»åç§°ä¸€è‡´ å¿…é¡»ä½¿ç”¨è‹±æ–‡æ¨¡å¼ä¸‹çš„ç¬¦å· javac .\\HelloWorld.java\rjava HelloWorld public class Main{ public static void main(String[] args){ System.out.println(\u0026#34;Hello World!\u0026#34;); } } JDK11å¼€å§‹æ”¯æŒjavaç›´æ¥è¿è¡Œæºä»£ç æ–‡ä»¶\nJDK ç»„æˆ JREï¼ˆJava Runtime Environmentï¼‰ï¼šJavaçš„è¿è¡Œç¯å¢ƒ\nJVMï¼ˆJava Vitual Machineï¼‰ï¼šJavaè™šæ‹Ÿæœºï¼Œ çœŸæ­£è¿è¡Œjavaç¨‹åºçš„åœ°æ–¹ã€‚\næ ¸å¿ƒç±»åº“ï¼šJavaè‡ªå·±å†™å¥½çš„ç¨‹åºï¼Œç»™ç¨‹åºå‘˜è°ƒç”¨çš„\nå¼€å‘å·¥å…·ï¼šjava, javac\nJDKï¼ˆJava Development Kitï¼‰ï¼šJavaå¼€å‘å·¥å…·åŒ…ï¼ˆåŒ…æ‹¬ä¸Šé¢æ‰€æœ‰ï¼‰ã€‚\nJavaçš„è·¨å¹³å°ã€å·¥ä½œåŸç†\nä¸€æ¬¡ç¼–è¯‘ï¼Œå¤„å¤„å¯ç”¨ Pathç¯å¢ƒå˜é‡ï¼šç”¨äºè®°ä½ç¨‹åºè·¯å¾„ï¼Œæ–¹ä¾¿åœ¨å‘½ä»¤è¡Œçª—å£çš„ä»»æ„ç›®å½•å¯åŠ¨ç¨‹åº\nIDEAç®¡ç†JAVAç¨‹åºçš„ç»“æ„\nprojectï¼ˆé¡¹ç›®ï¼Œå·¥ç¨‹ï¼‰ moduleï¼ˆæ¨¡å—ï¼‰ packageï¼ˆåŒ…ï¼‰ classï¼ˆç±»ï¼‰ IDEAå¿«æ·é”®\nmain/psvm sout\nctrl + D å¤åˆ¶å½“å‰è¡Œåˆ°ä¸‹ä¸€è¡Œ\nctrl + Y åˆ é™¤æ‰€åœ¨è¡Œï¼Œå»ºè®®ç”¨ctrl + x\nctrl + alt + L æ ¼å¼åŒ–ä»£ç \nALT + SHIFT + â¬† | â¬‡ ä¸Šä¸‹ç§»åŠ¨å½“å‰ä»£ç \nctrl + /, ctrl + shift + / å¯¹ä»£ç è¿›è¡Œæ³¨é‡Š\nshift + enter , ctrl + alt + enter åœ¨å½“å‰è¡Œä¸‹é¢/ä¸Šé¢æ·»åŠ ä¸€è¡Œ\nIDEAå¸¸ç”¨æ“ä½œï¼š\nåˆ é™¤ç±»æ–‡ä»¶ ä¿®æ”¹ç±»åç§° ä¿®æ”¹æ¨¡å— å¯¼å…¥æ¨¡å— æ–¹æ³•1ï¼š\næ³¨ï¼šç”Ÿæˆimiæ–‡ä»¶\nmvn idea:module æ–¹æ³•2ï¼š\nå¤åˆ¶ä»£ç åˆ°projectç›®å½•ï¼Œ ä¹‹åå†å¯¼å…¥ï¼Œ å¦åˆ™åªæ˜¯ç›¸å…³å¯¼å…¥ï¼Œä¿®æ”¹moduleå†…å®¹ä¼šä¿®æ”¹æºä»£ç \nåˆ é™¤æ¨¡å— æ‰“å¼€å·¥ç¨‹ å…³é—­å·¥ç¨‹ JAVAåŸºç¡€è¯­æ³• 1ã€æ³¨é‡Š // å•è¡Œæ³¨é‡Š /* å¤šè¡Œæ³¨é‡Š */ /** æ–‡æ¡£æ³¨é‡Š * ç›®æ ‡ï¼š */ 2ã€å˜é‡ å˜é‡å°±æ˜¯å†…å­˜ä¸­çš„ä¸€å—åŒºåŸŸã€‚\n// äºŒè¿›åˆ¶è¡¨ç¤ºï¼Œå‰ç¼€ 0b è¡¨ç¤ºäºŒè¿›åˆ¶ int a1 = 0b01100001; System.out.println(a1); // è¾“å‡ºï¼š97 // åè¿›åˆ¶è¡¨ç¤º int a2 = 97; System.out.println(a2); // è¾“å‡ºï¼š97 // å…«è¿›åˆ¶è¡¨ç¤ºï¼Œå‰ç¼€ 0 è¡¨ç¤ºå…«è¿›åˆ¶ int a3 = 0141; System.out.println(a3); // è¾“å‡ºï¼š97 // åå…­è¿›åˆ¶è¡¨ç¤ºï¼Œå‰ç¼€ 0x è¡¨ç¤ºåå…­è¿›åˆ¶ int a4 = 0xFA; System.out.println(a4); // è¾“å‡ºï¼š250 // å£°æ˜å¹¶åˆå§‹åŒ–ä¸åŒç±»å‹çš„å˜é‡ byte a = 10; // byteç±»å‹ï¼Œè¡¨ç¤ºèŒƒå›´ä¸º -128 åˆ° 127 short b = 8888; // shortç±»å‹ï¼Œè¡¨ç¤ºèŒƒå›´ä¸º -32768 åˆ° 32767 int c = 130; // intç±»å‹ï¼Œè¡¨ç¤ºèŒƒå›´ä¸º -2147483648 åˆ° 2147483647 long d = 9393939393993L; // longç±»å‹ï¼Œéœ€è¦åœ¨ç»“å°¾åŠ ä¸ŠLæˆ–lï¼Œè¡¨ç¤ºèŒƒå›´ä¸º -9223372036854775808 åˆ° 9223372036854775807 // è¾“å‡ºä¸åŒç±»å‹çš„æ•´æ•°å˜é‡ System.out.println(a); // è¾“å‡ºï¼š10 System.out.println(b); // è¾“å‡ºï¼š130 System.out.println(c); // è¾“å‡ºï¼š9393939393993 System.out.println(d); // è¾“å‡ºï¼š8888 // æµ®ç‚¹æ•°ç±»å‹ float e = 2.17F; // floatç±»å‹ï¼Œéœ€è¦åœ¨ç»“å°¾åŠ ä¸ŠFæˆ–f double f = 3.141592657; // doubleç±»å‹ï¼Œé»˜è®¤ä¸ºdoubleï¼Œå¯ä»¥ä¸åŠ ä»»ä½•æ ‡è¯† // è¾“å‡ºæµ®ç‚¹æ•°å˜é‡ System.out.println(e); // è¾“å‡ºï¼š2.17 System.out.println(f); // è¾“å‡ºï¼š3.141592657 // å­—ç¬¦ç±»å‹ char ch = \u0026#39;c\u0026#39;; // charç±»å‹ï¼Œè¡¨ç¤ºå•ä¸ªå­—ç¬¦ System.out.println(ch); // è¾“å‡ºï¼šc // å¸ƒå°”ç±»å‹ boolean flag = false; // booleanç±»å‹ï¼Œè¡¨ç¤ºtrueæˆ–false System.out.println(flag); // è¾“å‡ºï¼šfalse // å­—ç¬¦ä¸²ç±»å‹ String st = \u0026#34;string\u0026#34;; // Stringç±»å‹ï¼Œè¡¨ç¤ºå­—ç¬¦ä¸² System.out.println(st); // è¾“å‡ºï¼šstring ç±»å‹è½¬æ¢ byte a = 10; // å£°æ˜å¹¶åˆå§‹åŒ–byteç±»å‹å˜é‡a int b = a; // å°†byteç±»å‹çš„å˜é‡aèµ‹å€¼ç»™intç±»å‹çš„å˜é‡bï¼Œå‘ç”Ÿæ‹“å®½è½¬æ¢ System.out.println(b); // è¾“å‡ºï¼š10 int c = 100; // å£°æ˜å¹¶åˆå§‹åŒ–intç±»å‹å˜é‡c double d = c; // å°†intç±»å‹çš„å˜é‡cèµ‹å€¼ç»™doubleç±»å‹çš„å˜é‡dï¼Œå‘ç”Ÿæ‹“å®½è½¬æ¢ System.out.println(d); // è¾“å‡ºï¼š100.0 char e = \u0026#39;b\u0026#39;; // å£°æ˜å¹¶åˆå§‹åŒ–charç±»å‹å˜é‡e int f = e; // å°†charç±»å‹çš„å˜é‡eèµ‹å€¼ç»™intç±»å‹çš„å˜é‡fï¼Œå‘ç”Ÿæ‹“å®½è½¬æ¢ System.out.println(f); // è¾“å‡ºï¼š98ï¼ˆå­—ç¬¦\u0026#39;b\u0026#39;å¯¹åº”çš„ASCIIç å€¼ï¼‰ byte a = 10; // å£°æ˜å¹¶åˆå§‹åŒ–byteç±»å‹å˜é‡a short b = 20; // å£°æ˜å¹¶åˆå§‹åŒ–shortç±»å‹å˜é‡b int c = 30; // å£°æ˜å¹¶åˆå§‹åŒ–intç±»å‹å˜é‡c long d = 40; // å£°æ˜å¹¶åˆå§‹åŒ–longç±»å‹å˜é‡d // å¯¹aã€bã€cã€dè¿›è¡ŒåŠ æ³•è¿ç®—ï¼Œç»“æœå­˜å‚¨åœ¨longç±»å‹å˜é‡res1ä¸­ long res1 = a + b + c + d; System.out.println(res1); // è¾“å‡ºï¼š100 // å¯¹aã€bè¿›è¡ŒåŠ æ³•è¿ç®—ï¼Œå¹¶å°†1.0ï¼ˆdoubleç±»å‹ï¼‰ç›¸åŠ ï¼Œç»“æœå­˜å‚¨åœ¨doubleç±»å‹å˜é‡res2ä¸­ double res2 = a + b + 1.0; System.out.println(res2); // è¾“å‡ºï¼š31.0 // å¯¹aã€bè¿›è¡ŒåŠ æ³•è¿ç®—ï¼Œç»“æœå­˜å‚¨åœ¨intç±»å‹å˜é‡res3ä¸­ int res3 = a + b; System.out.println(res3); // è¾“å‡ºï¼š30 byte a1 = 10; // å£°æ˜å¹¶åˆå§‹åŒ–byteç±»å‹å˜é‡a1 byte a2 = 20; // å£°æ˜å¹¶åˆå§‹åŒ–byteç±»å‹å˜é‡a2 // å¯¹a1ã€a2è¿›è¡ŒåŠ æ³•è¿ç®—ï¼Œç”±äºbyteç±»å‹ç›¸åŠ å¯èƒ½æº¢å‡ºï¼Œå› æ­¤ç»“æœå­˜å‚¨åœ¨intç±»å‹å˜é‡res4ä¸­ int res4 = a1 + a2; // è¿›è¡Œè¿ç®—æ—¶a1å’Œa2è‡ªåŠ¨è½¬æ¢æˆintç±»å‹ï¼Œç„¶åç›¸åŠ  System.out.println(res4); // è¾“å‡ºï¼š30 å¼ºåˆ¶ç±»å‹è½¬æ¢ int a = 1111111; char b = (char) a; // å¿«æ·é”®ï¼Œ ALT+ENTER System.out.println(b); double c = 99.8; int d = (int) c; // ä¸¢æ‰å°æ•°éƒ¨åˆ† System.out.println(d); 3ã€è¿ç®—ç¬¦ ä½¿ç”¨+ç¬¦å·åšè¿æ¥ç¬¦çš„æƒ…å†µ int a = 10; // å£°æ˜å¹¶åˆå§‹åŒ–æ•´æ•°å˜é‡a // ä½¿ç”¨å­—ç¬¦ä¸²è¿æ¥ç¬¦å°†å­—ç¬¦ä¸² \u0026#34;abc\u0026#34; å’Œæ•´æ•°å˜é‡a è¿æ¥èµ·æ¥å¹¶æ‰“å° System.out.println(\u0026#34;abc\u0026#34; + a); // è¾“å‡ºï¼š\u0026#34;abc10\u0026#34; // æ‰“å°æ•´æ•°å˜é‡a åŠ  5 çš„ç»“æœ System.out.println(a + 5); // è¾“å‡ºï¼š15 // å°†å­—ç¬¦ä¸² \u0026#34;abc\u0026#34;ã€æ•´æ•°å˜é‡a å’Œå­—ç¬¦ \u0026#39;a\u0026#39; è¿æ¥èµ·æ¥å¹¶æ‰“å° System.out.println(\u0026#34;abc\u0026#34; + a + \u0026#39;a\u0026#39;); // è¾“å‡ºï¼š\u0026#34;abc10a\u0026#34; // å°†å­—ç¬¦ \u0026#39;a\u0026#39; çš„ASCIIç å€¼ï¼ˆ97ï¼‰å’Œæ•´æ•°å˜é‡a ç›¸åŠ ï¼Œå†å°†ç»“æœä¸å­—ç¬¦ä¸² \u0026#34;abc\u0026#34; è¿æ¥èµ·æ¥å¹¶æ‰“å° // æ³¨ï¼šå­—ç¬¦ \u0026#39;a\u0026#39; çš„ASCIIç å€¼è¢«å½“ä½œæ•´æ•°å‚ä¸è¿ç®—ï¼Œç„¶åå†å°†ç»“æœè½¬æ¢ä¸ºå­—ç¬¦ System.out.println(\u0026#39;a\u0026#39; + a + \u0026#34;abc\u0026#34;); // è¾“å‡ºï¼š\u0026#34;107abc\u0026#34; // åˆå§‹åŒ–å˜é‡nå’Œmåˆ†åˆ«ä¸º3å’Œ5 int n = 3, m = 5; // è®¡ç®—resçš„å€¼ // ++m: å…ˆè‡ªå¢mï¼Œmå˜æˆ6ï¼Œç„¶åè¿”å›6 // --m: å…ˆè‡ªå‡mï¼Œmå˜æˆ5ï¼Œç„¶åè¿”å›5 // m--: å…ˆè¿”å›mçš„å€¼5ï¼Œç„¶åå†è‡ªå‡mï¼Œmå˜æˆ4 // ++n: å…ˆè‡ªå¢nï¼Œnå˜æˆ4ï¼Œç„¶åè¿”å›4 // n--: å…ˆè¿”å›nçš„å€¼4ï¼Œç„¶åå†è‡ªå‡nï¼Œnå˜æˆ3 // è®¡ç®—ï¼š6 - 5 + 5 - 4 + 4 + 3 = 9 int res = ++m - --m + m-- - ++n + n-- + 3; System.out.println(res); // è¾“å‡ºresçš„å€¼ System.out.println(n); // è¾“å‡ºnçš„å€¼ï¼Œæ­¤æ—¶nä¸º3 System.out.println(m); // è¾“å‡ºmçš„å€¼ï¼Œæ­¤æ—¶mä¸º4 // åˆå§‹åŒ–å˜é‡cå’Œdåˆ†åˆ«ä¸º10å’Œ5 int c = 10, d = 5; // è®¡ç®—res2çš„å€¼ // c++: å…ˆè¿”å›cçš„å€¼10ï¼Œç„¶åå†è‡ªå¢cï¼Œcå˜æˆ11 // ++c: å…ˆè‡ªå¢cï¼Œcå˜æˆ12ï¼Œç„¶åè¿”å›12 // --d: å…ˆè‡ªå‡dï¼Œdå˜æˆ4ï¼Œç„¶åè¿”å›4 // ++d: å…ˆè‡ªå¢dï¼Œdå˜æˆ5ï¼Œç„¶åè¿”å›5 // è®¡ç®—ï¼š10 + 12 - 4 - 5 + 1 + c--ï¼Œå…¶ä¸­cæ­¤æ—¶ä¸º12ï¼Œç„¶åå†è‡ªå‡cï¼Œcå˜æˆ11 // è®¡ç®—ï¼š10 + 12 - 4 - 5 + 1 + 12 = 26 int res2 = c++ + ++c - --d - ++d + 1 + c--; System.out.println(res2); // è¾“å‡ºres2çš„å€¼ System.out.println(c); // è¾“å‡ºcçš„å€¼ï¼Œæ­¤æ—¶cä¸º11 System.out.println(d); // è¾“å‡ºdçš„å€¼ï¼Œæ­¤æ—¶dä¸º5 é€»è¾‘è¿ç®— // å®šä¹‰å˜é‡ double size = 9.8; // sizeçš„å€¼ä¸º9.8 double storage = 16; // storageçš„å€¼ä¸º16 // ç¬¬ä¸€ç»„æ¡ä»¶åˆ¤æ–­ System.out.println(\u0026#34;original \u0026#34; + storage); // ä½¿ç”¨æŒ‰ä½ä¸è¿ç®—ç¬¦\u0026#34;\u0026amp;\u0026#34;ï¼Œå³ä½¿ç¬¬ä¸€ä¸ªæ¡ä»¶ä¸æ»¡è¶³ï¼Œstorageä¹Ÿä¼šè‡ªå¢ boolean res11 = size \u0026lt; 8 \u0026amp; storage++ \u0026gt;= 16; // false System.out.println(res11); // è¾“å‡ºfalse System.out.println(storage); // è¾“å‡º17.0ï¼Œå› ä¸ºstorageåœ¨æ¡ä»¶åˆ¤æ–­ä¹‹åè‡ªå¢äº† // ä½¿ç”¨é€»è¾‘ä¸è¿ç®—ç¬¦\u0026#34;\u0026amp;\u0026amp;\u0026#34;ï¼Œè‹¥ç¬¬ä¸€ä¸ªæ¡ä»¶ä¸æ»¡è¶³ï¼Œåˆ™ä¸ä¼šæ‰§è¡Œç¬¬äºŒä¸ªæ¡ä»¶ï¼Œstorageä¸ä¼šè‡ªå¢ boolean res12 = size \u0026lt; 8 \u0026amp;\u0026amp; storage++ \u0026gt;= 16; // false System.out.println(res12); // è¾“å‡ºfalse System.out.println(storage); // è¾“å‡º17.0ï¼Œå› ä¸ºstorageæ²¡æœ‰è‡ªå¢ // ç¬¬äºŒç»„æ¡ä»¶åˆ¤æ–­ System.out.println(\u0026#34;-------------------\u0026#34;); System.out.println(\u0026#34;original \u0026#34; + storage); // ä½¿ç”¨æŒ‰ä½æˆ–è¿ç®—ç¬¦\u0026#34;|\u0026#34;ï¼Œå³ä½¿ç¬¬ä¸€ä¸ªæ¡ä»¶æ»¡è¶³ï¼Œstorageä¹Ÿä¼šè‡ªå¢ boolean res21 = size \u0026gt;= 8 | storage++ \u0026gt;= 8; // true System.out.println(res21); // è¾“å‡ºtrue System.out.println(storage); // è¾“å‡º18.0ï¼Œå› ä¸ºstorageåœ¨æ¡ä»¶åˆ¤æ–­ä¹‹åè‡ªå¢äº† // ä½¿ç”¨é€»è¾‘æˆ–è¿ç®—ç¬¦\u0026#34;||\u0026#34;ï¼Œè‹¥ç¬¬ä¸€ä¸ªæ¡ä»¶æ»¡è¶³ï¼Œåˆ™ä¸ä¼šæ‰§è¡Œç¬¬äºŒä¸ªæ¡ä»¶ï¼Œstorageä¸ä¼šè‡ªå¢ boolean res22 = size \u0026gt;= 8 || storage++ \u0026gt;= 16; // true System.out.println(res22); // è¾“å‡ºtrue System.out.println(storage); // è¾“å‡º18.0ï¼Œå› ä¸ºstorageæ²¡æœ‰è‡ªå¢ System.out.println(\u0026#34;-------------------\u0026#34;); // å…¶ä»–æ“ä½œ // ä½¿ç”¨é€»è¾‘éè¿ç®—ç¬¦\u0026#34;!\u0026#34;ï¼Œå¯¹trueå–åï¼Œç»“æœä¸ºfalse System.out.println((!true)); // è¾“å‡ºfalse // ä½¿ç”¨æŒ‰ä½å¼‚æˆ–è¿ç®—ç¬¦\u0026#34;^\u0026#34;ï¼Œå¯¹ä¸¤ä¸ªæ•°çš„äºŒè¿›åˆ¶è¿›è¡Œå¼‚æˆ–æ“ä½œï¼Œç»“æœä¸º0 System.out.println((1^1)); // è¾“å‡º0 int grade = 10; // å®šä¹‰æˆç»©å˜é‡ä¸º10 // ä½¿ç”¨ä¸‰å…ƒè¿ç®—ç¬¦åˆ¤æ–­æˆç»©æ˜¯å¦åˆæ ¼ String res = grade \u0026gt;= 60 ? \u0026#34;æˆç»©åˆæ ¼\u0026#34; : \u0026#34;æˆç»©ä¸åˆæ ¼\u0026#34;; System.out.println(res); // è¾“å‡º \u0026#34;æˆç»©ä¸åˆæ ¼\u0026#34;ï¼Œå› ä¸ºgradeçš„å€¼ä¸º10ï¼Œå°äº60 // ç¬¬ä¸€æ¡é€»è¾‘è¡¨è¾¾å¼ System.out.println(10 \u0026gt; 3 || 10 \u0026gt; 3 \u0026amp;\u0026amp; 10 \u0026lt; 3); // è¾“å‡ºtrue // é€»è¾‘è¿ç®—ç¬¦\u0026#34;\u0026amp;\u0026amp;\u0026#34;çš„ä¼˜å…ˆçº§é«˜äº\u0026#34;||\u0026#34;ï¼Œæ‰€ä»¥å…ˆæ‰§è¡Œ10 \u0026gt; 3 \u0026amp;\u0026amp; 10 \u0026lt; 3ï¼Œç»“æœä¸ºfalseï¼Œç„¶åæ‰§è¡Œ10 \u0026gt; 3 || falseï¼Œç»“æœä¸ºtrueã€‚ // ç¬¬äºŒæ¡é€»è¾‘è¡¨è¾¾å¼ System.out.println((10 \u0026gt; 3 || 10 \u0026gt; 3) \u0026amp;\u0026amp; 10 \u0026lt; 3); // è¾“å‡ºfalse // åŠ äº†æ‹¬å·åï¼Œå…ˆæ‰§è¡Œæ‹¬å·å†…çš„10 \u0026gt; 3 || 10 \u0026gt; 3ï¼Œç»“æœä¸ºtrueï¼Œç„¶åä¸10 \u0026lt; 3è¿›è¡Œé€»è¾‘ä¸è¿ç®—ï¼Œç»“æœä¸ºfalseã€‚ è¾“å…¥ // 1. åˆ›å»ºScannerå¯¹è±¡scï¼Œç”¨äºä»System.inï¼ˆå³æ ‡å‡†è¾“å…¥æµï¼Œé€šå¸¸ä¸ºæ§åˆ¶å°ï¼‰è¯»å–ç”¨æˆ·è¾“å…¥ Scanner sc = new Scanner(System.in); // 2. è¾“å‡ºæç¤ºä¿¡æ¯ï¼Œè¦æ±‚ç”¨æˆ·è¾“å…¥å¹´é¾„ System.out.println(\u0026#34;Please input your age:\u0026#34;); // 3. ä½¿ç”¨Scannerå¯¹è±¡scè¯»å–ç”¨æˆ·è¾“å…¥çš„æ•´æ•°å‹å¹´é¾„ï¼Œå¹¶å°†å…¶å­˜å‚¨åœ¨å˜é‡ageä¸­ int age = sc.nextInt(); // 4. æ ¹æ®ç”¨æˆ·è¾“å…¥çš„å¹´é¾„è®¡ç®—å…¶å‡ºç”Ÿå¹´ä»½ï¼ˆå‡è®¾å½“å‰ä¸º2024å¹´ï¼‰ï¼Œç„¶åè¾“å‡ºç»“æœ System.out.println(\u0026#34;Your birth year is :\u0026#34; + (2024 - age)); // 5. è¾“å‡ºæç¤ºä¿¡æ¯ï¼Œè¦æ±‚ç”¨æˆ·è¾“å…¥å§“å System.out.println(\u0026#34;Please input your name:\u0026#34;); // 6. ä½¿ç”¨Scannerå¯¹è±¡scè¯»å–ç”¨æˆ·è¾“å…¥çš„å­—ç¬¦ä¸²å‹å§“åï¼Œå¹¶å°†å…¶å­˜å‚¨åœ¨å˜é‡nameä¸­ String name = sc.next(); // 7. é‡å¤è¾“å‡ºç”¨æˆ·å‡ºç”Ÿå¹´ä»½ï¼ˆä¸æ­¥éª¤4ç›¸åŒï¼Œæ­¤å¤„å¯èƒ½æ˜¯ä»£ç å†—ä½™æˆ–ç¬”è¯¯ï¼‰ System.out.println(\u0026#34;Your birth year is :\u0026#34; + (2024 - age)); // 8. è¾“å‡ºæ¬¢è¿ä¿¡æ¯ï¼ŒåŒ…å«ç”¨æˆ·è¾“å…¥çš„å§“å System.out.println(\u0026#34;Welcome: \u0026#34; + name); switchæ³¨æ„äº‹é¡¹ï¼š\nè¡¨è¾¾å¼ç±»å‹åªèƒ½æ˜¯byte, short, int, char, JDK5å¼€å§‹æ”¯æŒæšä¸¾ï¼Œ JDK7å¼€å§‹æ”¯æŒStringï¼Œä¸æ”¯æŒdoubleï¼Œfloat, longã€‚ caseç»™å‡ºçš„å€¼ä¸å…è®¸é‡å¤ï¼Œä¸”åªèƒ½æ˜¯å­—é¢é‡ï¼Œä¸èƒ½æ˜¯å˜é‡ æ­£å¸¸ä½¿ç”¨æ—¶éœ€è¦å†™breakï¼Œ å¦åˆ™ä¼šå‡ºç°ç©¿é€ç°è±¡ switch æŠ€å·§ï¼šè¿ç”¨ç©¿é€æ€§åˆå¹¶åŒæ ·ç»“æœçš„åˆ†æ”¯ã€‚\npublic class SwitchExample { public static void main(String[] args) { int day = 2; String dayType; switch (day) { case 1: case 2: case 3: case 4: case 5: dayType = \u0026#34;å·¥ä½œæ—¥\u0026#34;; break; case 6: case 7: dayType = \u0026#34;å‘¨æœ«\u0026#34;; break; default: dayType = \u0026#34;æ— æ•ˆçš„æ—¥å­\u0026#34;; break; } System.out.println(\u0026#34;ä»Šå¤©æ˜¯: \u0026#34; + dayType); } } while\n// åˆ›å»ºä¸€ä¸ªRandomå¯¹è±¡ç”¨äºç”Ÿæˆéšæœºæ•° Random random = new Random(); // ç”Ÿæˆ1åˆ°100ä¹‹é—´çš„éšæœºæ•°ä½œä¸ºå¹¸è¿æ•°å­— int luckNumber = random.nextInt(100) + 1; // åˆ›å»ºä¸€ä¸ªScannerå¯¹è±¡ç”¨äºæ¥æ”¶ç”¨æˆ·çš„è¾“å…¥ Scanner sc = new Scanner(System.in); // æç¤ºç”¨æˆ·è¾“å…¥çŒœæµ‹çš„æ•°å­— System.out.println(\u0026#34;è¯·è¾“å…¥ä½ çŒœçš„æ•°å­—\u0026#34;); // å¾ªç¯ï¼Œç›´åˆ°ç”¨æˆ·çŒœä¸­ä¸ºæ­¢ while (true) { // è·å–ç”¨æˆ·è¾“å…¥çš„çŒœæµ‹æ•°å­— int guessNumber = sc.nextInt(); // åˆ¤æ–­ç”¨æˆ·è¾“å…¥çš„æ•°å­—ä¸å¹¸è¿æ•°å­—çš„å…³ç³»ï¼Œå¹¶ç»™å‡ºç›¸åº”æç¤º if (guessNumber == luckNumber) { // å¦‚æœçŒœä¸­äº†ï¼Œè¾“å‡ºæ­å–œä¿¡æ¯ï¼Œå¹¶ç»“æŸå¾ªç¯ System.out.println(\u0026#34;æ­å–œä½ ï¼Œä½ ä¸­äº†100å…ƒå¤§å¥–\u0026#34;); break; } else if (guessNumber \u0026gt; luckNumber) { // å¦‚æœçŒœçš„æ•°å­—å¤ªå¤§ï¼Œæç¤ºç”¨æˆ·æ•°å­—å¤ªå¤§ System.out.println(\u0026#34;ä½ çŒœçš„æ•°å­—å¤ªå¤§äº†\u0026#34;); } else { // å¦‚æœçŒœçš„æ•°å­—å¤ªå°ï¼Œæç¤ºç”¨æˆ·æ•°å­—å¤ªå° System.out.println(\u0026#34;ä½ çŒœçš„æ•°å­—å¤ªå°äº†\u0026#34;); } } æ•°ç»„ //1.æ ‡å‡†å†™æ³• // åˆå§‹åŒ–æ•´å‹æ•°ç»„agesï¼ŒåŒ…å«5ä¸ªå…ƒç´ ï¼Œåˆ†åˆ«ä¸º10, 20, 30, 40, 50 int[] ages = new int[]{ 10, 20, 30, 40, 50 }; // åˆå§‹åŒ–åŒç²¾åº¦æµ®ç‚¹å‹æ•°ç»„scoresï¼ŒåŒ…å«5ä¸ªå…ƒç´ ï¼Œåˆ†åˆ«ä¸º99.9, 88.8, 77.7, 66.6, 55.5 double[] scores = new double[]{ 99.9, 88.8, 77.7, 66.6, 55.5 }; // è¾“å‡ºæ•´å‹æ•°ç»„agesçš„å¼•ç”¨åœ°å€ System.out.println(ages); // è¾“å‡ºåŒç²¾åº¦æµ®ç‚¹å‹æ•°ç»„scoresçš„å¼•ç”¨åœ°å€ //2.ç®€åŒ–å†™æ³• // ä½¿ç”¨ç®€åŒ–è¯­æ³•åˆå§‹åŒ–æ•´å‹æ•°ç»„ages2ï¼ŒåŒ…å«5ä¸ªå…ƒç´ ï¼Œåˆ†åˆ«ä¸º10, 20, 30, 40, 50 int[] ages2 = { 10, 20, 30, 40, 50 }; // ä½¿ç”¨ç®€åŒ–è¯­æ³•åˆå§‹åŒ–åŒç²¾åº¦æµ®ç‚¹å‹æ•°ç»„scores2ï¼ŒåŒ…å«5ä¸ªå…ƒç´ ï¼Œåˆ†åˆ«ä¸º99.9, 88.8, 77.7, 66.6, 55.5 //3.å†™æ³•ä¸‰ int age3[] = new int[10]; Java å†…å­˜åˆ†é… æ–¹æ³•åŒº\næ ˆ\nå †\næœ¬åœ°æ–¹æ³•æ ˆ\nç¨‹åºè®¡æ•°å™¨\nint a = 20; int[] arr = new int[3]; ä»¥ä¸Šä¸¤è¡Œä»£ç çš„æ‰§è¡ŒåŸç†ï¼š\naæ˜¯å˜é‡ï¼Œç›´æ¥æ”¾åœ¨æ ˆä¸­ï¼Œaå˜é‡ä¸­å­˜å‚¨çš„æ•°æ®å°±æ˜¯20è¿™ä¸ªå€¼ new int[3]æ˜¯åˆ›å»ºä¸€ä¸ªæ•°ç»„å¯¹è±¡ï¼Œä¼šåœ¨å †å†…å­˜ä¸­å¼€è¾ŸåŒºå­˜å‚¨3ä¸ªæ•´æ•° arræ˜¯å˜é‡ï¼Œåœ¨æ ˆä¸­ï¼Œarrä¸­å­˜å‚¨çš„æ˜¯æ•°ç»„å¯¹è±¡åœ¨å †å†…å­˜ä¸­åœ°å€å€¼ Javaå°æ¡ˆä¾‹â€”â€”åŒè‰²çƒ package com.show.test; import java.util.Random; import java.util.Scanner; public class Test4 { public static void main(String[] args) { System.out.println(1); int[] userNumber = userChooseNumber(); // ç”¨æˆ·é€‰æ‹©å·ç  int[] luckNumer = createLuckNumber(); // åˆ›å»ºå¹¸è¿å·ç  check(userNumber, luckNumer); // æ£€æŸ¥ç”¨æˆ·é€‰æ‹©çš„å·ç ä¸å¹¸è¿å·ç çš„åŒ¹é…æƒ…å†µ } // ç”¨æˆ·é€‰æ‹©å·ç çš„æ–¹æ³• public static int[] userChooseNumber() { System.out.println(\u0026#34;Welcome to this select ball system!\u0026#34;); // æ¬¢è¿è¯­ int[] numbers = new int[6]; // å­˜å‚¨ç”¨æˆ·é€‰æ‹©çš„å·ç æ•°ç»„ Scanner sc = new Scanner(System.in); for (int i = 0; i \u0026lt; 5; i++) { System.out.println(\u0026#34;Please input your No.\u0026#34; + (i + 1) + \u0026#34; ball\u0026#34;); // æç¤ºç”¨æˆ·è¾“å…¥å·ç  while (true) { int n = sc.nextInt(); // æ¥æ”¶ç”¨æˆ·è¾“å…¥çš„å·ç  if (n \u0026lt; 1 || n \u0026gt; 33) { // åˆ¤æ–­å·ç æ˜¯å¦åœ¨æœ‰æ•ˆèŒƒå›´å†… System.out.println(\u0026#34;Your number not in the available zone: [1,33], Please input again\u0026#34;); } else { if (exist(numbers, n)) { // åˆ¤æ–­å·ç æ˜¯å¦å·²ç»è¢«é€‰æ‹© System.out.println(\u0026#34;Current number has been chosen, Please input again\u0026#34;); } else { numbers[i] = n; // å°†å·ç å­˜å…¥æ•°ç»„ break; } } } System.out.println(\u0026#34;Your input number is :\u0026#34; + numbers[i]); // è¾“å‡ºç”¨æˆ·è¾“å…¥çš„å·ç  } System.out.println(\u0026#34;Input your last number\u0026#34;); while (true) { int n = sc.nextInt(); if (n \u0026lt; 1 || n \u0026gt; 16) { System.out.println(\u0026#34;Your number is not available, Please input the number between 1 and 16\u0026#34;); } else { numbers[5] = n; // å­˜å‚¨æœ€åä¸€ä¸ªå·ç  break; } } System.out.println(\u0026#34;Blow is your input numbers\u0026#34;); printArray(numbers); // æ‰“å°ç”¨æˆ·é€‰æ‹©çš„å·ç  return numbers; } // åˆ¤æ–­æ•°å­—æ˜¯å¦å·²å­˜åœ¨äºæ•°ç»„ä¸­çš„æ–¹æ³• public static boolean exist(int[] arr, int x) { for (int i = 0; i \u0026lt; arr.length; i++) { if (arr[i] == x) { return true; } } return false; } // æ‰“å°æ•°ç»„çš„æ–¹æ³• public static void printArray(int[] arr) { for (int i = 0; i \u0026lt; arr.length; i++) { System.out.print(arr[i] + \u0026#34; \u0026#34;); } System.out.println(); } // åˆ›å»ºå¹¸è¿å·ç çš„æ–¹æ³• public static int[] createLuckNumber() { int[] numbers = new int[6]; // å­˜å‚¨å¹¸è¿å·ç æ•°ç»„ Random r = new Random(); for (int i = 0; i \u0026lt; 5; i++) { while (true) { int n = r.nextInt(33) + 1; // ç”Ÿæˆéšæœºå·ç  if (exist(numbers, n)) { continue; } else { numbers[i] = n; // å°†å·ç å­˜å…¥æ•°ç»„ break; } } } int n = r.nextInt(16) + 1; numbers[5] = n; // å­˜å‚¨æœ€åä¸€ä¸ªå·ç ï¼ˆè“çƒï¼‰ System.out.println(\u0026#34;Blow is the LuckNumber!\u0026#34;); // è¾“å‡ºå¹¸è¿å·ç  printArray(numbers); // æ‰“å°å¹¸è¿å·ç  return numbers; } // æ£€æŸ¥ç”¨æˆ·é€‰æ‹©çš„å·ç ä¸å¹¸è¿å·ç çš„åŒ¹é…æƒ…å†µ public static void check(int[] arr1, int[] arr2) { int redCount = 0, blueCount = 0; // çº¢çƒåŒ¹é…æ•°ã€è“çƒåŒ¹é…æ•°åˆå§‹åŒ–ä¸º0 for (int i = 0; i \u0026lt; arr1.length - 1; i++) { if (arr1[i] == arr2[i]) { // åˆ¤æ–­çº¢çƒæ˜¯å¦åŒ¹é… redCount += 1; } } if (arr1[5] == arr2[5]) { // åˆ¤æ–­è“çƒæ˜¯å¦åŒ¹é… blueCount += 1; } // è¾“å‡ºå‘½ä¸­çš„çº¢çƒæ•°é‡å’Œè“çƒæ•°é‡ System.out.println(\u0026#34;æ‚¨å‘½ä¸­çš„çº¢çƒæ•°é‡æ˜¯ï¼š\u0026#34; + redCount); System.out.println(\u0026#34;æ‚¨å‘½ä¸­çš„è“çƒæ•°é‡æ˜¯ï¼š\u0026#34; + blueCount); // æ ¹æ®å‘½ä¸­æƒ…å†µè¾“å‡ºä¸åŒçš„ä¸­å¥–ä¿¡æ¯ if (redCount == 6 \u0026amp;\u0026amp; blueCount == 1) { System.out.println(\u0026#34;æ­å–œæ‚¨ï¼Œä¸­å¥–1000ä¸‡ï¼Œå¯ä»¥å¼€å§‹äº«å—äººç”Ÿäº†~~~\u0026#34;); } else if (redCount == 6 \u0026amp;\u0026amp; blueCount == 0) { System.out.println(\u0026#34;æ­å–œæ‚¨ï¼Œä¸­å¥–500ä¸‡ï¼Œå¯ä»¥ç¨å¾®å¼€å§‹äº«å—äººç”Ÿäº†~~~\u0026#34;); } else if (redCount == 5 \u0026amp;\u0026amp; blueCount == 1) { System.out.println(\u0026#34;æ­å–œæ‚¨ï¼Œä¸­å¥–3000å…ƒï¼Œå¯ä»¥å‡ºå»åƒé¡¿å°é¾™è™¾äº†~\u0026#34;); } else if (redCount == 5 \u0026amp;\u0026amp; blueCount == 0 || redCount == 4 \u0026amp;\u0026amp; blueCount == 1) { System.out.println(\u0026#34;æ­å–œæ‚¨ï¼Œä¸­äº†å°å¥–ï¼š200å…ƒ~\u0026#34;); } else if (redCount == 4 \u0026amp;\u0026amp; blueCount == 0 || redCount == 3 \u0026amp;\u0026amp; blueCount == 1) { System.out.println(\u0026#34;ä¸­äº†10å…ƒ~\u0026#34;); } else if (redCount \u0026lt; 3 \u0026amp;\u0026amp; blueCount == 1) { System.out.println(\u0026#34;ä¸­äº†5å…ƒ~\u0026#34;); } else { System.out.println(\u0026#34;æ„Ÿè°¢æ‚¨å¯¹ç¦åˆ©äº‹ä¸šåšå‡ºçš„å·¨å¤§è´¡çŒ®~~~\u0026#34;); } } } é¢å‘å¯¹è±¡ å¯¹è±¡å°±æ˜¯ä¸€å¼ è¡¨ã€‚\nthisçš„æ‰§è¡ŒåŸç† thisï¼šå°±æ˜¯ä¸€ä¸ªå˜é‡ï¼Œå¯ä»¥ç”¨åœ¨æ–¹æ³•ä¸­ï¼Œæ¥æ‹¿åˆ°å½“å‰å¯¹è±¡ã€‚\nthisä¸»è¦ç”¨æ¥\npublic class PrintThis { public void printThis(){ System.out.println(this); } } public class Test1 { public static void main(String[] args) { PrintThis t = new PrintThis(); t.printThis();//com.show.thisDemo.PrintThis@3b07d329 System.out.println(t); //com.show.thisDemo.PrintThis@3b07d329 } } public class Student1 { int score; public void check(int score){ if(this.score\u0026gt;score){ System.out.println(\u0026#34;Congratulations!\u0026#34;); }else{ System.out.println(\u0026#34;What\u0026#39;s the pity!\u0026#34;); } } } public static void main(String[] args) { Student1 s1 = new Student1(); s1.score = 10; s1.check(100); } æ„é€ å™¨éœ€è¦æ³¨æ„çš„é—®é¢˜ ä¸å†™æ— å‚æ•°æ„é€ å™¨æ—¶ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªæ— å‚æ•°æ„é€ å™¨ è€Œå†™äº†æœ‰å‚æ•°æ„é€ å™¨ä¹‹åï¼Œå°±ä¸ä¼šè‡ªåŠ¨ç”Ÿæˆæ— å‚æ•°æ„é€ å™¨äº†ï¼Œ éœ€è¦æ‰‹åŠ¨å†™ä¸Šã€‚ å°è£… å°±æ˜¯ç”¨ç±»è®¾è®¡å¯¹è±¡å¤„ç†æŸä¸€ä¸ªäº‹ç‰©çš„æ•°æ®æ—¶ï¼Œåº”è¯¥æŠŠè¦å¤„ç†çš„æ•°æ®ï¼Œä»¥åŠå¤„ç†è¿™äº›æ•°æ®çš„æ–¹æ³•ï¼Œè®¾è®¡åˆ°ä¸€ä¸ªå¯¹è±¡ä¸­å» åˆç†éšè—ï¼Œåˆç†æš´éœ²ï¼ˆget, setæ–¹æ³•ï¼‰\nå®ä¾‹JavaBean å®ä½“ç±»ï¼šä¸€ç§ç‰¹æ®Šçš„ç±»\nMovie package com.show.ObjectDemo; public class Movie { // ç§æœ‰å±æ€§ private int id; // ç”µå½±ID private String name; // ç”µå½±åç§° private double price; // ç”µå½±ç¥¨ä»· private double score; // ç”µå½±è¯„åˆ† private String director; // å¯¼æ¼” private String actor; // ä¸»æ¼” private String info; // ç”µå½±ä¿¡æ¯ // æ— å‚æ„é€ æ–¹æ³• public Movie() { } // å¸¦å‚æ„é€ æ–¹æ³• public Movie(int id, String name, double price, double score, String director, String actor, String info) { this.id = id; this.name = name; this.price = price; this.score = score; this.director = director; this.actor = actor; this.info = info; } // Getterå’ŒSetteræ–¹æ³• public int getId() { return id; } public void setId(int id) { this.id = id; } public String getName() { return name; } public void setName(String name) { this.name = name; } public double getPrice() { return price; } public void setPrice(double price) { this.price = price; } public double getScore() { return score; } public void setScore(double score) { this.score = score; } public String getDirector() { return director; } public void setDirector(String director) { this.director = director; } public String getActor() { return actor; } public void setActor(String actor) { this.actor = actor; } public String getInfo() { return info; } public void setInfo(String info) { this.info = info; } } MovieOperator package com.show.ObjectDemo; public class MovieOperator { // ç”µå½±æ•°ç»„ private Movie[] movies; // æ„é€ æ–¹æ³• public MovieOperator(Movie[] movies) { this.movies = movies; } // æ‰“å°æ‰€æœ‰ç”µå½±ä¿¡æ¯ public void printAllMovies() { System.out.println(\u0026#34;ç³»ç»Ÿå…¨éƒ¨ç”µå½±ä¿¡æ¯å¦‚ä¸‹â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”\u0026#34;); for (int i = 0; i \u0026lt; movies.length; i++) { Movie m = movies[i]; System.out.println(\u0026#34;ç¼–å·ï¼šâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”\u0026#34; + m.getId()); System.out.println(\u0026#34;ç”µå½±åï¼šâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”\u0026#34; + m.getName()); System.out.println(\u0026#34;ä»·æ ¼ï¼šâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”\u0026#34; + m.getPrice()); System.out.println(\u0026#34;-----------------------\u0026#34;); } } // æ ¹æ®IDæŸ¥è¯¢ç”µå½±ä¿¡æ¯ public void searchMovieById(int id) { for (int i = 0; i \u0026lt; movies.length; i++) { Movie m = movies[i]; if (id == m.getId()) { System.out.println(\u0026#34;å­˜åœ¨è¯¥ç”µå½±ï¼\u0026#34;); System.out.println(\u0026#34;ç¼–å·ï¼šâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”\u0026#34; + m.getId()); System.out.println(\u0026#34;ç”µå½±åï¼šâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”\u0026#34; + m.getName()); System.out.println(\u0026#34;ä»·æ ¼ï¼šâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”\u0026#34; + m.getPrice()); System.out.println(\u0026#34;å¯¼æ¼”ï¼šâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”\u0026#34; + m.getDirector()); System.out.println(\u0026#34;æ¼”å‘˜ï¼šâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”\u0026#34; + m.getActor()); System.out.println(\u0026#34;è¯„åˆ†ï¼šâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”\u0026#34; + m.getScore()); System.out.println(\u0026#34;å…¶ä»–ä¿¡æ¯ï¼šâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”\u0026#34; + m.getInfo()); return; } } System.out.println(\u0026#34;ä¸å­˜åœ¨è¯¥ç”µå½±\u0026#34;); } } Test package com.show.ObjectDemo; import java.util.Scanner; public class Test { public static void main(String[] args) { // åˆ›å»ºMovieå¯¹è±¡æ•°ç»„ï¼Œå­˜å‚¨ç”µå½±ä¿¡æ¯ Movie[] movies = new Movie[4]; movies[0] = new Movie(1, \u0026#34;æ°´é—¨æ¡¥\u0026#34;, 38.9, 9.8, \u0026#34;å¾å…‹\u0026#34;, \u0026#34;å´äº¬\u0026#34;, \u0026#34;12ä¸‡äººæƒ³çœ‹\u0026#34;); movies[1] = new Movie(2, \u0026#34;å‡ºæ‹³å§\u0026#34;, 39, 7.8, \u0026#34;å”æ™“ç™½\u0026#34;, \u0026#34;ç”°é›¨\u0026#34;, \u0026#34;3.5ä¸‡äººæƒ³çœ‹\u0026#34;); movies[2] = new Movie(3, \u0026#34;æœˆçƒé™¨è½\u0026#34;, 42, 7.9, \u0026#34;ç½—å…°\u0026#34;, \u0026#34;è´ç‘\u0026#34;, \u0026#34;17.9ä¸‡äººæƒ³çœ‹\u0026#34;); movies[3] = new Movie(4, \u0026#34;ä¸€ç‚¹å°±åˆ°å®¶\u0026#34;, 35, 8.7, \u0026#34;è®¸å®å®‡\u0026#34;, \u0026#34;åˆ˜æ˜Šç„¶\u0026#34;, \u0026#34;10.8ä¸‡äººæƒ³çœ‹\u0026#34;); // åˆ›å»ºMovieOperatorå¯¹è±¡ï¼Œç”¨äºæ“ä½œMovieæ•°ç»„ MovieOperator movieOperator = new MovieOperator(movies); System.out.println(\u0026#34;åœ¨è¿™é‡Œï¼Œä½ å¯ä»¥æŸ¥è¯¢å…³äºæœ€æ–°çš„ç”µå½±ä¿¡æ¯ï¼\u0026#34;); Scanner sc = new Scanner(System.in); while (true) { System.out.println(\u0026#34;è¾“å…¥1æŸ¥çœ‹æ‰€æœ‰ç”µå½±ä¿¡æ¯\u0026#34;); System.out.println(\u0026#34;è¾“å…¥2å¯ä»¥æŸ¥è¯¢æŸä¸ªç‰¹å®šç”µå½±çš„è¯¦ç»†ä¿¡æ¯\u0026#34;); int cmd = sc.nextInt(); switch (cmd) { case 1: movieOperator.printAllMovies(); // æ‰“å°æ‰€æœ‰ç”µå½±ä¿¡æ¯ break; case 2: System.out.println(\u0026#34;è¯·è¾“å…¥ä½ éœ€è¦æŸ¥è¯¢çš„ç”µå½±ID\u0026#34;); int id = sc.nextInt(); movieOperator.searchMovieById(id); // æ ¹æ®IDæŸ¥è¯¢ç”µå½±ä¿¡æ¯ break; default: System.out.println(\u0026#34;éæ³•å‘½ä»¤ï¼Œè¯·é‡æ–°è¾“å…¥\u0026#34;); } } } } æˆå‘˜å˜é‡å’Œå±€éƒ¨å˜é‡ æˆå‘˜å˜é‡ï¼šç±»ä¸­ï¼Œ æ–¹æ³•å¤–ï¼Œ æœ‰é»˜è®¤å€¼ï¼Œ å­˜äºå †å†…å­˜ä¸­ï¼Œ å±äºæ•´ä¸ªå¯¹è±¡ï¼Œ ä¸å¯¹è±¡åŒç”Ÿå…±æ­»\nå±€éƒ¨å˜é‡ï¼šå¸¸è§äºæ–¹æ³•ä¸­ï¼Œæ— é»˜è®¤å€¼ï¼Œéœ€è¦åˆå§‹åŒ–ï¼Œ å­˜äºæ ˆå†…å­˜ä¸­ï¼Œ å±äºæ‰€å±å¤§æ‹¬å·ä¸­ï¼Œ æ–¹æ³•è°ƒç”¨è€Œç”Ÿï¼Œç»“æŸè€Œäº¡\nAPI æ³¨æ„äº‹é¡¹ åŒä¸€ä¸ªåŒ…ä¸‹çš„ç¨‹åºï¼Œå¯ä»¥ç›´æ¥è®¿é—® è®¿é—®å…¶ä»–åŒ…ä¸‹çš„ç¨‹åºï¼Œå¿…é¡»å¯¼åŒ…æ‰å¯ä»¥è®¿é—® è‡ªå·±çš„ç¨‹åºä¸­è°ƒç”¨Javaæä¾›çš„ç¨‹åºï¼Œä¹Ÿéœ€è¦å…ˆå¯¼åŒ…æ‰å¯ä»¥ä½¿ç”¨ æ³¨æ„Java.langåŒ…ä¸‹çš„ç¨‹åºæ˜¯ä¸éœ€è¦å¯¼åŒ…ï¼Œ å¯ä»¥ç›´æ¥ä½¿ç”¨ è®¿é—®å¤šä¸ªå…¶ä»–åŒ…ä¸‹çš„ç¨‹åºï¼Œåœ¨è¿™äº›ç¨‹åºåä¸€æ ·çš„æƒ…å†µä¸‹ï¼Œé»˜è®¤åªèƒ½åªèƒ½å¯¼å…¥ä¸€ä¸ªç¨‹åºï¼Œå¦å¤–ä¸€ä¸ªç¨‹åºå¿…é¡»å¸¦åŒ…åå’Œç±»åæ¥è®¿é—®ã€‚ Demo d = new Demo(); d.print(); Demo1 d1 = new Demo1(); d1.print(); com.show.pkgDemo3.Demo1 d2 = new com.show.pkgDemo3.Demo1(); d2.print(); String String name = \u0026#34;Java\u0026#34;; System.out.println(name); String rs1 = new String(); System.out.println(rs1); String rs2 = new String(\u0026#34;NewStringJava\u0026#34;); System.out.println(rs2); String æ˜¯ä¸å¯å˜çš„ åªè¦æ˜¯\u0026quot;...\u0026quot;çš„æ–¹å¼å†™å‡ºçš„å­—ç¬¦ä¸²å¯¹è±¡ï¼Œä¼šå­˜å‚¨åˆ°å­—ç¬¦ä¸²å¸¸é‡æ± ä¸­ï¼Œä¸”ç›¸åŒå†…å®¹çš„å­—ç¬¦åªä¼šå­˜å‚¨ä¸€ä»½ è€Œnew Stringåˆ›å»ºå­—ç¬¦ä¸²å¯¹è±¡æ—¶ï¼Œæ¯æ¬¡éƒ½ä¼šnewå‡ºæ¥ä¸€ä¸ªæ–°å¯¹è±¡ï¼Œæ”¾åœ¨å †å†…å­˜ä¸­ã€‚ String s1 = \u0026#34;abc\u0026#34;; String s2 = \u0026#34;abc\u0026#34;; System.out.println(s1==s2); //true char[] ch = {\u0026#39;1\u0026#39;, \u0026#39;2\u0026#39;, \u0026#39;3\u0026#39;}; String s3 = new String(ch); String s4 = new String(ch); System.out.println(s3==s4); //false String s5 = new String(\u0026#34;abc\u0026#34;); // å®é™…åˆ›å»ºäº†ä¸¤ä¸ªå¯¹è±¡ï¼Œä¸€ä¸ªåœ¨å­—ç¬¦ä¸²å¸¸é‡æ± å½“ä¸­ // å¦ä¸€ä¸ªåœ¨å †å†…å­˜ä¸­ String s6 = \u0026#34;abc\u0026#34;; // å®é™…åˆ›å»ºäº†0ä¸ªå¯¹è±¡ï¼Œå› ä¸º\u0026#34;abc\u0026#34;å·²ç»åœ¨å¸¸é‡æ± å½“ä¸­äº† System.out.println(s5==s6); //false String s7 = \u0026#34;abc\u0026#34;; String s8 = \u0026#34;a\u0026#34;+\u0026#39;b\u0026#39;+\u0026#34;c\u0026#34;; //ç¼–è¯‘å™¨ä¼šè‡ªåŠ¨å¤„ç† System.out.println(s7==s8); //true String s9 = \u0026#34;abc\u0026#34;; String s10 = \u0026#34;ab\u0026#34;; String s11 = s10 + \u0026#34;c\u0026#34;; //è€Œå¯¹äºå˜é‡åˆ™ä¸ä¼šè‡ªåŠ¨å¤„ç† System.out.println(s9==s11); //false ArrayList ArrayList\u0026lt;String\u0026gt; list = new ArrayList\u0026lt;\u0026gt;(); list.add(\u0026#34;heima\u0026#34;); list.add(\u0026#34;Java\u0026#34;); list.add(\u0026#34;çˆªæ´¼\u0026#34;); System.out.println(list);//[heima, Java, çˆªæ´¼] list.add(1, \u0026#34;JAVAJAVA\u0026#34;); System.out.println(list); //[heima, JAVAJAVA, Java, çˆªæ´¼] System.out.println(list.get(1));//JAVAJAVA System.out.println(list.size());//4 System.out.println(list.remove(1));//JAVAJAVA System.out.println(list.remove(\u0026#34;Java\u0026#34;)); //true é»˜è®¤åˆ é™¤ç¬¬ä¸€ä¸ªå‡ºç°çš„å…ƒç´  System.out.println(list);//[heima, çˆªæ´¼] System.out.println(list.set(1, \u0026#34;ZhuaWa\u0026#34;));//çˆªæ´¼ System.out.println(list);//[heima, ZhuaWa] ç»¼åˆå®è·µé¡¹ç›®â€”â€”ATM Account package com.showguan; public class Account { private int userId; private String userName; private String cardId; private char sex; private String possword; private double money; private double limit; public int getUserId() { return userId; } public void setUserId(int userId) { this.userId = userId; } public String getUserName() { return userName + (this.sex == \u0026#39;ç”·\u0026#39; ? \u0026#34;å…ˆç”Ÿ\u0026#34; : \u0026#34;å¥³å£«\u0026#34;); } public void setUserName(String userName) { this.userName = userName; } public char getSex() { return sex; } public void setSex(char sex) { this.sex = sex; } public String getPossword() { return possword; } public void setPossword(String possword) { this.possword = possword; } public double getMoney() { return money; } public void setMoney(double money) { this.money = money; } public double getLimit() { return limit; } public void setLimit(double limit) { this.limit = limit; } public String getCardId() { return cardId; } public void setCardId(String cardId) { this.cardId = cardId; } } ATM package com.showguan; import java.util.ArrayList; import java.util.Random; import java.util.Scanner; public class ATM { private ArrayList\u0026lt;Account\u0026gt; accounts = new ArrayList\u0026lt;\u0026gt;(); private Account loginAcc; private Scanner sc = new Scanner(System.in); public void start() { /** * å¯åŠ¨ATMç³»ç»Ÿï¼Œå±•ç¤ºæ¬¢è¿ç•Œé¢ */ while (true) { System.out.println(\u0026#34;æ¬¢è¿æ‚¨è¿›å…¥ATMç³»ç»Ÿï¼\u0026#34;); System.out.println(\u0026#34;1. ç”¨æˆ·ç™»å½•\u0026#34;); System.out.println(\u0026#34;2. ç”¨æˆ·å¼€æˆ·\u0026#34;); System.out.println(\u0026#34;è¯·è¾“å…¥ä½ éœ€è¦è¿›è¡Œçš„æ“ä½œï¼š\u0026#34;); String command = sc.next(); switch (command) { case \u0026#34;1\u0026#34;: login(); break; case \u0026#34;2\u0026#34;: createAccount(); break; default: System.out.println(\u0026#34;ä½ è¾“å…¥çš„æ“ä½œæœ‰è¯¯ï¼Œè¯·é‡æ–°ä¹¦è¾“å…¥ï¼\u0026#34;); System.out.println(); break; } } } private void createAccount() { System.out.println(\u0026#34;===ç³»ç»Ÿå¼€æˆ·æ“ä½œ===\u0026#34;); Account acc = new Account(); System.out.println(\u0026#34;è¯·è¾“å…¥ç”¨æˆ·å\u0026#34;); String name = sc.next(); acc.setUserName(name); while (true) { System.out.println(\u0026#34;è¯·è¾“å…¥æ€§åˆ«ï¼š\u0026#34;); char sex = sc.next().charAt(0); if (sex == \u0026#39;ç”·\u0026#39; || sex == \u0026#39;å¥³\u0026#39;) { acc.setSex(sex); break; } else { System.out.println(\u0026#34;ä½ è¾“å…¥çš„æ€§åˆ«æœ‰è¯¯ï¼è¯·é‡æ–°è¾“å…¥\u0026#34;); } } while (true) { System.out.println(\u0026#34;è¯·è¾“å…¥æ‚¨çš„è´¦æˆ·å¯†ç ï¼š\u0026#34;); String password = sc.next(); System.out.println(\u0026#34;è¯·è¾“å…¥æ‚¨çš„ç¡®è®¤å¯†ç ï¼š\u0026#34;); String confirmPassword = sc.next(); if (password.equals(confirmPassword)) { acc.setPossword(password); System.out.println(\u0026#34;å¯†ç è®¾ç½®æˆåŠŸï¼\u0026#34;); break; } else { System.out.println(\u0026#34;ä¸¤æ¬¡å¯†ç ä¸ä¸€è‡´ï¼Œè¯·é‡æ–°è®¾ç½®å¯†ç ï¼\u0026#34;); } } System.out.println(\u0026#34;è¯·è¾“å…¥æ‚¨çš„å–ç°æœ€å¤§é¢åº¦\u0026#34;); double limit = sc.nextDouble(); acc.setLimit(limit); String cardId = createCardId(); acc.setCardId(cardId); accounts.add(acc); System.out.println(\u0026#34;æ­å–œä½ ï¼\u0026#34; + acc.getUserName() + \u0026#34;å¼€æˆ·å®Œæˆ, æ‚¨çš„å¡å·æ˜¯:\u0026#34; + acc.getCardId()); } private String createCardId() { while (true) { String cardId = \u0026#34;\u0026#34;; Random r = new Random(); for (int i = 0; i \u0026lt; 8; i++) { int data = r.nextInt(10); cardId += data; } Account acc = getAccountByCardID(cardId); if (acc == null) { return cardId; } } } private Account getAccountByCardID(String cardId) { for (int i = 0; i \u0026lt; accounts.size(); i++) { Account acc = accounts.get(i); if (acc.getCardId().equals(cardId)) { return acc; } } return null; } private void login() { System.out.println(\u0026#34;===ç³»ç»Ÿç™»å½•===\u0026#34;); if (accounts.size() == 0) { System.out.println(\u0026#34;å½“å‰ç³»ç»Ÿå†…è¿˜æ²¡æœ‰ä»»ä½•è´¦æˆ·ï¼Œè¯·å…ˆåˆ›å»ºè´¦æˆ·å†æ¥ç™»å½•ï¼\u0026#34;); return; } System.out.println(\u0026#34;è¯·è¾“å…¥æ‚¨çš„å¡å·\u0026#34;); String cardId = sc.next(); Account acc = getAccountByCardID(cardId); if (acc == null) { System.out.println(\u0026#34;ç”¨æˆ·ä¸å­˜åœ¨\u0026#34;); } else { while (true) { System.out.println(\u0026#34;è¯·è¾“å…¥ç”¨æˆ·å¯†ç \u0026#34;); String passWord = sc.next(); if (passWord.equals(acc.getPossword())) { System.out.println(\u0026#34;ç™»é™†æˆåŠŸï¼\u0026#34;); loginAcc = acc; showUerCommand(); break; } else { System.out.println(\u0026#34;å¯†ç é”™è¯¯ï¼è¯·é‡æ–°è¾“å…¥\u0026#34;); } } } } private void showUerCommand() { while (true) { System.out.println(loginAcc.getUserName() + \u0026#34;æ‚¨å¯ä»¥è¿›è¡Œå¦‚ä¸‹æ“ä½œ\u0026#34;); System.out.println(\u0026#34;1. æŸ¥è¯¢è´¦æˆ·\u0026#34;); System.out.println(\u0026#34;2. å­˜æ¬¾\u0026#34;); System.out.println(\u0026#34;3. å–æ¬¾\u0026#34;); System.out.println(\u0026#34;4. è½¬è´¦\u0026#34;); System.out.println(\u0026#34;5. ä¿®æ”¹å¯†ç \u0026#34;); System.out.println(\u0026#34;6. é€€å‡º\u0026#34;); System.out.println(\u0026#34;7. æ³¨é”€å½“å‰è´¦æˆ·\u0026#34;); System.out.println(\u0026#34;è¯·é€‰æ‹©æ‚¨è¦è¿›è¡Œçš„æ“ä½œï¼š\u0026#34;); String command = sc.next(); switch (command) { case \u0026#34;1\u0026#34;: showloginAccount(); break; case \u0026#34;2\u0026#34;: depositMoney(); break; case \u0026#34;3\u0026#34;: withDrawMoney(); break; case \u0026#34;4\u0026#34;: transferMoney(); break; case \u0026#34;5\u0026#34;: updatePassword(); return; case \u0026#34;6\u0026#34;: System.out.println(\u0026#34;ç”¨æˆ·\u0026#34; + loginAcc.getUserName() + \u0026#34;æˆåŠŸé€€å‡ºç³»ç»Ÿï¼\u0026#34;); return; case \u0026#34;7\u0026#34;: if (deleteAccount()) { return; } break; default: break; } } } private void updatePassword() { System.out.println(\u0026#34;===è´¦å·å¯†ç ä¿®æ”¹æ“ä½œ===\u0026#34;); while (true) { System.out.println(\u0026#34;è¯·è¾“å…¥å½“å‰è´¦æˆ·å¯†ç \u0026#34;); String password = sc.next(); if (loginAcc.getPossword().equals(password)) { while (true) { System.out.println(\u0026#34;è¯·è¾“å…¥ä½ è¦ä¿®æ”¹ä¸ºçš„æ–°å¯†ç ï¼š\u0026#34;); String newPassword = sc.next(); System.out.println(\u0026#34;è¯·é‡å¤ä½ éœ€è¦ä¿®æ”¹ä¸ºçš„å¯†ç ï¼š\u0026#34;); String confirmNewPassword = sc.next(); if (newPassword.equals(confirmNewPassword)) { System.out.println(\u0026#34;å¯†ç ä¿®æ”¹æˆåŠŸ\u0026#34;); loginAcc.setPossword(newPassword); return; } System.out.println(\u0026#34;ä¸¤æ¬¡å¯†ç ä¸ä¸€è‡´ï¼Œ è¯·é‡æ–°è¾“å…¥\u0026#34;); } } else { System.out.println(\u0026#34;æ‚¨å½“å‰è¾“å…¥çš„å¯†ç é”™è¯¯ï¼\u0026#34;); } } } private boolean deleteAccount() { System.out.println(\u0026#34;===é”€æˆ·æ“ä½œ===\u0026#34;); System.out.println(\u0026#34;ç¡®å®šè¦é”€æˆ·å—ï¼Ÿy/n\u0026#34;); String command = sc.next(); switch (command) { case \u0026#34;y\u0026#34;: if (loginAcc.getMoney() == 0) { accounts.remove(loginAcc); System.out.println(\u0026#34;é”€æˆ·æˆåŠŸ\u0026#34;); return true; } else { System.out.println(\u0026#34;è´¦æˆ·ä¸‹ä½™é¢ä¸ä¸º0ï¼Œ ä¸å…è®¸é”€æˆ·\u0026#34;); } break; } return false; } private void transferMoney() { System.out.println(\u0026#34;===ç”¨æˆ·è½¬è´¦===\u0026#34;); if (accounts.size() \u0026lt; 2) { System.out.println(\u0026#34;ç³»ç»Ÿå†…åªæœ‰æ‚¨ä¸€ä¸ªè´¦æˆ·ï¼Œæ— æ³•è½¬è´¦\u0026#34;); return; } if (loginAcc.getMoney() \u0026lt; 0) { System.out.println(\u0026#34;æ‚¨è‡ªå·±éƒ½æ²¡é’±äº†ï¼Œå°±åˆ«è½¬äº†å§ï¼\u0026#34;); return; } while (true) { System.out.println(\u0026#34;è¯·æ‚¨è¾“å…¥å¯¹æ–¹çš„å¡å·:\u0026#34;); String receiveCardID = sc.next(); Account acc = getAccountByCardID(receiveCardID); if (acc == null) { System.out.println(\u0026#34;æ‚¨è¾“å…¥çš„å¡å·ä¸å­˜åœ¨ï¼\u0026#34;); } else { String receiveName = \u0026#34;*\u0026#34; + acc.getUserName().substring(1); System.out.println(\u0026#34;è¯·æ‚¨è¾“å…¥ã€\u0026#34; + receiveName + \u0026#34;ã€‘å§“æ°\u0026#34;); System.out.println(receiveName); String firstName = sc.next(); if (acc.getUserName().startsWith(firstName)) { System.out.println(\u0026#34;å§“æ°éªŒè¯æˆåŠŸï¼\u0026#34;); while (true) { System.out.println(); System.out.println(\u0026#34;è¯·æ‚¨è¾“å…¥è½¬è®©ç»™å¯¹æ–¹çš„é‡‘é¢:\u0026#34;); double transfermoney = sc.nextDouble(); if (loginAcc.getMoney() \u0026gt;= transfermoney) { System.out.println(\u0026#34;è½¬è´¦æˆåŠŸï¼\u0026#34;); loginAcc.setMoney(loginAcc.getMoney() - transfermoney); acc.setMoney(acc.getMoney() + transfermoney); return; } else { System.out.println(\u0026#34;ä½™é¢ä¸è¶³ï¼Œæ— æ³•è½¬è´¦ï¼ï¼æœ€å¤šå¯è½¬\u0026#34; + loginAcc.getMoney()); } } } else { System.out.println(\u0026#34;å¯¹ä¸èµ·ï¼Œ æ‚¨è®¤è¯çš„å§“æ°æœ‰é—®é¢˜ï¼\u0026#34;); } } } } private void withDrawMoney() { System.out.println(\u0026#34;===å–é’±æ“ä½œ===\u0026#34;); if (loginAcc.getMoney() \u0026lt; 100) { System.out.println(\u0026#34;æ‚¨çš„è´¦æˆ·ä½™é¢ä¸è¶³100å…ƒï¼Œä¸å…è®¸å–é’±\u0026#34;); return; } while (true) { System.out.println(\u0026#34;è¯·æ‚¨è¾“å…¥å–æ¬¾é‡‘é¢ï¼š\u0026#34;); double drawMoney = sc.nextDouble(); if (loginAcc.getMoney() \u0026gt;= drawMoney) { if (drawMoney \u0026gt; loginAcc.getLimit()) { System.out.println(\u0026#34;å–æ¬¾é‡‘é¢å¤§äºé™å®šé¢åº¦ï¼Œ æ‚¨å½“å‰çš„é™å®šé¢åº¦ä¸º:\u0026#34; + loginAcc.getLimit()); break; } else { loginAcc.setMoney(loginAcc.getMoney() - drawMoney); System.out.println(\u0026#34;å–æ¬¾æˆåŠŸï¼Œ å–æ¬¾é‡‘é¢ä¸º\u0026#34; + drawMoney + \u0026#34;è´¦æˆ·å†…å‰©ä½™ä½™é¢:\u0026#34; + loginAcc.getMoney()); return; } } else { System.out.println(\u0026#34;ä½™é¢ä¸è¶³ï¼Œ æ‚¨å½“å‰çš„è´¦æˆ·ä½™é¢æ˜¯ï¼š\u0026#34; + loginAcc.getMoney()); } } } private void showloginAccount() { System.out.println(\u0026#34;===å½“å‰æ‚¨çš„è´¦æˆ·ä¿¡æ¯å¦‚ä¸‹===\u0026#34;); System.out.println(\u0026#34;ç”¨æˆ·å: \u0026#34; + loginAcc.getUserName()); System.out.println(\u0026#34;æ€§åˆ«: \u0026#34; + loginAcc.getSex()); System.out.println(\u0026#34;å¡å·: \u0026#34; + loginAcc.getCardId()); System.out.println(\u0026#34;ä½™é¢: \u0026#34; + loginAcc.getMoney()); System.out.println(\u0026#34;å–ç°æœ€å¤§é¢åº¦: \u0026#34; + loginAcc.getLimit()); } private void depositMoney() { System.out.println(\u0026#34;==å­˜æ¬¾æ“ä½œ==\u0026#34;); System.out.println(\u0026#34;è¯·è¾“å…¥ä½ è¦å­˜æ¬¾çš„é‡‘é¢\u0026#34;); double money = sc.nextDouble(); loginAcc.setMoney(loginAcc.getMoney() + money); System.out.println(\u0026#34;æ­å–œæ‚¨\u0026#34; + \u0026#34;å­˜æ¬¾ï¼š\u0026#34; + money + \u0026#34;å­˜æ¬¾åä½™é¢:\u0026#34; + loginAcc.getMoney()); } } Test package com.showguan; public class Test { public static void main(String[] args) { ATM atm = new ATM(); atm.start(); } } ","permalink":"https://kennems.github.io/posts/tech/java20%E5%A4%A9%E9%80%9F%E6%88%90%E5%9F%BA%E7%A1%80%E8%AF%BE%E7%A8%8B/","summary":"JAVA 20å¤©é€Ÿæˆ æœ‰å¿—è€…äº‹ç«Ÿæˆ æ²¡æœ‰å®Œå®Œå…¨å…¨çš„æŠ•å…¥ï¼Œæ£€æµ‹ï¼Œå­¦ä¹ æ˜¯å­¦ä¸åˆ°ä¸œè¥¿çš„ã€‚ è‡ªæ¬ºæ¬ºäººï¼Œçœ¼é«˜æ‰‹ä½æ˜¯ç»å¯¹æ²¡æœ‰ä»»ä½•ä½œç”¨çš„ã€‚ JAVAèƒŒæ™¯ä¿¡æ¯ JAVAæ˜¯ä¸€é—¨","title":"Java20å¤©é€Ÿæˆâ€”â€”åŸºç¡€è¯¾ç¨‹"},{"content":"Acwingç®—æ³•å­¦ä¹  [TOC]\nç¬¬ä¸€ç«  è¯¾ä¸Šï¼šå­¦æ€æƒ³\nè¯¾ä¸‹ï¼šèƒŒä»£ç \né¢˜ç›®ï¼Œä¸€é“é¢˜å†™å¥½å‡ é\nç†è§£æ²¡æœ‰ä»»ä½•æ„ä¹‰ï¼Œä½“åŠ›æ´»+è„‘åŠ›æ´»\nè®°å¿†åŠ› æ¯…åŠ›/è‡ªåˆ¶åŠ›\næ²‰ä¸‹å¿ƒèƒŒä¸œè¥¿\nå¿«é€Ÿæ’åºç®—æ³•æ¨¡æ¿ â€”â€” æ¨¡æ¿é¢˜ AcWing 785. å¿«é€Ÿæ’åº åˆ†æ²»\n1ã€ç¡®å®šåˆ†ç•Œç‚¹ï¼Œlã€rã€ï¼ˆl+r)/2 éšæœº\n2ã€è°ƒæ•´åŒºé—´ï¼Œåˆ†ä¸ºä¸¤è¾¹ï¼Œå·¦è¾¹å°äºç­‰äºx,å³è¾¹å¤§äºç­‰äºx\n3ã€é€’å½’å¤„ç†å·¦å³ä¸¤æ®µ\nvoid quick_sort(int q[], int l, int r) { if (l \u0026gt;= r) return; int i = l - 1, j = r + 1, x = q[l + r \u0026gt;\u0026gt; 1]; while (i \u0026lt; j) { do i ++ ; while (q[i] \u0026lt; x); do j -- ; while (q[j] \u0026gt; x); if (i \u0026lt; j) swap(q[i], q[j]); } quick_sort(q, l, j), quick_sort(q, j + 1, r); } -std=c++11 å½’å¹¶æ’åºç®—æ³•æ¨¡æ¿ â€”â€” æ¨¡æ¿é¢˜ AcWing 787. å½’å¹¶æ’åº æ’åºç¨³å®šï¼šåºåˆ—ä¸­ç›¸åŒçš„å€¼æ’åºåçš„ç›¸å¯¹ä½ç½®æ˜¯å¦å‘ç”Ÿæ”¹å˜\næ—¶é—´å¤æ‚åº¦æœ‰ ï¼ˆnlogn)\n1ï¼‰ç¡®å®šåˆ†ç•Œç‚¹mid\n2ï¼‰é€’å½’æ’åºä¸¤è¾¹\n2ï¼‰å½’å¹¶ï¼Œåˆå¹¶ä¸ºä¸€ä¸ªæœ‰åºæ•°ç»„\nvoid merge_sort(int q[], int l, int r) { if (l \u0026gt;= r) return; int mid = l + r \u0026gt;\u0026gt; 1; merge_sort(q, l, mid); merge_sort(q, mid + 1, r); int k = 0, i = l, j = mid + 1; while (i \u0026lt;= mid \u0026amp;\u0026amp; j \u0026lt;= r) if (q[i] \u0026lt; q[j]) tmp[k ++ ] = q[i ++ ]; else tmp[k ++ ] = q[j ++ ]; while (i \u0026lt;= mid) tmp[k ++ ] = q[i ++ ]; while (j \u0026lt;= r) tmp[k ++ ] = q[j ++ ]; for (i = l, j = 0; i \u0026lt;= r; i ++, j ++ ) q[i] = tmp[j]; } æ•´æ•°äºŒåˆ†ç®—æ³•æ¨¡æ¿ â€”â€” æ¨¡æ¿é¢˜ AcWing 789. æ•°çš„èŒƒå›´ è¾¹ç•Œé—®é¢˜\næœ¬è´¨ï¼šåŒºé—´å†…ä¸€åŠæ»¡è¶³ä¸€åŠä¸æ»¡è¶³\nl=midæ—¶åŠ ä¸€\nbool check(int x) {/* ... */} // æ£€æŸ¥xæ˜¯å¦æ»¡è¶³æŸç§æ€§è´¨ // åŒºé—´[l, r]è¢«åˆ’åˆ†æˆ[l, mid]å’Œ[mid + 1, r]æ—¶ä½¿ç”¨ï¼š int bsearch_1(int l, int r) { while (l \u0026lt; r) { int mid = l + r \u0026gt;\u0026gt; 1; if (check(mid)) r = mid; // check()åˆ¤æ–­midæ˜¯å¦æ»¡è¶³æ€§è´¨ else l = mid + 1; } return l; } // åŒºé—´[l, r]è¢«åˆ’åˆ†æˆ[l, mid - 1]å’Œ[mid, r]æ—¶ä½¿ç”¨ï¼š int bsearch_2(int l, int r) { while (l \u0026lt; r) { int mid = l + r + 1 \u0026gt;\u0026gt; 1; if (check(mid)) l = mid; else r = mid - 1; } return l; } æµ®ç‚¹æ•°äºŒåˆ†ç®—æ³•æ¨¡æ¿ â€”â€” æ¨¡æ¿é¢˜ AcWing 790. æ•°çš„ä¸‰æ¬¡æ–¹æ ¹ æµ®ç‚¹æ•°äºŒåˆ†ï¼Œæ¯”è¾ƒå¯¹åº”æ•´æ•°äºŒåˆ†\nbool check(double x) {/* ... */} // æ£€æŸ¥xæ˜¯å¦æ»¡è¶³æŸç§æ€§è´¨ double bsearch_3(double l, double r) { const double eps = 1e-6; // eps è¡¨ç¤ºç²¾åº¦ï¼Œå–å†³äºé¢˜ç›®å¯¹ç²¾åº¦çš„è¦æ±‚ while (r - l \u0026gt; eps) { double mid = (l + r) / 2; if (check(mid)) r = mid; else l = mid; } return l; } é«˜ç²¾åº¦åŠ æ³• â€”â€” æ¨¡æ¿é¢˜ AcWing 791. é«˜ç²¾åº¦åŠ æ³• // C = A + B, A \u0026gt;= 0, B \u0026gt;= 0 vector\u0026lt;int\u0026gt; add(vector\u0026lt;int\u0026gt; \u0026amp;A, vector\u0026lt;int\u0026gt; \u0026amp;B) { if (A.size() \u0026lt; B.size()) return add(B, A); vector\u0026lt;int\u0026gt; C; int t = 0; for (int i = 0; i \u0026lt; A.size(); i ++ ) { t += A[i]; if (i \u0026lt; B.size()) t += B[i]; C.push_back(t % 10); t /= 10; } if (t) C.push_back(t); return C; } é«˜ç²¾åº¦å‡æ³• â€”â€” æ¨¡æ¿é¢˜ AcWing 792. é«˜ç²¾åº¦å‡æ³• // C = A - B, æ»¡è¶³A \u0026gt;= B, A \u0026gt;= 0, B \u0026gt;= 0 vector\u0026lt;int\u0026gt; sub(vector\u0026lt;int\u0026gt; \u0026amp;A, vector\u0026lt;int\u0026gt; \u0026amp;B) { vector\u0026lt;int\u0026gt; C; for (int i = 0, t = 0; i \u0026lt; A.size(); i ++ ) { t = A[i] - t; if (i \u0026lt; B.size()) t -= B[i]; C.push_back((t + 10) % 10); if (t \u0026lt; 0) t = 1; else t = 0; } while (C.size() \u0026gt; 1 \u0026amp;\u0026amp; C.back() == 0) C.pop_back(); return C; } é«˜ç²¾åº¦ä¹˜ä½ç²¾åº¦ â€”â€” æ¨¡æ¿é¢˜ AcWing 793. é«˜ç²¾åº¦ä¹˜æ³• // C = A * b, A \u0026gt;= 0, b \u0026gt; 0 vector\u0026lt;int\u0026gt; mul(vector\u0026lt;int\u0026gt; \u0026amp;A, int b) { vector\u0026lt;int\u0026gt; C; int t = 0; for (int i = 0; i \u0026lt; A.size() || t; i ++ ) { if (i \u0026lt; A.size()) t += A[i] * b; C.push_back(t % 10); t /= 10; } return C; } é«˜ç²¾åº¦é™¤ä»¥ä½ç²¾åº¦ â€”â€” æ¨¡æ¿é¢˜ AcWing 794. é«˜ç²¾åº¦é™¤æ³• // A / b = C ... r, A \u0026gt;= 0, b \u0026gt; 0 vector\u0026lt;int\u0026gt; div(vector\u0026lt;int\u0026gt; \u0026amp;A, int b, int \u0026amp;r) { vector\u0026lt;int\u0026gt; C; r = 0; for (int i = A.size() - 1; i \u0026gt;= 0; i -- ) { r = r * 10 + A[i]; C.push_back(r / b); r %= b; } reverse(C.begin(), C.end()); while (C.size() \u0026gt; 1 \u0026amp;\u0026amp; C.back() == 0) C.pop_back(); return C; } ä¸€ç»´å‰ç¼€å’Œ â€”â€” æ¨¡æ¿é¢˜ AcWing 795. å‰ç¼€å’Œ å¿«é€Ÿæ±‚åŒºé—´å’Œ\nS[i] = a[1] + a[2] + ... a[i] a[l] + ... + a[r] = S[r] - S[l - 1] ä»1å¼€å§‹ï¼Œä¾¿äºå¤„ç†è¾¹ç•Œ äºŒç»´å‰ç¼€å’Œ â€”â€” æ¨¡æ¿é¢˜ AcWing 796. å­çŸ©é˜µçš„å’Œ S[i, j] = ç¬¬iè¡Œjåˆ—æ ¼å­å·¦ä¸Šéƒ¨åˆ†æ‰€æœ‰å…ƒç´ çš„å’Œ ä»¥(x1, y1)ä¸ºå·¦ä¸Šè§’ï¼Œ(x2, y2)ä¸ºå³ä¸‹è§’çš„å­çŸ©é˜µçš„å’Œä¸ºï¼š S[x2, y2] - S[x1 - 1, y2] - S[x2, y1 - 1] + S[x1 - 1, y1 - 1] ä¸€ç»´å·®åˆ† â€”â€” æ¨¡æ¿é¢˜ AcWing 797. å·®åˆ† ç»™åŒºé—´[l, r]ä¸­çš„æ¯ä¸ªæ•°åŠ ä¸Šcï¼š B[l] += c, B[r + 1] -= c äºŒç»´å·®åˆ† â€”â€” æ¨¡æ¿é¢˜ AcWing 798. å·®åˆ†çŸ©é˜µ/äºŒç»´å·®åˆ† ç»™ä»¥(x1, y1)ä¸ºå·¦ä¸Šè§’ï¼Œ(x2, y2)ä¸ºå³ä¸‹è§’çš„å­çŸ©é˜µä¸­çš„æ‰€æœ‰å…ƒç´ åŠ ä¸Šcï¼š S[x1, y1] += c, S[x2 + 1, y1] -= c, S[x1, y2 + 1] -= c, S[x2 + 1, y2 + 1] += c åŒæŒ‡é’ˆç®—æ³• â€”â€” æ¨¡æ¿é¢˜ AcWIng 799. æœ€é•¿è¿ç»­ä¸é‡å¤å­åºåˆ—, AcWing 800. æ•°ç»„å…ƒç´ çš„ç›®æ ‡å’Œ __æ»‘åŠ¨çª—å£ï¼Ÿ æ ¸å¿ƒï¼šæŠŠO(n^2)ç®—æ³•ä¼˜åŒ–ä¸ºO(n)\nfor (int i = 0, j = 0; i \u0026lt; n; i ++ ) { while (j \u0026lt; i \u0026amp;\u0026amp; check(j, i)) j ++ ; // å…·ä½“é—®é¢˜çš„é€»è¾‘ } å¸¸è§é—®é¢˜åˆ†ç±»ï¼š (1) å¯¹äºä¸€ä¸ªåºåˆ—ï¼Œç”¨ä¸¤ä¸ªæŒ‡é’ˆç»´æŠ¤ä¸€æ®µåŒºé—´ (2) å¯¹äºä¸¤ä¸ªåºåˆ—ï¼Œç»´æŠ¤æŸç§æ¬¡åºï¼Œæ¯”å¦‚å½’å¹¶æ’åºä¸­åˆå¹¶ä¸¤ä¸ªæœ‰åºåºåˆ—çš„æ“ä½œ ä½è¿ç®— â€”â€” æ¨¡æ¿é¢˜ AcWing 801. äºŒè¿›åˆ¶ä¸­1çš„ä¸ªæ•° åŸç ï¼Œåç ï¼Œè¡¥ç  æ±‚näºŒè¿›åˆ¶è¡¨ç¤ºä¸­ç¬¬kä½æ•°å­—: n \u0026gt;\u0026gt; k \u0026amp; 1 è¿”å›nçš„æœ€åä¸€ä½1ï¼šlowbit(n) = n \u0026amp; -n æ ‘çŠ¶æ•°ç»„åŸºæœ¬æ“ä½œ æ•´æ•°ç¦»æ•£åŒ– â€”â€” æ¨¡æ¿é¢˜ AcWing 802. åŒºé—´å’Œ vector\u0026lt;int\u0026gt; alls; // å­˜å‚¨æ‰€æœ‰å¾…ç¦»æ•£åŒ–çš„å€¼ sort(alls.begin(), alls.end()); // å°†æ‰€æœ‰å€¼æ’åº alls.erase(unique(alls.begin(), alls.end())è¿”å›å»é‡åæ•°ç»„æœ«å°¾ç«¯ç‚¹, alls.end()); // å»æ‰é‡å¤å…ƒç´  // äºŒåˆ†æ±‚å‡ºxå¯¹åº”çš„ç¦»æ•£åŒ–çš„å€¼ int find(int x) // æ‰¾åˆ°ç¬¬ä¸€ä¸ªå¤§äºç­‰äºxçš„ä½ç½® { int l = 0, r = alls.size() - 1; while (l \u0026lt; r) { int mid = l + r \u0026gt;\u0026gt; 1; if (alls[mid] \u0026gt;= x) r = mid; else l = mid + 1; } return r + 1; // æ˜ å°„åˆ°1, 2, ...n } åŒºé—´åˆå¹¶ â€”â€” æ¨¡æ¿é¢˜ AcWing 803. åŒºé—´åˆå¹¶ // å°†æ‰€æœ‰å­˜åœ¨äº¤é›†çš„åŒºé—´åˆå¹¶ è´ªå¿ƒ void merge(vector\u0026lt;PII\u0026gt; \u0026amp;segs) { vector\u0026lt;PII\u0026gt; res; sort(segs.begin(), segs.end()); //åŒºé—´å·¦ç«¯ç‚¹æ’åº int st = -2e9, ed = -2e9; for (auto seg : segs) if (ed \u0026lt; seg.first) { if (st != -2e9) res.push_back({st, ed}); st = seg.first, ed = seg.second; } else ed = max(ed, seg.second); if (st != -2e9) res.push_back({st, ed}); segs = res; } ä½œè€…ï¼šyxc é“¾æ¥ï¼šhttps://www.acwing.com/blog/content/277/ æ¥æºï¼šAcWing è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚\nç¬¬äºŒç«  æ•°æ®ç»“æ„ï¼Œä»¥æ•°ç»„æ¨¡æ‹Ÿçš„å½¢å¼\næŒ‡é’ˆ+ç»“æ„ä½“ ï¼š é¢è¯•é¢˜\nå•é“¾è¡¨ â€”â€” æ¨¡æ¿é¢˜ AcWing 826. å•é“¾è¡¨ é‚»æ¥è¡¨-å­˜å‚¨æ ‘å’Œå›¾ é™æ€é“¾è¡¨\nä¸‹æ ‡ä»0å¼€å§‹\n// headå­˜å‚¨é“¾è¡¨å¤´ï¼Œe[]å­˜å‚¨èŠ‚ç‚¹çš„å€¼ï¼Œne[]å­˜å‚¨èŠ‚ç‚¹çš„nextæŒ‡é’ˆï¼Œidxè¡¨ç¤ºå½“å‰ç”¨åˆ°äº†å“ªä¸ªèŠ‚ç‚¹ int head, e[N], ne[N], idx; // åˆå§‹åŒ– void init() { head = -1; idx = 0; } // åœ¨é“¾è¡¨å¤´æ’å…¥ä¸€ä¸ªæ•°a void insert(int a) { e[idx] = a, ne[idx] = head, head = idx ++ ; } // æ’å…¥ä¸‹æ ‡kåé¢ void add(int k,int x) { e[idx]= x, ne[idx] = ne[k], ne[k] = idx++ ; } // å°†å¤´ç»“ç‚¹åˆ é™¤ï¼Œéœ€è¦ä¿è¯å¤´ç»“ç‚¹å­˜åœ¨ void remove() { head = ne[head]; } // å°†kåé¢çš„ç‚¹åˆ æ‰ void remove(int k) { ne[k] = ne[ne[k]]; } åŒé“¾è¡¨ â€”â€” æ¨¡æ¿é¢˜ AcWing 827. åŒé“¾è¡¨ ä¼˜åŒ–æŸäº›é—®é¢˜\n// e[]è¡¨ç¤ºèŠ‚ç‚¹çš„å€¼ï¼Œl[]è¡¨ç¤ºèŠ‚ç‚¹çš„å·¦æŒ‡é’ˆï¼Œr[]è¡¨ç¤ºèŠ‚ç‚¹çš„å³æŒ‡é’ˆï¼Œidxè¡¨ç¤ºå½“å‰ç”¨åˆ°äº†å“ªä¸ªèŠ‚ç‚¹ int e[N], l[N], r[N], idx; // åˆå§‹åŒ– void init() { //0æ˜¯å·¦ç«¯ç‚¹ï¼Œ1æ˜¯å³ç«¯ç‚¹ r[0] = 1, l[1] = 0; idx = 2; } // åœ¨èŠ‚ç‚¹açš„å³è¾¹æ’å…¥ä¸€ä¸ªæ•°x void insert(int a, int x) { e[idx] = x; l[idx] = a, r[idx] = r[a]; l[r[a]] = idx, r[a] = idx ++ ; } // åˆ é™¤èŠ‚ç‚¹a void remove(int a) { l[r[a]] = l[a]; r[l[a]] = r[a]; } æ ˆ â€”â€” æ¨¡æ¿é¢˜ AcWing 828. æ¨¡æ‹Ÿæ ˆ // ttè¡¨ç¤ºæ ˆé¡¶ int stk[N], tt = 0; // å‘æ ˆé¡¶æ’å…¥ä¸€ä¸ªæ•° stk[ ++ tt] = x; // ä»æ ˆé¡¶å¼¹å‡ºä¸€ä¸ªæ•° tt -- ; // æ ˆé¡¶çš„å€¼ stk[tt]; // åˆ¤æ–­æ ˆæ˜¯å¦ä¸ºç©º if (tt \u0026gt; 0) { } é˜Ÿåˆ— â€”â€” æ¨¡æ¿é¢˜ AcWing 829. æ¨¡æ‹Ÿé˜Ÿåˆ— æ™®é€šé˜Ÿåˆ—\n// hh è¡¨ç¤ºé˜Ÿå¤´ï¼Œttè¡¨ç¤ºé˜Ÿå°¾ int q[N], hh = 0, tt = -1; // å‘é˜Ÿå°¾æ’å…¥ä¸€ä¸ªæ•° q[ ++ tt] = x; // ä»é˜Ÿå¤´å¼¹å‡ºä¸€ä¸ªæ•° hh ++ ; // é˜Ÿå¤´çš„å€¼ q[hh]; // åˆ¤æ–­é˜Ÿåˆ—æ˜¯å¦ä¸ºç©º if (hh \u0026lt;= tt) { //ä¸ç©º } å¾ªç¯é˜Ÿåˆ—\n// hh è¡¨ç¤ºé˜Ÿå¤´ï¼Œttè¡¨ç¤ºé˜Ÿå°¾çš„åä¸€ä¸ªä½ç½® int q[N], hh = 0, tt = 0; // å‘é˜Ÿå°¾æ’å…¥ä¸€ä¸ªæ•° q[tt ++ ] = x; if (tt == N) tt = 0; // ä»é˜Ÿå¤´å¼¹å‡ºä¸€ä¸ªæ•° hh ++ ; if (hh == N) hh = 0; // é˜Ÿå¤´çš„å€¼ q[hh]; // åˆ¤æ–­é˜Ÿåˆ—æ˜¯å¦ä¸ºç©º if (hh != tt) { } å•è°ƒæ ˆ â€”â€” æ¨¡æ¿é¢˜ AcWing 830. å•è°ƒæ ˆ å¸¸è§æ¨¡å‹ï¼šæ‰¾å‡ºæ¯ä¸ªæ•°å·¦è¾¹ç¦»å®ƒæœ€è¿‘çš„æ¯”å®ƒå¤§/å°çš„æ•° int tt = 0; for (int i = 1; i \u0026lt;= n; i ++ ) { while (tt \u0026amp;\u0026amp; check(stk[tt], i)) tt -- ; stk[ ++ tt] = i; } å•è°ƒé˜Ÿåˆ— â€”â€” æ¨¡æ¿é¢˜ AcWing 154. æ»‘åŠ¨çª—å£ å¸¸è§æ¨¡å‹ï¼šæ‰¾å‡ºæ»‘åŠ¨çª—å£ä¸­çš„æœ€å¤§å€¼/æœ€å°å€¼ int hh = 0, tt = -1; for (int i = 0; i \u0026lt; n; i ++ ) { while (hh \u0026lt;= tt \u0026amp;\u0026amp; check_out(q[hh])) hh ++ ; // åˆ¤æ–­é˜Ÿå¤´æ˜¯å¦æ»‘å‡ºçª—å£ while (hh \u0026lt;= tt \u0026amp;\u0026amp; check(q[tt], i)) tt -- ; q[ ++ tt] = i; } KMP â€”â€” æ¨¡æ¿é¢˜ AcWing 831. KMPå­—ç¬¦ä¸² ç”¨æ¨¡æ¿ä¸²æ¥åŒ¹é…æ¨¡å¼ä¸²ï¼Œæ‰¾åˆ°æ¨¡å¼ä¸²\nsçš„çœŸå‰ç¼€ä»¥åŠçœŸåç¼€æ˜¯æŒ‡ä¸ç­‰äºsçš„å‰ç¼€ä»¥åŠåç¼€ï¼Œå³è‡³å°‘æ˜¯s[1n-2]æˆ–s[0n-1]\nne[i] : ä»¥iç»“å°¾çš„ä¸²ä¸­ æœ€é•¿çœŸå‰ç¼€ä¸çœŸåç¼€ç›¸ç­‰çš„ä¸² çš„é•¿åº¦ï¼Œå¦‚æœæ²¡æœ‰åˆ™ä¸º0ã€‚\n//å‰ç¼€h vector\u0026lt;int\u0026gt; prefix_function(string s) { int n = (int)s.length(); vector\u0026lt;int\u0026gt; pi(n); for (int i = 1; i \u0026lt; n; i++) { int j = pi[i - 1]; while (j \u0026gt; 0 \u0026amp;\u0026amp; s[i] != s[j]) j = pi[j - 1]; if (s[i] == s[j]) j++; pi[i] = j; } return pi; } å®é™…ä½¿ç”¨èŒƒä¾‹ï¼ˆä¸‹é¢è¿™ä¸ªä¾‹å­å­—ç¬¦ä¸²ä»1å¼€å§‹ï¼‰\n// æ±‚Nextæ•°ç»„ï¼š // ne[i] å­˜å‚¨çœŸå‰ç¼€å’ŒçœŸåç¼€ç›¸ç­‰çš„é•¿åº¦ï¼Œæ‰€ä»¥è‡³å°‘ä»2å¼€å§‹ï¼š //abcab,ä»bå¼€å§‹æ‰æœ‰çœŸå‰ç¼€ // s[]æ˜¯æ¨¡å¼ä¸²ï¼Œp[]æ˜¯æ¨¡æ¿ä¸², næ˜¯sçš„é•¿åº¦ï¼Œmæ˜¯pçš„é•¿åº¦ for (int i = 2, j = 0; i \u0026lt;= m; i ++ ) { while (j \u0026amp;\u0026amp; p[i] != p[j + 1]) j = ne[j]; if (p[i] == p[j + 1]) j ++ ; ne[i] = j; } // åŒ¹é… for (int i = 1, j = 0; i \u0026lt;= n; i ++ ) { while (j \u0026amp;\u0026amp; s[i] != p[j + 1]) j = ne[j]; if (s[i] == p[j + 1]) j ++ ; if (j == m) { j = ne[j]; // åŒ¹é…æˆåŠŸåçš„é€»è¾‘ } } Trieæ ‘ â€”â€” æ¨¡æ¿é¢˜ AcWing 835. Trieå­—ç¬¦ä¸²ç»Ÿè®¡ int son[N][26], cnt[N], idx; // 0å·ç‚¹æ—¢æ˜¯æ ¹èŠ‚ç‚¹ï¼Œåˆæ˜¯ç©ºèŠ‚ç‚¹ // son[][]å­˜å‚¨æ ‘ä¸­æ¯ä¸ªèŠ‚ç‚¹çš„å­èŠ‚ç‚¹ // cnt[]å­˜å‚¨ä»¥æ¯ä¸ªèŠ‚ç‚¹ç»“å°¾çš„å•è¯æ•°é‡ // æ’å…¥ä¸€ä¸ªå­—ç¬¦ä¸² void insert(char *str) { int p = 0; for (int i = 0; str[i]; i ++ ) { int u = str[i] - \u0026#39;a\u0026#39;; if (!son[p][u]) son[p][u] = ++ idx; p = son[p][u]; } cnt[p] ++ ; } // æŸ¥è¯¢å­—ç¬¦ä¸²å‡ºç°çš„æ¬¡æ•° int query(char *str) { int p = 0; for (int i = 0; str[i]; i ++ ) { int u = str[i] - \u0026#39;a\u0026#39;; if (!son[p][u]) return 0; p = son[p][u]; } return cnt[p]; } å¹¶æŸ¥é›† â€”â€” æ¨¡æ¿é¢˜ AcWing 836. åˆå¹¶é›†åˆ, AcWing 837. è¿é€šå—ä¸­ç‚¹çš„æ•°é‡ æŒ‰ç§©åˆå¹¶\nå­—ç¬¦æŒ‰å­—ç¬¦ä¸²è¯»å…¥\n(1)æœ´ç´ å¹¶æŸ¥é›†ï¼š\nint p[N]; //å­˜å‚¨æ¯ä¸ªç‚¹çš„ç¥–å®—èŠ‚ç‚¹ // è¿”å›xçš„ç¥–å®—èŠ‚ç‚¹ int find(int x) { if (p[x] != x) p[x] = find(p[x]); return p[x]; } // åˆå§‹åŒ–ï¼Œå‡å®šèŠ‚ç‚¹ç¼–å·æ˜¯1~n for (int i = 1; i \u0026lt;= n; i ++ ) p[i] = i; // åˆå¹¶aå’Œbæ‰€åœ¨çš„ä¸¤ä¸ªé›†åˆï¼š p[find(a)] = find(b); (2)ç»´æŠ¤sizeçš„å¹¶æŸ¥é›†ï¼š\nint p[N], size[N]; //p[]å­˜å‚¨æ¯ä¸ªç‚¹çš„ç¥–å®—èŠ‚ç‚¹, size[]åªæœ‰ç¥–å®—èŠ‚ç‚¹çš„æœ‰æ„ä¹‰ï¼Œè¡¨ç¤ºç¥–å®—èŠ‚ç‚¹æ‰€åœ¨é›†åˆä¸­çš„ç‚¹çš„æ•°é‡ // è¿”å›xçš„ç¥–å®—èŠ‚ç‚¹ int find(int x) { if (p[x] != x) p[x] = find(p[x]); return p[x]; } // åˆå§‹åŒ–ï¼Œå‡å®šèŠ‚ç‚¹ç¼–å·æ˜¯1~n for (int i = 1; i \u0026lt;= n; i ++ ) { p[i] = i; size[i] = 1; } // åˆå¹¶aå’Œbæ‰€åœ¨çš„ä¸¤ä¸ªé›†åˆï¼š p[find(a)] = find(b); size[b] += size[a]; (3)ç»´æŠ¤åˆ°ç¥–å®—èŠ‚ç‚¹è·ç¦»çš„å¹¶æŸ¥é›†ï¼š\nint p[N], d[N]; //p[]å­˜å‚¨æ¯ä¸ªç‚¹çš„ç¥–å®—èŠ‚ç‚¹, d[x]å­˜å‚¨xåˆ°p[x]çš„è·ç¦» // è¿”å›xçš„ç¥–å®—èŠ‚ç‚¹ int find(int x) { if (p[x] != x) { int u = find(p[x]); d[x] += d[p[x]]; p[x] = u; } return p[x]; } // åˆå§‹åŒ–ï¼Œå‡å®šèŠ‚ç‚¹ç¼–å·æ˜¯1~n for (int i = 1; i \u0026lt;= n; i ++ ) { p[i] = i; d[i] = 0; } // åˆå¹¶aå’Œbæ‰€åœ¨çš„ä¸¤ä¸ªé›†åˆï¼š p[find(a)] = find(b); d[find(a)] = distance; // æ ¹æ®å…·ä½“é—®é¢˜ï¼Œåˆå§‹åŒ–find(a)çš„åç§»é‡ å † â€”â€” æ¨¡æ¿é¢˜ AcWing 838. å †æ’åº, AcWing 839. æ¨¡æ‹Ÿå † ç»´æŠ¤é›†åˆçš„æ•°æ®ç»“æ„ ï¼ˆå¤§æ ¹å †ï¼Œçˆ¶èŠ‚ç‚¹å€¼ä¸å°äºå­èŠ‚ç‚¹å€¼ï¼‰\n// h[N]å­˜å‚¨å †ä¸­çš„å€¼, h[1]æ˜¯å †é¡¶ï¼Œxçš„å·¦å„¿å­æ˜¯2x, å³å„¿å­æ˜¯2x + 1 // pos[k]å­˜å‚¨ç¬¬kä¸ªæ’å…¥çš„ç‚¹åœ¨å †ä¸­çš„ä½ç½® // ord[k]å­˜å‚¨å †ä¸­ä¸‹æ ‡æ˜¯kçš„ç‚¹æ˜¯ç¬¬å‡ ä¸ªæ’å…¥çš„ int h[N], ph[N], hp[N], size; // äº¤æ¢ä¸¤ä¸ªç‚¹ï¼ŒåŠå…¶æ˜ å°„å…³ç³» void heap_swap(int a, int b) { //swap(ph[hp[a]],ph[hp[b]]); æ ¹æ®é¢˜æ„ //swap(hp[a], hp[b]); swap(h[a], h[b]); } void down(int u) { int t = u; if (u * 2 \u0026lt;= size \u0026amp;\u0026amp; h[u * 2] \u0026lt; h[t]) t = u * 2; if (u * 2 + 1 \u0026lt;= size \u0026amp;\u0026amp; h[u * 2 + 1] \u0026lt; h[t]) t = u * 2 + 1; if (u != t) { heap_swap(u, t); down(t); } } void up(int u) { while (u / 2 \u0026amp;\u0026amp; h[u] \u0026lt; h[u / 2]) { heap_swap(u, u / 2); u \u0026gt;\u0026gt;= 1; } } // O(n)å»ºå † for (int i = n / 2; i; i -- ) down(i); heap[++size] = x; up(size); //æ·»åŠ å…ƒç´  heap[1]; //å †é¡¶å…ƒç´  heap[1]=heap[size]; size--; down(1);//åˆ é™¤ç¬¬sizeä¸ªç»“ç‚¹ heap[k]=heap[size]; size---; down(k);up(k);//åˆ é™¤ç¬¬kä¸ªç»“ç‚¹ heap[k]=x; down(k); up(k); //å°†ç¬¬kä¸ªå…ƒç´ èµ‹å€¼ä¸ºx ä¸€èˆ¬å“ˆå¸Œ â€”â€” æ¨¡æ¿é¢˜ AcWing 840. æ¨¡æ‹Ÿæ•£åˆ—è¡¨ (1) æ‹‰é“¾æ³• int h[N], e[N], ne[N], idx; // å‘å“ˆå¸Œè¡¨ä¸­æ’å…¥ä¸€ä¸ªæ•° void insert(int x) { int k = (x % N + N) % N; e[idx] = x; ne[idx] = h[k]; h[k] = idx ++ ; } // åœ¨å“ˆå¸Œè¡¨ä¸­æŸ¥è¯¢æŸä¸ªæ•°æ˜¯å¦å­˜åœ¨ bool find(int x) { int k = (x % N + N) % N; for (int i = h[k]; i != -1; i = ne[i]) if (e[i] == x) return true; return false; } (2) å¼€æ”¾å¯»å€æ³• int h[N]; // å¦‚æœxåœ¨å“ˆå¸Œè¡¨ä¸­ï¼Œè¿”å›xçš„ä¸‹æ ‡ï¼›å¦‚æœxä¸åœ¨å“ˆå¸Œè¡¨ä¸­ï¼Œè¿”å›xåº”è¯¥æ’å…¥çš„ä½ç½® int find(int x) { int t = (x % N + N) % N; while (h[t] != null \u0026amp;\u0026amp; h[t] != x) { t ++ ; if (t == N) t = 0; } return t; } å­—ç¬¦ä¸²å“ˆå¸Œ â€”â€” æ¨¡æ¿é¢˜ AcWing 841. å­—ç¬¦ä¸²å“ˆå¸Œ æ ¸å¿ƒæ€æƒ³ï¼šå°†å­—ç¬¦ä¸²çœ‹æˆPè¿›åˆ¶æ•°ï¼ŒPçš„ç»éªŒå€¼æ˜¯131æˆ–13331ï¼Œå–è¿™ä¸¤ä¸ªå€¼çš„å†²çªæ¦‚ç‡ä½ å°æŠ€å·§ï¼šå–æ¨¡çš„æ•°ç”¨2^64ï¼Œè¿™æ ·ç›´æ¥ç”¨unsigned long longå­˜å‚¨ï¼Œæº¢å‡ºçš„ç»“æœå°±æ˜¯å–æ¨¡çš„ç»“æœã€‚\ntypedef unsigned long long ULL; const int P = 131 or 13331 ; ULL h[N], p[N]; // h[k]å­˜å‚¨å­—ç¬¦ä¸²å‰kä¸ªå­—æ¯çš„å“ˆå¸Œå€¼, p[k]å­˜å‚¨ P^k mod 2^64 // åˆå§‹åŒ– p[0] = 1; for (int i = 1; i \u0026lt;= n; i ++ ) { h[i] = h[i - 1] * P + str[i]; p[i] = p[i - 1] * P; } // è®¡ç®—å­ä¸² str[l ~ r] çš„å“ˆå¸Œå€¼ ULL get(int l, int r) { return h[r] - h[l - 1] * p[r - l + 1]; } C++ STLç®€ä»‹ æ‰€æœ‰å®¹å™¨éƒ½æœ‰size() empty() vector, å˜é•¿æ•°ç»„ï¼Œå€å¢çš„æ€æƒ³ size() è¿”å›å…ƒç´ ä¸ªæ•° empty() è¿”å›æ˜¯å¦ä¸ºç©º clear() æ¸…ç©º front()/back() push_back()/pop_back() begin()/end() [] æ”¯æŒæ¯”è¾ƒè¿ç®—ï¼ŒæŒ‰å­—å…¸åº vector\u0026lt;int\u0026gt; a(10,2); a.empty(); pair\u0026lt;int, int\u0026gt; first, ç¬¬ä¸€ä¸ªå…ƒç´  second, ç¬¬äºŒä¸ªå…ƒç´  æ”¯æŒæ¯”è¾ƒè¿ç®—ï¼Œä»¥firstä¸ºç¬¬ä¸€å…³é”®å­—ï¼Œä»¥secondä¸ºç¬¬äºŒå…³é”®å­—ï¼ˆå­—å…¸åºï¼‰ pair\u0026lt;int,int\u0026gt; p; p=make_pair(1,1); p={1,1}; stringï¼Œå­—ç¬¦ä¸² size()/length() è¿”å›å­—ç¬¦ä¸²é•¿åº¦ empty() clear() substr(èµ·å§‹ä¸‹æ ‡ï¼Œ(å­ä¸²é•¿åº¦)) è¿”å›å­ä¸² c_str() è¿”å›å­—ç¬¦ä¸²æ‰€åœ¨å­—ç¬¦æ•°ç»„çš„èµ·å§‹åœ°å€ strcpy(c,s.c_str());//c_str()çš„ä½¿ç”¨æ–¹æ³• queue, é˜Ÿåˆ— æ²¡æœ‰clearå‡½æ•° æ¸…ç©ºç”¨æ–°å»ºqueue size() empty() push() å‘é˜Ÿå°¾æ’å…¥ä¸€ä¸ªå…ƒç´  front() è¿”å›é˜Ÿå¤´å…ƒç´  back() è¿”å›é˜Ÿå°¾å…ƒç´  pop() å¼¹å‡ºé˜Ÿå¤´å…ƒç´  priority_queue, ä¼˜å…ˆé˜Ÿåˆ—ï¼Œé»˜è®¤æ˜¯å¤§æ ¹å † push() æ’å…¥ä¸€ä¸ªå…ƒç´  top() è¿”å›å †é¡¶å…ƒç´  pop() å¼¹å‡ºå †é¡¶å…ƒç´  å®šä¹‰æˆå°æ ¹å †çš„æ–¹å¼ï¼špriority_queue\u0026lt;int, vector\u0026lt;int\u0026gt;, greater\u0026lt;int\u0026gt;\u0026gt; q; stack, æ ˆ size() empty() push() å‘æ ˆé¡¶æ’å…¥ä¸€ä¸ªå…ƒç´  top() è¿”å›æ ˆé¡¶å…ƒç´  pop() å¼¹å‡ºæ ˆé¡¶å…ƒç´  deque, åŒç«¯é˜Ÿåˆ— size() empty() clear() front()/back() push_back()/pop_back() push_front()/pop_front() begin()/end() [] set, map, multiset, multimap, åŸºäºå¹³è¡¡äºŒå‰æ ‘ï¼ˆçº¢é»‘æ ‘ï¼‰ï¼ŒåŠ¨æ€ç»´æŠ¤æœ‰åºåºåˆ— size() empty() clear() begin()/end() ++, -- è¿”å›å‰é©±å’Œåç»§ï¼Œæ—¶é—´å¤æ‚åº¦ O(logn) set/multiset insert() æ’å…¥ä¸€ä¸ªæ•° find() æŸ¥æ‰¾ä¸€ä¸ªæ•° count() è¿”å›æŸä¸€ä¸ªæ•°çš„ä¸ªæ•° erase() (1) è¾“å…¥æ˜¯ä¸€ä¸ªæ•°xï¼Œåˆ é™¤æ‰€æœ‰x O(k + logn) (2) è¾“å…¥ä¸€ä¸ªè¿­ä»£å™¨ï¼Œåˆ é™¤è¿™ä¸ªè¿­ä»£å™¨ lower_bound()/upper_bound() lower_bound(x) è¿”å›å¤§äºç­‰äºxçš„æœ€å°çš„æ•°çš„è¿­ä»£å™¨ upper_bound(x) è¿”å›å¤§äºxçš„æœ€å°çš„æ•°çš„è¿­ä»£å™¨ map/multimap insert() æ’å…¥çš„æ•°æ˜¯ä¸€ä¸ªpair erase() è¾“å…¥çš„å‚æ•°æ˜¯pairæˆ–è€…è¿­ä»£å™¨ find() [] æ³¨æ„multimapä¸æ”¯æŒæ­¤æ“ä½œã€‚ æ—¶é—´å¤æ‚åº¦æ˜¯ O(logn) lower_bound()/upper_bound() unordered_set, unordered_map, unordered_multiset, unordered_multimap, å“ˆå¸Œè¡¨ å’Œä¸Šé¢ç±»ä¼¼ï¼Œå¢åˆ æ”¹æŸ¥çš„æ—¶é—´å¤æ‚åº¦æ˜¯ O(1) ä¸æ”¯æŒ lower_bound()/upper_bound()ï¼Œ è¿­ä»£å™¨çš„++ï¼Œ-- bitset, åœ§ä½ bitset\u0026lt;10000\u0026gt; s; ~, \u0026amp;, |, ^ \u0026gt;\u0026gt;, \u0026lt;\u0026lt; ==, != [] count() è¿”å›æœ‰å¤šå°‘ä¸ª1 none() åˆ¤æ–­æ˜¯å¦å…¨ä¸º0 any() åˆ¤æ–­æ˜¯å¦è‡³å°‘æœ‰ä¸€ä¸ª1 set() æŠŠæ‰€æœ‰ä½ç½®æˆ1 set(k, v) å°†ç¬¬kä½å˜æˆv reset() æŠŠæ‰€æœ‰ä½å˜æˆ0 flip() ç­‰ä»·äº~ flip(k) æŠŠç¬¬kä½å–å ä½œè€…ï¼šyxc é“¾æ¥ï¼šhttps://www.acwing.com/blog/content/404/ æ¥æºï¼šAcWing è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚\nç¬¬ä¸‰ç«  æ ‘ä¸å›¾çš„å­˜å‚¨ æ ‘æ˜¯ä¸€ç§ç‰¹æ®Šçš„å›¾: æ— ç¯è¿é€šå›¾ï¼Œä¸å›¾çš„å­˜å‚¨æ–¹å¼ç›¸åŒã€‚ å¯¹äºæ— å‘å›¾ä¸­çš„è¾¹abï¼Œå­˜å‚¨ä¸¤æ¡æœ‰å‘è¾¹a-\u0026gt;b, b-\u0026gt;aã€‚ å› æ­¤æˆ‘ä»¬å¯ä»¥åªè€ƒè™‘æœ‰å‘å›¾çš„å­˜å‚¨ã€‚\n(1) é‚»æ¥çŸ©é˜µï¼šg[a][b] å­˜å‚¨è¾¹a-\u0026gt;b (2) é‚»æ¥è¡¨ï¼š // å¯¹äºæ¯ä¸ªç‚¹kï¼Œå¼€ä¸€ä¸ªå•é“¾è¡¨ï¼Œå­˜å‚¨kæ‰€æœ‰å¯ä»¥èµ°åˆ°çš„ç‚¹ã€‚h[k]å­˜å‚¨è¿™ä¸ªå•é“¾è¡¨çš„å¤´ç»“ç‚¹ int h[N], e[N], ne[N], idx; // æ·»åŠ ä¸€æ¡è¾¹a-\u0026gt;b void add(int a, int b) { e[idx] = b, ne[idx] = h[a], h[a] = idx ++ ; } // åˆå§‹åŒ– idx = 0; memset(h, -1, sizeof h); æ ‘ä¸å›¾çš„éå† æ—¶é—´å¤æ‚åº¦ O(n+m)O(n+m), nn è¡¨ç¤ºç‚¹æ•°ï¼Œmm è¡¨ç¤ºè¾¹æ•°\n(1) æ·±åº¦ä¼˜å…ˆéå† â€”â€” æ¨¡æ¿é¢˜ AcWing 846. æ ‘çš„é‡å¿ƒ int dfs(int u) { st[u] = true; // st[u] è¡¨ç¤ºç‚¹uå·²ç»è¢«éå†è¿‡ for (int i = h[u]; i != -1; i = ne[i]) { int j = e[i]; if (!st[j]) dfs(j); } } (2) å®½åº¦ä¼˜å…ˆéå† â€”â€” æ¨¡æ¿é¢˜ AcWing 847. å›¾ä¸­ç‚¹çš„å±‚æ¬¡ queue\u0026lt;int\u0026gt; q; st[1] = true; // è¡¨ç¤º1å·ç‚¹å·²ç»è¢«éå†è¿‡ q.push(1); while (q.size()) { int t = q.front(); q.pop(); for (int i = h[t]; i != -1; i = ne[i]) { int j = e[i]; if (!st[j]) { st[j] = true; // è¡¨ç¤ºç‚¹jå·²ç»è¢«éå†è¿‡ q.push(j); } } } æ‹“æ‰‘æ’åº â€”â€” æ¨¡æ¿é¢˜ AcWing 848. æœ‰å‘å›¾çš„æ‹“æ‰‘åºåˆ— æ—¶é—´å¤æ‚åº¦ O(n+m)O(n+m), nn è¡¨ç¤ºç‚¹æ•°ï¼Œmm è¡¨ç¤ºè¾¹æ•°\nbool topsort() { int hh = 0, tt = -1; // d[i] å­˜å‚¨ç‚¹içš„å…¥åº¦ for (int i = 1; i \u0026lt;= n; i ++ ) if (!d[i]) q[ ++ tt] = i; while (hh \u0026lt;= tt) { int t = q[hh ++ ]; for (int i = h[t]; i != -1; i = ne[i]) { int j = e[i]; if (-- d[j] == 0) q[ ++ tt] = j; } } // å¦‚æœæ‰€æœ‰ç‚¹éƒ½å…¥é˜Ÿäº†ï¼Œè¯´æ˜å­˜åœ¨æ‹“æ‰‘åºåˆ—ï¼›å¦åˆ™ä¸å­˜åœ¨æ‹“æ‰‘åºåˆ—ã€‚ return tt == n - 1; } æœ€çŸ­è·¯ å•æºæœ€çŸ­è·¯\næ‰€æœ‰è¾¹æƒå‡ä¸ºæ­£ï¼šæœ´ç´ Dijkstra O(n^2)ï¼›å †ä¼˜åŒ–ç‰ˆçš„Dijkstra(mlogn)\nå­˜åœ¨è´Ÿæƒå˜ï¼šBellman-Ford O(nm) ï¼› SPFAï¼ˆé˜Ÿåˆ—ä¼˜åŒ–Bellman-Ford) ä¸€èˆ¬ï¼šO(m) æœ€å O(nm)\nå¤šå…ƒæ±‡æœ€çŸ­è·¯ï¼šFloyedç®—æ³• O(n^3)\næœ´ç´ dijkstraç®—æ³• â€”â€” æ¨¡æ¿é¢˜ AcWing 849. Dijkstraæ±‚æœ€çŸ­è·¯ I åŸºäºè´ªå¿ƒ æ—¶é—´å¤æ‚æ˜¯ O(n^2+m), n è¡¨ç¤ºç‚¹æ•°ï¼Œm è¡¨ç¤ºè¾¹æ•°\nint g[N][N]; // å­˜å‚¨æ¯æ¡è¾¹ï¼Œ int dist[N]; // å­˜å‚¨1å·ç‚¹åˆ°æ¯ä¸ªç‚¹çš„æœ€çŸ­è·ç¦» bool st[N]; // å­˜å‚¨æ¯ä¸ªç‚¹çš„æœ€çŸ­è·¯æ˜¯å¦å·²ç»ç¡®å®š // æ±‚1å·ç‚¹åˆ°nå·ç‚¹çš„æœ€çŸ­è·¯ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™è¿”å›-1 int dijkstra() { memset(dist, 0x3f, sizeof dist); dist[1] = 0; for (int i = 0; i \u0026lt; n - 1; i ++ ) { int t = -1; // åœ¨è¿˜æœªç¡®å®šæœ€çŸ­è·¯çš„ç‚¹ä¸­ï¼Œå¯»æ‰¾è·ç¦»æœ€å°çš„ç‚¹ for (int j = 1; j \u0026lt;= n; j ++ ) if (!st[j] \u0026amp;\u0026amp; (t == -1 || dist[t] \u0026gt; dist[j])) t = j; // ç”¨tæ›´æ–°å…¶ä»–ç‚¹çš„è·ç¦» for (int j = 1; j \u0026lt;= n; j ++ ) dist[j] = min(dist[j], dist[t] + g[t][j]); st[t] = true; } if (dist[n] == 0x3f3f3f3f) return -1; return dist[n]; } å †ä¼˜åŒ–ç‰ˆdijkstra â€”â€” æ¨¡æ¿é¢˜ AcWing 850. Dijkstraæ±‚æœ€çŸ­è·¯ II æ—¶é—´å¤æ‚åº¦ O(mlogn), n è¡¨ç¤ºç‚¹æ•°ï¼Œm è¡¨ç¤ºè¾¹æ•°\ntypedef pair\u0026lt;int, int\u0026gt; PII; int n; // ç‚¹çš„æ•°é‡ int h[N], w[N], e[N], ne[N], idx; // é‚»æ¥è¡¨å­˜å‚¨æ‰€æœ‰è¾¹ int dist[N]; // å­˜å‚¨æ‰€æœ‰ç‚¹åˆ°1å·ç‚¹çš„è·ç¦» bool st[N]; // å­˜å‚¨æ¯ä¸ªç‚¹çš„æœ€çŸ­è·ç¦»æ˜¯å¦å·²ç¡®å®š // æ±‚1å·ç‚¹åˆ°nå·ç‚¹çš„æœ€çŸ­è·ç¦»ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œåˆ™è¿”å›-1 int dijkstra() { memset(dist, 0x3f, sizeof dist); dist[1] = 0; priority_queue\u0026lt;PII, vector\u0026lt;PII\u0026gt;, greater\u0026lt;PII\u0026gt;\u0026gt; heap; heap.push({0, 1}); // firstå­˜å‚¨è·ç¦»ï¼Œsecondå­˜å‚¨èŠ‚ç‚¹ç¼–å· while (heap.size()) { auto t = heap.top(); heap.pop(); int ver = t.second, distance = t.first; if (st[ver]) continue; st[ver] = true; for (int i = h[ver]; i != -1; i = ne[i]) { int j = e[i]; if (dist[j] \u0026gt; distance + w[i]) { dist[j] = distance + w[i]; heap.push({dist[j], j}); } } } if (dist[n] == 0x3f3f3f3f) return -1; return dist[n]; } Bellman-Fordç®—æ³• â€”â€” æ¨¡æ¿é¢˜ AcWing 853. æœ‰è¾¹æ•°é™åˆ¶çš„æœ€çŸ­è·¯ æ—¶é—´å¤æ‚åº¦ O(nm), n è¡¨ç¤ºç‚¹æ•°ï¼Œmè¡¨ç¤ºè¾¹æ•° æ³¨æ„åœ¨æ¨¡æ¿é¢˜ä¸­éœ€è¦å¯¹ä¸‹é¢çš„æ¨¡æ¿ç¨ä½œä¿®æ”¹ï¼ŒåŠ ä¸Šå¤‡ä»½æ•°ç»„ï¼Œè¯¦æƒ…è§æ¨¡æ¿é¢˜ã€‚\nint n, m; // nè¡¨ç¤ºç‚¹æ•°ï¼Œmè¡¨ç¤ºè¾¹æ•° int dist[N]; // dist[x]å­˜å‚¨1åˆ°xçš„æœ€çŸ­è·¯è·ç¦» struct Edge // è¾¹ï¼Œaè¡¨ç¤ºå‡ºç‚¹ï¼Œbè¡¨ç¤ºå…¥ç‚¹ï¼Œwè¡¨ç¤ºè¾¹çš„æƒé‡ { int a, b, w; }edges[M]; // æ±‚1åˆ°nçš„æœ€çŸ­è·¯è·ç¦»ï¼Œå¦‚æœæ— æ³•ä»1èµ°åˆ°nï¼Œåˆ™è¿”å›-1ã€‚ int bellman_ford() { memset(dist, 0x3f, sizeof dist); dist[1] = 0; // å¦‚æœç¬¬næ¬¡è¿­ä»£ä»ç„¶ä¼šæ¾å¼›ä¸‰è§’ä¸ç­‰å¼ï¼Œå°±è¯´æ˜å­˜åœ¨ä¸€æ¡é•¿åº¦æ˜¯n+1çš„æœ€çŸ­è·¯å¾„ï¼Œç”±æŠ½å±‰åŸç†ï¼Œè·¯å¾„ä¸­è‡³å°‘å­˜åœ¨ä¸¤ä¸ªç›¸åŒçš„ç‚¹ï¼Œè¯´æ˜å›¾ä¸­å­˜åœ¨è´Ÿæƒå›è·¯ã€‚ for (int i = 0; i \u0026lt; n; i ++ ) { for (int j = 0; j \u0026lt; m; j ++ ) { int a = edges[j].a, b = edges[j].b, w = edges[j].w; if (dist[b] \u0026gt; dist[a] + w) dist[b] = dist[a] + w; } } if (dist[n] \u0026gt; 0x3f3f3f3f / 2) return -1; return dist[n]; } spfa ç®—æ³•ï¼ˆé˜Ÿåˆ—ä¼˜åŒ–çš„Bellman-Fordç®—æ³•ï¼‰ â€”â€” æ¨¡æ¿é¢˜ AcWing 851. spfaæ±‚æœ€çŸ­è·¯ æ—¶é—´å¤æ‚åº¦ å¹³å‡æƒ…å†µä¸‹ O(m)ï¼Œæœ€åæƒ…å†µä¸‹ O(nm), n è¡¨ç¤ºç‚¹æ•°ï¼Œm è¡¨ç¤ºè¾¹æ•°\nint n; // æ€»ç‚¹æ•° int h[N], w[N], e[N], ne[N], idx; // é‚»æ¥è¡¨å­˜å‚¨æ‰€æœ‰è¾¹ int dist[N]; // å­˜å‚¨æ¯ä¸ªç‚¹åˆ°1å·ç‚¹çš„æœ€çŸ­è·ç¦» bool st[N]; // å­˜å‚¨æ¯ä¸ªç‚¹æ˜¯å¦åœ¨é˜Ÿåˆ—ä¸­ // æ±‚1å·ç‚¹åˆ°nå·ç‚¹çš„æœ€çŸ­è·¯è·ç¦»ï¼Œå¦‚æœä»1å·ç‚¹æ— æ³•èµ°åˆ°nå·ç‚¹åˆ™è¿”å›-1 int spfa() { memset(dist, 0x3f, sizeof dist); dist[1] = 0; queue\u0026lt;int\u0026gt; q; q.push(1); st[1] = true; while (q.size()) { auto t = q.front(); q.pop(); st[t] = false; for (int i = h[t]; i != -1; i = ne[i]) { int j = e[i]; if (dist[j] \u0026gt; dist[t] + w[i]) { dist[j] = dist[t] + w[i]; if (!st[j]) // å¦‚æœé˜Ÿåˆ—ä¸­å·²å­˜åœ¨jï¼Œåˆ™ä¸éœ€è¦å°†jé‡å¤æ’å…¥ { q.push(j); st[j] = true; } } } } if (dist[n] == 0x3f3f3f3f) return -1; return dist[n]; } spfaåˆ¤æ–­å›¾ä¸­æ˜¯å¦å­˜åœ¨è´Ÿç¯ â€”â€” æ¨¡æ¿é¢˜ AcWing 852. spfaåˆ¤æ–­è´Ÿç¯ æ—¶é—´å¤æ‚åº¦æ˜¯ O(nm), n è¡¨ç¤ºç‚¹æ•°ï¼Œm è¡¨ç¤ºè¾¹æ•°\nint n; // æ€»ç‚¹æ•° int h[N], w[N], e[N], ne[N], idx; // é‚»æ¥è¡¨å­˜å‚¨æ‰€æœ‰è¾¹ int dist[N], cnt[N]; // dist[x]å­˜å‚¨1å·ç‚¹åˆ°xçš„æœ€çŸ­è·ç¦»ï¼Œcnt[x]å­˜å‚¨1åˆ°xçš„æœ€çŸ­è·¯ä¸­ç»è¿‡çš„ç‚¹æ•° bool st[N]; // å­˜å‚¨æ¯ä¸ªç‚¹æ˜¯å¦åœ¨é˜Ÿåˆ—ä¸­ // å¦‚æœå­˜åœ¨è´Ÿç¯ï¼Œåˆ™è¿”å›trueï¼Œå¦åˆ™è¿”å›falseã€‚ bool spfa() { // ä¸éœ€è¦åˆå§‹åŒ–distæ•°ç»„ // åŸç†ï¼šå¦‚æœæŸæ¡æœ€çŸ­è·¯å¾„ä¸Šæœ‰nä¸ªç‚¹ï¼ˆé™¤äº†è‡ªå·±ï¼‰ï¼Œé‚£ä¹ˆåŠ ä¸Šè‡ªå·±ä¹‹åä¸€å…±æœ‰n+1ä¸ªç‚¹ï¼Œç”±æŠ½å±‰åŸç†ä¸€å®šæœ‰ä¸¤ä¸ªç‚¹ç›¸åŒï¼Œæ‰€ä»¥å­˜åœ¨ç¯ã€‚ queue\u0026lt;int\u0026gt; q; for (int i = 1; i \u0026lt;= n; i ++ ) { q.push(i); st[i] = true; } while (q.size()) { auto t = q.front(); q.pop(); st[t] = false; for (int i = h[t]; i != -1; i = ne[i]) { int j = e[i]; if (dist[j] \u0026gt; dist[t] + w[i]) { dist[j] = dist[t] + w[i]; cnt[j] = cnt[t] + 1; if (cnt[j] \u0026gt;= n) return true; // å¦‚æœä»1å·ç‚¹åˆ°xçš„æœ€çŸ­è·¯ä¸­åŒ…å«è‡³å°‘nä¸ªç‚¹ï¼ˆä¸åŒ…æ‹¬è‡ªå·±ï¼‰ï¼Œåˆ™è¯´æ˜å­˜åœ¨ç¯ if (!st[j]) { q.push(j); st[j] = true; } } } } return false; } floydç®—æ³• â€”â€” æ¨¡æ¿é¢˜ AcWing 854. Floydæ±‚æœ€çŸ­è·¯ æ—¶é—´å¤æ‚åº¦æ˜¯ O(n3)O(n3), nn è¡¨ç¤ºç‚¹æ•° åˆå§‹åŒ–ï¼š for (int i = 1; i \u0026lt;= n; i ++ ) for (int j = 1; j \u0026lt;= n; j ++ ) if (i == j) d[i][j] = 0; else d[i][j] = INF; // ç®—æ³•ç»“æŸåï¼Œd[a][b]è¡¨ç¤ºaåˆ°bçš„æœ€çŸ­è·ç¦» void floyd() { for (int k = 1; k \u0026lt;= n; k ++ ) for (int i = 1; i \u0026lt;= n; i ++ ) for (int j = 1; j \u0026lt;= n; j ++ ) d[i][j] = min(d[i][j], d[i][k] + d[k][j]); } æœ€å°ç”Ÿæˆæ ‘ï¼ˆæ— å‘å›¾ï¼‰ Prim : æœ´ç´ ç‰ˆPrim O(n^2)(ç¨ å¯†å›¾) ; å †ä¼˜åŒ–ç‰ˆPrim O(mlogn)(ä¸€èˆ¬ä¸ä¼šç”¨)\nKruskal : O(mlogm)(ç¨€ç–å›¾)\næœ´ç´ ç‰ˆprimç®—æ³• â€”â€” æ¨¡æ¿é¢˜ AcWing 858. Primç®—æ³•æ±‚æœ€å°ç”Ÿæˆæ ‘ æ—¶é—´å¤æ‚åº¦æ˜¯ O(n^2+m), n è¡¨ç¤ºç‚¹æ•°ï¼Œm è¡¨ç¤ºè¾¹æ•°\nåˆå§‹åŒ–è·ç¦»ä¸ºæ­£æ— ç©·ï¼Œè¿­ä»£æ‰€æœ‰ç‚¹ï¼Œæ‰¾åˆ°é›†åˆä¸­æœ€è¿‘çš„ç‚¹ï¼Œæ›´æ–°å®ƒåˆ°é›†åˆçš„è·ç¦»ï¼ŒæŠŠtåŠ åˆ°é›†åˆä¸­ã€‚\nint n; // nè¡¨ç¤ºç‚¹æ•° int g[N][N]; // é‚»æ¥çŸ©é˜µï¼Œå­˜å‚¨æ‰€æœ‰è¾¹ int dist[N]; // å­˜å‚¨å…¶ä»–ç‚¹åˆ°å½“å‰æœ€å°ç”Ÿæˆæ ‘çš„è·ç¦» bool st[N]; // å­˜å‚¨æ¯ä¸ªç‚¹æ˜¯å¦å·²ç»åœ¨ç”Ÿæˆæ ‘ä¸­ // å¦‚æœå›¾ä¸è¿é€šï¼Œåˆ™è¿”å›INF(å€¼æ˜¯0x3f3f3f3f), å¦åˆ™è¿”å›æœ€å°ç”Ÿæˆæ ‘çš„æ ‘è¾¹æƒé‡ä¹‹å’Œ int prim() { memset(dist, 0x3f, sizeof dist); int res = 0; for (int i = 0; i \u0026lt; n; i ++ ) { int t = -1; for (int j = 1; j \u0026lt;= n; j ++ ) if (!st[j] \u0026amp;\u0026amp; (t == -1 || dist[t] \u0026gt; dist[j])) t = j; if (i \u0026amp;\u0026amp; dist[t] == INF) return INF; if (i) res += dist[t]; st[t] = true; for (int j = 1; j \u0026lt;= n; j ++ ) dist[j] = min(dist[j], g[t][j]); } return res; } Kruskalç®—æ³• â€”â€” æ¨¡æ¿é¢˜ AcWing 859. Kruskalç®—æ³•æ±‚æœ€å°ç”Ÿæˆæ ‘ æ—¶é—´å¤æ‚åº¦æ˜¯ O(mlogm), n è¡¨ç¤ºç‚¹æ•°ï¼Œm è¡¨ç¤ºè¾¹æ•°\nint n, m; // næ˜¯ç‚¹æ•°ï¼Œmæ˜¯è¾¹æ•° int p[N]; // å¹¶æŸ¥é›†çš„çˆ¶èŠ‚ç‚¹æ•°ç»„ struct Edge // å­˜å‚¨è¾¹ { int a, b, w; // é‡è½½å°äºå·è¿ç®—ç¬¦ // ç”¨äºæ¯”è¾ƒä¸¤ä¸ªEdgeå¯¹è±¡çš„å¤§å°å…³ç³» bool operator \u0026lt; (const Edge \u0026amp;W) const { return w \u0026lt; W.w; // å¦‚æœå½“å‰å¯¹è±¡çš„è¾¹æƒå°äºWå¯¹è±¡çš„è¾¹æƒï¼Œè¿”å›trueï¼Œå¦åˆ™è¿”å›false } }edges[M]; int find(int x) // å¹¶æŸ¥é›†æ ¸å¿ƒæ“ä½œ { if (p[x] != x) p[x] = find(p[x]); return p[x]; } int kruskal() { sort(edges, edges + m); for (int i = 1; i \u0026lt;= n; i ++ ) p[i] = i; // åˆå§‹åŒ–å¹¶æŸ¥é›† int res = 0, cnt = 0; for (int i = 0; i \u0026lt; m; i ++ ) { int a = edges[i].a, b = edges[i].b, w = edges[i].w; a = find(a), b = find(b); if (a != b) // å¦‚æœä¸¤ä¸ªè¿é€šå—ä¸è¿é€šï¼Œåˆ™å°†è¿™ä¸¤ä¸ªè¿é€šå—åˆå¹¶ { p[a] = b; res += w; cnt ++ ; } } if (cnt \u0026lt; n - 1) return INF; return res; } æŸ“è‰²æ³•ï¼ˆæœ¬è´¨dfs)åˆ¤åˆ«äºŒåˆ†å›¾ â€”â€” æ¨¡æ¿é¢˜ AcWing 860. æŸ“è‰²æ³•åˆ¤å®šäºŒåˆ†å›¾ ç»™å®šä¸€ä¸ª n ä¸ªç‚¹mæ¡è¾¹çš„æ— å‘å›¾ï¼Œå›¾ä¸­å¯èƒ½å­˜åœ¨é‡è¾¹å’Œè‡ªç¯ã€‚è¯·ä½ åˆ¤æ–­è¿™ä¸ªå›¾æ˜¯å¦æ˜¯äºŒåˆ†å›¾ã€‚\næ—¶é—´å¤æ‚åº¦æ˜¯ O(n+m), n è¡¨ç¤ºç‚¹æ•°ï¼Œm è¡¨ç¤ºè¾¹æ•°\nint n; // nè¡¨ç¤ºç‚¹æ•° int h[N], e[M], ne[M], idx; // é‚»æ¥è¡¨å­˜å‚¨å›¾ int color[N]; // è¡¨ç¤ºæ¯ä¸ªç‚¹çš„é¢œè‰²ï¼Œ-1è¡¨ç¤ºä¸ºæŸ“è‰²ï¼Œ0è¡¨ç¤ºç™½è‰²ï¼Œ1è¡¨ç¤ºé»‘è‰² // å‚æ•°ï¼šuè¡¨ç¤ºå½“å‰èŠ‚ç‚¹ï¼Œcè¡¨ç¤ºå½“å‰ç‚¹çš„é¢œè‰² bool dfs(int u, int c) { color[u] = c; for (int i = h[u]; i != -1; i = ne[i]) { int j = e[i]; if (color[j] == -1) { if (!dfs(j, !c)) return false; } else if (color[j] == c) return false; } return true; } bool check() { memset(color, -1, sizeof color); bool flag = true; for (int i = 1; i \u0026lt;= n; i ++ ) if (color[i] == -1) if (!dfs(i, 0)) { flag = false; break; } return flag; } åŒˆç‰™åˆ©ç®—æ³• â€”â€” æ¨¡æ¿é¢˜ AcWing 861. äºŒåˆ†å›¾çš„æœ€å¤§åŒ¹é… æ—¶é—´å¤æ‚åº¦æœ€åæ˜¯ O(nm)ï¼Œå®é™…è¿è¡Œæ—¶é—´ä¸€èˆ¬è¿œå°äºO(nm)ï¼Œ n è¡¨ç¤ºç‚¹æ•°ï¼Œm è¡¨ç¤ºè¾¹æ•°\nåšé”™ä¸€ä»¶äº‹ï¼Œé”™è¿‡ä¸€ä»¶äº‹\nint n1, n2; // n1è¡¨ç¤ºç¬¬ä¸€ä¸ªé›†åˆä¸­çš„ç‚¹æ•°ï¼Œn2è¡¨ç¤ºç¬¬äºŒä¸ªé›†åˆä¸­çš„ç‚¹æ•° int h[N], e[M], ne[M], idx; // é‚»æ¥è¡¨å­˜å‚¨æ‰€æœ‰è¾¹ï¼ŒåŒˆç‰™åˆ©ç®—æ³•ä¸­åªä¼šç”¨åˆ°ä»ç¬¬äºŒä¸ªé›†åˆæŒ‡å‘ç¬¬ä¸€ä¸ªé›†åˆçš„è¾¹ï¼Œæ‰€ä»¥è¿™é‡Œåªç”¨å­˜ä¸€ä¸ªæ–¹å‘çš„è¾¹ int match[N]; // å­˜å‚¨ç¬¬äºŒä¸ªé›†åˆä¸­çš„æ¯ä¸ªç‚¹å½“å‰åŒ¹é…çš„ç¬¬ä¸€ä¸ªé›†åˆä¸­çš„ç‚¹æ˜¯å“ªä¸ª bool st[N]; // è¡¨ç¤ºç¬¬äºŒä¸ªé›†åˆä¸­çš„æ¯ä¸ªç‚¹æ˜¯å¦å·²ç»è¢«éå†è¿‡ bool find(int x) { for (int i = h[x]; i != -1; i = ne[i]) { int j = e[i]; if (!st[j]) { st[j] = true; if (match[j] == 0 || find(match[j])) { match[j] = x; return true; } } } return false; } // æ±‚æœ€å¤§åŒ¹é…æ•°ï¼Œä¾æ¬¡æšä¸¾ç¬¬ä¸€ä¸ªé›†åˆä¸­çš„æ¯ä¸ªç‚¹èƒ½å¦åŒ¹é…ç¬¬äºŒä¸ªé›†åˆä¸­çš„ç‚¹ int res = 0; for (int i = 1; i \u0026lt;= n1; i ++ ) { memset(st, false, sizeof st); if (find(i)) res ++ ; } ä½œè€…ï¼šyxc é“¾æ¥ï¼šhttps://www.acwing.com/blog/content/405/ æ¥æºï¼šAcWing è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚\nç¬¬å››ç«  è¯•é™¤æ³•åˆ¤å®šè´¨æ•° â€”â€” æ¨¡æ¿é¢˜ AcWing 866. è¯•é™¤æ³•åˆ¤å®šè´¨æ•° è´¨æ•°ï¼šå¤§äº1çš„æ•´æ•°ä¸­ï¼Œå¦‚æœåªåŒ…å«1å’Œæœ¬èº«ä¸¤ä¸ªçº¦æŸï¼Œç§°ä¸ºè´¨æ•°ï¼ˆç´ æ•°ï¼‰\nï¼ˆ1ï¼‰åˆ¤å®šï¼Œè¯•é™¤æ³•\nï¼ˆ2ï¼‰åˆ†è§£è´¨å› æ•°\nbool is_prime(int x) { if (x \u0026lt; 2) return false; for (int i = 2; i \u0026lt;= x / i; i ++ ) if (x % i == 0) return false; return true; } è¯•é™¤æ³•åˆ†è§£è´¨å› æ•° â€”â€” æ¨¡æ¿é¢˜ AcWing 867. åˆ†è§£è´¨å› æ•° void divide(int x) { for (int i = 2; i \u0026lt;= x / i; i ++ ) if (x % i == 0) { int s = 0; while (x % i == 0) x /= i, s ++ ; cout \u0026lt;\u0026lt; i \u0026lt;\u0026lt; \u0026#39; \u0026#39; \u0026lt;\u0026lt; s \u0026lt;\u0026lt; endl; } if (x \u0026gt; 1) cout \u0026lt;\u0026lt; x \u0026lt;\u0026lt; \u0026#39; \u0026#39; \u0026lt;\u0026lt; 1 \u0026lt;\u0026lt; endl; cout \u0026lt;\u0026lt; endl; } æœ´ç´ ç­›æ³•æ±‚ç´ æ•° â€”â€” æ¨¡æ¿é¢˜ AcWing 868. ç­›è´¨æ•° int primes[N], cnt; // primes[]å­˜å‚¨æ‰€æœ‰ç´ æ•° bool st[N]; // st[x]å­˜å‚¨xæ˜¯å¦è¢«ç­›æ‰ void get_primes(int n) { for (int i = 2; i \u0026lt;= n; i ++ ) { if (st[i]) continue; primes[cnt ++ ] = i; for (int j = i; j \u0026lt;= n; j += i) st[j] = true; } } çº¿æ€§ç­›æ³•æ±‚ç´ æ•° â€”â€” æ¨¡æ¿é¢˜ AcWing 868. ç­›è´¨æ•° è¢«æœ€å°è´¨å› å­ç­›æ‰\nint primes[N], cnt; // primes[]å­˜å‚¨æ‰€æœ‰ç´ æ•° bool st[N]; // st[x]å­˜å‚¨xæ˜¯å¦è¢«ç­›æ‰ void get_primes(int n) { for (int i = 2; i \u0026lt;= n; i ++ ) { if (!st[i]) primes[cnt ++ ] = i; for (int j = 0; primes[j] \u0026lt;= n / i; j ++ ) { st[primes[j] * i] = true; if (i % primes[j] == 0) break; } } } è¯•é™¤æ³•æ±‚æ‰€æœ‰çº¦æ•° â€”â€” æ¨¡æ¿é¢˜ AcWing 869. è¯•é™¤æ³•æ±‚çº¦æ•° intèŒƒå›´å†…çº¦æ•°ä¸ªæ•°æœ€å¤šä¸º1500ä¸ªå·¦å³\nvector\u0026lt;int\u0026gt; get_divisors(int x) { vector\u0026lt;int\u0026gt; res; for (int i = 1; i \u0026lt;= x / i; i ++ ) if (x % i == 0) { res.push_back(i); if (i != x / i) res.push_back(x / i); } sort(res.begin(), res.end()); return res; } çº¦æ•°ä¸ªæ•°å’Œçº¦æ•°ä¹‹å’Œ â€”â€” æ¨¡æ¿é¢˜ AcWing 870. çº¦æ•°ä¸ªæ•°, AcWing 871. çº¦æ•°ä¹‹å’Œ å¦‚æœ N = p1^c1 * p2^c2 * ... *pk^ck çº¦æ•°ä¸ªæ•°ï¼š (c1 + 1) * (c2 + 1) * ... * (ck + 1) çº¦æ•°ä¹‹å’Œï¼š (p1^0 + p1^1 + ... + p1^c1) * ... * (pk^0 + pk^1 + ... + pk^ck) æ¬§å‡ é‡Œå¾—ç®—æ³• â€”â€” æ¨¡æ¿é¢˜ AcWing 872. æœ€å¤§å…¬çº¦æ•° int gcd(int a, int b) { return b ? gcd(b, a % b) : a; } æ±‚æ¬§æ‹‰å‡½æ•° â€”â€” æ¨¡æ¿é¢˜ AcWing 873. æ¬§æ‹‰å‡½æ•° æ¬§æ‹‰å‡½æ•°å…¬å¼ï¼ˆå®¹æ–¥åŸç†) : n*(1-p1)*(1-p2)\u0026hellip;(1-pk)\nint phi(int x) { int res = x; for (int i = 2; i \u0026lt;= x / i; i ++ ) if (x % i == 0) { res = res / i * (i - 1); while (x % i == 0) x /= i; } if (x \u0026gt; 1) res = res / x * (x - 1); return res; } ç­›æ³•æ±‚æ¬§æ‹‰å‡½æ•° â€”â€” æ¨¡æ¿é¢˜ AcWing 874. ç­›æ³•æ±‚æ¬§æ‹‰å‡½æ•° O(n) çº¿æ€§æ±‚æ‰€æœ‰æ•°çš„æ¬§æ‹‰å‡½æ•°\nåº”ç”¨ï¼šæ¬§æ‹‰å®šç†ï¼šaä¸näº’è´¨ a^Ï†(n)=1(mod n)\nint primes[N], cnt; // primes[]å­˜å‚¨æ‰€æœ‰ç´ æ•° int euler[N]; // å­˜å‚¨æ¯ä¸ªæ•°çš„æ¬§æ‹‰å‡½æ•° bool st[N]; // st[x]å­˜å‚¨xæ˜¯å¦è¢«ç­›æ‰ void get_eulers(int n) { euler[1] = 1; for (int i = 2; i \u0026lt;= n; i ++ ) { if (!st[i]) { primes[cnt ++ ] = i; euler[i] = i - 1; } for (int j = 0; primes[j] \u0026lt;= n / i; j ++ ) { int t = primes[j] * i; st[t] = true; if (i % primes[j] == 0) { euler[t] = euler[i] * primes[j]; break; } euler[t] = euler[i] * (primes[j] - 1); } } } å¿«é€Ÿå¹‚ â€”â€” æ¨¡æ¿é¢˜ AcWing 875. å¿«é€Ÿå¹‚ æ±‚ m^k mod pï¼Œæ—¶é—´å¤æ‚åº¦ O(logk)ã€‚\nint qmi(int m, int k, int p) { int res = 1 % p, t = m; while (k) { if (k\u0026amp;1) res = res * t % p; t = t * t % p; k \u0026gt;\u0026gt;= 1; } return res; } æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³• â€”â€” æ¨¡æ¿é¢˜ AcWing 877. æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³• // æ±‚x, yï¼Œä½¿å¾—ax + by = gcd(a, b) int exgcd(int a, int b, int \u0026amp;x, int \u0026amp;y) { if (!b) { x = 1; y = 0; return a; } int d = exgcd(b, a % b, y, x); y -= (a/b) * x; return d; } é«˜æ–¯æ¶ˆå…ƒ â€”â€” æ¨¡æ¿é¢˜ AcWing 883. é«˜æ–¯æ¶ˆå…ƒè§£çº¿æ€§æ–¹ç¨‹ç»„ O(n^3)æ—¶é—´å†…è§£nä¸ªæ–¹ç¨‹nä¸ªæœªçŸ¥æ•°çš„è§£ã€‚\nè§£ï¼šæ— è§£ ï¼› æ— ç©·å¤šç»„è§£ ï¼› å”¯ä¸€è§£ ï¼›\nå®Œç¾é˜¶æ¢¯å‹ï¼šå”¯ä¸€è§£ *0=*éé›¶ ï¼š *æ— è§£ 0=0 ï¼š æ— ç©·å¤šç»„è§£ é«˜æ–¯æ¶ˆå…ƒï¼š\næšä¸¾æ¯ä¸€åˆ—cï¼š\næ‰¾åˆ°ç»å¯¹å€¼æœ€å¤§çš„ä¸€è¡Œ å°†è¯¥è¡Œæ¢åˆ°æœ€ä¸Šé¢ å°†è¯¥è¡Œç¬¬ä¸€ä¸ªæ•°å˜æˆ1 å°†ä¸‹é¢æ‰€æœ‰è¡Œçš„ç¬¬cåˆ—æ¶ˆæˆ0 // a[N][N]æ˜¯å¢å¹¿çŸ©é˜µ int gauss() { int c, r; for (c = 0, r = 0; c \u0026lt; n; c ++ ) { int t = r; for (int i = r; i \u0026lt; n; i ++ ) // æ‰¾åˆ°ç»å¯¹å€¼æœ€å¤§çš„è¡Œ if (fabs(a[i][c]) \u0026gt; fabs(a[t][c])) t = i; if (fabs(a[t][c]) \u0026lt; eps) continue; for (int i = c; i \u0026lt;= n; i ++ ) swap(a[t][i], a[r][i]); // å°†ç»å¯¹å€¼æœ€å¤§çš„è¡Œæ¢åˆ°æœ€é¡¶ç«¯ for (int i = n; i \u0026gt;= c; i -- ) a[r][i] /= a[r][c]; // å°†å½“å‰ä¸Šçš„é¦–ä½å˜æˆ1 for (int i = r + 1; i \u0026lt; n; i ++ ) // ç”¨å½“å‰è¡Œå°†ä¸‹é¢æ‰€æœ‰çš„åˆ—æ¶ˆæˆ0 if (fabs(a[i][c]) \u0026gt; eps) for (int j = n; j \u0026gt;= c; j -- ) a[i][j] -= a[r][j] * a[i][c]; r ++ ; } if (r \u0026lt; n) { for (int i = r; i \u0026lt; n; i ++ ) if (fabs(a[i][n]) \u0026gt; eps) return 2; // æ— è§£ return 1; // æœ‰æ— ç©·å¤šç»„è§£ } for (int i = n - 1; i \u0026gt;= 0; i -- ) for (int j = i + 1; j \u0026lt; n; j ++ ) a[i][n] -= a[i][j] * a[j][n]; return 0; // æœ‰å”¯ä¸€è§£ } é€’å½’æ³•æ±‚ç»„åˆæ•° â€”â€” æ¨¡æ¿é¢˜ AcWing 885. æ±‚ç»„åˆæ•° I åä¸‡ 1\u0026lt;b\u0026lt;a\u0026lt;2000 O(n^2)\n// c[a][b] è¡¨ç¤ºä»aä¸ªè‹¹æœä¸­é€‰bä¸ªçš„æ–¹æ¡ˆæ•° for (int i = 0; i \u0026lt; N; i ++ ) for (int j = 0; j \u0026lt;= i; j ++ ) if (!j) c[i][j] = 1; else c[i][j] = (c[i - 1][j] + c[i - 1][j - 1]) % mod; é€šè¿‡é¢„å¤„ç†é€†å…ƒçš„æ–¹å¼æ±‚ç»„åˆæ•° â€”â€” æ¨¡æ¿é¢˜ AcWing 886. æ±‚ç»„åˆæ•° II ä¸€ä¸‡ 1\u0026lt;b\u0026lt;a\u0026lt;10^5 O(logn)\né¦–å…ˆé¢„å¤„ç†å‡ºæ‰€æœ‰é˜¶ä¹˜å–æ¨¡çš„ä½™æ•°fact[N]ï¼Œä»¥åŠæ‰€æœ‰é˜¶ä¹˜å–æ¨¡çš„é€†å…ƒinfact[N] å¦‚æœå–æ¨¡çš„æ•°æ˜¯è´¨æ•°ï¼Œå¯ä»¥ç”¨è´¹é©¬å°å®šç†æ±‚é€†å…ƒ int qmi(int a, int k, int p) // å¿«é€Ÿå¹‚æ¨¡æ¿ { int res = 1; while (k) { if (k \u0026amp; 1) res = (LL)res * a % p; a = (LL)a * a % p; k \u0026gt;\u0026gt;= 1; } return res; } // é¢„å¤„ç†é˜¶ä¹˜çš„ä½™æ•°å’Œé˜¶ä¹˜é€†å…ƒçš„ä½™æ•° fact[0] = infact[0] = 1; for (int i = 1; i \u0026lt; N; i ++ ) { fact[i] = (LL)fact[i - 1] * i % mod; infact[i] = (LL)infact[i - 1] * qmi(i, mod - 2, mod) % mod; } ll C(ll n,ll m){ if(m\u0026gt;n) return 0ll; return fact[n]*infact[m]%mod*infact[n-m]%mod; } Lucaså®šç† â€”â€” æ¨¡æ¿é¢˜ AcWing 887. æ±‚ç»„åˆæ•° III ç»„åˆæ•°ï¼Œ1\u0026lt;b\u0026lt;a\nè‹¥pæ˜¯è´¨æ•°ï¼Œåˆ™å¯¹äºä»»æ„æ•´æ•° 1 \u0026lt;= m \u0026lt;= nï¼Œæœ‰ï¼š C(n, m) = C(n % p, m % p) * C(n / p, m / p) (mod p) int qmi(int a, int k) // å¿«é€Ÿå¹‚æ¨¡æ¿ { int res = 1; while (k) { if (k \u0026amp; 1) res = (LL)res * a % p; a = (LL)a * a % p; k \u0026gt;\u0026gt;= 1; } return res; } int C(int a, int b) // é€šè¿‡å®šç†æ±‚ç»„åˆæ•°C(a, b) { int res = 1; for (int i = 1, j = a; i \u0026lt;= b; i ++, j -- ) { res = (LL)res * j % p; res = (LL)res * qmi(i, p - 2) % p; } return res; } int lucas(LL a, LL b) { if (a \u0026lt; p \u0026amp;\u0026amp; b \u0026lt; p) return C(a, b); return (LL)C(a % p, b % p) * lucas(a / p, b / p) % p; } åˆ†è§£è´¨å› æ•°æ³•æ±‚ç»„åˆæ•° â€”â€” æ¨¡æ¿é¢˜ AcWing 888. æ±‚ç»„åˆæ•° IV å½“æˆ‘ä»¬éœ€è¦æ±‚å‡ºç»„åˆæ•°çš„çœŸå®å€¼ï¼Œè€Œéå¯¹æŸä¸ªæ•°çš„ä½™æ•°æ—¶ï¼Œåˆ†è§£è´¨å› æ•°çš„æ–¹å¼æ¯”è¾ƒå¥½ç”¨ï¼š\n1. ç­›æ³•æ±‚å‡ºèŒƒå›´å†…çš„æ‰€æœ‰è´¨æ•° 2. é€šè¿‡ C(a, b) = a! / b! / (a - b)! è¿™ä¸ªå…¬å¼æ±‚å‡ºæ¯ä¸ªè´¨å› å­çš„æ¬¡æ•°ã€‚ n! ä¸­pçš„æ¬¡æ•°æ˜¯ n / p + n / p^2 + n / p^3 + ... 3. ç”¨é«˜ç²¾åº¦ä¹˜æ³•å°†æ‰€æœ‰è´¨å› å­ç›¸ä¹˜ int primes[N], cnt; // å­˜å‚¨æ‰€æœ‰è´¨æ•° int sum[N]; // å­˜å‚¨æ¯ä¸ªè´¨æ•°çš„æ¬¡æ•° bool st[N]; // å­˜å‚¨æ¯ä¸ªæ•°æ˜¯å¦å·²è¢«ç­›æ‰ void get_primes(int n) // çº¿æ€§ç­›æ³•æ±‚ç´ æ•° { for (int i = 2; i \u0026lt;= n; i ++ ) { if (!st[i]) primes[cnt ++ ] = i; for (int j = 0; primes[j] \u0026lt;= n / i; j ++ ) { st[primes[j] * i] = true; if (i % primes[j] == 0) break; } } } int get(int n, int p) // æ±‚nï¼ä¸­çš„æ¬¡æ•° { int res = 0; while (n) { res += n / p; n /= p; } return res; } vector\u0026lt;int\u0026gt; mul(vector\u0026lt;int\u0026gt; a, int b) // é«˜ç²¾åº¦ä¹˜ä½ç²¾åº¦æ¨¡æ¿ { vector\u0026lt;int\u0026gt; c; int t = 0; for (int i = 0; i \u0026lt; a.size(); i ++ ) { t += a[i] * b; c.push_back(t % 10); t /= 10; } while (t) { c.push_back(t % 10); t /= 10; } return c; } get_primes(a); // é¢„å¤„ç†èŒƒå›´å†…çš„æ‰€æœ‰è´¨æ•° for (int i = 0; i \u0026lt; cnt; i ++ ) // æ±‚æ¯ä¸ªè´¨å› æ•°çš„æ¬¡æ•° { int p = primes[i]; sum[i] = get(a, p) - get(b, p) - get(a - b, p); } vector\u0026lt;int\u0026gt; res; res.push_back(1); for (int i = 0; i \u0026lt; cnt; i ++ ) // ç”¨é«˜ç²¾åº¦ä¹˜æ³•å°†æ‰€æœ‰è´¨å› å­ç›¸ä¹˜ for (int j = 0; j \u0026lt; sum[i]; j ++ ) res = mul(res, primes[i]); å¡ç‰¹å…°æ•° â€”â€” æ¨¡æ¿é¢˜ AcWing 889. æ»¡è¶³æ¡ä»¶çš„01åºåˆ— ç»™å®šnä¸ª0å’Œnä¸ª1ï¼Œå®ƒä»¬æŒ‰ç…§æŸç§é¡ºåºæ’æˆé•¿åº¦ä¸º2nçš„åºåˆ—ï¼Œæ»¡è¶³ä»»æ„å‰ç¼€ä¸­0çš„ä¸ªæ•°éƒ½ä¸å°‘äº1çš„ä¸ªæ•°çš„åºåˆ—çš„æ•°é‡ä¸ºï¼š $$ Cat(n) = C(2n, n) / (n + 1) $$\nå®¹æ–¥åŸç† æ‰¾1~nä¸­èƒ½è‡³å°‘è¢«ç´ æ•°p1,p2,\u0026hellip;,pnä¸€ä¸ªæ•´é™¤çš„æ•´æ•°æœ‰å¤šå°‘ä¸ªã€‚\nä½è¿ç®—å¯¹åº”å®¹æ–¥åŸç†é›†åˆï¼Œ1~nä¸­èƒ½è¢«xæ•´é™¤çš„ä¸ªæ•°ä¸ºn/xï¼Œå¥‡æ•°åŠ ä¸Šï¼Œå¶æ•°å‡å»\nNIM(å°¼å§†)æ¸¸æˆ â€”â€” æ¨¡æ¿é¢˜ AcWing 891. Nimæ¸¸æˆ ç»™å®šNå †ç‰©å“ï¼Œç¬¬iå †ç‰©å“æœ‰Aiä¸ªã€‚ä¸¤åç©å®¶è½®æµè¡ŒåŠ¨ï¼Œæ¯æ¬¡å¯ä»¥ä»»é€‰ä¸€å †ï¼Œå–èµ°ä»»æ„å¤šä¸ªç‰©å“ï¼Œå¯æŠŠä¸€å †å–å…‰ï¼Œä½†ä¸èƒ½ä¸å–ã€‚å–èµ°æœ€åä¸€ä»¶ç‰©å“è€…è·èƒœã€‚ä¸¤äººéƒ½é‡‡å–æœ€ä¼˜ç­–ç•¥ï¼Œé—®å…ˆæ‰‹æ˜¯å¦å¿…èƒœã€‚\næˆ‘ä»¬æŠŠè¿™ç§æ¸¸æˆç§°ä¸ºNIMåšå¼ˆã€‚æŠŠæ¸¸æˆè¿‡ç¨‹ä¸­é¢ä¸´çš„çŠ¶æ€ç§°ä¸ºå±€é¢ã€‚æ•´å±€æ¸¸æˆç¬¬ä¸€ä¸ªè¡ŒåŠ¨çš„ç§°ä¸ºå…ˆæ‰‹ï¼Œç¬¬äºŒä¸ªè¡ŒåŠ¨çš„ç§°ä¸ºåæ‰‹ã€‚è‹¥åœ¨æŸä¸€å±€é¢ä¸‹æ— è®ºé‡‡å–ä½•ç§è¡ŒåŠ¨ï¼Œéƒ½ä¼šè¾“æ‰æ¸¸æˆï¼Œåˆ™ç§°è¯¥å±€é¢å¿…è´¥ã€‚ æ‰€è°“é‡‡å–æœ€ä¼˜ç­–ç•¥æ˜¯æŒ‡ï¼Œè‹¥åœ¨æŸä¸€å±€é¢ä¸‹å­˜åœ¨æŸç§è¡ŒåŠ¨ï¼Œä½¿å¾—è¡ŒåŠ¨åå¯¹é¢é¢ä¸´å¿…è´¥å±€é¢ï¼Œåˆ™ä¼˜å…ˆé‡‡å–è¯¥è¡ŒåŠ¨ã€‚åŒæ—¶ï¼Œè¿™æ ·çš„å±€é¢è¢«ç§°ä¸ºå¿…èƒœã€‚æˆ‘ä»¬è®¨è®ºçš„åšå¼ˆé—®é¢˜ä¸€èˆ¬éƒ½åªè€ƒè™‘ç†æƒ³æƒ…å†µï¼Œå³ä¸¤äººå‡æ— å¤±è¯¯ï¼Œéƒ½é‡‡å–æœ€ä¼˜ç­–ç•¥è¡ŒåŠ¨æ—¶æ¸¸æˆçš„ç»“æœã€‚ NIMåšå¼ˆä¸å­˜åœ¨å¹³å±€ï¼Œåªæœ‰å…ˆæ‰‹å¿…èƒœå’Œå…ˆæ‰‹å¿…è´¥ä¸¤ç§æƒ…å†µã€‚\nå®šç†ï¼š NIMåšå¼ˆå…ˆæ‰‹å¿…èƒœï¼Œå½“ä¸”ä»…å½“ A1 ^ A2 ^ â€¦ ^ An != 0\nå…¬å¹³ç»„åˆæ¸¸æˆICG è‹¥ä¸€ä¸ªæ¸¸æˆæ»¡è¶³ï¼š\nç”±ä¸¤åç©å®¶äº¤æ›¿è¡ŒåŠ¨ï¼› åœ¨æ¸¸æˆè¿›ç¨‹çš„ä»»æ„æ—¶åˆ»ï¼Œå¯ä»¥æ‰§è¡Œçš„åˆæ³•è¡ŒåŠ¨ä¸è½®åˆ°å“ªåç©å®¶æ— å…³ï¼› ä¸èƒ½è¡ŒåŠ¨çš„ç©å®¶åˆ¤è´Ÿï¼› åˆ™ç§°è¯¥æ¸¸æˆä¸ºä¸€ä¸ªå…¬å¹³ç»„åˆæ¸¸æˆã€‚ NIMåšå¼ˆå±äºå…¬å¹³ç»„åˆæ¸¸æˆï¼Œä½†åŸå»ºçš„æ£‹ç±»æ¸¸æˆï¼Œæ¯”å¦‚å›´æ£‹ï¼Œå°±ä¸æ˜¯å…¬å¹³ç»„åˆæ¸¸æˆã€‚å› ä¸ºå›´æ£‹äº¤æˆ˜åŒæ–¹åˆ†åˆ«åªèƒ½è½é»‘å­å’Œç™½å­ï¼Œèƒœè´Ÿåˆ¤å®šä¹Ÿæ¯”è¾ƒå¤æ‚ï¼Œä¸æ»¡è¶³æ¡ä»¶2å’Œæ¡ä»¶3ã€‚\næœ‰å‘å›¾æ¸¸æˆ ç»™å®šä¸€ä¸ªæœ‰å‘æ— ç¯å›¾ï¼Œå›¾ä¸­æœ‰ä¸€ä¸ªå”¯ä¸€çš„èµ·ç‚¹ï¼Œåœ¨èµ·ç‚¹ä¸Šæ”¾æœ‰ä¸€æšæ£‹å­ã€‚ä¸¤åç©å®¶äº¤æ›¿åœ°æŠŠè¿™æšæ£‹å­æ²¿æœ‰å‘è¾¹è¿›è¡Œç§»åŠ¨ï¼Œæ¯æ¬¡å¯ä»¥ç§»åŠ¨ä¸€æ­¥ï¼Œæ— æ³•ç§»åŠ¨è€…åˆ¤è´Ÿã€‚è¯¥æ¸¸æˆè¢«ç§°ä¸ºæœ‰å‘å›¾æ¸¸æˆã€‚ ä»»ä½•ä¸€ä¸ªå…¬å¹³ç»„åˆæ¸¸æˆéƒ½å¯ä»¥è½¬åŒ–ä¸ºæœ‰å‘å›¾æ¸¸æˆã€‚å…·ä½“æ–¹æ³•æ˜¯ï¼ŒæŠŠæ¯ä¸ªå±€é¢çœ‹æˆå›¾ä¸­çš„ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå¹¶ä¸”ä»æ¯ä¸ªå±€é¢å‘æ²¿ç€åˆæ³•è¡ŒåŠ¨èƒ½å¤Ÿåˆ°è¾¾çš„ä¸‹ä¸€ä¸ªå±€é¢è¿æœ‰å‘è¾¹ã€‚\nMexè¿ç®— è®¾Sè¡¨ç¤ºä¸€ä¸ªéè´Ÿæ•´æ•°é›†åˆã€‚å®šä¹‰mex(S)ä¸ºæ±‚å‡ºä¸å±äºé›†åˆSçš„æœ€å°éè´Ÿæ•´æ•°çš„è¿ç®—ï¼Œå³ï¼š mex(S) = min{x}, xå±äºè‡ªç„¶æ•°ï¼Œä¸”xä¸å±äºS\nSGå‡½æ•° åœ¨æœ‰å‘å›¾æ¸¸æˆä¸­ï¼Œå¯¹äºæ¯ä¸ªèŠ‚ç‚¹xï¼Œè®¾ä»xå‡ºå‘å…±æœ‰kæ¡æœ‰å‘è¾¹ï¼Œåˆ†åˆ«åˆ°è¾¾èŠ‚ç‚¹y1, y2, â€¦, ykï¼Œå®šä¹‰SG(x)ä¸ºxçš„åç»§èŠ‚ç‚¹y1, y2, â€¦, yk çš„SGå‡½æ•°å€¼æ„æˆçš„é›†åˆå†æ‰§è¡Œ**mex(S)**è¿ç®—çš„ç»“æœï¼Œå³ï¼š SG(x) = mex({SG(y1), SG(y2), â€¦, SG(yk)}) ç‰¹åˆ«åœ°ï¼Œæ•´ä¸ªæœ‰å‘å›¾æ¸¸æˆGçš„SGå‡½æ•°å€¼è¢«å®šä¹‰ä¸ºæœ‰å‘å›¾æ¸¸æˆèµ·ç‚¹sçš„SGå‡½æ•°å€¼ï¼Œå³SG(G) = SG(s)ã€‚\nint sg(int x){ if (f[x] != -1) return f[x]; unordered_set\u0026lt;int\u0026gt; S; for(int i = 0; i \u0026lt; m; i++ ) { int sum = s[i]; if (x \u0026gt;= sum) S.insert(sg(x - sum)); } for (int i=0; ; i++ ) if (!S.count(i)) return f[x] = i; } æœ‰å‘å›¾æ¸¸æˆçš„å’Œ â€”â€” æ¨¡æ¿é¢˜ AcWing 893. é›†åˆ-Nimæ¸¸æˆ è®¾G1, G2, â€¦, Gm æ˜¯mä¸ªæœ‰å‘å›¾æ¸¸æˆã€‚å®šä¹‰æœ‰å‘å›¾æ¸¸æˆGï¼Œå®ƒçš„è¡ŒåŠ¨è§„åˆ™æ˜¯ä»»é€‰æŸä¸ªæœ‰å‘å›¾æ¸¸æˆGiï¼Œå¹¶åœ¨Giä¸Šè¡ŒåŠ¨ä¸€æ­¥ã€‚Gè¢«ç§°ä¸ºæœ‰å‘å›¾æ¸¸æˆG1, G2, â€¦, Gmçš„å’Œã€‚ æœ‰å‘å›¾æ¸¸æˆçš„å’Œçš„SGå‡½æ•°å€¼ç­‰äºå®ƒåŒ…å«çš„å„ä¸ªå­æ¸¸æˆSGå‡½æ•°å€¼çš„å¼‚æˆ–å’Œï¼Œå³ï¼š SG(G) = SG(G1) ^ SG(G2) ^ â€¦ ^ SG(Gm)\nå®šç† æœ‰å‘å›¾æ¸¸æˆçš„æŸä¸ªå±€é¢å¿…èƒœï¼Œå½“ä¸”ä»…å½“è¯¥å±€é¢å¯¹åº”èŠ‚ç‚¹çš„SGå‡½æ•°å€¼å¤§äº0ã€‚ æœ‰å‘å›¾æ¸¸æˆçš„æŸä¸ªå±€é¢å¿…è´¥ï¼Œå½“ä¸”ä»…å½“è¯¥å±€é¢å¯¹åº”èŠ‚ç‚¹çš„SGå‡½æ•°å€¼ç­‰äº0ã€‚\nä½œè€…ï¼šyxc é“¾æ¥ï¼šhttps://www.acwing.com/blog/content/406/ æ¥æºï¼šAcWing è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚\næ—¶ç©ºå¤æ‚åº¦åˆ†æ å½“å¤„ç†ACMæˆ–ç¬”è¯•é¢˜æ—¶ï¼Œé€šå¸¸æ—¶é—´é™åˆ¶ä¸º1ç§’æˆ–2ç§’ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒC++ä»£ç ä¸­çš„æ“ä½œæ¬¡æ•°åº”æ§åˆ¶åœ¨10^7 åˆ° 10^8ä¹‹é—´ï¼Œè¿™æ˜¯æœ€ä½³èŒƒå›´ã€‚\nä»¥ä¸‹æ˜¯åœ¨ä¸åŒæ•°æ®è§„æ¨¡ä¸‹ï¼Œä»£ç çš„æ—¶é—´å¤æ‚åº¦å’Œç®—æ³•é€‰æ‹©çš„æŒ‡å¯¼ï¼š\nn â‰¤ 30ï¼šæŒ‡æ•°çº§åˆ«ï¼Œä½¿ç”¨DFS+å‰ªæï¼ŒçŠ¶æ€å‹ç¼©DPã€‚ n â‰¤ 100ï¼šO(n^3)ï¼Œé€‚ç”¨äºFloydã€DPã€é«˜æ–¯æ¶ˆå…ƒã€‚ n â‰¤ 1000ï¼šO(n^2)æˆ–O(n^2*logn)ï¼Œé€‚ç”¨äºDPã€åˆ†æ²»ã€é«˜æ–¯æ¶ˆå…ƒã€æœ´ç´ ç‰ˆDijkstraã€æœ´ç´ ç‰ˆPrimã€Bellman-Fordã€‚ n â‰¤ 10000ï¼šO(n * âˆšn)ï¼Œé€‚ç”¨äºå—çŠ¶é“¾è¡¨ã€åˆ†å—ã€è«é˜Ÿã€‚ n â‰¤ 100000ï¼šO(nlogn)ï¼Œé€‚ç”¨äºå„ç§æ’åºã€çº¿æ®µæ ‘ã€æ ‘çŠ¶æ•°ç»„ã€é›†åˆ/æ˜ å°„ã€å †ã€æ‹“æ‰‘æ’åºã€Dijkstra+å †ã€Primã€Kruskalã€SPFAã€æ±‚å‡¸åŒ…ã€æ±‚åŠå¹³é¢äº¤ã€äºŒåˆ†ã€CDQåˆ†æ²»ã€æ•´ä½“äºŒåˆ†ã€åç¼€æ•°ç»„ã€æ ‘é“¾å‰–åˆ†ã€åŠ¨æ€æ ‘ã€‚ n \u0026lt; 1000000ï¼šO(n)æˆ–å¸¸æ•°è¾ƒå°çš„O(nlogn)ï¼Œé€‚ç”¨äºå•è°ƒé˜Ÿåˆ—ã€å“ˆå¸Œæ˜ å°„ã€åŒæŒ‡é’ˆæ‰«æã€BFSã€å¹¶æŸ¥é›†ã€KMPã€ACè‡ªåŠ¨æœºã€å¸¸æ•°è¾ƒå°çš„O(nlogn)çš„åšæ³•ï¼ˆå¦‚æ’åºã€æ ‘çŠ¶æ•°ç»„ã€å †ã€Dijkstraã€SPFAï¼‰ã€‚ n \u0026lt; 10000000ï¼šO(n)ï¼Œé€‚ç”¨äºåŒæŒ‡é’ˆæ‰«æã€KMPã€ACè‡ªåŠ¨æœºã€çº¿æ€§ç­›ç´ æ•°ã€‚ n â‰¤ 10^9ï¼šO(nâˆšn)ï¼Œé€‚ç”¨äºåˆ¤æ–­è´¨æ•°ã€‚ n â‰¤ 10^18ï¼šO(logn)ï¼Œé€‚ç”¨äºæœ€å¤§å…¬çº¦æ•°ã€å¿«é€Ÿå¹‚ã€æ•°ä½DPã€‚ n â‰¤ 10^1000ï¼šO((logn)^2)ï¼Œé€‚ç”¨äºé«˜ç²¾åº¦åŠ å‡ä¹˜é™¤ã€‚ n â‰¤ 10^100000ï¼šO(logk Ã— loglogk)ï¼Œå…¶ä¸­kè¡¨ç¤ºä½æ•°ï¼Œé€‚ç”¨äºé«˜ç²¾åº¦åŠ å‡ã€FFT/NTTã€‚ åŠ¨æ€è§„åˆ’è®¡ç®—é‡ ï¼š çŠ¶æ€æ•° * çŠ¶æ€è½¬ç§»æ•°é‡\n1 Byte = 8 bit\n1KB = 1024 Byte\n1MB = 102410241024 Byte\n1GB = 1024 * 1024 * 1024 Byte\nint 4 Byte\nchar 1 Byte\ndouble, long long 8 Byte\nåŠ¨æ€è§„åˆ’ å¸¸è§æ¨¡å‹\nèƒŒåŒ… ä¹è®² 01èƒŒåŒ… æ¯ä»¶ç‰©å“æœ€å¤šå¯ä»¥ç”¨ä¸€æ¬¡\nä½“ç§¯ä»å¤§åˆ°å°çš„åŸå›  ï¼š å¦‚æœä»å°åˆ°å¤§ï¼Œåˆ™f[j-w[i]]+v[i]å®é™…æ˜¯f[i-1][j-w[i]]+v[i]ï¼Œéœ€è¦çš„æ˜¯ä¸Šä¸€ç»´åº¦f[i-1]ç»´åº¦ï¼Œæ‰€ä»¥ä»å¤§åˆ°å°å¯ä»¥ä½¿ç”¨ä¸Šä¸€ç»´åº¦çš„ï¼Œå› ä¸ºè¿™ä¸€ç»´åº¦çš„è¿˜æ²¡æœ‰è¢«è®¡ç®—åˆ°ã€‚\nfor(int i=1;i\u0026lt;=N;i++){ for(int j=V;j\u0026gt;=w[i];j--){ f[j]=max(f[j],f[j-w[i]]+v[i]); } } å®Œå…¨èƒŒåŒ… æ¯ä»¶ç‰©å“å¯ä»¥ç”¨æ— é™æ¬¡\nfor(int i=1;i\u0026lt;=N;i++){ for(int j=w[i];j\u0026lt;=V;j++){ f[j]=max(f[j],f[j-w[i]]+v[i]); } } å¤šé‡èƒŒåŒ… æ¯ä»¶ç‰©å“ç‰¹å®šæ•°é‡\näºŒè¿›åˆ¶ä¼˜åŒ– for(int i=1;i\u0026lt;=N;i++){ cin\u0026gt;\u0026gt;a\u0026gt;\u0026gt;b\u0026gt;\u0026gt;c; //æƒé‡a,ä»·å€¼bï¼Œæ•°é‡c int k=1; while(k\u0026lt;=c){ cnt++; c-=k; w[cnt]=k*a; v[cnt]=k*b; k*=2; } if(c){ cnt++; w[cnt]=c*a; v[cnt]=c*b; } } //ä¹‹åç”¨01èƒŒåŒ… å•è°ƒé˜Ÿåˆ—ä¼˜åŒ– for(int i=1;i\u0026lt;=N;i++){ // éå†æ¯ä»¶ç‰©å“ memcpy(g, f, sizeof g); // å°†ä¸Šä¸€è½®çš„æœ€ä¼˜è§£æ‹·è´ç»™gæ•°ç»„ for(int r=0;r\u0026lt;v[i];r++){ // éå†ä½™æ•°rï¼ˆç”¨äºä¼˜åŒ–å¾ªç¯ï¼‰ int h=0,t=-1; // æ»‘åŠ¨çª—å£çš„èµ·å§‹ç´¢å¼•å’Œç»“æŸç´¢å¼• for(int l=r;l\u0026lt;=V;l+=v[i]){ // éå†èƒŒåŒ…å®¹é‡ï¼Œé—´éš”ä¸ºå½“å‰ç‰©å“ä½“ç§¯ while(h\u0026lt;=t \u0026amp;\u0026amp; l-q[h]\u0026gt;s[i]*v[i]) h++; // å¦‚æœçª—å£å·¦è¾¹ç•Œè¶…å‡ºé™åˆ¶ï¼Œåˆ™å·¦è¾¹ç•Œå³ç§» while(h\u0026lt;=t \u0026amp;\u0026amp; g[q[t]] + (l-q[t])/v[i]*w[i]\u0026lt;=g[l]) t--; // ä¿æŒçª—å£å•è°ƒæ€§ï¼Œå°†çª—å£å†…ä¸ç¬¦åˆæ¡ä»¶çš„è§£ç§»é™¤ q[++t] = l; // å°†å½“å‰çŠ¶æ€çš„èƒŒåŒ…å®¹é‡åŠ å…¥çª—å£ f[l] = g[q[h]] + (l-q[h])/v[i]*w[i]; // æ›´æ–°å½“å‰çŠ¶æ€çš„æœ€ä¼˜è§£ } } } åˆ†ç»„èƒŒåŒ… è‹¥å¹²ç»„ï¼Œä¸€ç»„åªèƒ½é€‰ä¸€ä¸ª\nfor(int i=1;i\u0026lt;=N;i++){ for(int j=V;j\u0026gt;=0;j--){ for(int k=1;k\u0026lt;=s[i];k++){ if(w[i][k]\u0026lt;=j){ f[j]=max(f[j],f[j- w[i][k] ]+v[i][k]); } } } } æ··åˆèƒŒåŒ… è½¬æ¢æˆ01èƒŒåŒ…é—®é¢˜\nfor(int i=1;i\u0026lt;=N;i++){ cin\u0026gt;\u0026gt;a\u0026gt;\u0026gt;b\u0026gt;\u0026gt;s; if(s==-1) s=1; else if(s==0) s=V/a; k=1; while(k\u0026lt;=s){ s-=k; cnt++; v[cnt] = k*a; w[cnt] = k*b; k*=2; } if(s){ cnt++; v[cnt] = s*a; w[cnt] = s*b; } } for(int i=1;i\u0026lt;=cnt;i++){ for(int j=V;j\u0026gt;=v[i];j--){ f[j] = max(f[j], f[j-v[i]]+w[i]); } } äºŒç»´è´¹ç”¨çš„èƒŒåŒ…é—®é¢˜ é‡‡ç”¨ä¸¤å±‚å¾ªç¯\ncin\u0026gt;\u0026gt;N\u0026gt;\u0026gt;V\u0026gt;\u0026gt;W; for(int i=1;i\u0026lt;=N;i++){ cin\u0026gt;\u0026gt;v\u0026gt;\u0026gt;m\u0026gt;\u0026gt;w; for(int j=V;j\u0026gt;=v;j--){ for(int k=W;k\u0026gt;=m;k--){ f[j][k] = max(f[j][k], f[j-v][k-m] + w); } } } cout\u0026lt;\u0026lt;f[V][W]\u0026lt;\u0026lt;endl; çº¿æ€§dp æ•°å­—ä¸‰è§’å½¢ for(int i=1;i\u0026lt;=n;i++){ for(int j=1;j\u0026lt;=i;j++){ a[i][j]+=max(a[i-1][j],a[i-1][j-1]); } } LIS for(int i=1;i\u0026lt;=n;i++){ for(int j=1;j\u0026lt;i;j++){ if(a[j]\u0026lt;a[i]) f[i]=max(f[j]+1,f[i]); } } for(int i=1;i\u0026lt;=n;i++){ ma=max(f[i],ma); } LCS for(int i=1;i\u0026lt;=n;i++){ for(int j=1;j\u0026lt;=m;j++){ f[i][j]=max(f[i-1][j],f[i][j-1]); if(a[i]==b[j]) f[i][j]=f[i-1][j-1]+1; } } åŒºé—´dp çŸ³å­åˆå¹¶ memset(f, 0x3f, sizeof f); for(int len=2;len\u0026lt;=n;len++){ for(int i=1;i+len-1\u0026lt;=n;i++){ int j=i+len-1; if (len == 1) { f[i][j] = 0; // è¾¹ç•Œåˆå§‹åŒ– continue; } for(int k=i;k\u0026lt;j;k++){ f[l][r]=min(f[l][r],f[l][k]+f[k+1][r]+s[r]-s[l-1]); } } } cout\u0026lt;\u0026lt;f[1][n]; æ•°ä½ç»Ÿè®¡dp çŠ¶æ€è¡¨ç¤º\nåˆ†æƒ…å†µè®¨è®º\nçŠ¶æ€å‹ç¼© dp è’™å¾·é‡Œå®‰çš„æ¢¦æƒ³\næœ€çŸ­Hamiltonè·ç¦»\næ ‘å½¢dp æ²¡æœ‰ä¸Šå¸çš„èˆä¼š\nè®°å¿†åŒ– æ»‘é›ª\n#include\u0026lt;bits/stdc++.h\u0026gt; using namespace std; #define ll long long const int maxn=1e4; ll f[maxn][maxn],g[maxn][maxn]; //distance struct node{ ll i,j,num; }a[maxn]; struct cmp { bool operator () (node x,node y){ return x.num\u0026gt;y.num; } }; int main() { ios::sync_with_stdio(false); cin.tie(0); cout.tie(0); ll n,m,ma=-1; cin\u0026gt;\u0026gt;n\u0026gt;\u0026gt;m; priority_queue\u0026lt;node, vector\u0026lt;node\u0026gt;,cmp\u0026gt;pq; for(ll i=1;i\u0026lt;=n;i++){ for(ll j=1;j\u0026lt;=m;j++){ f[i][j]=1; node a; a.i=i; a.j=j; cin\u0026gt;\u0026gt;a.num; g[i][j]=a.num; pq.push(a); } } while(!pq.empty()){ node t=pq.top(); pq.pop(); ll i=t.i; ll j=t.j; ll nu=t.num; if(g[i-1][j]\u0026lt;nu) f[i][j]=max(f[i][j],f[i-1][j]+1); if(g[i+1][j]\u0026lt;nu) f[i][j]=max(f[i][j],f[i+1][j]+1); if(g[i][j-1]\u0026lt;nu) f[i][j]=max(f[i][j],f[i][j-1]+1); if(g[i][j+1]\u0026lt;nu) f[i][j]=max(f[i][j],f[i][j+1]+1); ma=max(ma,f[i][j]); } cout\u0026lt;\u0026lt;ma\u0026lt;\u0026lt;endl; return 0; } ä¹ é¢˜è¯¾ ","permalink":"https://kennems.github.io/posts/tech/acwing/","summary":"Acwingç®—æ³•å­¦ä¹  [TOC] ç¬¬ä¸€ç«  è¯¾ä¸Šï¼šå­¦æ€æƒ³ è¯¾ä¸‹ï¼šèƒŒä»£ç  é¢˜ç›®ï¼Œä¸€é“é¢˜å†™å¥½å‡ é ç†è§£æ²¡æœ‰ä»»ä½•æ„ä¹‰ï¼Œä½“åŠ›æ´»+è„‘åŠ›æ´» è®°å¿†åŠ› æ¯…åŠ›/è‡ªåˆ¶åŠ› æ²‰ä¸‹å¿ƒèƒŒä¸œè¥¿ å¿«é€Ÿæ’","title":"Acwingç®—æ³•å­¦ä¹ "},{"content":"ç®—æ³•ç¬”è®°ï¼ˆäºŒï¼‰â€”â€”æ•°æ®ç»“æ„(Pythonå®ç°) æ•°æ®ç»“æ„ å•é“¾è¡¨ N = int(1e5+10) e=[0]*N ne=[0]*N head=-1 idx=1 def insert(x): global idx, head e[idx]=x ne[idx]=head head=idx idx+=1 def add(k, x): global idx e[idx]=x ne[idx]=ne[k] ne[k]=idx idx+=1 def remove(k): global idx, head if k==0: head = ne[head] else: ne[k]=ne[ne[k]] n = int(input()) for _ in range(n): s = input().split() op=s[0] if op==\u0026#39;H\u0026#39;: insert(int(s[1])) elif op==\u0026#39;I\u0026#39;: add(int(s[1]), int(s[2])) else: remove(int(s[1])) i=head while i!=-1: print(e[i], end=\u0026#39; \u0026#39;) i=ne[i] åŒé“¾è¡¨ N = int(1e5+10) e=[0]*N l=[0]*N r=[0]*N idx=0 def init(): global idx r[2]=1 l[1]=2 idx=3 def insert(k, x): global idx e[idx]=x l[idx]=k r[idx]=r[k] l[r[k]]=idx r[k]=idx idx+=1 def remove(k): l[r[k]]=l[k] r[l[k]]=r[k] init() m=int(input()) for _ in range(m): s=input().split() if s[0]==\u0026#39;L\u0026#39;: x=int(s[1]) insert(2,x) elif s[0]==\u0026#39;R\u0026#39;: x=int(s[1]) insert(l[1],x) elif s[0]==\u0026#39;D\u0026#39;: k=int(s[1])+2 remove(k) elif s[0]==\u0026#39;IL\u0026#39;: k=int(s[1])+2 x=int(s[2]) insert(l[k],x) elif s[0]==\u0026#39;IR\u0026#39;: k=int(s[1])+2 x=int(s[2]) insert(k,x) i=2 while i!=0: if i==2 or i==1: i=r[i] continue print(e[i],end=\u0026#34; \u0026#34;) i=r[i] æ ˆ N = int(1e5+10) # å‡è®¾Nçš„å€¼ä¸º100 stk = [0] * N tt = 0 # å‘æ ˆé¡¶æ’å…¥ä¸€ä¸ªæ•° tt += 1 stk[tt] = x # ä»æ ˆé¡¶å¼¹å‡ºä¸€ä¸ªæ•° tt -= 1 # æ ˆé¡¶çš„å€¼ stk[tt] # åˆ¤æ–­æ ˆæ˜¯å¦ä¸ºç©º if tt \u0026gt; 0: pass é˜Ÿåˆ— N = 100 # å‡è®¾Nçš„å€¼ä¸º100 q = [0] * N hh = 0 tt = -1 # å‘é˜Ÿå°¾æ’å…¥ä¸€ä¸ªæ•° tt += 1 q[tt] = x # ä»é˜Ÿå¤´å¼¹å‡ºä¸€ä¸ªæ•° hh += 1 # é˜Ÿå¤´çš„å€¼ q[hh] # åˆ¤æ–­é˜Ÿåˆ—æ˜¯å¦ä¸ºç©º if hh \u0026lt;= tt: pass N = 100 # å‡è®¾Nçš„å€¼ä¸º100 q = [0] * N hh = 0 tt = 0 # å‘é˜Ÿå°¾æ’å…¥ä¸€ä¸ªæ•° q[tt] = x tt += 1 if tt == N: tt = 0 # ä»é˜Ÿå¤´å¼¹å‡ºä¸€ä¸ªæ•° hh += 1 if hh == N: hh = 0 # é˜Ÿå¤´çš„å€¼ q[hh] # åˆ¤æ–­é˜Ÿåˆ—æ˜¯å¦ä¸ºç©º if hh != tt: pass å•è°ƒæ ˆ tt = 0 stk = [0] * (n + 1) for i in range(1, n + 1): while tt and check(stk[tt], i): tt -= 1 stk[tt + 1] = i tt += 1 å•è°ƒé˜Ÿåˆ— n = 10 # å‡è®¾nçš„å€¼ä¸º10 hh = 0 tt = -1 q = [0] * n for i in range(n): while hh \u0026lt;= tt and check_out(q[hh]): hh += 1 while hh \u0026lt;= tt and check(q[tt], i): tt -= 1 q[tt + 1] = i tt += 1 N = int(1e6+10) q=[0 for _ in range(N)] n,k=map(int, input().split()) a=[0]+[int(x) for x in input().split()] hh,tt=0,-1 for i in range(1,n+1): if hh\u0026lt;=tt and i-q[hh]+1\u0026gt;k: hh+=1 while hh\u0026lt;=tt and a[q[tt]] \u0026gt;= a[i]: tt-=1 tt+=1 q[tt]=i if i \u0026gt;= k: print(a[q[hh]], end=\u0026#34; \u0026#34;) print() hh,tt=0,-1 for i in range(1,n+1): if hh\u0026lt;=tt and i-q[hh]+1\u0026gt;k: hh+=1 while hh\u0026lt;=tt and a[q[tt]] \u0026lt;= a[i]: tt-=1 tt+=1 q[tt]=i if i\u0026gt;=k: print(a[q[hh]], end=\u0026#34; \u0026#34;) KMP m = len(p) # å‡è®¾pä¸ºæ¨¡æ¿ä¸²ï¼Œé•¿åº¦ä¸ºm n = len(s) # å‡è®¾sä¸ºæ¨¡å¼ä¸²ï¼Œé•¿åº¦ä¸ºn ne = [0] * (m + 1) # åˆå§‹åŒ–neæ•°ç»„ # æ±‚Nextæ•°ç»„ j = 0 for i in range(2, m + 1): while j and p[i] != p[j + 1]: j = ne[j] if p[i] == p[j + 1]: j += 1 ne[i] = j # åŒ¹é… j = 0 for i in range(1, n + 1): while j and s[i] != p[j + 1]: j = ne[j] if s[i] == p[j + 1]: j += 1 if j == m: j = ne[j] # åŒ¹é…æˆåŠŸåçš„é€»è¾‘ n = int(input()) p = \u0026#39; \u0026#39; + input() m = int(input()) s = \u0026#39; \u0026#39; + input() ne = [0]*(n+1) j = 0 for i in range(2, n+1): while j and p[i]!=p[j+1]: j = ne[j] if p[i]==p[j+1]: j += 1 ne[i] = j j = 0 res = [] for i in range(1, m+1): while j and s[i]!=p[j+1]: j = ne[j] if s[i]==p[j+1]: j += 1 if j==n: res.append(i-j) j = ne[j] print(*res, sep=\u0026#39; \u0026#39;) Zå‡½æ•° def z_function(s): n = len(s) z = [0] * n l, r = 0, 0 for i in range(1, n): if i \u0026lt;= r and z[i - l] \u0026lt; r - i + 1: z[i] = z[i - l] else: z[i] = max(0, r - i + 1) while i + z[i] \u0026lt; n and s[z[i]] == s[i + z[i]]: z[i] += 1 if i + z[i] - 1 \u0026gt; r: l = i r = i + z[i] - 1 return z Tire N = 100010 son = [[0] * 26 for _ in range(N)] cnt = [0] * N idx = 0 # 0å·ç‚¹æ—¢æ˜¯æ ¹èŠ‚ç‚¹ï¼Œåˆæ˜¯ç©ºèŠ‚ç‚¹ # son[][]å­˜å‚¨æ ‘ä¸­æ¯ä¸ªèŠ‚ç‚¹çš„å­èŠ‚ç‚¹ # cnt[]å­˜å‚¨ä»¥æ¯ä¸ªèŠ‚ç‚¹ç»“å°¾çš„å•è¯æ•°é‡ # æ’å…¥ä¸€ä¸ªå­—ç¬¦ä¸² def insert(s): global idx p = 0 for i in range(len(s)): u = ord(s[i]) - ord(\u0026#39;a\u0026#39;) if not son[p][u]: idx += 1 son[p][u] = idx p = son[p][u] cnt[p] += 1 # æŸ¥è¯¢å­—ç¬¦ä¸²å‡ºç°çš„æ¬¡æ•° def query(s): p = 0 for i in range(len(s)): u = ord(s[i]) - ord(\u0026#39;a\u0026#39;) if not son[p][u]: return 0 p = son[p][u] return cnt[p] é©¬æ‹‰è½¦ï¼ˆå­—ç¬¦ä¸²å›æ–‡ä¸²ç®—æ³•ï¼‰ class Solution: # æ¨èæ•™å­¦è§†é¢‘ ï¼šhttps://www.bilibili.com/video/BV1Sx4y1k7jG/?spm_id_from=333.337.search-card.all.click\u0026amp;vd_source=a4a2b56f746715b34521bfb853094cf4 def longestPalindrome(self, s: str) -\u0026gt; str: s = \u0026#39;#\u0026#39; + \u0026#39;#\u0026#39;.join(list(s)) + \u0026#39;#\u0026#39; n = len(s) p = [0]*n #æ¯ä¸ªç‚¹çš„ æœ€é•¿å›æ–‡å­—ä¸² èƒ½åˆ°çš„ ä¸¤ä¾§é•¿åº¦ c, r = 0, 0 # å³è¾¹èƒ½åˆ°è¾¾æœ€è¿œçš„è˜‘è‡çš„ä½ç½® å’Œ å…¶æœ€å³è¾¹èƒ½è¾¾åˆ°çš„ä½ç½® for i in range(n): if i\u0026lt;=r: p[i] = min(r-i, p[c + c-i]) # ç”±å·²çŸ¥æ¡ä»¶å¾—åˆ°å½“å‰ä½ç½®èƒ½è¾¾åˆ°çš„æœ€å¤§å³ä¾§è·ç¦»( éœ€è¦å–min(é•œåƒä½ç½®çš„å€¼, å½“å‰æœ€å¤§è˜‘è‡èƒ½è¦†ç›–åˆ°çš„æœ€å¤§å€¼) ) while i+p[i]+1 \u0026lt; n and s[i-p[i]-1] == s[i+p[i]+1]: p[i]+=1 if p[i]+i \u0026gt; r: r = p[i] + i c = i ma = max(p) idx = p.index(ma) return s[idx-ma+1:idx+ma+1:2] å¹¶æŸ¥é›† N = 1000005 # å‡è®¾Nçš„å€¼ä¸º1000005 p = [0] * N # åˆå§‹åŒ–pæ•°ç»„ # è¿”å›xçš„ç¥–å®—èŠ‚ç‚¹ def find(x): if p[x] != x: p[x] = find(p[x]) return p[x] \u0026#39;\u0026#39;\u0026#39; éé€’å½’å†™æ³• def find(x): while p[x]!=x: p[x] = p[p[x]] x = p[x] return x \u0026#39;\u0026#39;\u0026#39; # åˆå§‹åŒ–ï¼Œå‡å®šèŠ‚ç‚¹ç¼–å·æ˜¯1~n for i in range(1, n + 1): p[i] = i # åˆå¹¶aå’Œbæ‰€åœ¨çš„ä¸¤ä¸ªé›†åˆ p[find(a)] = find(b) ç»´æŠ¤sizeä¿¡æ¯\n# Pythonä¸­æ²¡æœ‰ç±»ä¼¼äºC++çš„æ•°ç»„å£°æ˜æ–¹å¼ï¼Œæˆ‘ä»¬ç›´æ¥ä½¿ç”¨åˆ—è¡¨æ¥ä»£æ›¿ p = [i for i in range(N)] size = [1] * N # è¿”å›xçš„ç¥–å®—èŠ‚ç‚¹ def find(x): if p[x] != x: p[x] = find(p[x]) return p[x] # åˆå§‹åŒ–ï¼Œå‡å®šèŠ‚ç‚¹ç¼–å·æ˜¯1~n n = N # å‡è®¾næ˜¯æå‰å®šä¹‰å¥½çš„ for i in range(1, n + 1): p[i] = i size[i] = 1 # åˆå¹¶aå’Œbæ‰€åœ¨çš„ä¸¤ä¸ªé›†åˆ p[find(a)] = find(b) size[b] += size[a] ç»´æŠ¤åˆ°ç¥–å®—èŠ‚ç‚¹è·ç¦»çš„å¹¶æŸ¥é›†\n# Pythonä¸­æ²¡æœ‰ç±»ä¼¼äºC++çš„æ•°ç»„å£°æ˜æ–¹å¼ï¼Œæˆ‘ä»¬ç›´æ¥ä½¿ç”¨åˆ—è¡¨æ¥ä»£æ›¿ p = [i for i in range(N)] d = [0] * N # è¿”å›xçš„ç¥–å®—èŠ‚ç‚¹ def find(x): if p[x] != x: u = find(p[x]) d[x] += d[p[x]] p[x] = u return p[x] # åˆå§‹åŒ–ï¼Œå‡å®šèŠ‚ç‚¹ç¼–å·æ˜¯1~n n = N # å‡è®¾næ˜¯æå‰å®šä¹‰å¥½çš„ for i in range(1, n + 1): p[i] = i d[i] = 0 # åˆå¹¶aå’Œbæ‰€åœ¨çš„ä¸¤ä¸ªé›†åˆ p[find(a)] = find(b) d[find(a)] = distance # æ ¹æ®å…·ä½“é—®é¢˜ï¼Œåˆå§‹åŒ–find(a)çš„åç§»é‡ é¢˜ç›®å¤§æ„\nAlice å’Œ Bob ç©äº†ä¸€ä¸ªå¤è€çš„æ ¼å­æ¸¸æˆã€‚æ¸¸æˆåœ¨ä¸€ä¸ª nÃ—n çš„ç‚¹é˜µä¸Šè¿›è¡Œï¼Œç©å®¶è½®æµåœ¨ç›¸é‚»çš„ç‚¹ä¹‹é—´ç”»çº¿ï¼Œåˆ†åˆ«æ˜¯çº¢è¾¹å’Œè“è¾¹ã€‚ç©å®¶åœ¨ç”»å‡ºä¸€æ¡å°é—­çš„åœˆï¼ˆé¢ç§¯ä¸é™ï¼‰æ—¶æ¸¸æˆç»“æŸï¼Œè¯¥ç©å®¶è·èƒœã€‚é¢˜ç›®è¦æ±‚åˆ¤æ–­æ¸¸æˆåœ¨ç¬¬å‡ æ­¥ç»“æŸï¼ˆå³ç”»å‡ºå°é—­åœˆï¼‰ï¼Œè‹¥ m æ­¥ä¹‹åä¹Ÿæ²¡æœ‰ç»“æŸï¼Œåˆ™è¾“å‡º \u0026ldquo;draw\u0026rdquo;ã€‚ å®ç°æ€è·¯\nè¾“å…¥ä¸åˆå§‹åŒ–ï¼šè¯»å–è¾“å…¥çš„ç‚¹é˜µå¤§å° n å’Œå·²ç”»çš„ m æ¡è¾¹ã€‚åˆå§‹åŒ–ä¸€ä¸ªæ•°ç»„ p ä½œä¸ºå¹¶æŸ¥é›†ï¼Œp[i] è¡¨ç¤ºç‚¹ i çš„çˆ¶èŠ‚ç‚¹ã€‚ å¹¶æŸ¥é›†çš„æŸ¥æ‰¾å‡½æ•°ï¼šå®šä¹‰ä¸€ä¸ª find å‡½æ•°ç”¨äºæŸ¥æ‰¾ç‚¹çš„æ ¹èŠ‚ç‚¹ï¼ŒåŒæ—¶è¿›è¡Œè·¯å¾„å‹ç¼©ä»¥ä¼˜åŒ–æŸ¥æ‰¾æ•ˆç‡ã€‚ å¤„ç†æ¯æ¡è¾¹ï¼š â€‹ å°†äºŒç»´åæ ‡è½¬æ¢ä¸ºä¸€ç»´æ ‡è¯†ã€‚ â€‹ æ ¹æ®è¾¹çš„æ–¹å‘ï¼ˆå‘å³æˆ–å‘ä¸‹ï¼‰è®¡ç®—å‡ºè¿æ¥çš„ä¸¤ä¸ªç‚¹ã€‚ â€‹ ä½¿ç”¨å¹¶æŸ¥é›†æŸ¥æ‰¾è¿™ä¸¤ä¸ªç‚¹çš„æ ¹èŠ‚ç‚¹ï¼Œåˆ¤æ–­å®ƒä»¬æ˜¯å¦å±äºåŒä¸€ä¸ªé›†åˆã€‚å¦‚æœæ˜¯åŒä¸€ä¸ªé›†åˆï¼Œåˆ™è¯´æ˜å½¢æˆäº†å°é—­åœˆï¼Œè¾“å‡ºå½“å‰æ­¥éª¤å¹¶ç»“æŸç¨‹åºã€‚ â€‹ å¦‚æœä¸å±äºåŒä¸€ä¸ªé›†åˆï¼Œåˆ™å°†ä¸¤ä¸ªç‚¹åˆå¹¶ã€‚ è¾“å‡ºç»“æœï¼šå¦‚æœéå†å®Œæ‰€æœ‰è¾¹åä»æœªå½¢æˆå°é—­åœˆï¼Œåˆ™è¾“å‡º \u0026ldquo;draw\u0026rdquo;ã€‚ from sys import stdin input = lambda:stdin.readline().strip() def find(x): while p[x] != x: p[x] = p[p[x]] x = p[x] return x n, m = map(int, input().split()) p = [i for i in range(n*n+1)] for i in range(1, m+1): x, y, op = input().split() x, y = map(int, (x, y)) a = (x-1)*n + y - 1 if op==\u0026#39;D\u0026#39;: b = x*n + y - 1 else: b = (x-1)*n + y pa, pb = find(a), find(b) if pa == pb: print(i) exit() p[pa] = pb print(\u0026#39;draw\u0026#39;) å † # h[N] å­˜å‚¨å †ä¸­çš„å€¼, h[1]æ˜¯å †é¡¶ï¼Œxçš„å·¦å„¿å­æ˜¯2x, å³å„¿å­æ˜¯2x + 1 # ph pos[k] å­˜å‚¨ç¬¬kä¸ªæ’å…¥çš„ç‚¹åœ¨å †ä¸­çš„ä½ç½® # hp ord[k] å­˜å‚¨å †ä¸­ä¸‹æ ‡æ˜¯kçš„ç‚¹æ˜¯ç¬¬å‡ ä¸ªæ’å…¥çš„ N = 1000005 # å‡è®¾Nçš„å€¼ä¸º1000005 h = [0] * N # åˆå§‹åŒ–hæ•°ç»„ ph = [0] * N # åˆå§‹åŒ–phæ•°ç»„ hp = [0] * N # åˆå§‹åŒ–hpæ•°ç»„ size = 0 # åˆå§‹åŒ–sizeä¸º0 # äº¤æ¢ä¸¤ä¸ªç‚¹ï¼ŒåŠå…¶æ˜ å°„å…³ç³» def heap_swap(a, b): ph[hp[a]], ph[hp[b]] = ph[hp[b]], ph[hp[a]] hp[a], hp[b] = hp[b], hp[a] h[a], h[b] = h[b], h[a] def down(u): t = u if u * 2 \u0026lt;= size and h[u * 2] \u0026lt; h[t]: t = u * 2 if u * 2 + 1 \u0026lt;= size and h[u * 2 + 1] \u0026lt; h[t]: t = u * 2 + 1 if u != t: heap_swap(u, t) down(t) def up(u): while u // 2 and h[u] \u0026lt; h[u // 2]: heap_swap(u, u // 2) u \u0026gt;\u0026gt;= 1 # O(n)å»ºå † for i in range(n // 2, 0, -1): down(i) def add_element(x): global size size += 1 h[size] = x ph[size] = size hp[size] = size up(size) def get_heap_top(): return h[1] def delete_element(k): global size heap_swap(k, size) size -= 1 down(k) up(k) def update_element(k, x): h[k] = x down(k) up(k) # æ·»åŠ å…ƒç´  add_element(x) # å †é¡¶å…ƒç´  heap_top = get_heap_top() # åˆ é™¤ç¬¬sizeä¸ªèŠ‚ç‚¹ delete_element(1) # åˆ é™¤ç¬¬kä¸ªèŠ‚ç‚¹ delete_element(k) # å°†ç¬¬kä¸ªå…ƒç´ èµ‹å€¼ä¸ºx update_element(k, x) import sys from heapq import * input = lambda:sys.stdin.readline().strip() n = int(input()) cnt = 1 d = dict() h = [] for i in range(n): op = input().split() if op[0]==\u0026#39;I\u0026#39;: v = int(op[1]) heappush(h, v) d[cnt] = v; cnt+=1 elif op[0]==\u0026#39;D\u0026#39;: k = int(op[1]) if d[k]==0: continue v = d[k]; d[k]=0 h.remove(v) heapify(h) elif op[0]==\u0026#39;C\u0026#39;: k = int(op[1]) x = int(op[2]) if d[k]==0: continue v = d[k]; d[k]=x h.remove(v) heapify(h) heappush(h, x) elif op[0]==\u0026#39;DM\u0026#39;: heappop(h) elif op[0]==\u0026#39;PM\u0026#39;: print(h[0]) åŠ¨æ€ä¸­ä½æ•° import sys from heapq import * input = lambda:sys.stdin.readline().strip() p = int(input()) for _ in range(p): id, m = map(int, input().split()) print(id, (m+1)//2) cnt1, cnt2 = 0, 0 hl, hu = [], [] while m: a = list(map(int, input().split())) m -= len(a) for i in range(len(a)): if len(hl)==0 or len(hl)==len(hu): heappush(hu, -a[i]) tmp = -heappop(hu) heappush(hl, tmp) else: heappush(hl, a[i]) tmp = heappop(hl) heappush(hu, -tmp) cnt1+=1 if cnt1\u0026amp;1: print(hl[0], end=\u0026#34; \u0026#34;) cnt2+=1 if cnt2%10==0 and m!=0: print() print() å“ˆå¸Œ (1)æ‹‰é“¾æ³• N = 1000005 # å‡è®¾Nçš„å€¼ä¸º1000005 h = [-1] * N # åˆå§‹åŒ–hæ•°ç»„ä¸º-1 e = [0] * N # åˆå§‹åŒ–eæ•°ç»„ ne = [0] * N # åˆå§‹åŒ–neæ•°ç»„ idx = 0 # åˆå§‹åŒ–idxä¸º0 # å‘å“ˆå¸Œè¡¨ä¸­æ’å…¥ä¸€ä¸ªæ•° def insert(x): k = (x % N + N) % N e[idx] = x ne[idx] = h[k] h[k] = idx idx += 1 # åœ¨å“ˆå¸Œè¡¨ä¸­æŸ¥è¯¢æŸä¸ªæ•°æ˜¯å¦å­˜åœ¨ def find(x): k = (x % N + N) % N i = h[k] while i != -1: if e[i] == x: return True i = ne[i] return False N = 100003 e, ne, h = [0]*N, [0]*N, [-1]*N idx = 0 def insert(x): global idx k = (x%N + N)%N e[idx] = x ne[idx] = h[k] h[k] = idx idx+=1 def query(x): k = (x%N + N)%N i = h[k] while i!=-1: if e[i]==x: return True i = ne[i] return False n = int(input()) for i in range(n): s = input().split() op, k = s[0], int(s[1]) if op==\u0026#39;I\u0026#39;: insert(k) else: if query(k): print(\u0026#34;Yes\u0026#34;) else: print(\u0026#34;No\u0026#34;) (2) å¼€æ”¾å¯»å€æ³• N = 1000005 # å‡è®¾Nçš„å€¼ä¸º1000005 h = [0] * N # åˆå§‹åŒ–hæ•°ç»„ # å¦‚æœxåœ¨å“ˆå¸Œè¡¨ä¸­ï¼Œè¿”å›xçš„ä¸‹æ ‡ï¼›å¦‚æœxä¸åœ¨å“ˆå¸Œè¡¨ä¸­ï¼Œè¿”å›xåº”è¯¥æ’å…¥çš„ä½ç½® def find(x): t = (x % N + N) % N while h[t] != 0 and h[t] != x: t += 1 if t == N: t = 0 return t å­—ç¬¦ä¸²å“ˆå¸Œ è¿™æ®µä»£ç å®ç°äº†å­—ç¬¦ä¸²çš„å“ˆå¸Œç®—æ³•ï¼Œç”¨äºå¿«é€Ÿè®¡ç®—å­ä¸²çš„å“ˆå¸Œå€¼ã€‚ä¸‹é¢æˆ‘æ¥è§£é‡Šä¸€ä¸‹ï¼š\né¢˜ç›®å¤§æ„ï¼š è¿™æ®µä»£ç å®ç°äº†å­—ç¬¦ä¸²å“ˆå¸Œç®—æ³•ï¼Œå¯ä»¥ç”¨äºå¿«é€Ÿè®¡ç®—ç»™å®šå­—ç¬¦ä¸²ä¸­ä»»æ„å­ä¸²çš„å“ˆå¸Œå€¼ã€‚\nå®ç°æ€è·¯ï¼š\né¦–å…ˆå®šä¹‰äº†ä¸¤ä¸ªæ•°ç»„ h å’Œ pï¼Œåˆ†åˆ«ç”¨äºå­˜å‚¨å­—ç¬¦ä¸²çš„å“ˆå¸Œå€¼å’Œå¹‚æ¬¡å€¼ã€‚ å¯¹äºå­—ç¬¦ä¸²çš„æ¯ä¸ªä½ç½®ï¼Œè®¡ç®—å…¶å¯¹åº”çš„å“ˆå¸Œå€¼å¹¶å­˜å‚¨åœ¨æ•°ç»„ h ä¸­ã€‚åŒæ—¶è®¡ç®—å¹‚æ¬¡å€¼å¹¶å­˜å‚¨åœ¨æ•°ç»„ p ä¸­ã€‚ å­—ç¬¦ä¸²çš„å“ˆå¸Œå€¼ç”±ä»¥ä¸‹å…¬å¼è®¡ç®—å¾—åˆ°ï¼š$h[i] = h[i - 1] \\times P + \\text{ord}(str[i])$å…¶ä¸­ï¼Œ$P$æ˜¯ä¸€ä¸ªé¢„å…ˆå®šä¹‰çš„è´¨æ•°ï¼ˆä¾‹å¦‚ 131 æˆ– 13331ï¼‰ï¼Œ$\\text{ord}(str[i])$ è¡¨ç¤ºå­—ç¬¦ä¸²ä¸­ç¬¬ $i$ ä¸ªå­—ç¬¦çš„ ASCII å€¼ã€‚ è®¡ç®—å­ä¸² $str[l:r]$ çš„å“ˆå¸Œå€¼æ—¶ï¼Œä½¿ç”¨ä»¥ä¸‹å…¬å¼ï¼š$ \\text{get}(l, r) = h[r] - h[l - 1] \\times p[r - l + 1] $å…¶ä¸­ï¼Œ$h[r]$ æ˜¯å­ä¸²èµ·å§‹ä½ç½®åˆ°ç»“æŸä½ç½®çš„å“ˆå¸Œå€¼ï¼Œ$h[l - 1]$ æ˜¯å­ä¸²èµ·å§‹ä½ç½®å‰ä¸€ä¸ªä½ç½®çš„å“ˆå¸Œå€¼ï¼Œ$p[r - l + 1]$ æ˜¯å­ä¸²é•¿åº¦å¯¹åº”çš„å¹‚æ¬¡å€¼ã€‚ æ€»ä½“æ¥è¯´ï¼Œè¿™æ®µä»£ç å®ç°äº†å­—ç¬¦ä¸²å“ˆå¸Œç®—æ³•ï¼Œç”¨äºå¿«é€Ÿè®¡ç®—ç»™å®šå­—ç¬¦ä¸²ä¸­ä»»æ„å­ä¸²çš„å“ˆå¸Œå€¼ã€‚\nh æ•°ç»„å­˜å‚¨äº†å­—ç¬¦ä¸²çš„å“ˆå¸Œå€¼ï¼Œå³ä»å­—ç¬¦ä¸²çš„èµ·å§‹ä½ç½®åˆ°å½“å‰ä½ç½®çš„å­ä¸²çš„å“ˆå¸Œå€¼ã€‚ h[i] è¡¨ç¤ºå­—ç¬¦ä¸²ä»ç¬¬ä¸€ä¸ªå­—ç¬¦åˆ°ç¬¬ i ä¸ªå­—ç¬¦ï¼ˆåŒ…æ‹¬ç¬¬ i ä¸ªå­—ç¬¦ï¼‰çš„å­ä¸²çš„å“ˆå¸Œå€¼ã€‚ p[i] è¡¨ç¤ºå¹‚æ¬¡å€¼ï¼Œå³ $P^i$ çš„å€¼ï¼Œå…¶ä¸­ $P$ æ˜¯ä¸€ä¸ªé¢„å…ˆå®šä¹‰çš„è´¨æ•°ã€‚ p æ•°ç»„å­˜å‚¨äº†å¹‚æ¬¡å€¼ï¼Œç”¨äºè®¡ç®—å­ä¸²çš„å“ˆå¸Œå€¼æ—¶ä½¿ç”¨ã€‚ import sys input = lambda:sys.stdin.readline().strip() mod = 1\u0026lt;\u0026lt;64 def get(l, r): return (h[r] - h[l-1]*p[r-l+1])%mod N = int(1e5) + 10 P = 131 p = [0]*N h = [0]*N n, m = map(int, input().split()) s = \u0026#39; \u0026#39; + input() p[0] = 1 for i in range(1, n+1): h[i] = (h[i-1]*P + ord(s[i]))%mod p[i] = (p[i-1]*P)%mod for i in range(m): l1, r1, l2, r2 = map(int, input().split()) if get(l1, r1) == get(l2, r2): print(\u0026#34;Yes\u0026#34;) else: print(\u0026#34;No\u0026#34;) æ ‘çŠ¶æ•°ç»„ æ¥¼å…°å›¾è…¾\nimport sys input=lambda:sys.stdin.readline() M = 200010 suml, sumg = 0, 0 tr = [0]*M n = int(input()) a = [0]+[int(_) for _ in input().split()] def lowbit(x): return x\u0026amp;-x def add(x,v): while x\u0026lt;M: tr[x]+=v x+=lowbit(x) def query(x): res = 0 while x: res+=tr[x] x-=lowbit(x) return res for i in range(1,n+1): y=a[i] lw = query(y-1) lwr = y-1-lw # the lower element on the right side gr = query(n)-query(y) grr = (n-y) - gr suml += (lw*lwr) sumg += (gr*grr) add(y,1) print(sumg, suml) çº¿æ®µæ ‘ \\1265. æ•°æ˜Ÿæ˜Ÿ é¢˜ç›®å¤§æ„ï¼šç»™å®šä¸€äº›æ˜Ÿæ˜Ÿçš„åæ ‡ï¼Œä»¥å¹³é¢ç›´è§’åæ ‡ç³»è¡¨ç¤ºï¼Œéœ€è¦ç»Ÿè®¡æ¯ä¸ªæ˜Ÿæ˜Ÿçš„ç­‰çº§ï¼Œå³åœ¨è¯¥æ˜Ÿæ˜Ÿå·¦ä¸‹æ–¹ï¼ˆå«æ­£å·¦ã€æ­£ä¸‹ï¼‰çš„æ˜Ÿæ˜Ÿæ•°é‡ã€‚\nå®ç°æ€è·¯ï¼š\nä½¿ç”¨çº¿æ®µæ ‘æ¥ç»´æŠ¤æ¯ä¸ªæ˜Ÿæ˜Ÿçš„ç­‰çº§ã€‚ æ„å»ºçº¿æ®µæ ‘ï¼Œåˆå§‹æ—¶æ‰€æœ‰èŠ‚ç‚¹å€¼éƒ½ä¸º0ã€‚ è¯»å…¥æ¯ä¸ªæ˜Ÿæ˜Ÿçš„åæ ‡ï¼Œé€šè¿‡æŸ¥è¯¢çº¿æ®µæ ‘ç»Ÿè®¡è¯¥æ˜Ÿæ˜Ÿå·¦è¾¹ï¼ˆå«æ­£å·¦ï¼‰çš„æ˜Ÿæ˜Ÿæ•°é‡ï¼Œå³ä¸ºè¯¥æ˜Ÿæ˜Ÿçš„ç­‰çº§ã€‚ æ›´æ–°çº¿æ®µæ ‘çš„å€¼ï¼Œå°†å½“å‰æ˜Ÿæ˜Ÿçš„æ¨ªåæ ‡ä½ç½®å¯¹åº”çš„èŠ‚ç‚¹å€¼åŠ 1ã€‚ ç»Ÿè®¡æ¯ä¸ªç­‰çº§çš„æ˜Ÿæ˜Ÿæ•°é‡ï¼Œè¾“å‡ºç»“æœã€‚ import sys input = lambda:sys.stdin.readline() N = 15010 M = 32010 tr = [0]*(M*4) level = [0]*N def pushup(u): tr[u] = tr[u \u0026lt;\u0026lt; 1] + tr[u \u0026lt;\u0026lt; 1 | 1] def build(u, l, r): if l == r: tr[u] = 0 else: mid = (l + r) \u0026gt;\u0026gt; 1 build(u \u0026lt;\u0026lt; 1, l, mid) build(u \u0026lt;\u0026lt; 1 | 1, mid + 1, r) pushup(u) def query(u, l, r, ql, qr): if l \u0026gt;= ql and r \u0026lt;= qr: return tr[u] mid = (l + r) \u0026gt;\u0026gt; 1 if mid==l and mid==r: return 0 res = 0 if ql \u0026lt;= mid: res += query(u \u0026lt;\u0026lt; 1, l, mid, ql, qr) if qr \u0026gt; mid: res += query(u \u0026lt;\u0026lt; 1 | 1, mid + 1, r, ql, qr) return res def modify(u, x, l, r, val): if l == r: tr[u] += val else: mid = (l + r) \u0026gt;\u0026gt; 1 if x \u0026lt;= mid: modify(u \u0026lt;\u0026lt; 1, x, l, mid, val) else: modify(u \u0026lt;\u0026lt; 1 | 1, x, mid + 1, r, val) pushup(u) l, r = 0, 32000 build(1, l, r) n = int(input()) for i in range(n): x, _ = map(int, input().split()) t = query(1, l, r, 0, x) level[t]+=1 modify(1, x, l, r, 1) for i in range(n): print(level[i]) æœ€å¤§æ•° import sys input = lambda:sys.stdin.readline().strip() m = int(2e5)+2 tr = [0]*(m*4) def pushup(u): tr[u] = max(tr[u\u0026lt;\u0026lt;1], tr[u\u0026lt;\u0026lt;1|1]) def modify(u, l, r, x, v): if l==r: tr[u] = v else: mid = l+r\u0026gt;\u0026gt;1 if x\u0026lt;=mid: modify(u\u0026lt;\u0026lt;1, l, mid, x, v) else: modify(u\u0026lt;\u0026lt;1|1, mid+1, r, x, v) pushup(u) def query(u, l, r, ql, qr): if l\u0026gt;=ql and r\u0026lt;=qr: return tr[u] if l==r: return 0 res = 0 mid = l+r\u0026gt;\u0026gt;1 if ql\u0026lt;=mid: res = query(u\u0026lt;\u0026lt;1, l, mid, ql, qr) if qr\u0026gt;mid: res = max(res, query(u\u0026lt;\u0026lt;1|1, mid+1, r, ql, qr)) return res m, p = map(int, input().split()) n, pre = 0, 0 for i in range(m): op, x = input().split() x = int(x) if op==\u0026#39;Q\u0026#39;: pre = query(1, 1, m, n-x+1, n) print(pre) else: n += 1 modify(1, 1, m, n, (x+pre)%p) \\243. ä¸€ä¸ªç®€å•çš„æ•´æ•°é—®é¢˜2 import sys input = lambda:sys.stdin.readline().strip() N = int(1e5)+10 M = 1\u0026lt;\u0026lt;N.bit_length() + 1 tr = [0]*M add = [0]*M def pushup(u): tr[u] = tr[u\u0026lt;\u0026lt;1] + tr[u\u0026lt;\u0026lt;1|1] def pushdown(u, ln, rn): if add[u]: lazy(u\u0026lt;\u0026lt;1, add[u], ln) lazy(u\u0026lt;\u0026lt;1|1, add[u], rn) add[u] = 0 def lazy(u, v, n): tr[u] += v*n add[u] += v def build(u, l, r): if l==r: tr[u] = w[l] else: mid = l+r\u0026gt;\u0026gt;1 build(u\u0026lt;\u0026lt;1, l, mid) build(u\u0026lt;\u0026lt;1|1, mid+1, r) pushup(u) add[u] = 0 def modify(u, l, r, ml, mr, v): if l\u0026gt;=ml and r\u0026lt;=mr: lazy(u, v, r-l+1) else: mid = l+r\u0026gt;\u0026gt;1 pushdown(u, mid-l+1, r-mid) if ml \u0026lt;= mid: modify(u\u0026lt;\u0026lt;1, l, mid, ml, mr, v) if mr \u0026gt; mid: modify(u\u0026lt;\u0026lt;1|1, mid+1, r, ml, mr, v) pushup(u) def query(u, l, r, ql, qr): if l\u0026gt;=ql and r\u0026lt;=qr: return tr[u] mid = l+r\u0026gt;\u0026gt;1 pushdown(u, mid-l+1, r-mid) res = 0 if ql\u0026lt;=mid: res = query(u\u0026lt;\u0026lt;1, l, mid, ql, qr) if qr\u0026gt;mid: res += query(u\u0026lt;\u0026lt;1|1, mid+1, r, ql, qr) return res # ä¸»ç¨‹åºå¼€å§‹ n, m = map(int, input().split()) # è¾“å…¥èŠ‚ç‚¹æ•°é‡nå’Œæ“ä½œæ•°é‡m w = list(map(int, input().split())) # è¾“å…¥èŠ‚ç‚¹çš„åˆå§‹æƒå€¼ build(1, 0, n-1) res = [] # å­˜å‚¨æŸ¥è¯¢ç»“æœ while m: m -= 1 op, opt = input().split(maxsplit=1) if op == \u0026#39;Q\u0026#39;: l, r = map(int, opt.split()) l-=1; r-=1 res.append(str(query(1, 0, n-1, l, r))) # æŸ¥è¯¢åŒºé—´å’Œå¹¶å°†ç»“æœæ·»åŠ åˆ°resåˆ—è¡¨ä¸­ else: l, r, val = map(int, opt.split()) l-=1; r-=1 modify(1, 0, n-1, l, r, val) # ä¿®æ”¹åŒºé—´çš„å€¼ print(\u0026#34;\\n\u0026#34;.join(res)) # è¾“å‡ºæŸ¥è¯¢ç»“æœ ç»´æŠ¤åºåˆ— é¢˜ç›®å¤§æ„ï¼šç»™å®šä¸€ä¸ªé•¿åº¦ä¸º n çš„æ•°åˆ— ğ‘ğ‘–ï¼Œæœ‰ä¸‰ç§æ“ä½œï¼š1. æ ¼å¼1 t g cï¼Œå°†åŒºé—´ [t, g] å†…çš„æ•°ä¹˜ä»¥ cï¼›2. æ ¼å¼2 t g cï¼Œå°†åŒºé—´ [t, g] å†…çš„æ•°åŠ ä¸Š cï¼›3. æ ¼å¼3 t gï¼Œæ±‚åŒºé—´ [t, g] å†…æ•°çš„å’Œï¼Œå¹¶è¾“å‡ºç»“æœæ¨¡ p çš„å€¼ã€‚\nå®ç°æ€è·¯ï¼š\nä½¿ç”¨çº¿æ®µæ ‘æ¥ç»´æŠ¤åŒºé—´å’Œï¼Œæ¯ä¸ªèŠ‚ç‚¹ä¿å­˜åŒºé—´å†…æ•°çš„å’Œã€‚ å¯¹äºæ¯ç§æ“ä½œï¼Œæ ¹æ®æ“ä½œç±»å‹åˆ†åˆ«è¿›è¡Œå¤„ç†ã€‚ å¯¹äºæ ¼å¼1å’Œæ ¼å¼2ï¼Œé‡‡ç”¨å»¶è¿Ÿæ ‡è®°æ¥å®ç°åŒºé—´ä¿®æ”¹ã€‚å¯¹äºæ ¼å¼3ï¼Œé‡‡ç”¨é€’å½’çš„æ–¹å¼æŸ¥è¯¢åŒºé—´å’Œã€‚ å®ç°å…·ä½“çš„æ“ä½œå‡½æ•°ï¼ŒåŒ…æ‹¬å»ºæ ‘ã€ä¿®æ”¹å’ŒæŸ¥è¯¢ã€‚ å¾ªç¯è¯»å…¥æ¯ä¸ªæ“ä½œå¹¶è¿›è¡Œå¤„ç†ï¼Œæœ€åè¾“å‡ºæŸ¥è¯¢ç»“æœã€‚ import sys input = lambda: sys.stdin.readline().strip() N = int(1e5) + 1 M = 1 \u0026lt;\u0026lt; N.bit_length() + 1 tr = [0] * M add = [0] * M mul = [0] * M def lazy(u, n, ad, mu): tr[u] = (tr[u] * mu + n * ad) % p add[u] = (add[u] * mu + ad) % p mul[u] = (mul[u] * mu) % p def pushup(u): tr[u] = tr[u \u0026lt;\u0026lt; 1] + tr[u \u0026lt;\u0026lt; 1 | 1] def pushdown(u, ln, rn): if add[u] != 0 or mul[u] != -1: lazy(u \u0026lt;\u0026lt; 1, ln, add[u], mul[u]) lazy(u \u0026lt;\u0026lt; 1 | 1, rn, add[u], mul[u]) add[u] = 0 mul[u] = 1 def build(u, l, r): if l == r: tr[u] = w[l] else: mid = l + r \u0026gt;\u0026gt; 1 build(u \u0026lt;\u0026lt; 1, l, mid) build(u \u0026lt;\u0026lt; 1 | 1, mid + 1, r) pushup(u) add[u] = 0 mul[u] = 1 def modify(u, l, r, ml, mr, ad, mu): if l \u0026gt;= ml and r \u0026lt;= mr: lazy(u, r - l + 1, ad, mu) else: mid = l + r \u0026gt;\u0026gt; 1 pushdown(u, mid - l + 1, r - mid) if ml \u0026lt;= mid: modify(u \u0026lt;\u0026lt; 1, l, mid, ml, mr, ad, mu) if mr \u0026gt; mid: modify(u \u0026lt;\u0026lt; 1 | 1, mid + 1, r, ml, mr, ad, mu) pushup(u) def query(u, l, r, ql, qr): if l \u0026gt;= ql and r \u0026lt;= qr: return tr[u] mid = l + r \u0026gt;\u0026gt; 1 pushdown(u, mid - l + 1, r - mid) res = 0 if ql \u0026lt;= mid: res += query(u \u0026lt;\u0026lt; 1, l, mid, ql, qr) if qr \u0026gt; mid: res += query(u \u0026lt;\u0026lt; 1 | 1, mid + 1, r, ql, qr) return res % p n, p = map(int, input().split()) w = [0] + list(map(int, input().split())) m = int(input()) build(1, 1, n) res = [] for i in range(m): op, par = input().split(maxsplit=1) if op == \u0026#34;1\u0026#34;: l, r, mu = map(int, par.split()) modify(1, 1, n, l, r, 0, mu) elif op == \u0026#34;2\u0026#34;: l, r, ad = map(int, par.split()) modify(1, 1, n, l, r, ad, 1) else: l, r = map(int, par.split()) res.append(str(query(1, 1, n, l, r))) print(*res, sep=\u0026#34;\\n\u0026#34;) \\246. åŒºé—´æœ€å¤§å…¬çº¦æ•° from math import gcd from sys import stdin input = stdin.readline def pushup(u): tr[u] = tr[u\u0026lt;\u0026lt;1] + tr[u\u0026lt;\u0026lt;1|1] gd[u] = gcd(gd[u\u0026lt;\u0026lt;1], gd[u\u0026lt;\u0026lt;1|1]) def build(u, l, r): if l==r: tr[u] = gd[u] = arr[l]-arr[l-1] else: mid = l+r\u0026gt;\u0026gt;1 build(u\u0026lt;\u0026lt;1, l, mid) build(u\u0026lt;\u0026lt;1|1, mid+1, r) pushup(u) def modify(u, l, r, x, v): if l==r: tr[u] += v gd[u] += v else: mid = l+r\u0026gt;\u0026gt;1 if x\u0026lt;=mid: modify(u\u0026lt;\u0026lt;1, l, mid, x, v) else: modify(u\u0026lt;\u0026lt;1|1, mid+1, r, x, v) pushup(u) def query(u, l, r, ql, qr): if l\u0026gt;=ql and r\u0026lt;=qr: return (tr[u], gd[u]) mid = l+r\u0026gt;\u0026gt;1 a, b = [0, 0], [0, 0] if ql\u0026lt;=mid: a = query(u\u0026lt;\u0026lt;1, l, mid, ql, qr) if qr\u0026gt;mid: b = query(u\u0026lt;\u0026lt;1|1, mid+1, r, ql, qr) return (a[0]+b[0], gcd(a[1], b[1])) n, m = map(int, input().split()) arr = [0] + list(map(int, input().split())) M = 1\u0026lt;\u0026lt;n.bit_length() + 1 tr = [0]*M gd = [0]*M build(1, 1, n) res = [] for i in range(m): op, par = input().split(maxsplit=1) if op==\u0026#39;Q\u0026#39;: l, r = map(int, par.split()) ans = gcd(query(1, 1, n, 1, l)[0], query(1, 1, n, l+1, r)[1]) if l+1\u0026lt;=r else query(1, 1, n, 1, l)[0] res.append(str(ans)) else: l, r, v = map(int, par.split()) modify(1, 1, n, l, v) if r+1\u0026lt;=n: modify(1, 1, n, r+1, -v) print(*res, sep=\u0026#39;\\n\u0026#39;) ç±»å®ç°çº¿æ®µæ ‘ # å®šä¹‰æ ‘èŠ‚ç‚¹ï¼Œl,r, valè¡¨ç¤ºè¯¥èŠ‚ç‚¹è®°å½•çš„æ˜¯åŒºé—´[l, r]çš„æœ€å¤§å€¼æ˜¯val class Tree(): def __init__(self): self.l = 0 self.r = 0 self.lazy = 0 self.val = 0 # äºŒå‰æ ‘æ˜¯å †å½¢å¼ï¼Œå¯ä»¥ç”¨ä¸€ç»´æ•°ç»„å­˜å‚¨ï¼Œæ³¨æ„æ•°ç»„é•¿åº¦è¦å¼€4å€ç©ºé—´ tree = [Tree() for i in range(10*4)] # å»ºæ ‘ï¼Œç”¨cur\u0026lt;\u0026lt;1è®¿é—®å·¦å­æ ‘ï¼Œcur\u0026lt;\u0026lt;1|1è®¿é—®å³å­æ ‘ï¼Œä½è¿ç®—æ“ä½œå¾ˆæ–¹ä¾¿ def build(cur, l, r): tree[cur].l, tree[cur].r, tree[cur].lazy, tree[cur].val = l, r, 0, 0 # å½“l==rçš„æ—¶å€™ç»“æŸé€’å½’ if l \u0026lt; r: mid = l + r \u0026gt;\u0026gt; 1 build(cur\u0026lt;\u0026lt;1, l, mid) build(cur\u0026lt;\u0026lt;1|1, mid+1, r) # å½“å­èŠ‚ç‚¹è®¡ç®—å®Œæˆåï¼Œç”¨å­èŠ‚ç‚¹çš„å€¼æ¥æ›´æ–°è‡ªå·±çš„å€¼ def pushup(cur): tree[cur].val = max(tree[cur\u0026lt;\u0026lt;1].val, tree[cur\u0026lt;\u0026lt;1|1].val) # å•ç‚¹æ›´æ–° def add(cur, x, v): if tree[cur].l == tree[cur].r: tree[cur].val += v else: mid = tree[cur].r + tree[cur].l \u0026gt;\u0026gt; 1 if x \u0026gt; mid: add(cur\u0026gt;\u0026gt;1|1, x, v) else: add(cur\u0026lt;\u0026lt;1, x, v) pushup(cur) # å°†lazyæ ‡è®°å‘ä¸‹ä¼ é€’ä¸€å±‚ def pushdown(cur): if tree[cur].lazy: lazy = tree[cur].lazy tree[cur\u0026lt;\u0026lt;1].lazy += lazy tree[cur\u0026lt;\u0026lt;1|1].lazy += lazy tree[cur\u0026lt;\u0026lt;1].val += lazy tree[cur\u0026lt;\u0026lt;1|1].val += lazy tree[cur].lazy = 0 # åŒºé—´æ›´æ–° def update(cur, l, r, v): if l \u0026lt;= tree[cur].l and tree[cur].r \u0026lt;= r: tree[cur].lazy += v tree[cur].val += v return if r \u0026lt; tree[cur].l or l \u0026gt; tree[cur].r: return if tree[cur].lazy: pushdown(cur) update(cur\u0026lt;\u0026lt;1, l, r, v) update(cur\u0026lt;\u0026lt;1|1, l, r, v) pushup(cur) # åŒºé—´æŸ¥è¯¢ def query(cur, l, r): if l \u0026lt;= tree[cur].l and tree[cur].r \u0026lt;= r: return tree[cur].val if tree[cur].l \u0026gt; r or tree[cur].r \u0026lt; l: return 0 if tree[cur].lazy: pushdown(cur) return max(query(cur\u0026lt;\u0026lt;1, l, r), query(cur\u0026lt;\u0026lt;1|1)) # æµ‹è¯• # ----- # --- # ------- # -- # -- build(1, 1, 10) update(1, 1, 5, 1) update(1, 7, 10, 1) update(1, 2, 8, 1) update(1, 3, 4, 1) update(1, 9, 10, 1) print(query(1, 1, 10)) def pushup(u): tr[u] = tr[u \u0026lt;\u0026lt; 1] + tr[u \u0026lt;\u0026lt; 1 | 1] def build(u, l, r): if l == r: tr[u] = 0 else: mid = (l + r) \u0026gt;\u0026gt; 1 build(u \u0026lt;\u0026lt; 1, l, mid) build(u \u0026lt;\u0026lt; 1 | 1, mid + 1, r) pushup(u) def query(u, l, r, ql, qr): if l \u0026gt;= ql and r \u0026lt;= qr: return tr[u] mid = (l + r) \u0026gt;\u0026gt; 1 if mid==l and mid==r: return 0 res = 0 if ql \u0026lt;= mid: res = query(u \u0026lt;\u0026lt; 1, l, mid, ql, qr) if qr \u0026gt; mid: res += query(u \u0026lt;\u0026lt; 1 | 1, mid + 1, r, ql, qr) return res def modify(u, x, l, r, val): if l == r: tr[u] += val else: mid = (l + r) \u0026gt;\u0026gt; 1 if x \u0026lt;= mid: modify(u \u0026lt;\u0026lt; 1, x, l, mid, val) else: modify(u \u0026lt;\u0026lt; 1 | 1, x, mid + 1, r, val) pushup(u) æœç´¢æ·±å…¥ æ± å¡˜è®¡æ•° import sys from collections import deque input = lambda:sys.stdin.readline().strip() N = int(1e3+10) M = N*N g = [0]*N cnt=0 vis = [ [False]*N for _ in range(N) ] def bfs(x, y): q=deque() q.append( (x,y) ) while q: tx, ty = q[0] q.popleft() for i in range(-1, 2): for j in range(-1, 2): if i==0 and j==0: continue xx, yy = tx+i, ty+j if xx\u0026lt;0 or xx\u0026gt;=n or yy\u0026lt;0 or yy\u0026gt;=m or vis[xx][yy] or g[xx][yy]==\u0026#39;.\u0026#39;: continue vis[xx][yy]=True q.append( (xx,yy) ) n, m = map(int, input().split()) for i in range(n): g[i]=input() for i in range(n): for j in range(m): if g[i][j]!=\u0026#39;W\u0026#39; or vis[i][j]: continue bfs(i, j) cnt+=1 print(cnt) åŸå ¡é—®é¢˜ import sys from collections import deque input = lambda:sys.stdin.readline().strip() N = 55 g = [] vis = [[False]*N for _ in range(N)] area = 0 cnt=0 def bfs(x, y): vis[x][y]=True q = deque() q.append((x, y)) dx, dy = [0, -1, 0, 1], [-1, 0, 1, 0] ans=1 while q: tx, ty = q.popleft() for i in range(4): xx = tx+dx[i] yy = ty+dy[i] if xx\u0026lt;0 or xx\u0026gt;=n or yy\u0026lt;0 or yy\u0026gt;=m or vis[xx][yy]: continue if (g[tx][ty]\u0026gt;\u0026gt;i)\u0026amp;1: continue ans+=1 vis[xx][yy]=True q.append((xx,yy)) return ans n, m = map(int, input().split()) for _ in range(n): g.append(list(map(int, input().split()))) for i in range(n): for j in range(m): if vis[i][j]: continue area = max(area, bfs(i, j)) cnt+=1 print(cnt) print(area) å±±å³°å’Œå±±è°· import sys from collections import deque N = 1010 g = [] vis = [[0]*N for _ in range(N)] pek, val = 0, 0 def bfs(x, y): global higher, lower vis[x][y]=True q = deque() q.append((x,y)) while q: tx,ty = q.popleft() for i in range(-1, 2): for j in range(-1, 2): if i==0 and j==0: continue xx, yy = tx+i, ty+j if xx\u0026lt;0 or xx\u0026gt;=n or yy\u0026lt;0 or yy\u0026gt;=n: continue if g[xx][yy]!=g[tx][ty]: if g[xx][yy]\u0026gt;g[tx][ty]: higher=True elif g[xx][yy]\u0026lt;g[tx][ty]: lower=True elif not vis[xx][yy]: vis[xx][yy]=True q.append((xx,yy)) higher, lower = False, False n = int(input()) for _ in range(n): g.append(list(map(int, input().split()))) # print(g) for i in range(n): for j in range(n): if vis[i][j]: continue higher, lower = False, False bfs(i, j) if not higher:pek+=1 if not lower:val+=1 print(pek, val) BFS P1038 [NOIP2003 æé«˜ç»„] ç¥ç»ç½‘ç»œ é¢˜ç›®å¤§æ„ï¼šå…°å…°æå‡ºäº†ä¸€ä¸ªç¥ç»ç½‘ç»œæ¨¡å‹ï¼Œè¯¥æ¨¡å‹å¯ä»¥è¡¨ç¤ºä¸ºä¸€ä¸ªæœ‰å‘å›¾ï¼Œå›¾ä¸­çš„èŠ‚ç‚¹ç§°ä¸ºç¥ç»å…ƒï¼ŒèŠ‚ç‚¹ä¹‹é—´çš„è¿æ¥ä»£è¡¨ç¥ç»å…ƒä¹‹é—´çš„è”ç³»ã€‚ç¥ç»å…ƒæŒ‰ç…§ä¸€å®šçš„é¡ºåºæ’åˆ—ï¼Œæ„æˆæ•´ä¸ªç¥ç»ç½‘ç»œã€‚æ¯ä¸ªç¥ç»å…ƒéƒ½æœ‰ä¸€ä¸ªçŠ¶æ€å’Œé˜ˆå€¼ï¼Œå½“ç¥ç»å…ƒå¤„äºå…´å¥‹çŠ¶æ€æ—¶ï¼Œä¼šå‘å…¶ä»–ç¥ç»å…ƒä¼ é€ä¿¡å·ã€‚\nå®ç°æ€è·¯ï¼š\né¦–å…ˆï¼Œæ ¹æ®è¾“å…¥çš„ç½‘ç»œç»“æ„ä¿¡æ¯ï¼Œæ„å»ºç¥ç»å…ƒä¹‹é—´çš„è¿æ¥å…³ç³»ã€‚ä½¿ç”¨å­—å…¸gæ¥è¡¨ç¤ºç¥ç»å…ƒä¹‹é—´çš„è¿æ¥å…³ç³»ï¼Œä»¥åŠå­—å…¸weiæ¥è¡¨ç¤ºè¿æ¥ç¥ç»å…ƒä¹‹é—´çš„è¾¹çš„æƒå€¼ã€‚ ç„¶åï¼Œæ ¹æ®è¾“å…¥çš„åˆå§‹çŠ¶æ€å’Œé˜ˆå€¼ä¿¡æ¯ï¼Œåˆå§‹åŒ–ç¥ç»å…ƒçš„çŠ¶æ€ã€‚åŒæ—¶ï¼Œè®°å½•è¾“å…¥å±‚ç¥ç»å…ƒçš„åˆå§‹çŠ¶æ€ï¼Œå¦‚æœç¥ç»å…ƒçš„çŠ¶æ€ä¸ä¸º0ï¼Œåˆ™å°†å…¶åŠ å…¥é˜Ÿåˆ—qä¸­ã€‚ åˆ©ç”¨å¹¿åº¦ä¼˜å…ˆæœç´¢ï¼ˆBFSï¼‰ç®—æ³•ï¼Œéå†ç¥ç»å…ƒï¼Œæ ¹æ®æ¨¡å‹å…¬å¼æ›´æ–°æ¯ä¸ªç¥ç»å…ƒçš„çŠ¶æ€ã€‚åŒæ—¶ï¼Œæ›´æ–°ç¥ç»å…ƒçš„çŠ¶æ€æ—¶ï¼Œè€ƒè™‘åˆ°è¾¹çš„æƒå€¼ä»¥åŠç¥ç»å…ƒçš„é˜ˆå€¼ã€‚ æœ€åï¼Œè¾“å‡ºè¾“å‡ºå±‚ç¥ç»å…ƒçš„çŠ¶æ€ã€‚å¦‚æœè¾“å‡ºå±‚ç¥ç»å…ƒçš„æœ€åçŠ¶æ€å‡å°äºç­‰äº0ï¼Œåˆ™è¾“å‡º\u0026quot;NULL\u0026quot;ï¼Œå¦åˆ™æŒ‰ç…§ç¼–å·ä»å°åˆ°å¤§é¡ºåºè¾“å‡ºè¾“å‡ºå±‚ç¥ç»å…ƒçš„çŠ¶æ€ã€‚ from collections import deque, defaultdict maxn = 1e3 + 10 c = [0] * int(maxn) u = [0] * int(maxn) wei = defaultdict(lambda: defaultdict(int)) vis = [False] * int(maxn) beginer = [False] * int(maxn) g = defaultdict(list) n, p = map(int, input().split()) en = [] q = deque() for i in range(1, n + 1): c[i], u[i] = map(int, input().split()) if c[i] != 0: q.append(i) beginer[i] = True else: en.append(i) if not en: for i in range(1, n + 1): print(i, c[i]) exit() for _ in range(p): s, e, w = map(int, input().split()) g[s].append(e) wei[s][e] = w while q: t = q.popleft() if not beginer[t]: c[t] -= u[t] base = c[t] if base \u0026gt; 0: for j in g[t]: c[j] += base * wei[t][j] if not vis[j]: q.append(j) vis[j] = True ans = 0 for i in en: if c[i] \u0026gt; 0 and not g[i]: print(i, c[i]) ans += 1 if not ans: print(\u0026#34;NULL\u0026#34;) ","permalink":"https://kennems.github.io/posts/tech/%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0%E4%BA%8C%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84python%E5%AE%9E%E7%8E%B0/","summary":"ç®—æ³•ç¬”è®°ï¼ˆäºŒï¼‰â€”â€”æ•°æ®ç»“æ„(Pythonå®ç°) æ•°æ®ç»“æ„ å•é“¾è¡¨ N = int(1e5+10) e=[0]*N ne=[0]*N head=-1 idx=1 def insert(x): global idx, head e[idx]=x ne[idx]=head head=idx idx+=1 def add(k, x): global idx e[idx]=x ne[idx]=ne[k] ne[k]=idx idx+=1 def remove(k): global idx, head if k==0: head = ne[head] else: ne[k]=ne[ne[k]] n = int(input())","title":"ç®—æ³•ç¬”è®°ï¼ˆäºŒï¼‰â€”â€”æ•°æ®ç»“æ„(Pythonå®ç°)"},{"content":"ç®—æ³•ç¬”è®°ï¼ˆä¸‰ï¼‰â€”â€”å›¾è®ºï¼ˆPythonå®ç°ï¼‰ å›¾è®º æ ‘çš„å­˜å‚¨ é‚»æ¥çŸ©é˜µ # åˆ›å»ºä¸€ä¸ªäºŒç»´åˆ—è¡¨è¡¨ç¤ºé‚»æ¥çŸ©é˜µ n = 10 # é¡¶ç‚¹æ•°é‡ g = [[0] * n for _ in range(n)] # æ·»åŠ ä¸€æ¡è¾¹a-\u0026gt;b def add_edge(a, b): g[a][b] = 1 # åˆå§‹åŒ– g = [[0] * n for _ in range(n)] é‚»æ¥è¡¨ # åˆ›å»ºä¸€ä¸ªåˆ—è¡¨è¡¨ç¤ºé‚»æ¥è¡¨ n = 10 # é¡¶ç‚¹æ•°é‡ h = [-1] * n e = [0] * n ne = [0] * n idx = 0 # æ·»åŠ ä¸€æ¡è¾¹a-\u0026gt;b def add_edge(a, b): global idx e[idx] = b ne[idx] = h[a] h[a] = idx idx += 1 # åˆå§‹åŒ– idx = 0 h = [-1] * n æ ‘å’Œå›¾çš„å­˜å‚¨ # é‚»æ¥è¡¨è¡¨ç¤ºçš„å›¾ N = 100010 # æ ¹æ®å…·ä½“éœ€æ±‚è®¾ç½®åˆé€‚çš„æœ€å¤§èŠ‚ç‚¹æ•°é‡ # å¯¹äºæ¯ä¸ªç‚¹kï¼Œå¼€ä¸€ä¸ªå•é“¾è¡¨ï¼Œå­˜å‚¨kæ‰€æœ‰å¯ä»¥èµ°åˆ°çš„ç‚¹ã€‚h[k]å­˜å‚¨è¿™ä¸ªå•é“¾è¡¨çš„å¤´ç»“ç‚¹ h = [-1] * N # å­˜å‚¨è¾¹çš„ç›®æ ‡èŠ‚ç‚¹ e = [0] * N # å­˜å‚¨ä¸‹ä¸€æ¡è¾¹çš„ç´¢å¼• ne = [0] * N # è¾¹çš„ç´¢å¼• idx = 0 # æ·»åŠ ä¸€æ¡è¾¹a-\u0026gt;b def add(a, b): global idx e[idx] = b ne[idx] = h[a] h[a] = idx idx += 1 # åˆå§‹åŒ– idx = 0 for i in range(N): h[i] = -1 æ ‘å’Œå›¾çš„éå† DFS def dfs(u): st[u] = True i = h[u] while i!=-1: j = e[i] if not st[j]: dfs(j) i = ne[i] BFS from collections import deque q = deque() st[1] = True q.append(1) while q: t = q.popleft() i = h[t] while i!=-1: j=e[i] if not st[j]: st[j] = True q.append(j) i=ne[i] æ‹“æ‰‘æ’åº from sys import stdin from collections import deque input = lambda:stdin.readline().strip() def topsort(): q = deque() res = [] for i in range(1, n+1): if ind[i]==0: res.append(i) q.append(i) while q: u = q.popleft() for v in g[u]: ind[v] -= 1 if ind[v]==0: q.append(v) res.append(v) return res n = int(input()) ind = [0]*(n+1) g = [[] for _ in range(n+1)] for i in range(1, n+1): a = list(map(int, input().split())) for j in range(len(a)-1): g[i].append(a[j]) ind[a[j]]+=1 res = topsort() print(*res, sep=\u0026#39; \u0026#39;) å¥–é‡‘ from sys import stdin from collections import deque def topsort(): res = [] q = deque() ans = 0 for i in range(1, n+1): if ind[i]==0: res.append(i) q.append((i, 100)) ans += 100 while q: u, m = q.popleft() for v in g[u]: ind[v] -= 1 if ind[v]==0: q.append((v, m+1)) res.append(v) ans += m+1 if len(res)==n: print(ans) else: print(\u0026#34;Poor Xed\u0026#34;) n, m = map(int, input().split()) ind = [0]*(n+1) g = [[] for _ in range(n+1)] for i in range(m): a, b = map(int, input().split()) ind[a] += 1 g[b].append(a) topsort() LCA def lca(x,y): if dep[x] \u0026lt; dep[y]: x,y = y,x d = dep[x]-dep[y] while d: # å¾ªç¯ç›´åˆ°æ·±åº¦å·®ä¸º 0 v = d \u0026amp; -d # è·å– d çš„æœ€ä½ä½çš„ 1 æ‰€åœ¨çš„ä½ç½® i = v.bit_length() - 1 # è®¡ç®—æœ€ä½ä½çš„ä½ç½®ç´¢å¼• x = fa[i][x] # å°†èŠ‚ç‚¹ x ä¸Šç§»åˆ°å’ŒèŠ‚ç‚¹ y åŒä¸€æ·±åº¦ d -= v # æ›´æ–°æ·±åº¦å·® if x==y: return x for k in range(K-1, -1, -1): if fa[k][x] != fa[k][y]: x = fa[k][x] y = fa[k][y] return fa[0][x] # åˆå§‹åŒ–æ·±åº¦ä»¥åŠçˆ¶èŠ‚ç‚¹ä¿¡æ¯ dep[x]=dep[val]+1 dep[y]=dep[val]+1 fa[0][x] = val fa[0][y] = val for k in range(K-1): fa[k+1][x] = fa[k][fa[k][x]] # è‡ªå·±çš„ç¬¬2^(1+1)çº§çˆ¶äº²å³ä¸º è‡ªå·±çš„ç¬¬2^(1)çº§çˆ¶äº² çš„ç¬¬2^(1)çº§çˆ¶äº² fa[k+1][y] = fa[k][fa[k][y]] ç¥–å­™è¯¢é—® from sys import stdin from collections import deque, defaultdict from math import inf K = 17 N = int(4*10e4) + 10 dep = [inf]*(N) fa = [[0]*N for _ in range(K)] def bfs(): dep[0] = 0; dep[root] = 1 q = deque([root]) while q: u = q.popleft() for v in g[u]: if dep[v] \u0026gt; dep[u] + 1: dep[v] = dep[u] + 1 q.append(v) fa[0][v] = u for k in range(1, K-1): fa[k][v] = fa[k-1][fa[k-1][v]] def lca(x, y): if dep[x] \u0026lt; dep[y]: x, y = y, x d = dep[x] - dep[y] while d: v = d \u0026amp; -d i = v.bit_length() - 1 x = fa[i][x] d -= v if x==y: return x for k in range(K-1, -1, -1): if fa[k][x] != fa[k][y]: x = fa[k][x] y = fa[k][y] return fa[0][x] n = int(input()) g = defaultdict(list) for i in range(n): a, b = map(int, input().split()) if b==-1: root = a else: g[a].append(b) g[b].append(a) bfs() # print(dep) m = int(input()) for i in range(m): x, y = map(int, input().split()) res = lca(x, y) if res == x and res != y: print(1) elif res == y and res != x: print(2) else: print(0) æœ€çŸ­è·¯ å•å…ƒæœ€çŸ­è·¯\nâ€‹\tæ‰€æœ‰è¾¹æƒä¸ºæ­£ï¼š\nâ€‹\tæœ´ç´ ç‰ˆDijkstra $O(n^2)$,å †ä¼˜åŒ–ç‰ˆçš„Dijkstra $O(mlogn)$, â€‹\tå­˜åœ¨è´Ÿæƒè¾¹\nâ€‹\tBellman-Ford $O(nm)$, SPFA é˜Ÿåˆ—ä¼˜åŒ–çš„Bellman-Ford, ä¸€èˆ¬æƒ…å†µï¼š$O(m)$ æœ€åæƒ…å†µï¼š$O(nm)$ å¤šå…ƒæ±‡æœ€çŸ­è·¯ï¼š\nâ€‹\tFloyed $O(n^3)$ æœ´ç´ Dijkstra Dijkstraä¸èƒ½å¤„ç†è´Ÿæƒè¾¹ï¼š\nN = int(5e2)+10 INF = 0x3f3f3f3f g = [[INF]*N for _ in range(N)] #g = defaultdict(lambda:defaultdict(lambda:INF)) åŒæ ·çš„æ•ˆæœ dis = [INF]*N st = [False]*N def dijkstra(): dis[1]=0 for i in range(n-1): t=-1 for j in range(1,n+1): if not st[j] and (t==-1 or dis[j]\u0026lt;dis[t]): t=j for j in range(1,n+1): dis[j]=min(dis[j], dis[t] + g[t][j]) st[t]=True if dis[n]==INF: return -1 return dis[n] n, m = map(int, input().split()) for _ in range(m): x, y, z = map(int ,input().split()) g[x][y] = min(g[x][y], z) print(dijkstra()) å †ä¼˜åŒ–ç‰ˆDijkstra from heapq import * import sys input = lambda:sys.stdin.readline().strip() N = 150010 INF = 0x3f3f3f3f e, ne, head, w, dis= [0]*N, [0]*N, [-1]*N, [0]*N, [INF]*N st = [False]*N idx=0 def add(a, b, x): global idx e[idx]=b w[idx]=x ne[idx]=head[a] head[a]=idx idx+=1 def dijkstra(): dis[1]=0 h=[] heappush(h, (0,1)) while h: dist, ver = heappop(h) if st[ver]: continue st[ver]=True i=head[ver] while i!=-1: j=e[i] if not st[j] and dis[j]\u0026gt;dist+w[i]: dis[j]=dist+w[i] heappush(h, (dis[j], j)) i=ne[i] if dis[n]==INF: print(-1) else: print(dis[n]) n, m = map(int, input().split()) for _ in range(m): x, y, z = map(int, input().split()) add(x,y,z) dijkstra() å¦ä¸€ç§å†™æ³• from sys import stdin from math import inf from collections import deque, defaultdict from heapq import heappush, heappop input = lambda:stdin.readline().strip() def dijkstra(): h = [(0, 1)] dis[1] = 0 while h: dist, ver = heappop(h) if vis[ver]: continue vis[ver] = True for nx, z in g[ver]: if dis[nx] \u0026gt; dis[ver] + z: dis[nx] = dis[ver] + z heappush(h, (dis[nx], nx)) return dis[n] n, m = map(int, input().split()) dis = [inf]*(n+1) vis = [False]*(n+1) g = defaultdict(list) for i in range(m): x, y, z = map(int, input().split()) g[x].append((y, z)) res = dijkstra() print(res if res != inf else -1) Bellman-Ford # nè¡¨ç¤ºç‚¹æ•°ï¼Œmè¡¨ç¤ºè¾¹æ•° dist = [float(\u0026#39;inf\u0026#39;)] * (n + 1) # dist[x]å­˜å‚¨1åˆ°xçš„æœ€çŸ­è·¯è·ç¦» # è¾¹ï¼Œaè¡¨ç¤ºå‡ºç‚¹ï¼Œbè¡¨ç¤ºå…¥ç‚¹ï¼Œwè¡¨ç¤ºè¾¹çš„æƒé‡ edges = [] # æ±‚1åˆ°nçš„æœ€çŸ­è·¯è·ç¦»ï¼Œå¦‚æœæ— æ³•ä»1èµ°åˆ°nï¼Œåˆ™è¿”å›-1ã€‚ def bellman_ford(): dist[1] = 0 # å¦‚æœç¬¬næ¬¡è¿­ä»£ä»ç„¶ä¼šæ¾å¼›ä¸‰è§’ä¸ç­‰å¼ï¼Œå°±è¯´æ˜å­˜åœ¨ä¸€æ¡é•¿åº¦æ˜¯n+1çš„æœ€çŸ­è·¯å¾„ï¼Œç”±æŠ½å±‰åŸç†ï¼Œè·¯å¾„ä¸­è‡³å°‘å­˜åœ¨ä¸¤ä¸ªç›¸åŒçš„ç‚¹ï¼Œè¯´æ˜å›¾ä¸­å­˜åœ¨è´Ÿæƒå›è·¯ã€‚ for i in range(n): for j in range(m): a, b, w = edges[j][\u0026#39;a\u0026#39;], edges[j][\u0026#39;b\u0026#39;], edges[j][\u0026#39;w\u0026#39;] if dist[b] \u0026gt; dist[a] + w: dist[b] = dist[a] + w if dist[n] \u0026gt; float(\u0026#39;inf\u0026#39;) / 2: return -1 return dist[n] SPFA from collections import defaultdict, deque import sys input = lambda:sys.stdin.readline().strip() N, INF = int(1e5+10), 0x3f3f3f3f dis, st = [INF]*N, [False]*N g=defaultdict(list) def spfa(): q=deque() q.append(1) st[1]=True dis[1]=0 while q: x=q.popleft() st[x]=False for y, z in g[x]: if dis[y]\u0026gt;dis[x]+z: dis[y]=dis[x]+z if not st[y]: st[y]=True q.append(y) if dis[n]==INF: print(\u0026#39;impossible\u0026#39;) else: print(dis[n]) n, m = map(int, input().split()) for _ in range(m): x, y, z = map(int, input().split()) g[x].append((y, z)) spfa() åˆ¤æ–­è´Ÿç¯ from sys import stdin from collections import deque, defaultdict from math import inf input = lambda:stdin.readline().strip() def spfa(): q = deque() for i in range(1, n+1): q.append(i) st[i] = True while q: x = q.popleft() st[x] = False for y, z in g[x]: if dis[y] \u0026gt; dis[x] + z: dis[y] = dis[x] + z cnt[y] = cnt[x] + 1 if cnt[y] \u0026gt;= n: return True if not st[y]: q.append(y) st[y] = True return False n, m = map(int, input().split()) g = defaultdict(list) cnt = [0]*(n+1) st = [False]*(n+1) dis = [0]*(n+1) for i in range(m): x, y, z = map(int, input().split()) g[x].append((y, z)) res = spfa() print(\u0026#34;Yes\u0026#34; if res else \u0026#34;No\u0026#34;) floyd from sys import stdin from math import inf def floyd(): for k in range(1, n+1): for i in range(1, n+1): for j in range(1, n+1): d[i][j] = min(d[i][j], d[i][k] + d[k][j]) n, m, k = map(int, input().split()) d = [[0 if i==j else inf for i in range(n+1)] for j in range(n+1)] for i in range(m): x, y, z = map(int, input().split()) d[x][y] = min(d[x][y], z) floyd() for i in range(k): x, y = map(int, input().split()) print(d[x][y] if d[x][y]!=inf else \u0026#34;impossible\u0026#34;) Prim from math import inf from sys import stdin def prim(): res = 0 dis[1] = 0 for i in range(n): t = -1 for j in range(1, n+1): if not st[j] and (t==-1 or dis[t] \u0026gt; dis[j]): t = j if i and dis[t]==inf: return inf if i: res += dis[t] st[t] = True for j in range(1, n+1): dis[j] = min(dis[j], g[t][j]) return res n, m = map(int, input().split()) g = [[inf]*(n+1) for _ in range(n+1)] dis = [inf]*(n+1) st = [False]*(n+1) for i in range(m): u, v, w = map(int, input().split()) g[u][v] = g[v][u] = min(w, g[u][v]) res = prim() if res==inf: print(\u0026#34;impossible\u0026#34;) else: print(res) Kruskal import sys input = lambda:sys.stdin.readline().strip() def find(x): while p[x] != x: p[x] = p[p[x]] x = p[x] return x def kruskal(): res, cnt = 0, 0 ans = [] for u, v, w in g: fu, fv = find(u), find(v) if fu != fv: res += w cnt += 1 p[fu] = fv ans.append((u, v, w)) ans.sort() if cnt == n-1: print(res) # print(ans) # è®°å½•é€‰æ‹©çš„æ˜¯å“ªäº›è¾¹ else: print(\u0026#34;impossible\u0026#34;) n, m = map(int, input().split()) g = [] p = [i for i in range(n+1)] for i in range(m): u, v, w = map(int, input().split()) g.append((u, v, w)) g.sort(key = lambda e:e[2]) kruskal() æŸ“è‰²æ³• ä½¿ç”¨äº†æ·±åº¦ä¼˜å…ˆæœç´¢ç®—æ³•ï¼ˆDFSï¼‰æ¥åˆ¤æ–­ä¸€ä¸ªå›¾æ˜¯å¦æ˜¯äºŒåˆ†å›¾\näºŒåˆ†å›¾ï¼šé¡¶ç‚¹åˆ†ä¸ºä¸¤ä¸ªé›†åˆï¼Œè¾¹ä»…å­˜åœ¨äºä¸¤ä¸ªä¸åŒçš„é›†åˆä¸­ï¼Œè€Œé›†åˆå†…éƒ¨éƒ½æ²¡æœ‰è¾¹ã€‚\nPythonä¼˜å…ˆä½¿ç”¨BFSï¼Œå› ä¸ºDFSä¼šå‡ºç°å„ç§é—®é¢˜ï¼Œçˆ†æ ˆï¼Œæ®µé”™è¯¯ï¼ˆè¿˜æ²¡ææ¸…æ¥šåŸå› ï¼‰ç­‰\nè¿™æ®µä»£ç ä½¿ç”¨äº†æŸ“è‰²æ³•æ¥åˆ¤æ–­ä¸€ä¸ªæ— å‘å›¾æ˜¯å¦ä¸ºäºŒåˆ†å›¾ã€‚ä¸‹é¢æˆ‘æ¥è§£é‡Šä¸€ä¸‹ï¼š\né¢˜ç›®å¤§æ„ï¼š ç»™å®šä¸€ä¸ªæ— å‘å›¾ï¼Œåˆ¤æ–­æ˜¯å¦å¯ä»¥å°†å…¶é¡¶ç‚¹é›†åˆåˆ’åˆ†ä¸ºä¸¤ä¸ªä¸ç›¸äº¤çš„å­é›†ï¼Œä½¿å¾—æ¯æ¡è¾¹çš„ä¸¤ä¸ªç«¯ç‚¹åˆ†åˆ«å±äºè¿™ä¸¤ä¸ªå­é›†ã€‚å¦‚æœå¯ä»¥ï¼Œåˆ™è¾“å‡º\u0026quot;Yes\u0026quot;ï¼Œå¦åˆ™è¾“å‡º\u0026quot;No\u0026quot;ã€‚\nå®ç°æ€è·¯ï¼š\nä½¿ç”¨é‚»æ¥è¡¨ g æ¥è¡¨ç¤ºæ— å‘å›¾ï¼Œå…¶ä¸­ g[u] å­˜å‚¨ä¸é¡¶ç‚¹ u ç›¸è¿çš„æ‰€æœ‰é¡¶ç‚¹ã€‚ å®šä¹‰ä¸€ä¸ªæ•°ç»„ color æ¥æ ‡è®°æ¯ä¸ªé¡¶ç‚¹çš„æŸ“è‰²æƒ…å†µï¼Œåˆå§‹å€¼è®¾ä¸º -1 è¡¨ç¤ºæœªæŸ“è‰²ã€‚ å®šä¹‰ä¸€ä¸ª BFS å‡½æ•° bfs(u, c)ï¼Œå…¶ä¸­ u è¡¨ç¤ºèµ·å§‹é¡¶ç‚¹ï¼Œc è¡¨ç¤ºåˆå§‹é¢œè‰²ã€‚è¯¥å‡½æ•°ä½¿ç”¨ BFS éå†å›¾ï¼Œå¹¶å°†é¡¶ç‚¹æŸ“è‰²ï¼Œä¿è¯ç›¸é‚»é¡¶ç‚¹é¢œè‰²ä¸åŒã€‚ åœ¨ä¸»ä½“éƒ¨åˆ†ï¼Œéå†æ‰€æœ‰é¡¶ç‚¹ï¼Œå¯¹äºæ¯ä¸ªæœªæŸ“è‰²çš„é¡¶ç‚¹ï¼Œè°ƒç”¨ bfs å‡½æ•°è¿›è¡ŒæŸ“è‰²ã€‚å¦‚æœæŸ“è‰²è¿‡ç¨‹ä¸­å‘ç°ç›¸é‚»é¡¶ç‚¹é¢œè‰²ç›¸åŒï¼Œåˆ™è¿”å› \u0026ldquo;No\u0026rdquo;ï¼Œè¡¨ç¤ºæ— æ³•åˆ’åˆ†ä¸ºäºŒåˆ†å›¾ï¼›å¦åˆ™è¿”å› \u0026ldquo;Yes\u0026rdquo;ã€‚ import sys from collections import deque, defaultdict input = lambda:sys.stdin.readline().strip() N = int(1e5)+10 g = defaultdict(list) color = [-1]*N def bfs(u, c): color[u] = c q = deque() q.append((u, c)) while q: cur, col = q.popleft() for nx in g[cur]: if color[nx]==-1: color[nx] = 1-col q.append((nx, 1-col)) elif color[nx]==col: return False return True n, m = map(int, input().split()) for i in range(m): u, v = map(int, input().split()) # if u==v: #***è‡ªç¯ä¸èƒ½å»æ‰*** # continue if u not in g[v]: g[v].append(u) if v not in g[u]: g[u].append(v) for i in range(1, n+1): if color[i]==-1: if not bfs(i, 0): print(\u0026#34;No\u0026#34;) exit() print(\u0026#34;Yes\u0026#34;) åŒˆç‰™åˆ©ç®—æ³• é¢˜ç›®å¤§æ„ï¼š ç»™å®šä¸€ä¸ªäºŒåˆ†å›¾ï¼Œå…¶ä¸­å·¦ä¾§é¡¶ç‚¹é›†åˆä¸º (N_1)ï¼Œå³ä¾§é¡¶ç‚¹é›†åˆä¸º (N_2)ï¼Œå›¾ä¸­å­˜åœ¨ä¸€äº›è¾¹ã€‚éœ€è¦æ‰¾åˆ°å°½å¯èƒ½å¤šçš„åŒ¹é…ï¼Œä½¿å¾—å·¦ä¾§çš„æ¯ä¸ªé¡¶ç‚¹æœ€å¤šä¸ä¸€ä¸ªå³ä¾§çš„é¡¶ç‚¹ç›¸è¿ï¼Œè€Œå³ä¾§çš„æ¯ä¸ªé¡¶ç‚¹æœ€å¤šä¸ä¸€ä¸ªå·¦ä¾§çš„é¡¶ç‚¹ç›¸è¿ã€‚\nå®ç°æ€è·¯ï¼š\nä½¿ç”¨ä¸€ä¸ªäºŒç»´æ•°ç»„ g å­˜å‚¨å›¾çš„é‚»æ¥è¡¨è¡¨ç¤ºã€‚å…¶ä¸­ g[u] è¡¨ç¤ºä¸å·¦ä¾§é¡¶ç‚¹ u ç›¸è¿çš„æ‰€æœ‰å³ä¾§é¡¶ç‚¹çš„é›†åˆã€‚ å®šä¹‰ä¸€ä¸ªå‡½æ•° find(x)ï¼Œç”¨äºä»å·¦ä¾§é¡¶ç‚¹ x å¼€å§‹å°è¯•å¯»æ‰¾å¢å¹¿è·¯å¾„ï¼Œå¦‚æœæ‰¾åˆ°äº†å¢å¹¿è·¯å¾„å°±è¿”å› Trueï¼Œå¦åˆ™è¿”å› Falseã€‚ åœ¨ä¸»ä½“éƒ¨åˆ†ï¼Œéå†å·¦ä¾§çš„æ¯ä¸ªé¡¶ç‚¹ï¼Œå¯¹æ¯ä¸ªé¡¶ç‚¹è°ƒç”¨ find å‡½æ•°è¿›è¡ŒåŒ¹é…ï¼Œè‹¥æˆåŠŸåŒ¹é…ï¼Œåˆ™åŒ¹é…æ•°åŠ ä¸€ã€‚ from sys import stdin from collections import defaultdict def find(u): for v in g[u]: if not st[v]: st[v] = True if mat[v]==0 or find(mat[v]): mat[v] = u return True return False n1, n2, m = map(int, input().split()) mat = [0]*(n2 + 1) g = defaultdict(list) for i in range(m): u, v = map(int, input().split()) g[u].append(v) res = 0 for i in range(1, n1+1): st = [False]*(n2 + 1) if find(i): res += 1 print(res) DFSä¹‹è¿é€šæ€§ é¢˜æ„ï¼šåœ¨ä¸€ä¸ªç»™å®šè¿·å®«ä¸­ï¼Œä»èµ·ç‚¹Aåˆ°ç»ˆç‚¹Bæ˜¯å¦å­˜åœ¨ä¸€æ¡è·¯å¾„çš„é—®é¢˜ã€‚è¿·å®«ç”±ä¸€ä¸ªç”± '.' å’Œ '#' æ„æˆçš„çŸ©é˜µè¡¨ç¤ºï¼Œå…¶ä¸­ '.' è¡¨ç¤ºå¯é€šè¡Œçš„æ ¼ç‚¹ï¼Œ'#' è¡¨ç¤ºä¸å¯é€šè¡Œçš„æ ¼ç‚¹ã€‚Extenseåªèƒ½å‘ä¸œå—è¥¿åŒ—å››ä¸ªæ–¹å‘ç§»åŠ¨åˆ°ç›¸é‚»çš„å¯é€šè¡Œæ ¼ç‚¹ä¸Šï¼Œè€Œä¸”è¦æ±‚èµ·ç‚¹å’Œç»ˆç‚¹éƒ½æ˜¯å¯é€šè¡Œçš„ã€‚ä½ éœ€è¦ç¼–å†™ä¸€ä¸ªç¨‹åºæ¥ç¡®å®šåœ¨ç»™å®šçš„è¿·å®«ä¸­ï¼Œæ˜¯å¦å­˜åœ¨ä¸€æ¡ä»Aåˆ°Bçš„è·¯å¾„ã€‚\nimport sys input = lambda:sys.stdin.readline().strip() sys.setrecursionlimit(150000) dir = [(-1, 0), (0, 1), (1, 0), (0, -1)] def dfs(x, y): if g[x][y]==\u0026#39;#\u0026#39; or vis[x][y]: return False if (x, y)==end: return True vis[x][y] = True for i in range(4): a, b = x + dir[i][0], y+dir[i][1] if 0\u0026lt;=a\u0026lt;n and 0\u0026lt;=b\u0026lt;n: if dfs(a, b): return True return False k = int(input()) N = 110 g = [[] for _ in range(N)] for _ in range(k): n = int(input()) vis = [[False]*(n+1) for _ in range(n+1)] for i in range(n): g[i] = list(input()) x1, y1, x2, y2 = map(int, input().split()) end = (x2, y2) if dfs(x1, y1): print(\u0026#34;YES\u0026#34;) else: print(\u0026#34;NO\u0026#34;) é­”æ¿ é¢˜ç›®å¤§æ„ï¼šç»™å®šä¸€ä¸ª 8 ä¸ªæ ¼å­çš„é­”æ¿ï¼Œæ¯ä¸ªæ ¼å­æœ‰ä¸€ç§é¢œè‰²ï¼Œç”¨ 1 åˆ° 8 çš„æ•´æ•°è¡¨ç¤ºã€‚æœ‰ä¸‰ç§åŸºæœ¬æ“ä½œå¯ä»¥æ”¹å˜é­”æ¿çš„çŠ¶æ€ï¼šAï¼šäº¤æ¢ä¸Šä¸‹ä¸¤è¡Œï¼›Bï¼šå°†æœ€å³è¾¹çš„ä¸€åˆ—æ’å…¥åˆ°æœ€å·¦è¾¹ï¼›Cï¼šé­”æ¿ä¸­å¤®å¯¹çš„4ä¸ªæ•°ä½œé¡ºæ—¶é’ˆæ—‹è½¬ã€‚ç°åœ¨ç»™å®šä¸€ä¸ªç›®æ ‡çŠ¶æ€ï¼Œæ±‚ç”¨æœ€å°‘çš„åŸºæœ¬æ“ä½œå®ŒæˆåŸºæœ¬çŠ¶æ€åˆ°ç›®æ ‡çŠ¶æ€çš„è½¬æ¢ï¼Œå¹¶è¾“å‡ºåŸºæœ¬æ“ä½œåºåˆ—ã€‚\nå®ç°æ€è·¯ï¼š\né¦–å…ˆå®ç°ä¸‰ç§åŸºæœ¬æ“ä½œ Aã€Bã€C çš„å‡½æ•°ã€‚ ä½¿ç”¨å¹¿åº¦ä¼˜å…ˆæœç´¢ï¼ˆBFSï¼‰ç®—æ³•æ¥æ‰¾åˆ°ä»åŸºæœ¬çŠ¶æ€åˆ°ç›®æ ‡çŠ¶æ€çš„æœ€çŸ­æ“ä½œåºåˆ—ã€‚ ä½¿ç”¨ä¸€ä¸ªé˜Ÿåˆ—å­˜å‚¨å¾…å¤„ç†çŠ¶æ€ï¼Œå¹¶ä½¿ç”¨ä¸€ä¸ªå­—å…¸è®°å½•æ¯ä¸ªçŠ¶æ€çš„å‰é©±çŠ¶æ€å’Œæ‰§è¡Œçš„æ“ä½œã€‚ åœ¨æ¯ä¸€æ­¥ä¸­ï¼Œå°è¯•å¯¹å½“å‰çŠ¶æ€è¿›è¡Œä¸‰ç§åŸºæœ¬æ“ä½œï¼Œå¾—åˆ°æ–°çš„çŠ¶æ€ï¼Œå¦‚æœæ–°çŠ¶æ€æœªè¢«è®¿é—®è¿‡ï¼Œåˆ™å°†å…¶åŠ å…¥é˜Ÿåˆ—ï¼Œå¹¶è®°å½•å…¶å‰é©±çŠ¶æ€å’Œæ“ä½œã€‚ å½“æ‰¾åˆ°ç›®æ ‡çŠ¶æ€æ—¶ï¼Œæ ¹æ®å‰é©±çŠ¶æ€å›æº¯å¾—åˆ°æœ€çŸ­æ“ä½œåºåˆ—ã€‚ è¾“å‡ºæœ€çŸ­æ“ä½œåºåˆ—çš„é•¿åº¦å’Œå…·ä½“æ“ä½œåºåˆ—ã€‚ from collections import deque def A(t): return t[::-1] def B(t): return t[3] + t[:3] + t[5:] + t[4] def C(t): return t[0] + t[6] + t[1] + t[3] + t[4] + t[2] + t[5] + t[7] pre = dict() def bfs(): q = deque() q.append(st) while q: t = q.popleft() if t==ed: break m = [A(t), B(t), C(t)] for i in range(3): if m[i] not in pre: pre[m[i]] = (chr(65+i), t) q.append(m[i]) nums = input().split() ed = \u0026#39;\u0026#39;.join(nums) st = \u0026#34;12345678\u0026#34; bfs() cnt = 0 res = \u0026#34;\u0026#34; while ed != st: cnt+=1 res = pre[ed][0] + res ed = pre[ed][1] print(cnt) if cnt: print(res) å•è¯æ¥é¾™ é¢˜ç›®å¤§æ„ï¼šç»™å®šä¸€ç»„å•è¯å’Œä¸€ä¸ªå¼€å¤´çš„å­—æ¯ï¼Œè¦æ±‚æ‰¾å‡ºä»¥è¿™ä¸ªå­—æ¯å¼€å¤´çš„æœ€é•¿çš„â€œé¾™â€ï¼Œæ¯ä¸ªå•è¯æœ€å¤šè¢«ä½¿ç”¨ä¸¤æ¬¡ã€‚åœ¨æ„æˆé¾™æ—¶ï¼Œä¸¤ä¸ªå•è¯ç›¸è¿æ—¶ï¼Œå®ƒä»¬çš„é‡åˆéƒ¨åˆ†åˆå¹¶ä¸ºä¸€éƒ¨åˆ†ï¼Œä½†é‡åˆéƒ¨åˆ†çš„é•¿åº¦å¿…é¡»å¤§äºç­‰äº1ä¸”å°äºä¸¤ä¸ªå•è¯çš„é•¿åº¦ã€‚\nå®ç°æ€è·¯ï¼š\né¦–å…ˆè¯»å…¥è¾“å…¥æ•°æ®ï¼ŒåŒ…æ‹¬å•è¯æ•° nã€n ä¸ªå•è¯ä»¥åŠå¼€å¤´çš„å­—æ¯ã€‚ æ„å»ºä¸€ä¸ªå­—å…¸ gï¼Œç”¨äºå­˜å‚¨æ¯ä¸ªå•è¯å¯¹åº”çš„å¯è¿æ¥çš„å•è¯ä»¥åŠå¯¹åº”çš„é‡åˆéƒ¨åˆ†çš„é•¿åº¦ã€‚ å¯¹äºæ¯ä¸€å¯¹å•è¯ï¼Œæ¯”è¾ƒå®ƒä»¬çš„é‡åˆéƒ¨åˆ†ï¼Œå¦‚æœç¬¦åˆæ¡ä»¶ï¼Œåˆ™å°†å…¶åŠ å…¥å­—å…¸ g ä¸­ã€‚ ä½¿ç”¨æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰æ¥æœç´¢ä»¥å¼€å¤´å­—æ¯å¼€å¤´çš„æœ€é•¿çš„â€œé¾™â€ã€‚ åœ¨æœç´¢è¿‡ç¨‹ä¸­ï¼Œä½¿ç”¨ä¸€ä¸ªå­—å…¸ cnt æ¥è®°å½•æ¯ä¸ªå•è¯çš„ä½¿ç”¨æ¬¡æ•°ï¼Œæ¯ä¸ªå•è¯æœ€å¤šåªèƒ½è¢«ä½¿ç”¨ä¸¤æ¬¡ã€‚ é€’å½’æœç´¢æ¯ä¸ªå¯è¿æ¥çš„å•è¯ï¼Œå¹¶æ›´æ–°æœ€é•¿â€œé¾™â€çš„é•¿åº¦ã€‚ æœ€ç»ˆè¾“å‡ºæœ€é•¿â€œé¾™â€çš„é•¿åº¦ã€‚ from collections import defaultdict n = int(input()) wds = [] for i in range(n): wds.append(input()) st = input() g = {w:[] for w in wds} for i in range(n): for j in range(n): for k in range(1, min( len(wds[i]), len(wds[j]) )): if wds[i][-k:] == wds[j][:k]: g[wds[i]].append((wds[j], k)) cnt = defaultdict(int) def dfs(dra, x): global ans cnt[x] += 1 ans = max(ans, len(dra)) for nx, k in g[x]: if cnt[nx] \u0026lt; 2: dfs(dra + nx[k:], nx) cnt[x] -= 1 ans = 0 for w in wds: if w[0] == st: dfs(w, w) print(ans) åˆ†æˆäº’è´¨ç»„ é¢˜ç›®å¤§æ„ï¼šç»™å®š n ä¸ªæ­£æ•´æ•°ï¼Œè¦æ±‚å°†å®ƒä»¬åˆ†ç»„ï¼Œä½¿å¾—æ¯ç»„ä¸­ä»»æ„ä¸¤ä¸ªæ•°äº’è´¨ã€‚æ±‚æœ€å°‘éœ€è¦åˆ†æˆå¤šå°‘ä¸ªç»„ã€‚\nå®ç°æ€è·¯ï¼š\né¦–å…ˆè¯»å…¥è¾“å…¥æ•°æ®ï¼ŒåŒ…æ‹¬æ­£æ•´æ•°çš„ä¸ªæ•° n å’Œ n ä¸ªæ­£æ•´æ•°ã€‚ ä½¿ç”¨æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰æ¥æœç´¢åˆ†ç»„çš„æ–¹æ³•ã€‚ æ„å»ºä¸€ä¸ªåˆ—è¡¨ gï¼Œç”¨äºå­˜å‚¨åˆ†ç»„æƒ…å†µï¼Œæ¯ä¸ªåˆ†ç»„æ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼Œåˆ—è¡¨ä¸­å­˜å‚¨åˆ†ç»„ä¸­çš„æ•°ã€‚ ç¼–å†™ DFS å‡½æ•°ï¼Œåœ¨å‡½æ•°ä¸­é€’å½’å°è¯•å°†å½“å‰æ•°æ”¾å…¥å·²æœ‰çš„åˆ†ç»„æˆ–æ–°å»ºä¸€ä¸ªåˆ†ç»„ã€‚ åœ¨é€’å½’è¿‡ç¨‹ä¸­ï¼Œå¦‚æœå½“å‰æ•°å¯ä»¥å’ŒæŸä¸ªåˆ†ç»„ä¸­çš„æ‰€æœ‰æ•°äº’è´¨ï¼Œåˆ™å°†å½“å‰æ•°åŠ å…¥è¯¥åˆ†ç»„ï¼Œå¹¶ç»§ç»­é€’å½’ã€‚ å¦‚æœå½“å‰æ•°æ— æ³•åŠ å…¥ä»»ä½•åˆ†ç»„ï¼Œåˆ™æ–°å»ºä¸€ä¸ªåˆ†ç»„ï¼Œå¹¶ç»§ç»­é€’å½’ã€‚ å½“æ‰€æœ‰æ•°éƒ½è¢«åˆ†ç»„å®Œæ¯•æ—¶ï¼Œæ›´æ–°æœ€å°‘éœ€è¦çš„ç»„æ•°ã€‚ æœ€ç»ˆè¾“å‡ºæœ€å°‘éœ€è¦çš„ç»„æ•°ã€‚ from math import gcd n = int(input()) a = list(map(int, input().split())) g = [] def dfs(u, i): global ans if i==n: ans = min(ans, u) return if u\u0026gt;=ans: return for j in range(u): cnt = sum(1 for k in g[j] if gcd(a[i], k)==1) if cnt==len(g[j]): g[j].append(a[i]) dfs(u, i+1) g[j].pop() g.append([a[i]]) dfs(u+1, i+1) g.pop() ans = n dfs(0, 0) print(ans) è¿­ä»£åŠ æ·± åŠ æˆåºåˆ— é¢˜ç›®å¤§æ„ï¼šç»™å®šä¸€ä¸ªæ•´æ•° nï¼Œæ‰¾å‡ºæ»¡è¶³ä»¥ä¸‹æ¡ä»¶çš„æœ€å°é•¿åº¦çš„â€œåŠ æˆåºåˆ—â€ï¼šåºåˆ—çš„ç¬¬ä¸€ä¸ªå…ƒç´ ä¸º1ï¼Œæœ€åä¸€ä¸ªå…ƒç´ ä¸º nï¼Œåºåˆ—ä¸­çš„å…ƒç´ æ»¡è¶³æ¯ä¸ªå…ƒç´ éƒ½å¯ä»¥è¡¨ç¤ºä¸ºåºåˆ—ä¸­å…¶ä»–ä¸¤ä¸ªå…ƒç´ çš„å’Œã€‚\nå®ç°æ€è·¯ï¼š\nå®šä¹‰ä¸€ä¸ªæ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰å‡½æ•° dfsï¼Œç”¨äºæœç´¢ç¬¦åˆæ¡ä»¶çš„åŠ æˆåºåˆ—ã€‚ åœ¨ dfs å‡½æ•°ä¸­ï¼Œä½¿ç”¨ä¸€ä¸ªåˆ—è¡¨ path æ¥è®°å½•å½“å‰æœç´¢çš„åŠ æˆåºåˆ—ï¼Œåˆå§‹åŒ– path[0] = 1ã€‚ é€’å½’åœ°æœç´¢åŠ æˆåºåˆ—çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œä½¿å¾—æ–°çš„å…ƒç´ æ˜¯å‰é¢å…ƒç´ çš„ä¸¤ä¸¤ç›¸åŠ çš„ç»“æœï¼Œå¹¶æ»¡è¶³æ¡ä»¶ path[u] \u0026lt;= nï¼Œå…¶ä¸­ u è¡¨ç¤ºå½“å‰æœç´¢çš„ä½ç½®ã€‚ å¦‚æœæœç´¢æˆåŠŸï¼Œå³æ‰¾åˆ°äº†ç¬¦åˆæ¡ä»¶çš„åŠ æˆåºåˆ—ï¼Œè¿”å› Trueï¼›å¦åˆ™è¿”å› Falseã€‚ åœ¨ä¸»ç¨‹åºä¸­ï¼Œä¸æ–­è¯»å–è¾“å…¥çš„ nï¼Œå¹¶é€šè¿‡è°ƒç”¨ dfs å‡½æ•°æ¥æœç´¢ç¬¦åˆæ¡ä»¶çš„åŠ æˆåºåˆ—ã€‚ è¾“å‡ºæ»¡è¶³æ¡ä»¶çš„åŠ æˆåºåˆ—ã€‚ def dfs(u): if u==dep: return path[u-1]==n vis = [False]*(n+1) for i in range(u-1, -1, -1): for j in range(i, -1, -1): s = path[i] + path[j] if s\u0026gt;n or s\u0026lt;=path[u-1] or vis[s]: continue vis[s] = True path[u] = s if dfs(u+1): return True return False path = [0]*(110) path[0] = 1 while True: n = int(input()) if not n: break dep = 1 while not dfs(1): dep += 1 print(*path[:dep]) åŒå‘DFS é€ç¤¼ç‰© é¢˜ç›®å¤§æ„ï¼šè¾¾è¾¾å¸®ç¿°ç¿°é€ç¤¼ç‰©ï¼Œä»–ä¸€æ¬¡å¯ä»¥æ¬åŠ¨çš„é‡é‡ä¹‹å’Œä¸è¶…è¿‡ Wï¼Œä¸€å…±æœ‰ N ä¸ªç¤¼ç‰©ï¼Œå…¶ä¸­ç¬¬ i ä¸ªç¤¼ç‰©çš„é‡é‡æ˜¯ G[i]ã€‚æ±‚è¾¾è¾¾åœ¨ä»–çš„åŠ›æ°”èŒƒå›´å†…ä¸€æ¬¡æ€§èƒ½æ¬åŠ¨çš„æœ€å¤§é‡é‡ã€‚\nå®ç°æ€è·¯ï¼š\nå®šä¹‰ä¸¤ä¸ªæ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰å‡½æ•° dfs1 å’Œ dfs2ï¼Œç”¨äºæ±‚è§£è¾¾è¾¾ä¸€æ¬¡æ€§èƒ½æ¬åŠ¨çš„æœ€å¤§é‡é‡ã€‚ dfs1 å‡½æ•°ç”¨äºéå†å‰ä¸€åŠçš„ç¤¼ç‰©ï¼Œæ±‚å¾—æ‰€æœ‰å¯èƒ½çš„æ¬åŠ¨é‡é‡ä¹‹å’Œï¼Œå¹¶å­˜å‚¨åœ¨é›†åˆ wgh ä¸­ã€‚ dfs2 å‡½æ•°ç”¨äºéå†åä¸€åŠçš„ç¤¼ç‰©ï¼Œå¹¶é€šè¿‡äºŒåˆ†æŸ¥æ‰¾åœ¨ wgh ä¸­æ‰¾åˆ°åˆé€‚çš„æ¬åŠ¨é‡é‡ï¼Œæ±‚å¾—æœ€å¤§é‡é‡ã€‚ åœ¨ä¸»ç¨‹åºä¸­ï¼Œé¦–å…ˆè¯»å…¥è¾“å…¥çš„ W å’Œ Nï¼Œç„¶åè¯»å…¥ N ä¸ªç¤¼ç‰©çš„é‡é‡ï¼Œå¹¶æŒ‰ç…§é‡é‡ä»å¤§åˆ°å°æ’åºã€‚ è°ƒç”¨ dfs1 å’Œ dfs2 å‡½æ•°æ±‚è§£æœ€å¤§é‡é‡ï¼Œå¹¶è¾“å‡ºç»“æœã€‚ def dfs1(u, tot): if u\u0026gt;k: wgh.add(tot) return if tot + a[u] \u0026lt;= w: dfs1(u+1, tot + a[u]) dfs1(u+1, tot) def dfs2(u, tot): global ans if u\u0026gt;=n: l, r = 0, cnt-1 while l\u0026lt;r: mid = (l+r+1)\u0026gt;\u0026gt;1 if wgh[mid] + tot \u0026lt;= w: l = mid else: r = mid - 1 ans = max(ans, wgh[r] + tot) return if a[u] + tot \u0026lt;= w: dfs2(u+1, a[u] + tot) dfs2(u+1, tot) w, n = map(int, input().split()) a = [] for i in range(n): a.append(int(input())) a.sort(reverse = True) wgh = set() k = n//2 dfs1(0, 0) wgh = sorted(list(wgh)) cnt = len(wgh) ans = -1 dfs2(k+1, 0) print(ans) 37. è§£æ•°ç‹¬ \\166. æ•°ç‹¬ é¢˜ç›®å¤§æ„ï¼šæ•°ç‹¬æ˜¯ä¸€ç§ç›Šæ™ºæ¸¸æˆï¼Œè¦æ±‚å¡«å†™ä¸€ä¸ª9Ã—9çš„ç½‘æ ¼ï¼Œä½¿å¾—æ¯è¡Œã€æ¯åˆ—ã€æ¯ä¸ª3Ã—3çš„ä¹å®«æ ¼å†…æ•°å­—1âˆ¼9å‡æ°å¥½å‡ºç°ä¸€æ¬¡ã€‚\nå®ç°æ€è·¯ï¼šè¯¥å®ç°é‡‡ç”¨æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰çš„æ–¹æ³•è§£å†³æ•°ç‹¬é—®é¢˜ã€‚é¦–å…ˆï¼Œé€šè¿‡å°†æ¯ä¸ªæ•°å­—æ˜ å°„åˆ°äºŒè¿›åˆ¶ä½æ¥è¿›è¡Œä½è¿ç®—ï¼Œä»¥ä¾¿å¿«é€Ÿè·å–å·²å¡«å……æ•°å­—çš„çŠ¶æ€ã€‚ç„¶åï¼Œåˆ©ç”¨DFSé€’å½’å¡«å……æ•°ç‹¬ä¸­çš„ç©ºç™½æ ¼å­ï¼Œä¼˜å…ˆé€‰æ‹©å½“å‰ç©ºç™½æ ¼å­å¡«å……æ•°å­—çš„é€‰æ‹©ç©ºé—´è¾ƒå°çš„ä½ç½®ã€‚é€’å½’çš„ç»ˆæ­¢æ¡ä»¶æ˜¯æ‰€æœ‰ç©ºç™½æ ¼å­éƒ½å¡«å……å®Œæ¯•ã€‚\nimport sys N = 9 M = 1 \u0026lt;\u0026lt; N row, col, cell = [0] * N, [0] * N, [[0] * 3 for _ in range(3)] mp = dict() ones = [0] * M for i in range(N): mp[1 \u0026lt;\u0026lt; i] = i for i in range(1 \u0026lt;\u0026lt; N): for j in range(N): ones[i] += (i \u0026gt;\u0026gt; j) \u0026amp; 1 def lowbit(x): return x \u0026amp; -x def get(x, y): return row[x] \u0026amp; col[y] \u0026amp; cell[x // 3][y // 3] def draw(x, y, t, flag): global st, row, col, cell if flag: st[x * N + y] = chr(49 + t) else: st[x * N + y] = \u0026#34;.\u0026#34; v = 1 \u0026lt;\u0026lt; t if not flag: v = -v row[x] -= v col[y] -= v cell[x // 3][y // 3] -= v def dfs(cnt): global st if not cnt: return True minv = 10 for i in range(N): for j in range(N): if st[i * N + j] == \u0026#34;.\u0026#34;: state = get(i, j) if ones[state] \u0026lt; minv: minv = ones[state] x, y = i, j i = get(x, y) while i: t = mp[lowbit(i)] draw(x, y, t, True) if dfs(cnt - 1): return True draw(x, y, t, False) i -= lowbit(i) return False while True: st = sys.stdin.readline().strip() if st == \u0026#34;end\u0026#34;: break st = list(st) cnt = 0 for i in range(N): row[i] = col[i] = M - 1 for i in range(3): for j in range(3): cell[i][j] = M - 1 for i in range(N): for j in range(N): if st[i * N + j] != \u0026#34;.\u0026#34;: t = int(st[i * N + j]) - 1 draw(i, j, t, True) else: cnt += 1 dfs(cnt) print(\u0026#34;\u0026#34;.join(st)) æœ€çŸ­è·¯ 188. æ­¦å£«é£åº¦çš„ç‰› é¢˜ç›®å¤§æ„ï¼šå†œæ°‘ John æƒ³äº¤æ˜“ä»–çš„ä¸€å¤´è¢« Don ç§°ä¸º The Knight çš„ç‰›ã€‚è¿™å¤´ç‰›æœ‰ç‰¹æ®Šèƒ½åŠ›ï¼Œå¯ä»¥æŒ‰ç…§è±¡æ£‹ä¸­é©¬çš„èµ°æ³•è·³è·ƒã€‚å†œåœºè¢«è¡¨ç¤ºä¸ºä¸€ä¸ªäºŒç»´åæ ‡å›¾ï¼Œå…¶ä¸­åŒ…å«äº†æ ‘ã€çŒæœ¨ã€çŸ³å¤´ä»¥åŠè‰çš„ä½ç½®ã€‚The Knight èµ·å§‹ä½ç½®ä¸º Kï¼Œè‰çš„ä½ç½®ä¸º Hã€‚ä»»åŠ¡æ˜¯ç¡®å®š The Knight è¦è·³å¤šå°‘æ¬¡æ‰èƒ½åˆ°è¾¾è‰çš„ä½ç½®ã€‚\nå®ç°æ€è·¯ï¼š\né¦–å…ˆè§£æè¾“å…¥ï¼Œå¾—åˆ°å†œåœºçš„åˆ—æ•°å’Œè¡Œæ•°ï¼Œä»¥åŠåœ°å›¾ä¿¡æ¯ï¼ŒåŒ…æ‹¬éšœç¢ç‰©å’Œç›®æ ‡ä½ç½®ï¼ˆè‰çš„ä½ç½®ï¼‰ã€‚ ä½¿ç”¨å¹¿åº¦ä¼˜å…ˆæœç´¢ï¼ˆBFSï¼‰ç®—æ³•æ¥æ‰¾åˆ°ä»èµ·å§‹ä½ç½®åˆ°è¾¾ç›®æ ‡ä½ç½®çš„æœ€çŸ­è·¯å¾„ã€‚ åˆå§‹åŒ–ä¸€ä¸ªé˜Ÿåˆ—ï¼Œå¹¶å°†èµ·å§‹ä½ç½®åŠ å…¥é˜Ÿåˆ—ä¸­ã€‚ åœ¨å¾ªç¯ä¸­ï¼Œæ¯æ¬¡ä»é˜Ÿåˆ—ä¸­å–å‡ºä¸€ä¸ªä½ç½®ï¼Œå¹¶å°è¯•å‘å…«ä¸ªæ–¹å‘è·³è·ƒï¼ˆè±¡æ£‹ä¸­é©¬çš„æ‰€æœ‰å¯èƒ½èµ°æ³•ï¼‰ï¼Œå¦‚æœè·³è·ƒåçš„ä½ç½®åˆæ³•ä¸”æ²¡æœ‰éšœç¢ç‰©ä¸”æœªè¢«è®¿é—®è¿‡ï¼Œåˆ™å°†è¯¥ä½ç½®åŠ å…¥é˜Ÿåˆ—ï¼Œå¹¶æ ‡è®°ä¸ºå·²è®¿é—®ã€‚ å½“å–å‡ºçš„ä½ç½®ä¸ºç›®æ ‡ä½ç½®æ—¶ï¼Œè¾“å‡ºè·³è·ƒçš„æ¬¡æ•°ï¼Œå³æœ€çŸ­è·¯å¾„çš„é•¿åº¦ï¼Œç„¶åé€€å‡ºå¾ªç¯ã€‚ å¦‚æœé˜Ÿåˆ—ä¸ºç©ºä»æœªæ‰¾åˆ°ç›®æ ‡ä½ç½®ï¼Œåˆ™è¯´æ˜æ•°æ®ä¿è¯ä¸€å®šæœ‰è§£ï¼Œä¸éœ€è¦å¤„ç†è¿™ç§æƒ…å†µã€‚ from collections import deque dir = [(-2, 1), (-1, 2), (1, 2), (2, 1), (2, -1), (1, -2), (-1, -2), (-2, -1)] c, r = map(int, input().split()) g = [[] for _ in range(r)] vis = [[False]*(c+1) for _ in range(r+1)] for i in range(r): g[i] = list(input()) for j, ch in enumerate(g[i]): if ch==\u0026#39;H\u0026#39;: end = (i, j) if ch==\u0026#39;K\u0026#39;: start = (i, j) q = deque() q.append((*start, 0)) while q: x, y, d= q.popleft() if (x, y)==end: print(d) break for i in range(8): a, b = x + dir[i][0], y + dir[i][1] if 0\u0026lt;=a\u0026lt;r and 0\u0026lt;=b\u0026lt;c: if g[a][b]!=\u0026#39;*\u0026#39; and not vis[a][b]: vis[a][b] = True q.append((a, b, d+1)) å¤šæºBFS é¢˜ç›®å¤§æ„ï¼šç»™å®šä¸€ä¸ª N è¡Œ M åˆ—çš„ 01 çŸ©é˜µ Aï¼Œå®šä¹‰çŸ©é˜µä¸­æ¯ä¸ªä½ç½®ä¸æ‰€æœ‰å€¼ä¸º1çš„ä½ç½®çš„æ›¼å“ˆé¡¿è·ç¦»ã€‚æ›¼å“ˆé¡¿è·ç¦»ä¸ºè¯¥ä½ç½®ä¸æ‰€æœ‰å€¼ä¸º1çš„ä½ç½®è¡Œåæ ‡ä¹‹å·®çš„ç»å¯¹å€¼ä¸åˆ—åæ ‡ä¹‹å·®çš„ç»å¯¹å€¼ä¹‹å’Œã€‚\nå®ç°æ€è·¯ï¼š\né¦–å…ˆè¯»å…¥çŸ©é˜µçš„è¡Œæ•°å’Œåˆ—æ•°ï¼Œä»¥åŠçŸ©é˜µæœ¬èº«ã€‚ ä½¿ç”¨BFSï¼ˆå¹¿åº¦ä¼˜å…ˆæœç´¢ï¼‰æ¥è®¡ç®—æ¯ä¸ªä½ç½®åˆ°æ‰€æœ‰å€¼ä¸º1çš„ä½ç½®çš„è·ç¦»ã€‚ åˆå§‹åŒ–ä¸€ä¸ªé˜Ÿåˆ—ï¼Œå°†æ‰€æœ‰å€¼ä¸º1çš„ä½ç½®å…¥é˜Ÿï¼Œè·ç¦»åˆå§‹åŒ–ä¸º0ã€‚ å¯¹é˜Ÿåˆ—è¿›è¡ŒBFSéå†ï¼Œæ¯æ¬¡å–å‡ºé˜Ÿé¦–å…ƒç´ ï¼Œè®¡ç®—å…¶å‘¨å›´å››ä¸ªæ–¹å‘çš„ä½ç½®ï¼Œè‹¥ä½ç½®åˆæ³•ä¸”ä¸º0ä¸”æœªè¢«è®¿é—®è¿‡ï¼Œåˆ™æ›´æ–°è·ç¦»å¹¶å…¥é˜Ÿã€‚ æœ€ç»ˆè¾“å‡ºè·ç¦»çŸ©é˜µBã€‚ import sys from collections import deque input = lambda:sys.stdin.readline().strip() N = int(1e3+10) g = [[] for _ in range(N)] dis = [[-1]*N for _ in range(N)] n, m = map(int, input().split()) for i in range(1, n+1): g[i] = [0] + list(input()) q = deque() for i in range(1, n+1): for j in range(1, m+1): if g[i][j] == \u0026#39;1\u0026#39;: q.append((i, j, 0)) dis[i][j] = 0 dx = [1, 0, -1, 0] dy = [0, 1, 0, -1] while q: x, y, d = q.popleft() for i in range(4): xx = x+dx[i]; yy = y+dy[i] if xx\u0026gt;0 and xx\u0026lt;=n and yy\u0026gt;0 and yy\u0026lt;=m: if g[xx][yy] == \u0026#39;0\u0026#39; and dis[xx][yy] == -1: dis[xx][yy] = d+1 q.append((xx, yy, d+1)) for i in range(1, n+1): print(*dis[i][1:m+1]) åŒç«¯é˜Ÿåˆ—BFS175. ç”µè·¯ç»´ä¿® é¢˜ç›®å¤§æ„ï¼šæœ‰ä¸€ä¸ªç”µè·¯æ¿ï¼Œç”± R è¡Œ C åˆ—çš„ç½‘æ ¼ç»„æˆï¼Œæ¯ä¸ªæ ¼ç‚¹éƒ½æ˜¯ç”µçº¿çš„æ¥ç‚¹ï¼Œæ¯ä¸ªæ ¼å­åŒ…å«ä¸€ä¸ªå¯æ—‹è½¬çš„ç”µå­å…ƒä»¶ï¼Œç”µå­å…ƒä»¶è¿æ¥ä¸€æ¡å¯¹è§’çº¿ä¸Šçš„ä¸¤ä¸ªæ¥ç‚¹ã€‚è¾¾è¾¾å¸Œæœ›é€šè¿‡æ—‹è½¬æœ€å°‘æ•°é‡çš„å…ƒä»¶ï¼Œä½¿ç”µæºä¸å‘åŠ¨è£…ç½®é€šè¿‡è‹¥å¹²æ¡çŸ­ç¼†ç›¸è¿ï¼Œä½†å› ä¸ºæŸäº›å…ƒä»¶çš„æ–¹å‘ä¸æ­£ç¡®ï¼Œå¯¼è‡´ç”µè·¯æ¿å¯èƒ½å¤„äºæ–­è·¯çš„çŠ¶æ€ã€‚éœ€è¦è®¡ç®—æœ€å°‘æ—‹è½¬çš„æ¬¡æ•°æ¥ä½¿å¾—ç”µæºå’Œå‘åŠ¨æœºä¹‹é—´è¿é€šã€‚\nå®ç°æ€è·¯ï¼šå¯ä»¥ä½¿ç”¨å¹¿åº¦ä¼˜å…ˆæœç´¢ï¼ˆBFSï¼‰æ¥è§£å†³æ­¤é—®é¢˜ã€‚é¦–å…ˆï¼Œåˆå§‹åŒ–ä¸€ä¸ªäºŒç»´æ•°ç»„ d ç”¨äºå­˜å‚¨ä»èµ·ç‚¹åˆ°æ¯ä¸ªç‚¹çš„æœ€çŸ­è·ç¦»ã€‚ç„¶åï¼Œåˆ©ç”¨å¹¿åº¦ä¼˜å…ˆæœç´¢çš„æ–¹å¼éå†ç”µè·¯æ¿çš„æ¯ä¸ªæ ¼ç‚¹ï¼Œå¦‚æœå‘ç°æŸä¸ªæ ¼ç‚¹çš„çŠ¶æ€éœ€è¦æ”¹å˜ï¼ˆå³å½“å‰æ ¼ç‚¹çš„å…ƒä»¶æ–¹å‘ä¸æ‰€éœ€æ–¹å‘ä¸ä¸€è‡´ï¼‰ï¼Œåˆ™æ›´æ–°è¯¥æ ¼ç‚¹çš„çŠ¶æ€å¹¶å°†å…¶åŠ å…¥åˆ°é˜Ÿåˆ—ä¸­ã€‚æœ€åï¼Œè¿”å›ç»ˆç‚¹çš„æœ€çŸ­è·ç¦»å³å¯ï¼Œå¦‚æœæ— æ³•åˆ°è¾¾ç»ˆç‚¹ï¼Œåˆ™è¾“å‡º \u0026ldquo;NO SOLUTION\u0026rdquo;ã€‚\nimport sys input = lambda:sys.stdin.readline().strip() from collections import deque dire = [(-1, -1), (-1, 1), (1, 1), (1, -1)] mov = [(-1, -1), (-1, 0), (0, 0), (0, -1)] ch = \u0026#34;\\\\/\\\\/\u0026#34; def bfs(): dq = deque() d = [[float(\u0026#39;inf\u0026#39;)]*(c+1) for _ in range(r+1)] d[0][0] = 0 dq.append((0, 0)) while dq: x, y = dq.popleft() for i in range(4): xx, yy = x + dire[i][0], y + dire[i][1] if 0\u0026lt;=xx\u0026lt;=r and 0\u0026lt;=yy\u0026lt;=c: j, k = x+mov[i][0], y + mov[i][1] w = 1 if g[j][k] != ch[i] else 0 if d[xx][yy] \u0026gt; d[x][y] + w: d[xx][yy] = d[x][y] + w if w: dq.append((xx, yy)) else: dq.appendleft((xx, yy)) return -1 if d[r][c] == float(\u0026#39;inf\u0026#39;) else d[r][c] t = int(input()) for _ in range(t): r, c = map(int, input().split()) g = [input() for _ in range(r)] res = bfs() print(res if res != -1 else \u0026#34;NO SOLUTION\u0026#34;) A* 179. å…«æ•°ç  é¢˜ç›®å¤§æ„ï¼šåœ¨ä¸€ä¸ª 3Ã—3 çš„ç½‘æ ¼ä¸­ï¼Œæ•°å­— 1âˆ¼8 ä¸ä¸€ä¸ª x æ°å¥½ä¸é‡ä¸æ¼åœ°åˆ†å¸ƒåœ¨è¿™ä¸ªç½‘æ ¼ä¸­ã€‚å¯ä»¥é€šè¿‡æŠŠ x ä¸å…¶ä¸Šã€ä¸‹ã€å·¦ã€å³å››ä¸ªæ–¹å‘ä¹‹ä¸€çš„æ•°å­—äº¤æ¢ï¼ˆå¦‚æœå­˜åœ¨ï¼‰æ¥æ”¹å˜ç½‘æ ¼çš„çŠ¶æ€ï¼Œç›®æ ‡æ˜¯é€šè¿‡æœ€å°‘çš„ç§»åŠ¨æ¬¡æ•°ï¼Œä½¿å¾—ç½‘æ ¼å˜ä¸ºæ­£ç¡®æ’åˆ—ã€‚\nå®ç°æ€è·¯ï¼šä½¿ç”¨ A* ç®—æ³•æ¥è§£å†³è¯¥é—®é¢˜ã€‚é¦–å…ˆï¼Œå®šä¹‰ä¸€ä¸ªå¯å‘å‡½æ•°ç”¨äºä¼°è®¡å½“å‰çŠ¶æ€åˆ°è¾¾ç›®æ ‡çŠ¶æ€çš„æœ€å°ç§»åŠ¨æ¬¡æ•°ã€‚ç„¶åï¼Œåˆ©ç”¨ A* ç®—æ³•è¿›è¡Œæœç´¢ï¼Œä¸æ–­æ›´æ–°å½“å‰çŠ¶æ€åˆ°è¾¾ç›®æ ‡çŠ¶æ€çš„æœ€å°ç§»åŠ¨æ¬¡æ•°ï¼Œå¹¶è®°å½•æ¯ä¸€æ­¥çš„ç§»åŠ¨æ“ä½œã€‚æœ€åï¼Œè¾“å‡ºå¾—åˆ°çš„å®Œæ•´è¡ŒåŠ¨è®°å½•å³å¯ã€‚å¦‚æœä¸å­˜åœ¨è§£å†³æ–¹æ¡ˆï¼Œåˆ™è¾“å‡º \u0026ldquo;unsolvable\u0026rdquo;ã€‚\nfrom heapq import heappush, heappop d = [(-1, 0), (0, 1), (1, 0), (0, -1)] op = \u0026#34;urdl\u0026#34; def heuristic(state): # å¯å‘å¼ ans = 0 for i, st in enumerate(state): if st==\u0026#39;x\u0026#39;: continue t = int(st)-1 ans += abs(t//3 - i//3) + abs(t%3 - i%3) return ans def astar(): dis, pre = dict(), dict() end = \u0026#34;12345678x\u0026#34; dis[start] = 0 h = [] heappush(h, (heuristic(start), start)) while h: _, state = heappop(h) if state == end: break x, y = divmod(state.index(\u0026#39;x\u0026#39;), 3) src = state for i in range(4): a, b = x+d[i][0], y+d[i][1] if 0\u0026lt;=a\u0026lt;3 and 0\u0026lt;=b\u0026lt;3: ls = list(state) ls[3*x+y], ls[3*a+b] = ls[3*a+b], ls[3*x+y] new_state = \u0026#39;\u0026#39;.join(ls) if new_state not in dis or dis[new_state] \u0026gt; dis[src] + 1: dis[new_state] = dis[src] + 1 pre[new_state] = (op[i], src) heappush(h, (dis[new_state] + heuristic(new_state), new_state)) ans = \u0026#39;\u0026#39; while end != start: ans = pre[end][0] + ans end = pre[end][1] return ans start = \u0026#39;\u0026#39;.join(input().split()) s = start.replace(\u0026#39;x\u0026#39;, \u0026#39;\u0026#39;) cnt = sum(s[i]\u0026gt;s[j] for i in range(8) for j in range(i, 8)) if cnt\u0026amp;1: print(\u0026#34;unsolvable\u0026#34;) else: print(astar()) IDA* æ’ä¹¦ å¯»æ‰¾ä¼°ä»·å‡½æ•°ï¼Œ ä¸€å®šå°äºç­‰äºçœŸå®å€¼ï¼Œå¹¶è¶Šæ¥è¿‘çœŸå®å€¼\nè¿™é“é¢˜ç›®è¦æ±‚ç»™å®š n æœ¬ä¹¦ï¼Œæ¯æœ¬ä¹¦ç¼–å·ä¸º 1 åˆ° nï¼Œåˆå§‹çŠ¶æ€ä¸‹ï¼Œä¹¦æ˜¯ä»»æ„æ’åˆ—çš„ã€‚æ¯æ¬¡æ“ä½œå¯ä»¥æŠ½å–å…¶ä¸­è¿ç»­çš„ä¸€æ®µï¼Œå†æŠŠè¿™æ®µæ’å…¥åˆ°å…¶ä»–æŸä¸ªä½ç½®ã€‚ç›®æ ‡æ˜¯å°†ä¹¦æŒ‰ç…§ 1 åˆ° n çš„é¡ºåºä¾æ¬¡æ’åˆ—ã€‚è¦æ±‚è®¡ç®—æœ€å°‘éœ€è¦å¤šå°‘æ¬¡æ“ä½œã€‚\nå®ç°æ€è·¯ï¼š\né¦–å…ˆå®šä¹‰ä¸€ä¸ªå‡½æ•° f()ï¼Œç”¨æ¥è®¡ç®—å½“å‰çŠ¶æ€ä¸ç›®æ ‡çŠ¶æ€ä¹‹é—´çš„æœ€å°æ“ä½œæ¬¡æ•°ã€‚è¿™ä¸ªå‡½æ•°é€šè¿‡éå†æ¯å¯¹ç›¸é‚»ä¹¦çš„ç¼–å·ï¼Œåˆ¤æ–­å®ƒä»¬æ˜¯å¦è¿ç»­ï¼Œå¦‚æœä¸è¿ç»­åˆ™éœ€è¦è¿›è¡Œä¸€æ¬¡æ“ä½œã€‚æœ€åè¿”å›æ“ä½œæ¬¡æ•°ã€‚ ç„¶åå®šä¹‰ä¸€ä¸ªæ·±åº¦ä¼˜å…ˆæœç´¢å‡½æ•° dfs(u)ï¼Œå…¶ä¸­ u è¡¨ç¤ºå½“å‰æœç´¢çš„æ·±åº¦ã€‚åœ¨æ¯æ¬¡æœç´¢ä¸­ï¼Œæˆ‘ä»¬éœ€è¦åˆ¤æ–­å½“å‰æ·±åº¦åŠ ä¸Šåˆ°ç›®æ ‡çŠ¶æ€çš„æœ€å°æ“ä½œæ¬¡æ•°æ˜¯å¦è¶…è¿‡å·²ç»å¾—åˆ°çš„æœ€å°æ“ä½œæ¬¡æ•°ï¼Œå¦‚æœè¶…è¿‡åˆ™ç›´æ¥è¿”å› Falseï¼Œå¦åˆ™ç»§ç»­æœç´¢ã€‚ åœ¨ dfs å‡½æ•°ä¸­ï¼Œé¦–å…ˆåˆ¤æ–­å¦‚æœå½“å‰çŠ¶æ€å·²ç»æ˜¯ç›®æ ‡çŠ¶æ€ï¼Œåˆ™ç›´æ¥è¿”å› Trueã€‚å¦åˆ™ï¼Œæˆ‘ä»¬éå†æ‰€æœ‰å¯èƒ½çš„æ“ä½œï¼Œä»ä¸­é€‰æ‹©ä¸€ç§æ“ä½œæ–¹å¼ï¼Œç„¶åé€’å½’è°ƒç”¨ dfs å‡½æ•°ã€‚ åœ¨ä¸»ç¨‹åºä¸­ï¼Œä¾æ¬¡è¯»å…¥æ¯ç»„æ•°æ®ï¼Œç„¶åè¿›è¡Œæ·±åº¦ä¼˜å…ˆæœç´¢ï¼Œç›´åˆ°å¾—åˆ°ç»“æœæˆ–è€…æœç´¢æ·±åº¦è¾¾åˆ° 5ã€‚æœ€åæ ¹æ®å¾—åˆ°çš„ç»“æœè¾“å‡ºæœ€å°æ“ä½œæ¬¡æ•°æˆ–è€… \u0026ldquo;5 or more\u0026rdquo;ã€‚ def f(): res = 0 for i in range(n-1): if a[i] != a[i+1]-1: res += 1 return (res+2)//3 def dfs(u): global a if u + f() \u0026gt; dep: return False if f()==0: return True for leng in range(n, 0, -1): for l in range(n-leng+1): r = l+leng-1 for k in range(l, r+1): bk = a[:] j = l for i in range(k+1, r+1): a[j] = bk[i] j+=1 for i in range(l, k+1): a[j] = bk[i] j+=1 if dfs(u+1): return True a = bk[:] t = int(input()) while t: t-=1 n = int(input()) a = list(map(int, input().split())) dep = 0 while dep\u0026lt;5 and not dfs(0): dep += 1 if dep \u0026lt; 5: print(dep) else: print(\u0026#34;5 or more\u0026#34;) ","permalink":"https://kennems.github.io/posts/tech/%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0%E4%B8%89%E5%9B%BE%E8%AE%BApython%E5%AE%9E%E7%8E%B0/","summary":"ç®—æ³•ç¬”è®°ï¼ˆä¸‰ï¼‰â€”â€”å›¾è®ºï¼ˆPythonå®ç°ï¼‰ å›¾è®º æ ‘çš„å­˜å‚¨ é‚»æ¥çŸ©é˜µ # åˆ›å»ºä¸€ä¸ªäºŒç»´åˆ—è¡¨è¡¨ç¤ºé‚»æ¥çŸ©é˜µ n = 10 # é¡¶ç‚¹æ•°é‡ g = [[0] * n for _ in range(n)] # æ·»åŠ ä¸€æ¡è¾¹a","title":"ç®—æ³•ç¬”è®°ï¼ˆä¸‰ï¼‰â€”â€”å›¾è®ºï¼ˆPythonå®ç°ï¼‰"},{"content":"ç®—æ³•ç¬”è®°ï¼ˆå››ï¼‰â€”â€”æ•°å­¦ï¼ˆPythonå®ç°ï¼‰ æ•°å­¦ è¯•é™¤æ³•åˆ¤å®šè´¨æ•° def check(x): # åˆ¤å®š if x\u0026lt;2: return False for i in range(2, int(x**0.5)+1): if x%i==0: return False return True n = int(input()) for i in range(n): x = int(input()) if check(x): print(\u0026#34;Yes\u0026#34;) else: print(\u0026#34;No\u0026#34;) è¯•é™¤æ³•åˆ†è§£è´¨å› æ•° def get(x): #åˆ†è§£ for i in range(2, int(x**0.5)+1): if x%i==0: cnt=0 while x%i==0: x//=i cnt+=1 print(i, cnt, sep=\u0026#39; \u0026#39;) if x\u0026gt;1: print(x, 1, sep=\u0026#39; \u0026#39;) n = int(input()) for i in range(n): x = int(input()) get(x) print() çº¿æ€§ç­›æ³•æ±‚ç´ æ•° N = int(1e6+10) primes = [] st = [False]*N def get(n): for i in range(2, n+1): if not st[i]: primes.append(i) for j in range(len(primes)): if i*primes[j]\u0026gt;n: break st[i*primes[j]]=True if i%primes[j]==0: break n = int(input()) get(n) print(len(primes)) æœ´ç´ ç­›æ³•æ±‚ç´ æ•° N = 1000005 # æ ¹æ®éœ€è¦ä¿®æ”¹ primes = [] # å­˜å‚¨æ‰€æœ‰ç´ æ•° st = [False] * N # st[x]å­˜å‚¨xæ˜¯å¦è¢«ç­›æ‰ # ç­›ç´ æ•°å‡½æ•° def get_primes(n): global primes global st for i in range(2, n + 1): if not st[i]: primes.append(i) for j in range(i, n + 1, i): st[j] = True # Example usage: # get_primes(100) # print(primes) è¯•é™¤æ³•æ±‚æ‰€æœ‰çº¦æ•° def get(x): res = [1] for i in range(2, int(x**0.5)+1): if x%i==0: res.append(i) if i!=x//i: res.append(x//i) if x\u0026gt;1: res.append(x) return sorted(res) n = int(input()) for i in range(n): x = int(input()) res = get(x) print(*res) çº¦æ•°ä¸ªæ•°å’Œçº¦æ•°ä¹‹å’Œ å¦‚æœ N = p1^c1 * p2^c2 * ... *pk^ck\rçº¦æ•°ä¸ªæ•°ï¼š (c1 + 1) * (c2 + 1) * ... * (ck + 1)\rçº¦æ•°ä¹‹å’Œï¼š (p1^0 + p1^1 + ... + p1^c1) * ... * (pk^0 + pk^1 + ... + pk^ck) çº¦æ•°ä¹‹å’Œ é¢˜ç›®å¤§æ„ï¼šç»™å®šä¸¤ä¸ªè‡ªç„¶æ•° A å’Œ Bï¼Œå®šä¹‰ S ä¸º A*B çš„æ‰€æœ‰çº¦æ•°ä¹‹å’Œã€‚æ±‚ S mod 9901 çš„å€¼ã€‚\nå®ç°æ€è·¯ï¼šé¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ç¼–å†™ä¸€ä¸ªå¿«é€Ÿå¹‚å‡½æ•° qpow(a, k) æ¥è®¡ç®—å¹‚è¿ç®—çš„ç»“æœã€‚ç„¶åï¼Œå®šä¹‰ä¸€ä¸ªå‡½æ•° calc(p, k) æ¥è®¡ç®— p^k çš„ç»“æœå¹¶å¯¹ mod å–ä½™ã€‚åœ¨ä¸»ç¨‹åºä¸­ï¼Œæˆ‘ä»¬å¯¹ A è¿›è¡Œè´¨å› æ•°åˆ†è§£ï¼Œå¹¶è®¡ç®—æ¯ä¸ªè´¨å› æ•°çš„å¹‚æ¬¡æ–¹ä¸ B çš„ä¹˜ç§¯ï¼Œå¹¶ç´¯åŠ åˆ°æœ€ç»ˆç»“æœ res ä¸­ã€‚æœ€åï¼Œè¾“å‡º res çš„å€¼å¯¹ mod 9901 å–ä½™çš„ç»“æœã€‚\nimport sys input = lambda:sys.stdin.readline().strip() mod = 9901 def qpow(a, k): res = 1 while k: if k\u0026amp;1: res = res*a%mod a = a*a%mod k\u0026gt;\u0026gt;=1 return res def calc(p, k): if k==0: return 1 if k%2==1: return (1+qpow(p, k//2+1)) * calc(p, k//2) % mod return (qpow(p, k)%mod + (1 + qpow(p, (k-1)//2+1)) * calc(p, (k-1)//2)) % mod a, b = map(int, input().split()) res = 1 for i in range(2, a+1): if a\u0026lt;i: break s = 0 while a%i==0: s+=1 a//=i if s: res = res * calc(i, s*b) % mod print(res if a else 0) gcd def gcd(a, b): return gcd(b, a % b) if b else a æ±‚æ¬§æ‹‰å‡½æ•° def get(x): res = x for i in range(2, int(x**0.5)+1): if x%i==0: res = res//i*(i-1) while x%i==0: x//=i if x\u0026gt;1: res = res//x*(x-1) return res n = int(input()) for i in range(n): x = int(input()) print(get(x)) ç­›æ³•æ±‚æ¬§æ‹‰å‡½æ•° N = int(1e6+10) primes = [] euler = [0]*N st = [False]*N cnt = 0 def get(n): euler[1] = 1 for i in range(2, n+1): if not st[i]: primes.append(i) euler[i] = i-1 for j in range(len(primes)): t = primes[j]*i if t\u0026gt;n: break st[t] = True if i%primes[j]==0: euler[t] = euler[i]*primes[j] break euler[t] = euler[i]*(primes[j]-1) n = int(input()) get(n) for i in range(1,n+1): cnt+=euler[i] print(cnt) å¿«é€Ÿå¹‚ # å¿«é€Ÿå¹‚å‡½æ•° def qmi(m, k, p): res, t = 1 % p, m while k: if k \u0026amp; 1: res = res * t % p t = t * t % p k \u0026gt;\u0026gt;= 1 return res # Example usage: # result = qmi(2, 10, 1000000007) # print(result) æ‹“å±•æ¬§å‡ é‡Œå¾— # æ±‚ x, yï¼Œä½¿å¾— ax + by = gcd(a, b) def exgcd(a, b, x, y): if b == 0: x[0], y[0] = 1, 0 return a d = exgcd(b, a % b, y, x) y[0] -= (a // b) * x[0] return d # Example usage: # x = [0] # y = [0] # gcd = exgcd(30, 20, x, y) # print(\u0026#34;x:\u0026#34;, x[0], \u0026#34;y:\u0026#34;, y[0], \u0026#34;gcd:\u0026#34;, gcd) P1082 [NOIP2012 æé«˜ç»„] åŒä½™æ–¹ç¨‹ é¢˜ç›®æè¿°ï¼šæ±‚è§£å…³äºxçš„åŒä½™æ–¹ç¨‹$ax â‰¡ 1 (mod b)$çš„æœ€å°æ­£æ•´æ•°è§£ã€‚\nå®ç°æ€è·¯ï¼šè¿™ä¸ªé—®é¢˜å¯ä»¥è½¬åŒ–ä¸ºæ±‚è§£$ax + by = gcd(a, b)$çš„è§£ï¼Œå…¶ä¸­xå°±æ˜¯æˆ‘ä»¬éœ€è¦çš„ç»“æœã€‚å¯ä»¥åˆ©ç”¨æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•æ¥æ±‚è§£è¿™ä¸ªæ–¹ç¨‹ã€‚å…·ä½“åœ°ï¼Œé€šè¿‡é€’å½’çš„æ–¹å¼æ±‚è§£å‡ºæœ€å¤§å…¬çº¦æ•°ï¼Œå¹¶ä¸”æ±‚è§£å‡ºä½¿å¾—$ax + by = gcd(a, b)$æˆç«‹çš„æ•´æ•°xå’Œyã€‚ç„¶åé€šè¿‡å¯¹xå–æ¨¡bçš„æ“ä½œå¾—åˆ°æœ€å°æ­£æ•´æ•°è§£xã€‚æœ€åè¾“å‡ºxå³å¯ã€‚\n# æ±‚ x, yï¼Œä½¿å¾— ax + by = gcd(a, b) def exgcd(a, b, x, y): if b == 0: x[0], y[0] = 1, 0 return a d = exgcd(b, a % b, y, x) y[0] -= (a // b) * x[0] return d a, b = map(int, input().split()) x, y = [0], [0] exgcd(a, b, x, y) x = x[0] x = (x%b+b)%b print(x) é€’æ¨æ³•æ±‚ç»„åˆæ•° N = int(2e3)+10 mod = int(1e9)+7 c = [[0]*N for _ in range(N)] def get(n): for i in range(n+1): for j in range(i+1): if j==0: c[i][j] = 1 else: c[i][j] = (c[i-1][j]+c[i-1][j-1])%mod MN = int(2e3) get(MN) n = int(input()) for i in range(n): a, b = map(int, input().split()) print(c[a][b]) é€šè¿‡é¢„å¤„ç†é€†å…ƒçš„æ–¹å¼æ±‚ç»„åˆæ•° mod = int(1e9)+7 N = int(2e5)+10 fact, infact = [0]*N, [0]*N def qpow(a, k, p): res = 1 while k: if k\u0026amp;1: res = (res*a)%p a = (a*a)%p k\u0026gt;\u0026gt;=1 return res def init(): fact[0] = infact[0] = 1 for i in range(1, N): fact[i] = (fact[i-1]*i)%mod infact[i] = (infact[i-1]*qpow(i, mod-2, mod))%mod def C(n, m): if n\u0026lt;m: return 0 return (fact[n]*infact[m]%mod*infact[n-m]%mod) init() n = int(input()) for i in range(n): a, b = map(int, input().split()) print(C(a, b)) Lucaså®šç† p = 1000000007 # æ ¹æ®éœ€è¦è°ƒæ•´ # å¿«é€Ÿå¹‚æ¨¡æ¿ def qmi(a, k): res = 1 while k: if k \u0026amp; 1: res = (res * a) % p a = (a * a) % p k \u0026gt;\u0026gt;= 1 return res # é€šè¿‡å®šç†æ±‚ç»„åˆæ•°C(a, b) def C(a, b): res = 1 for i in range(1, b + 1): res = (res * (a - i + 1)) % p res = (res * qmi(i, p - 2)) % p return res # Lucaså®šç†è®¡ç®—ç»„åˆæ•° def lucas(a, b): if a \u0026lt; p and b \u0026lt; p: return C(a, b) return (C(a % p, b % p) * lucas(a // p, b // p)) % p # Example usage: # result = lucas(10, 5) # è®¡ç®—ç»„åˆæ•° C(10, 5) # print(result) åˆ†è§£è´¨å› æ•°æ³•æ±‚ç»„åˆæ•° åˆ†è§£è´¨å› æ•°æ³•è®¡ç®—ç»„åˆæ•°ï¼š\nè·å–å°äºç­‰äº a çš„æ‰€æœ‰è´¨æ•°ã€‚ åˆå§‹åŒ–è´¨æ•°çš„å¹‚æ¬¡åˆ—è¡¨ sã€‚ å¯¹æ¯ä¸ªè´¨æ•° pï¼Œè®¡ç®—åœ¨ a!ï¼Œb! å’Œ (a-b)! ä¸­ p çš„å¹‚æ¬¡ï¼Œé€šè¿‡ get(a, p) - get(b, p) - get(a - b, p) å¾—åˆ°ç»„åˆæ•°åˆ†è§£ä¸­ p çš„æ€»å¹‚æ¬¡ã€‚ é€šè¿‡å¿«é€Ÿå¹‚è®¡ç®—æ¯ä¸ªè´¨æ•° p çš„å¹‚æ¬¡ä¹˜ç§¯ï¼Œæœ€ç»ˆå¾—åˆ°ç»„åˆæ•°ã€‚ def get_primes(n): primes = [] st = [False]*(n+1) for i in range(2, n+1): if not st[i]: primes.append(i) for p in primes: if i*p\u0026gt;n: break st[i*p] = True if i%p==0: break return primes def get(n, p): cnt = 0 while n: cnt += n//p n//=p return cnt def qpow(a, k): res = 1 while k: if k\u0026amp;1: res = res * a a = a*a k\u0026gt;\u0026gt;=1 return res def calc(a, b): primes = get_primes(a) n = len(primes) res = 1 for i, p in enumerate(primes): s = get(a, p) - get(b, p) - get(a-b, p) res *= qpow(p, s) return res a, b = map(int, input().split()) print(calc(a, b)) é«˜æ–¯æ¶ˆå…ƒ eps = 1e-8 # æ ¹æ®éœ€è¦è°ƒæ•´ # a æ˜¯å¢å¹¿çŸ©é˜µï¼Œn æ˜¯çŸ©é˜µç»´åº¦ def gauss(a, n): c, r = 0, 0 for c in range(n): t = r for i in range(r, n): if abs(a[i][c]) \u0026gt; abs(a[t][c]): t = i if abs(a[t][c]) \u0026lt; eps: continue for i in range(c, n + 1): a[r][i], a[t][i] = a[t][i], a[r][i] for i in range(n, c - 1, -1): a[r][i] //= a[r][c] for i in range(r + 1, n): if abs(a[i][c]) \u0026gt; eps: for j in range(n, c - 1, -1): a[i][j] -= a[r][j] * a[i][c] r += 1 if r \u0026lt; n: for i in range(r, n): if abs(a[i][n]) \u0026gt; eps: return 2 # æ— è§£ return 1 # æœ‰æ— ç©·å¤šç»„è§£ for i in range(n - 1, -1, -1): for j in range(i + 1, n): a[i][n] -= a[i][j] * a[j][n] return 0 # æœ‰å”¯ä¸€è§£ # Example usage: # a = [[2, 1, -1, 8], [-3, -1, 2, -11], [-2, 1, 2, -3]] # n = 3 # result = gauss(a, n) # print(result) ","permalink":"https://kennems.github.io/posts/tech/%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0%E5%9B%9B%E6%95%B0%E5%AD%A6python%E5%AE%9E%E7%8E%B0/","summary":"ç®—æ³•ç¬”è®°ï¼ˆå››ï¼‰â€”â€”æ•°å­¦ï¼ˆPythonå®ç°ï¼‰ æ•°å­¦ è¯•é™¤æ³•åˆ¤å®šè´¨æ•° def check(x): # åˆ¤å®š if x\u0026lt;2: return False for i in range(2, int(x**0.5)+1): if x%i==0: return False return True n = int(input()) for i in range(n): x = int(input()) if check(x): print(\u0026#34;Yes\u0026#34;) else: print(\u0026#34;No\u0026#34;) è¯•é™¤æ³•åˆ†è§£","title":"ç®—æ³•ç¬”è®°ï¼ˆå››ï¼‰â€”â€”æ•°å­¦ï¼ˆPythonå®ç°ï¼‰"},{"content":"ç®—æ³•ç¬”è®°ï¼ˆäº”ï¼‰â€”â€”DPï¼ˆPythonå®ç°ï¼‰ DP æ•°å­—ä¸‰è§’å½¢ f=[] n=int(input()) for _ in range(n): f.append([int(x) for x in input().split()]) for i in range(n-2,-1,-1): for j in range(i+1): f[i][j]=max(f[i+1][j], f[i+1][j+1])+f[i][j] print(f[0][0]) èƒŒåŒ… ç©ºé—´ä¼˜åŒ–æˆ1ç»´ä¹‹åï¼Œåªæœ‰å®Œå…¨èƒŒåŒ…é—®é¢˜çš„ä½“ç§¯æ˜¯ä»å°åˆ°å¤§å¾ªç¯çš„\n01èƒŒåŒ… N = int(1e3+10) f=[ 0 for _ in range(N) ] n,v=map(int,input().split()) for i in range(n): vi,wi=map(int,input().split()) for j in range(v, vi-1,-1): f[j]=max(f[j],f[j-vi]+wi) print(f[v]) å¤šé‡èƒŒåŒ… å•è°ƒé˜Ÿåˆ— MN = int(2e4+10) f=[0 for _ in range(MN)] q=[0 for _ in range(MN)] g=[0 for _ in range(MN)] N,V = map(int, input().split()) for i in range(N): v,w,s=map(int, input().split()) g=f[:] for j in range(v): hh,tt=0,-1 for k in range(j,V+1,v): while hh\u0026lt;=tt and q[hh]\u0026lt;k-s*v: hh+=1 while hh\u0026lt;=tt and g[q[tt]]+(k-q[tt])//v*w \u0026lt;= g[k]: tt-=1 tt+=1 q[tt]=k f[k]=g[q[hh]]+(k-q[hh])//v*w print(f[V]) äºŒç»´è´¹ç”¨èƒŒåŒ… N = int(1e2+10) f=[[0]*N for _ in range(N)] n,V,M = map(int , input().split()) for i in range(n): v,m,w=map(int , input().split()) for j in range(V,v-1,-1): for k in range(M, m-1, -1): f[j][k]=max(f[j][k], f[j-v][k-m]+w) print(f[V][M]) å® ç‰©å°ç²¾çµ é¢˜ç›®å¤§æ„ï¼šå°æ™ºåœ¨é‡å¤–æ•æ‰å® ç‰©å°ç²¾çµï¼Œä»–å¸¦äº†ä¸€äº›ç²¾çµçƒå’Œçš®å¡ä¸˜ï¼Œç²¾çµçƒå¯ä»¥æ•æ‰å°ç²¾çµï¼Œä½†æ¯æ•æ‰ä¸€ä¸ªå°ç²¾çµéƒ½ä¼šæ¶ˆè€—ç²¾çµçƒå’Œå‡å°‘çš®å¡ä¸˜çš„ä½“åŠ›ã€‚ç°åœ¨ç»™å®šå°æ™ºæ‹¥æœ‰çš„ç²¾çµçƒæ•°é‡ã€çš®å¡ä¸˜çš„åˆå§‹ä½“åŠ›å€¼ä»¥åŠæ¯ä¸ªå°ç²¾çµéœ€è¦çš„ç²¾çµçƒæ•°é‡å’Œå¯¹çš®å¡ä¸˜é€ æˆçš„ä¼¤å®³æ•°ç›®ï¼Œé—®å°æ™ºæœ€å¤šèƒ½æ•æ‰å¤šå°‘ä¸ªå°ç²¾çµï¼Œå¹¶ä¸”åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œçš®å¡ä¸˜çš„å‰©ä½™ä½“åŠ›å€¼æœ€å¤šæ˜¯å¤šå°‘ã€‚\nå®ç°æ€è·¯ï¼š\nä½¿ç”¨åŠ¨æ€è§„åˆ’ï¼Œå®šä¹‰çŠ¶æ€ f[i][j] è¡¨ç¤ºä½¿ç”¨ i ä¸ªç²¾çµçƒæ—¶ï¼Œå¯¹çš®å¡ä¸˜é€ æˆ j ä¼¤å®³æ—¶èƒ½å¤Ÿæ•æ‰åˆ°çš„å°ç²¾çµæ•°é‡ã€‚ éå†æ¯ä¸ªé‡ç”Ÿå°ç²¾çµï¼Œæ›´æ–°çŠ¶æ€æ•°ç»„ fã€‚ æœ€åè¾“å‡º f[n][m-1] è¡¨ç¤ºæ•æ‰åˆ°çš„å°ç²¾çµæ•°é‡ï¼Œç„¶åå†è®¡ç®—çš®å¡ä¸˜çš„å‰©ä½™ä½“åŠ›å€¼ã€‚ N = int(1e3+10) M = int(5e2+10) f=[[0]*M for _ in range(N)] n,m,kk = map(int, input().split()) for i in range(kk): v1,v2=map(int, input().split()) for j in range(n, v1-1, -1): for k in range(m-1,v2-1,-1): f[j][k]=max(f[j][k], f[j-v1][k-v2]+1) print(f[n][m-1], end=\u0026#34; \u0026#34;) t=m-1 while t\u0026gt;0 and f[n][m-1]==f[n][t-1]: t-=1 print(m-t) æ½œæ°´ æœ€å¤š\næ°å¥½\næœ€å°‘\né¢˜ç›®å¤§æ„ï¼šæ½œæ°´å‘˜éœ€è¦ä½¿ç”¨ç‰¹æ®Šè£…å¤‡ä¸‹æ½œï¼Œè£…å¤‡æœ‰ä¸¤ç§æ°”ç¼¸ï¼Œä¸€ç§æ°§æ°”ï¼Œä¸€ç§æ°®æ°”ï¼Œæ¯ä¸ªæ°”ç¼¸æœ‰ä¸€å®šçš„é‡é‡å’Œæ°”ä½“å®¹é‡ã€‚ä¸‹æ½œçš„æ·±åº¦éœ€è¦ä¸€å®šæ•°é‡çš„æ°§æ°”å’Œæ°®æ°”ã€‚ç°åœ¨ç»™å®šæ½œæ°´å‘˜éœ€è¦çš„æ°§æ°”å’Œæ°®æ°”çš„é‡ï¼Œä»¥åŠæ¯ä¸ªæ°”ç¼¸çš„æ°§æ°”ã€æ°®æ°”å®¹é‡å’Œé‡é‡ï¼Œæ±‚å®Œæˆå·¥ä½œæ‰€éœ€æ°”ç¼¸çš„æ€»é‡çš„æœ€ä½å€¼ã€‚\nå®ç°æ€è·¯ï¼š\nä½¿ç”¨åŠ¨æ€è§„åˆ’ï¼Œå®šä¹‰çŠ¶æ€ f[i][j] è¡¨ç¤ºæ»¡è¶³æ°§æ°”éœ€æ±‚ä¸º iï¼Œæ°®æ°”éœ€æ±‚ä¸º j æ—¶çš„æœ€å°æ°”ç¼¸æ€»é‡é‡ã€‚ éå†æ¯ä¸ªæ°”ç¼¸ï¼Œæ›´æ–°çŠ¶æ€æ•°ç»„ fã€‚ æœ€åè¾“å‡º f[m][n] è¡¨ç¤ºå®Œæˆå·¥ä½œæ‰€éœ€çš„æ°”ç¼¸çš„æ€»é‡çš„æœ€ä½å€¼ã€‚ N = int(1e2+10) INF = 0x3f3f3f3f f=[ [INF]*N for _ in range(N) ] f[0][0]=0 m,n=map(int, input().split()) k=int(input()) for i in range(k): a,b,c=map(int, input().split()) for j in range(m,-1,-1): for k in range(n,-1,-1): f[j][k]=min(f[j][k], f[max(j-a, 0)][max(k-b, 0)]+c) print(f[m][n]) åº†åŠŸä¼š é¢˜ç›®å¤§æ„ï¼šä¸ºäº†åº†ç¥ç­çº§åœ¨å­¦æ ¡è¿åŠ¨ä¼šä¸Šå–å¾—ç¬¬ä¸€åï¼Œç­ä¸»ä»»å†³å®šå¼€ä¸€åœºåº†åŠŸä¼šï¼Œå¹¶æ‹¨æ¬¾è´­ä¹°å¥–å“çŠ’åŠ³è¿åŠ¨å‘˜ã€‚éœ€è¦é€‰æ‹©è´­ä¹°çš„å¥–å“ï¼Œä½¿å¾—è´­ä¹°çš„å¥–å“çš„æ€»ä»·å€¼æœ€å¤§ï¼Œä¸”ä¸è¶…è¿‡æ‹¨æ¬¾é‡‘é¢ã€‚\nå®ç°æ€è·¯ï¼š\nä½¿ç”¨åŠ¨æ€è§„åˆ’ï¼Œå®šä¹‰çŠ¶æ€ f[i] è¡¨ç¤ºæ‹¨æ¬¾é‡‘é¢ä¸º i æ—¶å¯ä»¥è´­ä¹°çš„å¥–å“çš„æœ€å¤§æ€»ä»·å€¼ã€‚ éå†æ¯ä¸ªå¥–å“ï¼Œæ›´æ–°çŠ¶æ€æ•°ç»„ fã€‚ æœ€åè¾“å‡º f[m]ï¼Œå³æ‹¨æ¬¾é‡‘é¢ä¸º m æ—¶å¯ä»¥è´­ä¹°çš„å¥–å“çš„æœ€å¤§æ€»ä»·å€¼ã€‚ N = int(6e3+10) f=[0 for _ in range(N)] n,m = map(int, input().split()) for i in range(n): v,w,s=map(int, input().split()) for j in range(1,s+1): for k in range(m, v-1, -1): f[k]=max(f[k], f[k-v]+w) print(f[m]) åˆ†ç»„èƒŒåŒ… åˆ†ç»„èƒŒåŒ…çš„é¡ºåºï¼š\nç‰©å“ç»„ ä½“ç§¯ å†³ç­– N = int(1e2+10) f=[0 for _ in range(N)] v=[0 for _ in range(N)] w=[0 for _ in range(N)] N,V = map(int, input().split()) for i in range(N): # ç‰©å“ç»„ s=int(input()) for j in range(s): v[j],w[j]=map(int, input().split()) for j in range(V,-1,-1): #ä½“ç§¯ for k in range(s): #å†³ç­– if j\u0026gt;=v[k]: f[j]=max(f[j], f[j-v[k]]+w[k]) print(f[V]) æœºå™¨åˆ†é… å¤šé‡èƒŒåŒ…å˜ç§\né¢˜ç›®å¤§æ„ï¼šæ€»å…¬å¸æœ‰Må°ç›¸åŒçš„é«˜æ•ˆè®¾å¤‡ï¼Œè¦åˆ†ç»™Nä¸ªåˆ†å…¬å¸ã€‚æ¯ä¸ªåˆ†å…¬å¸æ ¹æ®åˆ†é…çš„è®¾å¤‡æ•°é‡èƒ½å¤Ÿä¸ºå›½å®¶å¸¦æ¥ä¸€å®šçš„ç›ˆåˆ©ã€‚é—®å¦‚ä½•åˆ†é…è¿™Må°è®¾å¤‡æ‰èƒ½ä½¿å›½å®¶å¾—åˆ°çš„ç›ˆåˆ©æœ€å¤§ï¼Œè¾“å‡ºæœ€å¤§ç›ˆåˆ©å€¼å’Œåˆ†é…æ–¹æ¡ˆã€‚\nå®ç°æ€è·¯ï¼šè¿™æ˜¯ä¸€ä¸ªç»å…¸çš„èƒŒåŒ…é—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨åŠ¨æ€è§„åˆ’æ¥è§£å†³ã€‚å®šä¹‰çŠ¶æ€dp[i][j]è¡¨ç¤ºå‰iä¸ªåˆ†å…¬å¸ä¸­ï¼Œåˆ†é…jå°è®¾å¤‡æ‰€èƒ½è·å¾—çš„æœ€å¤§ç›ˆåˆ©ã€‚è½¬ç§»æ–¹ç¨‹ä¸ºdp[i][j] = max(dp[i-1][j-k] + w[i][k])ï¼Œå…¶ä¸­kè¡¨ç¤ºç¬¬iä¸ªåˆ†å…¬å¸åˆ†é…çš„è®¾å¤‡æ•°é‡ï¼Œ0 \u0026lt;= k \u0026lt;= jã€‚æœ€åéå†æ±‚è§£å¾—åˆ°æœ€å¤§ç›ˆåˆ©å€¼ï¼Œå¹¶è®°å½•åˆ†é…æ–¹æ¡ˆã€‚\nN = 100 f=[0 for _ in range(N)] w=[[0]*N for _ in range(N)] c=[[0]*N for _ in range(N)] n,m=map(int, input().split()) for i in range(n): w[i]=[0]+[int(x) for x in input().split()] for i in range(n): for j in range(m,-1,-1): for k in range(1,j+1): if f[j-k]+w[i][k] \u0026gt; f[j]: f[j]=f[j-k]+w[i][k] c[i][j]=k print(f[m]) t=m for i in range(n-1,-1,-1): print(i+1, c[i][t]) t-=c[i][t] é‡‘æ˜çš„é¢„ç®—æ–¹æ¡ˆ é¢˜ç›®æè¿°ï¼šé‡‘æ˜æƒ³è´­ä¹°ç‰©å“ï¼Œå…¶ä¸­æœ‰ä¸»ä»¶å’Œé™„ä»¶ã€‚æ¯ä¸ªä¸»ä»¶å¯ä»¥æœ‰0ä¸ªã€1ä¸ªæˆ–2ä¸ªé™„ä»¶ï¼Œé™„ä»¶ä¸èƒ½æœ‰ä»å±äºè‡ªå·±çš„é™„ä»¶ã€‚é‡‘æ˜å¸Œæœ›åœ¨ä¸è¶…è¿‡Nå…ƒï¼ˆå¯ä»¥ç­‰äºNå…ƒï¼‰çš„å‰æä¸‹ï¼Œä½¿æ¯ä»¶ç‰©å“çš„ä»·æ ¼ä¸é‡è¦åº¦çš„ä¹˜ç§¯çš„æ€»å’Œæœ€å¤§ã€‚ç‰©å“çš„ä»·æ ¼éƒ½æ˜¯10å…ƒçš„æ•´æ•°å€ã€‚\nå®ç°æ€è·¯ï¼šè¿™ä¸ªé—®é¢˜å¯ä»¥ä½¿ç”¨åŠ¨æ€è§„åˆ’æ¥è§£å†³ã€‚é¦–å…ˆï¼Œéœ€è¦å°†ä¸»ä»¶å’Œé™„ä»¶åˆ†å¼€å¤„ç†ã€‚å¯¹äºæ¯ä¸€ä¸ªç‰©å“ï¼Œåˆ†åˆ«è€ƒè™‘ä¸åŒé™„ä»¶æ•°é‡çš„æƒ…å†µï¼Œè®¡ç®—å¯èƒ½çš„ä»·æ ¼ä¸é‡è¦åº¦ä¹˜ç§¯çš„æ€»å’Œï¼Œç„¶åæ›´æ–°åŠ¨æ€è§„åˆ’æ•°ç»„fã€‚æœ€ç»ˆï¼Œè¿”å›f[n]å³å¯å¾—åˆ°ç»“æœã€‚\nN = 80 M = 32010 f=[0 for _ in range(M)] mas=[[0,0] for _ in range(N)] ser=[[] for _ in range(N)] n,m=map(int,input().split()) for i in range(1,m+1): v,p,q=map(int, input().split()) if q==0: mas[i]=[v,v*p] else: ser[q].append((v, v*p)) for i in range(1,m+1): for j in range(n, -1, -1): for k in range( (1 \u0026lt;\u0026lt; len(ser[i]) )): v,p=mas[i] for l in range(len(ser[i])): if k\u0026gt;\u0026gt;l \u0026amp; 1: v+=ser[i][l][0] p+=ser[i][l][1] if j\u0026gt;=v: f[j]=max(f[j], f[j-v]+p) print(f[n]) æ‘˜èŠ±ç”Ÿ N = 105 f=[ [0]*N for _ in range(N)] t=int(input()) for _ in range(t): r,c=map(int, input().split()) for i in range(1,r+1): f[i] = [0] + [int(x) for x in input().split()] for j in range(1,c+1): f[i][j]+=max(f[i-1][j], f[i][j-1]) print(f[r][c]) æœ€å°é€šè¡Œè´¹ N = int(1e3+10) INF = 0x3f3f3f3f f = [[INF]*N for _ in range(N)] f[1][0]=f[0][1]=0 n=int(input()) for i in range(1,n+1): f[i]=[INF]+[int(x) for x in input().split()] for i in range(1,n+1): for j in range(1,n+1): f[i][j]+=min(f[i-1][j],f[i][j-1]) print(f[n][n]) æ–¹æ ¼ N = 15 g = [[0]*N for _ in range(N)] f = [[[[0]*N for _ in range(N)] for _ in range(N)] for _ in range(N)] n=int(input()) while True: r,c,x=map(int,input().split()) if r==0 and c==0 and x==0: break g[r][c]=x for i in range(1,n+1): for j in range(1,n+1): for k in range(1,n+1): for l in range(1,n+1): if i==k and j==l: f[i][j][k][l] = max(f[i-1][j][k-1][l], f[i-1][j][k][l-1], f[i][j-1][k-1][l], f[i][j-1][k][l-1]) + g[i][j] else: f[i][j][k][l] = max(f[i-1][j][k-1][l], f[i-1][j][k][l-1], f[i][j-1][k-1][l], f[i][j-1][k][l-1]) + g[i][j] + g[k][l] print(f[n][n][n][n]) N = 55 g=[[0]*N for _ in range(N)] f=[[[[0]*N for _ in range(N)] for _ in range(N)] for _ in range(N)] m,n=map(int, input().split()) for i in range(1,m+1): g[i]=[0]+[int(x) for x in input().split()] for i in range(1,m+1): for j in range(1,n+1): for k in range(1,m+1): for l in range(1,n+1): if i==k and j==l: f[i][j][k][l]=max(f[i-1][j][k-1][l], f[i-1][j][k][l-1], f[i][j-1][k-1][l], f[i][j-1][k][l-1])+g[i][j] else: f[i][j][k][l]=max(f[i-1][j][k-1][l], f[i-1][j][k][l-1], f[i][j-1][k-1][l], f[i][j-1][k][l-1])+g[i][j]+g[k][l] print(f[m][n][m][n]) LIS \u0026amp; LCS LIS N=int(1e3+10) f=[1 for _ in range(N)] a=[] n=int(input()) a=[0]+[int(x) for x in input().split()] for i in range(1,n+1): for j in range(1,i): if a[i]\u0026gt;a[j]: f[i]=max(f[i],f[j]+1) ans = 0 for i in range(1,n+1): ans = max(ans, f[i]) print(ans) LCS N = int(1e3+10) f=[[0]*N for _ in range(N)] a=\u0026#34;\u0026#34; b=\u0026#34;\u0026#34; n,m=map(int, input().split()) a=input() b=input() for i in range(n): for j in range(m): f[i][j]=max(f[i-1][j], f[i][j-1]) if a[i]==b[j]: f[i][j]=f[i-1][j-1]+1 print(f[n-1][m-1]) å›æº¯å¯»æ‰¾æ‰€æœ‰çš„æœ€é•¿å…¬å…±å­åºåˆ—\ndef lcs_length(X, Y): m, n = len(X), len(Y) dp = [[0] * (n + 1) for _ in range(m + 1)] for i in range(1, m + 1): for j in range(1, n + 1): if X[i - 1] == Y[j - 1]: dp[i][j] = dp[i - 1][j - 1] + 1 else: dp[i][j] = max(dp[i - 1][j], dp[i][j - 1]) return dp def find_all_lcs(X, Y, dp): def backtrack(i, j): if i == 0 or j == 0: return {\u0026#34;\u0026#34;} elif X[i - 1] == Y[j - 1]: return {lcs + X[i - 1] for lcs in backtrack(i - 1, j - 1)} else: lcs_set = set() if dp[i - 1][j] \u0026gt;= dp[i][j - 1]: lcs_set.update(backtrack(i - 1, j)) if dp[i][j - 1] \u0026gt;= dp[i - 1][j]: lcs_set.update(backtrack(i, j - 1)) return lcs_set return backtrack(len(X), len(Y)) æœ€å¤§ä¸Šå‡å­åºåˆ—å’Œ import copy a=[] f=[] ans=0 n=int(input()) a=[int(x) for x in input().split()] f=copy.deepcopy(a) for i in range(n): for j in range(i): if a[i]\u0026gt;a[j]: f[i]=max(f[i], f[j]+a[i]) for i in range(n): ans = max(ans, f[i]) print(ans) N = int(1e3+10) f=[0 for _ in range(N)] ans = 0 n=int(input()) a=[0]+[int(x) for x in input().split()] for i in range(1,n+1): f[i]=a[i] for j in range(1,i): if a[i]\u0026gt;a[j]: f[i]=max(f[i], f[j]+a[i]) ans = max(ans, f[i]) print(ans) æœ€å¤§ä¸Šå‡å­åºåˆ—II N = int(1e5+10) INF = 0x3f3f3f3f q=[INF for _ in range(N)] ans=0 n=int(input()) a=[0]+[int(x) for x in input().split()] for i in range(1,n+1): l,r=0,i while l\u0026lt;r: mid = (l+r+1)\u0026gt;\u0026gt;1 if q[mid]\u0026lt;a[i]: l=mid else: r=mid-1 ans = max(ans, l+1) q[l+1]=min(q[l+1], a[i]) print(ans) N = int(1e5+10) q=[0 for _ in range(N)] len = 0 n=int(input()) a=[0]+[int(x) for x in input().split()] for i in range(1, n+1): l,r=0,len while l\u0026lt;r: mid = (l+r+1)\u0026gt;\u0026gt;1 if q[mid]\u0026lt;a[i]: l=mid else: r=mid-1 len=max(len, l+1) q[l+1]=a[i] print(len) N = int(1e5+10) q=[0 for _ in range(N)] len = 0 n=int(input()) a=[0]+[int(x) for x in input().split()] for i in range(1,n+1): l,r=0,len while l\u0026lt;r: mid = (l+r+1)\u0026gt;\u0026gt;1 if q[mid]\u0026gt;=a[i]: r=mid-1 else: l=mid len = max(len, l+1) q[l+1]=a[i] print(len) äºŒåˆ†åŸåˆ™ï¼š\næœ‰å•è°ƒæ€§ï¼Œå¹¶ä¸”äºŒåˆ†ä¹‹åèƒ½ä¿æŒå•è°ƒæ€§\næ€ªç›—åŸºå¾·çš„æ»‘ç¿”ç¿¼ **é¢˜æ„ï¼š**æ€ªç›—åŸºå¾·éœ€è¦é€ƒè·‘ï¼ŒåŸå¸‚ä¸­æœ‰Nå¹¢å»ºç­‘æ’æˆä¸€æ¡çº¿ï¼Œæ¯å¹¢å»ºç­‘çš„é«˜åº¦å„ä¸ç›¸åŒã€‚ä»–å¸Œæœ›å°½å¯èƒ½å¤šåœ°ç»è¿‡ä¸åŒå»ºç­‘çš„é¡¶éƒ¨ï¼Œä»¥å‡ç¼“ä¸‹é™æ—¶çš„å†²å‡»åŠ›ï¼Œå‡å°‘å—ä¼¤çš„å¯èƒ½æ€§ã€‚ä»–å¯ä»¥é€‰æ‹©ä¸€ä¸ªæ–¹å‘é€ƒè·‘ï¼Œä½†ä¸èƒ½ä¸­é€”æ”¹å˜æ–¹å‘ï¼Œä¸”åªèƒ½ä»è¾ƒé«˜çš„å»ºç­‘æ»‘ç¿”åˆ°è¾ƒä½çš„å»ºç­‘ã€‚æ€ªç›—åŸºå¾·æœ€å¤šå¯ä»¥ç»è¿‡å¤šå°‘å¹¢ä¸åŒå»ºç­‘çš„é¡¶éƒ¨ï¼ˆåŒ…å«åˆå§‹æ—¶çš„å»ºç­‘ï¼‰ã€‚\n**å®ç°æ€è·¯ï¼š**å¯ä»¥ä½¿ç”¨åŠ¨æ€è§„åˆ’æ¥è§£å†³ã€‚é¦–å…ˆï¼Œå¯¹äºæ¯ä¸€åº§å»ºç­‘ï¼Œåˆ†åˆ«è®¡ç®—ä»¥è¯¥å»ºç­‘ä¸ºç»ˆç‚¹çš„æœ€é•¿é€’å¢å­åºåˆ—é•¿åº¦ï¼Œå¾—åˆ°ä»å·¦å¾€å³å’Œä»å³å¾€å·¦çš„ä¸¤ä¸ªæœ€é•¿é€’å¢å­åºåˆ—æ•°ç»„ã€‚ç„¶åå°†è¿™ä¸¤ä¸ªæ•°ç»„å¯¹åº”ä½ç½®çš„æœ€å¤§å€¼ç›¸åŠ ï¼Œå†å‡å»1ï¼ˆå› ä¸ºåˆå§‹ä½ç½®ä¹Ÿç®—ä¸€åº§å»ºç­‘ï¼‰ï¼Œå³ä¸ºæ€ªç›—åŸºå¾·æœ€å¤šå¯ä»¥ç»è¿‡çš„ä¸åŒå»ºç­‘æ•°é‡ã€‚\nN = int(1e3+10) f=[0 for _ in range(N)] t=int(input()) while t: t-=1 ans=0 n=int(input()) a=[0]+[int(x) for x in input().split()] for i in range(1,n+1): f[i]=1 for j in range(1,i): if a[i]\u0026gt;a[j]: f[i]=max(f[i], f[j]+1) ans = max(ans, f[i]) for i in range(n,0,-1): f[i]=1 for j in range(n,i,-1): if a[i]\u0026gt;a[j]: f[i]=max(f[i], f[j]+1) ans = max(ans, f[i]) print(ans) ç™»å±± N = int(1e3+10) f=[1 for _ in range(N)] g=[1 for _ in range(N)] ans = 0 n=int(input()) a=[0]+[int(x) for x in input().split()] for i in range(1,n+1): for j in range(1,i): if a[i]\u0026gt;a[j]: f[i]=max(f[i], f[j]+1) for i in range(n,0,-1): for j in range(n,i,-1): if a[i]\u0026gt;a[j]: g[i]=max(g[i], g[j]+1) for i in range(1,n+1): ans = max(ans, f[i]+g[i]-1) print(ans) åˆå”±é˜Ÿå½¢ N = int(1e3+10) f=[1 for _ in range(N)] g=[1 for _ in range(N)] ans = 0 n=int(input()) a=[0]+[int(x) for x in input().split()] for i in range(1,n+1): for j in range(1,i): if a[i]\u0026gt;a[j]: f[i]=max(f[i], f[j]+1) for i in range(n,0,-1): for j in range(n,i,-1): if a[i]\u0026gt;a[j]: g[i]=max(g[i], g[j]+1) for i in range(1,n+1): ans = max(ans, f[i]+g[i]-1) print(n-ans) å‹å¥½åŸå¸‚ N = int(5e3+10) a=[(-1,-1)] f=[1 for _ in range(N)] ans = 0 n=int(input()) for i in range(n): x,y=map(int, input().split()) a.append((x,y)) a.sort(key=lambda x:x[0]) for i in range(1,n+1): for j in range(1,i): if a[i][1]\u0026gt;a[j][1]: f[i]=max(f[i], f[j]+1) ans = max(f[i], ans) print(ans) æ‹¦æˆªå¯¼å¼¹ è´ªå¿ƒè¯æ˜\né¢˜æ„ï¼šæŸå›½ä¸ºäº†é˜²å¾¡æ•Œå›½çš„å¯¼å¼¹è¢­å‡»ï¼Œå‘å±•å‡ºä¸€ç§å¯¼å¼¹æ‹¦æˆªç³»ç»Ÿï¼Œä½†æœ‰ç¼ºé™·ï¼šæ¯ä¸€å‘ç‚®å¼¹éƒ½ä¸èƒ½é«˜äºå‰ä¸€å‘çš„é«˜åº¦ã€‚ç»™å®šå¯¼å¼¹ä¾æ¬¡é£æ¥çš„é«˜åº¦ï¼Œè®¡ç®—è¿™å¥—ç³»ç»Ÿæœ€å¤šèƒ½æ‹¦æˆªå¤šå°‘å¯¼å¼¹ï¼Œå¹¶ä¸”å¦‚æœè¦æ‹¦æˆªæ‰€æœ‰å¯¼å¼¹ï¼Œæœ€å°‘éœ€è¦é…å¤‡å¤šå°‘å¥—è¿™ç§å¯¼å¼¹æ‹¦æˆªç³»ç»Ÿã€‚\nå®ç°æ€è·¯ï¼šé¦–å…ˆä½¿ç”¨åŠ¨æ€è§„åˆ’æ±‚è§£æœ€å¤šèƒ½æ‹¦æˆªçš„å¯¼å¼¹æ•°ï¼Œç„¶åå†åˆ©ç”¨è´ªå¿ƒç®—æ³•æ±‚è§£æœ€å°‘éœ€è¦é…å¤‡çš„ç³»ç»Ÿæ•°ã€‚å…·ä½“å®ç°æ—¶ï¼Œå…ˆä»å·¦å¾€å³ä¾æ¬¡è®¡ç®—æ¯ä¸ªä½ç½®èƒ½æ‹¦æˆªçš„æœ€å¤§å¯¼å¼¹æ•°ï¼Œç„¶åå†ä»å³å¾€å·¦ä¾æ¬¡è®¡ç®—æ¯ä¸ªä½ç½®èƒ½æ‹¦æˆªçš„æœ€å¤§å¯¼å¼¹æ•°ã€‚æ¥ç€ï¼Œåˆ©ç”¨è´ªå¿ƒç®—æ³•ï¼Œéå†å¯¼å¼¹é«˜åº¦ï¼Œå¦‚æœå½“å‰é«˜åº¦å¤§äºå·²æœ‰ç³»ç»Ÿçš„é«˜åº¦ï¼Œåˆ™å¢åŠ ç³»ç»Ÿæ•°ï¼›å¦åˆ™ï¼Œæ›´æ–°å·²æœ‰ç³»ç»Ÿçš„é«˜åº¦ã€‚æœ€ç»ˆå¾—åˆ°æœ€å¤šèƒ½æ‹¦æˆªçš„å¯¼å¼¹æ•°å’Œæœ€å°‘éœ€è¦é…å¤‡çš„ç³»ç»Ÿæ•°ã€‚\nN = int(1e3+10) f=[1 for _ in range(N)] g=[0 for _ in range(N)] ans = 0 cnt = 0 a=[0]+[int(x) for x in input().split()] n=len(a) for i in range(n-1,0,-1): for j in range(n-1,i,-1): if a[i]\u0026gt;=a[j]: f[i]=max(f[i], f[j]+1) ans = max(ans, f[i]) print(ans) for i in range(1, n): k=0 while k\u0026lt;cnt and g[k]\u0026lt;a[i]: k+=1 if k\u0026gt;=cnt: cnt+=1 g[k]=a[i] print(cnt) å¯¼å¼¹é˜²å¾¡ç³»ç»Ÿ **é¢˜æ„ï¼š**Rå›½æ›´æ–°äº†å¯¼å¼¹é˜²å¾¡ç³»ç»Ÿï¼Œä¸€å¥—ç³»ç»Ÿçš„å¯¼å¼¹æ‹¦æˆªé«˜åº¦è¦ä¹ˆä¸€ç›´ä¸¥æ ¼å•è°ƒä¸Šå‡ï¼Œè¦ä¹ˆä¸€ç›´ä¸¥æ ¼å•è°ƒä¸‹é™ã€‚ç»™å®šå³å°†è¢­æ¥çš„ä¸€ç³»åˆ—å¯¼å¼¹çš„é«˜åº¦ï¼Œè¯·ä½ æ±‚å‡ºè‡³å°‘éœ€è¦å¤šå°‘å¥—é˜²å¾¡ç³»ç»Ÿï¼Œæ‰èƒ½å°†å®ƒä»¬å…¨éƒ¨å‡»è½ã€‚\n**å®ç°æ€è·¯ï¼š**å¯ä»¥åˆ©ç”¨æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰æ¥è§£å†³ã€‚é¦–å…ˆå®šä¹‰ä¸¤ä¸ªæ•°ç»„upå’Œdownï¼Œåˆ†åˆ«è¡¨ç¤ºä¸Šå‡åºåˆ—å’Œä¸‹é™åºåˆ—ã€‚ç„¶åä½¿ç”¨DFSè¿›è¡ŒçŠ¶æ€æœç´¢ï¼Œæ¯æ¬¡å°è¯•å°†å½“å‰å¯¼å¼¹åŠ å…¥ä¸Šå‡åºåˆ—æˆ–ä¸‹é™åºåˆ—ï¼Œå¹¶æ›´æ–°å½“å‰çš„é˜²å¾¡ç³»ç»Ÿæ•°é‡ã€‚æœ€ç»ˆå¾—åˆ°è‡³å°‘éœ€è¦çš„é˜²å¾¡ç³»ç»Ÿæ•°é‡ã€‚ä»£ç ä¸­çš„dfså‡½æ•°ç”¨äºè¿›è¡ŒçŠ¶æ€æœç´¢ï¼Œå°è¯•å°†å½“å‰å¯¼å¼¹åŠ å…¥ä¸Šå‡åºåˆ—æˆ–ä¸‹é™åºåˆ—ï¼Œå¹¶é€’å½’è°ƒç”¨ä¸‹ä¸€ä¸ªå¯¼å¼¹çš„å¤„ç†ã€‚æœ€ç»ˆè¾“å‡ºæœ€å°‘éœ€è¦çš„é˜²å¾¡ç³»ç»Ÿæ•°é‡ã€‚\nN = int(1e2+10) up=[0 for _ in range(N)] down=[0 for _ in range(N)] ans=0 def dfs(u, su, sd): global ans if su + sd\u0026gt;=ans: return if u==n: ans=su+sd return k=0 while k\u0026lt;su and up[k]\u0026gt;=a[u]: k+=1 t=up[k] up[k]=a[u] if k\u0026gt;=su: dfs(u+1, su+1, sd) else: dfs(u+1, su, sd) up[k]=t k=0 while k\u0026lt;sd and down[k]\u0026lt;=a[u]: k+=1 t=down[k] down[k]=a[u] if k\u0026gt;=sd: dfs(u+1, su, sd+1) else: dfs(u+1, su, sd) down[k]=t while True: n=int(input()) ans = n if n==0: break a=[int(x) for x in input().split()] dfs(0,0,0) print(ans) æœ€é•¿å…¬å…±ä¸Šå‡å­åºåˆ— é¢˜æ„ï¼šç†Šå¤§å¦ˆçš„å¥¶ç‰›ä»¬åœ¨å°æ²æ²çš„æŒ‡å¯¼ä¸‹ç ”ç©¶äº†æœ€é•¿å…¬å…±ä¸Šå‡å­åºåˆ—ï¼Œå³ä¸¤ä¸ªæ•°åˆ—ä¸­éƒ½åŒ…å«ä¸€æ®µä½ç½®ä¸ä¸€å®šè¿ç»­çš„ä¸¥æ ¼é€’å¢çš„æ•°æ®µï¼Œè¦æ±‚æ‰¾å‡ºæœ€é•¿çš„è¿™æ ·çš„å­åºåˆ—ã€‚ç°åœ¨ä½ éœ€è¦å‘Šè¯‰å¥¶ç‰›ä»¬æœ€é•¿å…¬å…±ä¸Šå‡å­åºåˆ—çš„é•¿åº¦ã€‚\nå®ç°æ€è·¯ï¼šå¯ä»¥ä½¿ç”¨åŠ¨æ€è§„åˆ’æ¥è§£å†³ã€‚å®šä¹‰ä¸€ä¸ªäºŒç»´æ•°ç»„fï¼Œå…¶ä¸­f[i][j]è¡¨ç¤ºæ•°åˆ—Açš„å‰iä¸ªå…ƒç´ å’Œæ•°åˆ—Bçš„å‰jä¸ªå…ƒç´ ä¸­ï¼Œä»¥æ•°åˆ—Açš„ç¬¬iä¸ªå…ƒç´ å’Œæ•°åˆ—Bçš„ç¬¬jä¸ªå…ƒç´ ç»“å°¾çš„æœ€é•¿å…¬å…±ä¸Šå‡å­åºåˆ—çš„é•¿åº¦ã€‚ç„¶åä½¿ç”¨åŠ¨æ€è§„åˆ’çš„æ–¹å¼å¡«è¡¨ï¼Œæœ€ç»ˆæ‰¾å‡ºæœ€é•¿çš„å…¬å…±ä¸Šå‡å­åºåˆ—çš„é•¿åº¦ã€‚\nä»£ç ä¸­çš„f[i][j]çš„çŠ¶æ€è½¬ç§»æ–¹ç¨‹å¦‚ä¸‹ï¼š\nå¦‚æœa[i]ç­‰äºb[j]ï¼Œåˆ™f[i][j]ç­‰äºf[i-1][j-1]+1ï¼ˆè¡¨ç¤ºåœ¨a[i]å’Œb[j]ç›¸ç­‰çš„æƒ…å†µä¸‹å¯ä»¥æ„æˆæ›´é•¿çš„å…¬å…±ä¸Šå‡å­åºåˆ—ï¼‰ã€‚\nå¦‚æœa[i]å¤§äºb[j]ï¼Œåˆ™f[i][j]ç­‰äºf[i-1][j]ï¼ˆè¡¨ç¤ºa[i]ä¸åœ¨å…¬å…±ä¸Šå‡å­åºåˆ—ä¸­ï¼‰ã€‚\nå¦åˆ™ï¼Œf[i][j]ç­‰äºf[i][j-1]ï¼ˆè¡¨ç¤ºb[j]ä¸åœ¨å…¬å…±ä¸Šå‡å­åºåˆ—ä¸­ï¼‰ã€‚\nN = int(3e3+10) f=[[0]*N for _ in range(N)] ans=0 n=int(input()) a=[0]+[int(x) for x in input().split()] b=[0]+[int(x) for x in input().split()] for i in range(1,n+1): maxv=1 for j in range(1,n+1): f[i][j]=f[i-1][j] if a[i]==b[j]: f[i][j]=max(f[i][j], maxv) if a[i]\u0026gt;b[j]: maxv=max(maxv, f[i][j]+1) for i in range(1,n+1): ans = max(ans, f[n][i]) print(ans) çŠ¶æ€æœºæ¨¡å‹ é—«æ°DPåˆ†ææ³•â€”â€”çŠ¶æ€æœºåˆ†ææ³•\nå¤§ç›—é˜¿ç¦ N = int(1e5+10) t=int(input()) while t: t-=1 f=[[0]*2 for _ in range(N)] n=int(input()) a=[0]+[int(x) for x in input().split()] f[1][0]=0 f[1][1]=a[1] for i in range(2,n+1): f[i][0]=max(f[i-1][1],f[i-1][0]) f[i][1]=max(f[i-1][0], f[i-2][1])+a[i] print(max(f[n][0], f[n][1])) ä¹°å–è‚¡ç¥¨ IV é¢˜ç›®å¤§æ„ï¼šç»™å®šä¸€ä¸ªé•¿åº¦ä¸ºnçš„æ•°ç»„ï¼Œè¡¨ç¤ºä¸€ä¸ªç»™å®šè‚¡ç¥¨åœ¨nå¤©å†…çš„ä»·æ ¼ã€‚è®¾è®¡ä¸€ä¸ªç®—æ³•ï¼Œè®¡ç®—å¯ä»¥è·å–çš„æœ€å¤§åˆ©æ¶¦ï¼Œæœ€å¤šå¯ä»¥å®Œæˆkç¬”äº¤æ˜“ã€‚æ¯æ¬¡ä¹°å…¥å–å‡ºåˆä¸ºä¸€ç¬”äº¤æ˜“ï¼Œä¸”ä¸èƒ½åŒæ—¶å‚ä¸å¤šç¬”äº¤æ˜“ã€‚\nå®ç°æ€è·¯ï¼š\nä½¿ç”¨åŠ¨æ€è§„åˆ’è§£å†³è¯¥é—®é¢˜ï¼Œå®šä¹‰ä¸€ä¸ªä¸‰ç»´æ•°ç»„fï¼Œå…¶ä¸­f[i][j][0]è¡¨ç¤ºç¬¬iå¤©ï¼Œå·²å®Œæˆjç¬”äº¤æ˜“ï¼Œå¹¶ä¸”æ‰‹ä¸Šæ²¡æœ‰è‚¡ç¥¨æ—¶çš„æœ€å¤§åˆ©æ¶¦ï¼›f[i][j][1]è¡¨ç¤ºç¬¬iå¤©ï¼Œå·²å®Œæˆjç¬”äº¤æ˜“ï¼Œå¹¶ä¸”æ‰‹ä¸Šæœ‰è‚¡ç¥¨æ—¶çš„æœ€å¤§åˆ©æ¶¦ã€‚ åˆå§‹åŒ–æ•°ç»„fï¼Œå°†æ‰€æœ‰ä½ç½®çš„åˆ©æ¶¦åˆå§‹åŒ–ä¸ºè´Ÿæ— ç©·-INFï¼Œè¡¨ç¤ºä¸å¯è¾¾ã€‚ éå†è‚¡ç¥¨ä»·æ ¼æ•°ç»„ï¼Œä½¿ç”¨åŠ¨æ€è§„åˆ’é€’æ¨å‡ºf[i][j][0]å’Œf[i][j][1]ï¼Œå³åœ¨ç¬¬iå¤©å·²å®Œæˆjç¬”äº¤æ˜“æ—¶çš„æœ€å¤§åˆ©æ¶¦ã€‚ æœ€ç»ˆï¼Œå–f[n][k][0]ä¸­çš„æœ€å¤§å€¼ä½œä¸ºæœ€ç»ˆç»“æœï¼Œè¡¨ç¤ºç¬¬nå¤©å·²å®Œæˆkç¬”äº¤æ˜“ï¼Œå¹¶ä¸”æ‰‹ä¸Šæ²¡æœ‰è‚¡ç¥¨æ—¶çš„æœ€å¤§åˆ©æ¶¦ã€‚ ä»£ç å®ç°å·²ç»™å‡ºï¼Œå…¶ä¸­ä½¿ç”¨äº†ä¸¤é‡å¾ªç¯æ¥å¡«å……åŠ¨æ€è§„åˆ’æ•°ç»„fï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(nk)ï¼Œå› ä¸ºnçš„æœ€å¤§å€¼ä¸º10^5ï¼Œkçš„æœ€å¤§å€¼ä¸º100ï¼Œæ‰€ä»¥ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦ä¸ºå¯æ¥å—çš„èŒƒå›´å†…ã€‚\nè¿™ä¸ªç®—æ³•çš„æ ¸å¿ƒæ€æƒ³æ˜¯åˆ©ç”¨åŠ¨æ€è§„åˆ’é€æ­¥è®¡ç®—å‡ºåœ¨æ¯ä¸€å¤©å·²å®Œæˆä¸€å®šæ•°é‡äº¤æ˜“æ—¶çš„æœ€å¤§åˆ©æ¶¦ï¼Œç„¶åæ ¹æ®é—®é¢˜è¦æ±‚å–å¾—æœ€ä¼˜è§£ã€‚\nK = 110 INF = 0x3f3f3f3f f=[[[-INF]*2 for _ in range(K)] for _ in range(2)] n,k = map(int ,input().split()) w=[0]+[int(x) for x in input().split()] f[1][0][0]=0 t=0 for i in range(1,n+1): for j in range(k+1): f[t][j][0]=max(f[t^1][j][0], f[t^1][j][1]+w[i]) f[t][j][1]=max(f[t^1][j][1], f[t^1][j-1][0]-w[i]) t^=1 res =max(f[t^1][i][0] for i in range(k+1)) print(res) è‚¡ç¥¨äº¤æ˜“V é¢˜ç›®å¤§æ„ï¼šç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„pricesï¼Œå…¶ä¸­ç¬¬iå¤©çš„è‚¡ç¥¨ä»·æ ¼ä¸ºprices[i]ã€‚è®¾è®¡ä¸€ä¸ªç®—æ³•è®¡ç®—å‡ºåœ¨æ»¡è¶³çº¦æŸæ¡ä»¶ä¸‹å¯ä»¥è·å–çš„æœ€å¤§åˆ©æ¶¦ã€‚çº¦æŸæ¡ä»¶ä¸ºï¼šå–å‡ºè‚¡ç¥¨åï¼Œä½ æ— æ³•åœ¨ç¬¬äºŒå¤©ä¹°å…¥è‚¡ç¥¨ï¼ˆå³å†·å†»æœŸä¸º1å¤©ï¼‰ï¼Œä¸”ä¸èƒ½åŒæ—¶å‚ä¸å¤šç¬”äº¤æ˜“ï¼ˆå¿…é¡»åœ¨å†æ¬¡è´­ä¹°å‰å‡ºå”®æ‰ä¹‹å‰çš„è‚¡ç¥¨ï¼‰ã€‚\nå®ç°æ€è·¯ï¼š\nä½¿ç”¨åŠ¨æ€è§„åˆ’è§£å†³è¯¥é—®é¢˜ï¼Œå®šä¹‰ä¸€ä¸ªäºŒç»´æ•°ç»„fï¼Œå…¶ä¸­f[i][j]è¡¨ç¤ºç¬¬iå¤©çš„äº¤æ˜“çŠ¶æ€ä¸ºjæ—¶çš„æœ€å¤§åˆ©æ¶¦ï¼Œjæœ‰ä¸‰ç§çŠ¶æ€ï¼š0è¡¨ç¤ºæŒæœ‰è‚¡ç¥¨ï¼Œ1è¡¨ç¤ºä¸æŒæœ‰è‚¡ç¥¨ä¸”å¤„äºå†·å†»æœŸï¼Œ2è¡¨ç¤ºä¸æŒæœ‰è‚¡ç¥¨ä¸”ä¸å¤„äºå†·å†»æœŸã€‚ åˆå§‹åŒ–æ•°ç»„fï¼Œå°†æ‰€æœ‰ä½ç½®çš„åˆ©æ¶¦åˆå§‹åŒ–ä¸ºè´Ÿæ— ç©·-INFï¼Œè¡¨ç¤ºä¸å¯è¾¾ã€‚å¹¶ä¸”å°†f[0][2]åˆå§‹åŒ–ä¸º0ï¼Œè¡¨ç¤ºç¬¬0å¤©ç»“æŸæ—¶ï¼Œä¸æŒæœ‰è‚¡ç¥¨ä¸”ä¸å¤„äºå†·å†»æœŸæ—¶çš„æœ€å¤§åˆ©æ¶¦ä¸º0ã€‚ éå†è‚¡ç¥¨ä»·æ ¼æ•°ç»„ï¼Œä½¿ç”¨åŠ¨æ€è§„åˆ’é€’æ¨å‡ºf[i][j]ï¼Œå³åœ¨ç¬¬iå¤©çš„äº¤æ˜“çŠ¶æ€ä¸ºjæ—¶çš„æœ€å¤§åˆ©æ¶¦ã€‚ æœ€ç»ˆï¼Œå–f[n][1]å’Œf[n][2]ä¸­çš„æœ€å¤§å€¼ä½œä¸ºæœ€ç»ˆç»“æœï¼Œè¡¨ç¤ºæœ€åä¸€å¤©ç»“æŸæ—¶çš„æœ€å¤§åˆ©æ¶¦ã€‚ ä»£ç å®ç°å·²ç»™å‡ºï¼Œå…¶ä¸­ä½¿ç”¨äº†ä¸€é‡å¾ªç¯æ¥å¡«å……åŠ¨æ€è§„åˆ’æ•°ç»„fï¼Œæ—¶é—´å¤æ‚åº¦ä¸º$O(n)$ï¼Œå› ä¸ºnçš„æœ€å¤§å€¼ä¸º5000ï¼Œæ‰€ä»¥ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦ä¸ºå¯æ¥å—çš„èŒƒå›´å†…ã€‚\nè¿™ä¸ªç®—æ³•çš„æ ¸å¿ƒæ€æƒ³æ˜¯åˆ©ç”¨åŠ¨æ€è§„åˆ’é€æ­¥è®¡ç®—å‡ºåœ¨æ¯ä¸€å¤©ä¸åŒäº¤æ˜“çŠ¶æ€ä¸‹çš„æœ€å¤§åˆ©æ¶¦ï¼Œç„¶åæ ¹æ®é—®é¢˜è¦æ±‚å–å¾—æœ€ä¼˜è§£ã€‚\nN = int(1e5+10) INF = 0x3f3f3f3f f=[[-INF]*3 for _ in range(N)] n=int(input()) w=[0]+[int(x) for x in input().split()] f[0][2]=0 for i in range(1,n+1): f[i][0]=max(f[i-1][0], f[i-1][2]-w[i]) f[i][1]=f[i-1][0]+w[i] f[i][2]=max(f[i-1][1], f[i-1][2]) print(max(f[n][1], f[n][2])) P1220 å…³è·¯ç¯ é¢˜æ„ï¼šè¿™ä¸ªé—®é¢˜æ˜¯å…³äºä¼˜åŒ–è€å¼ å…³ç¯é¡ºåºä»¥æœ€å°åŒ–æ€»åŠŸè€—çš„ã€‚è€å¼ æ¯æ¬¡åœ¨å¤©äº®æ—¶é¦–å…ˆå…³æ‰è‡ªå·±æ‰€å¤„ä½ç½®çš„è·¯ç¯ï¼Œç„¶åå¯ä»¥å‘å·¦æˆ–å‘å³å…³ç¯ã€‚ä¸ºäº†æœ€å°åŒ–æ€»åŠŸè€—ï¼Œéœ€è¦æ‰¾åˆ°ä¸€ä¸ªæœ€ä¼˜çš„å…³ç¯é¡ºåºã€‚\nå®ç°æ€è·¯ï¼š\né¦–å…ˆï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨åŠ¨æ€è§„åˆ’æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªä¸‰ç»´æ•°ç»„fï¼Œå…¶ä¸­f[i][j][k]è¡¨ç¤ºä»ç¬¬iç›ç¯åˆ°ç¬¬jç›ç¯ï¼Œè€å¼ æœ€åä¸€ä¸ªå…³ç¯ä½ç½®åœ¨ç¬¬kç›ç¯æ—¶çš„æœ€å°åŠŸè€—ã€‚ ç„¶åï¼Œæˆ‘ä»¬åˆå§‹åŒ–æ•°ç»„fï¼Œå°†æ‰€æœ‰ä½ç½®çš„åŠŸè€—éƒ½åˆå§‹åŒ–ä¸ºæ— ç©·å¤§INFï¼Œè¡¨ç¤ºä¸å¯è¾¾ã€‚ å¯¹äºæ¯ä¸€å¯¹è·¯ç¯iå’Œjï¼Œæˆ‘ä»¬é€šè¿‡åŠ¨æ€è§„åˆ’é€’æ¨å‡ºf[i][j][0]å’Œf[i][j][1]ï¼Œåˆ†åˆ«è¡¨ç¤ºè€å¼ ä»å·¦è¾¹æˆ–å³è¾¹èµ°åˆ°ä½ç½®iåˆ°jçš„æœ€å°åŠŸè€—ã€‚ æœ€åï¼Œæˆ‘ä»¬åªéœ€æ¯”è¾ƒf[1][n][0]å’Œf[1][n][1]ï¼Œå–å…¶ä¸­è¾ƒå°çš„å€¼ä½œä¸ºæœ€ç»ˆç­”æ¡ˆã€‚ ä½¿ç”¨äº†ä¸‰é‡å¾ªç¯æ¥å¡«å……åŠ¨æ€è§„åˆ’æ•°ç»„fï¼Œæ—¶é—´å¤æ‚åº¦ä¸º$O(n^3)$ï¼Œå› ä¸ºnçš„æœ€å¤§å€¼ä¸º50ï¼Œæ‰€ä»¥ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦ä¸ºå¯æ¥å—çš„èŒƒå›´å†…ã€‚è¿™ä¸ªç®—æ³•çš„æ ¸å¿ƒæ€æƒ³æ˜¯åˆ©ç”¨åŠ¨æ€è§„åˆ’é€æ­¥è®¡ç®—å‡ºè€å¼ ä»å·¦æˆ–å³å…³ç¯åˆ°è¾¾æ¯ä¸ªä½ç½®çš„æœ€å°åŠŸè€—ï¼Œç„¶åæ¯”è¾ƒä¸¤ç§æƒ…å†µä¸‹çš„æœ€å°åŠŸè€—ï¼Œæ‰¾åˆ°æœ€ä¼˜è§£ã€‚\nmaxn = int(8e2) + 100 INF = 0x3f3f3f3f f = [[[INF] * 2 for _ in range(maxn)] for _ in range(maxn)] a = [0] * (maxn + 1) w = [0] * (maxn + 1) sum = [0] * (maxn + 1) n, r = map(int, input().split()) for i in range(1, n + 1): a[i], w[i] = map(int, input().split()) sum[i] = sum[i - 1] + w[i] f[r][r][0] = f[r][r][1] = 0 for i in range(2, n + 1): for j in range(1, n - i + 2): l = j + i - 1 f[j][l][0] = min(f[j + 1][l][0] + (a[j + 1] - a[j]) * (sum[j] + sum[n] - sum[l]), f[j + 1][l][1] + (a[l] - a[j]) * (sum[j] + sum[n] - sum[l])) f[j][l][1] = min(f[j][l - 1][0] + (a[l] - a[j]) * (sum[j - 1] + sum[n] - sum[l - 1]), f[j][l - 1][1] + (a[l] - a[l - 1]) * (sum[j - 1] + sum[n] - sum[l - 1])) ans = min(f[1][n][0], f[1][n][1]) print(ans) çŠ¶æ€å‹ç¼©DP å°å›½ç‹ N = 13 M = 1\u0026lt;\u0026lt;N K = 110 state=[] h=[[] for _ in range(M)] cnt = [0]*M f=[[[0]*M for _ in range(K)] for _ in range(N)] def check(x): global n for i in range(n): if (x\u0026gt;\u0026gt;i)\u0026amp;1 and (x\u0026gt;\u0026gt;i+1)\u0026amp;1: return False return True def count(x): global n cnt=0 for i in range(n): if (x\u0026gt;\u0026gt;i)\u0026amp;1: cnt+=1 return cnt n,m = map(int, input().split()) for i in range(1\u0026lt;\u0026lt;n): if check(i): state.append(i) cnt[i]=count(i) for i in range(len(state)): for j in range(len(state)): a = state[i] b = state[j] if (a\u0026amp;b)==0 and check(a|b): h[i].append(j) f[0][0][0]=1 for i in range(1,n+2): for j in range(m+1): for k in range(len(state)): for t in h[k]: c = cnt[state[k]] if j\u0026gt;=c: f[i][j][state[k]]+=f[i-1][j-c][state[t]] print(f[n+1][m][0]) æ„¤æ€’çš„å°é¸Ÿ eps = 1e-6 N = 18 M = 1\u0026lt;\u0026lt;18 INF = 0x3f3f3f3f def cmp(a,b): if abs(a-b)\u0026lt;eps: return 0 if a\u0026gt;b: return 1 return -1 t = int(input()) for _ in range(t): f = [INF]*M path = [[0]*N for _ in range(N)] q = [0]*N n,m = map(int, input().split()) for i in range(n): x,y = map(float, input().split()) q[i]=(x,y) for i in range(n): path[i][i]=1\u0026lt;\u0026lt;i #å…³é”®ç‚¹ï¼šä¸å…¶ä»–ç‚¹çš„æŠ›ç‰©çº¿å¯èƒ½éƒ½ä¸åˆæ³•ï¼Œæ‰€ä»¥éœ€è¦ç‹¬ç«‹å‡ºä¸€æ¡æŠ›ç‰©çº¿ for j in range(n): x1,y1 = q[i] x2,y2 = q[j] if cmp(x1,x2)==0: continue a = (y1/x1-y2/x2)/(x1-x2) if cmp(a,0)\u0026gt;=0: continue b = y1/x1-a*x1 state=0 for k in range(n): x3,y3 = q[k] if cmp(a*x3*x3+b*x3, y3) == 0: state+=(1\u0026lt;\u0026lt;k) path[i][j]=state f[0]=0 for i in range(1\u0026lt;\u0026lt;n): for j in range(n): if not (i\u0026gt;\u0026gt;j)\u0026amp;1: x=j break for j in range(n): f[i | path[x][j]] = min(f[i | path[x][j]], f[i]+1) print(f[(1\u0026lt;\u0026lt;n)-1]) é›†åˆç±»çŠ¶æ€å‹ç¼©DP æœ€çŸ­Hamiltonè·ç¦» N = 22 M = 1\u0026lt;\u0026lt;20 INF = 0x3f3f3f3f f=[[INF]*N for _ in range(M)] w=[[]*N for _ in range(N)] n=int(input()) for i in range(n): w[i]=[int(_) for _ in input().split()] f[1][0]=0 for i in range(1\u0026lt;\u0026lt;n): for j in range(n): if i\u0026gt;\u0026gt;j\u0026amp;1: for k in range(n): if i\u0026gt;\u0026gt;k\u0026amp;1: f[i][j]=min(f[i][j], f[i-(1\u0026lt;\u0026lt;j)][k]+w[k][j]) print(f[(1\u0026lt;\u0026lt;n)-1][n-1]) åŒºé—´DP çŸ³å­åˆå¹¶ N = 1010 INF = 0x3f3f3f3f f=[[INF]*N for _ in range(N)] s=[0]*N n = int(input()) a=[0]+[int(_) for _ in input().split()] for i in range(1,n+1): f[i][i]=0 s[i]=s[i-1]+a[i] for l in range(2,n+1): for i in range(1,n-l+2): j=i+l-1 for k in range(i,j): f[i][j] = min(f[i][j], f[i][k] + f[k+1][j] + s[j]-s[i-1]) print(f[1][n]) ç¯å½¢çŸ³å­åˆå¹¶ N = 410 w=[0]*N s=[0]*N INF = 0x3f3f3f3f f=[[-INF]*N for _ in range(N)] g=[[INF]*N for _ in range(N)] n=int(input()) a= [0]+[int(_) for _ in input().split()] for i in range(1,n+1): w[i] = w[i+n] = a[i] for i in range(1,n*2+1): s[i]=s[i-1]+w[i] for l in range(1,n+1): for i in range(1,n*2-l+2): j=i+l-1 if l==1: f[i][j]=g[i][j]=0 for k in range(i,j): f[i][j] = max(f[i][j], f[i][k]+f[k+1][j]+s[j]-s[i-1]) g[i][j] = min(g[i][j], g[i][k]+g[k+1][j]+s[j]-s[i-1]) minv, maxv = INF, -INF for i in range(1,n+1): minv = min(minv, g[i][i+n-1]) maxv = max(maxv, f[i][i+n-1]) print(minv, maxv, sep=\u0026#39;\\n\u0026#39;) èƒ½é‡é¡¹é“¾ N = 210 w=[0]*N f=[[0]*N for _ in range(N)] n = int(input()) a=[0]+[int(_) for _ in input().split()] for i in range(1,n+1): w[i]=w[i+n]=a[i] for l in range(3,n+2): for i in range(1,n*2-l+2): j=i+l-1 for k in range(i+1,j): f[i][j] = max(f[i][j], f[i][k]+f[k][j]+w[i]*w[k]*w[j]) maxv = -1 for i in range(1,n+1): maxv = max(maxv, f[i][i+n]) print(maxv) å‡¸å¤šè¾¹å½¢çš„åˆ’åˆ† N = 55 INF = 1e30 f=[[INF]*N for _ in range(N)] n = int(input()) w=[0]+[int(_) for _ in input().split()] for i in range(1,n+1): f[i][i+1]=0 for l in range(3,n+1): for i in range(1, n-l+2): j=i+l-1 for k in range(i+1,j): f[i][j] = min(f[i][j], f[i][k]+f[k][j]+w[i]*w[k]*w[j]) print(f[1][n]) åŠ åˆ†äºŒå‰æ ‘ N = 50 def dfs(l, r): if l\u0026gt;r: return k=root[l][r] print(k,end=\u0026#39; \u0026#39;) dfs(l,k-1) dfs(k+1,r) n = int(input()) w = [0]+[int(_) for _ in input().split()] f=[[0]*N for _ in range(N)] root=[[0]*N for _ in range(N)] for l in range(1,n+1): for i in range(1,n-l+2): j=i+l-1 for k in range(i,j+1): left = 1 if k==i else f[i][k-1] right = 1 if k==j else f[k+1][j] s = left*right+w[k] if i==j: s=w[k] if f[i][j]\u0026lt;s: f[i][j]=s root[i][j]=k print(f[1][n]) dfs(1,n) æ ‘å½¢DP æ ‘çš„æœ€é•¿è·¯å¾„ æ³¨æ„æ³¨æ„å†æ³¨æ„ï¼Œwhileå¾ªç¯é“¾ä¸ç¬¦åˆè¦æ±‚æ˜¯éœ€è¦ i=ne[i]\nimport sys sys.setrecursionlimit(int(1e5+10)) N = 10010*2 e = [0]*N ne = [0]*N w = [0]*N h = [-1]*N idx = 1 ans = -1 def add(a, b, c): global idx e[idx]=b w[idx]=c ne[idx]=h[a] h[a]=idx idx+=1 def dfs(root, father): global ans dis, d1, d2 = 0,0,0 i=h[root] while i!=-1: j = e[i] if j==father: i=ne[i] # é‡ç‚¹ continue d = dfs(j, root)+w[i] dis = max(dis, d) if d\u0026gt;d1: d2=d1 d1=d else: d2 = max(d2, d) i=ne[i] ans = max(ans, d1+d2) return dis n = int(input()) for i in range(n-1): a,b,c = map(int, input().split()) add(a,b,c) add(b,a,c) dfs(1,-1) print(ans) æ ‘çš„ä¸­å¿ƒ é¢˜ç›®å¤§æ„ï¼šç»™å®šä¸€æ£µåŒ…å« n ä¸ªèŠ‚ç‚¹çš„æ ‘ï¼Œæ¯æ¡è¾¹éƒ½æœ‰ä¸€ä¸ªæƒå€¼ã€‚è¦æ±‚åœ¨æ ‘ä¸­æ‰¾åˆ°ä¸€ä¸ªç‚¹ï¼Œä½¿å¾—è¯¥ç‚¹åˆ°æ ‘ä¸­å…¶ä»–èŠ‚ç‚¹çš„æœ€è¿œè·ç¦»æœ€è¿‘ã€‚\nå®ç°æ€è·¯ï¼š\næ„å»ºæ— å‘å›¾çš„é‚»æ¥è¡¨ï¼Œå…¶ä¸­æ¯ä¸ªèŠ‚ç‚¹å¯¹åº”ä¸€ä¸ªé“¾è¡¨ï¼Œå­˜å‚¨å…¶ç›¸é‚»çš„èŠ‚ç‚¹ä»¥åŠå¯¹åº”çš„è¾¹æƒå€¼ã€‚ ä½¿ç”¨ DFS éå†æ ‘ï¼Œåˆ†åˆ«è®¡ç®—æ¯ä¸ªèŠ‚ç‚¹åˆ°å…¶ä»–èŠ‚ç‚¹çš„æœ€é•¿è·ç¦» d1 å’Œæ¬¡é•¿è·ç¦» d2ï¼Œå¹¶è®°å½•å…¶ç›¸é‚»èŠ‚ç‚¹ s1ã€‚ å†æ¬¡ä½¿ç”¨ DFS éå†æ ‘ï¼Œè®¡ç®—æ¯ä¸ªèŠ‚ç‚¹åˆ°å…¶ç›¸é‚»èŠ‚ç‚¹çš„æœ€é•¿è·ç¦» upã€‚ æœ€åï¼Œéå†æ‰€æœ‰èŠ‚ç‚¹ï¼Œæ±‚å‡ºæ‰€æœ‰èŠ‚ç‚¹ä¸­æœ€å¤§çš„ max(up[i], d1[i])ï¼Œå³ä¸ºæ‰€æ±‚çš„æœ€è¿‘è·ç¦»ã€‚ N = 10010*2 e = [0]*N ne=[0]*N h=[-1]*N w=[0]*N d1=[0]*N d2=[0]*N s1=[0]*N up=[0]*N idx = 1 def add(a,b,c): global idx e[idx]=b w[idx]=c ne[idx]=h[a] h[a]=idx idx+=1 def dfs1(u, father): i=h[u] while i!=-1: j=e[i] if j==father: i=ne[i] continue dfs1(j,u) dis = d1[j]+w[i] if dis\u0026gt;d1[u]: d2[u]=d1[u] d1[u], s1[u]=dis, j elif dis\u0026gt;d2[u]: d2[u]=dis i=ne[i] def dfs2(u, father): i=h[u] while i!=-1: j=e[i] if j==father: i=ne[i] continue if s1[u]==j: up[j]=max(up[u], d2[u])+w[i] else: up[j]=max(up[u], d1[u])+w[i] i=ne[i] dfs2(j, u) n = int(input()) for i in range(n-1): a,b,c = map(int ,input().split()) add(a,b,c) add(b,a,c) dfs1(1,-1) dfs2(1,-1) ans = 1e10 for i in range(1,n+1): ans = min(ans, max(up[i], d1[i])) print(ans) æ•°å­—è½¬æ¢ é¢˜ç›®å¤§æ„ï¼šç»™å®šä¸€ä¸ªæ­£æ•´æ•° nï¼Œå¦‚æœä¸€ä¸ªæ•° x çš„çº¦æ•°ä¹‹å’Œ yï¼ˆä¸åŒ…æ‹¬ x æœ¬èº«ï¼‰æ¯”å®ƒæœ¬èº«å°ï¼Œé‚£ä¹ˆ x å¯ä»¥å˜ä¸º yï¼Œy ä¹Ÿå¯ä»¥å˜ä¸º xã€‚é™å®šæ‰€æœ‰æ•°å­—å˜æ¢åœ¨ä¸è¶…è¿‡ n çš„æ­£æ•´æ•°èŒƒå›´å†…è¿›è¡Œï¼Œæ±‚ä¸æ–­è¿›è¡Œæ•°å­—å˜æ¢ä¸”ä¸å‡ºç°é‡å¤æ•°å­—çš„æœ€å¤šå˜æ¢æ­¥æ•°ã€‚\nå®ç°æ€è·¯ï¼š\né¦–å…ˆï¼Œå¯¹äºæ¯ä¸ªæ•° iï¼Œè®¡ç®—å…¶æ‰€æœ‰çº¦æ•°ä¹‹å’Œï¼Œå¹¶å­˜å‚¨åœ¨æ•°ç»„ s ä¸­ã€‚ ç„¶åï¼Œéå†æ‰€æœ‰çš„æ•° iï¼Œå¦‚æœçº¦æ•°ä¹‹å’Œ s[i] å°äº iï¼Œåˆ™å°†å…¶ä½œä¸ºä¸€ä¸ªèŠ‚ç‚¹æ·»åŠ åˆ°æœ‰å‘å›¾ä¸­ï¼Œè¡¨ç¤ºå¯ä»¥ä» s[i] å˜æ¢åˆ° iã€‚ æ„å»ºæœ‰å‘å›¾åï¼Œä½¿ç”¨æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰ç®—æ³•éå†å›¾ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹ï¼Œå¹¶æ±‚å‡ºæ¯ä¸ªèŠ‚ç‚¹çš„æœ€é•¿è·¯å¾„é•¿åº¦ã€‚ åœ¨DFSè¿‡ç¨‹ä¸­ï¼Œä½¿ç”¨å˜é‡ ans è®°å½•å›¾ä¸­æœ€é•¿è·¯å¾„çš„é•¿åº¦ï¼Œå³æœ€å¤šå˜æ¢æ­¥æ•°ã€‚ æœ€åï¼Œè¾“å‡º ans å³å¯ã€‚ N = int(5e4+10) s=[0]*N st=[False]*N e=[0]*N ne=[0]*N h=[-1]*N idx=1 ans = -1 def add(a,b): global idx e[idx]=b ne[idx]=h[a] h[a]=idx idx+=1 def dfs(u): global ans d1,d2=0,0 i=h[u] while i!=-1: j=e[i] dis = dfs(j)+1 if dis\u0026gt;d1: d2,d1=d1,dis elif dis\u0026gt;d2: d2=dis i=ne[i] ans = max(ans, d1+d2) return d1 n = int(input()) for i in range(1,n+1): for j in range(2,n+1): if i\u0026gt;n//j: break s[i*j]+=i for i in range(2,n+1): if s[i]\u0026lt;i: add(s[i], i) st[i]=True # for i in range(1,n+1): # if not st[i]: # dfs(i) dfs(1) print(ans) æ²¡æœ‰ä¸Šå¸çš„èˆä¼š é¢˜ç›®å¤§æ„ï¼šUralå¤§å­¦æœ‰NåèŒå‘˜ï¼Œç¼–å·ä¸º1âˆ¼Nã€‚ä»–ä»¬çš„å…³ç³»åƒä¸€æ£µä»¥æ ¡é•¿ä¸ºæ ¹çš„æ ‘ï¼Œçˆ¶èŠ‚ç‚¹å°±æ˜¯å­èŠ‚ç‚¹çš„ç›´æ¥ä¸Šå¸ã€‚æ¯ä¸ªèŒå‘˜æœ‰ä¸€ä¸ªå¿«ä¹æŒ‡æ•°ï¼Œç”¨æ•´æ•°Hiè¡¨ç¤ºã€‚ç°åœ¨è¦å¬å¼€ä¸€åœºå‘¨å¹´åº†å®´ä¼šï¼Œä½†æ²¡æœ‰èŒå‘˜æ„¿æ„å’Œç›´æ¥ä¸Šå¸ä¸€èµ·å‚ä¼šã€‚åœ¨æ»¡è¶³è¿™ä¸ªæ¡ä»¶çš„å‰æä¸‹ï¼Œä¸»åŠæ–¹å¸Œæœ›é‚€è¯·ä¸€éƒ¨åˆ†èŒå‘˜å‚ä¼šï¼Œä½¿å¾—æ‰€æœ‰å‚ä¼šèŒå‘˜çš„å¿«ä¹æŒ‡æ•°æ€»å’Œæœ€å¤§ï¼Œæ±‚è¿™ä¸ªæœ€å¤§å€¼ã€‚\nå®ç°æ€è·¯ï¼š\né¦–å…ˆï¼Œå»ºç«‹ä¸€æ£µä»¥æ ¡é•¿ä¸ºæ ¹çš„æ ‘ï¼Œä½¿ç”¨ä¸€ä¸ªäºŒç»´æ•°ç»„væ¥å­˜å‚¨æ ‘çš„ç»“æ„å…³ç³»ï¼Œå…¶ä¸­v[i]è¡¨ç¤ºç¬¬iä¸ªèŒå‘˜çš„ç›´æ¥ä¸‹å±ã€‚ ä½¿ç”¨ä¸€ä¸ªäºŒç»´æ•°ç»„fæ¥è®°å½•æ¯ä¸ªèŒå‘˜å‚åŠ å’Œä¸å‚åŠ å®´ä¼šæ—¶çš„æœ€å¤§å¿«ä¹æŒ‡æ•°ï¼Œå…¶ä¸­f[i][0]è¡¨ç¤ºç¬¬iä¸ªèŒå‘˜ä¸å‚åŠ å®´ä¼šæ—¶çš„æœ€å¤§å¿«ä¹æŒ‡æ•°ï¼Œf[i][1]è¡¨ç¤ºç¬¬iä¸ªèŒå‘˜å‚åŠ å®´ä¼šæ—¶çš„æœ€å¤§å¿«ä¹æŒ‡æ•°ã€‚ ä½¿ç”¨æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰æ¥éå†æ ‘çš„æ¯ä¸ªèŠ‚ç‚¹ï¼Œè®¡ç®—æ¯ä¸ªèŠ‚ç‚¹ä¸å‚åŠ å’Œå‚åŠ å®´ä¼šæ—¶çš„æœ€å¤§å¿«ä¹æŒ‡æ•°ã€‚ åœ¨DFSè¿‡ç¨‹ä¸­ï¼Œå¯¹äºæ¯ä¸ªèŠ‚ç‚¹iï¼Œé¦–å…ˆæ›´æ–°è¯¥èŠ‚ç‚¹å‚åŠ å®´ä¼šæ—¶çš„æœ€å¤§å¿«ä¹æŒ‡æ•°f[i][1]ä¸ºå½“å‰èŠ‚ç‚¹çš„å¿«ä¹æŒ‡æ•°h[i]ï¼Œç„¶åéå†å½“å‰èŠ‚ç‚¹çš„ç›´æ¥ä¸‹å±ï¼Œæ›´æ–°å½“å‰èŠ‚ç‚¹å‚åŠ å’Œä¸å‚åŠ å®´ä¼šæ—¶çš„æœ€å¤§å¿«ä¹æŒ‡æ•°ã€‚ æœ€ç»ˆï¼Œå–æ ¹èŠ‚ç‚¹çš„å‚åŠ å’Œä¸å‚åŠ å®´ä¼šæ—¶çš„æœ€å¤§å¿«ä¹æŒ‡æ•°çš„è¾ƒå¤§å€¼ä½œä¸ºæœ€ç»ˆç»“æœã€‚ ä»£ç å®ç°å·²ç»™å‡ºï¼Œå…¶ä¸­ä½¿ç”¨äº†æ·±åº¦ä¼˜å…ˆæœç´¢æ¥éå†æ ‘çš„æ¯ä¸ªèŠ‚ç‚¹ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(N)ï¼Œå› ä¸ºNçš„æœ€å¤§å€¼ä¸º6000ï¼Œæ‰€ä»¥ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦ä¸ºå¯æ¥å—çš„èŒƒå›´å†…ã€‚\nè¿™ä¸ªç®—æ³•çš„æ ¸å¿ƒæ€æƒ³æ˜¯åˆ©ç”¨æ·±åº¦ä¼˜å…ˆæœç´¢é€æ­¥è®¡ç®—å‡ºæ¯ä¸ªèŠ‚ç‚¹å‚åŠ å’Œä¸å‚åŠ å®´ä¼šæ—¶çš„æœ€å¤§å¿«ä¹æŒ‡æ•°ï¼Œç„¶åæ ¹æ®é—®é¢˜è¦æ±‚æ‰¾åˆ°æœ€å¤§çš„å¿«ä¹æŒ‡æ•°ã€‚\nimport sys sys.setrecursionlimit(int(1e4)) N = int(7e3) v=[[] for _ in range(N)] f=[[0]*2 for _ in range(N)] st=[False]*N h=[0]*N root=0 def dfs(u): f[u][1]+=h[u] for i in v[u]: dfs(i) f[u][1]+=f[i][0] f[u][0]+=max(f[i][0], f[i][1]) n = int(input()) for i in range(1,n+1): h[i]=int(input()) for i in range(n-1): l,k = map(int, input().split()) v[k].append(l) st[l]=True for i in range(1,n+1): if not st[i]: root=i dfs(root) print(max(f[root][0], f[root][1])) å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–çš„DP æœ€å¤§å­åºå’Œ é¢˜ç›®å¤§æ„ï¼šç»™å®šä¸€ä¸ªé•¿åº¦ä¸ºnçš„æ•´æ•°åºåˆ—ï¼Œä»ä¸­æ‰¾å‡ºä¸€æ®µé•¿åº¦ä¸è¶…è¿‡mçš„è¿ç»­å­åºåˆ—ï¼Œä½¿å¾—å­åºåˆ—ä¸­æ‰€æœ‰æ•°çš„å’Œæœ€å¤§ã€‚è¦æ±‚è¾“å‡ºè¯¥åºåˆ—çš„æœ€å¤§å­åºå’Œã€‚\nå®ç°æ€è·¯ï¼š\né¦–å…ˆï¼Œå°†è¾“å…¥çš„åºåˆ—è¿›è¡Œé¢„å¤„ç†ï¼Œè®¡ç®—å‡ºå‰ç¼€å’Œæ•°ç»„sï¼Œå…¶ä¸­s[i]è¡¨ç¤ºåºåˆ—çš„å‰iä¸ªæ•°çš„å’Œã€‚ ä½¿ç”¨å•è°ƒé˜Ÿåˆ—æ¥è§£å†³è¯¥é—®é¢˜ã€‚å•è°ƒé˜Ÿåˆ—ç»´æŠ¤çš„æ˜¯å‰ç¼€å’Œæ•°ç»„sä¸­çš„ä¸‹æ ‡ï¼Œé˜Ÿåˆ—ä¸­çš„å…ƒç´ æŒ‰ç…§å‰ç¼€å’Œçš„å€¼å•è°ƒé€’å¢ã€‚é˜Ÿåˆ—ä¸­çš„ä¸‹æ ‡è¡¨ç¤ºçš„æ˜¯ä»¥è¯¥ä¸‹æ ‡ç»“å°¾çš„è¿ç»­å­åºåˆ—çš„æœ€å¤§å’Œã€‚ éå†åºåˆ—ï¼Œå¯¹äºæ¯ä¸ªä½ç½®iï¼Œæ›´æ–°å•è°ƒé˜Ÿåˆ—ä¸­çš„å…ƒç´ ï¼Œä½¿å¾—é˜Ÿåˆ—ä¸­çš„ä¸‹æ ‡ç¬¦åˆè¦æ±‚ï¼Œå³æ»¡è¶³é•¿åº¦ä¸è¶…è¿‡mçš„è¿ç»­å­åºåˆ—çš„æ¡ä»¶ã€‚ åœ¨éå†çš„è¿‡ç¨‹ä¸­ï¼Œä¸æ–­æ›´æ–°è®°å½•æœ€å¤§å­åºå’Œçš„å˜é‡ansï¼Œæœ€ç»ˆå¾—åˆ°çš„anså³ä¸ºæ‰€æ±‚ç»“æœã€‚ ä»£ç å®ç°å·²ç»™å‡ºï¼Œå…¶ä¸­ä½¿ç”¨äº†å•è°ƒé˜Ÿåˆ—æ¥ç»´æŠ¤æ»¡è¶³æ¡ä»¶çš„ä¸‹æ ‡ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(n)ï¼Œå› ä¸ºnçš„æœ€å¤§å€¼ä¸º300000ï¼Œæ‰€ä»¥ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦ä¸ºå¯æ¥å—çš„èŒƒå›´å†…ã€‚\nè¿™ä¸ªç®—æ³•çš„æ ¸å¿ƒæ€æƒ³æ˜¯åˆ©ç”¨å•è°ƒé˜Ÿåˆ—ç»´æŠ¤ä»¥æ¯ä¸ªä½ç½®ç»“å°¾çš„æ»¡è¶³æ¡ä»¶çš„å­åºåˆ—çš„æœ€å¤§å’Œï¼Œç„¶åæ ¹æ®é—®é¢˜è¦æ±‚æ‰¾åˆ°æœ€å¤§å­åºå’Œã€‚\nN = 300010 q, s = [0]*N, [0]*N ans = -2**33 hh, tt = 0, 0 n,m = map(int, input().split()) s = [0]+list(map(int, input().split())) for i in range(1,n+1): s[i]+=s[i-1] for i in range(1,n+1): if q[hh]\u0026lt;i-m: hh+=1 ans = max(ans, s[i]-s[q[hh]]) while hh\u0026lt;=tt and s[q[tt]]\u0026gt;=s[i]: tt-=1 tt+=1 q[tt]=i print(ans) æ•°ä½DP 1081\nfrom typing import List N = 35 def init() -\u0026gt; List[List[int]]: f = [[0] * N for _ in range(N)] for i in range(N): for j in range(i + 1): if j == 0: f[i][j] = 1 else: f[i][j] = f[i - 1][j] + f[i - 1][j - 1] return f def dp(n: int, k: int, b: int, f: List[List[int]]) -\u0026gt; int: if n == 0: return 0 nums = [] while n: nums.append(n % b) n //= b res = 0 last = 0 for i in range(len(nums) - 1, -1, -1): x = nums[i] if x \u0026gt; 0: res += f[i][k - last] if x \u0026gt; 1: if k - last - 1 \u0026gt;= 0: res += f[i][k - last - 1] break else: last += 1 if last \u0026gt; k: break if i == 0 and last == k: res += 1 return res def solve(l: int, r: int, k: int, b: int) -\u0026gt; int: f = init() return dp(r, k, b, f) - dp(l - 1, k, b, f) if __name__ == \u0026#34;__main__\u0026#34;: l, r, k, b = map(int, input().split()) print(solve(l, r, k, b)) è®°å¿†åŒ– æ»‘é›ª é¢˜ç›®å¤§æ„ï¼šMichaelå–œæ¬¢æ»‘é›ªï¼Œå¹¶å¸Œæœ›çŸ¥é“åœ¨ä¸€ä¸ªåŒºåŸŸä¸­æœ€é•¿çš„æ»‘å¡ã€‚ç»™å®šä¸€ä¸ªäºŒç»´æ•°ç»„è¡¨ç¤ºåŒºåŸŸï¼Œæ•°ç»„ä¸­çš„æ¯ä¸ªæ•°å­—ä»£è¡¨ç‚¹çš„é«˜åº¦ã€‚ä¸€ä¸ªäººå¯ä»¥ä»æŸä¸ªç‚¹æ»‘å‘ä¸Šä¸‹å·¦å³ç›¸é‚»å››ä¸ªç‚¹ä¹‹ä¸€ï¼Œå½“ä¸”ä»…å½“é«˜åº¦ä¼šå‡å°ã€‚è¦æ±‚æ‰¾åˆ°æœ€é•¿çš„æ»‘å¡ï¼Œå³ä»ä¸€ä¸ªé«˜ç‚¹å¼€å§‹ï¼Œä¸€ç›´æ»‘åˆ°ä¸€ä¸ªä½ç‚¹ã€‚\nå®ç°æ€è·¯ï¼š\nä½¿ç”¨ä¼˜å…ˆé˜Ÿåˆ—ï¼ˆå †ï¼‰æ¥å®ç°å¹¿åº¦ä¼˜å…ˆæœç´¢ï¼ˆBFSï¼‰ã€‚ é¦–å…ˆï¼Œåˆå§‹åŒ–ä¸€ä¸ªäºŒç»´æ•°ç»„fç”¨äºå­˜å‚¨ä»æ¯ä¸ªç‚¹å‡ºå‘çš„æœ€é•¿æ»‘å¡è·ç¦»ï¼Œåˆå§‹åŒ–ä¼˜å…ˆé˜Ÿåˆ—pqç”¨äºå­˜å‚¨å¾…æœç´¢çš„ç‚¹ã€‚ å°†æ‰€æœ‰ç‚¹æŒ‰ç…§é«˜åº¦ä»å°åˆ°å¤§åŠ å…¥ä¼˜å…ˆé˜Ÿåˆ—pqã€‚ å¯¹äºä¼˜å…ˆé˜Ÿåˆ—ä¸­çš„æ¯ä¸ªç‚¹ï¼Œä¾æ¬¡å‘ä¸Šä¸‹å·¦å³å››ä¸ªæ–¹å‘æœç´¢ï¼Œå¦‚æœä¸‹ä¸€ä¸ªç‚¹çš„é«˜åº¦å°äºå½“å‰ç‚¹ï¼Œåˆ™æ›´æ–°ä¸‹ä¸€ä¸ªç‚¹çš„æœ€é•¿æ»‘å¡è·ç¦»ä¸ºå½“å‰ç‚¹çš„æœ€é•¿æ»‘å¡è·ç¦»åŠ 1ã€‚ åœ¨æœç´¢è¿‡ç¨‹ä¸­ï¼Œä¸æ–­æ›´æ–°è®°å½•æœ€é•¿æ»‘å¡è·ç¦»çš„å˜é‡maï¼Œæœ€ç»ˆå¾—åˆ°çš„maå³ä¸ºæœ€é•¿æ»‘å¡çš„é•¿åº¦ã€‚ ä»£ç å®ç°å·²ç»™å‡ºï¼Œå…¶ä¸­ä½¿ç”¨äº†ä¼˜å…ˆé˜Ÿåˆ—pqæ¥è¿›è¡Œå¹¿åº¦ä¼˜å…ˆæœç´¢ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(nmlog(nm))ï¼Œå› ä¸ºnå’Œmçš„æœ€å¤§å€¼ä¸º100ï¼Œæ‰€ä»¥ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦ä¸ºå¯æ¥å—çš„èŒƒå›´å†…ã€‚\nè¿™ä¸ªç®—æ³•çš„æ ¸å¿ƒæ€æƒ³æ˜¯åˆ©ç”¨å¹¿åº¦ä¼˜å…ˆæœç´¢é€æ­¥è®¡ç®—å‡ºä»æ¯ä¸ªç‚¹å‡ºå‘çš„æœ€é•¿æ»‘å¡è·ç¦»ï¼Œç„¶åæ ¹æ®é—®é¢˜è¦æ±‚æ‰¾åˆ°æœ€é•¿çš„æ»‘å¡ã€‚\nfrom heapq import * n, m = map(int, input().split()) f = [[0] * (m + 5) for _ in range(n + 5)] # distance g = [[0] * (m + 5) for _ in range(n + 5)] # store heights pq = [] for i in range(1, n + 1): nums = [0] + list(map(int, input().split())) for j, num in enumerate(nums[1:]): f[i][j] = 1 g[i][j] = num heappush(pq, (num, i, j)) # Push (num, i, j) into the priority queue ma = -1 while pq: num, i, j = heappop(pq) if g[i - 1][j] \u0026lt; num: f[i][j] = max(f[i][j], f[i - 1][j] + 1) if g[i + 1][j] \u0026lt; num: f[i][j] = max(f[i][j], f[i + 1][j] + 1) if g[i][j - 1] \u0026lt; num: f[i][j] = max(f[i][j], f[i][j - 1] + 1) if g[i][j + 1] \u0026lt; num: f[i][j] = max(f[i][j], f[i][j + 1] + 1) ma = max(ma, f[i][j]) print(ma) from functools import lru_cache from sys import stdin input = stdin.readline def solve(matrix): if not matrix: return 0 dirs = [(-1, 0), (0, 1), (1, 0), (0, -1)] @lru_cache(None) def dfs(r, c): res = 1 for dx, dy in dirs: a, b = r + dx, c + dy if 0\u0026lt;= a \u0026lt;m and 0\u0026lt;= b \u0026lt;n and matrix[a][b] \u0026gt; matrix[r][c]: res = max(res, dfs(a, b) + 1) return res m, n = len(matrix), len(matrix[0]) res = 0 for i in range(m): for j in range(n): res = max(res, dfs(i, j)) return res r, c = map(int, input().split()) matrix = [[]for _ in range(r)] for i in range(r): matrix[i] = list(map(int, input().split())) print(solve(matrix)) ","permalink":"https://kennems.github.io/posts/tech/%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0%E4%BA%94dppython%E5%AE%9E%E7%8E%B0/","summary":"ç®—æ³•ç¬”è®°ï¼ˆäº”ï¼‰â€”â€”DPï¼ˆPythonå®ç°ï¼‰ DP æ•°å­—ä¸‰è§’å½¢ f=[] n=int(input()) for _ in range(n): f.append([int(x) for x in input().split()]) for i in range(n-2,-1,-1): for j in range(i+1): f[i][j]=max(f[i+1][j], f[i+1][j+1])+f[i][j] print(f[0][0]) èƒŒåŒ… ç©ºé—´ä¼˜åŒ–æˆ1ç»´ä¹‹åï¼Œåªæœ‰å®Œå…¨èƒŒåŒ…é—®é¢˜çš„","title":"ç®—æ³•ç¬”è®°ï¼ˆäº”ï¼‰â€”â€”DPï¼ˆPythonå®ç°ï¼‰"},{"content":"ç®—æ³•ç¬”è®°ï¼ˆä¸€ï¼‰â€”â€”åŸºç¡€+æ‚é¡¹ï¼ˆPythonå®ç°ï¼‰ åŸºç¡€+æ‚é¡¹ å¿«é€Ÿæ’åº def quick_sort(q, l, r): if l\u0026gt;=r: return i,j,x=l-1,r+1,q[(l+r)\u0026gt;\u0026gt;1] while i\u0026lt;j: i+=1 while q[i]\u0026lt;x: i+=1 j-=1 while q[j]\u0026gt;x: j-=1 if i\u0026lt;j: q[i], q[j] = q[j], q[i] quick_sort(q, l, j) quick_sort(q, j+1, r) n=int(input()) arr=list(map(int, input().split())) quick_sort(arr,0,n-1) print(\u0026#34; \u0026#34;.join(map(str, arr))) å½’å¹¶æ’åº j = mid+1 !!!\nfrom sys import stdin input = lambda:stdin.readline().strip() def merge_sort(q, l, r): if l\u0026gt;=r: return mid = l+r\u0026gt;\u0026gt;1 merge_sort(q, l, mid); merge_sort(q, mid+1, r) i, j = l, mid+1 tmp = [] while i\u0026lt;=mid and j\u0026lt;=r: if q[i] \u0026lt;= q[j]: tmp.append(q[i]) i += 1 else: tmp.append(q[j]) j += 1 if i\u0026lt;=mid: tmp.extend(q[i:mid+1]) if j\u0026lt;=r: tmp.extend(q[j:r+1]) q[l:r+1] = tmp n = int(input()) arr = list(map(int, input().split())) merge_sort(arr, 0, n-1) print(*arr) äºŒåˆ† def check(x): # æ£€æŸ¥ x æ˜¯å¦æ»¡è¶³æŸç§æ€§è´¨ pass # è¿™é‡Œéœ€è¦æ ¹æ®å…·ä½“çš„æƒ…å†µå®ç° def bsearch_1(l, r): while l \u0026lt; r: mid = (l + r) // 2 if check(mid): r = mid else: l = mid + 1 return l def bsearch_2(l, r): while l \u0026lt; r: mid = (l + r + 1) // 2 if check(mid): l = mid else: r = mid - 1 return l # ç¤ºä¾‹ç”¨æ³• # é¦–å…ˆå®šä¹‰ check å‡½æ•°æ¥æ£€æŸ¥æ€§è´¨ # ç„¶åä½¿ç”¨ bsearch_1 æˆ– bsearch_2 æ¥è¿›è¡ŒäºŒåˆ†æœç´¢ æœ€ä½³ç‰›å›´æ  é¢˜æ„ï¼šnå—åœ°ï¼Œæ¯å—åœ°ä¸Šæœ‰å¥¶ç‰›ï¼Œç°åœ¨éœ€è¦ç”¨å›´æ å›´èµ·ä¸€äº›å¥¶ç‰›ï¼Œ ä½†è‡³å°‘æœ‰få—åœ°ï¼Œé—®æœ€ç»ˆå›´èµ·çš„åœ°ä¸­ç‰›çš„æ•°é‡çš„å¹³å‡æ•°çš„æœ€å¤§å€¼ä¸ºå¤šå°‘ã€‚ æµ®ç‚¹æ•°äºŒåˆ†æœ€å¤§æ•°é‡ï¼Œåˆ¤æ–­æ‰€æœ‰æ•°å‡å»å½“å‰äºŒåˆ†çš„å¹³å‡æ•°åï¼Œæœ‰æ²¡æœ‰ä¸€æ®µé•¿åº¦ä¸ºfå¹¶ä¸”æ˜¯å…¨ä¸ºæ­£æ•°çš„ï¼Œå¦‚æœæœ‰åˆ™åˆæ³•ã€‚åˆ¤æ–­æ–¹æ³•ï¼šbæ•°ç»„å­˜åŸæ•°ç»„å‡å»å¹³å‡æ•°ï¼Œæ±‚å‰ç¼€å’Œï¼Œç”¨å‰ç¼€å’Œæ•°ç»„æ±‚æŸä¸€æ®µå†…çš„å’Œæ˜¯å¦ä¸ºæ­£æ•°å³å¯ï¼Œ åªè¦é•¿åº¦å¤§äºfçš„æ‰€æœ‰æ®µéƒ½è¦æšä¸¾ï¼Œä½†æ˜¯æˆ‘ä»¬åªè¦æ±‚$s[i]-s[0-\u0026gt;i-f]$æ˜¯å¦æœ‰ä¸€ä¸ªå¤§äº0å³å¯ï¼Œæ‰€ä»¥åªç”¨æ±‚$min(s[0:i-f])$å³å¯ã€‚æ³¨æ„æµ®ç‚¹æ•°äºŒåˆ†å› ä¸ºè¯¯å·®éœ€è¦ç”¨epsåˆ¤æ–­ï¼Œå¹¶ä¸”rä¼šç¨å¾®å¤§äºç­”æ¡ˆï¼Œlä¼šç¨å¾®å°äºç­”æ¡ˆï¼Œé¢˜ç›®é—®çš„æ˜¯å‘ä¸‹å–æ•´æœ€è¿‘çš„æ•´æ•°ï¼Œæ‰€ä»¥å–rå‘ä¸‹å–æ•´ã€‚ import sys input = lambda:sys.stdin.readline().strip() N = int(1e5+10) a, b = [0]*N, [0]*N n, f = map(int , input().split()) for i in range(1, n+1): a[i] = int(input()) l, r = 0.0, 2e3+10 eps = 1e-6 while r-l \u0026gt; eps: mid = (l+r)/2 s, mi, cur = [0]*N, 1e18, -1e18 for i in range(1, n+1): b[i] = a[i]-mid for i in range(1, n+1): s[i] = s[i-1]+b[i] for i in range(f, n+1): mi = min(mi, s[i-f]) cur = max(cur, s[i]-mi) if cur\u0026gt;=0: l = mid else: r = mid print(int(r*1000)) æµ®ç‚¹æ•°äºŒåˆ† def check(x): # æ£€æŸ¥xæ˜¯å¦æ»¡è¶³æŸç§æ€§è´¨ pass # è¿™é‡Œéœ€è¦æ ¹æ®å…·ä½“æƒ…å†µå®ç°checkå‡½æ•° def bsearch_3(l, r): eps = 1e-6 # eps è¡¨ç¤ºç²¾åº¦ï¼Œå–å†³äºé¢˜ç›®å¯¹ç²¾åº¦çš„è¦æ±‚ while r - l \u0026gt; eps: mid = (l + r) / 2 if check(mid): r = mid else: l = mid return l ä¸€ç»´å‰ç¼€å’Œ def prefixSum(arr): n = len(arr) prefixSum = [0] * n prefixSum[0] = arr[0] for i in range(1, n): prefixSum[i] = prefixSum[i-1] + arr[i] for i in range(n): print(prefixSum[i], end=\u0026#34; \u0026#34;) arr = [1, 2, 3, 4, 5] prefixSum(arr) äºŒç»´å‰ç¼€å’Œ import sys # é‡å®šå‘è¾“å…¥å‡½æ•°ä¸ºsys.stdin.readline().strip()ä»¥å»é™¤æœ«å°¾æ¢è¡Œç¬¦ input = lambda:sys.stdin.readline().strip() # è¯»å–nã€mã€qä¸‰ä¸ªæ•´æ•° n, m, q = map(int, input().split()) # åˆ›å»ºä¸€ä¸ªn+1è¡Œï¼Œm+1åˆ—çš„äºŒç»´åˆ—è¡¨gï¼Œåˆå§‹å€¼å‡ä¸º0 g = [[0]*(m+1) for _ in range(n+1)] # è¯»å–åœ°å›¾çš„æ¯ä¸€è¡Œï¼Œå¹¶å°†å€¼è½¬æ¢ä¸ºæ•´æ•°ï¼Œå­˜å‚¨åˆ°gä¸­ for i in range(1, n+1): g[i] = [0] + list(map(int, input().split())) # è®¡ç®—å‰ç¼€å’Œï¼Œg[i][j]è¡¨ç¤ºä»¥(i,j)ä¸ºå³ä¸‹è§’çš„çŸ©å½¢å†…æ‰€æœ‰å…ƒç´ ä¹‹å’Œ for i in range(1, n+1): for j in range(1, m+1): g[i][j] = (g[i][j] + g[i-1][j] + g[i][j-1] - g[i-1][j-1]) # é’ˆå¯¹æ¯ä¸ªæŸ¥è¯¢ï¼Œè®¡ç®—ç»™å®šçŸ©å½¢åŒºåŸŸå†…å…ƒç´ ä¹‹å’Œ for i in range(q): x1, y1, x2, y2 = map(int, input().split()) # è®¡ç®—çŸ©å½¢åŒºåŸŸå†…å…ƒç´ ä¹‹å’Œï¼Œåˆ©ç”¨å‰ç¼€å’Œçš„æ€§è´¨ # g[x2][y2]è¡¨ç¤ºå³ä¸‹è§’åæ ‡ä¸º(x2,y2)çš„çŸ©å½¢å†…æ‰€æœ‰å…ƒç´ ä¹‹å’Œ # g[x1-1][y2]è¡¨ç¤ºå³ä¸Šè§’åæ ‡ä¸º(x1-1,y2)çš„çŸ©å½¢å†…æ‰€æœ‰å…ƒç´ ä¹‹å’Œ # g[x2][y1-1]è¡¨ç¤ºå·¦ä¸‹è§’åæ ‡ä¸º(x2,y1-1)çš„çŸ©å½¢å†…æ‰€æœ‰å…ƒç´ ä¹‹å’Œ # g[x1-1][y1-1]è¡¨ç¤ºå·¦ä¸Šè§’åæ ‡ä¸º(x1-1,y1-1)çš„çŸ©å½¢å†…æ‰€æœ‰å…ƒç´ ä¹‹å’Œ # åˆ©ç”¨ä»¥ä¸Šå››ä¸ªå€¼ï¼Œå¯ä»¥æ±‚å¾—ç›®æ ‡çŸ©å½¢åŒºåŸŸå†…å…ƒç´ ä¹‹å’Œ print(g[x2][y2] - g[x1-1][y2] - g[x2][y1-1] + g[x1-1][y1-1]) ä¸€ç»´å·®åˆ† å·®åˆ†å’Œå‰ç¼€å’Œæ˜¯é€†è¿ç®—ã€‚\néœ€è¦è®¡ç®—æŸä¸€æ®µåŒºé—´$+-$æ“ä½œæ—¶ï¼Œè¿ç”¨å·®åˆ†æ“ä½œ updateRange éœ€è¦å…ˆæ„é€ å·®åˆ†æ•°ç»„\n$s[i] = s[i-1]+a[i]$ é€†è¿ç®— $d[i]=a[i]-a[i-1]$ ï¼ˆåŸæ•°ç»„çœ‹ä½œä¸ºå‰ç¼€å’Œæ•°ç»„ï¼‰\ndef updateRange(B, l, r, c): B[l] += c B[r + 1] -= c def printArray(arr): for i in range(len(arr)): print(arr[i], end=\u0026#34; \u0026#34;) print() n= 5 B = [0] * (n + 1) updateRange(B, 1, 3, 2) updateRange(B, 2, 4, 3) printArray(B) import sys # é‡å®šå‘è¾“å…¥å‡½æ•°ä¸ºsys.stdin.readline().strip()ä»¥å»é™¤æœ«å°¾æ¢è¡Œç¬¦ input = lambda:sys.stdin.readline().strip() # è¯»å–nå’Œmä¸¤ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºåºåˆ—é•¿åº¦å’Œæ“ä½œæ¬¡æ•° n, m = map(int, input().split()) # è¯»å–åºåˆ—aï¼Œé•¿åº¦ä¸ºnï¼Œå°†å…¶è½¬æ¢ä¸ºæ•´æ•°åˆ—è¡¨ï¼ŒåŒæ—¶åœ¨å¼€å¤´æ·»åŠ 0ä»¥ä¾¿å¤„ç†è¾¹ç•Œæƒ…å†µ a = [0] + list(map(int, input().split())) # åˆå§‹åŒ–å·®åˆ†æ•°ç»„dï¼Œé•¿åº¦ä¸ºn+2ï¼Œåˆå§‹å€¼å‡ä¸º0 d = [0]*(n+2) # è®¡ç®—åŸå§‹åºåˆ—aä¸­ç›¸é‚»å…ƒç´ çš„å·®å€¼ï¼Œå­˜å‚¨åˆ°å·®åˆ†æ•°ç»„dä¸­ for i in range(1, n+1): d[i] = a[i] - a[i-1] # æ‰§è¡Œmæ¬¡æ“ä½œ for i in range(m): # è¯»å–æ“ä½œå‚æ•°lã€rã€cï¼Œè¡¨ç¤ºå¯¹[l,r]èŒƒå›´å†…å…ƒç´ å¢åŠ c l, r, c = map(int, input().split()) # åœ¨å·®åˆ†æ•°ç»„ä¸­æ›´æ–°å¯¹åº”åŒºé—´[l,r]å†…å…ƒç´ çš„å¢é‡ d[l] += c d[r+1] -= c # æ ¹æ®å·®åˆ†æ•°ç»„è¿˜åŸåŸå§‹åºåˆ— for i in range(1, n+1): d[i] += d[i-1] # è¾“å‡ºè¿˜åŸåçš„åŸå§‹åºåˆ— print(*d[1:n+1]) äºŒç»´å·®åˆ† # ä»è¾“å…¥ä¸­è·å–ç½‘æ ¼çš„è¡Œæ•°ã€åˆ—æ•°å’Œæ“ä½œæ•°é‡ n, m, q = map(int, input().split()) # åˆå§‹åŒ–åŸå§‹ç½‘æ ¼æ•°ç»„å’Œæ“ä½œå½±å“æ•°ç»„ g = [[0]*(m+1) for _ in range(n+1)] d = [[0]*(m+2) for _ in range(n+2)] # å¡«å……åŸå§‹ç½‘æ ¼æ•°ç»„ for i in range(1, n+1): # å°†æ¯è¡Œçš„æ•°æ®å­˜å…¥äºŒç»´æ•°ç»„gä¸­ g[i] = [0] + list(map(int, input().split())) # å¤„ç†æ¯ä¸ªæ“ä½œ for i in range(q): # è·å–æ“ä½œçš„å·¦ä¸Šè§’åæ ‡ã€å³ä¸‹è§’åæ ‡å’Œè¦æ·»åŠ åˆ°è¯¥åŒºåŸŸå†…çš„å€¼ x1, y1, x2, y2, c = map(int, input().split()) # æ›´æ–°æ“ä½œå½±å“æ•°ç»„ d[x1][y1] += c d[x1][y2+1] -= c d[x2+1][y1] -= c d[x2+1][y2+1] += c # æ ¹æ®æ“ä½œå½±å“æ•°ç»„æ›´æ–°åŸå§‹ç½‘æ ¼æ•°ç»„ for i in range(1, n+1): for j in range(1, m+1): # æ›´æ–°æ“ä½œå½±å“çš„ç´¯ç§¯å€¼ d[i][j] = d[i][j] + d[i-1][j] + d[i][j-1] - d[i-1][j-1] # æ›´æ–°åŸå§‹ç½‘æ ¼æ•°ç»„ä¸­çš„å€¼ g[i][j] += d[i][j] # æ‰“å°æ›´æ–°åçš„åŸå§‹ç½‘æ ¼æ•°ç»„ for i in range(1, n+1): print(*g[i][1:m+1]) åŒæŒ‡é’ˆ for i in range(n): j = 0 while j \u0026lt; i and check(j, i): j += 1 # å…·ä½“é—®é¢˜çš„é€»è¾‘ # å¸¸è§é—®é¢˜åˆ†ç±»ï¼š # (1) å¯¹äºä¸€ä¸ªåºåˆ—ï¼Œç”¨ä¸¤ä¸ªæŒ‡é’ˆç»´æŠ¤ä¸€æ®µåŒºé—´ # (2) å¯¹äºä¸¤ä¸ªåºåˆ—ï¼Œç»´æŠ¤æŸç§æ¬¡åºï¼Œæ¯”å¦‚å½’å¹¶æ’åºä¸­åˆå¹¶ä¸¤ä¸ªæœ‰åºåºåˆ—çš„æ“ä½œ ä½è¿ç®— åŸç ï¼Œåç ï¼Œè¡¥ç  æ±‚näºŒè¿›åˆ¶è¡¨ç¤ºä¸­ç¬¬kä½æ•°å­—: n \u0026gt;\u0026gt; k \u0026amp; 1 è¿”å›nçš„æœ€åä¸€ä½1ï¼šlowbit(n) = n \u0026amp; -n æ ‘çŠ¶æ•°ç»„åŸºæœ¬æ“ä½œ ç¦»æ•£åŒ– alls = [] # å­˜å‚¨æ‰€æœ‰å¾…ç¦»æ•£åŒ–çš„å€¼ # å°†æ‰€æœ‰å€¼æ’åº alls.sort() # å»æ‰é‡å¤å…ƒç´  alls = list(set(alls)) # äºŒåˆ†æ±‚å‡ºxå¯¹åº”çš„ç¦»æ•£åŒ–çš„å€¼ def find(x): l, r = 0, len(alls) - 1 while l \u0026lt; r: mid = (l + r) // 2 if alls[mid] \u0026gt;= x: r = mid else: l = mid + 1 return r + 1 # æ˜ å°„åˆ°1, 2, ...n import sys input = lambda:sys.stdin.readline().strip() def find(x): l, r = 0, num while l\u0026lt;r: mid = (l+r+1)\u0026gt;\u0026gt;1 if ls[mid] \u0026lt;= x: l = mid else: r = mid-1 return l N = int(1e5)+10 s = [0]*N ls = [] d = dict() n, m = map(int, input().split()) for i in range(n): x, c = map(int, input().split()) if x not in d: d[x] = c ls.append(x) else: d[x] += c ls.sort() num = len(d) ls = [0] + ls for i in range(1, num+1): s[i] = s[i-1] + d[ls[i]] for i in range(m): l, r = map(int, input().split()) pl, pr = find(l), find(r) if l in d: pl -= 1 print(s[pr] - s[pl]) åŒºé—´åˆå¹¶ def merge(segs): segs.sort() # åŒºé—´å·¦ç«¯ç‚¹æ’åº res = [] st, ed = -2e9, -2e9 for seg in segs: if ed \u0026lt; seg[0]: if st != -2e9: res.append((st, ed)) st, ed = seg[0], seg[1] else: ed = max(ed, seg[1]) if st != -2e9: res.append((st, ed)) segs[:] = res n = int(input()) st, ed = -int(2e9), -int(2e9) segs = [] for i in range(n): l, r = map(int, input().split()) segs.append((l, r)) segs.sort() cnt = 0 for seg in segs: s, e = seg if s\u0026gt;ed: st, ed = s, e cnt+=1 else: ed = max(e, ed) print(cnt) çŸ©é˜µå¿«é€Ÿå¹‚ mod = int(1e9) + 7 def mul(a, b): t = [[0]*101 for _ in range(101)] for i in range(1, n+1): for j in range(1, n+1): for k in range(1, n+1): t[i][j] = (t[i][j] + a[i][k]*b[k][j]) % mod return t def qp(a, k): res = [[0]*101 for _ in range(101)] for i in range(1, n+1): res[i][i] = 1 while k: if k\u0026amp;1: res = mul(res, a) a = mul(a, a) k\u0026gt;\u0026gt;=1 return res n, k = map(int, input().split()) a = [[0]*101 for _ in range(101)] for i in range(1, n+1): row = [0] + list(map(int, input().split())) for j in range(1, n+1): a[i][j] = row[j] ans = qp(a, k) for i in range(1, n+1): print(*ans[i][1:n+1], sep=\u0026#39; \u0026#39;) é€’å½’98. åˆ†å½¢ä¹‹åŸ t = int(input()) def calc(n, m): if not m: return (0, 0) l, cnt = 1\u0026lt;\u0026lt;(n-1), 1\u0026lt;\u0026lt;(2*n-2) x, y = calc(n-1, m%cnt) z = m//cnt if z==0: return (y, x) if z==1: return (x, y+l) if z==2: return (x+l, y+l) if z==3: return (2*l-1 - y, l-1 - x) for i in range(t): n, a, b = map(int, input().split()) a-=1; b-=1 xa, ya = calc(n, a) xb, yb = calc(n, b) dis = int(( (xa-xb)**2 + (ya-yb)**2 ) ** 0.5 * 10 + 0.5) print(dis) é€’æ¨95. è´¹è§£çš„å¼€å…³ é¢˜ç›®å¤§æ„ï¼šæ¸¸æˆè§„åˆ™å¦‚ä¸‹ï¼šæœ‰ 25 ç›ç¯æ’æˆ 5Ã—5 çš„æ–¹å½¢ã€‚æ¯ä¸€ç›ç¯éƒ½æœ‰ä¸€ä¸ªå¼€å…³ï¼Œæ”¹å˜æŸä¸€ç›ç¯çš„çŠ¶æ€ä¼šå¯¼è‡´å…¶ä¸Šä¸‹å·¦å³ç›¸é‚»çš„ç¯ä¹Ÿæ”¹å˜çŠ¶æ€ã€‚ç»™å®šåˆå§‹çŠ¶æ€ï¼Œåˆ¤æ–­æ˜¯å¦èƒ½åœ¨ 6 æ­¥ä»¥å†…ä½¿æ‰€æœ‰çš„ç¯éƒ½å˜äº®ã€‚\nå®ç°æ€è·¯ï¼šé¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å®ç°ä¸€ä¸ªå‡½æ•° turn(x, y) æ¥å®ç°æ”¹å˜ç¯çš„çŠ¶æ€ä»¥åŠè¿é”ååº”ã€‚ç„¶åï¼Œæˆ‘ä»¬å¯¹äºæ¯ä¸ªåˆå§‹çŠ¶æ€ï¼Œé‡‡ç”¨æ·±åº¦ä¼˜å…ˆæœç´¢æˆ–è€…å¹¿åº¦ä¼˜å…ˆæœç´¢çš„æ–¹å¼æ¥æ¨¡æ‹Ÿæ¸¸æˆè¿‡ç¨‹ï¼Œå°è¯•æ‰€æœ‰å¯èƒ½çš„å¼€å…³çŠ¶æ€ç»„åˆï¼Œå¹¶è®°å½•è¾¾åˆ°ç›®æ ‡çŠ¶æ€æ‰€éœ€çš„æ­¥æ•°ã€‚æœ€åï¼Œè¾“å‡ºç»“æœå³å¯ã€‚\nfrom copy import deepcopy dx = [0, 1, 0, -1, 0] dy = [0, 0, 1, 0, -1] g = [[] for _ in range(5)] def turn(x, y): for i in range(5): xx = x+dx[i] yy = y+dy[i] if xx in range(5) and yy in range(5): g[xx][yy] ^= 1 def work(): global g backup = deepcopy(g) ans = float(\u0026#39;inf\u0026#39;) for k in range(1\u0026lt;\u0026lt;5): cur, flag = 0, True g = deepcopy(backup) for i in range(5): if (k\u0026gt;\u0026gt;i)\u0026amp;1: turn(0, i) cur+=1 for i in range(4): for j in range(5): if g[i][j]==0: turn(i+1, j) cur+=1 for i in range(5): if g[4][i]==0: flag = False break if flag: ans = min(ans, cur) return ans t = int(input()) for _ in range(t): for i in range(5): g[i] = [int(_) for _ in list(input())] if _ \u0026lt; t-1: input() res = work() if res\u0026lt;=6:print(res) else:print(-1) ST1273. å¤©æ‰çš„è®°å¿† é¢˜ç›®å¤§æ„ï¼šæœ‰ä¸€ä¸ªé•¿åº¦ä¸º N çš„æ•°å­—åºåˆ—ï¼Œç¼–å·ä¸º 1 åˆ° Nï¼Œæ¯æ¬¡è¯¢é—®ç»™å‡ºä¸¤ä¸ªæ•°å­— A å’Œ Bï¼Œè¦æ±‚å›ç­” A åˆ° B åŒºé—´å†…çš„æœ€å¤§æ•°ã€‚\nå®ç°æ€è·¯ï¼šè¿™æ˜¯ä¸€ä¸ªå…¸å‹çš„åŒºé—´æœ€å€¼æŸ¥è¯¢é—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨çº¿æ®µæ ‘è¿›è¡Œæ±‚è§£ã€‚é¦–å…ˆï¼Œéœ€è¦åˆå§‹åŒ–ä¸€ä¸ªäºŒç»´æ•°ç»„ f ç”¨äºå­˜å‚¨åŒºé—´æœ€å¤§å€¼ä¿¡æ¯ã€‚ç„¶åï¼Œåˆ©ç”¨é¢„å¤„ç†çš„æ–¹å¼ï¼Œè®¡ç®—å‡º log æ•°ç»„ï¼Œç”¨äºå¿«é€Ÿè®¡ç®—åŒºé—´é•¿åº¦çš„å¯¹æ•°ã€‚æ¥ç€ï¼Œåˆ©ç”¨åŠ¨æ€è§„åˆ’çš„æ€æƒ³ï¼Œåˆå§‹åŒ– f æ•°ç»„ï¼Œä½¿å¾— f[i][0] ç­‰äºæ•°å­—åºåˆ—ä¸­å¯¹åº”ä½ç½®çš„å€¼ã€‚æ¥ä¸‹æ¥ï¼Œåˆ©ç”¨åŠ¨æ€è§„åˆ’çš„æ€æƒ³ï¼Œæ›´æ–° f æ•°ç»„ï¼Œä½¿å¾— f[i][j] ç­‰äºåŒºé—´ [i, i+2^j-1] å†…çš„æœ€å¤§å€¼ã€‚æœ€åï¼Œå¯¹äºæ¯ä¸ªè¯¢é—®ï¼Œåˆ©ç”¨é¢„å¤„ç†çš„åŒºé—´æœ€å€¼ä¿¡æ¯ï¼Œé€šè¿‡ log æ•°ç»„å¿«é€Ÿç¡®å®šåŒºé—´é•¿åº¦çš„å¯¹æ•°ï¼Œç„¶ååˆ©ç”¨åŒºé—´æœ€å€¼ä¿¡æ¯æŸ¥è¯¢åŒºé—´æœ€å¤§å€¼ï¼Œå³å¯å¾—åˆ°ç­”æ¡ˆã€‚\nimport sys input = lambda:sys.stdin.readline().strip() N = int(2e5)+10 M = 20 f = [[0]*M for _ in range(N)] log = [0]*N def init(): log[0] = -1 for i in range(1, N): log[i] = log[i\u0026gt;\u0026gt;1] + 1 for j in range(M): for i in range(1, n+1): if not j: f[i][j] = w[i] else: if i + (1\u0026lt;\u0026lt;(j-1)) \u0026gt; n: break f[i][j] = max(f[i][j-1], f[i+(1\u0026lt;\u0026lt;(j-1))][j-1]) def query(l, r): leng = r-l+1 k = log[leng] return max(f[l][k], f[r-(1\u0026lt;\u0026lt;k)+1][k]) n = int(input()) w = [0] + list(map(int, input().split())) init() m = int(input()) for i in range(m): l, r = map(int, input().split()) print(query(l, r)) ","permalink":"https://kennems.github.io/posts/tech/%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0%E4%B8%80%E5%9F%BA%E7%A1%80+%E6%9D%82%E9%A1%B9python%E5%AE%9E%E7%8E%B0/","summary":"ç®—æ³•ç¬”è®°ï¼ˆä¸€ï¼‰â€”â€”åŸºç¡€+æ‚é¡¹ï¼ˆPythonå®ç°ï¼‰ åŸºç¡€+æ‚é¡¹ å¿«é€Ÿæ’åº def quick_sort(q, l, r): if l\u0026gt;=r: return i,j,x=l-1,r+1,q[(l+r)\u0026gt;\u0026gt;1] while i\u0026lt;j: i+=1 while q[i]\u0026lt;x: i+=1 j-=1 while q[j]\u0026gt;x: j-=1 if i\u0026lt;j: q[i], q[j] = q[j], q[i] quick_sort(q, l, j) quick_sort(q, j+1, r) n=int(input()) arr=list(map(int, input().split())) quick_sort(arr,0,n-1) print(\u0026#34; \u0026#34;.join(map(str,","title":"ç®—æ³•ç¬”è®°ï¼ˆä¸€ï¼‰â€”â€”åŸºç¡€+æ‚é¡¹ï¼ˆPythonå®ç°ï¼‰"},{"content":"å‘¨èµ›240407 å‡ºå¸ˆä¸åˆ©ï¼Œç¬¬ä¸€é¢˜å˜é‡åèƒ½å†™é”™ï¼Œæ…¢å°±æ˜¯å¿«ï¼Œå°‘å°±æ˜¯å¤šï¼Œæäº¤ä¹‹å‰ä¸€å®šè¦æœ‰ä¸‡å…¨çš„æ£€æŸ¥ã€‚\nç¬¬äºŒé¢˜100242. æ»¡è¶³è·ç¦»çº¦æŸä¸”å­—å…¸åºæœ€å°çš„å­—ç¬¦ä¸² çº¯æ€ç»´é¢˜ï¼Œå…ˆèŠ±æ—¶é—´æƒ³æ¸…æ¥šåŸºç¡€é—®é¢˜å†æƒ³åé¢çš„é—®é¢˜ã€‚å¸å–æ•™è®­ï¼Œä»£ç ä¸€å®šè¦å†™çš„æ¸…æ™°æ˜äº†ï¼Œè‡ªå·±æ‰èƒ½æ›´å¥½çš„çœ‹æ‡‚å¹¶å†™ä¸‹å»ã€‚\nPython å–æ¨¡è¿ç®—ä¸­ä½™æ•°ç¬¦å·å’Œé™¤æ•°ç¬¦å·ä¸€è‡´ï¼Œå¹¶æ»¡è¶³ï¼š$è¢«é™¤æ•°-é™¤æ•°*å•†(æ•´é™¤)=ä½™æ•°$\næ€è·¯ï¼šè½¬æ¢é—®é¢˜ï¼Œé—®ä¸è¶…è¿‡kï¼Œé‚£ä¹ˆç”¨å®Œ$k$æ˜¯æœ€ä¼˜çš„ï¼Œå› ä¸ºç”¨$k$æ€»èƒ½ä½¿å­—å…¸åºå˜å°(é™¤éåŸåºåˆ—å…¨æ˜¯$a$), é‚£ä¹ˆå°±ä¾æ¬¡æšä¸¾ï¼ŒçŸ¥é“ä¸èƒ½è½¬æ¢ä¸º$a$çš„æƒ…å†µä¸‹å°†å‰©ä½™çš„$k$è½¬æ¢ç§°å¯ä»¥è½¬æ¢æˆçš„æœ€å°çš„å­—å…¸åºå­—æ¯ã€‚\nclass Solution: def getSmallestString(self, s: str, k: int) -\u0026gt; str: s = list(s) n = len(s) for i in range(n): d = min(ord(s[i])-ord(\u0026#39;a\u0026#39;), ord(\u0026#39;a\u0026#39;)-ord(s[i])+26) if k\u0026gt;=d: k-=d s[i]=\u0026#39;a\u0026#39; else: num = ord(s[i])-ord(\u0026#39;a\u0026#39;) ch = min((num-k)%26, (num+k)%26) ch = chr(ch+ord(\u0026#39;a\u0026#39;)) s[i] = ch break return \u0026#39;\u0026#39;.join(s) ç¬¬ä¸‰é¢˜ 3107. ä½¿æ•°ç»„ä¸­ä½æ•°ç­‰äº K çš„æœ€å°‘æ“ä½œæ•° è¿™é¢˜æ¯”è¾ƒç®€ç­”ï¼Œæœ€åä¸€åˆ»ç”¨äºŒåˆ†äº¤çš„ï¼Œç»“æœå³ç«¯ç‚¹å–å€¼ä¿å®ˆé”™äº†ä¸€å‘ã€‚\nå®é™…ä¸éœ€è¦äºŒåˆ†ï¼Œåœ¨æ’å¥½åºçš„åºåˆ—é‡Œï¼Œç”¨ä¸­ä½æ•°å»é è¿‘ä¸­ä½æ•°æ›´ä¼˜ï¼Œæ‰€ä»¥ç›´æ¥æ’åºè®¡ç®—å°†å‰é¢æ¯”kå¤§çš„å’Œåé¢æ¯”$k$å°çš„è®¡ç®—å·®å€¼å°±å¯ä»¥äº†ã€‚\nclass Solution: def minOperationsToMakeMedianK(self, nums: List[int], k: int) -\u0026gt; int: nums.sort() n = len(nums) mid = n // 2 op=abs(nums[mid]-k) for i in range(mid): if nums[i]\u0026gt;k: op += nums[i] - k for i in range(mid+1, n): if nums[i]\u0026lt;k: op += k - nums[i] return op ç¬¬å››é¢˜100244. å¸¦æƒå›¾é‡Œæ—…é€”çš„æœ€å°ä»£ä»· å¹¶æŸ¥é›†+æ€ç»´é¢˜ã€‚å¦‚æœä¸€äº›æ•°å­—ç›¸ä¸$(and)$ï¼Œ å¦‚æœå­˜åœ¨è¾ƒå°çš„æ•°å­—äºŒè¿›åˆ¶ä½ä¸­æ˜¯$0$ï¼Œé‚£ä¹ˆå°±ç®—æœ‰å†å¤šçš„æ•°å­—åœ¨è¿™ä¸€ä½ä¸Šæ˜¯$1$ä¹Ÿæ²¡æœ‰ç”¨äº†ã€‚æ‰€ä»¥åœ¨ä¸€ä¸ªè¿é€šå—å†…æœ€å°ä»£ä»·å°±æ˜¯æ‰€æœ‰è¾¹éƒ½èµ°ä¸€éï¼Œè€Œè¿é€šå—å¯ä»¥ç”¨å¹¶æŸ¥é›†æ¥åˆ¤æ–­ã€‚\nclass Solution: def minimumCost(self, n: int, edges: List[List[int]], query: List[List[int]]) -\u0026gt; List[int]: def find(x): if p[x]!=x: p[x]=find(p[x]) return p[x] p={i:i for i in range(n)} dis={} ret=[] for u,v,_ in edges: p[find(u)]=find(v) for u,v,w in edges: pu = find(u) if pu not in dis: dis[pu]=w else: dis[pu]\u0026amp;=w for x,y in query: if x==y: ret.append(0) continue #å¦‚æœç›¸ç­‰ä¸€å®šè¦continue px, py = find(x), find(y) if px==py: ret.append(dis[px]) else: ret.append(-1) return ret ","permalink":"https://kennems.github.io/posts/tech/%E5%91%A8%E8%B5%9B240407/","summary":"å‘¨èµ›240407 å‡ºå¸ˆä¸åˆ©ï¼Œç¬¬ä¸€é¢˜å˜é‡åèƒ½å†™é”™ï¼Œæ…¢å°±æ˜¯å¿«ï¼Œå°‘å°±æ˜¯å¤šï¼Œæäº¤ä¹‹å‰ä¸€å®šè¦æœ‰ä¸‡å…¨çš„æ£€æŸ¥ã€‚ ç¬¬äºŒé¢˜100242. æ»¡è¶³è·ç¦»çº¦æŸä¸”å­—å…¸åºæœ€å°çš„","title":"LeetCodeå‘¨èµ›392(240407)"},{"content":"hugo new content posts/my-first-post.md\n","permalink":"https://kennems.github.io/posts/life/my-first-post/","summary":"hugo new content posts/my-first-post.md","title":"My First Post"},{"content":"VP å‘¨èµ› ç¬¬ 389 åœºå‘¨èµ› ç¬¬ä¸‰é¢˜3085. æˆä¸º K ç‰¹æ®Šå­—ç¬¦ä¸²éœ€è¦åˆ é™¤çš„æœ€å°‘å­—ç¬¦æ•° åŒæŒ‡é’ˆä¼˜åŒ–$O(n)$\nç¬¬ä¸‰é¢˜åšå‡ºæ¥äº†ä½†åšæ³•ä¸ä¼˜å¹¶ä¸”é”™çš„æ¬¡æ•°å¤ªå¤šäº†ã€‚\né¢˜ç›®å¤§æ„ï¼šç»™å®šä¸€ä¸ªå­—ç¬¦ä¸²wordå’Œä¸€ä¸ªæ•´æ•°kï¼Œå®šä¹‰ç‰¹æ®Šå­—ç¬¦ä¸²ä¸ºæ»¡è¶³|freq(word[i]) - freq(word[j])| \u0026lt;= kå¯¹äºå­—ç¬¦ä¸²ä¸­æ‰€æœ‰ä¸‹æ ‡iå’Œjéƒ½æˆç«‹çš„å­—ç¬¦ä¸²ã€‚å…¶ä¸­ï¼Œfreq(x)è¡¨ç¤ºå­—ç¬¦xåœ¨wordä¸­çš„å‡ºç°é¢‘ç‡ï¼Œ|y|è¡¨ç¤ºyçš„ç»å¯¹å€¼ã€‚è¦æ±‚è®¡ç®—ä½¿wordæˆä¸ºkç‰¹æ®Šå­—ç¬¦ä¸²æ‰€éœ€åˆ é™¤çš„å­—ç¬¦çš„æœ€å°æ•°é‡ã€‚\nå®ç°æ€è·¯ï¼šé¦–å…ˆç»Ÿè®¡wordä¸­æ¯ä¸ªå­—ç¬¦çš„å‡ºç°é¢‘ç‡ï¼Œç„¶åå¯¹é¢‘ç‡è¿›è¡Œæ’åºã€‚æ¥ç€éå†é¢‘ç‡åˆ—è¡¨ï¼Œä»æœ€å¤§çš„é¢‘ç‡å¼€å§‹ï¼Œé€æ­¥å‡å°‘é¢‘ç‡ï¼Œç›´åˆ°æ»¡è¶³ç‰¹æ®Šå­—ç¬¦ä¸²çš„æ¡ä»¶ã€‚åœ¨å‡å°‘é¢‘ç‡çš„è¿‡ç¨‹ä¸­ï¼Œåˆ©ç”¨ä¸€ä¸ªæŒ‡é’ˆæŒ‡å‘é¢‘ç‡åˆ—è¡¨ä¸­çš„å½“å‰ä½ç½®ï¼Œä¸æ–­å‘å‰ç§»åŠ¨ï¼Œæ›´æ–°éœ€è¦åˆ é™¤çš„å­—ç¬¦æ•°é‡ã€‚æœ€ç»ˆå¾—åˆ°ä½¿wordæˆä¸ºkç‰¹æ®Šå­—ç¬¦ä¸²æ‰€éœ€åˆ é™¤çš„æœ€å°å­—ç¬¦æ•°é‡ã€‚\nclass Solution: def minimumDeletions(self, word: str, k: int) -\u0026gt; int: ans = 2e9 cnt = sorted(Counter(word).values()) numFre = len(cnt)-1 delCnt = len(word) right = numFre for cur in range(numFre, -1, -1): delCnt-=cnt[cur] maxFre = cnt[cur]+k while right\u0026gt;cur and cnt[right]\u0026gt;maxFre: delCnt+=cnt[right] right-=1 ans = min(ans, delCnt-(numFre-right)*maxFre) return ans ç¬¬å››é¢˜3086. æ‹¾èµ· K ä¸ª 1 éœ€è¦çš„æœ€å°‘è¡ŒåŠ¨æ¬¡æ•° é¢˜ç›®å¤§æ„ï¼šç»™å®šä¸€ä¸ªäºŒè¿›åˆ¶æ•°ç»„numsï¼Œé•¿åº¦ä¸ºnï¼Œä»¥åŠä¸€ä¸ªæ­£æ•´æ•°kå’Œéè´Ÿæ•´æ•°maxChangesã€‚Aliceåœ¨ä¸€ä¸ªæ¸¸æˆä¸­éœ€è¦ä»numsä¸­æ‹¾èµ·kä¸ª1ï¼Œæ¸¸æˆå¼€å§‹æ—¶ï¼ŒAliceå¯ä»¥é€‰æ‹©ä»»æ„ä½ç½®ç«™ç«‹ã€‚Aliceå¯ä»¥æ‰§è¡Œä¸¤ç§è¡ŒåŠ¨ï¼šä¸€æ˜¯å°†ä¸€ä¸ª0æ”¹ä¸º1ï¼Œæ¬¡æ•°ä¸è¶…è¿‡maxChangesï¼›äºŒæ˜¯äº¤æ¢ç›¸é‚»ä½ç½®çš„1å’Œ0ã€‚è¿”å›Aliceæ‹¾å–kä¸ª1æ‰€éœ€çš„æœ€å°‘è¡ŒåŠ¨æ¬¡æ•°ã€‚\nå®ç°æ€è·¯ï¼šé¦–å…ˆï¼Œç»Ÿè®¡numsä¸­1çš„ä½ç½®ï¼ŒåŒæ—¶è®°å½•æ¯ä¸ª1çš„å‰ç¼€å’Œã€‚ç„¶åç¡®å®šæœ€å¤šå¯ä»¥æ‹¾å–çš„1çš„ä¸ªæ•°ï¼Œå³ä¸ºmaxChangeså’Œå½“å‰1çš„ä¸ªæ•°çš„æœ€å°å€¼ã€‚å¦‚æœæœ€å¤§å˜åŒ–æ¬¡æ•°maxChangesè¶³å¤Ÿå¤šï¼Œé‚£ä¹ˆä¸éœ€è¦äº¤æ¢1çš„ä½ç½®ï¼Œç›´æ¥è®¡ç®—éœ€è¦å˜åŒ–çš„æ¬¡æ•°å³å¯ï¼›å¦åˆ™ï¼Œåˆ©ç”¨äºŒåˆ†æœç´¢ç¡®å®šéœ€è¦äº¤æ¢çš„1çš„ä½ç½®ï¼Œè®¡ç®—äº¤æ¢å’Œå˜åŒ–çš„æ¬¡æ•°ã€‚æœ€ç»ˆè¿”å›è¡ŒåŠ¨æ¬¡æ•°ã€‚\nclass Solution: def minimumMoves(self, nums: List[int], k: int, maxChanges: int) -\u0026gt; int: pos = [] n=len(nums) c=0 for i, v in enumerate(nums): if not v: continue pos.append(i) if c==3: continue c=max(c, 1) if i\u0026gt;0 and nums[i]==nums[i-1]: c = max(2, c) if i\u0026gt;1 and nums[i]==nums[i-1] and nums[i]==nums[i-2]: c = max(3, c) c = min(c, k) if maxChanges\u0026gt;=k-c: return max(0, (k-c)*2)+max(0, c-1) n = len(pos) preSum = list(accumulate(pos, initial = 0)) ret = inf rest = k-maxChanges for right in range(rest, n+1): left = right-rest i=left+right\u0026gt;\u0026gt;1 s1 = pos[i]*(i-left) - (preSum[i]-preSum[left]) s2 = preSum[right]-preSum[i]-pos[i]*(right-i) ret = min(ret, s1+s2) return ret+maxChanges*2 ","permalink":"https://kennems.github.io/posts/tech/vp-%E5%91%A8%E8%B5%9B389/","summary":"VP å‘¨èµ› ç¬¬ 389 åœºå‘¨èµ› ç¬¬ä¸‰é¢˜3085. æˆä¸º K ç‰¹æ®Šå­—ç¬¦ä¸²éœ€è¦åˆ é™¤çš„æœ€å°‘å­—ç¬¦æ•° åŒæŒ‡é’ˆä¼˜åŒ–$O(n)$ ç¬¬ä¸‰é¢˜åšå‡ºæ¥äº†ä½†åšæ³•ä¸ä¼˜å¹¶ä¸”é”™çš„æ¬¡æ•°å¤ªå¤šäº†ã€‚ é¢˜ç›®å¤§","title":"LeetCodeå‘¨èµ›VP389"},{"content":"å‘¨èµ›240331 ç¬¬å››é¢˜ 100240 æœ€å°åŒ–æ›¼å“ˆé¡¿è·ç¦»\né¢˜ç›®å¤§æ„ï¼šç»™å®šä¸€ä¸ªäºŒç»´å¹³é¢ä¸Šçš„ç‚¹é›†ï¼Œæ±‚ç§»é™¤å…¶ä¸­ä¸€ä¸ªç‚¹åï¼Œå‰©ä½™ç‚¹é›†ä¸­ä»»æ„ä¸¤ç‚¹ä¹‹é—´çš„æœ€å¤§æ›¼å“ˆé¡¿è·ç¦»çš„æœ€å°å€¼ã€‚\nå®ç°æ€è·¯ï¼šé¦–å…ˆï¼Œå¯¹äºæ›¼å“ˆé¡¿è·ç¦»è€Œè¨€ï¼Œå®ƒçš„å®šä¹‰æ˜¯ä¸¤ç‚¹åœ¨å„ä¸ªåæ ‡è½´ä¸Šçš„å·®çš„ç»å¯¹å€¼ä¹‹å’Œã€‚æ‰€ä»¥ç§»é™¤ä¸€ä¸ªç‚¹åï¼Œå½±å“åˆ°æœ€å¤§æ›¼å“ˆé¡¿è·ç¦»çš„ä¸»è¦æ˜¯è·ç¦»ç§»é™¤ç‚¹æœ€è¿‘çš„ç‚¹ã€‚æˆ‘ä»¬å¯ä»¥å°†ç‚¹çš„åæ ‡è¿›è¡Œè½¬æ¢ï¼Œå°†å…¶è½¬æ¢ä¸º(x+y)å’Œ(x-y)çš„å½¢å¼ï¼Œè¿™æ ·åœ¨å¹³é¢ä¸Šçš„æ›¼å“ˆé¡¿è·ç¦»å°±å¯ä»¥ç­‰æ•ˆä¸ºåœ¨è½¬æ¢åçš„åæ ‡ç³»ä¸‹çš„æ¬§å‡ é‡Œå¾—è·ç¦»ã€‚ç„¶åæˆ‘ä»¬ç”¨ä¸¤ä¸ªæœ‰åºé›†åˆåˆ†åˆ«ç»´æŠ¤x+yå’Œx-yçš„åæ ‡è½´ä¸Šçš„å€¼ï¼Œåˆ†åˆ«ä¸ºxsetå’Œysetã€‚ç„¶åéå†æ¯ä¸ªç‚¹ï¼Œä»ç‚¹é›†ä¸­ç§»é™¤ä¸€ä¸ªç‚¹ï¼Œæ›´æ–°æœ€å¤§è·ç¦»ï¼Œæ‰¾åˆ°æœ€å°å€¼ã€‚\nfrom sortedcontainers import SortedList class Solution: def minimumDistance(self, points: List[List[int]]) -\u0026gt; int: xset, yset = SortedList(), SortedList() for x, y in points: xset.add(x+y) yset.add(x-y) ans = inf for x, y in points: xx = x+y yy = x-y xset.remove(xx) yset.remove(yy) ans = min( ans, max(xset[-1]-xset[0], yset[-1]-yset[0]) ) xset.add(xx) yset.add(yy) return ans ","permalink":"https://kennems.github.io/posts/tech/%E5%91%A8%E8%B5%9B240331/","summary":"å‘¨èµ›240331 ç¬¬å››é¢˜ 100240 æœ€å°åŒ–æ›¼å“ˆé¡¿è·ç¦» é¢˜ç›®å¤§æ„ï¼šç»™å®šä¸€ä¸ªäºŒç»´å¹³é¢ä¸Šçš„ç‚¹é›†ï¼Œæ±‚ç§»é™¤å…¶ä¸­ä¸€ä¸ªç‚¹åï¼Œå‰©ä½™ç‚¹é›†ä¸­ä»»æ„ä¸¤ç‚¹ä¹‹é—´çš„æœ€å¤§æ›¼å“ˆé¡¿è·ç¦»çš„æœ€å°","title":"LeetCodeå‘¨èµ›240331"},{"content":"å‘¨èµ› 24/3/24 ç¬¬ä¸‰é¢˜ 100258 3092. æœ€é«˜é¢‘ç‡çš„ ID é¢˜ç›®å¤§æ„ï¼šç»™å®šä¸¤ä¸ªé•¿åº¦ä¸ºnçš„æ•´æ•°æ•°ç»„numså’Œfreqï¼Œnumsä¸­çš„æ¯ä¸ªå…ƒç´ è¡¨ç¤ºä¸€ä¸ªIDï¼Œå¯¹åº”çš„freqä¸­çš„å…ƒç´ è¡¨ç¤ºè¿™ä¸ªIDåœ¨é›†åˆä¸­æ­¤æ¬¡æ“ä½œåéœ€è¦å¢åŠ æˆ–è€…å‡å°‘çš„æ•°ç›®ã€‚ç°è¦æ±‚åœ¨æ¯ä¸€æ­¥æ“ä½œåï¼Œè¿”å›å‡ºç°é¢‘ç‡æœ€é«˜çš„IDæ•°ç›®ï¼Œè‹¥é›†åˆä¸ºç©ºåˆ™ä¸º0ã€‚ SortedListå®ç°\nfrom sortedcontainers import SortedList class Solution: def mostFrequentIDs(self, nums: List[int], freq: List[int]) -\u0026gt; List[int]: sl = SortedList(key = lambda x : -x) d = defaultdict(int) ret = [] for x,y in zip(nums, freq): if d[x]!=0: sl.remove(d[x]) d[x]+=y sl.add(d[x]) else: d[x]=y sl.add(d[x]) if sl: ret.append(sl[0]) else: ret.append(0) return ret heap å®ç°\nå®ç°æ€è·¯ï¼š ä½¿ç”¨ä¸€ä¸ªå­—å…¸dæ¥åŠ¨æ€è®°å½•IDçš„å‡ºç°é¢‘ç‡ï¼Œåˆå§‹åŒ–ä¸€ä¸ªç©ºå †heapå’Œç»“æœåˆ—è¡¨retã€‚\néå†numså’Œfreqæ•°ç»„ï¼Œå¯¹äºæ¯å¯¹nums[i]å’Œfreq[i]ï¼Œæ›´æ–°å­—å…¸dä¸­å¯¹åº”IDçš„é¢‘ç‡ã€‚\nå°†(-d[x], x)å…ƒç»„åŠ å…¥å †heapï¼Œå…¶ä¸­-d[x]è¡¨ç¤ºID xçš„å‡ºç°é¢‘ç‡çš„ç›¸åæ•°ï¼Œxè¡¨ç¤ºIDæœ¬èº«ã€‚å †æŒ‰ç…§é¢‘ç‡ä»é«˜åˆ°ä½æ’åºã€‚\nè¿›å…¥å¾ªç¯ï¼Œæ£€æŸ¥å †é¡¶å…ƒç´ æ˜¯å¦æ»¡è¶³å½“å‰é¢‘ç‡ï¼Œè‹¥ä¸æ»¡è¶³åˆ™å¼¹å‡ºç›´è‡³æ»¡è¶³ã€‚\nå°†å½“å‰å †é¡¶å…ƒç´ çš„é¢‘ç‡åŠ å…¥ç»“æœåˆ—è¡¨retã€‚\nè¿”å›ç»“æœåˆ—è¡¨retã€‚\nclass Solution: def mostFrequentIDs(self, nums: List[int], freq: List[int]) -\u0026gt; List[int]: d = defaultdict(int) heap = [] ret = [] for x,y in zip(nums, freq): d[x]+=y heapq.heappush(heap, (-d[x], x)) while True: tx, ty = heap[0] if -tx != d[ty]: heapq.heappop(heap) continue ret.append(-tx) break return ret ç¬¬å››é¢˜ 1002683093. æœ€é•¿å…¬å…±åç¼€æŸ¥è¯¢ Trieæ ‘\né¢˜ç›®å¤§æ„ï¼š ç»™å®šä¸¤ä¸ªå­—ç¬¦ä¸²æ•°ç»„wordsContainerå’ŒwordsQueryï¼Œå¯¹äºæ¯ä¸ªwordsQuery[i]ï¼Œéœ€è¦ä»wordsContainerä¸­æ‰¾åˆ°ä¸€ä¸ªä¸wordsQuery[i]æœ‰æœ€é•¿å…¬å…±åç¼€çš„å­—ç¬¦ä¸²ã€‚è‹¥æœ‰å¤šä¸ªæ»¡è¶³æ¡ä»¶çš„å­—ç¬¦ä¸²ï¼Œé€‰æ‹©é•¿åº¦æœ€çŸ­çš„ä¸€ä¸ªï¼Œè‹¥é•¿åº¦ç›¸åŒåˆ™é€‰æ‹©åœ¨wordsContainerä¸­å‡ºç°è¾ƒæ—©çš„ä¸€ä¸ªã€‚è¿”å›ä¸€ä¸ªæ•´æ•°æ•°ç»„ansï¼Œå…¶ä¸­ans[i]è¡¨ç¤ºwordsContainerä¸­ä¸wordsQuery[i]æœ‰æœ€é•¿å…¬å…±åç¼€çš„å­—ç¬¦ä¸²çš„ä¸‹æ ‡ã€‚\nå®ç°æ€è·¯ï¼š\nåˆå§‹åŒ–ä¸€ä¸ªå˜é‡miè®°å½•wordsContainerä¸­æœ€çŸ­å­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œå¹¶è®°å½•å…¶ä¸‹æ ‡ä¸ºidxã€‚ æ„å»ºå­—å…¸trieï¼Œç”¨äºå­˜å‚¨wordsContainerä¸­æ¯ä¸ªå­—ç¬¦ä¸²çš„é€†åºå½¢å¼ï¼Œå¹¶è®°å½•æœ€çŸ­å­—ç¬¦ä¸²çš„ä¸‹æ ‡å’Œé•¿åº¦ã€‚ éå†wordsQueryï¼Œå¯¹äºæ¯ä¸ªæŸ¥è¯¢å­—ç¬¦ä¸²ï¼Œå°†å…¶é€†åºï¼Œç„¶ååœ¨trieä¸­æœç´¢ä¸ä¹‹åŒ¹é…çš„æœ€é•¿å…¬å…±åç¼€ï¼Œå¹¶è¿”å›å…¶å¯¹åº”çš„ä¸‹æ ‡ã€‚ å°†æ‰€æœ‰æŸ¥è¯¢ç»“æœå­˜å…¥ç»“æœåˆ—è¡¨retï¼Œå¹¶è¿”å›ã€‚ class Solution: def stringIndices(self, c: List[str], q: List[str]) -\u0026gt; List[int]: mi = inf idx = -1 ret = [] for i, w in enumerate(c): if len(w)\u0026lt;mi: mi = len(w) idx = i trie = {} #dict for i, w in enumerate(c): w=w[::-1] cur=trie for wi in w: if wi not in cur: cur[wi] = {} cur = cur[wi] if \u0026#39;#\u0026#39; not in cur: cur[\u0026#39;#\u0026#39;] = (i, len(w)) elif len(w)\u0026lt;cur[\u0026#39;#\u0026#39;][1]: cur[\u0026#39;#\u0026#39;] = (i,len(w)) for i, w in enumerate(q): w=w[::-1] cur = trie ans = idx for wi in w: if wi not in cur: break else: cur = cur[wi] ans = cur[\u0026#39;#\u0026#39;][0] ret.append(ans) return ret ","permalink":"https://kennems.github.io/posts/tech/%E5%91%A8%E8%B5%9B240324/","summary":"å‘¨èµ› 24/3/24 ç¬¬ä¸‰é¢˜ 100258 3092. æœ€é«˜é¢‘ç‡çš„ ID é¢˜ç›®å¤§æ„ï¼šç»™å®šä¸¤ä¸ªé•¿åº¦ä¸ºnçš„æ•´æ•°æ•°ç»„numså’Œfreqï¼Œnumsä¸­çš„æ¯ä¸ªå…ƒç´ è¡¨ç¤ºä¸€ä¸ªIDï¼Œå¯¹åº”çš„freqä¸­çš„å…ƒç´ ","title":"LeetCodeå‘¨èµ›240324"},{"content":" æ¬¢è¿æ¥åˆ°æˆ‘çš„åšå®¢ğŸ˜†ï¼\n{ \u0026#34;name\u0026#34;: \u0026#34;Kennem(å‘¨å† ï¼‰ğŸ˜¶â€ğŸŒ«ï¸\u0026#34;, \u0026#34;Birthday\u0026#34;: \u0026#34;2003-01-15\u0026#34;, \u0026#34;University\u0026#34;: \u0026#34;UPC\u0026#34;, \u0026#34;Address\u0026#34;: \u0026#34;QingDao\u0026#34;, \u0026#34;selfIntroduction\u0026#34;: \u0026#34;è¿™é‡Œè®°å½•äº†æˆ‘çš„å­¦ä¹ ç¬”è®°ï¼Œæ›¾ç»é‡åˆ°çš„é—®é¢˜ï¼Œä»¥åŠåœ¨å­¦ä¹ è¿‡ç¨‹ä¸­é‡åˆ°çš„å¥½ç”¨çš„å·¥å…·ã€‚ğŸ‘\u0026#34; } ","permalink":"https://kennems.github.io/about/","summary":"æ¬¢è¿æ¥åˆ°æˆ‘çš„åšå®¢ğŸ˜†ï¼ { \u0026#34;name\u0026#34;: \u0026#34;Kennem(å‘¨å† ï¼‰ğŸ˜¶â€ğŸŒ«ï¸\u0026#34;, \u0026#34;Birthday\u0026#34;: \u0026#34;2003-01-15\u0026#34;, \u0026#34;University\u0026#34;: \u0026#34;UPC\u0026#34;, \u0026#34;Address\u0026#34;: \u0026#34;QingDao\u0026#34;, \u0026#34;selfIntroduction\u0026#34;: \u0026#34;è¿™é‡Œè®°å½•äº†æˆ‘çš„å­¦ä¹ ç¬”è®°ï¼Œæ›¾ç»é‡åˆ°çš„é—®é¢˜ï¼Œä»¥","title":"ğŸ™‹ğŸ»â€â™‚ï¸å…³äº"},{"content":"æœºå™¨å­¦ä¹ ç®€ä»‹ Different types of Functions\nRegression : The function outputs a scalar(æ ‡é‡ï¼‰.\npredict the PM2.5 Classification ï¼š Given options (classes), the function outputs the correct one.\nSpam filtering Structured Learning ï¼š create something with structure(image, document)\nExample : YouTube Channel\n1.Function with Unknown Parameters. $$ y=b+wx_1 $$\n2.Define Loss from Training Data Loss is a function of parameters $$ L(b,w) $$\nLoss : how good a set of values is. L is mean absolute error (MAE) $$ e=\\left | y-\\hat{y} \\right | $$\nL is mean square error (MSE) $$ e=(y-\\hat{y})^2 $$\n$$ L=\\frac{1}{N} \\sum_{n}^{}e_n $$\n3.Optimization $$ w^,b^=arg,\\min_{w,b} ,L $$\nGradient Descent\n(Randomly) Pick an initial value ï¼š $$ w^0 $$\nCompute : $$ \\frac {\\partial L} {\\partial w} |_{w=w_0} $$\nNegative : Increase w\nPositive : Decrease w\n$$ \\eta\\frac {\\partial L} {\\partial w} |_{w=w_0} $$\nÎ·ï¼šlearning rate (hyperparameters)\nUpdate w iteratively Local minima global minima ç±»ä¼¼ä¸€ä¸ªå‚æ•°ï¼Œæ¨å¹¿åˆ°å¤šä¸ªå‚æ•°ã€‚\nLinear Models Linear models have severe limitation. Model Bias.\nWe need a more flexible model!\ncurve = constant + sum of a set of Hard Sigmoid Function\n$$ y=c\\frac {1} {1+exp(-(b+wx_1))} \\ =csigmoid(b+wx_1) $$\n$$ y=b+\\sum_{i}sigmoid(b_i+w_ix_i) $$\n$$ y=b+\\sum_{i}sigmoid(b_i+\\sum_{j}w_{ij}x_j) $$\nçº¿æ€§ä»£æ•°è§’åº¦ï¼š\n$$ r=b+Wx $$\n$$ a=\\sigma(r) $$\n$$ y=b+c^Ta $$\nLoss\nLoss is a function of parameters L(Î¸) Loss means how good a set of values is. Optimization of New Model $$ \\theta= \\begin{bmatrix}\n\\theta_1 \\ \\theta_2 \\ \\theta_3 \\ \\dots \\end{bmatrix} $$\n$$ \\theta=arg \\min_\\theta L $$\n(Randomly) Pick initial values Î¸^0 1 epoch = see all the batched once\nupdate : update Î¸ for each batch\nSigmoid -\u0026gt; ReLU (Rectified Linear Unit) ç»Ÿç§°ä¸º Activation function\nNeural Network\n","permalink":"https://kennems.github.io/posts/tech/1.%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AE%80%E4%BB%8B/","summary":"æœºå™¨å­¦ä¹ ç®€ä»‹ Different types of Functions Regression : The function outputs a scalar(æ ‡é‡ï¼‰. predict the PM2.5 Classification ï¼š Given options (classes), the function outputs the correct one. Spam filtering Structured Learning ï¼š create something with structure(image, document) Example : YouTube Channel 1.Function with Unknown Parameters. $$ y=b+wx_1 $$ 2.Define Loss from Training Data Loss is a","title":"1. æœºå™¨å­¦ä¹ ç®€ä»‹"},{"content":"PyTorch PyTorch Tutorial\nPython3ä¸­æœºå™¨å­¦ä¹ æ¡†æ¶\ndataset = MyDataset(file) dataloader = DataLoader(dataset, batch_size = size , shuffle = True) Training : True Testing : False from torch.utils.data import Dataset, DateLoader class MyDataset(Dataset): def __init__(self, file): # read data \u0026amp; preprocess self.data = ... def __getitem__(self,index): #return one sample at a time return self.data[index] def __len__(self): #return the size of the dataset return len(self.data) dataset = MyDataset(file) dataloader = Dataloader(dataset, batch_size, shuffle = True) shuffle : Training -\u0026gt; true Testing -\u0026gt; false Tersors High-dimensional matrices(arrays)\n.shape() # show the dimension #Directly from data (list or numpy.ndarray) x = torch.tensor([1, -1], [-1, 1]) x = torch.from_numpy(np.array([[1, -1], [-1, 1]])) #Tensor of constant zeros \u0026amp; ones x = torch.zeros([2, 2]) x = torch.ones([1, 2, 5]) x+y x-y y=x.pow(2) y=x.sum() y=x.mean() #Transpose : transpose two specified dimensions x = x.transpose(dim0,dim1) # change the dimension dim0 and dim1 #Squeeze : remove the specified dimension with length 1 x = x.squeeze(1) #unsqueeze expand a new dimension x = x.unsqueeze(1) dim in PyTorch == axis in NumPy\ndimensional\nCheck with.shape()\tCreating Tensors Directly from data (list or numpy.ndarray)\nx = torch.tensor([1, -1], [-1, 1]) x = torch.from_numpy(np.array([[1, -1], [-1, 1]])) Tensor of constant zeros \u0026amp; ones\nx = torch.zeros([2,2]) x = torch.ones([1, 2, 5]) Common Operations addition subtraction power summation mean\ntranspose x.shape x.transpose(0,1) Unsqueeze : expand a new dimension\nx = x.unsqueeze(1) **Cat **: conncatenate multiple tensors åˆå¹¶å¤šä¸ªçŸ©é˜µ\ntorch.cat([x, y, z], dim = 1) Data Type: Using different data types for model and data will case errors.\n32-bit -torch.float\n64-bit -torch.long\nDevice\nTensors \u0026amp; modules will be computed with CPU by default Use .to() to move tensors to appropriate devices CPU x = x.to('cpu')\t- ```py x = x.to('cuda') GPU check if your computer has NVIDIA GPU torch.cuda.is_available() - Multiple GPUs : specify- ``` 'cuda:0', 'cuda:1', 'cuda:2',... Cradient Calculation import torch # å®šä¹‰ä¸€ä¸ªéœ€è¦æ±‚å¯¼çš„å¼ é‡ xï¼Œå¹¶å°† requires_grad å‚æ•°è®¾ç½®ä¸º True x = torch.tensor([[1., 0.], [-1., 1.]], requires_grad=True) # è®¡ç®— x çš„å¹³æ–¹å¹¶å¯¹å…¶è¿›è¡Œæ±‚å’Œï¼Œå¾—åˆ°å¼ é‡ z z = x.pow(2).sum() # å¯¹å¼ é‡ z è¿›è¡Œåå‘ä¼ æ’­ï¼Œè‡ªåŠ¨è®¡ç®—å‡º x çš„æ¢¯åº¦ z.backward() # è¾“å‡º x çš„æ¢¯åº¦ print(x.grad) torch.nn Network Layers Linear Layer (Fully-connected Layer) nn.linear(in_features, out_features) #### Non-linear Activation Functions```pynn.Sigmoid()nn.ReLU() Build your own neural network import torch.nn as nn class MyModel(nn.Module): #initialize your model \u0026amp; define layers def __init__(self): super(MyModel, self).__init__() self.net = nn.Sequential( nn.Linear(10, 32), nn.Sigmoid(), nn.Linear(32,1) ) #compute output of your nn def forward(self, x): return self.next() Loss Functions Mean squared Error (for regression tasks) criterion = nn.MSELoss() Cross Entropy (for classification tasks) äº¤å‰ç†µ criterion = nn.CrossEntropyLoss() loss = criterion(model_output, expected_value) ### torch.optim- Stochastic Gradient Descent (SGD) - ```py torch.optim.SGD(model.parameters(), lr, momentum = 0) For every batch of data Call optimizer.zero_grad() to reset gradients of model parameters. Call loss.backward() to backpropagate gradients of prediction loss Call optimizer.step() to adjust model parameters Neural Network Training Setup dataset = MyDataSet(file) tr_set = DataLoader(dataset, 16, shuffle = True) model = MyModel().to(device) criterion = nn.MSELoss() optimizer = torch.optim.SGD(model.parameters(), 0.1) Training Loop for epoch in range(n_epochs): # Iterate over n_epochs model.train() # Set the model to training mode for x, y in tr_set: # Iterate over the training set optimizer.zero_grad() # Clear the gradients x, y = x.to(device), y.to(device) # Move data to the device (e.g., GPU) pred = model(x) # Forward pass, compute predictions loss = criterion(pred, y) # Compute the loss loss.backward() # Backward pass, compute gradients optimizer.step() # Update the model\u0026#39;s parameters using the gradients Validation Loop model.eval() # Set the model to evaluation mode total_loss = 0 for x, y in dv_set: # Iterate over the validation set x, y = x.to(device), y.to(device) # Move data to the device with torch.no_grad(): # Disable gradient computation pred = model(x) # Forward pass, compute predictions loss = criterion(pred, y) # Compute the loss total_loss += loss.cpu().item() * len(x) # Accumulate the loss avg_loss = total_loss / len(dv_set) # Calculate the average loss per sample Testing Loop model.eval() # Set the model to evaluation mode preds = [] for x in tt_set: # Iterate over the test set x = x.to(device) # Move data to the device with torch.no_grad(): # Disable gradient computation pred = model(x) # Forward pass, compute predictions preds.append(pred.cpu()) # Append the predictions to the list Data, demo1 Load data : use pandas to load a csv file\ntrain_data = pd.read_cav(\u0026#39;./name.csv\u0026#39;).drop(columns=[\u0026#39;date\u0026#39;]).values x_train, y_train = train_data[:,:-1], train_data[:,:-1] Dataset init : Read data and preproces\ngetitem : Return one sample at a time, In this case, one sample includes a 117 dimensional feature and a label\nlen : Return the size of the dataset. In this case, it is 2699\nclass COVID19Dataset(Dataset): \u0026#39;\u0026#39;\u0026#39; x: np.ndarray ç‰¹å¾çŸ©é˜µ. y: np.ndarray ç›®æ ‡æ ‡ç­¾, å¦‚æœä¸ºNone,åˆ™æ˜¯é¢„æµ‹çš„æ•°æ®é›† \u0026#39;\u0026#39;\u0026#39; def __init__(self, x, y=None): if y is None: self.y = y else: self.y = torch.FloatTensor(y) self.x = torch.FloatTensor(x) def __getitem__(self, idx): if self.y is None: return self.x[idx] return self.x[idx], self.y[idx] def __len__(self): return len(self.x) Dataloader train_loader = DataLoader(train_dataset, batch_size = 32, shuffle = True, pin_memory = True) Model class My_Model(nn.Module): def __init__(self, input_dim): super(My_Model, self).__init__() # TODO: ä¿®æ”¹æ¨¡å‹ç»“æ„, æ³¨æ„çŸ©é˜µçš„ç»´åº¦ï¼ˆdimensionsï¼‰ self.layers = nn.Sequential( nn.Linear(input_dim, 16), nn.ReLU(), nn.Linear(16, 8), nn.ReLU(), nn.Linear(8, 1) ) def forward(self, x): x = self.layers(x) x = x.squeeze(1) # (B, 1) -\u0026gt; (B) return x Criterion criterion = torch.nn.MSELoss(reduction = \u0026#39;mean\u0026#39;) Optimizer optimizer = torch.optim.SGD(model.parameters(), lr = 1e-5, momentum = 0.9) Training Loop Documentation and Common Errors read pytorch tutorial\nColabï¼ˆhighly recommendedï¼‰ ","permalink":"https://kennems.github.io/posts/tech/2.pytorch/","summary":"PyTorch PyTorch Tutorial Python3ä¸­æœºå™¨å­¦ä¹ æ¡†æ¶ dataset = MyDataset(file) dataloader = DataLoader(dataset, batch_size = size , shuffle = True) Training : True Testing : False from torch.utils.data import Dataset, DateLoader class MyDataset(Dataset): def __init__(self, file): # read data \u0026amp; preprocess self.data = ... def __getitem__(self,index): #return one sample at a time return self.data[index] def __len__(self): #return the size of","title":"2. PyTorch"},{"content":"Officially begin Deep = Many hidden layers\nNeurall Network Find a function in function set.\nGoodness of function Pick the best function\nBackpropagation - Backward Pass(åå‘ä¼ æ’­) åå‘çš„neural network\nRegression Stock Market Forecast Self-driving Car Recommendation Step 1 : Model A set of function\nStep 2 : Goodness of Function $$ \\hat{y}^1ä»£è¡¨x^1å¯¹åº”çš„ç¡®åˆ‡å€¼ $$\nLoss function Lï¼š $$ L(f)=L(w,b) ~ Estimated ~ y ~ basedoninputfunction $$\n$$ L(w,b)=\\sum_{n=1}^{10}(\\hat{y}^n-(b+w\\cdot x_{cp}^n))^2 $$\nStep 3 ï¼šBest Function In linear regression, the loss function L is convex.\nOverfitting\nRegularization $$ L(w,b)=\\sum_{n=1}^{10}(\\hat{y}^n-(b+w\\cdot x_{cp}^n))^2+\\lambda\\cdot \\sum(w_i)^2 $$\nä¸éœ€è¦è€ƒè™‘biasï¼Œè°ƒæ•´å¹³æ»‘ç¨‹åº¦ï¼Œsmooth\nGradient descent Overfitting and Regularization Classification independently and identically distributed(i.i.d) $$ L(h^{train},D_{all})-L(h^{all}, d_{all}) \\leq \\delta\\ we\\ need \\ \\forall h \\in \\H, |L(h,D_{train}) -L(h,D_{all}) | \\leq \\delta/2\\ L(h^{train},D_{all})\\leq L(h^{train},D_{all}) + \\delta/2 $$ é‡æ¸©æ•°ç å®è´ï¼š\næ¨¡å‹å‡ºç°badçš„æ¦‚ç‡ï¼š $$ P(D_{train}\\ is\\ bad)\\leq |H| \\cdot 2exp(-2N\\epsilon^2 ) \\ N \\ge \\frac{log(2|H|/\\delta)}{2\\epsilon^2} $$ Tradeoff of Model Complexity\nTraining data for Classification pair\nIdeal Alternatives Function(Model): $$ f(x)\\ x -\u0026gt; g(x)\u0026gt;0~Output=class1\\ else\\ Output=class2 $$\nlossfunction: The number of times of get incotrrect results on training data. $$ L(f) = \\sum_{n}\\delta(f(x^n)\\neq\\hat{y}^n) $$\nFind the best function; Example : Perceptron, SVM Prior $$ P(C_1|x)=\\frac{P(x|C_1)P(C_1)}{P(x|C_1)P(C_1)+P(x|C_2)P(C_2)} $$\nGaussian Maximum Likelihood\n2D array or 3D array mean the array with 2 or 3 axes respectively, but the n-dimensional vector mean the vector of length n.\nLearn something that can really differ you from others.\nLogistics Regression Function Set $$ f_{w,b}=\\sigma(\\sum_{i}w_ix_i)+b $$\nOutput : Between 0 and 1 $$ f_{w,b}(x)=P_{w,b}(C_1|x) $$\n$$ w^,b^=arg\\ \\underset{w,b}{max}L(w,b)\\ ç­‰åŒäº w^,b^ = arg\\ \\underset{w,b}{min}-lnL(w,b) $$\nCross Entropy: $$ Distribution \\ p: p(x=1)=\\hat{y}^n\\ p(x=0)=1-\\hat{y}^n\\ Distribution \\ q: q(x=1)=f(x^n)\\ q(x=0)=1-f(x^n)\\ H(p,q)=-\\sum_xp(x)ln(q(x)) $$\nLoss Function $$ L(f)=\\sum_nC(f(x^n),\\hat{y}^n)\\ C(f(x^n),\\hat{y}^n)=-[\\hat{y}^nlnf(x^n)+(1-\\hat{y}^n)ln(1-f(x^n))] $$\nUpdate logistic regression å’Œ linear regression å½¢å¼å®Œå…¨ç›¸åŒ $$ w_i\\gets w_i-\\eta \\sum_{n}-(\\hat{y}^n-f_{w,b}(x^n))x_i^n $$\nDiscriminative (logistic) \u0026amp; Generative (Gaussianæè¿°) Generativeåšäº†æŸäº›å‡è®¾ã€‚\nBenefit of generative model With the assumption of probability distribution, less training data is needed With the assumption of probability distribution, more robust to the noise Priors and class-dependent probabilities can be estimated from different sources. Multi-class Classification SoftMax $$ Softmax(z_i)=\\frac{e^{z_i}}{\\sum_{c=1}^{C} e^{z_c}}\\ 1 \u0026gt; y_i\u0026rsquo; \u0026gt; 0\\ \\sum_iy_i\u0026rsquo;=1 $$\nLimitation of Logistic Regression åªèƒ½ç”»ä¸€æ¡ç›´çº¿\nFeature Transformation Cascading logistic regression models Optimization Issue å±‚æ•°è¾ƒå¤šè¡¨ç°çš„åè€Œæ²¡æœ‰å±‚æ•°è¾ƒå°‘çš„å¥½\nOver fitting å¢åŠ è®­ç»ƒèµ„æ–™\nData augmentation\nconstrained model\nLess parameters, sharing parameters Less features Early stopping CNN-\u0026gt;æ¯”è¾ƒæ²¡æœ‰å¼¹æ€§çš„model\nåˆ†Training Set\nN-fold Cross Validation Optimization Fail H : Hessian\nTayler Series Approximation $$ L(\\theta) \\approx L(\\theta^\\prime)+\\frac{1}{2}(\\theta-\\theta^\\prime)^TH(\\theta-\\theta^\\prime) $$\nH is positive definte = All eigen values are positive -\u0026gt; local minima H is negative definte = All eigen values are negative -\u0026gt; **local ** Some eigen values are positive , and some are negative -\u0026gt; Saddle point åœ¨é«˜ç»´ä¸‹local minimaå¯èƒ½ä¼šå˜æˆsaddle poing\nTips for training : Batch and Momentum Batch 1 epoch = see all the batches once -\u0026gt; shuffle after each epoch\nMomentum Movement not just based on gradient, but previous movement.\nDifferent parameters needs different learning rate $$ \\theta_i^{t+1} \\gets \\theta_i^t-\\frac{\\eta}{\\sigma_i^t}g_i^t\\ \\sigma_i^t=\\sqrt{\\frac{1}{t+1}\\sum_{i=0}^t(g_i^t)^2} $$\nAdagred\nRMSProp $$ \\theta_i^{t+1} \\gets \\theta_i^t-\\frac{\\eta}{\\sigma_i^t}g_i^t\\ \\sigma_i^t = \\sqrt{\\alpha(\\sigma_i^{t-1})^2+(1-\\alpha)(g_i^t)^2} $$\nAdam : RMSProp + Momentum\nLearning Rate Sceduling $$ \\theta_i^{t+1} \\gets \\theta_i^t-\\frac{\\eta^t}{\\sigma_i^t}g_i^t\\ $$\nWarm Up New Optimization ","permalink":"https://kennems.github.io/posts/tech/3.regression-and-classification/","summary":"Officially begin Deep = Many hidden layers Neurall Network Find a function in function set. Goodness of function Pick the best function Backpropagation - Backward Pass(åå‘ä¼ æ’­) åå‘çš„neural network Regression Stock Market Forecast Self-driving Car Recommendation Step 1 : Model A set of function Step 2 : Goodness of Function $$ \\ha","title":"3. Regression and Classification"},{"content":"Convolutional network (CNN) Networkçš„æ¶æ„è°ƒæ•´\n1ã€All the images to be classified have the same size.\nReceptive filed\nSimplification 1 - Typical Setting all channels : ä¼šçœ‹æ‰€æœ‰çš„channels\nkernel size : é•¿å’Œå®½ ï¼ˆe.g., 3*3)\nStride : ç§»åŠ¨çš„æ­¥é•¿,å¸Œæœ›æœ‰é«˜åº¦çš„é‡å \npadding : è¡¥å€¼ï¼Œè¡¥å……è¶…å‡ºèŒƒå›´çš„å€¼\nEach receptive field has a set of neurons.\nEach receptive field has the neurons with the same set of parameters, which called filter.\nPooling Flatten ","permalink":"https://kennems.github.io/posts/tech/4.cnn/","summary":"Convolutional network (CNN) Networkçš„æ¶æ„è°ƒæ•´ 1ã€All the images to be classified have the same size. Receptive filed Simplification 1 - Typical Setting all channels : ä¼šçœ‹æ‰€æœ‰çš„channels kernel size : é•¿å’Œå®½ ï¼ˆe.g., 3*3) Stride : ç§»åŠ¨çš„","title":"4. CNN"},{"content":"Spatial Transformerï¼ˆSTNï¼‰ å¤„ç†æ—‹è½¬å’Œæ”¾å¤§å›¾å½¢çš„CNNåˆ†ç±»\ninterpolation æ’å€¼æ³• Self-attention Sequence Labeling consider the context -\u0026gt; å‚æ•°å¾ˆå¤§å¹¶ä¸”å®¹æ˜“Over fitting\nSelf-attentionä¼šæŒæœ‰æ•´ä¸ªsequenceçš„ä¿¡æ¯\ninput : vector\noutput : vector $$ q_i=W^qa^i\\ k_i=W^ka^i\\ v^i=W^va^i $$ Multi-head Self-attention å…¶ä¸­ $$ q_i, k_i, v_iå‡å¯ä»¥æœ‰å¤šä¸ª $$\nSelf-attention for Speech Truncated(æˆªçŸ­çš„) Self-attention\nSelf-attention is the complex version of CNN\nCNN is simplified self-attention\nRecurrent Neural Network(RNN) RNNæ‰€åšçš„äº‹æƒ…éƒ½å¯ä»¥ç”¨Self-attentionæ¥æ›¿ä»£\nSelf-attentionæ›´æœ‰æ•ˆç‡\nRNN\nTransformer Sequence to sequence (Seq2seq) Encoder -\u0026gt; Decoder\nEncoder input some vectors and output some vectors\nDecoder Autoregressive Non-autoregressive Decoder åŒæ—¶è¾“å‡ºBEGINå¹¶ä¸”åŒæ—¶è¾“å‡ºç»“æœå’ŒEND\nAdvantage ï¼š parallel, controllable output length\nNAT is usually worse than AT\nEncoder-Decoder Cross Attention\nTeacher Forcing : using the ground truth as input\nCopy Mechanism\nPointer Network Copying Mechanism Guided Attention Beam Search Scheduled Sampling\n","permalink":"https://kennems.github.io/posts/tech/5.transformer/","summary":"Spatial Transformerï¼ˆSTNï¼‰ å¤„ç†æ—‹è½¬å’Œæ”¾å¤§å›¾å½¢çš„CNNåˆ†ç±» interpolation æ’å€¼æ³• Self-attention Sequence Labeling consider the context -\u0026gt; å‚æ•°å¾ˆå¤§å¹¶ä¸”å®¹æ˜“Over fitting Self-attention","title":"5. Transformer"},{"content":" åç§°ï¼š Sulv\u0026rsquo;s Blog ç½‘å€ï¼š https://www.sulvblog.cn å›¾æ ‡ï¼š https://www.sulvblog.cn/img/Q.gif æè¿°ï¼š ä¸€ä¸ªè®°å½•æŠ€æœ¯ã€é˜…è¯»ã€ç”Ÿæ´»çš„åšå®¢ ","permalink":"https://kennems.github.io/links/","summary":"åç§°ï¼š Sulv\u0026rsquo;s Blog ç½‘å€ï¼š https://www.sulvblog.cn å›¾æ ‡ï¼š https://www.sulvblog.cn/img/Q.gif æè¿°ï¼š ä¸€ä¸ªè®°å½•æŠ€æœ¯ã€é˜…è¯»ã€ç”Ÿæ´»çš„åšå®¢","title":"ğŸ¤å‹é“¾"}]