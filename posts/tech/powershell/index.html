<!DOCTYPE html>
<html lang="zh" dir="auto" data-theme="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">

<meta name="msvalidate.01" content="DF5FE493CC759E62BFE073BEA8EFD472" />
<title>PowerShell è¯¦ç»†ä½¿ç”¨ | Kennem&#39;s Blog</title>
<meta name="keywords" content="PowerShell">
<meta name="description" content="PowerShellå­¦ä¹ ç¬”è®°">
<meta name="author" content="ShowGuan">
<link rel="canonical" href="https://kennems.github.io/posts/tech/powershell/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.fb554ce462a8cf4bfbab3304ed6ddda4f3012ffbf48cafa446cf54deb19876a7.css" integrity="sha256-&#43;1VM5GKoz0v7qzME7W3dpPMBL/v0jK&#43;kRs9U3rGYdqc=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://kennems.github.io/img/sun.png">
<link rel="icon" type="image/png" sizes="16x16" href="https://kennems.github.io/img/sun.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://kennems.github.io/img/sun.png">
<link rel="apple-touch-icon" href="https://kennems.github.io/img/sun.png">
<link rel="mask-icon" href="https://kennems.github.io/img/sun.png">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="zh" href="https://kennems.github.io/posts/tech/powershell/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
                color-scheme: dark;
            }

            .list {
                background: var(--theme);
            }

            .toc {
                background: var(--entry);
            }
        }

        @media (prefers-color-scheme: light) {
            .list::-webkit-scrollbar-thumb {
                border-color: var(--code-bg);
            }
        }

    </style>
</noscript>
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.querySelector("html").dataset.theme = 'dark';
    } else if (localStorage.getItem("pref-theme") === "light") {
       document.querySelector("html").dataset.theme = 'light';
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.querySelector("html").dataset.theme = 'dark';
    } else {
        document.querySelector("html").dataset.theme = 'light';
    }

</script>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous">

<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.js" integrity="sha384-VQ8d8WVFw0yHhCk5E8I86oOhv48xLpnDZx5T9GogA/Y84DcCKWXDmSDfn13bzFZY" crossorigin="anonymous"></script>

<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/contrib/auto-render.min.js" integrity="sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR" crossorigin="anonymous"
    onload="renderMathInElement(document.body);"></script>

<script>
document.addEventListener("DOMContentLoaded", function() {
    renderMathInElement(document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "$", right: "$", display: false}
        ]
    });
});
</script>



<link rel="stylesheet" href="https://fonts.cdnfonts.com/css/code-new-roman">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

<meta property="og:url" content="https://kennems.github.io/posts/tech/powershell/">
  <meta property="og:site_name" content="Kennem&#39;s Blog">
  <meta property="og:title" content="PowerShell è¯¦ç»†ä½¿ç”¨">
  <meta property="og:description" content="PowerShellå­¦ä¹ ç¬”è®°">
  <meta property="og:locale" content="zh">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-03-16T10:30:13+08:00">
    <meta property="article:modified_time" content="2025-03-16T10:40:13+08:00">
    <meta property="article:tag" content="PowerShell">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="PowerShell è¯¦ç»†ä½¿ç”¨">
<meta name="twitter:description" content="PowerShellå­¦ä¹ ç¬”è®°">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "ğŸ“šæ–‡ç« ",
      "item": "https://kennems.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "ğŸ’»æŠ€æœ¯",
      "item": "https://kennems.github.io/posts/tech/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "PowerShell è¯¦ç»†ä½¿ç”¨",
      "item": "https://kennems.github.io/posts/tech/powershell/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "PowerShell è¯¦ç»†ä½¿ç”¨",
  "name": "PowerShell è¯¦ç»†ä½¿ç”¨",
  "description": "PowerShellå­¦ä¹ ç¬”è®°",
  "keywords": [
    "PowerShell"
  ],
  "articleBody": "PowerShell è¯¦ç»†ä½¿ç”¨ ä¸€ã€PowerShell ç®€ä»‹ PowerShell æ˜¯å¾®è½¯å¼€å‘çš„ä¸€ç§å‘½ä»¤è¡Œå¤–å£³å’Œè„šæœ¬è¯­è¨€ï¼Œå®ƒåŸºäº .NET æ¡†æ¶ï¼Œä¸ä»…é€‚ç”¨äº Windows ç³»ç»Ÿï¼Œä¹Ÿåœ¨ Linux å’Œ macOS ä¸Šæä¾›æ”¯æŒã€‚ä¸ä¼ ç»Ÿçš„å‘½ä»¤æç¤ºç¬¦ç›¸æ¯”ï¼ŒPowerShell å¤„ç†çš„æ˜¯å¯¹è±¡è€Œéçº¯æ–‡æœ¬ï¼Œä½¿å¾—æ•°æ®ä¼ é€’å’Œç®¡ç†æ›´ä¸ºçµæ´»é«˜æ•ˆã€‚æ— è®ºæ˜¯æ—¥å¸¸ç®¡ç†ä»»åŠ¡è¿˜æ˜¯å¤æ‚çš„è‡ªåŠ¨åŒ–æ“ä½œï¼ŒPowerShell éƒ½æ˜¯éå¸¸å¼ºå¤§çš„å·¥å…·ã€‚\näºŒã€åŸºæœ¬æ¦‚å¿µå’Œè¯­æ³• 1. Cmdletï¼ˆå‘½ä»¤å•å…ƒï¼‰ å®šä¹‰ï¼šCmdlet æ˜¯ PowerShell å†…ç½®çš„è½»é‡çº§å‘½ä»¤ï¼Œéµå¾ªâ€œåŠ¨è¯-åè¯â€å‘½åè§„åˆ™ï¼Œå¦‚ Get-Processã€Set-Itemã€‚ ç¤ºä¾‹ï¼šGet-Process ç”¨äºè·å–å½“å‰è¿è¡Œçš„è¿›ç¨‹åˆ—è¡¨ã€‚ 2. å˜é‡ä¸æ•°æ®ç±»å‹ å˜é‡å£°æ˜ï¼šä½¿ç”¨ $ç¬¦å·ï¼Œä¾‹å¦‚ï¼š\n$greeting = \"Hello World\" æ•°æ®ç±»å‹ï¼šPowerShell æ”¯æŒå­—ç¬¦ä¸²ã€æ•´æ•°ã€å¸ƒå°”å€¼ã€æ•°ç»„ã€å“ˆå¸Œè¡¨ç­‰æ•°æ®ç±»å‹ã€‚\n3. ç®¡é“ï¼ˆPipelineï¼‰ æ¦‚å¿µï¼šç®¡é“ç¬¦å· | ç”¨äºå°†ä¸€ä¸ªå‘½ä»¤çš„è¾“å‡ºä¼ é€’ç»™ä¸‹ä¸€ä¸ªå‘½ä»¤ã€‚\nç¤ºä¾‹ï¼š\nGet-Process | Sort-Object -Property CPU -Descending ä¸Šè¿°å‘½ä»¤è·å–è¿›ç¨‹åˆ—è¡¨å¹¶æŒ‰ CPU å ç”¨é™åºæ’åºã€‚\n4. å¯¹è±¡å¤„ç† PowerShell è¾“å‡ºçš„æ˜¯ .NET å¯¹è±¡ï¼Œè¿™ä½¿å¾—ä½ å¯ä»¥ç›´æ¥è®¿é—®å±æ€§å’Œæ–¹æ³•ï¼Œè€Œä¸ä»…ä»…æ˜¯æ–‡æœ¬ã€‚ä¾‹å¦‚ï¼š\n$process = Get-Process | Where-Object { $_.ProcessName -eq \"notepad\" } $process.Id # è®¿é—®è¿›ç¨‹ID 5. è„šæœ¬æ–‡ä»¶ æ‰©å±•åï¼šè„šæœ¬æ–‡ä»¶ä»¥ .ps1 ç»“å°¾ã€‚\næ‰§è¡Œæ–¹å¼ï¼šåœ¨ PowerShell æ§åˆ¶å°ä¸­æ‰§è¡Œè„šæœ¬ï¼Œä¾‹å¦‚ï¼š\n.\\MyScript.ps1 ä¸‰ã€å¸¸ç”¨å‘½ä»¤åŠä½¿ç”¨ç¤ºä¾‹ 1. å¸®åŠ©ä¸å‘½ä»¤æŸ¥æ‰¾ è·å–å¸®åŠ©ï¼š\nGet-Help Get-Process -Detailed åˆ—å‡ºæ‰€æœ‰å‘½ä»¤ï¼š\nGet-Command æ›´æ–°å¸®åŠ©æ–‡æ¡£ï¼š\nUpdate-Help 2. æ–‡ä»¶ç³»ç»Ÿç®¡ç† åˆ—å‡ºç›®å½•å†…å®¹ï¼ˆç­‰åŒäº ls æˆ– dirï¼‰ï¼š\nGet-ChildItem -Path C:\\ åˆ‡æ¢ç›®å½•ï¼š\nSet-Location -Path C:\\Users å¤åˆ¶æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹ï¼š\nCopy-Item -Path .\\file.txt -Destination D:\\Backup\\ ç§»åŠ¨æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹ï¼š\nMove-Item -Path .\\file.txt -Destination D:\\Archive\\ åˆ é™¤æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹ï¼š\nRemove-Item -Path .\\oldfile.txt 3. è¿›ç¨‹ä¸æœåŠ¡ç®¡ç† è·å–è¿›ç¨‹ä¿¡æ¯ï¼š\nGet-Process åœæ­¢æŒ‡å®šè¿›ç¨‹ï¼š\nStop-Process -Name notepad æŸ¥çœ‹æœåŠ¡çŠ¶æ€ï¼š\nGet-Service ç®¡ç†æœåŠ¡ï¼ˆå¯åŠ¨ã€åœæ­¢ã€é‡å¯ï¼‰ï¼š\nStart-Service -Name \"wuauserv\" Stop-Service -Name \"wuauserv\" Restart-Service -Name \"wuauserv\" 4. ç¯å¢ƒå˜é‡ç®¡ç† æŸ¥çœ‹ç¯å¢ƒå˜é‡ï¼š\nGet-ChildItem Env: è®¾ç½®ç¯å¢ƒå˜é‡ï¼š\n$Env:Path = \"$Env:Path;C:\\MyFolder\" 5. è„šæœ¬ä¸å‡½æ•° å®šä¹‰å’Œè°ƒç”¨å‡½æ•°ï¼š\nfunction Say-Hello { param([string]$Name) Write-Output \"Hello, $Name!\" } Say-Hello -Name \"Alice\" æ¡ä»¶åˆ¤æ–­ä¸å¾ªç¯ï¼š\nif ($x -gt 10) { Write-Output \"å¤§äº10\" } else { Write-Output \"å°äºç­‰äº10\" } for ($i = 1; $i -le 5; $i++) { Write-Output \"æ•°å­—ï¼š$i\" } 6. ç®¡é“ä¸å¯¹è±¡æ“ä½œ ç­›é€‰ä¸éå†ï¼š\nGet-Service | Where-Object { $_.Status -eq \"Running\" } | ForEach-Object { $_.Name } æ’åºä¸æ ¼å¼åŒ–ï¼š\nGet-Process | Sort-Object -Property CPU -Descending | Format-Table -Property Name, CPU, Id 7. è¿œç¨‹ç®¡ç† å¯ç”¨è¿œç¨‹åŠŸèƒ½ï¼š\nEnable-PSRemoting -Force è¿›å…¥è¿œç¨‹ä¼šè¯ï¼š\nEnter-PSSession -ComputerName æ‰§è¡Œè¿œç¨‹å‘½ä»¤ï¼š\nInvoke-Command -ComputerName -ScriptBlock { Get-Process } 8. æ¨¡å—ç®¡ç† æŸ¥çœ‹å·²å®‰è£…æ¨¡å—ï¼š\nGet-Module -ListAvailable å¯¼å…¥æ¨¡å—ï¼š\nImport-Module ModuleName å®‰è£…æ–°æ¨¡å—\nï¼ˆéœ€å®‰è£… PowerShellGet æ¨¡å—ï¼‰ï¼š\nInstall-Module ModuleName 9. æ‰§è¡Œç­–ç•¥ï¼ˆExecution Policyï¼‰ æŸ¥çœ‹å½“å‰ç­–ç•¥ï¼š\nGet-ExecutionPolicy è®¾ç½®æ‰§è¡Œç­–ç•¥\nï¼ˆä¾‹å¦‚ RemoteSignedï¼‰ï¼š\nSet-ExecutionPolicy RemoteSigned æ³¨æ„ï¼šä¿®æ”¹æ‰§è¡Œç­–ç•¥æ—¶è¦ç¡®ä¿äº†è§£å…¶å®‰å…¨å½±å“ï¼Œé˜²æ­¢æ‰§è¡ŒæœªçŸ¥æ¥æºçš„è„šæœ¬ã€‚\nâ­æŸ¥çœ‹ æŸä¸ªæ–‡ä»¶çš„ sha256 å“ˆå¸Œå€¼ Get-FileHash \"path\" -Algorithm SHA256 è·å–å°å†™\n(Get-FileHash \"C:\\path\\to\\your\\file.zip\" -Algorithm SHA256).Hash.ToLower() 1. æ›´æ¢å“ˆå¸Œç®—æ³• é™¤äº† SHA256ï¼Œè¿˜å¯ä»¥æŒ‡å®šå…¶ä»–ç®—æ³•ï¼Œä¾‹å¦‚ SHA512ã€MD5ã€SHA1 ç­‰ã€‚ç¤ºä¾‹ï¼š\n# ä½¿ç”¨ SHA512 ç®—æ³•è®¡ç®—æ–‡ä»¶å“ˆå¸Œå€¼ Get-FileHash \"C:\\path\\to\\your\\file.zip\" -Algorithm SHA512 2. å¯¹æ¯”ä¸¤ä¸ªæ–‡ä»¶çš„å“ˆå¸Œå€¼ å¯ç”¨äºéªŒè¯ä¸¤ä¸ªæ–‡ä»¶æ˜¯å¦ä¸€è‡´ï¼š\n$hash1 = (Get-FileHash \"C:\\path\\to\\your\\file1.zip\" -Algorithm SHA256).Hash.ToLower() $hash2 = (Get-FileHash \"C:\\path\\to\\your\\file2.zip\" -Algorithm SHA256).Hash.ToLower() if ($hash1 -eq $hash2) { Write-Output \"ä¸¤ä¸ªæ–‡ä»¶çš„å“ˆå¸Œå€¼ç›¸åŒï¼Œæ–‡ä»¶å†…å®¹ä¸€è‡´ã€‚\" } else { Write-Output \"ä¸¤ä¸ªæ–‡ä»¶çš„å“ˆå¸Œå€¼ä¸åŒï¼Œæ–‡ä»¶å†…å®¹ä¸ä¸€è‡´ã€‚\" } 3. è®¡ç®—æ–‡ä»¶å¤¹ä¸­æ‰€æœ‰æ–‡ä»¶çš„å“ˆå¸Œå€¼ ç»“åˆ Get-ChildItem å’Œ ForEach-Object å¯ä»¥æ‰¹é‡è®¡ç®—æ–‡ä»¶å¤¹ä¸­æ‰€æœ‰æ–‡ä»¶çš„å“ˆå¸Œå€¼ï¼š\nGet-ChildItem \"C:\\path\\to\\folder\" -File | ForEach-Object { $fileHash = (Get-FileHash $_.FullName -Algorithm SHA256).Hash.ToLower() [PSCustomObject]@{ FileName = $_.Name Hash = $fileHash } } | Format-Table -AutoSize è¯¥å‘½ä»¤éå†æŒ‡å®šç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ï¼Œå¹¶è¾“å‡ºæ–‡ä»¶åä¸å¯¹åº”çš„ SHA256 å“ˆå¸Œå€¼ã€‚\n4. å°†å“ˆå¸Œå€¼è¾“å‡ºåˆ°æ–‡ä»¶ å¦‚æœéœ€è¦å°†å“ˆå¸Œå€¼ä¿å­˜åˆ°æ–‡ä»¶ä¸­ï¼Œå¯ä½¿ç”¨ Out-Fileï¼š\n(Get-FileHash \"C:\\path\\to\\your\\file.zip\" -Algorithm SHA256).Hash.ToLower() | Out-File \"C:\\path\\to\\output\\hash.txt\" 5. éªŒè¯æ–‡ä»¶å®Œæ•´æ€§ å‡è®¾ä½ å·²æœ‰ä¸€ä¸ªå·²çŸ¥çš„é¢„æœŸå“ˆå¸Œå€¼ï¼Œå¯ä»¥å°†è®¡ç®—å¾—åˆ°çš„å“ˆå¸Œå€¼ä¸é¢„æœŸå€¼è¿›è¡Œæ¯”å¯¹ï¼Œåˆ¤æ–­æ–‡ä»¶æ˜¯å¦è¢«ç¯¡æ”¹ï¼š\n$expectedHash = \"abcdef1234567890abcdef1234567890abcdef1234567890abcdef1234567890\" # è¯·æ›¿æ¢ä¸ºå®é™…çš„é¢„æœŸå“ˆå¸Œå€¼ $actualHash = (Get-FileHash \"C:\\path\\to\\your\\file.zip\" -Algorithm SHA256).Hash.ToLower() if ($expectedHash -eq $actualHash) { Write-Output \"æ–‡ä»¶å®Œæ•´æ€§éªŒè¯é€šè¿‡ã€‚\" } else { Write-Output \"æ–‡ä»¶å®Œæ•´æ€§éªŒè¯å¤±è´¥ï¼\" } 6. ç»“åˆè„šæœ¬æ‰¹é‡éªŒè¯å¤šä¸ªæ–‡ä»¶ å¦‚æœä½ éœ€è¦å¯¹å¤šä¸ªæ–‡ä»¶è¿›è¡Œå®Œæ•´æ€§éªŒè¯ï¼Œå¯ä»¥æŠŠæ–‡ä»¶è·¯å¾„å’Œé¢„æœŸå“ˆå¸Œå€¼ä¿å­˜åœ¨ä¸€ä¸ªæ•°æ®ç»“æ„ä¸­ï¼Œç„¶åéå†éªŒè¯ï¼š\n# å®šä¹‰å¾…éªŒè¯çš„æ–‡ä»¶åŠå…¶é¢„æœŸå“ˆå¸Œå€¼åˆ—è¡¨ $files = @( @{ Path = \"C:\\path\\to\\file1.zip\"; ExpectedHash = \"é¢„æœŸå“ˆå¸Œå€¼1\" }, @{ Path = \"C:\\path\\to\\file2.zip\"; ExpectedHash = \"é¢„æœŸå“ˆå¸Œå€¼2\" } ) foreach ($file in $files) { $actualHash = (Get-FileHash $file.Path -Algorithm SHA256).Hash.ToLower() if ($actualHash -eq $file.ExpectedHash.ToLower()) { Write-Output \"$($file.Path) éªŒè¯é€šè¿‡ã€‚\" } else { Write-Output \"$($file.Path) éªŒè¯å¤±è´¥ï¼\" } } å››ã€è„šæœ¬ç¼–å†™ä¸è°ƒè¯•æŠ€å·§ 1. è„šæœ¬æ–‡ä»¶ ç¼–å†™ä¸ä¿å­˜ï¼šå°†å¸¸ç”¨å‘½ä»¤å†™å…¥ .ps1 æ–‡ä»¶ä¸­ä¿å­˜ï¼Œä¾¿äºé‡å¤ä½¿ç”¨ã€‚\næ‰§è¡Œè„šæœ¬ï¼š\n.\\MyScript.ps1 2. è°ƒè¯•æ–¹æ³• è¾“å‡ºè°ƒè¯•ä¿¡æ¯ï¼šä½¿ç”¨ Write-Output æˆ– Write-Host è¾“å‡ºå˜é‡å’ŒçŠ¶æ€ã€‚\né€æ­¥è°ƒè¯•ï¼šå¯ä»¥å¯ç”¨é€è¡Œè°ƒè¯•\nSet-PSDebug -Step é”™è¯¯å¤„ç†ï¼šä½¿ç”¨ Try-Catch ç»“æ„æ•è·å’Œå¤„ç†é”™è¯¯ï¼š\ntry { Get-Item \"C:\\nonexistentfile.txt\" } catch { Write-Host \"é”™è¯¯ä¿¡æ¯ï¼š$_\" } äº”ã€PowerShell é«˜çº§ç‰¹æ€§ 1. å¯¹è±¡ä¸ç®¡é“çš„ä¼˜åŠ¿ å¯¹è±¡ä¼ é€’ï¼šä¸åŒäºä¼ ç»Ÿå‘½ä»¤è¡Œå°†æ–‡æœ¬ä¼ é€’ï¼ŒPowerShell ä¼ é€’çš„æ˜¯å¯¹è±¡ï¼Œå…è®¸ä½ ç›´æ¥æ“ä½œå±æ€§å’Œæ–¹æ³•ï¼Œæå¤§åœ°ç®€åŒ–äº†æ•°æ®å¤„ç†æµç¨‹ã€‚ 2. æ•°æ®æ ¼å¼è½¬æ¢ è½¬æ¢ä¸º JSON æˆ– XMLï¼š\nGet-Process | ConvertTo-Json Get-Service | ConvertTo-XML è¾“å‡ºåˆ°æ–‡ä»¶ï¼š\nGet-Process | Out-File -FilePath processes.txt 3. è‡ªåŠ¨åŒ–ä»»åŠ¡ä¸è®¡åˆ’ä»»åŠ¡ å®šæ—¶æ‰§è¡Œè„šæœ¬ï¼šå¯ç»“åˆ Windows ä»»åŠ¡è®¡åˆ’ç¨‹åºï¼ˆTask Schedulerï¼‰æˆ– PowerShell å†…ç½®çš„ ScheduledJob æ¨¡å—å®ç°è‡ªåŠ¨åŒ–ä»»åŠ¡ã€‚ æ‰¹é‡ç®¡ç†ï¼šåˆ©ç”¨ Invoke-Command åŒæ—¶ç®¡ç†å¤šå°æœåŠ¡å™¨ï¼Œæé«˜ç³»ç»Ÿç®¡ç†æ•ˆç‡ã€‚ 4. PowerShell Remoting è¿œç¨‹ä¼šè¯ï¼šå…è®¸ä½ é€šè¿‡ç½‘ç»œè¿œç¨‹ç®¡ç†è®¡ç®—æœºï¼Œæ˜¯ç³»ç»Ÿç®¡ç†å‘˜æ—¥å¸¸ç®¡ç†æœåŠ¡å™¨çš„é‡è¦å·¥å…·ã€‚ å…­ã€ç»“åˆOffice è·å–å½“å‰æœ€å å†…å­˜çš„åä¸ªè¿›ç¨‹ï¼Œå¹¶åœ¨Excelç”Ÿæˆé¥¼å›¾ï¼š\n# create new excel instance $objExcel = New-Object -comobject Excel.Application $objExcel.Visible = $True $objWorkbook = $objExcel.Workbooks.Add() $objWorksheet = $objWorkbook.Worksheets.Item(1) # write information to the excel file $i = 0 $first10 = (ps | sort ws -Descending | select -first 10) $first10 | foreach -Process {$i++; $objWorksheet.Cells.Item($i,1) = $_.name; $objWorksheet.Cells.Item($i,2) = $_.ws} $otherMem = (ps | measure ws -s).Sum - ($first10 | measure ws -s).Sum $objWorksheet.Cells.Item(11,1) = \"Others\"; $objWorksheet.Cells.Item(11,2) = $otherMem # draw the pie chart $objCharts = $objWorksheet.ChartObjects() $objChart = $objCharts.Add(0, 0, 500, 300) $objChart.Chart.SetSourceData($objWorksheet.range(\"A1:B11\"), 2) $objChart.Chart.ChartType = 70 $objChart.Chart.ApplyDataLabels(5) å‚è€ƒèµ„æ–™ï¼š\nå¾®è½¯å®˜æ–¹ PowerShell æ–‡æ¡£ ",
  "wordCount" : "2159",
  "inLanguage": "zh",
  "datePublished": "2025-03-16T10:30:13+08:00",
  "dateModified": "2025-03-16T10:40:13+08:00",
  "author":{
    "@type": "Person",
    "name": "ShowGuan"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://kennems.github.io/posts/tech/powershell/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Kennem's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://kennems.github.io/img/sun.png"
    }
  }
}
</script>
<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />
<script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>




</head>
<body id="top">
    <header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://kennems.github.io/" accesskey="h" title="Kennem&#39;s Blog (Alt + H)">
                <img src="https://kennems.github.io/img/sun.png" alt="" aria-label="logo"
                    height="35">Kennem&#39;s Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://kennems.github.io/" title="ğŸ ä¸»é¡µ">
                    <span>ğŸ ä¸»é¡µ</span>
                </a>
            </li>
            <li>
                <a href="https://kennems.github.io/search" title="ğŸ”æœç´¢ (Alt &#43; /)" accesskey=/>
                    <span>ğŸ”æœç´¢</span>
                </a>
            </li>
            <li>
                <a href="https://kennems.github.io/posts" title="ğŸ“šæ–‡ç« ">
                    <span>ğŸ“šæ–‡ç« </span>
                </a>
            </li>
            <li>
                <a href="https://kennems.github.io/archives" title="â±æ—¶é—´è½´">
                    <span>â±æ—¶é—´è½´</span>
                </a>
            </li>
            <li>
                <a href="https://kennems.github.io/tags" title="ğŸ”–æ ‡ç­¾">
                    <span>ğŸ”–æ ‡ç­¾</span>
                </a>
            </li>
            <li>
                <a href="https://kennems.github.io/categories" title="ğŸ—‚ï¸åˆ†ç±»">
                    <span>ğŸ—‚ï¸åˆ†ç±»</span>
                </a>
            </li>
            <li>
                <a href="https://kennems.github.io/about" title="ğŸ™‹ğŸ»â€â™‚ï¸å…³äº">
                    <span>ğŸ™‹ğŸ»â€â™‚ï¸å…³äº</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://kennems.github.io/">ä¸»é¡µ</a>&nbsp;Â»&nbsp;<a href="https://kennems.github.io/posts/">ğŸ“šæ–‡ç« </a>&nbsp;Â»&nbsp;<a href="https://kennems.github.io/posts/tech/">ğŸ’»æŠ€æœ¯</a></div>
    <h1 class="post-title entry-hint-parent">
      PowerShell è¯¦ç»†ä½¿ç”¨
    </h1>
    <div class="post-description">
      PowerShellå­¦ä¹ ç¬”è®°
    </div>
    <div class="post-meta"><span title='2025-03-16 10:30:13 +0800 CST'>2025-03-16</span>&nbsp;Â·&nbsp;<span>5 åˆ†é’Ÿ</span>&nbsp;Â·&nbsp;<span>2159 å­—</span>&nbsp;Â·&nbsp;updated:&nbsp;2025-03-16&nbsp;Â·&nbsp;<span>ShowGuan</span>

</div>
    
     <div class="post-password">
        
    </div>
  </header> <aside id="toc-container" class="toc-container wide">
    <div class="toc">
        <details  open>
            <summary accesskey="c" title="(Alt + C)">
                <span class="details">ç›®å½•</span>
            </summary>

            <div class="inner"><ul>
                    <li>
                        <a href="#powershell-%e8%af%a6%e7%bb%86%e4%bd%bf%e7%94%a8" aria-label="PowerShell è¯¦ç»†ä½¿ç”¨">PowerShell è¯¦ç»†ä½¿ç”¨</a><ul>
                            
                    <li>
                        <a href="#%e4%b8%80powershell-%e7%ae%80%e4%bb%8b" aria-label="ä¸€ã€PowerShell ç®€ä»‹">ä¸€ã€PowerShell ç®€ä»‹</a></li>
                    <li>
                        <a href="#%e4%ba%8c%e5%9f%ba%e6%9c%ac%e6%a6%82%e5%bf%b5%e5%92%8c%e8%af%ad%e6%b3%95" aria-label="äºŒã€åŸºæœ¬æ¦‚å¿µå’Œè¯­æ³•">äºŒã€åŸºæœ¬æ¦‚å¿µå’Œè¯­æ³•</a><ul>
                            
                    <li>
                        <a href="#1-cmdlet%e5%91%bd%e4%bb%a4%e5%8d%95%e5%85%83" aria-label="1. Cmdletï¼ˆå‘½ä»¤å•å…ƒï¼‰">1. Cmdletï¼ˆå‘½ä»¤å•å…ƒï¼‰</a></li>
                    <li>
                        <a href="#2-%e5%8f%98%e9%87%8f%e4%b8%8e%e6%95%b0%e6%8d%ae%e7%b1%bb%e5%9e%8b" aria-label="2. å˜é‡ä¸æ•°æ®ç±»å‹">2. å˜é‡ä¸æ•°æ®ç±»å‹</a></li>
                    <li>
                        <a href="#3-%e7%ae%a1%e9%81%93pipeline" aria-label="3. ç®¡é“ï¼ˆPipelineï¼‰">3. ç®¡é“ï¼ˆPipelineï¼‰</a></li>
                    <li>
                        <a href="#4-%e5%af%b9%e8%b1%a1%e5%a4%84%e7%90%86" aria-label="4. å¯¹è±¡å¤„ç†">4. å¯¹è±¡å¤„ç†</a></li>
                    <li>
                        <a href="#5-%e8%84%9a%e6%9c%ac%e6%96%87%e4%bb%b6" aria-label="5. è„šæœ¬æ–‡ä»¶">5. è„šæœ¬æ–‡ä»¶</a></li></ul>
                    </li>
                    <li>
                        <a href="#%e4%b8%89%e5%b8%b8%e7%94%a8%e5%91%bd%e4%bb%a4%e5%8f%8a%e4%bd%bf%e7%94%a8%e7%a4%ba%e4%be%8b" aria-label="ä¸‰ã€å¸¸ç”¨å‘½ä»¤åŠä½¿ç”¨ç¤ºä¾‹">ä¸‰ã€å¸¸ç”¨å‘½ä»¤åŠä½¿ç”¨ç¤ºä¾‹</a><ul>
                            
                    <li>
                        <a href="#1-%e5%b8%ae%e5%8a%a9%e4%b8%8e%e5%91%bd%e4%bb%a4%e6%9f%a5%e6%89%be" aria-label="1. å¸®åŠ©ä¸å‘½ä»¤æŸ¥æ‰¾">1. å¸®åŠ©ä¸å‘½ä»¤æŸ¥æ‰¾</a></li>
                    <li>
                        <a href="#2-%e6%96%87%e4%bb%b6%e7%b3%bb%e7%bb%9f%e7%ae%a1%e7%90%86" aria-label="2. æ–‡ä»¶ç³»ç»Ÿç®¡ç†">2. æ–‡ä»¶ç³»ç»Ÿç®¡ç†</a></li>
                    <li>
                        <a href="#3-%e8%bf%9b%e7%a8%8b%e4%b8%8e%e6%9c%8d%e5%8a%a1%e7%ae%a1%e7%90%86" aria-label="3. è¿›ç¨‹ä¸æœåŠ¡ç®¡ç†">3. è¿›ç¨‹ä¸æœåŠ¡ç®¡ç†</a></li>
                    <li>
                        <a href="#4-%e7%8e%af%e5%a2%83%e5%8f%98%e9%87%8f%e7%ae%a1%e7%90%86" aria-label="4. ç¯å¢ƒå˜é‡ç®¡ç†">4. ç¯å¢ƒå˜é‡ç®¡ç†</a></li>
                    <li>
                        <a href="#5-%e8%84%9a%e6%9c%ac%e4%b8%8e%e5%87%bd%e6%95%b0" aria-label="5. è„šæœ¬ä¸å‡½æ•°">5. è„šæœ¬ä¸å‡½æ•°</a></li>
                    <li>
                        <a href="#6-%e7%ae%a1%e9%81%93%e4%b8%8e%e5%af%b9%e8%b1%a1%e6%93%8d%e4%bd%9c" aria-label="6. ç®¡é“ä¸å¯¹è±¡æ“ä½œ">6. ç®¡é“ä¸å¯¹è±¡æ“ä½œ</a></li>
                    <li>
                        <a href="#7-%e8%bf%9c%e7%a8%8b%e7%ae%a1%e7%90%86" aria-label="7. è¿œç¨‹ç®¡ç†">7. è¿œç¨‹ç®¡ç†</a></li>
                    <li>
                        <a href="#8-%e6%a8%a1%e5%9d%97%e7%ae%a1%e7%90%86" aria-label="8. æ¨¡å—ç®¡ç†">8. æ¨¡å—ç®¡ç†</a></li>
                    <li>
                        <a href="#9-%e6%89%a7%e8%a1%8c%e7%ad%96%e7%95%a5execution-policy" aria-label="9. æ‰§è¡Œç­–ç•¥ï¼ˆExecution Policyï¼‰">9. æ‰§è¡Œç­–ç•¥ï¼ˆExecution Policyï¼‰</a></li>
                    <li>
                        <a href="#%e6%9f%a5%e7%9c%8b-%e6%9f%90%e4%b8%aa%e6%96%87%e4%bb%b6%e7%9a%84-sha256-%e5%93%88%e5%b8%8c%e5%80%bc" aria-label="â­æŸ¥çœ‹ æŸä¸ªæ–‡ä»¶çš„ sha256 å“ˆå¸Œå€¼">â­æŸ¥çœ‹ æŸä¸ªæ–‡ä»¶çš„ sha256 å“ˆå¸Œå€¼</a><ul>
                            
                    <li>
                        <a href="#1-%e6%9b%b4%e6%8d%a2%e5%93%88%e5%b8%8c%e7%ae%97%e6%b3%95" aria-label="1. æ›´æ¢å“ˆå¸Œç®—æ³•">1. æ›´æ¢å“ˆå¸Œç®—æ³•</a><ul>
                            
                    <li>
                        <a href="#2-%e5%af%b9%e6%af%94%e4%b8%a4%e4%b8%aa%e6%96%87%e4%bb%b6%e7%9a%84%e5%93%88%e5%b8%8c%e5%80%bc" aria-label="2. å¯¹æ¯”ä¸¤ä¸ªæ–‡ä»¶çš„å“ˆå¸Œå€¼">2. å¯¹æ¯”ä¸¤ä¸ªæ–‡ä»¶çš„å“ˆå¸Œå€¼</a></li>
                    <li>
                        <a href="#3-%e8%ae%a1%e7%ae%97%e6%96%87%e4%bb%b6%e5%a4%b9%e4%b8%ad%e6%89%80%e6%9c%89%e6%96%87%e4%bb%b6%e7%9a%84%e5%93%88%e5%b8%8c%e5%80%bc" aria-label="3. è®¡ç®—æ–‡ä»¶å¤¹ä¸­æ‰€æœ‰æ–‡ä»¶çš„å“ˆå¸Œå€¼">3. è®¡ç®—æ–‡ä»¶å¤¹ä¸­æ‰€æœ‰æ–‡ä»¶çš„å“ˆå¸Œå€¼</a></li>
                    <li>
                        <a href="#4-%e5%b0%86%e5%93%88%e5%b8%8c%e5%80%bc%e8%be%93%e5%87%ba%e5%88%b0%e6%96%87%e4%bb%b6" aria-label="4. å°†å“ˆå¸Œå€¼è¾“å‡ºåˆ°æ–‡ä»¶">4. å°†å“ˆå¸Œå€¼è¾“å‡ºåˆ°æ–‡ä»¶</a></li>
                    <li>
                        <a href="#5-%e9%aa%8c%e8%af%81%e6%96%87%e4%bb%b6%e5%ae%8c%e6%95%b4%e6%80%a7" aria-label="5. éªŒè¯æ–‡ä»¶å®Œæ•´æ€§">5. éªŒè¯æ–‡ä»¶å®Œæ•´æ€§</a></li>
                    <li>
                        <a href="#6-%e7%bb%93%e5%90%88%e8%84%9a%e6%9c%ac%e6%89%b9%e9%87%8f%e9%aa%8c%e8%af%81%e5%a4%9a%e4%b8%aa%e6%96%87%e4%bb%b6" aria-label="6. ç»“åˆè„šæœ¬æ‰¹é‡éªŒè¯å¤šä¸ªæ–‡ä»¶">6. ç»“åˆè„šæœ¬æ‰¹é‡éªŒè¯å¤šä¸ªæ–‡ä»¶</a></li></ul>
                    </li></ul>
                    </li></ul>
                    </li>
                    <li>
                        <a href="#%e5%9b%9b%e8%84%9a%e6%9c%ac%e7%bc%96%e5%86%99%e4%b8%8e%e8%b0%83%e8%af%95%e6%8a%80%e5%b7%a7" aria-label="å››ã€è„šæœ¬ç¼–å†™ä¸è°ƒè¯•æŠ€å·§">å››ã€è„šæœ¬ç¼–å†™ä¸è°ƒè¯•æŠ€å·§</a><ul>
                            
                    <li>
                        <a href="#1-%e8%84%9a%e6%9c%ac%e6%96%87%e4%bb%b6" aria-label="1. è„šæœ¬æ–‡ä»¶">1. è„šæœ¬æ–‡ä»¶</a></li>
                    <li>
                        <a href="#2-%e8%b0%83%e8%af%95%e6%96%b9%e6%b3%95" aria-label="2. è°ƒè¯•æ–¹æ³•">2. è°ƒè¯•æ–¹æ³•</a></li></ul>
                    </li>
                    <li>
                        <a href="#%e4%ba%94powershell-%e9%ab%98%e7%ba%a7%e7%89%b9%e6%80%a7" aria-label="äº”ã€PowerShell é«˜çº§ç‰¹æ€§">äº”ã€PowerShell é«˜çº§ç‰¹æ€§</a><ul>
                            
                    <li>
                        <a href="#1-%e5%af%b9%e8%b1%a1%e4%b8%8e%e7%ae%a1%e9%81%93%e7%9a%84%e4%bc%98%e5%8a%bf" aria-label="1. å¯¹è±¡ä¸ç®¡é“çš„ä¼˜åŠ¿">1. å¯¹è±¡ä¸ç®¡é“çš„ä¼˜åŠ¿</a></li>
                    <li>
                        <a href="#2-%e6%95%b0%e6%8d%ae%e6%a0%bc%e5%bc%8f%e8%bd%ac%e6%8d%a2" aria-label="2. æ•°æ®æ ¼å¼è½¬æ¢">2. æ•°æ®æ ¼å¼è½¬æ¢</a></li>
                    <li>
                        <a href="#3-%e8%87%aa%e5%8a%a8%e5%8c%96%e4%bb%bb%e5%8a%a1%e4%b8%8e%e8%ae%a1%e5%88%92%e4%bb%bb%e5%8a%a1" aria-label="3. è‡ªåŠ¨åŒ–ä»»åŠ¡ä¸è®¡åˆ’ä»»åŠ¡">3. è‡ªåŠ¨åŒ–ä»»åŠ¡ä¸è®¡åˆ’ä»»åŠ¡</a></li>
                    <li>
                        <a href="#4-powershell-remoting" aria-label="4. PowerShell Remoting">4. PowerShell Remoting</a></li></ul>
                    </li>
                    <li>
                        <a href="#%e5%85%ad%e7%bb%93%e5%90%88office" aria-label="å…­ã€ç»“åˆOffice">å…­ã€ç»“åˆOffice</a>
                    </li>
                </ul>
                </li>
                </ul>
            </div>
        </details>
    </div>
</aside>
<script>
    let activeElement;
    let elements;
    window.addEventListener('DOMContentLoaded', function (event) {
        checkTocPosition();

        elements = document.querySelectorAll('h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]');
         
         activeElement = elements[0];
         const id = encodeURI(activeElement.getAttribute('id')).toLowerCase();
         document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
     }, false);

    window.addEventListener('resize', function(event) {
        checkTocPosition();
    }, false);

    window.addEventListener('scroll', () => {
        
        activeElement = Array.from(elements).find((element) => {
            if ((getOffsetTop(element) - window.pageYOffset) > 0 && 
                (getOffsetTop(element) - window.pageYOffset) < window.innerHeight/2) {
                return element;
            }
        }) || activeElement

        elements.forEach(element => {
             const id = encodeURI(element.getAttribute('id')).toLowerCase();
             if (element === activeElement){
                 document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
             } else {
                 document.querySelector(`.inner ul li a[href="#${id}"]`).classList.remove('active');
             }
         })
     }, false);

    const main = parseInt(getComputedStyle(document.body).getPropertyValue('--article-width'), 10);
    const toc = parseInt(getComputedStyle(document.body).getPropertyValue('--toc-width'), 10);
    const gap = parseInt(getComputedStyle(document.body).getPropertyValue('--gap'), 10);

    function checkTocPosition() {
        const width = document.body.scrollWidth;

        if (width - main - (toc * 2) - (gap * 4) > 0) {
            document.getElementById("toc-container").classList.add("wide");
        } else {
            document.getElementById("toc-container").classList.remove("wide");
        }
    }

    function getOffsetTop(element) {
        if (!element.getClientRects().length) {
            return 0;
        }
        let rect = element.getBoundingClientRect();
        let win = element.ownerDocument.defaultView;
        return rect.top + win.pageYOffset;   
    }
</script>

  <div class="post-content"><h1 id="powershell-è¯¦ç»†ä½¿ç”¨">PowerShell è¯¦ç»†ä½¿ç”¨<a hidden class="anchor" aria-hidden="true" href="#powershell-è¯¦ç»†ä½¿ç”¨">#</a></h1>
<h2 id="ä¸€powershell-ç®€ä»‹">ä¸€ã€PowerShell ç®€ä»‹<a hidden class="anchor" aria-hidden="true" href="#ä¸€powershell-ç®€ä»‹">#</a></h2>
<p>PowerShell æ˜¯å¾®è½¯å¼€å‘çš„ä¸€ç§å‘½ä»¤è¡Œå¤–å£³å’Œè„šæœ¬è¯­è¨€ï¼Œå®ƒåŸºäº .NET æ¡†æ¶ï¼Œä¸ä»…é€‚ç”¨äº Windows ç³»ç»Ÿï¼Œä¹Ÿåœ¨ Linux å’Œ macOS ä¸Šæä¾›æ”¯æŒã€‚ä¸ä¼ ç»Ÿçš„å‘½ä»¤æç¤ºç¬¦ç›¸æ¯”ï¼ŒPowerShell å¤„ç†çš„æ˜¯å¯¹è±¡è€Œéçº¯æ–‡æœ¬ï¼Œä½¿å¾—æ•°æ®ä¼ é€’å’Œç®¡ç†æ›´ä¸ºçµæ´»é«˜æ•ˆã€‚æ— è®ºæ˜¯æ—¥å¸¸ç®¡ç†ä»»åŠ¡è¿˜æ˜¯å¤æ‚çš„è‡ªåŠ¨åŒ–æ“ä½œï¼ŒPowerShell éƒ½æ˜¯éå¸¸å¼ºå¤§çš„å·¥å…·ã€‚</p>
<h2 id="äºŒåŸºæœ¬æ¦‚å¿µå’Œè¯­æ³•">äºŒã€åŸºæœ¬æ¦‚å¿µå’Œè¯­æ³•<a hidden class="anchor" aria-hidden="true" href="#äºŒåŸºæœ¬æ¦‚å¿µå’Œè¯­æ³•">#</a></h2>
<h3 id="1-cmdletå‘½ä»¤å•å…ƒ">1. Cmdletï¼ˆå‘½ä»¤å•å…ƒï¼‰<a hidden class="anchor" aria-hidden="true" href="#1-cmdletå‘½ä»¤å•å…ƒ">#</a></h3>
<ul>
<li><strong>å®šä¹‰</strong>ï¼šCmdlet æ˜¯ PowerShell å†…ç½®çš„è½»é‡çº§å‘½ä»¤ï¼Œéµå¾ªâ€œåŠ¨è¯-åè¯â€å‘½åè§„åˆ™ï¼Œå¦‚ <code>Get-Process</code>ã€<code>Set-Item</code>ã€‚</li>
<li><strong>ç¤ºä¾‹</strong>ï¼š<code>Get-Process</code> ç”¨äºè·å–å½“å‰è¿è¡Œçš„è¿›ç¨‹åˆ—è¡¨ã€‚</li>
</ul>
<h3 id="2-å˜é‡ä¸æ•°æ®ç±»å‹">2. å˜é‡ä¸æ•°æ®ç±»å‹<a hidden class="anchor" aria-hidden="true" href="#2-å˜é‡ä¸æ•°æ®ç±»å‹">#</a></h3>
<ul>
<li>
<p>å˜é‡å£°æ˜ï¼šä½¿ç”¨ <code>$</code>ç¬¦å·ï¼Œä¾‹å¦‚ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>$greeting = <span style="color:#e6db74">&#34;Hello World&#34;</span>
</span></span></code></pre></div></li>
<li>
<p><strong>æ•°æ®ç±»å‹</strong>ï¼šPowerShell æ”¯æŒå­—ç¬¦ä¸²ã€æ•´æ•°ã€å¸ƒå°”å€¼ã€æ•°ç»„ã€å“ˆå¸Œè¡¨ç­‰æ•°æ®ç±»å‹ã€‚</p>
</li>
</ul>
<h3 id="3-ç®¡é“pipeline">3. ç®¡é“ï¼ˆPipelineï¼‰<a hidden class="anchor" aria-hidden="true" href="#3-ç®¡é“pipeline">#</a></h3>
<ul>
<li>
<p><strong>æ¦‚å¿µ</strong>ï¼šç®¡é“ç¬¦å· <code>|</code> ç”¨äºå°†ä¸€ä¸ªå‘½ä»¤çš„è¾“å‡ºä¼ é€’ç»™ä¸‹ä¸€ä¸ªå‘½ä»¤ã€‚</p>
</li>
<li>
<p>ç¤ºä¾‹ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>Get-Process | Sort-Object -Property CPU -Descending
</span></span></code></pre></div><p>ä¸Šè¿°å‘½ä»¤è·å–è¿›ç¨‹åˆ—è¡¨å¹¶æŒ‰ CPU å ç”¨é™åºæ’åºã€‚</p>
</li>
</ul>
<h3 id="4-å¯¹è±¡å¤„ç†">4. å¯¹è±¡å¤„ç†<a hidden class="anchor" aria-hidden="true" href="#4-å¯¹è±¡å¤„ç†">#</a></h3>
<ul>
<li>
<p>PowerShell è¾“å‡ºçš„æ˜¯ .NET å¯¹è±¡ï¼Œè¿™ä½¿å¾—ä½ å¯ä»¥ç›´æ¥è®¿é—®å±æ€§å’Œæ–¹æ³•ï¼Œè€Œä¸ä»…ä»…æ˜¯æ–‡æœ¬ã€‚ä¾‹å¦‚ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>$process = Get-Process | Where-Object { $_.ProcessName <span style="color:#f92672">-eq</span> <span style="color:#e6db74">&#34;notepad&#34;</span> }
</span></span><span style="display:flex;"><span>$process.Id  <span style="color:#75715e"># è®¿é—®è¿›ç¨‹ID</span>
</span></span></code></pre></div></li>
</ul>
<h3 id="5-è„šæœ¬æ–‡ä»¶">5. è„šæœ¬æ–‡ä»¶<a hidden class="anchor" aria-hidden="true" href="#5-è„šæœ¬æ–‡ä»¶">#</a></h3>
<ul>
<li>
<p><strong>æ‰©å±•å</strong>ï¼šè„šæœ¬æ–‡ä»¶ä»¥ <code>.ps1</code> ç»“å°¾ã€‚</p>
</li>
<li>
<p>æ‰§è¡Œæ–¹å¼ï¼šåœ¨ PowerShell æ§åˆ¶å°ä¸­æ‰§è¡Œè„šæœ¬ï¼Œä¾‹å¦‚ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>.\MyScript.ps1
</span></span></code></pre></div></li>
</ul>
<h2 id="ä¸‰å¸¸ç”¨å‘½ä»¤åŠä½¿ç”¨ç¤ºä¾‹">ä¸‰ã€å¸¸ç”¨å‘½ä»¤åŠä½¿ç”¨ç¤ºä¾‹<a hidden class="anchor" aria-hidden="true" href="#ä¸‰å¸¸ç”¨å‘½ä»¤åŠä½¿ç”¨ç¤ºä¾‹">#</a></h2>
<h3 id="1-å¸®åŠ©ä¸å‘½ä»¤æŸ¥æ‰¾">1. å¸®åŠ©ä¸å‘½ä»¤æŸ¥æ‰¾<a hidden class="anchor" aria-hidden="true" href="#1-å¸®åŠ©ä¸å‘½ä»¤æŸ¥æ‰¾">#</a></h3>
<ul>
<li>
<p>è·å–å¸®åŠ©ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>Get-Help Get-Process -Detailed
</span></span></code></pre></div></li>
<li>
<p>åˆ—å‡ºæ‰€æœ‰å‘½ä»¤ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>Get-Command
</span></span></code></pre></div></li>
<li>
<p>æ›´æ–°å¸®åŠ©æ–‡æ¡£ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>Update-Help
</span></span></code></pre></div></li>
</ul>
<h3 id="2-æ–‡ä»¶ç³»ç»Ÿç®¡ç†">2. æ–‡ä»¶ç³»ç»Ÿç®¡ç†<a hidden class="anchor" aria-hidden="true" href="#2-æ–‡ä»¶ç³»ç»Ÿç®¡ç†">#</a></h3>
<ul>
<li>
<p>åˆ—å‡ºç›®å½•å†…å®¹ï¼ˆç­‰åŒäº <code>ls</code> æˆ– <code>dir</code>ï¼‰ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>Get-ChildItem -Path C:\
</span></span></code></pre></div></li>
<li>
<p>åˆ‡æ¢ç›®å½•ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>Set-Location -Path C:\Users
</span></span></code></pre></div></li>
<li>
<p>å¤åˆ¶æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>Copy-Item -Path .\file.txt -Destination D:\Backup\
</span></span></code></pre></div></li>
<li>
<p>ç§»åŠ¨æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>Move-Item -Path .\file.txt -Destination D:\Archive\
</span></span></code></pre></div></li>
<li>
<p>åˆ é™¤æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>Remove-Item -Path .\oldfile.txt
</span></span></code></pre></div></li>
</ul>
<h3 id="3-è¿›ç¨‹ä¸æœåŠ¡ç®¡ç†">3. è¿›ç¨‹ä¸æœåŠ¡ç®¡ç†<a hidden class="anchor" aria-hidden="true" href="#3-è¿›ç¨‹ä¸æœåŠ¡ç®¡ç†">#</a></h3>
<ul>
<li>
<p>è·å–è¿›ç¨‹ä¿¡æ¯ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>Get-Process
</span></span></code></pre></div></li>
<li>
<p>åœæ­¢æŒ‡å®šè¿›ç¨‹ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>Stop-Process -Name notepad
</span></span></code></pre></div></li>
<li>
<p>æŸ¥çœ‹æœåŠ¡çŠ¶æ€ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>Get-Service
</span></span></code></pre></div></li>
<li>
<p>ç®¡ç†æœåŠ¡ï¼ˆå¯åŠ¨ã€åœæ­¢ã€é‡å¯ï¼‰ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>Start-Service -Name <span style="color:#e6db74">&#34;wuauserv&#34;</span>
</span></span><span style="display:flex;"><span>Stop-Service -Name <span style="color:#e6db74">&#34;wuauserv&#34;</span>
</span></span><span style="display:flex;"><span>Restart-Service -Name <span style="color:#e6db74">&#34;wuauserv&#34;</span>
</span></span></code></pre></div></li>
</ul>
<h3 id="4-ç¯å¢ƒå˜é‡ç®¡ç†">4. ç¯å¢ƒå˜é‡ç®¡ç†<a hidden class="anchor" aria-hidden="true" href="#4-ç¯å¢ƒå˜é‡ç®¡ç†">#</a></h3>
<ul>
<li>
<p>æŸ¥çœ‹ç¯å¢ƒå˜é‡ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>Get-ChildItem Env<span style="color:#960050;background-color:#1e0010">:</span>
</span></span></code></pre></div></li>
<li>
<p>è®¾ç½®ç¯å¢ƒå˜é‡ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>$Env:Path = <span style="color:#e6db74">&#34;</span>$Env:Path<span style="color:#e6db74">;C:\MyFolder&#34;</span>
</span></span></code></pre></div></li>
</ul>
<h3 id="5-è„šæœ¬ä¸å‡½æ•°">5. è„šæœ¬ä¸å‡½æ•°<a hidden class="anchor" aria-hidden="true" href="#5-è„šæœ¬ä¸å‡½æ•°">#</a></h3>
<ul>
<li>
<p>å®šä¹‰å’Œè°ƒç”¨å‡½æ•°ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> Say-Hello {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">param</span>([<span style="color:#66d9ef">string</span>]$Name)
</span></span><span style="display:flex;"><span>    Write-Output <span style="color:#e6db74">&#34;Hello, </span>$Name<span style="color:#e6db74">!&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>Say-Hello -Name <span style="color:#e6db74">&#34;Alice&#34;</span>
</span></span></code></pre></div></li>
<li>
<p>æ¡ä»¶åˆ¤æ–­ä¸å¾ªç¯ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#66d9ef">if</span> ($x <span style="color:#f92672">-gt</span> <span style="color:#ae81ff">10</span>) {
</span></span><span style="display:flex;"><span>    Write-Output <span style="color:#e6db74">&#34;å¤§äº10&#34;</span>
</span></span><span style="display:flex;"><span>} <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>    Write-Output <span style="color:#e6db74">&#34;å°äºç­‰äº10&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> ($i = <span style="color:#ae81ff">1</span>; $i <span style="color:#f92672">-le</span> <span style="color:#ae81ff">5</span>; $i++) {
</span></span><span style="display:flex;"><span>    Write-Output <span style="color:#e6db74">&#34;æ•°å­—ï¼š</span>$i<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div></li>
</ul>
<h3 id="6-ç®¡é“ä¸å¯¹è±¡æ“ä½œ">6. ç®¡é“ä¸å¯¹è±¡æ“ä½œ<a hidden class="anchor" aria-hidden="true" href="#6-ç®¡é“ä¸å¯¹è±¡æ“ä½œ">#</a></h3>
<ul>
<li>
<p>ç­›é€‰ä¸éå†ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>Get-Service | Where-Object { $_.Status <span style="color:#f92672">-eq</span> <span style="color:#e6db74">&#34;Running&#34;</span> } | ForEach-Object { $_.Name }
</span></span></code></pre></div></li>
<li>
<p>æ’åºä¸æ ¼å¼åŒ–ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>Get-Process | Sort-Object -Property CPU -Descending | Format-Table -Property Name, CPU, Id
</span></span></code></pre></div></li>
</ul>
<h3 id="7-è¿œç¨‹ç®¡ç†">7. è¿œç¨‹ç®¡ç†<a hidden class="anchor" aria-hidden="true" href="#7-è¿œç¨‹ç®¡ç†">#</a></h3>
<ul>
<li>
<p>å¯ç”¨è¿œç¨‹åŠŸèƒ½ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>Enable-PSRemoting -Force
</span></span></code></pre></div></li>
<li>
<p>è¿›å…¥è¿œç¨‹ä¼šè¯ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>Enter-PSSession -ComputerName &lt;RemoteComputer&gt;
</span></span></code></pre></div></li>
<li>
<p>æ‰§è¡Œè¿œç¨‹å‘½ä»¤ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>Invoke-Command -ComputerName &lt;RemoteComputer&gt; -ScriptBlock { Get-Process }
</span></span></code></pre></div></li>
</ul>
<h3 id="8-æ¨¡å—ç®¡ç†">8. æ¨¡å—ç®¡ç†<a hidden class="anchor" aria-hidden="true" href="#8-æ¨¡å—ç®¡ç†">#</a></h3>
<ul>
<li>
<p>æŸ¥çœ‹å·²å®‰è£…æ¨¡å—ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>Get-Module -ListAvailable
</span></span></code></pre></div></li>
<li>
<p>å¯¼å…¥æ¨¡å—ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>Import-Module ModuleName
</span></span></code></pre></div></li>
<li>
<p>å®‰è£…æ–°æ¨¡å—</p>
<p>ï¼ˆéœ€å®‰è£… PowerShellGet æ¨¡å—ï¼‰ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>Install-Module ModuleName
</span></span></code></pre></div></li>
</ul>
<h3 id="9-æ‰§è¡Œç­–ç•¥execution-policy">9. æ‰§è¡Œç­–ç•¥ï¼ˆExecution Policyï¼‰<a hidden class="anchor" aria-hidden="true" href="#9-æ‰§è¡Œç­–ç•¥execution-policy">#</a></h3>
<ul>
<li>
<p>æŸ¥çœ‹å½“å‰ç­–ç•¥ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>Get-ExecutionPolicy
</span></span></code></pre></div></li>
<li>
<p>è®¾ç½®æ‰§è¡Œç­–ç•¥</p>
<p>ï¼ˆä¾‹å¦‚ RemoteSignedï¼‰ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>Set-ExecutionPolicy RemoteSigned
</span></span></code></pre></div><blockquote>
<p>æ³¨æ„ï¼šä¿®æ”¹æ‰§è¡Œç­–ç•¥æ—¶è¦ç¡®ä¿äº†è§£å…¶å®‰å…¨å½±å“ï¼Œé˜²æ­¢æ‰§è¡ŒæœªçŸ¥æ¥æºçš„è„šæœ¬ã€‚</p>
</blockquote>
</li>
</ul>
<h3 id="æŸ¥çœ‹-æŸä¸ªæ–‡ä»¶çš„-sha256-å“ˆå¸Œå€¼">â­æŸ¥çœ‹ æŸä¸ªæ–‡ä»¶çš„ sha256 å“ˆå¸Œå€¼<a hidden class="anchor" aria-hidden="true" href="#æŸ¥çœ‹-æŸä¸ªæ–‡ä»¶çš„-sha256-å“ˆå¸Œå€¼">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>Get-FileHash <span style="color:#e6db74">&#34;path&#34;</span> -Algorithm SHA256
</span></span></code></pre></div><p>è·å–å°å†™</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#f92672">(</span>Get-FileHash <span style="color:#e6db74">&#34;C:\path\to\your\file.zip&#34;</span> -Algorithm SHA256<span style="color:#f92672">)</span>.Hash.ToLower<span style="color:#f92672">()</span>
</span></span></code></pre></div><hr>
<h4 id="1-æ›´æ¢å“ˆå¸Œç®—æ³•">1. æ›´æ¢å“ˆå¸Œç®—æ³•<a hidden class="anchor" aria-hidden="true" href="#1-æ›´æ¢å“ˆå¸Œç®—æ³•">#</a></h4>
<p>é™¤äº† SHA256ï¼Œè¿˜å¯ä»¥æŒ‡å®šå…¶ä»–ç®—æ³•ï¼Œä¾‹å¦‚ SHA512ã€MD5ã€SHA1 ç­‰ã€‚ç¤ºä¾‹ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#75715e"># ä½¿ç”¨ SHA512 ç®—æ³•è®¡ç®—æ–‡ä»¶å“ˆå¸Œå€¼</span>
</span></span><span style="display:flex;"><span>Get-FileHash <span style="color:#e6db74">&#34;C:\path\to\your\file.zip&#34;</span> -Algorithm SHA512
</span></span></code></pre></div><hr>
<h5 id="2-å¯¹æ¯”ä¸¤ä¸ªæ–‡ä»¶çš„å“ˆå¸Œå€¼">2. å¯¹æ¯”ä¸¤ä¸ªæ–‡ä»¶çš„å“ˆå¸Œå€¼<a hidden class="anchor" aria-hidden="true" href="#2-å¯¹æ¯”ä¸¤ä¸ªæ–‡ä»¶çš„å“ˆå¸Œå€¼">#</a></h5>
<p>å¯ç”¨äºéªŒè¯ä¸¤ä¸ªæ–‡ä»¶æ˜¯å¦ä¸€è‡´ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>$hash1 = (Get-FileHash <span style="color:#e6db74">&#34;C:\path\to\your\file1.zip&#34;</span> -Algorithm SHA256).Hash.ToLower()
</span></span><span style="display:flex;"><span>$hash2 = (Get-FileHash <span style="color:#e6db74">&#34;C:\path\to\your\file2.zip&#34;</span> -Algorithm SHA256).Hash.ToLower()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> ($hash1 <span style="color:#f92672">-eq</span> $hash2) {
</span></span><span style="display:flex;"><span>    Write-Output <span style="color:#e6db74">&#34;ä¸¤ä¸ªæ–‡ä»¶çš„å“ˆå¸Œå€¼ç›¸åŒï¼Œæ–‡ä»¶å†…å®¹ä¸€è‡´ã€‚&#34;</span>
</span></span><span style="display:flex;"><span>} <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>    Write-Output <span style="color:#e6db74">&#34;ä¸¤ä¸ªæ–‡ä»¶çš„å“ˆå¸Œå€¼ä¸åŒï¼Œæ–‡ä»¶å†…å®¹ä¸ä¸€è‡´ã€‚&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><hr>
<h5 id="3-è®¡ç®—æ–‡ä»¶å¤¹ä¸­æ‰€æœ‰æ–‡ä»¶çš„å“ˆå¸Œå€¼">3. è®¡ç®—æ–‡ä»¶å¤¹ä¸­æ‰€æœ‰æ–‡ä»¶çš„å“ˆå¸Œå€¼<a hidden class="anchor" aria-hidden="true" href="#3-è®¡ç®—æ–‡ä»¶å¤¹ä¸­æ‰€æœ‰æ–‡ä»¶çš„å“ˆå¸Œå€¼">#</a></h5>
<p>ç»“åˆ <strong>Get-ChildItem</strong> å’Œ <strong>ForEach-Object</strong> å¯ä»¥æ‰¹é‡è®¡ç®—æ–‡ä»¶å¤¹ä¸­æ‰€æœ‰æ–‡ä»¶çš„å“ˆå¸Œå€¼ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>Get-ChildItem <span style="color:#e6db74">&#34;C:\path\to\folder&#34;</span> <span style="color:#f92672">-File</span> | ForEach-Object {
</span></span><span style="display:flex;"><span>    $fileHash = (Get-FileHash $_.FullName -Algorithm SHA256).Hash.ToLower()
</span></span><span style="display:flex;"><span>    [<span style="color:#66d9ef">PSCustomObject</span>]@{
</span></span><span style="display:flex;"><span>        FileName = $_.Name
</span></span><span style="display:flex;"><span>        Hash     = $fileHash
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>} | Format-Table -AutoSize
</span></span></code></pre></div><p>è¯¥å‘½ä»¤éå†æŒ‡å®šç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ï¼Œå¹¶è¾“å‡ºæ–‡ä»¶åä¸å¯¹åº”çš„ SHA256 å“ˆå¸Œå€¼ã€‚</p>
<hr>
<h5 id="4-å°†å“ˆå¸Œå€¼è¾“å‡ºåˆ°æ–‡ä»¶">4. å°†å“ˆå¸Œå€¼è¾“å‡ºåˆ°æ–‡ä»¶<a hidden class="anchor" aria-hidden="true" href="#4-å°†å“ˆå¸Œå€¼è¾“å‡ºåˆ°æ–‡ä»¶">#</a></h5>
<p>å¦‚æœéœ€è¦å°†å“ˆå¸Œå€¼ä¿å­˜åˆ°æ–‡ä»¶ä¸­ï¼Œå¯ä½¿ç”¨ <strong>Out-File</strong>ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>(Get-FileHash <span style="color:#e6db74">&#34;C:\path\to\your\file.zip&#34;</span> -Algorithm SHA256).Hash.ToLower() | Out-File <span style="color:#e6db74">&#34;C:\path\to\output\hash.txt&#34;</span>
</span></span></code></pre></div><hr>
<h5 id="5-éªŒè¯æ–‡ä»¶å®Œæ•´æ€§">5. éªŒè¯æ–‡ä»¶å®Œæ•´æ€§<a hidden class="anchor" aria-hidden="true" href="#5-éªŒè¯æ–‡ä»¶å®Œæ•´æ€§">#</a></h5>
<p>å‡è®¾ä½ å·²æœ‰ä¸€ä¸ªå·²çŸ¥çš„é¢„æœŸå“ˆå¸Œå€¼ï¼Œå¯ä»¥å°†è®¡ç®—å¾—åˆ°çš„å“ˆå¸Œå€¼ä¸é¢„æœŸå€¼è¿›è¡Œæ¯”å¯¹ï¼Œåˆ¤æ–­æ–‡ä»¶æ˜¯å¦è¢«ç¯¡æ”¹ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>$expectedHash = <span style="color:#e6db74">&#34;abcdef1234567890abcdef1234567890abcdef1234567890abcdef1234567890&#34;</span>  <span style="color:#75715e"># è¯·æ›¿æ¢ä¸ºå®é™…çš„é¢„æœŸå“ˆå¸Œå€¼</span>
</span></span><span style="display:flex;"><span>$actualHash = (Get-FileHash <span style="color:#e6db74">&#34;C:\path\to\your\file.zip&#34;</span> -Algorithm SHA256).Hash.ToLower()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> ($expectedHash <span style="color:#f92672">-eq</span> $actualHash) {
</span></span><span style="display:flex;"><span>    Write-Output <span style="color:#e6db74">&#34;æ–‡ä»¶å®Œæ•´æ€§éªŒè¯é€šè¿‡ã€‚&#34;</span>
</span></span><span style="display:flex;"><span>} <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>    Write-Output <span style="color:#e6db74">&#34;æ–‡ä»¶å®Œæ•´æ€§éªŒè¯å¤±è´¥ï¼&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><hr>
<h5 id="6-ç»“åˆè„šæœ¬æ‰¹é‡éªŒè¯å¤šä¸ªæ–‡ä»¶">6. ç»“åˆè„šæœ¬æ‰¹é‡éªŒè¯å¤šä¸ªæ–‡ä»¶<a hidden class="anchor" aria-hidden="true" href="#6-ç»“åˆè„šæœ¬æ‰¹é‡éªŒè¯å¤šä¸ªæ–‡ä»¶">#</a></h5>
<p>å¦‚æœä½ éœ€è¦å¯¹å¤šä¸ªæ–‡ä»¶è¿›è¡Œå®Œæ•´æ€§éªŒè¯ï¼Œå¯ä»¥æŠŠæ–‡ä»¶è·¯å¾„å’Œé¢„æœŸå“ˆå¸Œå€¼ä¿å­˜åœ¨ä¸€ä¸ªæ•°æ®ç»“æ„ä¸­ï¼Œç„¶åéå†éªŒè¯ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#75715e"># å®šä¹‰å¾…éªŒè¯çš„æ–‡ä»¶åŠå…¶é¢„æœŸå“ˆå¸Œå€¼åˆ—è¡¨</span>
</span></span><span style="display:flex;"><span>$files = @(
</span></span><span style="display:flex;"><span>    @{ Path = <span style="color:#e6db74">&#34;C:\path\to\file1.zip&#34;</span>; ExpectedHash = <span style="color:#e6db74">&#34;é¢„æœŸå“ˆå¸Œå€¼1&#34;</span> },
</span></span><span style="display:flex;"><span>    @{ Path = <span style="color:#e6db74">&#34;C:\path\to\file2.zip&#34;</span>; ExpectedHash = <span style="color:#e6db74">&#34;é¢„æœŸå“ˆå¸Œå€¼2&#34;</span> }
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">foreach</span> ($file <span style="color:#66d9ef">in</span> $files) {
</span></span><span style="display:flex;"><span>    $actualHash = (Get-FileHash $file.Path -Algorithm SHA256).Hash.ToLower()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> ($actualHash <span style="color:#f92672">-eq</span> $file.ExpectedHash.ToLower()) {
</span></span><span style="display:flex;"><span>        Write-Output <span style="color:#e6db74">&#34;</span>$($file.Path)<span style="color:#e6db74"> éªŒè¯é€šè¿‡ã€‚&#34;</span>
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>        Write-Output <span style="color:#e6db74">&#34;</span>$($file.Path)<span style="color:#e6db74"> éªŒè¯å¤±è´¥ï¼&#34;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="å››è„šæœ¬ç¼–å†™ä¸è°ƒè¯•æŠ€å·§">å››ã€è„šæœ¬ç¼–å†™ä¸è°ƒè¯•æŠ€å·§<a hidden class="anchor" aria-hidden="true" href="#å››è„šæœ¬ç¼–å†™ä¸è°ƒè¯•æŠ€å·§">#</a></h2>
<h3 id="1-è„šæœ¬æ–‡ä»¶">1. è„šæœ¬æ–‡ä»¶<a hidden class="anchor" aria-hidden="true" href="#1-è„šæœ¬æ–‡ä»¶">#</a></h3>
<ul>
<li>
<p><strong>ç¼–å†™ä¸ä¿å­˜</strong>ï¼šå°†å¸¸ç”¨å‘½ä»¤å†™å…¥ <code>.ps1</code> æ–‡ä»¶ä¸­ä¿å­˜ï¼Œä¾¿äºé‡å¤ä½¿ç”¨ã€‚</p>
</li>
<li>
<p>æ‰§è¡Œè„šæœ¬ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>.\MyScript.ps1
</span></span></code></pre></div></li>
</ul>
<h3 id="2-è°ƒè¯•æ–¹æ³•">2. è°ƒè¯•æ–¹æ³•<a hidden class="anchor" aria-hidden="true" href="#2-è°ƒè¯•æ–¹æ³•">#</a></h3>
<ul>
<li>
<p><strong>è¾“å‡ºè°ƒè¯•ä¿¡æ¯</strong>ï¼šä½¿ç”¨ <code>Write-Output</code> æˆ– <code>Write-Host</code> è¾“å‡ºå˜é‡å’ŒçŠ¶æ€ã€‚</p>
</li>
<li>
<p>é€æ­¥è°ƒè¯•ï¼šå¯ä»¥å¯ç”¨é€è¡Œè°ƒè¯•</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>Set-PSDebug -Step
</span></span></code></pre></div></li>
<li>
<p>é”™è¯¯å¤„ç†ï¼šä½¿ç”¨ Try-Catch ç»“æ„æ•è·å’Œå¤„ç†é”™è¯¯ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>    Get-Item <span style="color:#e6db74">&#34;C:\nonexistentfile.txt&#34;</span>
</span></span><span style="display:flex;"><span>} <span style="color:#66d9ef">catch</span> {
</span></span><span style="display:flex;"><span>    Write-Host <span style="color:#e6db74">&#34;é”™è¯¯ä¿¡æ¯ï¼š</span>$_<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div></li>
</ul>
<h2 id="äº”powershell-é«˜çº§ç‰¹æ€§">äº”ã€PowerShell é«˜çº§ç‰¹æ€§<a hidden class="anchor" aria-hidden="true" href="#äº”powershell-é«˜çº§ç‰¹æ€§">#</a></h2>
<h3 id="1-å¯¹è±¡ä¸ç®¡é“çš„ä¼˜åŠ¿">1. å¯¹è±¡ä¸ç®¡é“çš„ä¼˜åŠ¿<a hidden class="anchor" aria-hidden="true" href="#1-å¯¹è±¡ä¸ç®¡é“çš„ä¼˜åŠ¿">#</a></h3>
<ul>
<li><strong>å¯¹è±¡ä¼ é€’</strong>ï¼šä¸åŒäºä¼ ç»Ÿå‘½ä»¤è¡Œå°†æ–‡æœ¬ä¼ é€’ï¼ŒPowerShell ä¼ é€’çš„æ˜¯å¯¹è±¡ï¼Œå…è®¸ä½ ç›´æ¥æ“ä½œå±æ€§å’Œæ–¹æ³•ï¼Œæå¤§åœ°ç®€åŒ–äº†æ•°æ®å¤„ç†æµç¨‹ã€‚</li>
</ul>
<h3 id="2-æ•°æ®æ ¼å¼è½¬æ¢">2. æ•°æ®æ ¼å¼è½¬æ¢<a hidden class="anchor" aria-hidden="true" href="#2-æ•°æ®æ ¼å¼è½¬æ¢">#</a></h3>
<ul>
<li>
<p>è½¬æ¢ä¸º JSON æˆ– XMLï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>Get-Process | ConvertTo-Json
</span></span><span style="display:flex;"><span>Get-Service | ConvertTo-XML
</span></span></code></pre></div></li>
<li>
<p>è¾“å‡ºåˆ°æ–‡ä»¶ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>Get-Process | Out-File -FilePath processes.txt
</span></span></code></pre></div></li>
</ul>
<h3 id="3-è‡ªåŠ¨åŒ–ä»»åŠ¡ä¸è®¡åˆ’ä»»åŠ¡">3. è‡ªåŠ¨åŒ–ä»»åŠ¡ä¸è®¡åˆ’ä»»åŠ¡<a hidden class="anchor" aria-hidden="true" href="#3-è‡ªåŠ¨åŒ–ä»»åŠ¡ä¸è®¡åˆ’ä»»åŠ¡">#</a></h3>
<ul>
<li><strong>å®šæ—¶æ‰§è¡Œè„šæœ¬</strong>ï¼šå¯ç»“åˆ Windows ä»»åŠ¡è®¡åˆ’ç¨‹åºï¼ˆTask Schedulerï¼‰æˆ– PowerShell å†…ç½®çš„ ScheduledJob æ¨¡å—å®ç°è‡ªåŠ¨åŒ–ä»»åŠ¡ã€‚</li>
<li><strong>æ‰¹é‡ç®¡ç†</strong>ï¼šåˆ©ç”¨ <code>Invoke-Command</code> åŒæ—¶ç®¡ç†å¤šå°æœåŠ¡å™¨ï¼Œæé«˜ç³»ç»Ÿç®¡ç†æ•ˆç‡ã€‚</li>
</ul>
<h3 id="4-powershell-remoting">4. PowerShell Remoting<a hidden class="anchor" aria-hidden="true" href="#4-powershell-remoting">#</a></h3>
<ul>
<li><strong>è¿œç¨‹ä¼šè¯</strong>ï¼šå…è®¸ä½ é€šè¿‡ç½‘ç»œè¿œç¨‹ç®¡ç†è®¡ç®—æœºï¼Œæ˜¯ç³»ç»Ÿç®¡ç†å‘˜æ—¥å¸¸ç®¡ç†æœåŠ¡å™¨çš„é‡è¦å·¥å…·ã€‚</li>
</ul>
<h2 id="å…­ç»“åˆoffice">å…­ã€ç»“åˆOffice<a hidden class="anchor" aria-hidden="true" href="#å…­ç»“åˆoffice">#</a></h2>
<p>è·å–å½“å‰æœ€å å†…å­˜çš„åä¸ªè¿›ç¨‹ï¼Œå¹¶åœ¨Excelç”Ÿæˆé¥¼å›¾ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#75715e"># create new excel instance</span>
</span></span><span style="display:flex;"><span> $objExcel = New-Object -comobject Excel.Application
</span></span><span style="display:flex;"><span> $objExcel.Visible = $True
</span></span><span style="display:flex;"><span> $objWorkbook = $objExcel.Workbooks.Add()
</span></span><span style="display:flex;"><span> $objWorksheet = $objWorkbook.Worksheets.Item(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># write information to the excel file</span>
</span></span><span style="display:flex;"><span>$i = <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>$first10 = (ps | sort ws -Descending | select -first <span style="color:#ae81ff">10</span>)
</span></span><span style="display:flex;"><span>$first10 | <span style="color:#66d9ef">foreach</span> -Process {$i++; $objWorksheet.Cells.Item($i,<span style="color:#ae81ff">1</span>) = $_.name; $objWorksheet.Cells.Item($i,<span style="color:#ae81ff">2</span>) = $_.ws}
</span></span><span style="display:flex;"><span>$otherMem = (ps | measure ws -s).Sum - ($first10 | measure ws -s).Sum
</span></span><span style="display:flex;"><span>$objWorksheet.Cells.Item(<span style="color:#ae81ff">11</span>,<span style="color:#ae81ff">1</span>) = <span style="color:#e6db74">&#34;Others&#34;</span>; $objWorksheet.Cells.Item(<span style="color:#ae81ff">11</span>,<span style="color:#ae81ff">2</span>) = $otherMem
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># draw the pie chart</span>
</span></span><span style="display:flex;"><span>$objCharts = $objWorksheet.ChartObjects()
</span></span><span style="display:flex;"><span>$objChart = $objCharts.Add(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">500</span>, <span style="color:#ae81ff">300</span>)
</span></span><span style="display:flex;"><span>$objChart.Chart.SetSourceData($objWorksheet.range(<span style="color:#e6db74">&#34;A1:B11&#34;</span>), <span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>$objChart.Chart.ChartType = <span style="color:#ae81ff">70</span>
</span></span><span style="display:flex;"><span>$objChart.Chart.ApplyDataLabels(<span style="color:#ae81ff">5</span>)
</span></span></code></pre></div><p><strong>å‚è€ƒèµ„æ–™ï¼š</strong></p>
<ul>
<li><a href="https://docs.microsoft.com/zh-cn/powershell/">å¾®è½¯å®˜æ–¹ PowerShell æ–‡æ¡£</a></li>
</ul>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://kennems.github.io/tags/powershell/">PowerShell</a></li>
    </ul>
        
    
    <ul id="categories">
      
        <li><a href="https://kennems.github.io/categories/powershell%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0">PowerShellå­¦ä¹ ç¬”è®°</a> </li>
      
    </ul>
    
    
<nav class="paginav">
  <a class="prev" href="https://kennems.github.io/posts/tech/nvm/">
    <span class="title">Â« ä¸Šä¸€é¡µ</span>
    <br>
    <span>NVMä½¿ç”¨ï¼ˆLinuxï¼‰</span>
  </a>
  <a class="next" href="https://kennems.github.io/posts/tech/protobuf%E4%BD%BF%E7%94%A8/">
    <span class="title">ä¸‹ä¸€é¡µ Â»</span>
    <br>
    <span>ProtoBufä½¿ç”¨</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="https://kennems.github.io/">Kennem&#39;s Blog</a></span> Â· 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu');
    if (menu) {
        
        const scrollPosition = localStorage.getItem("menu-scroll-position");
        if (scrollPosition) {
            menu.scrollLeft = parseInt(scrollPosition, 10);
        }
        
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        const html = document.querySelector("html");
        if (html.dataset.theme === "dark") {
            html.dataset.theme = 'light';
            localStorage.setItem("pref-theme", 'light');
        } else {
            html.dataset.theme = 'dark';
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'å¤åˆ¶';

        function copyingDone() {
            copybutton.innerHTML = 'å·²å¤åˆ¶ï¼';
            setTimeout(() => {
                copybutton.innerHTML = 'å¤åˆ¶';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>

<footer class="footer">
    
    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

    <span id="busuanzi_container">
    ğŸ‘¤ Visitors: <span id="busuanzi_value_site_uv"></span>
    ğŸ‘€ Views: <span id="busuanzi_value_site_pv"></span>
  </span>
</footer>



</body>

</html>
