<!DOCTYPE html>
<html lang="zh" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">

<meta name="msvalidate.01" content="DF5FE493CC759E62BFE073BEA8EFD472" />
<title>ç®—æ³•ç¬”è®°ï¼ˆä¸‰ï¼‰â€”â€”å›¾è®ºï¼ˆPythonå®ç°ï¼‰ | Kennem&#39;s Blog</title>
<meta name="keywords" content="ç®—æ³•ç¬”è®°, Python">
<meta name="description" content="ç®—æ³•ç¬”è®°ï¼ˆä¸‰ï¼‰â€”â€”å›¾è®ºï¼ˆPythonå®ç°ï¼‰">
<meta name="author" content="ShowGuan">
<link rel="canonical" href="https://kennems.github.io/posts/tech/%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0%E4%B8%89%E5%9B%BE%E8%AE%BApython%E5%AE%9E%E7%8E%B0/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.1a7bc7e6d01b82c8ca2b2e53cfcf7e33d2fd9058f6b28245f94da0d91447c6a0.css" integrity="sha256-GnvH5tAbgsjKKy5Tz89&#43;M9L9kFj2soJF&#43;U2g2RRHxqA=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://kennems.github.io/img/sun.png">
<link rel="icon" type="image/png" sizes="16x16" href="https://kennems.github.io/img/sun.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://kennems.github.io/img/sun.png">
<link rel="apple-touch-icon" href="https://kennems.github.io/img/sun.png">
<link rel="mask-icon" href="https://kennems.github.io/img/sun.png">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="zh" href="https://kennems.github.io/posts/tech/%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0%E4%B8%89%E5%9B%BE%E8%AE%BApython%E5%AE%9E%E7%8E%B0/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous">

<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.js" integrity="sha384-VQ8d8WVFw0yHhCk5E8I86oOhv48xLpnDZx5T9GogA/Y84DcCKWXDmSDfn13bzFZY" crossorigin="anonymous"></script>

<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/contrib/auto-render.min.js" integrity="sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR" crossorigin="anonymous"
    onload="renderMathInElement(document.body);"></script>


<script>
document.addEventListener("DOMContentLoaded", function() {
    renderMathInElement(document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "$", right: "$", display: false}
        ]
    });
});
</script>


<link rel="stylesheet" href="https://fonts.cdnfonts.com/css/code-new-roman">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  

<meta property="og:url" content="https://kennems.github.io/posts/tech/%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0%E4%B8%89%E5%9B%BE%E8%AE%BApython%E5%AE%9E%E7%8E%B0/">
  <meta property="og:site_name" content="Kennem&#39;s Blog">
  <meta property="og:title" content="ç®—æ³•ç¬”è®°ï¼ˆä¸‰ï¼‰â€”â€”å›¾è®ºï¼ˆPythonå®ç°ï¼‰">
  <meta property="og:description" content="ç®—æ³•ç¬”è®°ï¼ˆä¸‰ï¼‰â€”â€”å›¾è®ºï¼ˆPythonå®ç°ï¼‰">
  <meta property="og:locale" content="zh">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-04-09T15:37:01+08:00">
    <meta property="article:modified_time" content="2024-04-09T15:37:01+08:00">
    <meta property="article:tag" content="ç®—æ³•ç¬”è®°">
    <meta property="article:tag" content="Python">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ç®—æ³•ç¬”è®°ï¼ˆä¸‰ï¼‰â€”â€”å›¾è®ºï¼ˆPythonå®ç°ï¼‰">
<meta name="twitter:description" content="ç®—æ³•ç¬”è®°ï¼ˆä¸‰ï¼‰â€”â€”å›¾è®ºï¼ˆPythonå®ç°ï¼‰">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "ğŸ“šæ–‡ç« ",
      "item": "https://kennems.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "ğŸ’»æŠ€æœ¯",
      "item": "https://kennems.github.io/posts/tech/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "ç®—æ³•ç¬”è®°ï¼ˆä¸‰ï¼‰â€”â€”å›¾è®ºï¼ˆPythonå®ç°ï¼‰",
      "item": "https://kennems.github.io/posts/tech/%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0%E4%B8%89%E5%9B%BE%E8%AE%BApython%E5%AE%9E%E7%8E%B0/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "ç®—æ³•ç¬”è®°ï¼ˆä¸‰ï¼‰â€”â€”å›¾è®ºï¼ˆPythonå®ç°ï¼‰",
  "name": "ç®—æ³•ç¬”è®°ï¼ˆä¸‰ï¼‰â€”â€”å›¾è®ºï¼ˆPythonå®ç°ï¼‰",
  "description": "ç®—æ³•ç¬”è®°ï¼ˆä¸‰ï¼‰â€”â€”å›¾è®ºï¼ˆPythonå®ç°ï¼‰",
  "keywords": [
    "ç®—æ³•ç¬”è®°", "Python"
  ],
  "articleBody": "ç®—æ³•ç¬”è®°ï¼ˆä¸‰ï¼‰â€”â€”å›¾è®ºï¼ˆPythonå®ç°ï¼‰ å›¾è®º æ ‘çš„å­˜å‚¨ é‚»æ¥çŸ©é˜µ 1 2 3 4 5 6 7 8 9 10 # åˆ›å»ºä¸€ä¸ªäºŒç»´åˆ—è¡¨è¡¨ç¤ºé‚»æ¥çŸ©é˜µ n = 10 # é¡¶ç‚¹æ•°é‡ g = [[0] * n for _ in range(n)] # æ·»åŠ ä¸€æ¡è¾¹a-\u003eb def add_edge(a, b): g[a][b] = 1 # åˆå§‹åŒ– g = [[0] * n for _ in range(n)] é‚»æ¥è¡¨ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 # åˆ›å»ºä¸€ä¸ªåˆ—è¡¨è¡¨ç¤ºé‚»æ¥è¡¨ n = 10 # é¡¶ç‚¹æ•°é‡ h = [-1] * n e = [0] * n ne = [0] * n idx = 0 # æ·»åŠ ä¸€æ¡è¾¹a-\u003eb def add_edge(a, b): global idx e[idx] = b ne[idx] = h[a] h[a] = idx idx += 1 # åˆå§‹åŒ– idx = 0 h = [-1] * n æ ‘å’Œå›¾çš„å­˜å‚¨ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 # é‚»æ¥è¡¨è¡¨ç¤ºçš„å›¾ N = 100010 # æ ¹æ®å…·ä½“éœ€æ±‚è®¾ç½®åˆé€‚çš„æœ€å¤§èŠ‚ç‚¹æ•°é‡ # å¯¹äºæ¯ä¸ªç‚¹kï¼Œå¼€ä¸€ä¸ªå•é“¾è¡¨ï¼Œå­˜å‚¨kæ‰€æœ‰å¯ä»¥èµ°åˆ°çš„ç‚¹ã€‚h[k]å­˜å‚¨è¿™ä¸ªå•é“¾è¡¨çš„å¤´ç»“ç‚¹ h = [-1] * N # å­˜å‚¨è¾¹çš„ç›®æ ‡èŠ‚ç‚¹ e = [0] * N # å­˜å‚¨ä¸‹ä¸€æ¡è¾¹çš„ç´¢å¼• ne = [0] * N # è¾¹çš„ç´¢å¼• idx = 0 # æ·»åŠ ä¸€æ¡è¾¹a-\u003eb def add(a, b): global idx e[idx] = b ne[idx] = h[a] h[a] = idx idx += 1 # åˆå§‹åŒ– idx = 0 for i in range(N): h[i] = -1 æ ‘å’Œå›¾çš„éå† DFS 1 2 3 4 5 6 7 8 def dfs(u): st[u] = True i = h[u] while i!=-1: j = e[i] if not st[j]: dfs(j) i = ne[i] BFS 1 2 3 4 5 6 7 8 9 10 11 12 13 from collections import deque q = deque() st[1] = True q.append(1) while q: t = q.popleft() i = h[t] while i!=-1: j=e[i] if not st[j]: st[j] = True q.append(j) i=ne[i] æ‹“æ‰‘æ’åº 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 from sys import stdin from collections import deque input = lambda:stdin.readline().strip() def topsort(): q = deque() res = [] for i in range(1, n+1): if ind[i]==0: res.append(i) q.append(i) while q: u = q.popleft() for v in g[u]: ind[v] -= 1 if ind[v]==0: q.append(v) res.append(v) return res n = int(input()) ind = [0]*(n+1) g = [[] for _ in range(n+1)] for i in range(1, n+1): a = list(map(int, input().split())) for j in range(len(a)-1): g[i].append(a[j]) ind[a[j]]+=1 res = topsort() print(*res, sep=' ') å¥–é‡‘ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 from sys import stdin from collections import deque def topsort(): res = [] q = deque() ans = 0 for i in range(1, n+1): if ind[i]==0: res.append(i) q.append((i, 100)) ans += 100 while q: u, m = q.popleft() for v in g[u]: ind[v] -= 1 if ind[v]==0: q.append((v, m+1)) res.append(v) ans += m+1 if len(res)==n: print(ans) else: print(\"Poor Xed\") n, m = map(int, input().split()) ind = [0]*(n+1) g = [[] for _ in range(n+1)] for i in range(m): a, b = map(int, input().split()) ind[a] += 1 g[b].append(a) topsort() LCA 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 def lca(x,y): if dep[x] \u003c dep[y]: x,y = y,x d = dep[x]-dep[y] while d: # å¾ªç¯ç›´åˆ°æ·±åº¦å·®ä¸º 0 v = d \u0026 -d # è·å– d çš„æœ€ä½ä½çš„ 1 æ‰€åœ¨çš„ä½ç½® i = v.bit_length() - 1 # è®¡ç®—æœ€ä½ä½çš„ä½ç½®ç´¢å¼• x = fa[i][x] # å°†èŠ‚ç‚¹ x ä¸Šç§»åˆ°å’ŒèŠ‚ç‚¹ y åŒä¸€æ·±åº¦ d -= v # æ›´æ–°æ·±åº¦å·® if x==y: return x for k in range(K-1, -1, -1): if fa[k][x] != fa[k][y]: x = fa[k][x] y = fa[k][y] return fa[0][x] # åˆå§‹åŒ–æ·±åº¦ä»¥åŠçˆ¶èŠ‚ç‚¹ä¿¡æ¯ dep[x]=dep[val]+1 dep[y]=dep[val]+1 fa[0][x] = val fa[0][y] = val for k in range(K-1): fa[k+1][x] = fa[k][fa[k][x]] # è‡ªå·±çš„ç¬¬2^(1+1)çº§çˆ¶äº²å³ä¸º è‡ªå·±çš„ç¬¬2^(1)çº§çˆ¶äº² çš„ç¬¬2^(1)çº§çˆ¶äº² fa[k+1][y] = fa[k][fa[k][y]] ç¥–å­™è¯¢é—® 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 from sys import stdin from collections import deque, defaultdict from math import inf K = 17 N = int(4*10e4) + 10 dep = [inf]*(N) fa = [[0]*N for _ in range(K)] def bfs(): dep[0] = 0; dep[root] = 1 q = deque([root]) while q: u = q.popleft() for v in g[u]: if dep[v] \u003e dep[u] + 1: dep[v] = dep[u] + 1 q.append(v) fa[0][v] = u for k in range(1, K-1): fa[k][v] = fa[k-1][fa[k-1][v]] def lca(x, y): if dep[x] \u003c dep[y]: x, y = y, x d = dep[x] - dep[y] while d: v = d \u0026 -d i = v.bit_length() - 1 x = fa[i][x] d -= v if x==y: return x for k in range(K-1, -1, -1): if fa[k][x] != fa[k][y]: x = fa[k][x] y = fa[k][y] return fa[0][x] n = int(input()) g = defaultdict(list) for i in range(n): a, b = map(int, input().split()) if b==-1: root = a else: g[a].append(b) g[b].append(a) bfs() # print(dep) m = int(input()) for i in range(m): x, y = map(int, input().split()) res = lca(x, y) if res == x and res != y: print(1) elif res == y and res != x: print(2) else: print(0) æœ€çŸ­è·¯ å•å…ƒæœ€çŸ­è·¯\nâ€‹\tæ‰€æœ‰è¾¹æƒä¸ºæ­£ï¼š\nâ€‹\tæœ´ç´ ç‰ˆDijkstra $O(n^2)$,å †ä¼˜åŒ–ç‰ˆçš„Dijkstra $O(mlogn)$, â€‹\tå­˜åœ¨è´Ÿæƒè¾¹\nâ€‹\tBellman-Ford $O(nm)$, SPFA é˜Ÿåˆ—ä¼˜åŒ–çš„Bellman-Ford, ä¸€èˆ¬æƒ…å†µï¼š$O(m)$ æœ€åæƒ…å†µï¼š$O(nm)$ å¤šå…ƒæ±‡æœ€çŸ­è·¯ï¼š\nâ€‹\tFloyed $O(n^3)$ æœ´ç´ Dijkstra Dijkstraä¸èƒ½å¤„ç†è´Ÿæƒè¾¹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 N = int(5e2)+10 INF = 0x3f3f3f3f g = [[INF]*N for _ in range(N)] #g = defaultdict(lambda:defaultdict(lambda:INF)) åŒæ ·çš„æ•ˆæœ dis = [INF]*N st = [False]*N def dijkstra(): dis[1]=0 for i in range(n-1): t=-1 for j in range(1,n+1): if not st[j] and (t==-1 or dis[j]\u003cdis[t]): t=j for j in range(1,n+1): dis[j]=min(dis[j], dis[t] + g[t][j]) st[t]=True if dis[n]==INF: return -1 return dis[n] n, m = map(int, input().split()) for _ in range(m): x, y, z = map(int ,input().split()) g[x][y] = min(g[x][y], z) print(dijkstra()) å †ä¼˜åŒ–ç‰ˆDijkstra 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 from heapq import * import sys input = lambda:sys.stdin.readline().strip() N = 150010 INF = 0x3f3f3f3f e, ne, head, w, dis= [0]*N, [0]*N, [-1]*N, [0]*N, [INF]*N st = [False]*N idx=0 def add(a, b, x): global idx e[idx]=b w[idx]=x ne[idx]=head[a] head[a]=idx idx+=1 def dijkstra(): dis[1]=0 h=[] heappush(h, (0,1)) while h: dist, ver = heappop(h) if st[ver]: continue st[ver]=True i=head[ver] while i!=-1: j=e[i] if not st[j] and dis[j]\u003edist+w[i]: dis[j]=dist+w[i] heappush(h, (dis[j], j)) i=ne[i] if dis[n]==INF: print(-1) else: print(dis[n]) n, m = map(int, input().split()) for _ in range(m): x, y, z = map(int, input().split()) add(x,y,z) dijkstra() å¦ä¸€ç§å†™æ³• 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 from sys import stdin from math import inf from collections import deque, defaultdict from heapq import heappush, heappop input = lambda:stdin.readline().strip() def dijkstra(): h = [(0, 1)] dis[1] = 0 while h: dist, ver = heappop(h) if vis[ver]: continue vis[ver] = True for nx, z in g[ver]: if dis[nx] \u003e dis[ver] + z: dis[nx] = dis[ver] + z heappush(h, (dis[nx], nx)) return dis[n] n, m = map(int, input().split()) dis = [inf]*(n+1) vis = [False]*(n+1) g = defaultdict(list) for i in range(m): x, y, z = map(int, input().split()) g[x].append((y, z)) res = dijkstra() print(res if res != inf else -1) Bellman-Ford 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 # nè¡¨ç¤ºç‚¹æ•°ï¼Œmè¡¨ç¤ºè¾¹æ•° dist = [float('inf')] * (n + 1) # dist[x]å­˜å‚¨1åˆ°xçš„æœ€çŸ­è·¯è·ç¦» # è¾¹ï¼Œaè¡¨ç¤ºå‡ºç‚¹ï¼Œbè¡¨ç¤ºå…¥ç‚¹ï¼Œwè¡¨ç¤ºè¾¹çš„æƒé‡ edges = [] # æ±‚1åˆ°nçš„æœ€çŸ­è·¯è·ç¦»ï¼Œå¦‚æœæ— æ³•ä»1èµ°åˆ°nï¼Œåˆ™è¿”å›-1ã€‚ def bellman_ford(): dist[1] = 0 # å¦‚æœç¬¬næ¬¡è¿­ä»£ä»ç„¶ä¼šæ¾å¼›ä¸‰è§’ä¸ç­‰å¼ï¼Œå°±è¯´æ˜å­˜åœ¨ä¸€æ¡é•¿åº¦æ˜¯n+1çš„æœ€çŸ­è·¯å¾„ï¼Œç”±æŠ½å±‰åŸç†ï¼Œè·¯å¾„ä¸­è‡³å°‘å­˜åœ¨ä¸¤ä¸ªç›¸åŒçš„ç‚¹ï¼Œè¯´æ˜å›¾ä¸­å­˜åœ¨è´Ÿæƒå›è·¯ã€‚ for i in range(n): for j in range(m): a, b, w = edges[j]['a'], edges[j]['b'], edges[j]['w'] if dist[b] \u003e dist[a] + w: dist[b] = dist[a] + w if dist[n] \u003e float('inf') / 2: return -1 return dist[n] SPFA 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 from collections import defaultdict, deque import sys input = lambda:sys.stdin.readline().strip() N, INF = int(1e5+10), 0x3f3f3f3f dis, st = [INF]*N, [False]*N g=defaultdict(list) def spfa(): q=deque() q.append(1) st[1]=True dis[1]=0 while q: x=q.popleft() st[x]=False for y, z in g[x]: if dis[y]\u003edis[x]+z: dis[y]=dis[x]+z if not st[y]: st[y]=True q.append(y) if dis[n]==INF: print('impossible') else: print(dis[n]) n, m = map(int, input().split()) for _ in range(m): x, y, z = map(int, input().split()) g[x].append((y, z)) spfa() åˆ¤æ–­è´Ÿç¯ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 from sys import stdin from collections import deque, defaultdict from math import inf input = lambda:stdin.readline().strip() def spfa(): q = deque() for i in range(1, n+1): q.append(i) st[i] = True while q: x = q.popleft() st[x] = False for y, z in g[x]: if dis[y] \u003e dis[x] + z: dis[y] = dis[x] + z cnt[y] = cnt[x] + 1 if cnt[y] \u003e= n: return True if not st[y]: q.append(y) st[y] = True return False n, m = map(int, input().split()) g = defaultdict(list) cnt = [0]*(n+1) st = [False]*(n+1) dis = [0]*(n+1) for i in range(m): x, y, z = map(int, input().split()) g[x].append((y, z)) res = spfa() print(\"Yes\" if res else \"No\") floyd 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 from sys import stdin from math import inf def floyd(): for k in range(1, n+1): for i in range(1, n+1): for j in range(1, n+1): d[i][j] = min(d[i][j], d[i][k] + d[k][j]) n, m, k = map(int, input().split()) d = [[0 if i==j else inf for i in range(n+1)] for j in range(n+1)] for i in range(m): x, y, z = map(int, input().split()) d[x][y] = min(d[x][y], z) floyd() for i in range(k): x, y = map(int, input().split()) print(d[x][y] if d[x][y]!=inf else \"impossible\") Prim 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 from math import inf from sys import stdin def prim(): res = 0 dis[1] = 0 for i in range(n): t = -1 for j in range(1, n+1): if not st[j] and (t==-1 or dis[t] \u003e dis[j]): t = j if i and dis[t]==inf: return inf if i: res += dis[t] st[t] = True for j in range(1, n+1): dis[j] = min(dis[j], g[t][j]) return res n, m = map(int, input().split()) g = [[inf]*(n+1) for _ in range(n+1)] dis = [inf]*(n+1) st = [False]*(n+1) for i in range(m): u, v, w = map(int, input().split()) g[u][v] = g[v][u] = min(w, g[u][v]) res = prim() if res==inf: print(\"impossible\") else: print(res) Kruskal 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 import sys input = lambda:sys.stdin.readline().strip() def find(x): while p[x] != x: p[x] = p[p[x]] x = p[x] return x def kruskal(): res, cnt = 0, 0 ans = [] for u, v, w in g: fu, fv = find(u), find(v) if fu != fv: res += w cnt += 1 p[fu] = fv ans.append((u, v, w)) ans.sort() if cnt == n-1: print(res) # print(ans) # è®°å½•é€‰æ‹©çš„æ˜¯å“ªäº›è¾¹ else: print(\"impossible\") n, m = map(int, input().split()) g = [] p = [i for i in range(n+1)] for i in range(m): u, v, w = map(int, input().split()) g.append((u, v, w)) g.sort(key = lambda e:e[2]) kruskal() æŸ“è‰²æ³• ä½¿ç”¨äº†æ·±åº¦ä¼˜å…ˆæœç´¢ç®—æ³•ï¼ˆDFSï¼‰æ¥åˆ¤æ–­ä¸€ä¸ªå›¾æ˜¯å¦æ˜¯äºŒåˆ†å›¾\näºŒåˆ†å›¾ï¼šé¡¶ç‚¹åˆ†ä¸ºä¸¤ä¸ªé›†åˆï¼Œè¾¹ä»…å­˜åœ¨äºä¸¤ä¸ªä¸åŒçš„é›†åˆä¸­ï¼Œè€Œé›†åˆå†…éƒ¨éƒ½æ²¡æœ‰è¾¹ã€‚\nPythonä¼˜å…ˆä½¿ç”¨BFSï¼Œå› ä¸ºDFSä¼šå‡ºç°å„ç§é—®é¢˜ï¼Œçˆ†æ ˆï¼Œæ®µé”™è¯¯ï¼ˆè¿˜æ²¡ææ¸…æ¥šåŸå› ï¼‰ç­‰\nè¿™æ®µä»£ç ä½¿ç”¨äº†æŸ“è‰²æ³•æ¥åˆ¤æ–­ä¸€ä¸ªæ— å‘å›¾æ˜¯å¦ä¸ºäºŒåˆ†å›¾ã€‚ä¸‹é¢æˆ‘æ¥è§£é‡Šä¸€ä¸‹ï¼š\né¢˜ç›®å¤§æ„ï¼š ç»™å®šä¸€ä¸ªæ— å‘å›¾ï¼Œåˆ¤æ–­æ˜¯å¦å¯ä»¥å°†å…¶é¡¶ç‚¹é›†åˆåˆ’åˆ†ä¸ºä¸¤ä¸ªä¸ç›¸äº¤çš„å­é›†ï¼Œä½¿å¾—æ¯æ¡è¾¹çš„ä¸¤ä¸ªç«¯ç‚¹åˆ†åˆ«å±äºè¿™ä¸¤ä¸ªå­é›†ã€‚å¦‚æœå¯ä»¥ï¼Œåˆ™è¾“å‡º\"Yes\"ï¼Œå¦åˆ™è¾“å‡º\"No\"ã€‚\nå®ç°æ€è·¯ï¼š\nä½¿ç”¨é‚»æ¥è¡¨ g æ¥è¡¨ç¤ºæ— å‘å›¾ï¼Œå…¶ä¸­ g[u] å­˜å‚¨ä¸é¡¶ç‚¹ u ç›¸è¿çš„æ‰€æœ‰é¡¶ç‚¹ã€‚ å®šä¹‰ä¸€ä¸ªæ•°ç»„ color æ¥æ ‡è®°æ¯ä¸ªé¡¶ç‚¹çš„æŸ“è‰²æƒ…å†µï¼Œåˆå§‹å€¼è®¾ä¸º -1 è¡¨ç¤ºæœªæŸ“è‰²ã€‚ å®šä¹‰ä¸€ä¸ª BFS å‡½æ•° bfs(u, c)ï¼Œå…¶ä¸­ u è¡¨ç¤ºèµ·å§‹é¡¶ç‚¹ï¼Œc è¡¨ç¤ºåˆå§‹é¢œè‰²ã€‚è¯¥å‡½æ•°ä½¿ç”¨ BFS éå†å›¾ï¼Œå¹¶å°†é¡¶ç‚¹æŸ“è‰²ï¼Œä¿è¯ç›¸é‚»é¡¶ç‚¹é¢œè‰²ä¸åŒã€‚ åœ¨ä¸»ä½“éƒ¨åˆ†ï¼Œéå†æ‰€æœ‰é¡¶ç‚¹ï¼Œå¯¹äºæ¯ä¸ªæœªæŸ“è‰²çš„é¡¶ç‚¹ï¼Œè°ƒç”¨ bfs å‡½æ•°è¿›è¡ŒæŸ“è‰²ã€‚å¦‚æœæŸ“è‰²è¿‡ç¨‹ä¸­å‘ç°ç›¸é‚»é¡¶ç‚¹é¢œè‰²ç›¸åŒï¼Œåˆ™è¿”å› â€œNoâ€ï¼Œè¡¨ç¤ºæ— æ³•åˆ’åˆ†ä¸ºäºŒåˆ†å›¾ï¼›å¦åˆ™è¿”å› â€œYesâ€ã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 import sys from collections import deque, defaultdict input = lambda:sys.stdin.readline().strip() N = int(1e5)+10 g = defaultdict(list) color = [-1]*N def bfs(u, c): color[u] = c q = deque() q.append((u, c)) while q: cur, col = q.popleft() for nx in g[cur]: if color[nx]==-1: color[nx] = 1-col q.append((nx, 1-col)) elif color[nx]==col: return False return True n, m = map(int, input().split()) for i in range(m): u, v = map(int, input().split()) # if u==v: #***è‡ªç¯ä¸èƒ½å»æ‰*** # continue if u not in g[v]: g[v].append(u) if v not in g[u]: g[u].append(v) for i in range(1, n+1): if color[i]==-1: if not bfs(i, 0): print(\"No\") exit() print(\"Yes\") åŒˆç‰™åˆ©ç®—æ³• é¢˜ç›®å¤§æ„ï¼š ç»™å®šä¸€ä¸ªäºŒåˆ†å›¾ï¼Œå…¶ä¸­å·¦ä¾§é¡¶ç‚¹é›†åˆä¸º (N_1)ï¼Œå³ä¾§é¡¶ç‚¹é›†åˆä¸º (N_2)ï¼Œå›¾ä¸­å­˜åœ¨ä¸€äº›è¾¹ã€‚éœ€è¦æ‰¾åˆ°å°½å¯èƒ½å¤šçš„åŒ¹é…ï¼Œä½¿å¾—å·¦ä¾§çš„æ¯ä¸ªé¡¶ç‚¹æœ€å¤šä¸ä¸€ä¸ªå³ä¾§çš„é¡¶ç‚¹ç›¸è¿ï¼Œè€Œå³ä¾§çš„æ¯ä¸ªé¡¶ç‚¹æœ€å¤šä¸ä¸€ä¸ªå·¦ä¾§çš„é¡¶ç‚¹ç›¸è¿ã€‚\nå®ç°æ€è·¯ï¼š\nä½¿ç”¨ä¸€ä¸ªäºŒç»´æ•°ç»„ g å­˜å‚¨å›¾çš„é‚»æ¥è¡¨è¡¨ç¤ºã€‚å…¶ä¸­ g[u] è¡¨ç¤ºä¸å·¦ä¾§é¡¶ç‚¹ u ç›¸è¿çš„æ‰€æœ‰å³ä¾§é¡¶ç‚¹çš„é›†åˆã€‚ å®šä¹‰ä¸€ä¸ªå‡½æ•° find(x)ï¼Œç”¨äºä»å·¦ä¾§é¡¶ç‚¹ x å¼€å§‹å°è¯•å¯»æ‰¾å¢å¹¿è·¯å¾„ï¼Œå¦‚æœæ‰¾åˆ°äº†å¢å¹¿è·¯å¾„å°±è¿”å› Trueï¼Œå¦åˆ™è¿”å› Falseã€‚ åœ¨ä¸»ä½“éƒ¨åˆ†ï¼Œéå†å·¦ä¾§çš„æ¯ä¸ªé¡¶ç‚¹ï¼Œå¯¹æ¯ä¸ªé¡¶ç‚¹è°ƒç”¨ find å‡½æ•°è¿›è¡ŒåŒ¹é…ï¼Œè‹¥æˆåŠŸåŒ¹é…ï¼Œåˆ™åŒ¹é…æ•°åŠ ä¸€ã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 from sys import stdin from collections import defaultdict def find(u): for v in g[u]: if not st[v]: st[v] = True if mat[v]==0 or find(mat[v]): mat[v] = u return True return False n1, n2, m = map(int, input().split()) mat = [0]*(n2 + 1) g = defaultdict(list) for i in range(m): u, v = map(int, input().split()) g[u].append(v) res = 0 for i in range(1, n1+1): st = [False]*(n2 + 1) if find(i): res += 1 print(res) DFSä¹‹è¿é€šæ€§ é¢˜æ„ï¼šåœ¨ä¸€ä¸ªç»™å®šè¿·å®«ä¸­ï¼Œä»èµ·ç‚¹Aåˆ°ç»ˆç‚¹Bæ˜¯å¦å­˜åœ¨ä¸€æ¡è·¯å¾„çš„é—®é¢˜ã€‚è¿·å®«ç”±ä¸€ä¸ªç”± '.' å’Œ '#' æ„æˆçš„çŸ©é˜µè¡¨ç¤ºï¼Œå…¶ä¸­ '.' è¡¨ç¤ºå¯é€šè¡Œçš„æ ¼ç‚¹ï¼Œ'#' è¡¨ç¤ºä¸å¯é€šè¡Œçš„æ ¼ç‚¹ã€‚Extenseåªèƒ½å‘ä¸œå—è¥¿åŒ—å››ä¸ªæ–¹å‘ç§»åŠ¨åˆ°ç›¸é‚»çš„å¯é€šè¡Œæ ¼ç‚¹ä¸Šï¼Œè€Œä¸”è¦æ±‚èµ·ç‚¹å’Œç»ˆç‚¹éƒ½æ˜¯å¯é€šè¡Œçš„ã€‚ä½ éœ€è¦ç¼–å†™ä¸€ä¸ªç¨‹åºæ¥ç¡®å®šåœ¨ç»™å®šçš„è¿·å®«ä¸­ï¼Œæ˜¯å¦å­˜åœ¨ä¸€æ¡ä»Aåˆ°Bçš„è·¯å¾„ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 import sys input = lambda:sys.stdin.readline().strip() sys.setrecursionlimit(150000) dir = [(-1, 0), (0, 1), (1, 0), (0, -1)] def dfs(x, y): if g[x][y]=='#' or vis[x][y]: return False if (x, y)==end: return True vis[x][y] = True for i in range(4): a, b = x + dir[i][0], y+dir[i][1] if 0\u003c=a\u003cn and 0\u003c=b\u003cn: if dfs(a, b): return True return False k = int(input()) N = 110 g = [[] for _ in range(N)] for _ in range(k): n = int(input()) vis = [[False]*(n+1) for _ in range(n+1)] for i in range(n): g[i] = list(input()) x1, y1, x2, y2 = map(int, input().split()) end = (x2, y2) if dfs(x1, y1): print(\"YES\") else: print(\"NO\") é­”æ¿ é¢˜ç›®å¤§æ„ï¼šç»™å®šä¸€ä¸ª 8 ä¸ªæ ¼å­çš„é­”æ¿ï¼Œæ¯ä¸ªæ ¼å­æœ‰ä¸€ç§é¢œè‰²ï¼Œç”¨ 1 åˆ° 8 çš„æ•´æ•°è¡¨ç¤ºã€‚æœ‰ä¸‰ç§åŸºæœ¬æ“ä½œå¯ä»¥æ”¹å˜é­”æ¿çš„çŠ¶æ€ï¼šAï¼šäº¤æ¢ä¸Šä¸‹ä¸¤è¡Œï¼›Bï¼šå°†æœ€å³è¾¹çš„ä¸€åˆ—æ’å…¥åˆ°æœ€å·¦è¾¹ï¼›Cï¼šé­”æ¿ä¸­å¤®å¯¹çš„4ä¸ªæ•°ä½œé¡ºæ—¶é’ˆæ—‹è½¬ã€‚ç°åœ¨ç»™å®šä¸€ä¸ªç›®æ ‡çŠ¶æ€ï¼Œæ±‚ç”¨æœ€å°‘çš„åŸºæœ¬æ“ä½œå®ŒæˆåŸºæœ¬çŠ¶æ€åˆ°ç›®æ ‡çŠ¶æ€çš„è½¬æ¢ï¼Œå¹¶è¾“å‡ºåŸºæœ¬æ“ä½œåºåˆ—ã€‚\nå®ç°æ€è·¯ï¼š\né¦–å…ˆå®ç°ä¸‰ç§åŸºæœ¬æ“ä½œ Aã€Bã€C çš„å‡½æ•°ã€‚ ä½¿ç”¨å¹¿åº¦ä¼˜å…ˆæœç´¢ï¼ˆBFSï¼‰ç®—æ³•æ¥æ‰¾åˆ°ä»åŸºæœ¬çŠ¶æ€åˆ°ç›®æ ‡çŠ¶æ€çš„æœ€çŸ­æ“ä½œåºåˆ—ã€‚ ä½¿ç”¨ä¸€ä¸ªé˜Ÿåˆ—å­˜å‚¨å¾…å¤„ç†çŠ¶æ€ï¼Œå¹¶ä½¿ç”¨ä¸€ä¸ªå­—å…¸è®°å½•æ¯ä¸ªçŠ¶æ€çš„å‰é©±çŠ¶æ€å’Œæ‰§è¡Œçš„æ“ä½œã€‚ åœ¨æ¯ä¸€æ­¥ä¸­ï¼Œå°è¯•å¯¹å½“å‰çŠ¶æ€è¿›è¡Œä¸‰ç§åŸºæœ¬æ“ä½œï¼Œå¾—åˆ°æ–°çš„çŠ¶æ€ï¼Œå¦‚æœæ–°çŠ¶æ€æœªè¢«è®¿é—®è¿‡ï¼Œåˆ™å°†å…¶åŠ å…¥é˜Ÿåˆ—ï¼Œå¹¶è®°å½•å…¶å‰é©±çŠ¶æ€å’Œæ“ä½œã€‚ å½“æ‰¾åˆ°ç›®æ ‡çŠ¶æ€æ—¶ï¼Œæ ¹æ®å‰é©±çŠ¶æ€å›æº¯å¾—åˆ°æœ€çŸ­æ“ä½œåºåˆ—ã€‚ è¾“å‡ºæœ€çŸ­æ“ä½œåºåˆ—çš„é•¿åº¦å’Œå…·ä½“æ“ä½œåºåˆ—ã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 from collections import deque def A(t): return t[::-1] def B(t): return t[3] + t[:3] + t[5:] + t[4] def C(t): return t[0] + t[6] + t[1] + t[3] + t[4] + t[2] + t[5] + t[7] pre = dict() def bfs(): q = deque() q.append(st) while q: t = q.popleft() if t==ed: break m = [A(t), B(t), C(t)] for i in range(3): if m[i] not in pre: pre[m[i]] = (chr(65+i), t) q.append(m[i]) nums = input().split() ed = ''.join(nums) st = \"12345678\" bfs() cnt = 0 res = \"\" while ed != st: cnt+=1 res = pre[ed][0] + res ed = pre[ed][1] print(cnt) if cnt: print(res) å•è¯æ¥é¾™ é¢˜ç›®å¤§æ„ï¼šç»™å®šä¸€ç»„å•è¯å’Œä¸€ä¸ªå¼€å¤´çš„å­—æ¯ï¼Œè¦æ±‚æ‰¾å‡ºä»¥è¿™ä¸ªå­—æ¯å¼€å¤´çš„æœ€é•¿çš„â€œé¾™â€ï¼Œæ¯ä¸ªå•è¯æœ€å¤šè¢«ä½¿ç”¨ä¸¤æ¬¡ã€‚åœ¨æ„æˆé¾™æ—¶ï¼Œä¸¤ä¸ªå•è¯ç›¸è¿æ—¶ï¼Œå®ƒä»¬çš„é‡åˆéƒ¨åˆ†åˆå¹¶ä¸ºä¸€éƒ¨åˆ†ï¼Œä½†é‡åˆéƒ¨åˆ†çš„é•¿åº¦å¿…é¡»å¤§äºç­‰äº1ä¸”å°äºä¸¤ä¸ªå•è¯çš„é•¿åº¦ã€‚\nå®ç°æ€è·¯ï¼š\né¦–å…ˆè¯»å…¥è¾“å…¥æ•°æ®ï¼ŒåŒ…æ‹¬å•è¯æ•° nã€n ä¸ªå•è¯ä»¥åŠå¼€å¤´çš„å­—æ¯ã€‚ æ„å»ºä¸€ä¸ªå­—å…¸ gï¼Œç”¨äºå­˜å‚¨æ¯ä¸ªå•è¯å¯¹åº”çš„å¯è¿æ¥çš„å•è¯ä»¥åŠå¯¹åº”çš„é‡åˆéƒ¨åˆ†çš„é•¿åº¦ã€‚ å¯¹äºæ¯ä¸€å¯¹å•è¯ï¼Œæ¯”è¾ƒå®ƒä»¬çš„é‡åˆéƒ¨åˆ†ï¼Œå¦‚æœç¬¦åˆæ¡ä»¶ï¼Œåˆ™å°†å…¶åŠ å…¥å­—å…¸ g ä¸­ã€‚ ä½¿ç”¨æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰æ¥æœç´¢ä»¥å¼€å¤´å­—æ¯å¼€å¤´çš„æœ€é•¿çš„â€œé¾™â€ã€‚ åœ¨æœç´¢è¿‡ç¨‹ä¸­ï¼Œä½¿ç”¨ä¸€ä¸ªå­—å…¸ cnt æ¥è®°å½•æ¯ä¸ªå•è¯çš„ä½¿ç”¨æ¬¡æ•°ï¼Œæ¯ä¸ªå•è¯æœ€å¤šåªèƒ½è¢«ä½¿ç”¨ä¸¤æ¬¡ã€‚ é€’å½’æœç´¢æ¯ä¸ªå¯è¿æ¥çš„å•è¯ï¼Œå¹¶æ›´æ–°æœ€é•¿â€œé¾™â€çš„é•¿åº¦ã€‚ æœ€ç»ˆè¾“å‡ºæœ€é•¿â€œé¾™â€çš„é•¿åº¦ã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 from collections import defaultdict n = int(input()) wds = [] for i in range(n): wds.append(input()) st = input() g = {w:[] for w in wds} for i in range(n): for j in range(n): for k in range(1, min( len(wds[i]), len(wds[j]) )): if wds[i][-k:] == wds[j][:k]: g[wds[i]].append((wds[j], k)) cnt = defaultdict(int) def dfs(dra, x): global ans cnt[x] += 1 ans = max(ans, len(dra)) for nx, k in g[x]: if cnt[nx] \u003c 2: dfs(dra + nx[k:], nx) cnt[x] -= 1 ans = 0 for w in wds: if w[0] == st: dfs(w, w) print(ans) åˆ†æˆäº’è´¨ç»„ é¢˜ç›®å¤§æ„ï¼šç»™å®š n ä¸ªæ­£æ•´æ•°ï¼Œè¦æ±‚å°†å®ƒä»¬åˆ†ç»„ï¼Œä½¿å¾—æ¯ç»„ä¸­ä»»æ„ä¸¤ä¸ªæ•°äº’è´¨ã€‚æ±‚æœ€å°‘éœ€è¦åˆ†æˆå¤šå°‘ä¸ªç»„ã€‚\nå®ç°æ€è·¯ï¼š\né¦–å…ˆè¯»å…¥è¾“å…¥æ•°æ®ï¼ŒåŒ…æ‹¬æ­£æ•´æ•°çš„ä¸ªæ•° n å’Œ n ä¸ªæ­£æ•´æ•°ã€‚ ä½¿ç”¨æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰æ¥æœç´¢åˆ†ç»„çš„æ–¹æ³•ã€‚ æ„å»ºä¸€ä¸ªåˆ—è¡¨ gï¼Œç”¨äºå­˜å‚¨åˆ†ç»„æƒ…å†µï¼Œæ¯ä¸ªåˆ†ç»„æ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼Œåˆ—è¡¨ä¸­å­˜å‚¨åˆ†ç»„ä¸­çš„æ•°ã€‚ ç¼–å†™ DFS å‡½æ•°ï¼Œåœ¨å‡½æ•°ä¸­é€’å½’å°è¯•å°†å½“å‰æ•°æ”¾å…¥å·²æœ‰çš„åˆ†ç»„æˆ–æ–°å»ºä¸€ä¸ªåˆ†ç»„ã€‚ åœ¨é€’å½’è¿‡ç¨‹ä¸­ï¼Œå¦‚æœå½“å‰æ•°å¯ä»¥å’ŒæŸä¸ªåˆ†ç»„ä¸­çš„æ‰€æœ‰æ•°äº’è´¨ï¼Œåˆ™å°†å½“å‰æ•°åŠ å…¥è¯¥åˆ†ç»„ï¼Œå¹¶ç»§ç»­é€’å½’ã€‚ å¦‚æœå½“å‰æ•°æ— æ³•åŠ å…¥ä»»ä½•åˆ†ç»„ï¼Œåˆ™æ–°å»ºä¸€ä¸ªåˆ†ç»„ï¼Œå¹¶ç»§ç»­é€’å½’ã€‚ å½“æ‰€æœ‰æ•°éƒ½è¢«åˆ†ç»„å®Œæ¯•æ—¶ï¼Œæ›´æ–°æœ€å°‘éœ€è¦çš„ç»„æ•°ã€‚ æœ€ç»ˆè¾“å‡ºæœ€å°‘éœ€è¦çš„ç»„æ•°ã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 from math import gcd n = int(input()) a = list(map(int, input().split())) g = [] def dfs(u, i): global ans if i==n: ans = min(ans, u) return if u\u003e=ans: return for j in range(u): cnt = sum(1 for k in g[j] if gcd(a[i], k)==1) if cnt==len(g[j]): g[j].append(a[i]) dfs(u, i+1) g[j].pop() g.append([a[i]]) dfs(u+1, i+1) g.pop() ans = n dfs(0, 0) print(ans) è¿­ä»£åŠ æ·± åŠ æˆåºåˆ— é¢˜ç›®å¤§æ„ï¼šç»™å®šä¸€ä¸ªæ•´æ•° nï¼Œæ‰¾å‡ºæ»¡è¶³ä»¥ä¸‹æ¡ä»¶çš„æœ€å°é•¿åº¦çš„â€œåŠ æˆåºåˆ—â€ï¼šåºåˆ—çš„ç¬¬ä¸€ä¸ªå…ƒç´ ä¸º1ï¼Œæœ€åä¸€ä¸ªå…ƒç´ ä¸º nï¼Œåºåˆ—ä¸­çš„å…ƒç´ æ»¡è¶³æ¯ä¸ªå…ƒç´ éƒ½å¯ä»¥è¡¨ç¤ºä¸ºåºåˆ—ä¸­å…¶ä»–ä¸¤ä¸ªå…ƒç´ çš„å’Œã€‚\nå®ç°æ€è·¯ï¼š\nå®šä¹‰ä¸€ä¸ªæ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰å‡½æ•° dfsï¼Œç”¨äºæœç´¢ç¬¦åˆæ¡ä»¶çš„åŠ æˆåºåˆ—ã€‚ åœ¨ dfs å‡½æ•°ä¸­ï¼Œä½¿ç”¨ä¸€ä¸ªåˆ—è¡¨ path æ¥è®°å½•å½“å‰æœç´¢çš„åŠ æˆåºåˆ—ï¼Œåˆå§‹åŒ– path[0] = 1ã€‚ é€’å½’åœ°æœç´¢åŠ æˆåºåˆ—çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œä½¿å¾—æ–°çš„å…ƒç´ æ˜¯å‰é¢å…ƒç´ çš„ä¸¤ä¸¤ç›¸åŠ çš„ç»“æœï¼Œå¹¶æ»¡è¶³æ¡ä»¶ path[u] \u003c= nï¼Œå…¶ä¸­ u è¡¨ç¤ºå½“å‰æœç´¢çš„ä½ç½®ã€‚ å¦‚æœæœç´¢æˆåŠŸï¼Œå³æ‰¾åˆ°äº†ç¬¦åˆæ¡ä»¶çš„åŠ æˆåºåˆ—ï¼Œè¿”å› Trueï¼›å¦åˆ™è¿”å› Falseã€‚ åœ¨ä¸»ç¨‹åºä¸­ï¼Œä¸æ–­è¯»å–è¾“å…¥çš„ nï¼Œå¹¶é€šè¿‡è°ƒç”¨ dfs å‡½æ•°æ¥æœç´¢ç¬¦åˆæ¡ä»¶çš„åŠ æˆåºåˆ—ã€‚ è¾“å‡ºæ»¡è¶³æ¡ä»¶çš„åŠ æˆåºåˆ—ã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 def dfs(u): if u==dep: return path[u-1]==n vis = [False]*(n+1) for i in range(u-1, -1, -1): for j in range(i, -1, -1): s = path[i] + path[j] if s\u003en or s\u003c=path[u-1] or vis[s]: continue vis[s] = True path[u] = s if dfs(u+1): return True return False path = [0]*(110) path[0] = 1 while True: n = int(input()) if not n: break dep = 1 while not dfs(1): dep += 1 print(*path[:dep]) åŒå‘DFS é€ç¤¼ç‰© é¢˜ç›®å¤§æ„ï¼šè¾¾è¾¾å¸®ç¿°ç¿°é€ç¤¼ç‰©ï¼Œä»–ä¸€æ¬¡å¯ä»¥æ¬åŠ¨çš„é‡é‡ä¹‹å’Œä¸è¶…è¿‡ Wï¼Œä¸€å…±æœ‰ N ä¸ªç¤¼ç‰©ï¼Œå…¶ä¸­ç¬¬ i ä¸ªç¤¼ç‰©çš„é‡é‡æ˜¯ G[i]ã€‚æ±‚è¾¾è¾¾åœ¨ä»–çš„åŠ›æ°”èŒƒå›´å†…ä¸€æ¬¡æ€§èƒ½æ¬åŠ¨çš„æœ€å¤§é‡é‡ã€‚\nå®ç°æ€è·¯ï¼š\nå®šä¹‰ä¸¤ä¸ªæ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰å‡½æ•° dfs1 å’Œ dfs2ï¼Œç”¨äºæ±‚è§£è¾¾è¾¾ä¸€æ¬¡æ€§èƒ½æ¬åŠ¨çš„æœ€å¤§é‡é‡ã€‚ dfs1 å‡½æ•°ç”¨äºéå†å‰ä¸€åŠçš„ç¤¼ç‰©ï¼Œæ±‚å¾—æ‰€æœ‰å¯èƒ½çš„æ¬åŠ¨é‡é‡ä¹‹å’Œï¼Œå¹¶å­˜å‚¨åœ¨é›†åˆ wgh ä¸­ã€‚ dfs2 å‡½æ•°ç”¨äºéå†åä¸€åŠçš„ç¤¼ç‰©ï¼Œå¹¶é€šè¿‡äºŒåˆ†æŸ¥æ‰¾åœ¨ wgh ä¸­æ‰¾åˆ°åˆé€‚çš„æ¬åŠ¨é‡é‡ï¼Œæ±‚å¾—æœ€å¤§é‡é‡ã€‚ åœ¨ä¸»ç¨‹åºä¸­ï¼Œé¦–å…ˆè¯»å…¥è¾“å…¥çš„ W å’Œ Nï¼Œç„¶åè¯»å…¥ N ä¸ªç¤¼ç‰©çš„é‡é‡ï¼Œå¹¶æŒ‰ç…§é‡é‡ä»å¤§åˆ°å°æ’åºã€‚ è°ƒç”¨ dfs1 å’Œ dfs2 å‡½æ•°æ±‚è§£æœ€å¤§é‡é‡ï¼Œå¹¶è¾“å‡ºç»“æœã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 def dfs1(u, tot): if u\u003ek: wgh.add(tot) return if tot + a[u] \u003c= w: dfs1(u+1, tot + a[u]) dfs1(u+1, tot) def dfs2(u, tot): global ans if u\u003e=n: l, r = 0, cnt-1 while l\u003cr: mid = (l+r+1)\u003e\u003e1 if wgh[mid] + tot \u003c= w: l = mid else: r = mid - 1 ans = max(ans, wgh[r] + tot) return if a[u] + tot \u003c= w: dfs2(u+1, a[u] + tot) dfs2(u+1, tot) w, n = map(int, input().split()) a = [] for i in range(n): a.append(int(input())) a.sort(reverse = True) wgh = set() k = n//2 dfs1(0, 0) wgh = sorted(list(wgh)) cnt = len(wgh) ans = -1 dfs2(k+1, 0) print(ans) 37. è§£æ•°ç‹¬ \\166. æ•°ç‹¬ é¢˜ç›®å¤§æ„ï¼šæ•°ç‹¬æ˜¯ä¸€ç§ç›Šæ™ºæ¸¸æˆï¼Œè¦æ±‚å¡«å†™ä¸€ä¸ª9Ã—9çš„ç½‘æ ¼ï¼Œä½¿å¾—æ¯è¡Œã€æ¯åˆ—ã€æ¯ä¸ª3Ã—3çš„ä¹å®«æ ¼å†…æ•°å­—1âˆ¼9å‡æ°å¥½å‡ºç°ä¸€æ¬¡ã€‚\nå®ç°æ€è·¯ï¼šè¯¥å®ç°é‡‡ç”¨æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰çš„æ–¹æ³•è§£å†³æ•°ç‹¬é—®é¢˜ã€‚é¦–å…ˆï¼Œé€šè¿‡å°†æ¯ä¸ªæ•°å­—æ˜ å°„åˆ°äºŒè¿›åˆ¶ä½æ¥è¿›è¡Œä½è¿ç®—ï¼Œä»¥ä¾¿å¿«é€Ÿè·å–å·²å¡«å……æ•°å­—çš„çŠ¶æ€ã€‚ç„¶åï¼Œåˆ©ç”¨DFSé€’å½’å¡«å……æ•°ç‹¬ä¸­çš„ç©ºç™½æ ¼å­ï¼Œä¼˜å…ˆé€‰æ‹©å½“å‰ç©ºç™½æ ¼å­å¡«å……æ•°å­—çš„é€‰æ‹©ç©ºé—´è¾ƒå°çš„ä½ç½®ã€‚é€’å½’çš„ç»ˆæ­¢æ¡ä»¶æ˜¯æ‰€æœ‰ç©ºç™½æ ¼å­éƒ½å¡«å……å®Œæ¯•ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 import sys N = 9 M = 1 \u003c\u003c N row, col, cell = [0] * N, [0] * N, [[0] * 3 for _ in range(3)] mp = dict() ones = [0] * M for i in range(N): mp[1 \u003c\u003c i] = i for i in range(1 \u003c\u003c N): for j in range(N): ones[i] += (i \u003e\u003e j) \u0026 1 def lowbit(x): return x \u0026 -x def get(x, y): return row[x] \u0026 col[y] \u0026 cell[x // 3][y // 3] def draw(x, y, t, flag): global st, row, col, cell if flag: st[x * N + y] = chr(49 + t) else: st[x * N + y] = \".\" v = 1 \u003c\u003c t if not flag: v = -v row[x] -= v col[y] -= v cell[x // 3][y // 3] -= v def dfs(cnt): global st if not cnt: return True minv = 10 for i in range(N): for j in range(N): if st[i * N + j] == \".\": state = get(i, j) if ones[state] \u003c minv: minv = ones[state] x, y = i, j i = get(x, y) while i: t = mp[lowbit(i)] draw(x, y, t, True) if dfs(cnt - 1): return True draw(x, y, t, False) i -= lowbit(i) return False while True: st = sys.stdin.readline().strip() if st == \"end\": break st = list(st) cnt = 0 for i in range(N): row[i] = col[i] = M - 1 for i in range(3): for j in range(3): cell[i][j] = M - 1 for i in range(N): for j in range(N): if st[i * N + j] != \".\": t = int(st[i * N + j]) - 1 draw(i, j, t, True) else: cnt += 1 dfs(cnt) print(\"\".join(st)) æœ€çŸ­è·¯ 188. æ­¦å£«é£åº¦çš„ç‰› é¢˜ç›®å¤§æ„ï¼šå†œæ°‘ John æƒ³äº¤æ˜“ä»–çš„ä¸€å¤´è¢« Don ç§°ä¸º The Knight çš„ç‰›ã€‚è¿™å¤´ç‰›æœ‰ç‰¹æ®Šèƒ½åŠ›ï¼Œå¯ä»¥æŒ‰ç…§è±¡æ£‹ä¸­é©¬çš„èµ°æ³•è·³è·ƒã€‚å†œåœºè¢«è¡¨ç¤ºä¸ºä¸€ä¸ªäºŒç»´åæ ‡å›¾ï¼Œå…¶ä¸­åŒ…å«äº†æ ‘ã€çŒæœ¨ã€çŸ³å¤´ä»¥åŠè‰çš„ä½ç½®ã€‚The Knight èµ·å§‹ä½ç½®ä¸º Kï¼Œè‰çš„ä½ç½®ä¸º Hã€‚ä»»åŠ¡æ˜¯ç¡®å®š The Knight è¦è·³å¤šå°‘æ¬¡æ‰èƒ½åˆ°è¾¾è‰çš„ä½ç½®ã€‚\nå®ç°æ€è·¯ï¼š\né¦–å…ˆè§£æè¾“å…¥ï¼Œå¾—åˆ°å†œåœºçš„åˆ—æ•°å’Œè¡Œæ•°ï¼Œä»¥åŠåœ°å›¾ä¿¡æ¯ï¼ŒåŒ…æ‹¬éšœç¢ç‰©å’Œç›®æ ‡ä½ç½®ï¼ˆè‰çš„ä½ç½®ï¼‰ã€‚ ä½¿ç”¨å¹¿åº¦ä¼˜å…ˆæœç´¢ï¼ˆBFSï¼‰ç®—æ³•æ¥æ‰¾åˆ°ä»èµ·å§‹ä½ç½®åˆ°è¾¾ç›®æ ‡ä½ç½®çš„æœ€çŸ­è·¯å¾„ã€‚ åˆå§‹åŒ–ä¸€ä¸ªé˜Ÿåˆ—ï¼Œå¹¶å°†èµ·å§‹ä½ç½®åŠ å…¥é˜Ÿåˆ—ä¸­ã€‚ åœ¨å¾ªç¯ä¸­ï¼Œæ¯æ¬¡ä»é˜Ÿåˆ—ä¸­å–å‡ºä¸€ä¸ªä½ç½®ï¼Œå¹¶å°è¯•å‘å…«ä¸ªæ–¹å‘è·³è·ƒï¼ˆè±¡æ£‹ä¸­é©¬çš„æ‰€æœ‰å¯èƒ½èµ°æ³•ï¼‰ï¼Œå¦‚æœè·³è·ƒåçš„ä½ç½®åˆæ³•ä¸”æ²¡æœ‰éšœç¢ç‰©ä¸”æœªè¢«è®¿é—®è¿‡ï¼Œåˆ™å°†è¯¥ä½ç½®åŠ å…¥é˜Ÿåˆ—ï¼Œå¹¶æ ‡è®°ä¸ºå·²è®¿é—®ã€‚ å½“å–å‡ºçš„ä½ç½®ä¸ºç›®æ ‡ä½ç½®æ—¶ï¼Œè¾“å‡ºè·³è·ƒçš„æ¬¡æ•°ï¼Œå³æœ€çŸ­è·¯å¾„çš„é•¿åº¦ï¼Œç„¶åé€€å‡ºå¾ªç¯ã€‚ å¦‚æœé˜Ÿåˆ—ä¸ºç©ºä»æœªæ‰¾åˆ°ç›®æ ‡ä½ç½®ï¼Œåˆ™è¯´æ˜æ•°æ®ä¿è¯ä¸€å®šæœ‰è§£ï¼Œä¸éœ€è¦å¤„ç†è¿™ç§æƒ…å†µã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 from collections import deque dir = [(-2, 1), (-1, 2), (1, 2), (2, 1), (2, -1), (1, -2), (-1, -2), (-2, -1)] c, r = map(int, input().split()) g = [[] for _ in range(r)] vis = [[False]*(c+1) for _ in range(r+1)] for i in range(r): g[i] = list(input()) for j, ch in enumerate(g[i]): if ch=='H': end = (i, j) if ch=='K': start = (i, j) q = deque() q.append((*start, 0)) while q: x, y, d= q.popleft() if (x, y)==end: print(d) break for i in range(8): a, b = x + dir[i][0], y + dir[i][1] if 0\u003c=a\u003cr and 0\u003c=b\u003cc: if g[a][b]!='*' and not vis[a][b]: vis[a][b] = True q.append((a, b, d+1)) å¤šæºBFS é¢˜ç›®å¤§æ„ï¼šç»™å®šä¸€ä¸ª N è¡Œ M åˆ—çš„ 01 çŸ©é˜µ Aï¼Œå®šä¹‰çŸ©é˜µä¸­æ¯ä¸ªä½ç½®ä¸æ‰€æœ‰å€¼ä¸º1çš„ä½ç½®çš„æ›¼å“ˆé¡¿è·ç¦»ã€‚æ›¼å“ˆé¡¿è·ç¦»ä¸ºè¯¥ä½ç½®ä¸æ‰€æœ‰å€¼ä¸º1çš„ä½ç½®è¡Œåæ ‡ä¹‹å·®çš„ç»å¯¹å€¼ä¸åˆ—åæ ‡ä¹‹å·®çš„ç»å¯¹å€¼ä¹‹å’Œã€‚\nå®ç°æ€è·¯ï¼š\né¦–å…ˆè¯»å…¥çŸ©é˜µçš„è¡Œæ•°å’Œåˆ—æ•°ï¼Œä»¥åŠçŸ©é˜µæœ¬èº«ã€‚ ä½¿ç”¨BFSï¼ˆå¹¿åº¦ä¼˜å…ˆæœç´¢ï¼‰æ¥è®¡ç®—æ¯ä¸ªä½ç½®åˆ°æ‰€æœ‰å€¼ä¸º1çš„ä½ç½®çš„è·ç¦»ã€‚ åˆå§‹åŒ–ä¸€ä¸ªé˜Ÿåˆ—ï¼Œå°†æ‰€æœ‰å€¼ä¸º1çš„ä½ç½®å…¥é˜Ÿï¼Œè·ç¦»åˆå§‹åŒ–ä¸º0ã€‚ å¯¹é˜Ÿåˆ—è¿›è¡ŒBFSéå†ï¼Œæ¯æ¬¡å–å‡ºé˜Ÿé¦–å…ƒç´ ï¼Œè®¡ç®—å…¶å‘¨å›´å››ä¸ªæ–¹å‘çš„ä½ç½®ï¼Œè‹¥ä½ç½®åˆæ³•ä¸”ä¸º0ä¸”æœªè¢«è®¿é—®è¿‡ï¼Œåˆ™æ›´æ–°è·ç¦»å¹¶å…¥é˜Ÿã€‚ æœ€ç»ˆè¾“å‡ºè·ç¦»çŸ©é˜µBã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 import sys from collections import deque input = lambda:sys.stdin.readline().strip() N = int(1e3+10) g = [[] for _ in range(N)] dis = [[-1]*N for _ in range(N)] n, m = map(int, input().split()) for i in range(1, n+1): g[i] = [0] + list(input()) q = deque() for i in range(1, n+1): for j in range(1, m+1): if g[i][j] == '1': q.append((i, j, 0)) dis[i][j] = 0 dx = [1, 0, -1, 0] dy = [0, 1, 0, -1] while q: x, y, d = q.popleft() for i in range(4): xx = x+dx[i]; yy = y+dy[i] if xx\u003e0 and xx\u003c=n and yy\u003e0 and yy\u003c=m: if g[xx][yy] == '0' and dis[xx][yy] == -1: dis[xx][yy] = d+1 q.append((xx, yy, d+1)) for i in range(1, n+1): print(*dis[i][1:m+1]) åŒç«¯é˜Ÿåˆ—BFS175. ç”µè·¯ç»´ä¿® é¢˜ç›®å¤§æ„ï¼šæœ‰ä¸€ä¸ªç”µè·¯æ¿ï¼Œç”± R è¡Œ C åˆ—çš„ç½‘æ ¼ç»„æˆï¼Œæ¯ä¸ªæ ¼ç‚¹éƒ½æ˜¯ç”µçº¿çš„æ¥ç‚¹ï¼Œæ¯ä¸ªæ ¼å­åŒ…å«ä¸€ä¸ªå¯æ—‹è½¬çš„ç”µå­å…ƒä»¶ï¼Œç”µå­å…ƒä»¶è¿æ¥ä¸€æ¡å¯¹è§’çº¿ä¸Šçš„ä¸¤ä¸ªæ¥ç‚¹ã€‚è¾¾è¾¾å¸Œæœ›é€šè¿‡æ—‹è½¬æœ€å°‘æ•°é‡çš„å…ƒä»¶ï¼Œä½¿ç”µæºä¸å‘åŠ¨è£…ç½®é€šè¿‡è‹¥å¹²æ¡çŸ­ç¼†ç›¸è¿ï¼Œä½†å› ä¸ºæŸäº›å…ƒä»¶çš„æ–¹å‘ä¸æ­£ç¡®ï¼Œå¯¼è‡´ç”µè·¯æ¿å¯èƒ½å¤„äºæ–­è·¯çš„çŠ¶æ€ã€‚éœ€è¦è®¡ç®—æœ€å°‘æ—‹è½¬çš„æ¬¡æ•°æ¥ä½¿å¾—ç”µæºå’Œå‘åŠ¨æœºä¹‹é—´è¿é€šã€‚\nå®ç°æ€è·¯ï¼šå¯ä»¥ä½¿ç”¨å¹¿åº¦ä¼˜å…ˆæœç´¢ï¼ˆBFSï¼‰æ¥è§£å†³æ­¤é—®é¢˜ã€‚é¦–å…ˆï¼Œåˆå§‹åŒ–ä¸€ä¸ªäºŒç»´æ•°ç»„ d ç”¨äºå­˜å‚¨ä»èµ·ç‚¹åˆ°æ¯ä¸ªç‚¹çš„æœ€çŸ­è·ç¦»ã€‚ç„¶åï¼Œåˆ©ç”¨å¹¿åº¦ä¼˜å…ˆæœç´¢çš„æ–¹å¼éå†ç”µè·¯æ¿çš„æ¯ä¸ªæ ¼ç‚¹ï¼Œå¦‚æœå‘ç°æŸä¸ªæ ¼ç‚¹çš„çŠ¶æ€éœ€è¦æ”¹å˜ï¼ˆå³å½“å‰æ ¼ç‚¹çš„å…ƒä»¶æ–¹å‘ä¸æ‰€éœ€æ–¹å‘ä¸ä¸€è‡´ï¼‰ï¼Œåˆ™æ›´æ–°è¯¥æ ¼ç‚¹çš„çŠ¶æ€å¹¶å°†å…¶åŠ å…¥åˆ°é˜Ÿåˆ—ä¸­ã€‚æœ€åï¼Œè¿”å›ç»ˆç‚¹çš„æœ€çŸ­è·ç¦»å³å¯ï¼Œå¦‚æœæ— æ³•åˆ°è¾¾ç»ˆç‚¹ï¼Œåˆ™è¾“å‡º â€œNO SOLUTIONâ€ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 import sys input = lambda:sys.stdin.readline().strip() from collections import deque dire = [(-1, -1), (-1, 1), (1, 1), (1, -1)] mov = [(-1, -1), (-1, 0), (0, 0), (0, -1)] ch = \"\\\\/\\\\/\" def bfs(): dq = deque() d = [[float('inf')]*(c+1) for _ in range(r+1)] d[0][0] = 0 dq.append((0, 0)) while dq: x, y = dq.popleft() for i in range(4): xx, yy = x + dire[i][0], y + dire[i][1] if 0\u003c=xx\u003c=r and 0\u003c=yy\u003c=c: j, k = x+mov[i][0], y + mov[i][1] w = 1 if g[j][k] != ch[i] else 0 if d[xx][yy] \u003e d[x][y] + w: d[xx][yy] = d[x][y] + w if w: dq.append((xx, yy)) else: dq.appendleft((xx, yy)) return -1 if d[r][c] == float('inf') else d[r][c] t = int(input()) for _ in range(t): r, c = map(int, input().split()) g = [input() for _ in range(r)] res = bfs() print(res if res != -1 else \"NO SOLUTION\") A* 179. å…«æ•°ç  é¢˜ç›®å¤§æ„ï¼šåœ¨ä¸€ä¸ª 3Ã—3 çš„ç½‘æ ¼ä¸­ï¼Œæ•°å­— 1âˆ¼8 ä¸ä¸€ä¸ª x æ°å¥½ä¸é‡ä¸æ¼åœ°åˆ†å¸ƒåœ¨è¿™ä¸ªç½‘æ ¼ä¸­ã€‚å¯ä»¥é€šè¿‡æŠŠ x ä¸å…¶ä¸Šã€ä¸‹ã€å·¦ã€å³å››ä¸ªæ–¹å‘ä¹‹ä¸€çš„æ•°å­—äº¤æ¢ï¼ˆå¦‚æœå­˜åœ¨ï¼‰æ¥æ”¹å˜ç½‘æ ¼çš„çŠ¶æ€ï¼Œç›®æ ‡æ˜¯é€šè¿‡æœ€å°‘çš„ç§»åŠ¨æ¬¡æ•°ï¼Œä½¿å¾—ç½‘æ ¼å˜ä¸ºæ­£ç¡®æ’åˆ—ã€‚\nå®ç°æ€è·¯ï¼šä½¿ç”¨ A* ç®—æ³•æ¥è§£å†³è¯¥é—®é¢˜ã€‚é¦–å…ˆï¼Œå®šä¹‰ä¸€ä¸ªå¯å‘å‡½æ•°ç”¨äºä¼°è®¡å½“å‰çŠ¶æ€åˆ°è¾¾ç›®æ ‡çŠ¶æ€çš„æœ€å°ç§»åŠ¨æ¬¡æ•°ã€‚ç„¶åï¼Œåˆ©ç”¨ A* ç®—æ³•è¿›è¡Œæœç´¢ï¼Œä¸æ–­æ›´æ–°å½“å‰çŠ¶æ€åˆ°è¾¾ç›®æ ‡çŠ¶æ€çš„æœ€å°ç§»åŠ¨æ¬¡æ•°ï¼Œå¹¶è®°å½•æ¯ä¸€æ­¥çš„ç§»åŠ¨æ“ä½œã€‚æœ€åï¼Œè¾“å‡ºå¾—åˆ°çš„å®Œæ•´è¡ŒåŠ¨è®°å½•å³å¯ã€‚å¦‚æœä¸å­˜åœ¨è§£å†³æ–¹æ¡ˆï¼Œåˆ™è¾“å‡º â€œunsolvableâ€ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 from heapq import heappush, heappop d = [(-1, 0), (0, 1), (1, 0), (0, -1)] op = \"urdl\" def heuristic(state): # å¯å‘å¼ ans = 0 for i, st in enumerate(state): if st=='x': continue t = int(st)-1 ans += abs(t//3 - i//3) + abs(t%3 - i%3) return ans def astar(): dis, pre = dict(), dict() end = \"12345678x\" dis[start] = 0 h = [] heappush(h, (heuristic(start), start)) while h: _, state = heappop(h) if state == end: break x, y = divmod(state.index('x'), 3) src = state for i in range(4): a, b = x+d[i][0], y+d[i][1] if 0\u003c=a\u003c3 and 0\u003c=b\u003c3: ls = list(state) ls[3*x+y], ls[3*a+b] = ls[3*a+b], ls[3*x+y] new_state = ''.join(ls) if new_state not in dis or dis[new_state] \u003e dis[src] + 1: dis[new_state] = dis[src] + 1 pre[new_state] = (op[i], src) heappush(h, (dis[new_state] + heuristic(new_state), new_state)) ans = '' while end != start: ans = pre[end][0] + ans end = pre[end][1] return ans start = ''.join(input().split()) s = start.replace('x', '') cnt = sum(s[i]\u003es[j] for i in range(8) for j in range(i, 8)) if cnt\u00261: print(\"unsolvable\") else: print(astar()) IDA* æ’ä¹¦ å¯»æ‰¾ä¼°ä»·å‡½æ•°ï¼Œ ä¸€å®šå°äºç­‰äºçœŸå®å€¼ï¼Œå¹¶è¶Šæ¥è¿‘çœŸå®å€¼\nè¿™é“é¢˜ç›®è¦æ±‚ç»™å®š n æœ¬ä¹¦ï¼Œæ¯æœ¬ä¹¦ç¼–å·ä¸º 1 åˆ° nï¼Œåˆå§‹çŠ¶æ€ä¸‹ï¼Œä¹¦æ˜¯ä»»æ„æ’åˆ—çš„ã€‚æ¯æ¬¡æ“ä½œå¯ä»¥æŠ½å–å…¶ä¸­è¿ç»­çš„ä¸€æ®µï¼Œå†æŠŠè¿™æ®µæ’å…¥åˆ°å…¶ä»–æŸä¸ªä½ç½®ã€‚ç›®æ ‡æ˜¯å°†ä¹¦æŒ‰ç…§ 1 åˆ° n çš„é¡ºåºä¾æ¬¡æ’åˆ—ã€‚è¦æ±‚è®¡ç®—æœ€å°‘éœ€è¦å¤šå°‘æ¬¡æ“ä½œã€‚\nå®ç°æ€è·¯ï¼š\né¦–å…ˆå®šä¹‰ä¸€ä¸ªå‡½æ•° f()ï¼Œç”¨æ¥è®¡ç®—å½“å‰çŠ¶æ€ä¸ç›®æ ‡çŠ¶æ€ä¹‹é—´çš„æœ€å°æ“ä½œæ¬¡æ•°ã€‚è¿™ä¸ªå‡½æ•°é€šè¿‡éå†æ¯å¯¹ç›¸é‚»ä¹¦çš„ç¼–å·ï¼Œåˆ¤æ–­å®ƒä»¬æ˜¯å¦è¿ç»­ï¼Œå¦‚æœä¸è¿ç»­åˆ™éœ€è¦è¿›è¡Œä¸€æ¬¡æ“ä½œã€‚æœ€åè¿”å›æ“ä½œæ¬¡æ•°ã€‚ ç„¶åå®šä¹‰ä¸€ä¸ªæ·±åº¦ä¼˜å…ˆæœç´¢å‡½æ•° dfs(u)ï¼Œå…¶ä¸­ u è¡¨ç¤ºå½“å‰æœç´¢çš„æ·±åº¦ã€‚åœ¨æ¯æ¬¡æœç´¢ä¸­ï¼Œæˆ‘ä»¬éœ€è¦åˆ¤æ–­å½“å‰æ·±åº¦åŠ ä¸Šåˆ°ç›®æ ‡çŠ¶æ€çš„æœ€å°æ“ä½œæ¬¡æ•°æ˜¯å¦è¶…è¿‡å·²ç»å¾—åˆ°çš„æœ€å°æ“ä½œæ¬¡æ•°ï¼Œå¦‚æœè¶…è¿‡åˆ™ç›´æ¥è¿”å› Falseï¼Œå¦åˆ™ç»§ç»­æœç´¢ã€‚ åœ¨ dfs å‡½æ•°ä¸­ï¼Œé¦–å…ˆåˆ¤æ–­å¦‚æœå½“å‰çŠ¶æ€å·²ç»æ˜¯ç›®æ ‡çŠ¶æ€ï¼Œåˆ™ç›´æ¥è¿”å› Trueã€‚å¦åˆ™ï¼Œæˆ‘ä»¬éå†æ‰€æœ‰å¯èƒ½çš„æ“ä½œï¼Œä»ä¸­é€‰æ‹©ä¸€ç§æ“ä½œæ–¹å¼ï¼Œç„¶åé€’å½’è°ƒç”¨ dfs å‡½æ•°ã€‚ åœ¨ä¸»ç¨‹åºä¸­ï¼Œä¾æ¬¡è¯»å…¥æ¯ç»„æ•°æ®ï¼Œç„¶åè¿›è¡Œæ·±åº¦ä¼˜å…ˆæœç´¢ï¼Œç›´åˆ°å¾—åˆ°ç»“æœæˆ–è€…æœç´¢æ·±åº¦è¾¾åˆ° 5ã€‚æœ€åæ ¹æ®å¾—åˆ°çš„ç»“æœè¾“å‡ºæœ€å°æ“ä½œæ¬¡æ•°æˆ–è€… â€œ5 or moreâ€ã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 def f(): res = 0 for i in range(n-1): if a[i] != a[i+1]-1: res += 1 return (res+2)//3 def dfs(u): global a if u + f() \u003e dep: return False if f()==0: return True for leng in range(n, 0, -1): for l in range(n-leng+1): r = l+leng-1 for k in range(l, r+1): bk = a[:] j = l for i in range(k+1, r+1): a[j] = bk[i] j+=1 for i in range(l, k+1): a[j] = bk[i] j+=1 if dfs(u+1): return True a = bk[:] t = int(input()) while t: t-=1 n = int(input()) a = list(map(int, input().split())) dep = 0 while dep\u003c5 and not dfs(0): dep += 1 if dep \u003c 5: print(dep) else: print(\"5 or more\") ",
  "wordCount" : "9184",
  "inLanguage": "zh",
  "datePublished": "2024-04-09T15:37:01+08:00",
  "dateModified": "2024-04-09T15:37:01+08:00",
  "author":{
    "@type": "Person",
    "name": "ShowGuan"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://kennems.github.io/posts/tech/%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0%E4%B8%89%E5%9B%BE%E8%AE%BApython%E5%AE%9E%E7%8E%B0/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Kennem's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://kennems.github.io/img/sun.png"
    }
  }
}
</script>
<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />
<script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>




</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://kennems.github.io/" accesskey="h" title="Kennem&#39;s Blog (Alt + H)">
                <img src="https://kennems.github.io/img/sun.png" alt="" aria-label="logo"
                    height="35">Kennem&#39;s Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://kennems.github.io/" title="ğŸ ä¸»é¡µ">
                    <span>ğŸ ä¸»é¡µ</span>
                </a>
            </li>
            <li>
                <a href="https://kennems.github.io/search" title="ğŸ”æœç´¢ (Alt &#43; /)" accesskey=/>
                    <span>ğŸ”æœç´¢</span>
                </a>
            </li>
            <li>
                <a href="https://kennems.github.io/posts" title="ğŸ“šæ–‡ç« ">
                    <span>ğŸ“šæ–‡ç« </span>
                </a>
            </li>
            <li>
                <a href="https://kennems.github.io/archives" title="â±æ—¶é—´è½´">
                    <span>â±æ—¶é—´è½´</span>
                </a>
            </li>
            <li>
                <a href="https://kennems.github.io/tags" title="ğŸ”–æ ‡ç­¾">
                    <span>ğŸ”–æ ‡ç­¾</span>
                </a>
            </li>
            <li>
                <a href="https://kennems.github.io/categories" title="ğŸ—‚ï¸åˆ†ç±»">
                    <span>ğŸ—‚ï¸åˆ†ç±»</span>
                </a>
            </li>
            <li>
                <a href="https://kennems.github.io/about" title="ğŸ™‹ğŸ»â€â™‚ï¸å…³äº">
                    <span>ğŸ™‹ğŸ»â€â™‚ï¸å…³äº</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://kennems.github.io/">ä¸»é¡µ</a>&nbsp;Â»&nbsp;<a href="https://kennems.github.io/posts/">ğŸ“šæ–‡ç« </a>&nbsp;Â»&nbsp;<a href="https://kennems.github.io/posts/tech/">ğŸ’»æŠ€æœ¯</a></div>
    <h1 class="post-title entry-hint-parent">
      ç®—æ³•ç¬”è®°ï¼ˆä¸‰ï¼‰â€”â€”å›¾è®ºï¼ˆPythonå®ç°ï¼‰
    </h1>
    <div class="post-description">
      ç®—æ³•ç¬”è®°ï¼ˆä¸‰ï¼‰â€”â€”å›¾è®ºï¼ˆPythonå®ç°ï¼‰
    </div>
    <div class="post-meta"><span title='2024-04-09 15:37:01 +0800 CST'>2024-04-09</span>&nbsp;Â·&nbsp;19 åˆ†é’Ÿ&nbsp;Â·&nbsp;9184 å­—&nbsp;Â·&nbsp;updated:&nbsp;2024-04-09&nbsp;Â·&nbsp;ShowGuan

</div>
    
     <div class="post-password">
        
    </div>
  </header> <aside id="toc-container" class="toc-container wide">
    <div class="toc">
        <details  open>
            <summary accesskey="c" title="(Alt + C)">
                <span class="details">ç›®å½•</span>
            </summary>

            <div class="inner"><ul>
                    <li>
                        <a href="#%e7%ae%97%e6%b3%95%e7%ac%94%e8%ae%b0%e4%b8%89%e5%9b%be%e8%ae%bapython%e5%ae%9e%e7%8e%b0" aria-label="ç®—æ³•ç¬”è®°ï¼ˆä¸‰ï¼‰â€”â€”å›¾è®ºï¼ˆPythonå®ç°ï¼‰">ç®—æ³•ç¬”è®°ï¼ˆä¸‰ï¼‰â€”â€”å›¾è®ºï¼ˆPythonå®ç°ï¼‰</a><ul>
                            
                    <li>
                        <a href="#%e5%9b%be%e8%ae%ba" aria-label="å›¾è®º">å›¾è®º</a><ul>
                            
                    <li>
                        <a href="#%e6%a0%91%e7%9a%84%e5%ad%98%e5%82%a8" aria-label="æ ‘çš„å­˜å‚¨">æ ‘çš„å­˜å‚¨</a><ul>
                            
                    <li>
                        <a href="#%e9%82%bb%e6%8e%a5%e7%9f%a9%e9%98%b5" aria-label="é‚»æ¥çŸ©é˜µ">é‚»æ¥çŸ©é˜µ</a></li>
                    <li>
                        <a href="#%e9%82%bb%e6%8e%a5%e8%a1%a8" aria-label="é‚»æ¥è¡¨">é‚»æ¥è¡¨</a></li></ul>
                    </li>
                    <li>
                        <a href="#%e6%a0%91%e5%92%8c%e5%9b%be%e7%9a%84%e5%ad%98%e5%82%a8" aria-label="æ ‘å’Œå›¾çš„å­˜å‚¨">æ ‘å’Œå›¾çš„å­˜å‚¨</a></li>
                    <li>
                        <a href="#%e6%a0%91%e5%92%8c%e5%9b%be%e7%9a%84%e9%81%8d%e5%8e%86" aria-label="æ ‘å’Œå›¾çš„éå†">æ ‘å’Œå›¾çš„éå†</a><ul>
                            
                    <li>
                        <a href="#dfs" aria-label="DFS">DFS</a></li>
                    <li>
                        <a href="#bfs" aria-label="BFS">BFS</a></li></ul>
                    </li>
                    <li>
                        <a href="#%e6%8b%93%e6%89%91%e6%8e%92%e5%ba%8f" aria-label="æ‹“æ‰‘æ’åº">æ‹“æ‰‘æ’åº</a><ul>
                            
                    <li>
                        <a href="#%e5%a5%96%e9%87%91" aria-label="å¥–é‡‘">å¥–é‡‘</a></li></ul>
                    </li>
                    <li>
                        <a href="#lca" aria-label="LCA">LCA</a><ul>
                            
                    <li>
                        <a href="#%e7%a5%96%e5%ad%99%e8%af%a2%e9%97%ae" aria-label="ç¥–å­™è¯¢é—®">ç¥–å­™è¯¢é—®</a></li></ul>
                    </li>
                    <li>
                        <a href="#%e6%9c%80%e7%9f%ad%e8%b7%af" aria-label="æœ€çŸ­è·¯">æœ€çŸ­è·¯</a><ul>
                            
                    <li>
                        <a href="#%e6%9c%b4%e7%b4%a0dijkstra" aria-label="æœ´ç´ Dijkstra">æœ´ç´ Dijkstra</a></li>
                    <li>
                        <a href="#%e5%a0%86%e4%bc%98%e5%8c%96%e7%89%88dijkstra" aria-label="å †ä¼˜åŒ–ç‰ˆDijkstra">å †ä¼˜åŒ–ç‰ˆDijkstra</a><ul>
                            
                    <li>
                        <a href="#%e5%8f%a6%e4%b8%80%e7%a7%8d%e5%86%99%e6%b3%95" aria-label="å¦ä¸€ç§å†™æ³•">å¦ä¸€ç§å†™æ³•</a></li></ul>
                    </li></ul>
                    </li>
                    <li>
                        <a href="#bellman-ford" aria-label="Bellman-Ford">Bellman-Ford</a></li>
                    <li>
                        <a href="#spfa" aria-label="SPFA">SPFA</a><ul>
                            
                    <li>
                        <a href="#%e5%88%a4%e6%96%ad%e8%b4%9f%e7%8e%af" aria-label="åˆ¤æ–­è´Ÿç¯">åˆ¤æ–­è´Ÿç¯</a></li></ul>
                    </li>
                    <li>
                        <a href="#floyd" aria-label="floyd">floyd</a></li>
                    <li>
                        <a href="#prim" aria-label="Prim">Prim</a></li>
                    <li>
                        <a href="#kruskal" aria-label="Kruskal">Kruskal</a></li>
                    <li>
                        <a href="#%e6%9f%93%e8%89%b2%e6%b3%95" aria-label="æŸ“è‰²æ³•">æŸ“è‰²æ³•</a></li>
                    <li>
                        <a href="#%e5%8c%88%e7%89%99%e5%88%a9%e7%ae%97%e6%b3%95" aria-label="åŒˆç‰™åˆ©ç®—æ³•">åŒˆç‰™åˆ©ç®—æ³•</a></li>
                    <li>
                        <a href="#dfs%e4%b9%8b%e8%bf%9e%e9%80%9a%e6%80%a7" aria-label="DFSä¹‹è¿é€šæ€§">DFSä¹‹è¿é€šæ€§</a></li>
                    <li>
                        <a href="#%e9%ad%94%e6%9d%bf" aria-label="é­”æ¿">é­”æ¿</a></li>
                    <li>
                        <a href="#%e5%8d%95%e8%af%8d%e6%8e%a5%e9%be%99" aria-label="å•è¯æ¥é¾™">å•è¯æ¥é¾™</a></li>
                    <li>
                        <a href="#%e5%88%86%e6%88%90%e4%ba%92%e8%b4%a8%e7%bb%84" aria-label="åˆ†æˆäº’è´¨ç»„">åˆ†æˆäº’è´¨ç»„</a></li>
                    <li>
                        <a href="#%e8%bf%ad%e4%bb%a3%e5%8a%a0%e6%b7%b1-%e5%8a%a0%e6%88%90%e5%ba%8f%e5%88%97" aria-label="è¿­ä»£åŠ æ·± åŠ æˆåºåˆ—">è¿­ä»£åŠ æ·± åŠ æˆåºåˆ—</a></li>
                    <li>
                        <a href="#%e5%8f%8c%e5%90%91dfs-%e9%80%81%e7%a4%bc%e7%89%a9httpswwwacwingcomproblemcontentdescription173" aria-label="åŒå‘DFS é€ç¤¼ç‰©">åŒå‘DFS <a href="https://www.acwing.com/problem/content/description/173/">é€ç¤¼ç‰©</a></a></li>
                    <li>
                        <a href="#37-%e8%a7%a3%e6%95%b0%e7%8b%achttpsleetcodecnproblemssudoku-solver-166-%e6%95%b0%e7%8b%achttpswwwacwingcomproblemcontentdescription168" aria-label="37. è§£æ•°ç‹¬ \166. æ•°ç‹¬"><a href="https://leetcode.cn/problems/sudoku-solver/">37. è§£æ•°ç‹¬</a> <a href="https://www.acwing.com/problem/content/description/168/">\166. æ•°ç‹¬</a></a></li>
                    <li>
                        <a href="#%e6%9c%80%e7%9f%ad%e8%b7%af-188-%e6%ad%a6%e5%a3%ab%e9%a3%8e%e5%ba%a6%e7%9a%84%e7%89%9bhttpswwwacwingcomproblemcontentdescription190" aria-label="æœ€çŸ­è·¯ 188. æ­¦å£«é£åº¦çš„ç‰›">æœ€çŸ­è·¯ <a href="https://www.acwing.com/problem/content/description/190/">188. æ­¦å£«é£åº¦çš„ç‰›</a></a></li>
                    <li>
                        <a href="#%e5%a4%9a%e6%ba%90bfs" aria-label="å¤šæºBFS">å¤šæºBFS</a></li>
                    <li>
                        <a href="#%e5%8f%8c%e7%ab%af%e9%98%9f%e5%88%97bfs175-%e7%94%b5%e8%b7%af%e7%bb%b4%e4%bf%aehttpswwwacwingcomproblemcontentdescription177" aria-label="åŒç«¯é˜Ÿåˆ—BFS175. ç”µè·¯ç»´ä¿®">åŒç«¯é˜Ÿåˆ—BFS<a href="https://www.acwing.com/problem/content/description/177/">175. ç”µè·¯ç»´ä¿®</a></a></li>
                    <li>
                        <a href="#a-179-%e5%85%ab%e6%95%b0%e7%a0%81httpswwwacwingcomproblemcontentdescription181" aria-label="A* 179. å…«æ•°ç "><code>A*</code> <a href="https://www.acwing.com/problem/content/description/181/">179. å…«æ•°ç </a></a></li>
                    <li>
                        <a href="#ida-%e6%8e%92%e4%b9%a6" aria-label="IDA* æ’ä¹¦"><code>IDA*</code> æ’ä¹¦</a>
                    </li>
                </ul>
                </li>
                </ul>
                </li>
                </ul>
            </div>
        </details>
    </div>
</aside>
<script>
    let activeElement;
    let elements;
    window.addEventListener('DOMContentLoaded', function (event) {
        checkTocPosition();

        elements = document.querySelectorAll('h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]');
         
         activeElement = elements[0];
         const id = encodeURI(activeElement.getAttribute('id')).toLowerCase();
         document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
     }, false);

    window.addEventListener('resize', function(event) {
        checkTocPosition();
    }, false);

    window.addEventListener('scroll', () => {
        
        activeElement = Array.from(elements).find((element) => {
            if ((getOffsetTop(element) - window.pageYOffset) > 0 && 
                (getOffsetTop(element) - window.pageYOffset) < window.innerHeight/2) {
                return element;
            }
        }) || activeElement

        elements.forEach(element => {
             const id = encodeURI(element.getAttribute('id')).toLowerCase();
             if (element === activeElement){
                 document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
             } else {
                 document.querySelector(`.inner ul li a[href="#${id}"]`).classList.remove('active');
             }
         })
     }, false);

    const main = parseInt(getComputedStyle(document.body).getPropertyValue('--article-width'), 10);
    const toc = parseInt(getComputedStyle(document.body).getPropertyValue('--toc-width'), 10);
    const gap = parseInt(getComputedStyle(document.body).getPropertyValue('--gap'), 10);

    function checkTocPosition() {
        const width = document.body.scrollWidth;

        if (width - main - (toc * 2) - (gap * 4) > 0) {
            document.getElementById("toc-container").classList.add("wide");
        } else {
            document.getElementById("toc-container").classList.remove("wide");
        }
    }

    function getOffsetTop(element) {
        if (!element.getClientRects().length) {
            return 0;
        }
        let rect = element.getBoundingClientRect();
        let win = element.ownerDocument.defaultView;
        return rect.top + win.pageYOffset;   
    }
</script>

  <div class="post-content"><h1 id="ç®—æ³•ç¬”è®°ä¸‰å›¾è®ºpythonå®ç°">ç®—æ³•ç¬”è®°ï¼ˆä¸‰ï¼‰â€”â€”å›¾è®ºï¼ˆPythonå®ç°ï¼‰<a hidden class="anchor" aria-hidden="true" href="#ç®—æ³•ç¬”è®°ä¸‰å›¾è®ºpythonå®ç°">#</a></h1>
<h2 id="å›¾è®º">å›¾è®º<a hidden class="anchor" aria-hidden="true" href="#å›¾è®º">#</a></h2>
<h3 id="æ ‘çš„å­˜å‚¨">æ ‘çš„å­˜å‚¨<a hidden class="anchor" aria-hidden="true" href="#æ ‘çš„å­˜å‚¨">#</a></h3>
<h4 id="é‚»æ¥çŸ©é˜µ">é‚»æ¥çŸ©é˜µ<a hidden class="anchor" aria-hidden="true" href="#é‚»æ¥çŸ©é˜µ">#</a></h4>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-0-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-0-1"> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-0-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-0-2"> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-0-3"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-0-3"> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-0-4"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-0-4"> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-0-5"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-0-5"> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-0-6"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-0-6"> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-0-7"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-0-7"> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-0-8"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-0-8"> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-0-9"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-0-9"> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-0-10"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-0-10">10</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#75715e"># åˆ›å»ºä¸€ä¸ªäºŒç»´åˆ—è¡¨è¡¨ç¤ºé‚»æ¥çŸ©é˜µ</span>
</span></span><span style="display:flex;"><span>n <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>  <span style="color:#75715e"># é¡¶ç‚¹æ•°é‡</span>
</span></span><span style="display:flex;"><span>g <span style="color:#f92672">=</span> [[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">*</span> n <span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> range(n)]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># æ·»åŠ ä¸€æ¡è¾¹a-&gt;b</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">add_edge</span>(a, b):
</span></span><span style="display:flex;"><span>    g[a][b] <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># åˆå§‹åŒ–</span>
</span></span><span style="display:flex;"><span>g <span style="color:#f92672">=</span> [[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">*</span> n <span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> range(n)]
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="é‚»æ¥è¡¨">é‚»æ¥è¡¨<a hidden class="anchor" aria-hidden="true" href="#é‚»æ¥è¡¨">#</a></h4>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-1"> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-2"> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-3"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-3"> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-4"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-4"> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-5"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-5"> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-6"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-6"> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-7"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-7"> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-8"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-8"> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-9"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-9"> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-10"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-10">10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-11"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-11">11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-12"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-12">12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-13"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-13">13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-14"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-14">14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-15"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-15">15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-16"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-16">16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-17"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-17">17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-18"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-18">18</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#75715e"># åˆ›å»ºä¸€ä¸ªåˆ—è¡¨è¡¨ç¤ºé‚»æ¥è¡¨</span>
</span></span><span style="display:flex;"><span>n <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>  <span style="color:#75715e"># é¡¶ç‚¹æ•°é‡</span>
</span></span><span style="display:flex;"><span>h <span style="color:#f92672">=</span> [<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">*</span> n
</span></span><span style="display:flex;"><span>e <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0</span>] <span style="color:#f92672">*</span> n
</span></span><span style="display:flex;"><span>ne <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0</span>] <span style="color:#f92672">*</span> n
</span></span><span style="display:flex;"><span>idx <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># æ·»åŠ ä¸€æ¡è¾¹a-&gt;b</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">add_edge</span>(a, b):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">global</span> idx
</span></span><span style="display:flex;"><span>    e[idx] <span style="color:#f92672">=</span> b
</span></span><span style="display:flex;"><span>    ne[idx] <span style="color:#f92672">=</span> h[a]
</span></span><span style="display:flex;"><span>    h[a] <span style="color:#f92672">=</span> idx
</span></span><span style="display:flex;"><span>    idx <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># åˆå§‹åŒ–</span>
</span></span><span style="display:flex;"><span>idx <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>h <span style="color:#f92672">=</span> [<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">*</span> n
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="æ ‘å’Œå›¾çš„å­˜å‚¨">æ ‘å’Œå›¾çš„å­˜å‚¨<a hidden class="anchor" aria-hidden="true" href="#æ ‘å’Œå›¾çš„å­˜å‚¨">#</a></h3>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-1"> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-2"> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-3"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-3"> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-4"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-4"> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-5"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-5"> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-6"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-6"> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-7"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-7"> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-8"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-8"> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-9"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-9"> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-10"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-10">10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-11"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-11">11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-12"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-12">12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-13"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-13">13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-14"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-14">14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-15"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-15">15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-16"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-16">16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-17"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-17">17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-18"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-18">18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-19"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-19">19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-20"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-20">20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-21"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-21">21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-22"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-22">22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-23"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-23">23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-24"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-24">24</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#75715e"># é‚»æ¥è¡¨è¡¨ç¤ºçš„å›¾</span>
</span></span><span style="display:flex;"><span>N <span style="color:#f92672">=</span> <span style="color:#ae81ff">100010</span>  <span style="color:#75715e"># æ ¹æ®å…·ä½“éœ€æ±‚è®¾ç½®åˆé€‚çš„æœ€å¤§èŠ‚ç‚¹æ•°é‡</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># å¯¹äºæ¯ä¸ªç‚¹kï¼Œå¼€ä¸€ä¸ªå•é“¾è¡¨ï¼Œå­˜å‚¨kæ‰€æœ‰å¯ä»¥èµ°åˆ°çš„ç‚¹ã€‚h[k]å­˜å‚¨è¿™ä¸ªå•é“¾è¡¨çš„å¤´ç»“ç‚¹</span>
</span></span><span style="display:flex;"><span>h <span style="color:#f92672">=</span> [<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">*</span> N
</span></span><span style="display:flex;"><span><span style="color:#75715e"># å­˜å‚¨è¾¹çš„ç›®æ ‡èŠ‚ç‚¹</span>
</span></span><span style="display:flex;"><span>e <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0</span>] <span style="color:#f92672">*</span> N
</span></span><span style="display:flex;"><span><span style="color:#75715e"># å­˜å‚¨ä¸‹ä¸€æ¡è¾¹çš„ç´¢å¼•</span>
</span></span><span style="display:flex;"><span>ne <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0</span>] <span style="color:#f92672">*</span> N
</span></span><span style="display:flex;"><span><span style="color:#75715e"># è¾¹çš„ç´¢å¼•</span>
</span></span><span style="display:flex;"><span>idx <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># æ·»åŠ ä¸€æ¡è¾¹a-&gt;b</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">add</span>(a, b):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">global</span> idx
</span></span><span style="display:flex;"><span>    e[idx] <span style="color:#f92672">=</span> b
</span></span><span style="display:flex;"><span>    ne[idx] <span style="color:#f92672">=</span> h[a]
</span></span><span style="display:flex;"><span>    h[a] <span style="color:#f92672">=</span> idx
</span></span><span style="display:flex;"><span>    idx <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># åˆå§‹åŒ–</span>
</span></span><span style="display:flex;"><span>idx <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(N):
</span></span><span style="display:flex;"><span>    h[i] <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="æ ‘å’Œå›¾çš„éå†">æ ‘å’Œå›¾çš„éå†<a hidden class="anchor" aria-hidden="true" href="#æ ‘å’Œå›¾çš„éå†">#</a></h3>
<h4 id="dfs">DFS<a hidden class="anchor" aria-hidden="true" href="#dfs">#</a></h4>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-3-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-3-1">1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-3-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-3-2">2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-3-3"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-3-3">3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-3-4"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-3-4">4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-3-5"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-3-5">5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-3-6"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-3-6">6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-3-7"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-3-7">7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-3-8"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-3-8">8</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">dfs</span>(u):
</span></span><span style="display:flex;"><span>    st[u] <span style="color:#f92672">=</span> <span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>    i <span style="color:#f92672">=</span> h[u]
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> i<span style="color:#f92672">!=-</span><span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>        j <span style="color:#f92672">=</span> e[i]
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> st[j]:
</span></span><span style="display:flex;"><span>            dfs(j)
</span></span><span style="display:flex;"><span>        i <span style="color:#f92672">=</span> ne[i]
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="bfs">BFS<a hidden class="anchor" aria-hidden="true" href="#bfs">#</a></h4>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-4-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-4-1"> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-4-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-4-2"> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-4-3"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-4-3"> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-4-4"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-4-4"> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-4-5"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-4-5"> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-4-6"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-4-6"> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-4-7"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-4-7"> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-4-8"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-4-8"> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-4-9"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-4-9"> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-4-10"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-4-10">10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-4-11"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-4-11">11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-4-12"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-4-12">12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-4-13"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-4-13">13</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#f92672">from</span> collections <span style="color:#f92672">import</span> deque
</span></span><span style="display:flex;"><span>q <span style="color:#f92672">=</span> deque()
</span></span><span style="display:flex;"><span>st[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span> <span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>q<span style="color:#f92672">.</span>append(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">while</span> q:
</span></span><span style="display:flex;"><span>    t <span style="color:#f92672">=</span> q<span style="color:#f92672">.</span>popleft()
</span></span><span style="display:flex;"><span>    i <span style="color:#f92672">=</span> h[t]
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> i<span style="color:#f92672">!=-</span><span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>        j<span style="color:#f92672">=</span>e[i]
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> st[j]:
</span></span><span style="display:flex;"><span>            st[j] <span style="color:#f92672">=</span> <span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>            q<span style="color:#f92672">.</span>append(j)
</span></span><span style="display:flex;"><span>        i<span style="color:#f92672">=</span>ne[i]
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="æ‹“æ‰‘æ’åº">æ‹“æ‰‘æ’åº<a hidden class="anchor" aria-hidden="true" href="#æ‹“æ‰‘æ’åº">#</a></h3>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-1"> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-2"> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-3"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-3"> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-4"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-4"> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-5"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-5"> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-6"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-6"> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-7"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-7"> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-8"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-8"> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-9"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-9"> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-10"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-10">10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-11"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-11">11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-12"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-12">12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-13"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-13">13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-14"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-14">14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-15"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-15">15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-16"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-16">16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-17"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-17">17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-18"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-18">18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-19"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-19">19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-20"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-20">20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-21"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-21">21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-22"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-22">22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-23"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-23">23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-24"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-24">24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-25"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-25">25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-26"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-26">26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-27"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-27">27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-28"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-28">28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-29"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-29">29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-30"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-30">30</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-31"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-31">31</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-32"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-32">32</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-33"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-33">33</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-34"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-34">34</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-35"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-35">35</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#f92672">from</span> sys <span style="color:#f92672">import</span> stdin
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> collections <span style="color:#f92672">import</span> deque
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>input <span style="color:#f92672">=</span> <span style="color:#66d9ef">lambda</span>:stdin<span style="color:#f92672">.</span>readline()<span style="color:#f92672">.</span>strip()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">topsort</span>():
</span></span><span style="display:flex;"><span>    q <span style="color:#f92672">=</span> deque()
</span></span><span style="display:flex;"><span>    res <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>, n<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> ind[i]<span style="color:#f92672">==</span><span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>            res<span style="color:#f92672">.</span>append(i)
</span></span><span style="display:flex;"><span>            q<span style="color:#f92672">.</span>append(i)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> q:
</span></span><span style="display:flex;"><span>        u <span style="color:#f92672">=</span> q<span style="color:#f92672">.</span>popleft()
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> v <span style="color:#f92672">in</span> g[u]:
</span></span><span style="display:flex;"><span>            ind[v] <span style="color:#f92672">-=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> ind[v]<span style="color:#f92672">==</span><span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>                q<span style="color:#f92672">.</span>append(v)
</span></span><span style="display:flex;"><span>                res<span style="color:#f92672">.</span>append(v)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> res
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>n <span style="color:#f92672">=</span> int(input())
</span></span><span style="display:flex;"><span>ind <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0</span>]<span style="color:#f92672">*</span>(n<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>g <span style="color:#f92672">=</span> [[] <span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> range(n<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>, n<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>    a <span style="color:#f92672">=</span> list(map(int, input()<span style="color:#f92672">.</span>split()))
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(len(a)<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>        g[i]<span style="color:#f92672">.</span>append(a[j])
</span></span><span style="display:flex;"><span>        ind[a[j]]<span style="color:#f92672">+=</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>res <span style="color:#f92672">=</span> topsort()
</span></span><span style="display:flex;"><span>print(<span style="color:#f92672">*</span>res, sep<span style="color:#f92672">=</span><span style="color:#e6db74">&#39; &#39;</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="å¥–é‡‘">å¥–é‡‘<a hidden class="anchor" aria-hidden="true" href="#å¥–é‡‘">#</a></h4>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-1"> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-2"> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-3"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-3"> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-4"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-4"> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-5"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-5"> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-6"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-6"> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-7"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-7"> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-8"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-8"> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-9"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-9"> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-10"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-10">10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-11"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-11">11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-12"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-12">12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-13"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-13">13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-14"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-14">14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-15"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-15">15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-16"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-16">16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-17"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-17">17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-18"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-18">18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-19"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-19">19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-20"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-20">20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-21"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-21">21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-22"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-22">22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-23"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-23">23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-24"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-24">24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-25"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-25">25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-26"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-26">26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-27"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-27">27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-28"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-28">28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-29"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-29">29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-30"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-30">30</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-31"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-31">31</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-32"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-32">32</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-33"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-33">33</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-34"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-34">34</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-35"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-35">35</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-36"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-36">36</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-37"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-37">37</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-38"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-38">38</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#f92672">from</span> sys <span style="color:#f92672">import</span> stdin
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> collections <span style="color:#f92672">import</span> deque
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">topsort</span>():
</span></span><span style="display:flex;"><span>    res <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>    q <span style="color:#f92672">=</span> deque()
</span></span><span style="display:flex;"><span>    ans <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>, n<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> ind[i]<span style="color:#f92672">==</span><span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>            res<span style="color:#f92672">.</span>append(i)
</span></span><span style="display:flex;"><span>            q<span style="color:#f92672">.</span>append((i, <span style="color:#ae81ff">100</span>))
</span></span><span style="display:flex;"><span>            ans <span style="color:#f92672">+=</span> <span style="color:#ae81ff">100</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> q:
</span></span><span style="display:flex;"><span>        u, m <span style="color:#f92672">=</span> q<span style="color:#f92672">.</span>popleft()
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> v <span style="color:#f92672">in</span> g[u]:
</span></span><span style="display:flex;"><span>            ind[v] <span style="color:#f92672">-=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> ind[v]<span style="color:#f92672">==</span><span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>                q<span style="color:#f92672">.</span>append((v, m<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>))
</span></span><span style="display:flex;"><span>                res<span style="color:#f92672">.</span>append(v)
</span></span><span style="display:flex;"><span>                ans <span style="color:#f92672">+=</span> m<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> len(res)<span style="color:#f92672">==</span>n:
</span></span><span style="display:flex;"><span>        print(ans)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;Poor Xed&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>n, m <span style="color:#f92672">=</span> map(int, input()<span style="color:#f92672">.</span>split())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ind <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0</span>]<span style="color:#f92672">*</span>(n<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>g <span style="color:#f92672">=</span> [[] <span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> range(n<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(m):
</span></span><span style="display:flex;"><span>    a, b <span style="color:#f92672">=</span> map(int, input()<span style="color:#f92672">.</span>split())
</span></span><span style="display:flex;"><span>    ind[a] <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    g[b]<span style="color:#f92672">.</span>append(a)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>topsort()
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="lca">LCA<a hidden class="anchor" aria-hidden="true" href="#lca">#</a></h3>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-7-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-7-1"> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-7-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-7-2"> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-7-3"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-7-3"> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-7-4"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-7-4"> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-7-5"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-7-5"> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-7-6"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-7-6"> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-7-7"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-7-7"> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-7-8"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-7-8"> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-7-9"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-7-9"> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-7-10"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-7-10">10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-7-11"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-7-11">11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-7-12"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-7-12">12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-7-13"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-7-13">13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-7-14"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-7-14">14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-7-15"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-7-15">15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-7-16"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-7-16">16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-7-17"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-7-17">17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-7-18"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-7-18">18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-7-19"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-7-19">19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-7-20"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-7-20">20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-7-21"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-7-21">21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-7-22"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-7-22">22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-7-23"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-7-23">23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-7-24"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-7-24">24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-7-25"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-7-25">25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-7-26"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-7-26">26</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">lca</span>(x,y):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> dep[x] <span style="color:#f92672">&lt;</span> dep[y]:
</span></span><span style="display:flex;"><span>        x,y <span style="color:#f92672">=</span> y,x
</span></span><span style="display:flex;"><span>    d <span style="color:#f92672">=</span> dep[x]<span style="color:#f92672">-</span>dep[y]
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> d:  <span style="color:#75715e"># å¾ªç¯ç›´åˆ°æ·±åº¦å·®ä¸º 0</span>
</span></span><span style="display:flex;"><span>        v <span style="color:#f92672">=</span> d <span style="color:#f92672">&amp;</span> <span style="color:#f92672">-</span>d  <span style="color:#75715e"># è·å– d çš„æœ€ä½ä½çš„ 1 æ‰€åœ¨çš„ä½ç½®</span>
</span></span><span style="display:flex;"><span>        i <span style="color:#f92672">=</span> v<span style="color:#f92672">.</span>bit_length() <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>  <span style="color:#75715e"># è®¡ç®—æœ€ä½ä½çš„ä½ç½®ç´¢å¼•</span>
</span></span><span style="display:flex;"><span>        x <span style="color:#f92672">=</span> fa[i][x]  <span style="color:#75715e"># å°†èŠ‚ç‚¹ x ä¸Šç§»åˆ°å’ŒèŠ‚ç‚¹ y åŒä¸€æ·±åº¦</span>
</span></span><span style="display:flex;"><span>        d <span style="color:#f92672">-=</span> v  <span style="color:#75715e"># æ›´æ–°æ·±åº¦å·®</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> x<span style="color:#f92672">==</span>y:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> x
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> k <span style="color:#f92672">in</span> range(K<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> fa[k][x] <span style="color:#f92672">!=</span> fa[k][y]:
</span></span><span style="display:flex;"><span>            x <span style="color:#f92672">=</span> fa[k][x]
</span></span><span style="display:flex;"><span>            y <span style="color:#f92672">=</span> fa[k][y]
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> fa[<span style="color:#ae81ff">0</span>][x]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># åˆå§‹åŒ–æ·±åº¦ä»¥åŠçˆ¶èŠ‚ç‚¹ä¿¡æ¯</span>
</span></span><span style="display:flex;"><span>dep[x]<span style="color:#f92672">=</span>dep[val]<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>dep[y]<span style="color:#f92672">=</span>dep[val]<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>fa[<span style="color:#ae81ff">0</span>][x] <span style="color:#f92672">=</span> val
</span></span><span style="display:flex;"><span>fa[<span style="color:#ae81ff">0</span>][y] <span style="color:#f92672">=</span> val
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> k <span style="color:#f92672">in</span> range(K<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>    fa[k<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>][x] <span style="color:#f92672">=</span> fa[k][fa[k][x]] <span style="color:#75715e"># è‡ªå·±çš„ç¬¬2^(1+1)çº§çˆ¶äº²å³ä¸º è‡ªå·±çš„ç¬¬2^(1)çº§çˆ¶äº² çš„ç¬¬2^(1)çº§çˆ¶äº²</span>
</span></span><span style="display:flex;"><span>    fa[k<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>][y] <span style="color:#f92672">=</span> fa[k][fa[k][y]]
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="ç¥–å­™è¯¢é—®">ç¥–å­™è¯¢é—®<a hidden class="anchor" aria-hidden="true" href="#ç¥–å­™è¯¢é—®">#</a></h4>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-1"> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-2"> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-3"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-3"> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-4"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-4"> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-5"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-5"> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-6"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-6"> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-7"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-7"> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-8"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-8"> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-9"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-9"> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-10"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-10">10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-11"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-11">11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-12"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-12">12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-13"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-13">13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-14"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-14">14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-15"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-15">15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-16"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-16">16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-17"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-17">17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-18"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-18">18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-19"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-19">19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-20"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-20">20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-21"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-21">21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-22"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-22">22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-23"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-23">23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-24"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-24">24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-25"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-25">25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-26"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-26">26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-27"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-27">27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-28"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-28">28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-29"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-29">29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-30"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-30">30</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-31"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-31">31</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-32"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-32">32</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-33"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-33">33</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-34"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-34">34</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-35"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-35">35</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-36"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-36">36</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-37"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-37">37</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-38"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-38">38</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-39"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-39">39</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-40"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-40">40</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-41"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-41">41</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-42"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-42">42</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-43"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-43">43</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-44"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-44">44</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-45"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-45">45</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-46"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-46">46</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-47"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-47">47</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-48"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-48">48</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-49"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-49">49</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-50"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-50">50</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-51"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-51">51</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-52"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-52">52</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-53"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-53">53</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-54"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-54">54</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-55"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-55">55</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-56"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-56">56</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-57"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-57">57</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-58"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-58">58</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-59"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-59">59</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-60"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-60">60</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-61"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-61">61</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-62"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-62">62</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-63"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-63">63</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-64"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-64">64</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-65"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-65">65</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-66"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-66">66</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-67"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-67">67</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-68"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-68">68</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-69"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-69">69</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-70"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-70">70</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#f92672">from</span> sys <span style="color:#f92672">import</span> stdin
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> collections <span style="color:#f92672">import</span> deque, defaultdict
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> math <span style="color:#f92672">import</span> inf
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>K <span style="color:#f92672">=</span> <span style="color:#ae81ff">17</span>
</span></span><span style="display:flex;"><span>N <span style="color:#f92672">=</span> int(<span style="color:#ae81ff">4</span><span style="color:#f92672">*</span><span style="color:#ae81ff">10e4</span>) <span style="color:#f92672">+</span> <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>dep <span style="color:#f92672">=</span> [inf]<span style="color:#f92672">*</span>(N)
</span></span><span style="display:flex;"><span>fa <span style="color:#f92672">=</span> [[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">*</span>N <span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> range(K)]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">bfs</span>():
</span></span><span style="display:flex;"><span>    dep[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; dep[root] <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    q <span style="color:#f92672">=</span> deque([root])
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> q:
</span></span><span style="display:flex;"><span>        u <span style="color:#f92672">=</span> q<span style="color:#f92672">.</span>popleft()
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> v <span style="color:#f92672">in</span> g[u]:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> dep[v] <span style="color:#f92672">&gt;</span> dep[u] <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>                dep[v] <span style="color:#f92672">=</span> dep[u] <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                q<span style="color:#f92672">.</span>append(v)
</span></span><span style="display:flex;"><span>                fa[<span style="color:#ae81ff">0</span>][v] <span style="color:#f92672">=</span> u
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">for</span> k <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>, K<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>                    fa[k][v] <span style="color:#f92672">=</span> fa[k<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>][fa[k<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>][v]]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">lca</span>(x, y):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> dep[x] <span style="color:#f92672">&lt;</span> dep[y]:
</span></span><span style="display:flex;"><span>        x, y <span style="color:#f92672">=</span> y, x
</span></span><span style="display:flex;"><span>    d <span style="color:#f92672">=</span> dep[x] <span style="color:#f92672">-</span> dep[y]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> d:
</span></span><span style="display:flex;"><span>        v <span style="color:#f92672">=</span> d <span style="color:#f92672">&amp;</span> <span style="color:#f92672">-</span>d
</span></span><span style="display:flex;"><span>        i <span style="color:#f92672">=</span> v<span style="color:#f92672">.</span>bit_length() <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        x <span style="color:#f92672">=</span> fa[i][x]
</span></span><span style="display:flex;"><span>        d <span style="color:#f92672">-=</span> v
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> x<span style="color:#f92672">==</span>y:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> x
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> k <span style="color:#f92672">in</span> range(K<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> fa[k][x] <span style="color:#f92672">!=</span> fa[k][y]:
</span></span><span style="display:flex;"><span>            x <span style="color:#f92672">=</span> fa[k][x]
</span></span><span style="display:flex;"><span>            y <span style="color:#f92672">=</span> fa[k][y]
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> fa[<span style="color:#ae81ff">0</span>][x]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>n <span style="color:#f92672">=</span> int(input())
</span></span><span style="display:flex;"><span>g <span style="color:#f92672">=</span> defaultdict(list)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(n):
</span></span><span style="display:flex;"><span>    a, b <span style="color:#f92672">=</span> map(int, input()<span style="color:#f92672">.</span>split())
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> b<span style="color:#f92672">==-</span><span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>        root <span style="color:#f92672">=</span> a
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        g[a]<span style="color:#f92672">.</span>append(b)
</span></span><span style="display:flex;"><span>        g[b]<span style="color:#f92672">.</span>append(a)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>bfs()
</span></span><span style="display:flex;"><span><span style="color:#75715e"># print(dep)</span>
</span></span><span style="display:flex;"><span>m <span style="color:#f92672">=</span> int(input())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(m):
</span></span><span style="display:flex;"><span>    x, y <span style="color:#f92672">=</span> map(int, input()<span style="color:#f92672">.</span>split())
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    res <span style="color:#f92672">=</span> lca(x, y)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> res <span style="color:#f92672">==</span> x <span style="color:#f92672">and</span> res <span style="color:#f92672">!=</span> y:
</span></span><span style="display:flex;"><span>        print(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> res <span style="color:#f92672">==</span> y <span style="color:#f92672">and</span> res <span style="color:#f92672">!=</span> x:
</span></span><span style="display:flex;"><span>        print(<span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        print(<span style="color:#ae81ff">0</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="æœ€çŸ­è·¯">æœ€çŸ­è·¯<a hidden class="anchor" aria-hidden="true" href="#æœ€çŸ­è·¯">#</a></h3>
<ul>
<li>
<p>å•å…ƒæœ€çŸ­è·¯</p>
<ul>
<li>
<p>â€‹	æ‰€æœ‰è¾¹æƒä¸ºæ­£ï¼š</p>
<ul>
<li>â€‹		æœ´ç´ ç‰ˆDijkstra $O(n^2)$,å †ä¼˜åŒ–ç‰ˆçš„Dijkstra $O(mlogn)$,</li>
</ul>
</li>
<li>
<p>â€‹	å­˜åœ¨è´Ÿæƒè¾¹</p>
<ul>
<li>â€‹		Bellman-Ford $O(nm)$, SPFA é˜Ÿåˆ—ä¼˜åŒ–çš„Bellman-Ford, ä¸€èˆ¬æƒ…å†µï¼š$O(m)$ æœ€åæƒ…å†µï¼š$O(nm)$</li>
</ul>
</li>
</ul>
</li>
<li>
<p>å¤šå…ƒæ±‡æœ€çŸ­è·¯ï¼š</p>
<ul>
<li>â€‹	Floyed $O(n^3)$</li>
</ul>
</li>
</ul>
<h4 id="æœ´ç´ dijkstra">æœ´ç´ Dijkstra<a hidden class="anchor" aria-hidden="true" href="#æœ´ç´ dijkstra">#</a></h4>
<p>Dijkstraä¸èƒ½å¤„ç†è´Ÿæƒè¾¹ï¼š</p>
<p>






    <div class="post-img-view">
        <a data-fancybox="gallery" href="https://cdn.jsdelivr.net/gh/kennems/blog-image/20240409161050.png">
            <img src="https://cdn.jsdelivr.net/gh/kennems/blog-image/20240409161050.png" alt=""  />
        </a>
    </div>
</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-1"> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-2"> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-3"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-3"> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-4"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-4"> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-5"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-5"> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-6"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-6"> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-7"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-7"> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-8"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-8"> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-9"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-9"> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-10"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-10">10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-11"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-11">11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-12"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-12">12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-13"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-13">13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-14"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-14">14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-15"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-15">15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-16"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-16">16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-17"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-17">17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-18"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-18">18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-19"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-19">19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-20"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-20">20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-21"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-21">21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-22"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-22">22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-23"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-23">23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-24"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-24">24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-25"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-25">25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-26"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-26">26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-27"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-27">27</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span>N <span style="color:#f92672">=</span> int(<span style="color:#ae81ff">5e2</span>)<span style="color:#f92672">+</span><span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>INF <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x3f3f3f3f</span>
</span></span><span style="display:flex;"><span>g <span style="color:#f92672">=</span> [[INF]<span style="color:#f92672">*</span>N <span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> range(N)]
</span></span><span style="display:flex;"><span><span style="color:#75715e">#g = defaultdict(lambda:defaultdict(lambda:INF)) åŒæ ·çš„æ•ˆæœ</span>
</span></span><span style="display:flex;"><span>dis <span style="color:#f92672">=</span> [INF]<span style="color:#f92672">*</span>N
</span></span><span style="display:flex;"><span>st <span style="color:#f92672">=</span> [<span style="color:#66d9ef">False</span>]<span style="color:#f92672">*</span>N
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">dijkstra</span>():
</span></span><span style="display:flex;"><span>    dis[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(n<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>        t<span style="color:#f92672">=-</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>,n<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> st[j] <span style="color:#f92672">and</span> (t<span style="color:#f92672">==-</span><span style="color:#ae81ff">1</span> <span style="color:#f92672">or</span> dis[j]<span style="color:#f92672">&lt;</span>dis[t]):
</span></span><span style="display:flex;"><span>                t<span style="color:#f92672">=</span>j
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>,n<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>            dis[j]<span style="color:#f92672">=</span>min(dis[j], dis[t] <span style="color:#f92672">+</span> g[t][j])
</span></span><span style="display:flex;"><span>        st[t]<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> dis[n]<span style="color:#f92672">==</span>INF:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> dis[n]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>n, m <span style="color:#f92672">=</span> map(int, input()<span style="color:#f92672">.</span>split())
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> range(m):
</span></span><span style="display:flex;"><span>    x, y, z <span style="color:#f92672">=</span> map(int ,input()<span style="color:#f92672">.</span>split())
</span></span><span style="display:flex;"><span>    g[x][y] <span style="color:#f92672">=</span> min(g[x][y], z)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>print(dijkstra())
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="å †ä¼˜åŒ–ç‰ˆdijkstra">å †ä¼˜åŒ–ç‰ˆDijkstra<a hidden class="anchor" aria-hidden="true" href="#å †ä¼˜åŒ–ç‰ˆdijkstra">#</a></h4>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-10-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-10-1"> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-10-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-10-2"> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-10-3"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-10-3"> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-10-4"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-10-4"> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-10-5"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-10-5"> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-10-6"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-10-6"> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-10-7"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-10-7"> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-10-8"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-10-8"> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-10-9"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-10-9"> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-10-10"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-10-10">10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-10-11"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-10-11">11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-10-12"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-10-12">12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-10-13"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-10-13">13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-10-14"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-10-14">14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-10-15"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-10-15">15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-10-16"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-10-16">16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-10-17"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-10-17">17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-10-18"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-10-18">18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-10-19"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-10-19">19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-10-20"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-10-20">20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-10-21"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-10-21">21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-10-22"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-10-22">22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-10-23"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-10-23">23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-10-24"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-10-24">24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-10-25"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-10-25">25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-10-26"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-10-26">26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-10-27"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-10-27">27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-10-28"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-10-28">28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-10-29"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-10-29">29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-10-30"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-10-30">30</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-10-31"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-10-31">31</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-10-32"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-10-32">32</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-10-33"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-10-33">33</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-10-34"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-10-34">34</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-10-35"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-10-35">35</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-10-36"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-10-36">36</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-10-37"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-10-37">37</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-10-38"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-10-38">38</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-10-39"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-10-39">39</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-10-40"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-10-40">40</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-10-41"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-10-41">41</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-10-42"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-10-42">42</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-10-43"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-10-43">43</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#f92672">from</span> heapq <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> sys
</span></span><span style="display:flex;"><span>input <span style="color:#f92672">=</span> <span style="color:#66d9ef">lambda</span>:sys<span style="color:#f92672">.</span>stdin<span style="color:#f92672">.</span>readline()<span style="color:#f92672">.</span>strip()
</span></span><span style="display:flex;"><span>N <span style="color:#f92672">=</span> <span style="color:#ae81ff">150010</span>
</span></span><span style="display:flex;"><span>INF <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x3f3f3f3f</span>
</span></span><span style="display:flex;"><span>e, ne, head, w, dis<span style="color:#f92672">=</span> [<span style="color:#ae81ff">0</span>]<span style="color:#f92672">*</span>N, [<span style="color:#ae81ff">0</span>]<span style="color:#f92672">*</span>N, [<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">*</span>N, [<span style="color:#ae81ff">0</span>]<span style="color:#f92672">*</span>N, [INF]<span style="color:#f92672">*</span>N
</span></span><span style="display:flex;"><span>st <span style="color:#f92672">=</span> [<span style="color:#66d9ef">False</span>]<span style="color:#f92672">*</span>N
</span></span><span style="display:flex;"><span>idx<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">add</span>(a, b, x):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">global</span> idx
</span></span><span style="display:flex;"><span>    e[idx]<span style="color:#f92672">=</span>b
</span></span><span style="display:flex;"><span>    w[idx]<span style="color:#f92672">=</span>x
</span></span><span style="display:flex;"><span>    ne[idx]<span style="color:#f92672">=</span>head[a]
</span></span><span style="display:flex;"><span>    head[a]<span style="color:#f92672">=</span>idx
</span></span><span style="display:flex;"><span>    idx<span style="color:#f92672">+=</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">dijkstra</span>():
</span></span><span style="display:flex;"><span>    dis[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    h<span style="color:#f92672">=</span>[]
</span></span><span style="display:flex;"><span>    heappush(h, (<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>))
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> h:
</span></span><span style="display:flex;"><span>        dist, ver <span style="color:#f92672">=</span> heappop(h)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> st[ver]: <span style="color:#66d9ef">continue</span>
</span></span><span style="display:flex;"><span>        st[ver]<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>        i<span style="color:#f92672">=</span>head[ver]
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">while</span> i<span style="color:#f92672">!=-</span><span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>            j<span style="color:#f92672">=</span>e[i]
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> st[j] <span style="color:#f92672">and</span> dis[j]<span style="color:#f92672">&gt;</span>dist<span style="color:#f92672">+</span>w[i]:
</span></span><span style="display:flex;"><span>                dis[j]<span style="color:#f92672">=</span>dist<span style="color:#f92672">+</span>w[i]
</span></span><span style="display:flex;"><span>                heappush(h, (dis[j], j))
</span></span><span style="display:flex;"><span>            i<span style="color:#f92672">=</span>ne[i]
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> dis[n]<span style="color:#f92672">==</span>INF:
</span></span><span style="display:flex;"><span>        print(<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        print(dis[n])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>n, m <span style="color:#f92672">=</span> map(int, input()<span style="color:#f92672">.</span>split())
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> range(m):
</span></span><span style="display:flex;"><span>    x, y, z <span style="color:#f92672">=</span> map(int, input()<span style="color:#f92672">.</span>split())
</span></span><span style="display:flex;"><span>    add(x,y,z)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>dijkstra()
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="å¦ä¸€ç§å†™æ³•">å¦ä¸€ç§å†™æ³•<a hidden class="anchor" aria-hidden="true" href="#å¦ä¸€ç§å†™æ³•">#</a></h5>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-11-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-11-1"> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-11-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-11-2"> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-11-3"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-11-3"> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-11-4"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-11-4"> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-11-5"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-11-5"> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-11-6"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-11-6"> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-11-7"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-11-7"> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-11-8"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-11-8"> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-11-9"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-11-9"> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-11-10"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-11-10">10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-11-11"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-11-11">11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-11-12"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-11-12">12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-11-13"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-11-13">13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-11-14"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-11-14">14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-11-15"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-11-15">15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-11-16"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-11-16">16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-11-17"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-11-17">17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-11-18"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-11-18">18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-11-19"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-11-19">19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-11-20"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-11-20">20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-11-21"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-11-21">21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-11-22"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-11-22">22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-11-23"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-11-23">23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-11-24"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-11-24">24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-11-25"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-11-25">25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-11-26"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-11-26">26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-11-27"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-11-27">27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-11-28"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-11-28">28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-11-29"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-11-29">29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-11-30"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-11-30">30</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-11-31"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-11-31">31</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-11-32"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-11-32">32</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-11-33"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-11-33">33</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-11-34"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-11-34">34</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#f92672">from</span> sys <span style="color:#f92672">import</span> stdin
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> math <span style="color:#f92672">import</span> inf
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> collections <span style="color:#f92672">import</span> deque, defaultdict
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> heapq <span style="color:#f92672">import</span> heappush, heappop
</span></span><span style="display:flex;"><span>input <span style="color:#f92672">=</span> <span style="color:#66d9ef">lambda</span>:stdin<span style="color:#f92672">.</span>readline()<span style="color:#f92672">.</span>strip()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">dijkstra</span>():
</span></span><span style="display:flex;"><span>    h <span style="color:#f92672">=</span> [(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>)]
</span></span><span style="display:flex;"><span>    dis[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> h:
</span></span><span style="display:flex;"><span>        dist, ver <span style="color:#f92672">=</span> heappop(h)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> vis[ver]:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">continue</span>
</span></span><span style="display:flex;"><span>        vis[ver] <span style="color:#f92672">=</span> <span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> nx, z <span style="color:#f92672">in</span> g[ver]:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> dis[nx] <span style="color:#f92672">&gt;</span> dis[ver] <span style="color:#f92672">+</span> z:
</span></span><span style="display:flex;"><span>                dis[nx] <span style="color:#f92672">=</span> dis[ver] <span style="color:#f92672">+</span> z
</span></span><span style="display:flex;"><span>                heappush(h, (dis[nx], nx))
</span></span><span style="display:flex;"><span>                
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> dis[n]
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>n, m <span style="color:#f92672">=</span> map(int, input()<span style="color:#f92672">.</span>split())
</span></span><span style="display:flex;"><span>dis <span style="color:#f92672">=</span> [inf]<span style="color:#f92672">*</span>(n<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>vis <span style="color:#f92672">=</span> [<span style="color:#66d9ef">False</span>]<span style="color:#f92672">*</span>(n<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>g <span style="color:#f92672">=</span> defaultdict(list)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(m):
</span></span><span style="display:flex;"><span>    x, y, z <span style="color:#f92672">=</span> map(int, input()<span style="color:#f92672">.</span>split())
</span></span><span style="display:flex;"><span>    g[x]<span style="color:#f92672">.</span>append((y, z))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>res <span style="color:#f92672">=</span> dijkstra()
</span></span><span style="display:flex;"><span>print(res <span style="color:#66d9ef">if</span> res <span style="color:#f92672">!=</span> inf <span style="color:#66d9ef">else</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="bellman-ford">Bellman-Ford<a hidden class="anchor" aria-hidden="true" href="#bellman-ford">#</a></h3>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-12-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-12-1"> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-12-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-12-2"> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-12-3"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-12-3"> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-12-4"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-12-4"> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-12-5"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-12-5"> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-12-6"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-12-6"> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-12-7"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-12-7"> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-12-8"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-12-8"> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-12-9"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-12-9"> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-12-10"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-12-10">10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-12-11"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-12-11">11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-12-12"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-12-12">12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-12-13"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-12-13">13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-12-14"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-12-14">14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-12-15"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-12-15">15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-12-16"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-12-16">16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-12-17"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-12-17">17</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#75715e"># nè¡¨ç¤ºç‚¹æ•°ï¼Œmè¡¨ç¤ºè¾¹æ•°</span>
</span></span><span style="display:flex;"><span>dist <span style="color:#f92672">=</span> [float(<span style="color:#e6db74">&#39;inf&#39;</span>)] <span style="color:#f92672">*</span> (n <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>)  <span style="color:#75715e"># dist[x]å­˜å‚¨1åˆ°xçš„æœ€çŸ­è·¯è·ç¦»</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># è¾¹ï¼Œaè¡¨ç¤ºå‡ºç‚¹ï¼Œbè¡¨ç¤ºå…¥ç‚¹ï¼Œwè¡¨ç¤ºè¾¹çš„æƒé‡</span>
</span></span><span style="display:flex;"><span>edges <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># æ±‚1åˆ°nçš„æœ€çŸ­è·¯è·ç¦»ï¼Œå¦‚æœæ— æ³•ä»1èµ°åˆ°nï¼Œåˆ™è¿”å›-1ã€‚</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">bellman_ford</span>():
</span></span><span style="display:flex;"><span>    dist[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># å¦‚æœç¬¬næ¬¡è¿­ä»£ä»ç„¶ä¼šæ¾å¼›ä¸‰è§’ä¸ç­‰å¼ï¼Œå°±è¯´æ˜å­˜åœ¨ä¸€æ¡é•¿åº¦æ˜¯n+1çš„æœ€çŸ­è·¯å¾„ï¼Œç”±æŠ½å±‰åŸç†ï¼Œè·¯å¾„ä¸­è‡³å°‘å­˜åœ¨ä¸¤ä¸ªç›¸åŒçš„ç‚¹ï¼Œè¯´æ˜å›¾ä¸­å­˜åœ¨è´Ÿæƒå›è·¯ã€‚</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(n):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(m):
</span></span><span style="display:flex;"><span>            a, b, w <span style="color:#f92672">=</span> edges[j][<span style="color:#e6db74">&#39;a&#39;</span>], edges[j][<span style="color:#e6db74">&#39;b&#39;</span>], edges[j][<span style="color:#e6db74">&#39;w&#39;</span>]
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> dist[b] <span style="color:#f92672">&gt;</span> dist[a] <span style="color:#f92672">+</span> w:
</span></span><span style="display:flex;"><span>                dist[b] <span style="color:#f92672">=</span> dist[a] <span style="color:#f92672">+</span> w
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> dist[n] <span style="color:#f92672">&gt;</span> float(<span style="color:#e6db74">&#39;inf&#39;</span>) <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> dist[n]
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="spfa">SPFA<a hidden class="anchor" aria-hidden="true" href="#spfa">#</a></h3>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-13-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-13-1"> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-13-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-13-2"> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-13-3"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-13-3"> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-13-4"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-13-4"> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-13-5"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-13-5"> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-13-6"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-13-6"> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-13-7"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-13-7"> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-13-8"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-13-8"> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-13-9"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-13-9"> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-13-10"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-13-10">10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-13-11"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-13-11">11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-13-12"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-13-12">12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-13-13"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-13-13">13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-13-14"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-13-14">14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-13-15"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-13-15">15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-13-16"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-13-16">16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-13-17"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-13-17">17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-13-18"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-13-18">18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-13-19"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-13-19">19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-13-20"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-13-20">20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-13-21"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-13-21">21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-13-22"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-13-22">22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-13-23"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-13-23">23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-13-24"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-13-24">24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-13-25"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-13-25">25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-13-26"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-13-26">26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-13-27"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-13-27">27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-13-28"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-13-28">28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-13-29"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-13-29">29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-13-30"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-13-30">30</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-13-31"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-13-31">31</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-13-32"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-13-32">32</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-13-33"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-13-33">33</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-13-34"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-13-34">34</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#f92672">from</span> collections <span style="color:#f92672">import</span> defaultdict, deque
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> sys
</span></span><span style="display:flex;"><span>input <span style="color:#f92672">=</span> <span style="color:#66d9ef">lambda</span>:sys<span style="color:#f92672">.</span>stdin<span style="color:#f92672">.</span>readline()<span style="color:#f92672">.</span>strip()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>N, INF <span style="color:#f92672">=</span> int(<span style="color:#ae81ff">1e5</span><span style="color:#f92672">+</span><span style="color:#ae81ff">10</span>), <span style="color:#ae81ff">0x3f3f3f3f</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>dis, st <span style="color:#f92672">=</span> [INF]<span style="color:#f92672">*</span>N, [<span style="color:#66d9ef">False</span>]<span style="color:#f92672">*</span>N
</span></span><span style="display:flex;"><span>g<span style="color:#f92672">=</span>defaultdict(list)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">spfa</span>():
</span></span><span style="display:flex;"><span>    q<span style="color:#f92672">=</span>deque()
</span></span><span style="display:flex;"><span>    q<span style="color:#f92672">.</span>append(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>    st[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>    dis[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> q:
</span></span><span style="display:flex;"><span>        x<span style="color:#f92672">=</span>q<span style="color:#f92672">.</span>popleft()
</span></span><span style="display:flex;"><span>        st[x]<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> y, z <span style="color:#f92672">in</span> g[x]:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> dis[y]<span style="color:#f92672">&gt;</span>dis[x]<span style="color:#f92672">+</span>z:
</span></span><span style="display:flex;"><span>                dis[y]<span style="color:#f92672">=</span>dis[x]<span style="color:#f92672">+</span>z
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> st[y]:
</span></span><span style="display:flex;"><span>                    st[y]<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>                    q<span style="color:#f92672">.</span>append(y)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> dis[n]<span style="color:#f92672">==</span>INF:
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#39;impossible&#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        print(dis[n])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>n, m <span style="color:#f92672">=</span> map(int, input()<span style="color:#f92672">.</span>split())
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> range(m):
</span></span><span style="display:flex;"><span>    x, y, z <span style="color:#f92672">=</span> map(int, input()<span style="color:#f92672">.</span>split())
</span></span><span style="display:flex;"><span>    g[x]<span style="color:#f92672">.</span>append((y, z))
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>spfa()
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="åˆ¤æ–­è´Ÿç¯">åˆ¤æ–­è´Ÿç¯<a hidden class="anchor" aria-hidden="true" href="#åˆ¤æ–­è´Ÿç¯">#</a></h4>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-14-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-14-1"> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-14-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-14-2"> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-14-3"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-14-3"> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-14-4"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-14-4"> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-14-5"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-14-5"> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-14-6"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-14-6"> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-14-7"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-14-7"> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-14-8"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-14-8"> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-14-9"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-14-9"> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-14-10"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-14-10">10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-14-11"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-14-11">11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-14-12"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-14-12">12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-14-13"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-14-13">13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-14-14"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-14-14">14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-14-15"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-14-15">15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-14-16"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-14-16">16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-14-17"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-14-17">17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-14-18"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-14-18">18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-14-19"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-14-19">19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-14-20"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-14-20">20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-14-21"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-14-21">21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-14-22"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-14-22">22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-14-23"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-14-23">23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-14-24"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-14-24">24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-14-25"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-14-25">25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-14-26"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-14-26">26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-14-27"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-14-27">27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-14-28"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-14-28">28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-14-29"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-14-29">29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-14-30"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-14-30">30</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-14-31"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-14-31">31</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-14-32"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-14-32">32</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-14-33"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-14-33">33</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-14-34"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-14-34">34</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-14-35"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-14-35">35</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-14-36"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-14-36">36</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-14-37"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-14-37">37</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-14-38"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-14-38">38</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-14-39"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-14-39">39</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#f92672">from</span> sys <span style="color:#f92672">import</span> stdin
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> collections <span style="color:#f92672">import</span> deque, defaultdict
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> math <span style="color:#f92672">import</span> inf
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>input <span style="color:#f92672">=</span> <span style="color:#66d9ef">lambda</span>:stdin<span style="color:#f92672">.</span>readline()<span style="color:#f92672">.</span>strip()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">spfa</span>():
</span></span><span style="display:flex;"><span>    q <span style="color:#f92672">=</span> deque()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>, n<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>        q<span style="color:#f92672">.</span>append(i)
</span></span><span style="display:flex;"><span>        st[i] <span style="color:#f92672">=</span> <span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> q:
</span></span><span style="display:flex;"><span>        x <span style="color:#f92672">=</span> q<span style="color:#f92672">.</span>popleft()
</span></span><span style="display:flex;"><span>        st[x] <span style="color:#f92672">=</span> <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> y, z <span style="color:#f92672">in</span> g[x]:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> dis[y] <span style="color:#f92672">&gt;</span> dis[x] <span style="color:#f92672">+</span> z:
</span></span><span style="display:flex;"><span>                dis[y] <span style="color:#f92672">=</span> dis[x] <span style="color:#f92672">+</span> z
</span></span><span style="display:flex;"><span>                cnt[y] <span style="color:#f92672">=</span> cnt[x] <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> cnt[y] <span style="color:#f92672">&gt;=</span> n:
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> st[y]:
</span></span><span style="display:flex;"><span>                    q<span style="color:#f92672">.</span>append(y)
</span></span><span style="display:flex;"><span>                    st[y] <span style="color:#f92672">=</span> <span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>n, m <span style="color:#f92672">=</span> map(int, input()<span style="color:#f92672">.</span>split())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>g <span style="color:#f92672">=</span> defaultdict(list)
</span></span><span style="display:flex;"><span>cnt <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0</span>]<span style="color:#f92672">*</span>(n<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>st <span style="color:#f92672">=</span> [<span style="color:#66d9ef">False</span>]<span style="color:#f92672">*</span>(n<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>dis <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0</span>]<span style="color:#f92672">*</span>(n<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(m):
</span></span><span style="display:flex;"><span>    x, y, z <span style="color:#f92672">=</span> map(int, input()<span style="color:#f92672">.</span>split())
</span></span><span style="display:flex;"><span>    g[x]<span style="color:#f92672">.</span>append((y, z))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>res <span style="color:#f92672">=</span> spfa()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;Yes&#34;</span> <span style="color:#66d9ef">if</span> res <span style="color:#66d9ef">else</span> <span style="color:#e6db74">&#34;No&#34;</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="floyd">floyd<a hidden class="anchor" aria-hidden="true" href="#floyd">#</a></h3>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-1"> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-2"> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-3"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-3"> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-4"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-4"> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-5"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-5"> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-6"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-6"> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-7"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-7"> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-8"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-8"> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-9"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-9"> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-10"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-10">10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-11"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-11">11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-12"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-12">12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-13"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-13">13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-14"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-14">14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-15"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-15">15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-16"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-16">16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-17"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-17">17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-18"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-18">18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-19"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-19">19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-20"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-20">20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-21"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-21">21</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#f92672">from</span> sys <span style="color:#f92672">import</span> stdin
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> math <span style="color:#f92672">import</span> inf
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">floyd</span>():
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> k <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>, n<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>, n<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>, n<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>                d[i][j] <span style="color:#f92672">=</span> min(d[i][j], d[i][k] <span style="color:#f92672">+</span> d[k][j])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>n, m, k <span style="color:#f92672">=</span> map(int, input()<span style="color:#f92672">.</span>split())
</span></span><span style="display:flex;"><span>d <span style="color:#f92672">=</span> [[<span style="color:#ae81ff">0</span> <span style="color:#66d9ef">if</span> i<span style="color:#f92672">==</span>j <span style="color:#66d9ef">else</span> inf <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(n<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)] <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(n<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(m):
</span></span><span style="display:flex;"><span>    x, y, z <span style="color:#f92672">=</span> map(int, input()<span style="color:#f92672">.</span>split())
</span></span><span style="display:flex;"><span>    d[x][y] <span style="color:#f92672">=</span> min(d[x][y], z)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>floyd()
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(k):
</span></span><span style="display:flex;"><span>    x, y <span style="color:#f92672">=</span> map(int, input()<span style="color:#f92672">.</span>split())
</span></span><span style="display:flex;"><span>    print(d[x][y] <span style="color:#66d9ef">if</span> d[x][y]<span style="color:#f92672">!=</span>inf <span style="color:#66d9ef">else</span> <span style="color:#e6db74">&#34;impossible&#34;</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="prim">Prim<a hidden class="anchor" aria-hidden="true" href="#prim">#</a></h3>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-1"> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-2"> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-3"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-3"> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-4"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-4"> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-5"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-5"> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-6"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-6"> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-7"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-7"> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-8"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-8"> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-9"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-9"> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-10"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-10">10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-11"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-11">11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-12"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-12">12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-13"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-13">13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-14"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-14">14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-15"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-15">15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-16"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-16">16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-17"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-17">17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-18"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-18">18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-19"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-19">19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-20"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-20">20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-21"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-21">21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-22"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-22">22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-23"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-23">23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-24"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-24">24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-25"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-25">25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-26"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-26">26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-27"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-27">27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-28"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-28">28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-29"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-29">29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-30"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-30">30</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-31"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-31">31</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-32"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-32">32</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-33"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-33">33</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-34"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-34">34</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-35"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-35">35</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-36"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-36">36</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#f92672">from</span> math <span style="color:#f92672">import</span> inf
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sys <span style="color:#f92672">import</span> stdin
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">prim</span>():
</span></span><span style="display:flex;"><span>    res <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    dis[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(n):
</span></span><span style="display:flex;"><span>        t <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>, n<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> st[j] <span style="color:#f92672">and</span> (t<span style="color:#f92672">==-</span><span style="color:#ae81ff">1</span> <span style="color:#f92672">or</span> dis[t] <span style="color:#f92672">&gt;</span> dis[j]):
</span></span><span style="display:flex;"><span>                t <span style="color:#f92672">=</span> j
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> i <span style="color:#f92672">and</span> dis[t]<span style="color:#f92672">==</span>inf:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> inf
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> i:
</span></span><span style="display:flex;"><span>            res <span style="color:#f92672">+=</span> dis[t]
</span></span><span style="display:flex;"><span>        st[t] <span style="color:#f92672">=</span> <span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>, n<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>            dis[j] <span style="color:#f92672">=</span> min(dis[j], g[t][j])
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> res
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>n, m <span style="color:#f92672">=</span> map(int, input()<span style="color:#f92672">.</span>split())
</span></span><span style="display:flex;"><span>g <span style="color:#f92672">=</span> [[inf]<span style="color:#f92672">*</span>(n<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>) <span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> range(n<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)]
</span></span><span style="display:flex;"><span>dis <span style="color:#f92672">=</span> [inf]<span style="color:#f92672">*</span>(n<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>st <span style="color:#f92672">=</span> [<span style="color:#66d9ef">False</span>]<span style="color:#f92672">*</span>(n<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(m):
</span></span><span style="display:flex;"><span>    u, v, w <span style="color:#f92672">=</span> map(int, input()<span style="color:#f92672">.</span>split())
</span></span><span style="display:flex;"><span>    g[u][v] <span style="color:#f92672">=</span> g[v][u] <span style="color:#f92672">=</span> min(w, g[u][v])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>res <span style="color:#f92672">=</span> prim()
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> res<span style="color:#f92672">==</span>inf:
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;impossible&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>    print(res)
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="kruskal">Kruskal<a hidden class="anchor" aria-hidden="true" href="#kruskal">#</a></h3>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-1"> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-2"> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-3"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-3"> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-4"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-4"> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-5"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-5"> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-6"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-6"> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-7"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-7"> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-8"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-8"> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-9"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-9"> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-10"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-10">10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-11"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-11">11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-12"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-12">12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-13"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-13">13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-14"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-14">14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-15"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-15">15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-16"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-16">16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-17"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-17">17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-18"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-18">18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-19"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-19">19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-20"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-20">20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-21"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-21">21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-22"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-22">22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-23"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-23">23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-24"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-24">24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-25"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-25">25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-26"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-26">26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-27"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-27">27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-28"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-28">28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-29"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-29">29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-30"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-30">30</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-31"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-31">31</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-32"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-32">32</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-33"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-33">33</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-34"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-34">34</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-35"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-35">35</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-36"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-36">36</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-37"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-37">37</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#f92672">import</span> sys
</span></span><span style="display:flex;"><span>input <span style="color:#f92672">=</span> <span style="color:#66d9ef">lambda</span>:sys<span style="color:#f92672">.</span>stdin<span style="color:#f92672">.</span>readline()<span style="color:#f92672">.</span>strip()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">find</span>(x):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> p[x] <span style="color:#f92672">!=</span> x:
</span></span><span style="display:flex;"><span>        p[x] <span style="color:#f92672">=</span> p[p[x]]
</span></span><span style="display:flex;"><span>        x <span style="color:#f92672">=</span> p[x]
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> x
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">kruskal</span>():
</span></span><span style="display:flex;"><span>    res, cnt <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    ans <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> u, v, w <span style="color:#f92672">in</span> g:
</span></span><span style="display:flex;"><span>        fu, fv <span style="color:#f92672">=</span> find(u), find(v)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> fu <span style="color:#f92672">!=</span> fv:
</span></span><span style="display:flex;"><span>            res <span style="color:#f92672">+=</span> w
</span></span><span style="display:flex;"><span>            cnt <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>            p[fu] <span style="color:#f92672">=</span> fv
</span></span><span style="display:flex;"><span>            ans<span style="color:#f92672">.</span>append((u, v, w))
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    ans<span style="color:#f92672">.</span>sort()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> cnt <span style="color:#f92672">==</span> n<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>        print(res)
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># print(ans) # è®°å½•é€‰æ‹©çš„æ˜¯å“ªäº›è¾¹</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;impossible&#34;</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>n, m <span style="color:#f92672">=</span> map(int, input()<span style="color:#f92672">.</span>split())
</span></span><span style="display:flex;"><span>g <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>p <span style="color:#f92672">=</span> [i <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(n<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)]
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(m):
</span></span><span style="display:flex;"><span>    u, v, w <span style="color:#f92672">=</span> map(int, input()<span style="color:#f92672">.</span>split())
</span></span><span style="display:flex;"><span>    g<span style="color:#f92672">.</span>append((u, v, w))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>g<span style="color:#f92672">.</span>sort(key <span style="color:#f92672">=</span> <span style="color:#66d9ef">lambda</span> e:e[<span style="color:#ae81ff">2</span>])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>kruskal()
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="æŸ“è‰²æ³•">æŸ“è‰²æ³•<a hidden class="anchor" aria-hidden="true" href="#æŸ“è‰²æ³•">#</a></h3>
<p>ä½¿ç”¨äº†æ·±åº¦ä¼˜å…ˆæœç´¢ç®—æ³•ï¼ˆDFSï¼‰æ¥åˆ¤æ–­ä¸€ä¸ªå›¾æ˜¯å¦æ˜¯äºŒåˆ†å›¾</p>
<p><strong>äºŒåˆ†å›¾</strong>ï¼šé¡¶ç‚¹åˆ†ä¸ºä¸¤ä¸ªé›†åˆï¼Œè¾¹ä»…å­˜åœ¨äºä¸¤ä¸ªä¸åŒçš„é›†åˆä¸­ï¼Œè€Œé›†åˆå†…éƒ¨éƒ½æ²¡æœ‰è¾¹ã€‚</p>
<p>Pythonä¼˜å…ˆä½¿ç”¨BFSï¼Œå› ä¸ºDFSä¼šå‡ºç°å„ç§é—®é¢˜ï¼Œçˆ†æ ˆï¼Œæ®µé”™è¯¯ï¼ˆè¿˜æ²¡ææ¸…æ¥šåŸå› ï¼‰ç­‰</p>
<p>è¿™æ®µä»£ç ä½¿ç”¨äº†æŸ“è‰²æ³•æ¥åˆ¤æ–­ä¸€ä¸ªæ— å‘å›¾æ˜¯å¦ä¸ºäºŒåˆ†å›¾ã€‚ä¸‹é¢æˆ‘æ¥è§£é‡Šä¸€ä¸‹ï¼š</p>
<p><strong>é¢˜ç›®å¤§æ„ï¼š</strong>
ç»™å®šä¸€ä¸ªæ— å‘å›¾ï¼Œåˆ¤æ–­æ˜¯å¦å¯ä»¥å°†å…¶é¡¶ç‚¹é›†åˆåˆ’åˆ†ä¸ºä¸¤ä¸ªä¸ç›¸äº¤çš„å­é›†ï¼Œä½¿å¾—æ¯æ¡è¾¹çš„ä¸¤ä¸ªç«¯ç‚¹åˆ†åˆ«å±äºè¿™ä¸¤ä¸ªå­é›†ã€‚å¦‚æœå¯ä»¥ï¼Œåˆ™è¾“å‡º&quot;Yes&quot;ï¼Œå¦åˆ™è¾“å‡º&quot;No&quot;ã€‚</p>
<p><strong>å®ç°æ€è·¯ï¼š</strong></p>
<ol>
<li>ä½¿ç”¨é‚»æ¥è¡¨ <code>g</code> æ¥è¡¨ç¤ºæ— å‘å›¾ï¼Œå…¶ä¸­ <code>g[u]</code> å­˜å‚¨ä¸é¡¶ç‚¹ <code>u</code> ç›¸è¿çš„æ‰€æœ‰é¡¶ç‚¹ã€‚</li>
<li>å®šä¹‰ä¸€ä¸ªæ•°ç»„ <code>color</code> æ¥æ ‡è®°æ¯ä¸ªé¡¶ç‚¹çš„æŸ“è‰²æƒ…å†µï¼Œåˆå§‹å€¼è®¾ä¸º <code>-1</code> è¡¨ç¤ºæœªæŸ“è‰²ã€‚</li>
<li>å®šä¹‰ä¸€ä¸ª BFS å‡½æ•° <code>bfs(u, c)</code>ï¼Œå…¶ä¸­ <code>u</code> è¡¨ç¤ºèµ·å§‹é¡¶ç‚¹ï¼Œ<code>c</code> è¡¨ç¤ºåˆå§‹é¢œè‰²ã€‚è¯¥å‡½æ•°ä½¿ç”¨ BFS éå†å›¾ï¼Œå¹¶å°†é¡¶ç‚¹æŸ“è‰²ï¼Œä¿è¯ç›¸é‚»é¡¶ç‚¹é¢œè‰²ä¸åŒã€‚</li>
<li>åœ¨ä¸»ä½“éƒ¨åˆ†ï¼Œéå†æ‰€æœ‰é¡¶ç‚¹ï¼Œå¯¹äºæ¯ä¸ªæœªæŸ“è‰²çš„é¡¶ç‚¹ï¼Œè°ƒç”¨ <code>bfs</code> å‡½æ•°è¿›è¡ŒæŸ“è‰²ã€‚å¦‚æœæŸ“è‰²è¿‡ç¨‹ä¸­å‘ç°ç›¸é‚»é¡¶ç‚¹é¢œè‰²ç›¸åŒï¼Œåˆ™è¿”å› &ldquo;No&rdquo;ï¼Œè¡¨ç¤ºæ— æ³•åˆ’åˆ†ä¸ºäºŒåˆ†å›¾ï¼›å¦åˆ™è¿”å› &ldquo;Yes&rdquo;ã€‚</li>
</ol>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-18-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-18-1"> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-18-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-18-2"> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-18-3"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-18-3"> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-18-4"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-18-4"> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-18-5"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-18-5"> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-18-6"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-18-6"> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-18-7"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-18-7"> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-18-8"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-18-8"> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-18-9"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-18-9"> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-18-10"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-18-10">10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-18-11"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-18-11">11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-18-12"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-18-12">12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-18-13"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-18-13">13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-18-14"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-18-14">14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-18-15"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-18-15">15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-18-16"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-18-16">16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-18-17"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-18-17">17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-18-18"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-18-18">18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-18-19"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-18-19">19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-18-20"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-18-20">20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-18-21"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-18-21">21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-18-22"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-18-22">22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-18-23"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-18-23">23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-18-24"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-18-24">24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-18-25"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-18-25">25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-18-26"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-18-26">26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-18-27"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-18-27">27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-18-28"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-18-28">28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-18-29"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-18-29">29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-18-30"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-18-30">30</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-18-31"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-18-31">31</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-18-32"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-18-32">32</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-18-33"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-18-33">33</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-18-34"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-18-34">34</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-18-35"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-18-35">35</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-18-36"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-18-36">36</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-18-37"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-18-37">37</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-18-38"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-18-38">38</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#f92672">import</span> sys
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> collections <span style="color:#f92672">import</span> deque, defaultdict
</span></span><span style="display:flex;"><span>input <span style="color:#f92672">=</span> <span style="color:#66d9ef">lambda</span>:sys<span style="color:#f92672">.</span>stdin<span style="color:#f92672">.</span>readline()<span style="color:#f92672">.</span>strip()
</span></span><span style="display:flex;"><span>N <span style="color:#f92672">=</span> int(<span style="color:#ae81ff">1e5</span>)<span style="color:#f92672">+</span><span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>g <span style="color:#f92672">=</span> defaultdict(list)
</span></span><span style="display:flex;"><span>color <span style="color:#f92672">=</span> [<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">*</span>N
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">bfs</span>(u, c):
</span></span><span style="display:flex;"><span>    color[u] <span style="color:#f92672">=</span> c
</span></span><span style="display:flex;"><span>    q <span style="color:#f92672">=</span> deque()
</span></span><span style="display:flex;"><span>    q<span style="color:#f92672">.</span>append((u, c))
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> q:
</span></span><span style="display:flex;"><span>        cur, col <span style="color:#f92672">=</span> q<span style="color:#f92672">.</span>popleft()
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> nx <span style="color:#f92672">in</span> g[cur]:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> color[nx]<span style="color:#f92672">==-</span><span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>                color[nx] <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">-</span>col
</span></span><span style="display:flex;"><span>                q<span style="color:#f92672">.</span>append((nx, <span style="color:#ae81ff">1</span><span style="color:#f92672">-</span>col))
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">elif</span> color[nx]<span style="color:#f92672">==</span>col:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>n, m <span style="color:#f92672">=</span> map(int, input()<span style="color:#f92672">.</span>split())
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(m):
</span></span><span style="display:flex;"><span>    u, v <span style="color:#f92672">=</span> map(int, input()<span style="color:#f92672">.</span>split())
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># if u==v: #***è‡ªç¯ä¸èƒ½å»æ‰***</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#     continue</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> u <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> g[v]:
</span></span><span style="display:flex;"><span>        g[v]<span style="color:#f92672">.</span>append(u)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> v <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> g[u]:
</span></span><span style="display:flex;"><span>        g[u]<span style="color:#f92672">.</span>append(v)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>, n<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> color[i]<span style="color:#f92672">==-</span><span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> bfs(i, <span style="color:#ae81ff">0</span>):
</span></span><span style="display:flex;"><span>            print(<span style="color:#e6db74">&#34;No&#34;</span>)
</span></span><span style="display:flex;"><span>            exit()
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;Yes&#34;</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="åŒˆç‰™åˆ©ç®—æ³•">åŒˆç‰™åˆ©ç®—æ³•<a hidden class="anchor" aria-hidden="true" href="#åŒˆç‰™åˆ©ç®—æ³•">#</a></h3>
<p><strong>é¢˜ç›®å¤§æ„ï¼š</strong>
ç»™å®šä¸€ä¸ªäºŒåˆ†å›¾ï¼Œå…¶ä¸­å·¦ä¾§é¡¶ç‚¹é›†åˆä¸º (N_1)ï¼Œå³ä¾§é¡¶ç‚¹é›†åˆä¸º (N_2)ï¼Œå›¾ä¸­å­˜åœ¨ä¸€äº›è¾¹ã€‚éœ€è¦æ‰¾åˆ°å°½å¯èƒ½å¤šçš„åŒ¹é…ï¼Œä½¿å¾—å·¦ä¾§çš„æ¯ä¸ªé¡¶ç‚¹æœ€å¤šä¸ä¸€ä¸ªå³ä¾§çš„é¡¶ç‚¹ç›¸è¿ï¼Œè€Œå³ä¾§çš„æ¯ä¸ªé¡¶ç‚¹æœ€å¤šä¸ä¸€ä¸ªå·¦ä¾§çš„é¡¶ç‚¹ç›¸è¿ã€‚</p>
<p><strong>å®ç°æ€è·¯ï¼š</strong></p>
<ol>
<li>ä½¿ç”¨ä¸€ä¸ªäºŒç»´æ•°ç»„ <code>g</code> å­˜å‚¨å›¾çš„é‚»æ¥è¡¨è¡¨ç¤ºã€‚å…¶ä¸­ <code>g[u]</code> è¡¨ç¤ºä¸å·¦ä¾§é¡¶ç‚¹ <code>u</code> ç›¸è¿çš„æ‰€æœ‰å³ä¾§é¡¶ç‚¹çš„é›†åˆã€‚</li>
<li>å®šä¹‰ä¸€ä¸ªå‡½æ•° <code>find(x)</code>ï¼Œç”¨äºä»å·¦ä¾§é¡¶ç‚¹ <code>x</code> å¼€å§‹å°è¯•å¯»æ‰¾å¢å¹¿è·¯å¾„ï¼Œå¦‚æœæ‰¾åˆ°äº†å¢å¹¿è·¯å¾„å°±è¿”å› <code>True</code>ï¼Œå¦åˆ™è¿”å› <code>False</code>ã€‚</li>
<li>åœ¨ä¸»ä½“éƒ¨åˆ†ï¼Œéå†å·¦ä¾§çš„æ¯ä¸ªé¡¶ç‚¹ï¼Œå¯¹æ¯ä¸ªé¡¶ç‚¹è°ƒç”¨ <code>find</code> å‡½æ•°è¿›è¡ŒåŒ¹é…ï¼Œè‹¥æˆåŠŸåŒ¹é…ï¼Œåˆ™åŒ¹é…æ•°åŠ ä¸€ã€‚</li>
</ol>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-19-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-19-1"> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-19-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-19-2"> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-19-3"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-19-3"> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-19-4"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-19-4"> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-19-5"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-19-5"> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-19-6"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-19-6"> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-19-7"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-19-7"> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-19-8"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-19-8"> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-19-9"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-19-9"> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-19-10"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-19-10">10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-19-11"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-19-11">11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-19-12"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-19-12">12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-19-13"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-19-13">13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-19-14"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-19-14">14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-19-15"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-19-15">15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-19-16"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-19-16">16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-19-17"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-19-17">17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-19-18"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-19-18">18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-19-19"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-19-19">19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-19-20"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-19-20">20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-19-21"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-19-21">21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-19-22"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-19-22">22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-19-23"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-19-23">23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-19-24"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-19-24">24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-19-25"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-19-25">25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-19-26"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-19-26">26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-19-27"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-19-27">27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-19-28"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-19-28">28</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#f92672">from</span> sys <span style="color:#f92672">import</span> stdin
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> collections <span style="color:#f92672">import</span> defaultdict
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">find</span>(u):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> v <span style="color:#f92672">in</span> g[u]:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> st[v]:
</span></span><span style="display:flex;"><span>            st[v] <span style="color:#f92672">=</span> <span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> mat[v]<span style="color:#f92672">==</span><span style="color:#ae81ff">0</span> <span style="color:#f92672">or</span> find(mat[v]):
</span></span><span style="display:flex;"><span>                mat[v] <span style="color:#f92672">=</span> u
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>n1, n2, m <span style="color:#f92672">=</span> map(int, input()<span style="color:#f92672">.</span>split())
</span></span><span style="display:flex;"><span>mat <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0</span>]<span style="color:#f92672">*</span>(n2 <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>g <span style="color:#f92672">=</span> defaultdict(list)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(m):
</span></span><span style="display:flex;"><span>    u, v <span style="color:#f92672">=</span> map(int, input()<span style="color:#f92672">.</span>split())
</span></span><span style="display:flex;"><span>    g[u]<span style="color:#f92672">.</span>append(v)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>res <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>, n1<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>    st <span style="color:#f92672">=</span> [<span style="color:#66d9ef">False</span>]<span style="color:#f92672">*</span>(n2 <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> find(i):
</span></span><span style="display:flex;"><span>        res <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>print(res)
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="dfsä¹‹è¿é€šæ€§">DFSä¹‹è¿é€šæ€§<a hidden class="anchor" aria-hidden="true" href="#dfsä¹‹è¿é€šæ€§">#</a></h3>
<p><strong>é¢˜æ„</strong>ï¼šåœ¨ä¸€ä¸ªç»™å®šè¿·å®«ä¸­ï¼Œä»èµ·ç‚¹Aåˆ°ç»ˆç‚¹Bæ˜¯å¦å­˜åœ¨ä¸€æ¡è·¯å¾„çš„é—®é¢˜ã€‚è¿·å®«ç”±ä¸€ä¸ªç”± <code>'.'</code> å’Œ <code>'#'</code> æ„æˆçš„çŸ©é˜µè¡¨ç¤ºï¼Œå…¶ä¸­ <code>'.'</code> è¡¨ç¤ºå¯é€šè¡Œçš„æ ¼ç‚¹ï¼Œ<code>'#'</code> è¡¨ç¤ºä¸å¯é€šè¡Œçš„æ ¼ç‚¹ã€‚Extenseåªèƒ½å‘ä¸œå—è¥¿åŒ—å››ä¸ªæ–¹å‘ç§»åŠ¨åˆ°ç›¸é‚»çš„å¯é€šè¡Œæ ¼ç‚¹ä¸Šï¼Œè€Œä¸”è¦æ±‚èµ·ç‚¹å’Œç»ˆç‚¹éƒ½æ˜¯å¯é€šè¡Œçš„ã€‚ä½ éœ€è¦ç¼–å†™ä¸€ä¸ªç¨‹åºæ¥ç¡®å®šåœ¨ç»™å®šçš„è¿·å®«ä¸­ï¼Œæ˜¯å¦å­˜åœ¨ä¸€æ¡ä»Aåˆ°Bçš„è·¯å¾„ã€‚</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-20-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-20-1"> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-20-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-20-2"> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-20-3"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-20-3"> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-20-4"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-20-4"> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-20-5"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-20-5"> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-20-6"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-20-6"> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-20-7"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-20-7"> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-20-8"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-20-8"> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-20-9"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-20-9"> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-20-10"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-20-10">10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-20-11"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-20-11">11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-20-12"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-20-12">12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-20-13"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-20-13">13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-20-14"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-20-14">14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-20-15"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-20-15">15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-20-16"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-20-16">16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-20-17"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-20-17">17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-20-18"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-20-18">18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-20-19"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-20-19">19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-20-20"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-20-20">20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-20-21"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-20-21">21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-20-22"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-20-22">22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-20-23"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-20-23">23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-20-24"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-20-24">24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-20-25"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-20-25">25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-20-26"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-20-26">26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-20-27"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-20-27">27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-20-28"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-20-28">28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-20-29"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-20-29">29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-20-30"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-20-30">30</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-20-31"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-20-31">31</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-20-32"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-20-32">32</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-20-33"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-20-33">33</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-20-34"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-20-34">34</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-20-35"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-20-35">35</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-20-36"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-20-36">36</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-20-37"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-20-37">37</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-20-38"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-20-38">38</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-20-39"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-20-39">39</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#f92672">import</span> sys
</span></span><span style="display:flex;"><span>input <span style="color:#f92672">=</span> <span style="color:#66d9ef">lambda</span>:sys<span style="color:#f92672">.</span>stdin<span style="color:#f92672">.</span>readline()<span style="color:#f92672">.</span>strip()
</span></span><span style="display:flex;"><span>sys<span style="color:#f92672">.</span>setrecursionlimit(<span style="color:#ae81ff">150000</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>dir <span style="color:#f92672">=</span> [(<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>), (<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>), (<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>), (<span style="color:#ae81ff">0</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)]
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">dfs</span>(x, y):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> g[x][y]<span style="color:#f92672">==</span><span style="color:#e6db74">&#39;#&#39;</span> <span style="color:#f92672">or</span> vis[x][y]:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (x, y)<span style="color:#f92672">==</span>end:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>    vis[x][y] <span style="color:#f92672">=</span> <span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">4</span>):
</span></span><span style="display:flex;"><span>        a, b <span style="color:#f92672">=</span> x <span style="color:#f92672">+</span> dir[i][<span style="color:#ae81ff">0</span>], y<span style="color:#f92672">+</span>dir[i][<span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> <span style="color:#ae81ff">0</span><span style="color:#f92672">&lt;=</span>a<span style="color:#f92672">&lt;</span>n <span style="color:#f92672">and</span> <span style="color:#ae81ff">0</span><span style="color:#f92672">&lt;=</span>b<span style="color:#f92672">&lt;</span>n:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> dfs(a, b): <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>k <span style="color:#f92672">=</span> int(input())
</span></span><span style="display:flex;"><span>N <span style="color:#f92672">=</span> <span style="color:#ae81ff">110</span>
</span></span><span style="display:flex;"><span>g <span style="color:#f92672">=</span> [[] <span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> range(N)]
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> range(k):
</span></span><span style="display:flex;"><span>    n <span style="color:#f92672">=</span> int(input())
</span></span><span style="display:flex;"><span>    vis <span style="color:#f92672">=</span> [[<span style="color:#66d9ef">False</span>]<span style="color:#f92672">*</span>(n<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>) <span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> range(n<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)]
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(n):
</span></span><span style="display:flex;"><span>        g[i] <span style="color:#f92672">=</span> list(input())
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    x1, y1, x2, y2 <span style="color:#f92672">=</span> map(int, input()<span style="color:#f92672">.</span>split())
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    end <span style="color:#f92672">=</span> (x2, y2)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> dfs(x1, y1):
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;YES&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;NO&#34;</span>)
</span></span><span style="display:flex;"><span>    
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="é­”æ¿">é­”æ¿<a hidden class="anchor" aria-hidden="true" href="#é­”æ¿">#</a></h3>
<p><strong>é¢˜ç›®å¤§æ„</strong>ï¼šç»™å®šä¸€ä¸ª 8 ä¸ªæ ¼å­çš„é­”æ¿ï¼Œæ¯ä¸ªæ ¼å­æœ‰ä¸€ç§é¢œè‰²ï¼Œç”¨ 1 åˆ° 8 çš„æ•´æ•°è¡¨ç¤ºã€‚æœ‰ä¸‰ç§åŸºæœ¬æ“ä½œå¯ä»¥æ”¹å˜é­”æ¿çš„çŠ¶æ€ï¼šAï¼šäº¤æ¢ä¸Šä¸‹ä¸¤è¡Œï¼›Bï¼šå°†æœ€å³è¾¹çš„ä¸€åˆ—æ’å…¥åˆ°æœ€å·¦è¾¹ï¼›Cï¼šé­”æ¿ä¸­å¤®å¯¹çš„4ä¸ªæ•°ä½œé¡ºæ—¶é’ˆæ—‹è½¬ã€‚ç°åœ¨ç»™å®šä¸€ä¸ªç›®æ ‡çŠ¶æ€ï¼Œæ±‚ç”¨æœ€å°‘çš„åŸºæœ¬æ“ä½œå®ŒæˆåŸºæœ¬çŠ¶æ€åˆ°ç›®æ ‡çŠ¶æ€çš„è½¬æ¢ï¼Œå¹¶è¾“å‡ºåŸºæœ¬æ“ä½œåºåˆ—ã€‚</p>
<p><strong>å®ç°æ€è·¯</strong>ï¼š</p>
<ol>
<li>é¦–å…ˆå®ç°ä¸‰ç§åŸºæœ¬æ“ä½œ Aã€Bã€C çš„å‡½æ•°ã€‚</li>
<li>ä½¿ç”¨å¹¿åº¦ä¼˜å…ˆæœç´¢ï¼ˆBFSï¼‰ç®—æ³•æ¥æ‰¾åˆ°ä»åŸºæœ¬çŠ¶æ€åˆ°ç›®æ ‡çŠ¶æ€çš„æœ€çŸ­æ“ä½œåºåˆ—ã€‚</li>
<li>ä½¿ç”¨ä¸€ä¸ªé˜Ÿåˆ—å­˜å‚¨å¾…å¤„ç†çŠ¶æ€ï¼Œå¹¶ä½¿ç”¨ä¸€ä¸ªå­—å…¸è®°å½•æ¯ä¸ªçŠ¶æ€çš„å‰é©±çŠ¶æ€å’Œæ‰§è¡Œçš„æ“ä½œã€‚</li>
<li>åœ¨æ¯ä¸€æ­¥ä¸­ï¼Œå°è¯•å¯¹å½“å‰çŠ¶æ€è¿›è¡Œä¸‰ç§åŸºæœ¬æ“ä½œï¼Œå¾—åˆ°æ–°çš„çŠ¶æ€ï¼Œå¦‚æœæ–°çŠ¶æ€æœªè¢«è®¿é—®è¿‡ï¼Œåˆ™å°†å…¶åŠ å…¥é˜Ÿåˆ—ï¼Œå¹¶è®°å½•å…¶å‰é©±çŠ¶æ€å’Œæ“ä½œã€‚</li>
<li>å½“æ‰¾åˆ°ç›®æ ‡çŠ¶æ€æ—¶ï¼Œæ ¹æ®å‰é©±çŠ¶æ€å›æº¯å¾—åˆ°æœ€çŸ­æ“ä½œåºåˆ—ã€‚</li>
<li>è¾“å‡ºæœ€çŸ­æ“ä½œåºåˆ—çš„é•¿åº¦å’Œå…·ä½“æ“ä½œåºåˆ—ã€‚</li>
</ol>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-21-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-21-1"> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-21-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-21-2"> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-21-3"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-21-3"> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-21-4"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-21-4"> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-21-5"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-21-5"> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-21-6"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-21-6"> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-21-7"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-21-7"> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-21-8"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-21-8"> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-21-9"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-21-9"> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-21-10"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-21-10">10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-21-11"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-21-11">11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-21-12"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-21-12">12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-21-13"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-21-13">13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-21-14"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-21-14">14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-21-15"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-21-15">15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-21-16"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-21-16">16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-21-17"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-21-17">17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-21-18"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-21-18">18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-21-19"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-21-19">19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-21-20"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-21-20">20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-21-21"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-21-21">21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-21-22"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-21-22">22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-21-23"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-21-23">23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-21-24"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-21-24">24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-21-25"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-21-25">25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-21-26"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-21-26">26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-21-27"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-21-27">27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-21-28"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-21-28">28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-21-29"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-21-29">29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-21-30"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-21-30">30</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-21-31"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-21-31">31</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-21-32"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-21-32">32</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-21-33"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-21-33">33</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-21-34"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-21-34">34</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-21-35"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-21-35">35</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-21-36"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-21-36">36</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-21-37"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-21-37">37</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-21-38"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-21-38">38</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-21-39"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-21-39">39</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-21-40"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-21-40">40</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#f92672">from</span> collections <span style="color:#f92672">import</span> deque
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">A</span>(t):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> t[::<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">B</span>(t):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> t[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">+</span> t[:<span style="color:#ae81ff">3</span>] <span style="color:#f92672">+</span> t[<span style="color:#ae81ff">5</span>:] <span style="color:#f92672">+</span> t[<span style="color:#ae81ff">4</span>]
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">C</span>(t):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> t[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">+</span> t[<span style="color:#ae81ff">6</span>] <span style="color:#f92672">+</span> t[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">+</span> t[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">+</span> t[<span style="color:#ae81ff">4</span>] <span style="color:#f92672">+</span> t[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">+</span> t[<span style="color:#ae81ff">5</span>] <span style="color:#f92672">+</span> t[<span style="color:#ae81ff">7</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>pre <span style="color:#f92672">=</span> dict()
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">bfs</span>():
</span></span><span style="display:flex;"><span>    q <span style="color:#f92672">=</span> deque()
</span></span><span style="display:flex;"><span>    q<span style="color:#f92672">.</span>append(st)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> q:
</span></span><span style="display:flex;"><span>        t <span style="color:#f92672">=</span> q<span style="color:#f92672">.</span>popleft()
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> t<span style="color:#f92672">==</span>ed:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">break</span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        m <span style="color:#f92672">=</span> [A(t), B(t), C(t)]
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">3</span>):
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> m[i] <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> pre:
</span></span><span style="display:flex;"><span>                pre[m[i]] <span style="color:#f92672">=</span> (chr(<span style="color:#ae81ff">65</span><span style="color:#f92672">+</span>i), t)
</span></span><span style="display:flex;"><span>                q<span style="color:#f92672">.</span>append(m[i])
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>nums <span style="color:#f92672">=</span> input()<span style="color:#f92672">.</span>split()
</span></span><span style="display:flex;"><span>ed <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span><span style="color:#f92672">.</span>join(nums)
</span></span><span style="display:flex;"><span>st <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;12345678&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>bfs()
</span></span><span style="display:flex;"><span>cnt <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>res <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">while</span> ed <span style="color:#f92672">!=</span> st:
</span></span><span style="display:flex;"><span>    cnt<span style="color:#f92672">+=</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    res <span style="color:#f92672">=</span> pre[ed][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">+</span> res
</span></span><span style="display:flex;"><span>    ed <span style="color:#f92672">=</span> pre[ed][<span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>print(cnt)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> cnt:
</span></span><span style="display:flex;"><span>    print(res)
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="å•è¯æ¥é¾™">å•è¯æ¥é¾™<a hidden class="anchor" aria-hidden="true" href="#å•è¯æ¥é¾™">#</a></h3>
<p><strong>é¢˜ç›®å¤§æ„</strong>ï¼šç»™å®šä¸€ç»„å•è¯å’Œä¸€ä¸ªå¼€å¤´çš„å­—æ¯ï¼Œè¦æ±‚æ‰¾å‡ºä»¥è¿™ä¸ªå­—æ¯å¼€å¤´çš„æœ€é•¿çš„â€œé¾™â€ï¼Œæ¯ä¸ªå•è¯æœ€å¤šè¢«ä½¿ç”¨ä¸¤æ¬¡ã€‚åœ¨æ„æˆé¾™æ—¶ï¼Œä¸¤ä¸ªå•è¯ç›¸è¿æ—¶ï¼Œå®ƒä»¬çš„é‡åˆéƒ¨åˆ†åˆå¹¶ä¸ºä¸€éƒ¨åˆ†ï¼Œä½†é‡åˆéƒ¨åˆ†çš„é•¿åº¦å¿…é¡»å¤§äºç­‰äº1ä¸”å°äºä¸¤ä¸ªå•è¯çš„é•¿åº¦ã€‚</p>
<p><strong>å®ç°æ€è·¯</strong>ï¼š</p>
<ol>
<li>é¦–å…ˆè¯»å…¥è¾“å…¥æ•°æ®ï¼ŒåŒ…æ‹¬å•è¯æ•° nã€n ä¸ªå•è¯ä»¥åŠå¼€å¤´çš„å­—æ¯ã€‚</li>
<li>æ„å»ºä¸€ä¸ªå­—å…¸ gï¼Œç”¨äºå­˜å‚¨æ¯ä¸ªå•è¯å¯¹åº”çš„å¯è¿æ¥çš„å•è¯ä»¥åŠå¯¹åº”çš„é‡åˆéƒ¨åˆ†çš„é•¿åº¦ã€‚</li>
<li>å¯¹äºæ¯ä¸€å¯¹å•è¯ï¼Œæ¯”è¾ƒå®ƒä»¬çš„é‡åˆéƒ¨åˆ†ï¼Œå¦‚æœç¬¦åˆæ¡ä»¶ï¼Œåˆ™å°†å…¶åŠ å…¥å­—å…¸ g ä¸­ã€‚</li>
<li>ä½¿ç”¨æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰æ¥æœç´¢ä»¥å¼€å¤´å­—æ¯å¼€å¤´çš„æœ€é•¿çš„â€œé¾™â€ã€‚</li>
<li>åœ¨æœç´¢è¿‡ç¨‹ä¸­ï¼Œä½¿ç”¨ä¸€ä¸ªå­—å…¸ cnt æ¥è®°å½•æ¯ä¸ªå•è¯çš„ä½¿ç”¨æ¬¡æ•°ï¼Œæ¯ä¸ªå•è¯æœ€å¤šåªèƒ½è¢«ä½¿ç”¨ä¸¤æ¬¡ã€‚</li>
<li>é€’å½’æœç´¢æ¯ä¸ªå¯è¿æ¥çš„å•è¯ï¼Œå¹¶æ›´æ–°æœ€é•¿â€œé¾™â€çš„é•¿åº¦ã€‚</li>
<li>æœ€ç»ˆè¾“å‡ºæœ€é•¿â€œé¾™â€çš„é•¿åº¦ã€‚</li>
</ol>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-22-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-22-1"> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-22-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-22-2"> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-22-3"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-22-3"> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-22-4"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-22-4"> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-22-5"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-22-5"> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-22-6"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-22-6"> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-22-7"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-22-7"> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-22-8"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-22-8"> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-22-9"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-22-9"> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-22-10"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-22-10">10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-22-11"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-22-11">11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-22-12"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-22-12">12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-22-13"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-22-13">13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-22-14"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-22-14">14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-22-15"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-22-15">15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-22-16"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-22-16">16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-22-17"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-22-17">17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-22-18"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-22-18">18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-22-19"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-22-19">19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-22-20"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-22-20">20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-22-21"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-22-21">21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-22-22"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-22-22">22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-22-23"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-22-23">23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-22-24"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-22-24">24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-22-25"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-22-25">25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-22-26"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-22-26">26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-22-27"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-22-27">27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-22-28"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-22-28">28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-22-29"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-22-29">29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-22-30"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-22-30">30</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-22-31"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-22-31">31</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#f92672">from</span> collections <span style="color:#f92672">import</span> defaultdict
</span></span><span style="display:flex;"><span>n <span style="color:#f92672">=</span> int(input())
</span></span><span style="display:flex;"><span>wds <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(n):
</span></span><span style="display:flex;"><span>    wds<span style="color:#f92672">.</span>append(input())
</span></span><span style="display:flex;"><span>st <span style="color:#f92672">=</span> input()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>g <span style="color:#f92672">=</span> {w:[] <span style="color:#66d9ef">for</span> w <span style="color:#f92672">in</span> wds}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(n):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(n):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> k <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>, min( len(wds[i]), len(wds[j]) )):
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> wds[i][<span style="color:#f92672">-</span>k:] <span style="color:#f92672">==</span> wds[j][:k]:
</span></span><span style="display:flex;"><span>                g[wds[i]]<span style="color:#f92672">.</span>append((wds[j], k))
</span></span><span style="display:flex;"><span>     
</span></span><span style="display:flex;"><span>cnt <span style="color:#f92672">=</span> defaultdict(int)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">dfs</span>(dra, x):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">global</span> ans
</span></span><span style="display:flex;"><span>    cnt[x] <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    ans <span style="color:#f92672">=</span> max(ans, len(dra))
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> nx, k <span style="color:#f92672">in</span> g[x]:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> cnt[nx] <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">2</span>:
</span></span><span style="display:flex;"><span>            dfs(dra <span style="color:#f92672">+</span> nx[k:], nx)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    cnt[x] <span style="color:#f92672">-=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ans <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> w <span style="color:#f92672">in</span> wds:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> w[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> st:
</span></span><span style="display:flex;"><span>        dfs(w, w)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>print(ans)
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="åˆ†æˆäº’è´¨ç»„">åˆ†æˆäº’è´¨ç»„<a hidden class="anchor" aria-hidden="true" href="#åˆ†æˆäº’è´¨ç»„">#</a></h3>
<p><strong>é¢˜ç›®å¤§æ„</strong>ï¼šç»™å®š n ä¸ªæ­£æ•´æ•°ï¼Œè¦æ±‚å°†å®ƒä»¬åˆ†ç»„ï¼Œä½¿å¾—æ¯ç»„ä¸­ä»»æ„ä¸¤ä¸ªæ•°äº’è´¨ã€‚æ±‚æœ€å°‘éœ€è¦åˆ†æˆå¤šå°‘ä¸ªç»„ã€‚</p>
<p><strong>å®ç°æ€è·¯</strong>ï¼š</p>
<ol>
<li>é¦–å…ˆè¯»å…¥è¾“å…¥æ•°æ®ï¼ŒåŒ…æ‹¬æ­£æ•´æ•°çš„ä¸ªæ•° n å’Œ n ä¸ªæ­£æ•´æ•°ã€‚</li>
<li>ä½¿ç”¨æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰æ¥æœç´¢åˆ†ç»„çš„æ–¹æ³•ã€‚</li>
<li>æ„å»ºä¸€ä¸ªåˆ—è¡¨ gï¼Œç”¨äºå­˜å‚¨åˆ†ç»„æƒ…å†µï¼Œæ¯ä¸ªåˆ†ç»„æ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼Œåˆ—è¡¨ä¸­å­˜å‚¨åˆ†ç»„ä¸­çš„æ•°ã€‚</li>
<li>ç¼–å†™ DFS å‡½æ•°ï¼Œåœ¨å‡½æ•°ä¸­é€’å½’å°è¯•å°†å½“å‰æ•°æ”¾å…¥å·²æœ‰çš„åˆ†ç»„æˆ–æ–°å»ºä¸€ä¸ªåˆ†ç»„ã€‚</li>
<li>åœ¨é€’å½’è¿‡ç¨‹ä¸­ï¼Œå¦‚æœå½“å‰æ•°å¯ä»¥å’ŒæŸä¸ªåˆ†ç»„ä¸­çš„æ‰€æœ‰æ•°äº’è´¨ï¼Œåˆ™å°†å½“å‰æ•°åŠ å…¥è¯¥åˆ†ç»„ï¼Œå¹¶ç»§ç»­é€’å½’ã€‚</li>
<li>å¦‚æœå½“å‰æ•°æ— æ³•åŠ å…¥ä»»ä½•åˆ†ç»„ï¼Œåˆ™æ–°å»ºä¸€ä¸ªåˆ†ç»„ï¼Œå¹¶ç»§ç»­é€’å½’ã€‚</li>
<li>å½“æ‰€æœ‰æ•°éƒ½è¢«åˆ†ç»„å®Œæ¯•æ—¶ï¼Œæ›´æ–°æœ€å°‘éœ€è¦çš„ç»„æ•°ã€‚</li>
<li>æœ€ç»ˆè¾“å‡ºæœ€å°‘éœ€è¦çš„ç»„æ•°ã€‚</li>
</ol>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-23-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-23-1"> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-23-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-23-2"> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-23-3"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-23-3"> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-23-4"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-23-4"> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-23-5"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-23-5"> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-23-6"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-23-6"> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-23-7"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-23-7"> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-23-8"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-23-8"> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-23-9"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-23-9"> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-23-10"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-23-10">10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-23-11"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-23-11">11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-23-12"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-23-12">12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-23-13"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-23-13">13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-23-14"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-23-14">14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-23-15"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-23-15">15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-23-16"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-23-16">16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-23-17"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-23-17">17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-23-18"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-23-18">18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-23-19"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-23-19">19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-23-20"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-23-20">20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-23-21"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-23-21">21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-23-22"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-23-22">22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-23-23"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-23-23">23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-23-24"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-23-24">24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-23-25"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-23-25">25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-23-26"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-23-26">26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-23-27"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-23-27">27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-23-28"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-23-28">28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-23-29"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-23-29">29</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#f92672">from</span> math <span style="color:#f92672">import</span> gcd
</span></span><span style="display:flex;"><span>n <span style="color:#f92672">=</span> int(input())
</span></span><span style="display:flex;"><span>a <span style="color:#f92672">=</span> list(map(int, input()<span style="color:#f92672">.</span>split()))
</span></span><span style="display:flex;"><span>g <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">dfs</span>(u, i):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">global</span> ans
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> i<span style="color:#f92672">==</span>n:
</span></span><span style="display:flex;"><span>        ans <span style="color:#f92672">=</span> min(ans, u)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> 
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> u<span style="color:#f92672">&gt;=</span>ans:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> 
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(u):
</span></span><span style="display:flex;"><span>        cnt <span style="color:#f92672">=</span> sum(<span style="color:#ae81ff">1</span> <span style="color:#66d9ef">for</span> k <span style="color:#f92672">in</span> g[j] <span style="color:#66d9ef">if</span> gcd(a[i], k)<span style="color:#f92672">==</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> cnt<span style="color:#f92672">==</span>len(g[j]):
</span></span><span style="display:flex;"><span>            g[j]<span style="color:#f92672">.</span>append(a[i])
</span></span><span style="display:flex;"><span>            dfs(u, i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>            g[j]<span style="color:#f92672">.</span>pop()
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    g<span style="color:#f92672">.</span>append([a[i]])
</span></span><span style="display:flex;"><span>    dfs(u<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>, i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>    g<span style="color:#f92672">.</span>pop()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ans <span style="color:#f92672">=</span> n
</span></span><span style="display:flex;"><span>dfs(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>print(ans)
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="è¿­ä»£åŠ æ·±-åŠ æˆåºåˆ—">è¿­ä»£åŠ æ·± åŠ æˆåºåˆ—<a hidden class="anchor" aria-hidden="true" href="#è¿­ä»£åŠ æ·±-åŠ æˆåºåˆ—">#</a></h3>
<p><strong>é¢˜ç›®å¤§æ„</strong>ï¼šç»™å®šä¸€ä¸ªæ•´æ•° nï¼Œæ‰¾å‡ºæ»¡è¶³ä»¥ä¸‹æ¡ä»¶çš„æœ€å°é•¿åº¦çš„â€œåŠ æˆåºåˆ—â€ï¼šåºåˆ—çš„ç¬¬ä¸€ä¸ªå…ƒç´ ä¸º1ï¼Œæœ€åä¸€ä¸ªå…ƒç´ ä¸º nï¼Œåºåˆ—ä¸­çš„å…ƒç´ æ»¡è¶³æ¯ä¸ªå…ƒç´ éƒ½å¯ä»¥è¡¨ç¤ºä¸ºåºåˆ—ä¸­å…¶ä»–ä¸¤ä¸ªå…ƒç´ çš„å’Œã€‚</p>
<p><strong>å®ç°æ€è·¯</strong>ï¼š</p>
<ol>
<li>å®šä¹‰ä¸€ä¸ªæ·±åº¦ä¼˜å…ˆæœç´¢<code>ï¼ˆDFSï¼‰</code>å‡½æ•° <code>dfs</code>ï¼Œç”¨äºæœç´¢ç¬¦åˆæ¡ä»¶çš„åŠ æˆåºåˆ—ã€‚</li>
<li>åœ¨ <code>dfs</code> å‡½æ•°ä¸­ï¼Œä½¿ç”¨ä¸€ä¸ªåˆ—è¡¨ <code>path</code> æ¥è®°å½•å½“å‰æœç´¢çš„åŠ æˆåºåˆ—ï¼Œåˆå§‹åŒ– <code>path[0] = 1</code>ã€‚</li>
<li>é€’å½’åœ°æœç´¢åŠ æˆåºåˆ—çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œä½¿å¾—æ–°çš„å…ƒç´ æ˜¯å‰é¢å…ƒç´ çš„ä¸¤ä¸¤ç›¸åŠ çš„ç»“æœï¼Œå¹¶æ»¡è¶³æ¡ä»¶ <code>path[u] &lt;= n</code>ï¼Œå…¶ä¸­ u è¡¨ç¤ºå½“å‰æœç´¢çš„ä½ç½®ã€‚</li>
<li>å¦‚æœæœç´¢æˆåŠŸï¼Œå³æ‰¾åˆ°äº†ç¬¦åˆæ¡ä»¶çš„åŠ æˆåºåˆ—ï¼Œè¿”å› Trueï¼›å¦åˆ™è¿”å› Falseã€‚</li>
<li>åœ¨ä¸»ç¨‹åºä¸­ï¼Œä¸æ–­è¯»å–è¾“å…¥çš„ nï¼Œå¹¶é€šè¿‡è°ƒç”¨ <code>dfs</code> å‡½æ•°æ¥æœç´¢ç¬¦åˆæ¡ä»¶çš„åŠ æˆåºåˆ—ã€‚</li>
<li>è¾“å‡ºæ»¡è¶³æ¡ä»¶çš„åŠ æˆåºåˆ—ã€‚</li>
</ol>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-24-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-24-1"> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-24-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-24-2"> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-24-3"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-24-3"> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-24-4"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-24-4"> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-24-5"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-24-5"> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-24-6"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-24-6"> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-24-7"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-24-7"> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-24-8"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-24-8"> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-24-9"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-24-9"> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-24-10"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-24-10">10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-24-11"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-24-11">11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-24-12"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-24-12">12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-24-13"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-24-13">13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-24-14"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-24-14">14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-24-15"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-24-15">15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-24-16"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-24-16">16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-24-17"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-24-17">17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-24-18"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-24-18">18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-24-19"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-24-19">19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-24-20"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-24-20">20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-24-21"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-24-21">21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-24-22"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-24-22">22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-24-23"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-24-23">23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-24-24"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-24-24">24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-24-25"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-24-25">25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-24-26"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-24-26">26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-24-27"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-24-27">27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-24-28"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-24-28">28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-24-29"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-24-29">29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-24-30"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-24-30">30</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">dfs</span>(u):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> u<span style="color:#f92672">==</span>dep:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> path[u<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">==</span>n
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>    vis <span style="color:#f92672">=</span> [<span style="color:#66d9ef">False</span>]<span style="color:#f92672">*</span>(n<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(u<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(i, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>            s <span style="color:#f92672">=</span> path[i] <span style="color:#f92672">+</span> path[j]
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> s<span style="color:#f92672">&gt;</span>n <span style="color:#f92672">or</span> s<span style="color:#f92672">&lt;=</span>path[u<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">or</span> vis[s]:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">continue</span>
</span></span><span style="display:flex;"><span>            vis[s] <span style="color:#f92672">=</span> <span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>            path[u] <span style="color:#f92672">=</span> s
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> dfs(u<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>): <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>path <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0</span>]<span style="color:#f92672">*</span>(<span style="color:#ae81ff">110</span>)
</span></span><span style="display:flex;"><span>path[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">while</span> <span style="color:#66d9ef">True</span>:
</span></span><span style="display:flex;"><span>    n <span style="color:#f92672">=</span> int(input())
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> n: <span style="color:#66d9ef">break</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    dep <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> <span style="color:#f92672">not</span> dfs(<span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>        dep <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    print(<span style="color:#f92672">*</span>path[:dep])
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="åŒå‘dfs-é€ç¤¼ç‰©httpswwwacwingcomproblemcontentdescription173">åŒå‘DFS <a href="https://www.acwing.com/problem/content/description/173/">é€ç¤¼ç‰©</a><a hidden class="anchor" aria-hidden="true" href="#åŒå‘dfs-é€ç¤¼ç‰©httpswwwacwingcomproblemcontentdescription173">#</a></h3>
<p><strong>é¢˜ç›®å¤§æ„</strong>ï¼šè¾¾è¾¾å¸®ç¿°ç¿°é€ç¤¼ç‰©ï¼Œä»–ä¸€æ¬¡å¯ä»¥æ¬åŠ¨çš„é‡é‡ä¹‹å’Œä¸è¶…è¿‡ Wï¼Œä¸€å…±æœ‰ N ä¸ªç¤¼ç‰©ï¼Œå…¶ä¸­ç¬¬ i ä¸ªç¤¼ç‰©çš„é‡é‡æ˜¯ G[i]ã€‚æ±‚è¾¾è¾¾åœ¨ä»–çš„åŠ›æ°”èŒƒå›´å†…ä¸€æ¬¡æ€§èƒ½æ¬åŠ¨çš„æœ€å¤§é‡é‡ã€‚</p>
<p><strong>å®ç°æ€è·¯</strong>ï¼š</p>
<ol>
<li>å®šä¹‰ä¸¤ä¸ªæ·±åº¦ä¼˜å…ˆæœç´¢<code>ï¼ˆDFSï¼‰</code>å‡½æ•° <code>dfs1</code> å’Œ <code>dfs2</code>ï¼Œç”¨äºæ±‚è§£è¾¾è¾¾ä¸€æ¬¡æ€§èƒ½æ¬åŠ¨çš„æœ€å¤§é‡é‡ã€‚</li>
<li><code>dfs1</code> å‡½æ•°ç”¨äºéå†å‰ä¸€åŠçš„ç¤¼ç‰©ï¼Œæ±‚å¾—æ‰€æœ‰å¯èƒ½çš„æ¬åŠ¨é‡é‡ä¹‹å’Œï¼Œå¹¶å­˜å‚¨åœ¨é›†åˆ wgh ä¸­ã€‚</li>
<li><code>dfs2</code> å‡½æ•°ç”¨äºéå†åä¸€åŠçš„ç¤¼ç‰©ï¼Œå¹¶é€šè¿‡äºŒåˆ†æŸ¥æ‰¾åœ¨ wgh ä¸­æ‰¾åˆ°åˆé€‚çš„æ¬åŠ¨é‡é‡ï¼Œæ±‚å¾—æœ€å¤§é‡é‡ã€‚</li>
<li>åœ¨ä¸»ç¨‹åºä¸­ï¼Œé¦–å…ˆè¯»å…¥è¾“å…¥çš„ W å’Œ Nï¼Œç„¶åè¯»å…¥ N ä¸ªç¤¼ç‰©çš„é‡é‡ï¼Œå¹¶æŒ‰ç…§é‡é‡ä»å¤§åˆ°å°æ’åºã€‚</li>
<li>è°ƒç”¨ dfs1 å’Œ dfs2 å‡½æ•°æ±‚è§£æœ€å¤§é‡é‡ï¼Œå¹¶è¾“å‡ºç»“æœã€‚</li>
</ol>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-25-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-25-1"> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-25-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-25-2"> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-25-3"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-25-3"> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-25-4"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-25-4"> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-25-5"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-25-5"> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-25-6"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-25-6"> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-25-7"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-25-7"> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-25-8"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-25-8"> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-25-9"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-25-9"> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-25-10"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-25-10">10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-25-11"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-25-11">11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-25-12"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-25-12">12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-25-13"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-25-13">13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-25-14"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-25-14">14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-25-15"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-25-15">15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-25-16"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-25-16">16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-25-17"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-25-17">17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-25-18"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-25-18">18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-25-19"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-25-19">19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-25-20"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-25-20">20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-25-21"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-25-21">21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-25-22"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-25-22">22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-25-23"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-25-23">23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-25-24"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-25-24">24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-25-25"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-25-25">25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-25-26"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-25-26">26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-25-27"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-25-27">27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-25-28"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-25-28">28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-25-29"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-25-29">29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-25-30"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-25-30">30</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-25-31"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-25-31">31</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-25-32"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-25-32">32</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-25-33"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-25-33">33</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-25-34"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-25-34">34</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-25-35"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-25-35">35</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-25-36"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-25-36">36</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-25-37"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-25-37">37</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-25-38"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-25-38">38</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-25-39"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-25-39">39</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-25-40"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-25-40">40</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-25-41"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-25-41">41</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-25-42"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-25-42">42</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-25-43"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-25-43">43</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-25-44"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-25-44">44</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-25-45"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-25-45">45</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-25-46"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-25-46">46</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-25-47"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-25-47">47</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">dfs1</span>(u, tot):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> u<span style="color:#f92672">&gt;</span>k:
</span></span><span style="display:flex;"><span>        wgh<span style="color:#f92672">.</span>add(tot)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> 
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> tot <span style="color:#f92672">+</span> a[u] <span style="color:#f92672">&lt;=</span> w:
</span></span><span style="display:flex;"><span>        dfs1(u<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>, tot <span style="color:#f92672">+</span> a[u])
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    dfs1(u<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>, tot)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">dfs2</span>(u, tot):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">global</span> ans
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> u<span style="color:#f92672">&gt;=</span>n:
</span></span><span style="display:flex;"><span>        l, r <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, cnt<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">while</span> l<span style="color:#f92672">&lt;</span>r:
</span></span><span style="display:flex;"><span>            mid <span style="color:#f92672">=</span> (l<span style="color:#f92672">+</span>r<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">&gt;&gt;</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> wgh[mid] <span style="color:#f92672">+</span> tot <span style="color:#f92672">&lt;=</span> w:
</span></span><span style="display:flex;"><span>                l <span style="color:#f92672">=</span> mid
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>                r <span style="color:#f92672">=</span> mid <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        ans <span style="color:#f92672">=</span> max(ans, wgh[r] <span style="color:#f92672">+</span> tot)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> 
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> a[u] <span style="color:#f92672">+</span> tot <span style="color:#f92672">&lt;=</span> w:
</span></span><span style="display:flex;"><span>        dfs2(u<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>, a[u] <span style="color:#f92672">+</span> tot)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    dfs2(u<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>, tot)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>w, n <span style="color:#f92672">=</span> map(int, input()<span style="color:#f92672">.</span>split())
</span></span><span style="display:flex;"><span>a <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(n):
</span></span><span style="display:flex;"><span>    a<span style="color:#f92672">.</span>append(int(input()))
</span></span><span style="display:flex;"><span>a<span style="color:#f92672">.</span>sort(reverse <span style="color:#f92672">=</span> <span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>wgh <span style="color:#f92672">=</span> set()
</span></span><span style="display:flex;"><span>k <span style="color:#f92672">=</span> n<span style="color:#f92672">//</span><span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>dfs1(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>wgh <span style="color:#f92672">=</span> sorted(list(wgh))
</span></span><span style="display:flex;"><span>cnt <span style="color:#f92672">=</span> len(wgh)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ans <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>dfs2(k<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(ans)
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="37-è§£æ•°ç‹¬httpsleetcodecnproblemssudoku-solver-166-æ•°ç‹¬httpswwwacwingcomproblemcontentdescription168"><a href="https://leetcode.cn/problems/sudoku-solver/">37. è§£æ•°ç‹¬</a> <a href="https://www.acwing.com/problem/content/description/168/">\166. æ•°ç‹¬</a><a hidden class="anchor" aria-hidden="true" href="#37-è§£æ•°ç‹¬httpsleetcodecnproblemssudoku-solver-166-æ•°ç‹¬httpswwwacwingcomproblemcontentdescription168">#</a></h3>
<p><strong>é¢˜ç›®å¤§æ„</strong>ï¼šæ•°ç‹¬æ˜¯ä¸€ç§ç›Šæ™ºæ¸¸æˆï¼Œè¦æ±‚å¡«å†™ä¸€ä¸ª<code>9Ã—9</code>çš„ç½‘æ ¼ï¼Œä½¿å¾—æ¯è¡Œã€æ¯åˆ—ã€æ¯ä¸ª<code>3Ã—3</code>çš„ä¹å®«æ ¼å†…æ•°å­—<code>1âˆ¼9</code>å‡æ°å¥½å‡ºç°ä¸€æ¬¡ã€‚</p>
<p><strong>å®ç°æ€è·¯</strong>ï¼šè¯¥å®ç°é‡‡ç”¨æ·±åº¦ä¼˜å…ˆæœç´¢<code>ï¼ˆDFSï¼‰</code>çš„æ–¹æ³•è§£å†³æ•°ç‹¬é—®é¢˜ã€‚é¦–å…ˆï¼Œé€šè¿‡å°†æ¯ä¸ªæ•°å­—æ˜ å°„åˆ°äºŒè¿›åˆ¶ä½æ¥è¿›è¡Œä½è¿ç®—ï¼Œä»¥ä¾¿å¿«é€Ÿè·å–å·²å¡«å……æ•°å­—çš„çŠ¶æ€ã€‚ç„¶åï¼Œåˆ©ç”¨<code>DFS</code>é€’å½’å¡«å……æ•°ç‹¬ä¸­çš„ç©ºç™½æ ¼å­ï¼Œä¼˜å…ˆé€‰æ‹©å½“å‰ç©ºç™½æ ¼å­å¡«å……æ•°å­—çš„é€‰æ‹©ç©ºé—´è¾ƒå°çš„ä½ç½®ã€‚é€’å½’çš„ç»ˆæ­¢æ¡ä»¶æ˜¯æ‰€æœ‰ç©ºç™½æ ¼å­éƒ½å¡«å……å®Œæ¯•ã€‚</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-1"> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-2"> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-3"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-3"> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-4"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-4"> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-5"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-5"> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-6"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-6"> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-7"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-7"> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-8"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-8"> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-9"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-9"> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-10"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-10">10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-11"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-11">11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-12"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-12">12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-13"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-13">13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-14"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-14">14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-15"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-15">15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-16"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-16">16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-17"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-17">17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-18"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-18">18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-19"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-19">19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-20"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-20">20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-21"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-21">21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-22"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-22">22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-23"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-23">23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-24"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-24">24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-25"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-25">25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-26"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-26">26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-27"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-27">27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-28"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-28">28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-29"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-29">29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-30"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-30">30</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-31"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-31">31</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-32"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-32">32</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-33"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-33">33</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-34"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-34">34</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-35"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-35">35</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-36"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-36">36</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-37"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-37">37</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-38"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-38">38</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-39"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-39">39</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-40"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-40">40</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-41"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-41">41</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-42"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-42">42</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-43"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-43">43</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-44"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-44">44</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-45"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-45">45</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-46"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-46">46</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-47"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-47">47</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-48"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-48">48</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-49"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-49">49</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-50"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-50">50</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-51"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-51">51</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-52"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-52">52</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-53"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-53">53</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-54"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-54">54</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-55"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-55">55</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-56"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-56">56</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-57"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-57">57</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-58"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-58">58</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-59"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-59">59</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-60"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-60">60</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-61"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-61">61</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-62"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-62">62</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-63"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-63">63</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-64"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-64">64</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-65"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-65">65</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-66"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-66">66</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-67"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-67">67</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-68"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-68">68</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-69"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-69">69</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-70"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-70">70</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-71"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-71">71</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-72"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-72">72</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-73"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-73">73</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-74"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-74">74</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-75"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-75">75</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-76"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-76">76</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-77"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-77">77</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-78"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-78">78</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-79"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-79">79</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-80"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-80">80</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-26-81"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-26-81">81</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#f92672">import</span> sys
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>N <span style="color:#f92672">=</span> <span style="color:#ae81ff">9</span>
</span></span><span style="display:flex;"><span>M <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">&lt;&lt;</span> N
</span></span><span style="display:flex;"><span>row, col, cell <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0</span>] <span style="color:#f92672">*</span> N, [<span style="color:#ae81ff">0</span>] <span style="color:#f92672">*</span> N, [[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">*</span> <span style="color:#ae81ff">3</span> <span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">3</span>)]
</span></span><span style="display:flex;"><span>mp <span style="color:#f92672">=</span> dict()
</span></span><span style="display:flex;"><span>ones <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0</span>] <span style="color:#f92672">*</span> M
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(N):
</span></span><span style="display:flex;"><span>    mp[<span style="color:#ae81ff">1</span> <span style="color:#f92672">&lt;&lt;</span> i] <span style="color:#f92672">=</span> i
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span> <span style="color:#f92672">&lt;&lt;</span> N):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(N):
</span></span><span style="display:flex;"><span>        ones[i] <span style="color:#f92672">+=</span> (i <span style="color:#f92672">&gt;&gt;</span> j) <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">lowbit</span>(x):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> x <span style="color:#f92672">&amp;</span> <span style="color:#f92672">-</span>x
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get</span>(x, y):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> row[x] <span style="color:#f92672">&amp;</span> col[y] <span style="color:#f92672">&amp;</span> cell[x <span style="color:#f92672">//</span> <span style="color:#ae81ff">3</span>][y <span style="color:#f92672">//</span> <span style="color:#ae81ff">3</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">draw</span>(x, y, t, flag):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">global</span> st, row, col, cell
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> flag:
</span></span><span style="display:flex;"><span>        st[x <span style="color:#f92672">*</span> N <span style="color:#f92672">+</span> y] <span style="color:#f92672">=</span> chr(<span style="color:#ae81ff">49</span> <span style="color:#f92672">+</span> t)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        st[x <span style="color:#f92672">*</span> N <span style="color:#f92672">+</span> y] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;.&#34;</span>
</span></span><span style="display:flex;"><span>    v <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">&lt;&lt;</span> t
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> flag:
</span></span><span style="display:flex;"><span>        v <span style="color:#f92672">=</span> <span style="color:#f92672">-</span>v
</span></span><span style="display:flex;"><span>    row[x] <span style="color:#f92672">-=</span> v
</span></span><span style="display:flex;"><span>    col[y] <span style="color:#f92672">-=</span> v
</span></span><span style="display:flex;"><span>    cell[x <span style="color:#f92672">//</span> <span style="color:#ae81ff">3</span>][y <span style="color:#f92672">//</span> <span style="color:#ae81ff">3</span>] <span style="color:#f92672">-=</span> v
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">dfs</span>(cnt):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">global</span> st
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> cnt:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>    minv <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(N):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(N):
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> st[i <span style="color:#f92672">*</span> N <span style="color:#f92672">+</span> j] <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;.&#34;</span>:
</span></span><span style="display:flex;"><span>                state <span style="color:#f92672">=</span> get(i, j)
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> ones[state] <span style="color:#f92672">&lt;</span> minv:
</span></span><span style="display:flex;"><span>                    minv <span style="color:#f92672">=</span> ones[state]
</span></span><span style="display:flex;"><span>                    x, y <span style="color:#f92672">=</span> i, j
</span></span><span style="display:flex;"><span>    i <span style="color:#f92672">=</span> get(x, y)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> i:
</span></span><span style="display:flex;"><span>        t <span style="color:#f92672">=</span> mp[lowbit(i)]
</span></span><span style="display:flex;"><span>        draw(x, y, t, <span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> dfs(cnt <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>        draw(x, y, t, <span style="color:#66d9ef">False</span>)
</span></span><span style="display:flex;"><span>        i <span style="color:#f92672">-=</span> lowbit(i)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">while</span> <span style="color:#66d9ef">True</span>:
</span></span><span style="display:flex;"><span>    st <span style="color:#f92672">=</span> sys<span style="color:#f92672">.</span>stdin<span style="color:#f92672">.</span>readline()<span style="color:#f92672">.</span>strip()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> st <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;end&#34;</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">break</span>
</span></span><span style="display:flex;"><span>    st <span style="color:#f92672">=</span> list(st)
</span></span><span style="display:flex;"><span>    cnt <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(N):
</span></span><span style="display:flex;"><span>        row[i] <span style="color:#f92672">=</span> col[i] <span style="color:#f92672">=</span> M <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">3</span>):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">3</span>):
</span></span><span style="display:flex;"><span>            cell[i][j] <span style="color:#f92672">=</span> M <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(N):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(N):
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> st[i <span style="color:#f92672">*</span> N <span style="color:#f92672">+</span> j] <span style="color:#f92672">!=</span> <span style="color:#e6db74">&#34;.&#34;</span>:
</span></span><span style="display:flex;"><span>                t <span style="color:#f92672">=</span> int(st[i <span style="color:#f92672">*</span> N <span style="color:#f92672">+</span> j]) <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                draw(i, j, t, <span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>                cnt <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dfs(cnt)
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">.</span>join(st))
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="æœ€çŸ­è·¯-188-æ­¦å£«é£åº¦çš„ç‰›httpswwwacwingcomproblemcontentdescription190">æœ€çŸ­è·¯ <a href="https://www.acwing.com/problem/content/description/190/">188. æ­¦å£«é£åº¦çš„ç‰›</a><a hidden class="anchor" aria-hidden="true" href="#æœ€çŸ­è·¯-188-æ­¦å£«é£åº¦çš„ç‰›httpswwwacwingcomproblemcontentdescription190">#</a></h3>
<p><strong>é¢˜ç›®å¤§æ„</strong>ï¼šå†œæ°‘ <code>John</code> æƒ³äº¤æ˜“ä»–çš„ä¸€å¤´è¢« <code>Don</code> ç§°ä¸º <code>The Knight</code> çš„ç‰›ã€‚è¿™å¤´ç‰›æœ‰ç‰¹æ®Šèƒ½åŠ›ï¼Œå¯ä»¥æŒ‰ç…§è±¡æ£‹ä¸­é©¬çš„èµ°æ³•è·³è·ƒã€‚å†œåœºè¢«è¡¨ç¤ºä¸ºä¸€ä¸ªäºŒç»´åæ ‡å›¾ï¼Œå…¶ä¸­åŒ…å«äº†æ ‘ã€çŒæœ¨ã€çŸ³å¤´ä»¥åŠè‰çš„ä½ç½®ã€‚<code>The Knight</code> èµ·å§‹ä½ç½®ä¸º <code>K</code>ï¼Œè‰çš„ä½ç½®ä¸º <code>H</code>ã€‚ä»»åŠ¡æ˜¯ç¡®å®š <code>The Knight</code> è¦è·³å¤šå°‘æ¬¡æ‰èƒ½åˆ°è¾¾è‰çš„ä½ç½®ã€‚</p>
<p><strong>å®ç°æ€è·¯</strong>ï¼š</p>
<ol>
<li>é¦–å…ˆè§£æè¾“å…¥ï¼Œå¾—åˆ°å†œåœºçš„åˆ—æ•°å’Œè¡Œæ•°ï¼Œä»¥åŠåœ°å›¾ä¿¡æ¯ï¼ŒåŒ…æ‹¬éšœç¢ç‰©å’Œç›®æ ‡ä½ç½®ï¼ˆè‰çš„ä½ç½®ï¼‰ã€‚</li>
<li>ä½¿ç”¨å¹¿åº¦ä¼˜å…ˆæœç´¢ï¼ˆ<code>BFS</code>ï¼‰ç®—æ³•æ¥æ‰¾åˆ°ä»èµ·å§‹ä½ç½®åˆ°è¾¾ç›®æ ‡ä½ç½®çš„æœ€çŸ­è·¯å¾„ã€‚</li>
<li>åˆå§‹åŒ–ä¸€ä¸ªé˜Ÿåˆ—ï¼Œå¹¶å°†èµ·å§‹ä½ç½®åŠ å…¥é˜Ÿåˆ—ä¸­ã€‚</li>
<li>åœ¨å¾ªç¯ä¸­ï¼Œæ¯æ¬¡ä»é˜Ÿåˆ—ä¸­å–å‡ºä¸€ä¸ªä½ç½®ï¼Œå¹¶å°è¯•å‘å…«ä¸ªæ–¹å‘è·³è·ƒï¼ˆè±¡æ£‹ä¸­é©¬çš„æ‰€æœ‰å¯èƒ½èµ°æ³•ï¼‰ï¼Œå¦‚æœè·³è·ƒåçš„ä½ç½®åˆæ³•ä¸”æ²¡æœ‰éšœç¢ç‰©ä¸”æœªè¢«è®¿é—®è¿‡ï¼Œåˆ™å°†è¯¥ä½ç½®åŠ å…¥é˜Ÿåˆ—ï¼Œå¹¶æ ‡è®°ä¸ºå·²è®¿é—®ã€‚</li>
<li>å½“å–å‡ºçš„ä½ç½®ä¸ºç›®æ ‡ä½ç½®æ—¶ï¼Œè¾“å‡ºè·³è·ƒçš„æ¬¡æ•°ï¼Œå³æœ€çŸ­è·¯å¾„çš„é•¿åº¦ï¼Œç„¶åé€€å‡ºå¾ªç¯ã€‚</li>
<li>å¦‚æœé˜Ÿåˆ—ä¸ºç©ºä»æœªæ‰¾åˆ°ç›®æ ‡ä½ç½®ï¼Œåˆ™è¯´æ˜æ•°æ®ä¿è¯ä¸€å®šæœ‰è§£ï¼Œä¸éœ€è¦å¤„ç†è¿™ç§æƒ…å†µã€‚</li>
</ol>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-27-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-27-1"> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-27-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-27-2"> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-27-3"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-27-3"> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-27-4"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-27-4"> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-27-5"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-27-5"> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-27-6"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-27-6"> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-27-7"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-27-7"> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-27-8"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-27-8"> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-27-9"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-27-9"> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-27-10"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-27-10">10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-27-11"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-27-11">11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-27-12"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-27-12">12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-27-13"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-27-13">13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-27-14"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-27-14">14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-27-15"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-27-15">15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-27-16"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-27-16">16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-27-17"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-27-17">17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-27-18"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-27-18">18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-27-19"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-27-19">19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-27-20"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-27-20">20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-27-21"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-27-21">21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-27-22"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-27-22">22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-27-23"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-27-23">23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-27-24"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-27-24">24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-27-25"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-27-25">25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-27-26"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-27-26">26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-27-27"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-27-27">27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-27-28"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-27-28">28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-27-29"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-27-29">29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-27-30"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-27-30">30</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-27-31"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-27-31">31</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#f92672">from</span> collections <span style="color:#f92672">import</span> deque
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>dir <span style="color:#f92672">=</span> [(<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1</span>), (<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>), (<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>), (<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1</span>), (<span style="color:#ae81ff">2</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>), (<span style="color:#ae81ff">1</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>), (<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>), (<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>c, r <span style="color:#f92672">=</span> map(int, input()<span style="color:#f92672">.</span>split())
</span></span><span style="display:flex;"><span>g <span style="color:#f92672">=</span> [[] <span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> range(r)]
</span></span><span style="display:flex;"><span>vis <span style="color:#f92672">=</span> [[<span style="color:#66d9ef">False</span>]<span style="color:#f92672">*</span>(c<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>) <span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> range(r<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)]
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(r):
</span></span><span style="display:flex;"><span>    g[i] <span style="color:#f92672">=</span> list(input())
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> j, ch <span style="color:#f92672">in</span> enumerate(g[i]):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> ch<span style="color:#f92672">==</span><span style="color:#e6db74">&#39;H&#39;</span>:
</span></span><span style="display:flex;"><span>            end <span style="color:#f92672">=</span> (i, j)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> ch<span style="color:#f92672">==</span><span style="color:#e6db74">&#39;K&#39;</span>:
</span></span><span style="display:flex;"><span>            start <span style="color:#f92672">=</span> (i, j)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>q <span style="color:#f92672">=</span> deque()
</span></span><span style="display:flex;"><span>q<span style="color:#f92672">.</span>append((<span style="color:#f92672">*</span>start, <span style="color:#ae81ff">0</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">while</span> q:
</span></span><span style="display:flex;"><span>    x, y, d<span style="color:#f92672">=</span> q<span style="color:#f92672">.</span>popleft()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (x, y)<span style="color:#f92672">==</span>end:
</span></span><span style="display:flex;"><span>        print(d)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">break</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">8</span>):
</span></span><span style="display:flex;"><span>        a, b <span style="color:#f92672">=</span> x <span style="color:#f92672">+</span> dir[i][<span style="color:#ae81ff">0</span>], y <span style="color:#f92672">+</span> dir[i][<span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> <span style="color:#ae81ff">0</span><span style="color:#f92672">&lt;=</span>a<span style="color:#f92672">&lt;</span>r <span style="color:#f92672">and</span> <span style="color:#ae81ff">0</span><span style="color:#f92672">&lt;=</span>b<span style="color:#f92672">&lt;</span>c:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> g[a][b]<span style="color:#f92672">!=</span><span style="color:#e6db74">&#39;*&#39;</span> <span style="color:#f92672">and</span> <span style="color:#f92672">not</span> vis[a][b]:
</span></span><span style="display:flex;"><span>                vis[a][b] <span style="color:#f92672">=</span> <span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>                q<span style="color:#f92672">.</span>append((a, b, d<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>))
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="å¤šæºbfs">å¤šæºBFS<a hidden class="anchor" aria-hidden="true" href="#å¤šæºbfs">#</a></h3>
<p><strong>é¢˜ç›®å¤§æ„</strong>ï¼šç»™å®šä¸€ä¸ª N è¡Œ M åˆ—çš„ 01 çŸ©é˜µ Aï¼Œå®šä¹‰çŸ©é˜µä¸­æ¯ä¸ªä½ç½®ä¸æ‰€æœ‰å€¼ä¸º1çš„ä½ç½®çš„æ›¼å“ˆé¡¿è·ç¦»ã€‚æ›¼å“ˆé¡¿è·ç¦»ä¸ºè¯¥ä½ç½®ä¸æ‰€æœ‰å€¼ä¸º1çš„ä½ç½®è¡Œåæ ‡ä¹‹å·®çš„ç»å¯¹å€¼ä¸åˆ—åæ ‡ä¹‹å·®çš„ç»å¯¹å€¼ä¹‹å’Œã€‚</p>
<p><strong>å®ç°æ€è·¯</strong>ï¼š</p>
<ol>
<li>é¦–å…ˆè¯»å…¥çŸ©é˜µçš„è¡Œæ•°å’Œåˆ—æ•°ï¼Œä»¥åŠçŸ©é˜µæœ¬èº«ã€‚</li>
<li>ä½¿ç”¨BFSï¼ˆå¹¿åº¦ä¼˜å…ˆæœç´¢ï¼‰æ¥è®¡ç®—æ¯ä¸ªä½ç½®åˆ°æ‰€æœ‰å€¼ä¸º1çš„ä½ç½®çš„è·ç¦»ã€‚</li>
<li>åˆå§‹åŒ–ä¸€ä¸ªé˜Ÿåˆ—ï¼Œå°†æ‰€æœ‰å€¼ä¸º1çš„ä½ç½®å…¥é˜Ÿï¼Œè·ç¦»åˆå§‹åŒ–ä¸º0ã€‚</li>
<li>å¯¹é˜Ÿåˆ—è¿›è¡ŒBFSéå†ï¼Œæ¯æ¬¡å–å‡ºé˜Ÿé¦–å…ƒç´ ï¼Œè®¡ç®—å…¶å‘¨å›´å››ä¸ªæ–¹å‘çš„ä½ç½®ï¼Œè‹¥ä½ç½®åˆæ³•ä¸”ä¸º0ä¸”æœªè¢«è®¿é—®è¿‡ï¼Œåˆ™æ›´æ–°è·ç¦»å¹¶å…¥é˜Ÿã€‚</li>
<li>æœ€ç»ˆè¾“å‡ºè·ç¦»çŸ©é˜µBã€‚</li>
</ol>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-28-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-28-1"> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-28-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-28-2"> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-28-3"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-28-3"> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-28-4"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-28-4"> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-28-5"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-28-5"> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-28-6"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-28-6"> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-28-7"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-28-7"> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-28-8"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-28-8"> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-28-9"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-28-9"> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-28-10"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-28-10">10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-28-11"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-28-11">11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-28-12"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-28-12">12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-28-13"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-28-13">13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-28-14"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-28-14">14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-28-15"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-28-15">15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-28-16"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-28-16">16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-28-17"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-28-17">17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-28-18"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-28-18">18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-28-19"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-28-19">19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-28-20"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-28-20">20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-28-21"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-28-21">21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-28-22"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-28-22">22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-28-23"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-28-23">23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-28-24"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-28-24">24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-28-25"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-28-25">25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-28-26"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-28-26">26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-28-27"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-28-27">27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-28-28"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-28-28">28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-28-29"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-28-29">29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-28-30"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-28-30">30</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-28-31"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-28-31">31</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-28-32"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-28-32">32</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-28-33"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-28-33">33</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-28-34"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-28-34">34</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-28-35"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-28-35">35</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#f92672">import</span> sys
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> collections <span style="color:#f92672">import</span> deque
</span></span><span style="display:flex;"><span>input <span style="color:#f92672">=</span> <span style="color:#66d9ef">lambda</span>:sys<span style="color:#f92672">.</span>stdin<span style="color:#f92672">.</span>readline()<span style="color:#f92672">.</span>strip()
</span></span><span style="display:flex;"><span>N <span style="color:#f92672">=</span> int(<span style="color:#ae81ff">1e3</span><span style="color:#f92672">+</span><span style="color:#ae81ff">10</span>)
</span></span><span style="display:flex;"><span>g <span style="color:#f92672">=</span> [[] <span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> range(N)]
</span></span><span style="display:flex;"><span>dis <span style="color:#f92672">=</span> [[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">*</span>N <span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> range(N)]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>n, m <span style="color:#f92672">=</span> map(int, input()<span style="color:#f92672">.</span>split())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>, n<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>    g[i] <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0</span>] <span style="color:#f92672">+</span> list(input())
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>q <span style="color:#f92672">=</span> deque()   
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>, n<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>, m<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> g[i][j] <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;1&#39;</span>:
</span></span><span style="display:flex;"><span>           q<span style="color:#f92672">.</span>append((i, j, <span style="color:#ae81ff">0</span>))
</span></span><span style="display:flex;"><span>           dis[i][j] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>           
</span></span><span style="display:flex;"><span>dx <span style="color:#f92672">=</span> [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>dy <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">while</span> q:
</span></span><span style="display:flex;"><span>    x, y, d <span style="color:#f92672">=</span> q<span style="color:#f92672">.</span>popleft()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">4</span>):
</span></span><span style="display:flex;"><span>        xx <span style="color:#f92672">=</span> x<span style="color:#f92672">+</span>dx[i]; yy <span style="color:#f92672">=</span> y<span style="color:#f92672">+</span>dy[i]
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> xx<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">0</span> <span style="color:#f92672">and</span> xx<span style="color:#f92672">&lt;=</span>n <span style="color:#f92672">and</span> yy<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">0</span> <span style="color:#f92672">and</span> yy<span style="color:#f92672">&lt;=</span>m:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> g[xx][yy] <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;0&#39;</span> <span style="color:#f92672">and</span> dis[xx][yy] <span style="color:#f92672">==</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>                dis[xx][yy] <span style="color:#f92672">=</span> d<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                q<span style="color:#f92672">.</span>append((xx, yy, d<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>, n<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>    print(<span style="color:#f92672">*</span>dis[i][<span style="color:#ae81ff">1</span>:m<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>])
</span></span><span style="display:flex;"><span>    
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="åŒç«¯é˜Ÿåˆ—bfs175-ç”µè·¯ç»´ä¿®httpswwwacwingcomproblemcontentdescription177">åŒç«¯é˜Ÿåˆ—BFS<a href="https://www.acwing.com/problem/content/description/177/">175. ç”µè·¯ç»´ä¿®</a><a hidden class="anchor" aria-hidden="true" href="#åŒç«¯é˜Ÿåˆ—bfs175-ç”µè·¯ç»´ä¿®httpswwwacwingcomproblemcontentdescription177">#</a></h3>
<p><strong>é¢˜ç›®å¤§æ„</strong>ï¼šæœ‰ä¸€ä¸ªç”µè·¯æ¿ï¼Œç”± R è¡Œ C åˆ—çš„ç½‘æ ¼ç»„æˆï¼Œæ¯ä¸ªæ ¼ç‚¹éƒ½æ˜¯ç”µçº¿çš„æ¥ç‚¹ï¼Œæ¯ä¸ªæ ¼å­åŒ…å«ä¸€ä¸ªå¯æ—‹è½¬çš„ç”µå­å…ƒä»¶ï¼Œç”µå­å…ƒä»¶è¿æ¥ä¸€æ¡å¯¹è§’çº¿ä¸Šçš„ä¸¤ä¸ªæ¥ç‚¹ã€‚è¾¾è¾¾å¸Œæœ›é€šè¿‡æ—‹è½¬æœ€å°‘æ•°é‡çš„å…ƒä»¶ï¼Œä½¿ç”µæºä¸å‘åŠ¨è£…ç½®é€šè¿‡è‹¥å¹²æ¡çŸ­ç¼†ç›¸è¿ï¼Œä½†å› ä¸ºæŸäº›å…ƒä»¶çš„æ–¹å‘ä¸æ­£ç¡®ï¼Œå¯¼è‡´ç”µè·¯æ¿å¯èƒ½å¤„äºæ–­è·¯çš„çŠ¶æ€ã€‚éœ€è¦è®¡ç®—æœ€å°‘æ—‹è½¬çš„æ¬¡æ•°æ¥ä½¿å¾—ç”µæºå’Œå‘åŠ¨æœºä¹‹é—´è¿é€šã€‚</p>
<p><strong>å®ç°æ€è·¯</strong>ï¼šå¯ä»¥ä½¿ç”¨å¹¿åº¦ä¼˜å…ˆæœç´¢ï¼ˆBFSï¼‰æ¥è§£å†³æ­¤é—®é¢˜ã€‚é¦–å…ˆï¼Œåˆå§‹åŒ–ä¸€ä¸ªäºŒç»´æ•°ç»„ d ç”¨äºå­˜å‚¨ä»èµ·ç‚¹åˆ°æ¯ä¸ªç‚¹çš„æœ€çŸ­è·ç¦»ã€‚ç„¶åï¼Œåˆ©ç”¨å¹¿åº¦ä¼˜å…ˆæœç´¢çš„æ–¹å¼éå†ç”µè·¯æ¿çš„æ¯ä¸ªæ ¼ç‚¹ï¼Œå¦‚æœå‘ç°æŸä¸ªæ ¼ç‚¹çš„çŠ¶æ€éœ€è¦æ”¹å˜ï¼ˆå³å½“å‰æ ¼ç‚¹çš„å…ƒä»¶æ–¹å‘ä¸æ‰€éœ€æ–¹å‘ä¸ä¸€è‡´ï¼‰ï¼Œåˆ™æ›´æ–°è¯¥æ ¼ç‚¹çš„çŠ¶æ€å¹¶å°†å…¶åŠ å…¥åˆ°é˜Ÿåˆ—ä¸­ã€‚æœ€åï¼Œè¿”å›ç»ˆç‚¹çš„æœ€çŸ­è·ç¦»å³å¯ï¼Œå¦‚æœæ— æ³•åˆ°è¾¾ç»ˆç‚¹ï¼Œåˆ™è¾“å‡º &ldquo;NO SOLUTION&rdquo;ã€‚</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-29-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-29-1"> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-29-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-29-2"> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-29-3"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-29-3"> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-29-4"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-29-4"> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-29-5"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-29-5"> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-29-6"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-29-6"> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-29-7"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-29-7"> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-29-8"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-29-8"> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-29-9"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-29-9"> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-29-10"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-29-10">10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-29-11"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-29-11">11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-29-12"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-29-12">12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-29-13"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-29-13">13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-29-14"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-29-14">14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-29-15"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-29-15">15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-29-16"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-29-16">16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-29-17"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-29-17">17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-29-18"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-29-18">18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-29-19"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-29-19">19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-29-20"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-29-20">20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-29-21"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-29-21">21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-29-22"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-29-22">22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-29-23"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-29-23">23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-29-24"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-29-24">24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-29-25"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-29-25">25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-29-26"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-29-26">26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-29-27"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-29-27">27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-29-28"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-29-28">28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-29-29"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-29-29">29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-29-30"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-29-30">30</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-29-31"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-29-31">31</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-29-32"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-29-32">32</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-29-33"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-29-33">33</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-29-34"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-29-34">34</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-29-35"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-29-35">35</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-29-36"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-29-36">36</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-29-37"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-29-37">37</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#f92672">import</span> sys
</span></span><span style="display:flex;"><span>input <span style="color:#f92672">=</span> <span style="color:#66d9ef">lambda</span>:sys<span style="color:#f92672">.</span>stdin<span style="color:#f92672">.</span>readline()<span style="color:#f92672">.</span>strip()
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> collections <span style="color:#f92672">import</span> deque
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>dire <span style="color:#f92672">=</span> [(<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>), (<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>), (<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>), (<span style="color:#ae81ff">1</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)]
</span></span><span style="display:flex;"><span>mov <span style="color:#f92672">=</span> [(<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>), (<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>), (<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>), (<span style="color:#ae81ff">0</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)]
</span></span><span style="display:flex;"><span>ch <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">/</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">/&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">bfs</span>():
</span></span><span style="display:flex;"><span>    dq <span style="color:#f92672">=</span> deque()
</span></span><span style="display:flex;"><span>    d <span style="color:#f92672">=</span> [[float(<span style="color:#e6db74">&#39;inf&#39;</span>)]<span style="color:#f92672">*</span>(c<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>) <span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> range(r<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)]
</span></span><span style="display:flex;"><span>    d[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    dq<span style="color:#f92672">.</span>append((<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>))
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> dq:
</span></span><span style="display:flex;"><span>        x, y <span style="color:#f92672">=</span> dq<span style="color:#f92672">.</span>popleft()
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">4</span>):
</span></span><span style="display:flex;"><span>            xx, yy <span style="color:#f92672">=</span> x <span style="color:#f92672">+</span> dire[i][<span style="color:#ae81ff">0</span>], y <span style="color:#f92672">+</span> dire[i][<span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> <span style="color:#ae81ff">0</span><span style="color:#f92672">&lt;=</span>xx<span style="color:#f92672">&lt;=</span>r <span style="color:#f92672">and</span> <span style="color:#ae81ff">0</span><span style="color:#f92672">&lt;=</span>yy<span style="color:#f92672">&lt;=</span>c:
</span></span><span style="display:flex;"><span>                j, k <span style="color:#f92672">=</span> x<span style="color:#f92672">+</span>mov[i][<span style="color:#ae81ff">0</span>], y <span style="color:#f92672">+</span> mov[i][<span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>                w <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span> <span style="color:#66d9ef">if</span> g[j][k] <span style="color:#f92672">!=</span> ch[i] <span style="color:#66d9ef">else</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>                
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> d[xx][yy] <span style="color:#f92672">&gt;</span> d[x][y] <span style="color:#f92672">+</span> w:
</span></span><span style="display:flex;"><span>                    d[xx][yy] <span style="color:#f92672">=</span> d[x][y] <span style="color:#f92672">+</span> w
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">if</span> w:
</span></span><span style="display:flex;"><span>                        dq<span style="color:#f92672">.</span>append((xx, yy))
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>                        dq<span style="color:#f92672">.</span>appendleft((xx, yy))
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span> <span style="color:#66d9ef">if</span> d[r][c] <span style="color:#f92672">==</span> float(<span style="color:#e6db74">&#39;inf&#39;</span>) <span style="color:#66d9ef">else</span> d[r][c]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>t <span style="color:#f92672">=</span> int(input())
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> range(t):
</span></span><span style="display:flex;"><span>    r, c <span style="color:#f92672">=</span> map(int, input()<span style="color:#f92672">.</span>split())
</span></span><span style="display:flex;"><span>    g <span style="color:#f92672">=</span> [input() <span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> range(r)]
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    res <span style="color:#f92672">=</span> bfs()
</span></span><span style="display:flex;"><span>    print(res <span style="color:#66d9ef">if</span> res <span style="color:#f92672">!=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span> <span style="color:#66d9ef">else</span> <span style="color:#e6db74">&#34;NO SOLUTION&#34;</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="a-179-å…«æ•°ç httpswwwacwingcomproblemcontentdescription181"><code>A*</code> <a href="https://www.acwing.com/problem/content/description/181/">179. å…«æ•°ç </a><a hidden class="anchor" aria-hidden="true" href="#a-179-å…«æ•°ç httpswwwacwingcomproblemcontentdescription181">#</a></h3>
<p><strong>é¢˜ç›®å¤§æ„</strong>ï¼šåœ¨ä¸€ä¸ª 3Ã—3 çš„ç½‘æ ¼ä¸­ï¼Œæ•°å­— 1âˆ¼8 ä¸ä¸€ä¸ª x æ°å¥½ä¸é‡ä¸æ¼åœ°åˆ†å¸ƒåœ¨è¿™ä¸ªç½‘æ ¼ä¸­ã€‚å¯ä»¥é€šè¿‡æŠŠ x ä¸å…¶ä¸Šã€ä¸‹ã€å·¦ã€å³å››ä¸ªæ–¹å‘ä¹‹ä¸€çš„æ•°å­—äº¤æ¢ï¼ˆå¦‚æœå­˜åœ¨ï¼‰æ¥æ”¹å˜ç½‘æ ¼çš„çŠ¶æ€ï¼Œç›®æ ‡æ˜¯é€šè¿‡æœ€å°‘çš„ç§»åŠ¨æ¬¡æ•°ï¼Œä½¿å¾—ç½‘æ ¼å˜ä¸ºæ­£ç¡®æ’åˆ—ã€‚</p>
<p><strong>å®ç°æ€è·¯</strong>ï¼šä½¿ç”¨ <code>A*</code> ç®—æ³•æ¥è§£å†³è¯¥é—®é¢˜ã€‚é¦–å…ˆï¼Œå®šä¹‰ä¸€ä¸ªå¯å‘å‡½æ•°ç”¨äºä¼°è®¡å½“å‰çŠ¶æ€åˆ°è¾¾ç›®æ ‡çŠ¶æ€çš„æœ€å°ç§»åŠ¨æ¬¡æ•°ã€‚ç„¶åï¼Œåˆ©ç”¨ A* ç®—æ³•è¿›è¡Œæœç´¢ï¼Œä¸æ–­æ›´æ–°å½“å‰çŠ¶æ€åˆ°è¾¾ç›®æ ‡çŠ¶æ€çš„æœ€å°ç§»åŠ¨æ¬¡æ•°ï¼Œå¹¶è®°å½•æ¯ä¸€æ­¥çš„ç§»åŠ¨æ“ä½œã€‚æœ€åï¼Œè¾“å‡ºå¾—åˆ°çš„å®Œæ•´è¡ŒåŠ¨è®°å½•å³å¯ã€‚å¦‚æœä¸å­˜åœ¨è§£å†³æ–¹æ¡ˆï¼Œåˆ™è¾“å‡º &ldquo;unsolvable&rdquo;ã€‚</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-30-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-30-1"> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-30-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-30-2"> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-30-3"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-30-3"> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-30-4"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-30-4"> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-30-5"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-30-5"> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-30-6"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-30-6"> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-30-7"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-30-7"> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-30-8"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-30-8"> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-30-9"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-30-9"> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-30-10"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-30-10">10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-30-11"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-30-11">11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-30-12"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-30-12">12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-30-13"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-30-13">13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-30-14"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-30-14">14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-30-15"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-30-15">15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-30-16"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-30-16">16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-30-17"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-30-17">17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-30-18"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-30-18">18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-30-19"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-30-19">19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-30-20"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-30-20">20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-30-21"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-30-21">21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-30-22"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-30-22">22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-30-23"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-30-23">23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-30-24"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-30-24">24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-30-25"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-30-25">25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-30-26"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-30-26">26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-30-27"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-30-27">27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-30-28"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-30-28">28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-30-29"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-30-29">29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-30-30"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-30-30">30</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-30-31"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-30-31">31</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-30-32"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-30-32">32</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-30-33"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-30-33">33</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-30-34"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-30-34">34</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-30-35"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-30-35">35</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-30-36"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-30-36">36</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-30-37"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-30-37">37</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-30-38"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-30-38">38</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-30-39"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-30-39">39</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-30-40"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-30-40">40</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-30-41"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-30-41">41</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-30-42"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-30-42">42</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-30-43"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-30-43">43</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-30-44"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-30-44">44</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-30-45"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-30-45">45</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-30-46"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-30-46">46</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-30-47"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-30-47">47</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-30-48"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-30-48">48</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-30-49"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-30-49">49</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-30-50"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-30-50">50</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-30-51"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-30-51">51</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-30-52"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-30-52">52</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-30-53"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-30-53">53</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-30-54"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-30-54">54</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-30-55"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-30-55">55</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-30-56"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-30-56">56</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-30-57"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-30-57">57</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-30-58"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-30-58">58</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#f92672">from</span> heapq <span style="color:#f92672">import</span> heappush, heappop
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>d <span style="color:#f92672">=</span> [(<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>), (<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>), (<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>), (<span style="color:#ae81ff">0</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)]
</span></span><span style="display:flex;"><span>op <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;urdl&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">heuristic</span>(state): <span style="color:#75715e"># å¯å‘å¼</span>
</span></span><span style="display:flex;"><span>    ans <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i, st <span style="color:#f92672">in</span> enumerate(state):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> st<span style="color:#f92672">==</span><span style="color:#e6db74">&#39;x&#39;</span>: <span style="color:#66d9ef">continue</span>
</span></span><span style="display:flex;"><span>        t <span style="color:#f92672">=</span> int(st)<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        ans <span style="color:#f92672">+=</span> abs(t<span style="color:#f92672">//</span><span style="color:#ae81ff">3</span> <span style="color:#f92672">-</span> i<span style="color:#f92672">//</span><span style="color:#ae81ff">3</span>) <span style="color:#f92672">+</span> abs(t<span style="color:#f92672">%</span><span style="color:#ae81ff">3</span> <span style="color:#f92672">-</span> i<span style="color:#f92672">%</span><span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> ans
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">astar</span>():
</span></span><span style="display:flex;"><span>    dis, pre <span style="color:#f92672">=</span> dict(), dict()
</span></span><span style="display:flex;"><span>    end <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;12345678x&#34;</span>
</span></span><span style="display:flex;"><span>    dis[start] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    h <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>    heappush(h, (heuristic(start), start))
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> h:
</span></span><span style="display:flex;"><span>        _, state <span style="color:#f92672">=</span> heappop(h)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> state <span style="color:#f92672">==</span> end:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">break</span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        x, y <span style="color:#f92672">=</span> divmod(state<span style="color:#f92672">.</span>index(<span style="color:#e6db74">&#39;x&#39;</span>), <span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span>        src <span style="color:#f92672">=</span> state
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">4</span>):
</span></span><span style="display:flex;"><span>            a, b <span style="color:#f92672">=</span> x<span style="color:#f92672">+</span>d[i][<span style="color:#ae81ff">0</span>], y<span style="color:#f92672">+</span>d[i][<span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> <span style="color:#ae81ff">0</span><span style="color:#f92672">&lt;=</span>a<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">3</span> <span style="color:#f92672">and</span> <span style="color:#ae81ff">0</span><span style="color:#f92672">&lt;=</span>b<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">3</span>:
</span></span><span style="display:flex;"><span>                ls <span style="color:#f92672">=</span> list(state)
</span></span><span style="display:flex;"><span>                ls[<span style="color:#ae81ff">3</span><span style="color:#f92672">*</span>x<span style="color:#f92672">+</span>y], ls[<span style="color:#ae81ff">3</span><span style="color:#f92672">*</span>a<span style="color:#f92672">+</span>b] <span style="color:#f92672">=</span> ls[<span style="color:#ae81ff">3</span><span style="color:#f92672">*</span>a<span style="color:#f92672">+</span>b], ls[<span style="color:#ae81ff">3</span><span style="color:#f92672">*</span>x<span style="color:#f92672">+</span>y]
</span></span><span style="display:flex;"><span>                new_state <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span><span style="color:#f92672">.</span>join(ls)
</span></span><span style="display:flex;"><span>                
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> new_state <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> dis <span style="color:#f92672">or</span> dis[new_state] <span style="color:#f92672">&gt;</span> dis[src] <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>                    dis[new_state] <span style="color:#f92672">=</span> dis[src] <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                    pre[new_state] <span style="color:#f92672">=</span> (op[i], src)
</span></span><span style="display:flex;"><span>                    
</span></span><span style="display:flex;"><span>                    heappush(h, (dis[new_state] <span style="color:#f92672">+</span> heuristic(new_state), new_state))
</span></span><span style="display:flex;"><span>                    
</span></span><span style="display:flex;"><span>    ans <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> end <span style="color:#f92672">!=</span> start:
</span></span><span style="display:flex;"><span>        ans <span style="color:#f92672">=</span> pre[end][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">+</span> ans
</span></span><span style="display:flex;"><span>        end <span style="color:#f92672">=</span> pre[end][<span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> ans
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>start <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span><span style="color:#f92672">.</span>join(input()<span style="color:#f92672">.</span>split())
</span></span><span style="display:flex;"><span>s <span style="color:#f92672">=</span> start<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#39;x&#39;</span>, <span style="color:#e6db74">&#39;&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>cnt <span style="color:#f92672">=</span> sum(s[i]<span style="color:#f92672">&gt;</span>s[j] <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">8</span>) <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(i, <span style="color:#ae81ff">8</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> cnt<span style="color:#f92672">&amp;</span><span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;unsolvable&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>    print(astar())
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ida-æ’ä¹¦"><code>IDA*</code> æ’ä¹¦<a hidden class="anchor" aria-hidden="true" href="#ida-æ’ä¹¦">#</a></h3>
<p>å¯»æ‰¾ä¼°ä»·å‡½æ•°ï¼Œ ä¸€å®šå°äºç­‰äºçœŸå®å€¼ï¼Œå¹¶è¶Šæ¥è¿‘çœŸå®å€¼</p>
<p>è¿™é“é¢˜ç›®è¦æ±‚ç»™å®š n æœ¬ä¹¦ï¼Œæ¯æœ¬ä¹¦ç¼–å·ä¸º 1 åˆ° nï¼Œåˆå§‹çŠ¶æ€ä¸‹ï¼Œä¹¦æ˜¯ä»»æ„æ’åˆ—çš„ã€‚æ¯æ¬¡æ“ä½œå¯ä»¥æŠ½å–å…¶ä¸­è¿ç»­çš„ä¸€æ®µï¼Œå†æŠŠè¿™æ®µæ’å…¥åˆ°å…¶ä»–æŸä¸ªä½ç½®ã€‚ç›®æ ‡æ˜¯å°†ä¹¦æŒ‰ç…§ 1 åˆ° n çš„é¡ºåºä¾æ¬¡æ’åˆ—ã€‚è¦æ±‚è®¡ç®—æœ€å°‘éœ€è¦å¤šå°‘æ¬¡æ“ä½œã€‚</p>
<p><strong>å®ç°æ€è·¯</strong>ï¼š</p>
<ol>
<li>é¦–å…ˆå®šä¹‰ä¸€ä¸ªå‡½æ•° f()ï¼Œç”¨æ¥è®¡ç®—å½“å‰çŠ¶æ€ä¸ç›®æ ‡çŠ¶æ€ä¹‹é—´çš„æœ€å°æ“ä½œæ¬¡æ•°ã€‚è¿™ä¸ªå‡½æ•°é€šè¿‡éå†æ¯å¯¹ç›¸é‚»ä¹¦çš„ç¼–å·ï¼Œåˆ¤æ–­å®ƒä»¬æ˜¯å¦è¿ç»­ï¼Œå¦‚æœä¸è¿ç»­åˆ™éœ€è¦è¿›è¡Œä¸€æ¬¡æ“ä½œã€‚æœ€åè¿”å›æ“ä½œæ¬¡æ•°ã€‚</li>
<li>ç„¶åå®šä¹‰ä¸€ä¸ªæ·±åº¦ä¼˜å…ˆæœç´¢å‡½æ•° dfs(u)ï¼Œå…¶ä¸­ u è¡¨ç¤ºå½“å‰æœç´¢çš„æ·±åº¦ã€‚åœ¨æ¯æ¬¡æœç´¢ä¸­ï¼Œæˆ‘ä»¬éœ€è¦åˆ¤æ–­å½“å‰æ·±åº¦åŠ ä¸Šåˆ°ç›®æ ‡çŠ¶æ€çš„æœ€å°æ“ä½œæ¬¡æ•°æ˜¯å¦è¶…è¿‡å·²ç»å¾—åˆ°çš„æœ€å°æ“ä½œæ¬¡æ•°ï¼Œå¦‚æœè¶…è¿‡åˆ™ç›´æ¥è¿”å› Falseï¼Œå¦åˆ™ç»§ç»­æœç´¢ã€‚</li>
<li>åœ¨ dfs å‡½æ•°ä¸­ï¼Œé¦–å…ˆåˆ¤æ–­å¦‚æœå½“å‰çŠ¶æ€å·²ç»æ˜¯ç›®æ ‡çŠ¶æ€ï¼Œåˆ™ç›´æ¥è¿”å› Trueã€‚å¦åˆ™ï¼Œæˆ‘ä»¬éå†æ‰€æœ‰å¯èƒ½çš„æ“ä½œï¼Œä»ä¸­é€‰æ‹©ä¸€ç§æ“ä½œæ–¹å¼ï¼Œç„¶åé€’å½’è°ƒç”¨ dfs å‡½æ•°ã€‚</li>
<li>åœ¨ä¸»ç¨‹åºä¸­ï¼Œä¾æ¬¡è¯»å…¥æ¯ç»„æ•°æ®ï¼Œç„¶åè¿›è¡Œæ·±åº¦ä¼˜å…ˆæœç´¢ï¼Œç›´åˆ°å¾—åˆ°ç»“æœæˆ–è€…æœç´¢æ·±åº¦è¾¾åˆ° 5ã€‚æœ€åæ ¹æ®å¾—åˆ°çš„ç»“æœè¾“å‡ºæœ€å°æ“ä½œæ¬¡æ•°æˆ–è€… &ldquo;5 or more&rdquo;ã€‚</li>
</ol>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-31-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-31-1"> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-31-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-31-2"> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-31-3"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-31-3"> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-31-4"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-31-4"> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-31-5"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-31-5"> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-31-6"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-31-6"> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-31-7"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-31-7"> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-31-8"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-31-8"> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-31-9"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-31-9"> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-31-10"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-31-10">10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-31-11"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-31-11">11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-31-12"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-31-12">12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-31-13"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-31-13">13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-31-14"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-31-14">14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-31-15"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-31-15">15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-31-16"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-31-16">16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-31-17"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-31-17">17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-31-18"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-31-18">18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-31-19"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-31-19">19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-31-20"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-31-20">20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-31-21"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-31-21">21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-31-22"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-31-22">22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-31-23"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-31-23">23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-31-24"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-31-24">24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-31-25"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-31-25">25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-31-26"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-31-26">26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-31-27"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-31-27">27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-31-28"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-31-28">28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-31-29"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-31-29">29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-31-30"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-31-30">30</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-31-31"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-31-31">31</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-31-32"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-31-32">32</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-31-33"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-31-33">33</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-31-34"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-31-34">34</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-31-35"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-31-35">35</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-31-36"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-31-36">36</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-31-37"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-31-37">37</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-31-38"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-31-38">38</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-31-39"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-31-39">39</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-31-40"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-31-40">40</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-31-41"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-31-41">41</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-31-42"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-31-42">42</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-31-43"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-31-43">43</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-31-44"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-31-44">44</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-31-45"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-31-45">45</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-31-46"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-31-46">46</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-31-47"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-31-47">47</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-31-48"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-31-48">48</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-31-49"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-31-49">49</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-31-50"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-31-50">50</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-31-51"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-31-51">51</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-31-52"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-31-52">52</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-31-53"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-31-53">53</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">f</span>():
</span></span><span style="display:flex;"><span>    res <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(n<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> a[i] <span style="color:#f92672">!=</span> a[i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>            res <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> (res<span style="color:#f92672">+</span><span style="color:#ae81ff">2</span>)<span style="color:#f92672">//</span><span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">dfs</span>(u):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">global</span> a
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> u <span style="color:#f92672">+</span> f() <span style="color:#f92672">&gt;</span> dep:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> f()<span style="color:#f92672">==</span><span style="color:#ae81ff">0</span>: 
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> leng <span style="color:#f92672">in</span> range(n, <span style="color:#ae81ff">0</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> l <span style="color:#f92672">in</span> range(n<span style="color:#f92672">-</span>leng<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>            r <span style="color:#f92672">=</span> l<span style="color:#f92672">+</span>leng<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> k <span style="color:#f92672">in</span> range(l, r<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>                bk <span style="color:#f92672">=</span> a[:]
</span></span><span style="display:flex;"><span>                
</span></span><span style="display:flex;"><span>                j <span style="color:#f92672">=</span> l
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(k<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>, r<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>                    a[j] <span style="color:#f92672">=</span> bk[i]
</span></span><span style="display:flex;"><span>                    j<span style="color:#f92672">+=</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                    
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(l, k<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>                    a[j] <span style="color:#f92672">=</span> bk[i]
</span></span><span style="display:flex;"><span>                    j<span style="color:#f92672">+=</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> dfs(u<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>                
</span></span><span style="display:flex;"><span>                a <span style="color:#f92672">=</span> bk[:]
</span></span><span style="display:flex;"><span>                
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>t <span style="color:#f92672">=</span> int(input())
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">while</span> t:
</span></span><span style="display:flex;"><span>    t<span style="color:#f92672">-=</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    n <span style="color:#f92672">=</span> int(input())
</span></span><span style="display:flex;"><span>    a <span style="color:#f92672">=</span> list(map(int, input()<span style="color:#f92672">.</span>split()))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dep <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> dep<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">5</span> <span style="color:#f92672">and</span> <span style="color:#f92672">not</span> dfs(<span style="color:#ae81ff">0</span>):
</span></span><span style="display:flex;"><span>        dep <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> dep <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">5</span>:
</span></span><span style="display:flex;"><span>        print(dep)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;5 or more&#34;</span>)
</span></span></code></pre></td></tr></table>
</div>
</div>

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://kennems.github.io/tags/%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0/">ç®—æ³•ç¬”è®°</a></li>
      <li><a href="https://kennems.github.io/tags/python/">Python</a></li>
    </ul>
        
    
    <ul id="categories">
      
        <li><a href="https://kennems.github.io/categories/%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0">ç®—æ³•ç¬”è®°</a> </li>
      
    </ul>
    
    
<nav class="paginav">
  <a class="prev" href="https://kennems.github.io/posts/tech/%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0%E4%BA%8C%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84python%E5%AE%9E%E7%8E%B0/">
    <span class="title">Â« ä¸Šä¸€é¡µ</span>
    <br>
    <span>ç®—æ³•ç¬”è®°ï¼ˆäºŒï¼‰â€”â€”æ•°æ®ç»“æ„(Pythonå®ç°)</span>
  </a>
  <a class="next" href="https://kennems.github.io/posts/tech/%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0%E5%9B%9B%E6%95%B0%E5%AD%A6python%E5%AE%9E%E7%8E%B0/">
    <span class="title">ä¸‹ä¸€é¡µ Â»</span>
    <br>
    <span>ç®—æ³•ç¬”è®°ï¼ˆå››ï¼‰â€”â€”æ•°å­¦ï¼ˆPythonå®ç°ï¼‰</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="https://kennems.github.io/">Kennem&#39;s Blog</a></span> Â· 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'å¤åˆ¶';

        function copyingDone() {
            copybutton.innerHTML = 'å·²å¤åˆ¶ï¼';
            setTimeout(() => {
                copybutton.innerHTML = 'å¤åˆ¶';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
<footer class="footer">
    <script async src="https://busuanzi.sukap.cn/busuanzi.pure.mini.js"></script>
    <span id="busuanzi_container">
        <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
        Visitors: <span id="busuanzi_value_page_uv"></span>
        Views: <span id="busuanzi_value_page_pv"></span>

        
    </span>
</footer>



</body>

</html>
