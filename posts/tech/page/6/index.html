<!DOCTYPE html>
<html lang="zh" dir="auto" data-theme="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">

<meta name="msvalidate.01" content="DF5FE493CC759E62BFE073BEA8EFD472" />
<title>ğŸ’»æŠ€æœ¯ | Kennem&#39;s Blog</title>
<meta name="keywords" content="">
<meta name="description" content="ğŸ’»æŠ€æœ¯ - Kennem&#39;s Blog">
<meta name="author" content="ShowGuan">
<link rel="canonical" href="https://kennems.github.io/posts/tech/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.3fd442ca7ec81a7af0b27f3b9117add72bfa97e4a27ff155b8d3426818d63f9b.css" integrity="sha256-P9RCyn7IGnrwsn87kRet1yv6l&#43;Sif/FVuNNCaBjWP5s=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://kennems.github.io/img/sun.png">
<link rel="icon" type="image/png" sizes="16x16" href="https://kennems.github.io/img/sun.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://kennems.github.io/img/sun.png">
<link rel="apple-touch-icon" href="https://kennems.github.io/img/sun.png">
<link rel="mask-icon" href="https://kennems.github.io/img/sun.png">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" type="application/rss+xml" href="https://kennems.github.io/posts/tech/index.xml" title="rss">
<link rel="alternate" hreflang="zh" href="https://kennems.github.io/posts/tech/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
                color-scheme: dark;
            }

            .list {
                background: var(--theme);
            }

            .toc {
                background: var(--entry);
            }
        }

        @media (prefers-color-scheme: light) {
            .list::-webkit-scrollbar-thumb {
                border-color: var(--code-bg);
            }
        }

    </style>
</noscript>
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.querySelector("html").dataset.theme = 'dark';
    } else if (localStorage.getItem("pref-theme") === "light") {
       document.querySelector("html").dataset.theme = 'light';
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.querySelector("html").dataset.theme = 'dark';
    } else {
        document.querySelector("html").dataset.theme = 'light';
    }

</script>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous">

<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.js" integrity="sha384-VQ8d8WVFw0yHhCk5E8I86oOhv48xLpnDZx5T9GogA/Y84DcCKWXDmSDfn13bzFZY" crossorigin="anonymous"></script>

<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/contrib/auto-render.min.js" integrity="sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR" crossorigin="anonymous"
    onload="renderMathInElement(document.body);"></script>

<script>
document.addEventListener("DOMContentLoaded", function() {
    renderMathInElement(document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "$", right: "$", display: false}
        ]
    });
});
</script>



<link rel="stylesheet" href="https://fonts.cdnfonts.com/css/code-new-roman">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

<meta property="og:url" content="https://kennems.github.io/posts/tech/">
  <meta property="og:site_name" content="Kennem&#39;s Blog">
  <meta property="og:title" content="ğŸ’»æŠ€æœ¯">
  <meta property="og:description" content="è®°å½•å€¼å¾—è®°å½•çš„ä¸€åˆ‡">
  <meta property="og:locale" content="zh">
  <meta property="og:type" content="website">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ğŸ’»æŠ€æœ¯">
<meta name="twitter:description" content="è®°å½•å€¼å¾—è®°å½•çš„ä¸€åˆ‡">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "ğŸ“šæ–‡ç« ",
      "item": "https://kennems.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "ğŸ’»æŠ€æœ¯",
      "item": "https://kennems.github.io/posts/tech/"
    }
  ]
}
</script>
<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />
<script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>




</head>
<body class="list" id="top">
    <header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://kennems.github.io/" accesskey="h" title="Kennem&#39;s Blog (Alt + H)">
                <img src="https://kennems.github.io/img/sun.png" alt="" aria-label="logo"
                    height="35">Kennem&#39;s Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://kennems.github.io/" title="ğŸ ä¸»é¡µ">
                    <span>ğŸ ä¸»é¡µ</span>
                </a>
            </li>
            <li>
                <a href="https://kennems.github.io/search" title="ğŸ”æœç´¢ (Alt &#43; /)" accesskey=/>
                    <span>ğŸ”æœç´¢</span>
                </a>
            </li>
            <li>
                <a href="https://kennems.github.io/posts" title="ğŸ“šæ–‡ç« ">
                    <span>ğŸ“šæ–‡ç« </span>
                </a>
            </li>
            <li>
                <a href="https://kennems.github.io/archives" title="â±æ—¶é—´è½´">
                    <span>â±æ—¶é—´è½´</span>
                </a>
            </li>
            <li>
                <a href="https://kennems.github.io/tags" title="ğŸ”–æ ‡ç­¾">
                    <span>ğŸ”–æ ‡ç­¾</span>
                </a>
            </li>
            <li>
                <a href="https://kennems.github.io/categories" title="ğŸ—‚ï¸åˆ†ç±»">
                    <span>ğŸ—‚ï¸åˆ†ç±»</span>
                </a>
            </li>
            <li>
                <a href="https://kennems.github.io/about" title="ğŸ™‹ğŸ»â€â™‚ï¸å…³äº">
                    <span>ğŸ™‹ğŸ»â€â™‚ï¸å…³äº</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main"> 
<header class="page-header"><div class="breadcrumbs"><a href="https://kennems.github.io/">ä¸»é¡µ</a>&nbsp;Â»&nbsp;<a href="https://kennems.github.io/posts/">ğŸ“šæ–‡ç« </a></div>
  <h1>
    ğŸ’»æŠ€æœ¯
  </h1>
</header>



<article class="post-entry">
  <div class="post-info">
    <header class="entry-header">
      <h2>MIT6.S081(4)-Virtual Memory
      </h2>
    </header>
    <div class="entry-content">
      <p>MIT6.S081(4)-Virtual Memory Plan: Address spaces
Paging hardware
xv6 VM code
Virtual memory overview Todayâ€™s problem: [user/kernel diagram] [memory view: diagram with user processes and kernel in memory]
Suppose the shell has a bug:
sometimes it writes to a random memory address how can we keep it from wrecking the kernel? and from wrecking other processes?
we want isolated address spaces each process has its own memory it can read and write its own memory it cannot read or write anything else
...</p>
    </div>
    <footer class="entry-footer"><span title='2024-09-02 22:30:13 +0800 CST'>2024-09-02</span>&nbsp;Â·&nbsp;<span>12 åˆ†é’Ÿ</span>&nbsp;Â·&nbsp;<span>5742 å­—</span>&nbsp;Â·&nbsp;updated:&nbsp;2024-09-02&nbsp;Â·&nbsp;<span>ShowGuan</span></footer>
  </div> 
  <a class="entry-link" aria-label="post link to MIT6.S081(4)-Virtual Memory" href="https://kennems.github.io/posts/tech/mit6.s0814-virtual-memory/"></a>
</article>



<article class="post-entry">
  <div class="post-info">
    <header class="entry-header">
      <h2>MIT6.S081(1)-O/S overview
      </h2>
    </header>
    <div class="entry-content">
      <p>MIT6.S081(1)-O/S overview Class Page Overview 6.S081 goals Understand operating system (O/S) design and implementation Hands-on experience extending a small O/S Hands-on experience writing systems software What is the purpose of an O/S? Abstract the hardware for convenience and portability Multiplex the hardware among many applications Isolate applications in order to contain bugs Allow sharing among cooperating applications Control sharing for security Donâ€™t get in the way of high performance Support a wide range of applications Organization: layered picture user applications: vi, gcc, DB, &amp;c kernel services h/w: CPU, RAM, disk, net, &amp;c we care a lot about the interfaces and internal kernel structure ...</p>
    </div>
    <footer class="entry-footer"><span title='2024-08-31 22:30:13 +0800 CST'>2024-08-31</span>&nbsp;Â·&nbsp;<span>12 åˆ†é’Ÿ</span>&nbsp;Â·&nbsp;<span>5897 å­—</span>&nbsp;Â·&nbsp;updated:&nbsp;2024-08-31&nbsp;Â·&nbsp;<span>ShowGuan</span></footer>
  </div> 
  <a class="entry-link" aria-label="post link to MIT6.S081(1)-O/S overview" href="https://kennems.github.io/posts/tech/mit6.s0811-os-overview/"></a>
</article>



<article class="post-entry">
  <div class="post-info">
    <header class="entry-header">
      <h2>MIT6.S081(3)-OS organization
      </h2>
    </header>
    <div class="entry-content">
      <p>MIT6.S081(3)-OS organization Lecture Topic: OS design â€‹ system calls â€‹ micro/monolithic kernel First system call in xv6
OS picture apps: sh, echo, â€¦ system call interface (open, close,â€¦) OS
Goal of OS run multiple applications isolate them multiplex them share
Strawman design: No OS Application directly interacts with hardware CPU cores &amp; registers DRAM chips Disk blocks â€¦ OS library perhaps abstracts some of it
Strawman design not conducive to multiplexing each app periodically must give up hardware BUT, weak isolation app forgets to give up, no other app runs apps has end-less loop, no other app runs you cannot even kill the badly app from another app but used by real-time OSes â€œcooperative schedulingâ€
...</p>
    </div>
    <footer class="entry-footer"><span title='2024-08-31 22:30:13 +0800 CST'>2024-08-31</span>&nbsp;Â·&nbsp;<span>4 åˆ†é’Ÿ</span>&nbsp;Â·&nbsp;<span>1800 å­—</span>&nbsp;Â·&nbsp;updated:&nbsp;2024-08-31&nbsp;Â·&nbsp;<span>ShowGuan</span></footer>
  </div> 
  <a class="entry-link" aria-label="post link to MIT6.S081(3)-OS organization" href="https://kennems.github.io/posts/tech/mit6.s0813-os-organization/"></a>
</article>



<article class="post-entry">
  <div class="post-info">
    <header class="entry-header">
      <h2>Kotlinåç¨‹(4)
      </h2>
    </header>
    <div class="entry-content">
      <p>Kotlinåç¨‹(4) Kotlinå®è·µéƒ¨åˆ†
Flowä¸æ–‡ä»¶ä¸‹è½½åº”ç”¨ DownloadFragment.kt // DownloadFragment æ˜¯ä¸€ä¸ª Fragment ç±»ï¼Œç”¨äºå¤„ç†æ–‡ä»¶ä¸‹è½½ä»»åŠ¡ class DownloadFragment : Fragment() { // å®šä¹‰ä¸‹è½½æ–‡ä»¶çš„ URL åœ°å€ï¼Œè¿™æ˜¯ä¸€ä¸ªé™æ€çš„å¸¸é‡ val URL = &#34;https://ts1.cn.mm.bing.net/th/id/R-C.56ab5704680b6574c1b3c0a52643d8b5?rik=P8OAzrJEZS%2biuw&amp;riu=http%3a%2f%2fjourneyz.co%2fwp-content%2fuploads%2f2019%2f09%2fGolden-Gate-Bridge.jpg&amp;ehk=WX9eb2rUUjWBLLrsG2MQZLOMk2wtreV%2bT1Qq1tARk4s%3d&amp;risl=&amp;pid=ImgRaw&amp;r=0&#34; // å»¶è¿Ÿåˆå§‹åŒ– mBindingï¼Œè¿™æ˜¯ä¸€ä¸ª FragmentDownloadBinding å¯¹è±¡ï¼Œç”¨äºç»‘å®š XML å¸ƒå±€æ–‡ä»¶ private val mBinding: FragmentDownloadBinding by lazy { FragmentDownloadBinding.inflate(layoutInflater) } // é‡å†™ onCreateView æ–¹æ³•ï¼Œåœ¨ Fragment åˆ›å»ºè§†å›¾æ—¶è°ƒç”¨ override fun onCreateView( inflater: LayoutInflater, container: ViewGroup?, savedInstanceState: Bundle? ): View? { // è¿”å›ç»‘å®šçš„æ ¹è§†å›¾ä½œä¸º Fragment çš„ç•Œé¢ return mBinding.root } // é‡å†™ onActivityCreated æ–¹æ³•ï¼Œå½“ä¸ Fragment ç›¸å…³çš„æ´»åŠ¨çš„ onCreate æ–¹æ³•å®Œæˆæ—¶è°ƒç”¨ @RequiresApi(Build.VERSION_CODES.UPSIDE_DOWN_CAKE) override fun onActivityCreated(savedInstanceState: Bundle?) { super.onActivityCreated(savedInstanceState) // ä½¿ç”¨ lifecycleScope å¯åŠ¨åç¨‹ï¼Œå½“ Fragment çš„ç”Ÿå‘½å‘¨æœŸå¤„äº Created çŠ¶æ€æ—¶æ‰§è¡Œ lifecycleScope.launchWhenCreated { // è·å–ä¸Šä¸‹æ–‡å¹¶æ‰§è¡Œä¸‹è½½æ“ä½œ context?.apply { // æŒ‡å®šä¸‹è½½æ–‡ä»¶çš„å­˜å‚¨ä½ç½®ï¼Œä¿å­˜åœ¨åº”ç”¨çš„å¤–éƒ¨æ–‡ä»¶ç›®å½•ä¸‹ val file = File(getExternalFilesDir(null)?.path, &#34;pic.jpg&#34;) // å¼€å§‹ä¸‹è½½æ–‡ä»¶ï¼Œå¹¶æ”¶é›†ä¸‹è½½çŠ¶æ€ DownloadManager.download(URL, file).collect { status -&gt; when (status) { // å¦‚æœä¸‹è½½è¿‡ç¨‹ä¸­æœ‰è¿›åº¦æ›´æ–° is DownloadStatus.Progress -&gt; { mBinding.apply { // æ›´æ–°è¿›åº¦æ¡å’Œè¿›åº¦æ–‡æœ¬ progressBar.progress = status.value tvProgress.text = &#34;${status.value}%&#34; } } // å¦‚æœä¸‹è½½è¿‡ç¨‹ä¸­å‡ºç°é”™è¯¯ is DownloadStatus.Error -&gt; { Toast.makeText(context, &#34;ä¸‹è½½é”™è¯¯&#34;, Toast.LENGTH_SHORT).show() } // å¦‚æœä¸‹è½½å®Œæˆ is DownloadStatus.Done -&gt; { mBinding.apply { // è®¾ç½®è¿›åº¦æ¡åˆ° 100%ï¼Œå¹¶æ›´æ–°æ–‡æœ¬ä¸º 100% progressBar.progress = 100 tvProgress.text = &#34;100%&#34; } Toast.makeText(context, &#34;ä¸‹è½½å®Œæˆ&#34;, Toast.LENGTH_SHORT).show() } // å¤„ç†å…¶ä»–å¯èƒ½çš„ä¸‹è½½çŠ¶æ€ else -&gt; { Log.d(&#34;Kennem&#34;, &#34;ä¸‹è½½å¤±è´¥&#34;) } } } } } } } DownloadManager.kt object DownloadManager { /** * ä¸‹è½½æŒ‡å®šçš„æ–‡ä»¶å¹¶è¿”å›ä¸‹è½½çŠ¶æ€çš„æµï¼ˆFlowï¼‰ã€‚ * * @param url æ–‡ä»¶ä¸‹è½½çš„ URL åœ°å€ã€‚ * @param file ä¸‹è½½åä¿å­˜çš„æœ¬åœ°æ–‡ä»¶ã€‚ * @return ä¸‹è½½çŠ¶æ€çš„ Flowï¼ŒåŒ…å«ä¸‹è½½è¿›åº¦ã€å®ŒæˆçŠ¶æ€æˆ–é”™è¯¯ä¿¡æ¯ã€‚ */ @RequiresApi(Build.VERSION_CODES.UPSIDE_DOWN_CAKE) fun download(url: String, file: File): Flow&lt;DownloadStatus&gt; { return flow { // æ„å»º HTTP è¯·æ±‚å¯¹è±¡ val request = Request.Builder().url(url).get().build() // æ‰§è¡Œ HTTP è¯·æ±‚ï¼Œè·å–å“åº” val response = OkHttpClient.Builder().build().newCall(request).execute() // æ£€æŸ¥å“åº”æ˜¯å¦æˆåŠŸ if (response.isSuccessful) { response.body()!!.let { body -&gt; // è·å–å†…å®¹çš„æ€»é•¿åº¦ï¼ˆå­—èŠ‚æ•°ï¼‰ val total = body.contentLength() // ä½¿ç”¨è¾“å‡ºæµå°†ä¸‹è½½çš„æ•°æ®å†™å…¥æœ¬åœ°æ–‡ä»¶ file.outputStream().use { output -&gt; val input = body.byteStream() // è·å–è¾“å…¥æµ var emittedProgress = 0L // è®°å½•å·²å‘å‡ºçš„è¿›åº¦ // å°†è¾“å…¥æµä¸­çš„æ•°æ®å¤åˆ¶åˆ°è¾“å‡ºæµï¼ŒåŒæ—¶è·Ÿè¸ªå¤åˆ¶çš„å­—èŠ‚æ•° input.copyTo(output) { bytesCopied -&gt; // è®¡ç®—å½“å‰è¿›åº¦ç™¾åˆ†æ¯” val progress = bytesCopied * 100 / total // æ¯å½“è¿›åº¦æ¯”ä¸Šæ¬¡æ›´æ–°å¤š5%ä»¥ä¸Šæ—¶ï¼Œå‘å‡ºè¿›åº¦æ›´æ–° if (progress - emittedProgress &gt; 5) { delay(100) // æ¨¡æ‹Ÿç½‘ç»œå»¶è¿Ÿï¼ˆå¯é€‰ï¼‰ emit(DownloadStatus.Progress(progress.toInt())) // å‘å‡ºè¿›åº¦çŠ¶æ€ emittedProgress = progress // æ›´æ–°å·²å‘å‡ºçš„è¿›åº¦ } } } } // ä¸‹è½½å®Œæˆï¼Œå‘å‡ºå®ŒæˆçŠ¶æ€ emit(DownloadStatus.Done(file)) } else { // å¦‚æœå“åº”å¤±è´¥ï¼ŒæŠ›å‡ºå¼‚å¸¸ throw IOException(response.toString()) } }.catch { // å¦‚æœå‘ç”Ÿé”™è¯¯ï¼Œåˆ é™¤éƒ¨åˆ†ä¸‹è½½çš„æ–‡ä»¶å¹¶å‘å‡ºé”™è¯¯çŠ¶æ€ file.delete() emit(DownloadStatus.Error(it)) }.flowOn(Dispatchers.IO) // åœ¨ IO çº¿ç¨‹ä¸Šè¿è¡Œä¸‹è½½æµç¨‹ } } DownloadStatus.kt /** * å°é—­ç±»ï¼Œç”¨äºè¡¨ç¤ºä¸‹è½½è¿‡ç¨‹ä¸­çš„ä¸åŒçŠ¶æ€ã€‚ * å°é—­ç±»å…è®¸å®šä¹‰ä¸€ä¸ªæœ‰é™çš„ç±»å‹é›†åˆï¼Œåœ¨ä½¿ç”¨ `when` è¡¨è¾¾å¼æ—¶æä¾›å…¨é¢çš„ç±»å‹æ£€æŸ¥ã€‚ */ sealed class DownloadStatus { /** * è¡¨ç¤ºåˆå§‹çŠ¶æ€ï¼Œå³å°šæœªå¼€å§‹ä¸‹è½½ã€‚ * å¯ä»¥ç”¨äºåˆå§‹åŒ–æˆ–é‡ç½®çŠ¶æ€ã€‚ */ object None : DownloadStatus() /** * è¡¨ç¤ºæ­£åœ¨è¿›è¡Œçš„ä¸‹è½½çš„è¿›åº¦ã€‚ * @param value ä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºå½“å‰çš„è¿›åº¦ç™¾åˆ†æ¯”ï¼ˆ0-100ï¼‰ã€‚ */ data class Progress(val value: Int) : DownloadStatus() /** * è¡¨ç¤ºä¸‹è½½è¿‡ç¨‹ä¸­å‘ç”Ÿçš„é”™è¯¯ã€‚ * @param throwable å¼•å‘å¤±è´¥çš„å¼‚å¸¸æˆ–é”™è¯¯ã€‚ */ data class Error(val throwable: Throwable) : DownloadStatus() /** * è¡¨ç¤ºä¸‹è½½æˆåŠŸå®Œæˆã€‚ * @param file ä¸‹è½½å®Œæˆçš„æ–‡ä»¶ã€‚ */ data class Done(val file: File) : DownloadStatus() } Flowä¸Roomçš„åº”ç”¨ ...</p>
    </div>
    <footer class="entry-footer"><span title='2024-08-25 22:30:13 +0800 CST'>2024-08-25</span>&nbsp;Â·&nbsp;<span>10 åˆ†é’Ÿ</span>&nbsp;Â·&nbsp;<span>4536 å­—</span>&nbsp;Â·&nbsp;updated:&nbsp;2024-08-27&nbsp;Â·&nbsp;<span>ShowGuan</span></footer>
  </div> 
  <a class="entry-link" aria-label="post link to Kotlinåç¨‹(4)" href="https://kennems.github.io/posts/tech/kotlin%E5%8D%8F%E7%A8%8B4/"></a>
</article>



<article class="post-entry">
  <div class="post-info">
    <header class="entry-header">
      <h2>Git
      </h2>
    </header>
    <div class="entry-content">
      <p>Git git ç”± linus å¼€å‘ã€‚
Gitæµç¨‹å›¾ cloneï¼ˆå…‹éš†)ï¼‰ï¼š ä»è¿œç¨‹ä»“åº“ä¸­å…‹éš†ä»£ç åˆ°æœ¬åœ°ä»“åº“ checkoutï¼ˆæ£€å‡ºï¼‰ï¼šä»æœ¬åœ°ä»“åº“ä¸­æ£€å‡ºä¸€ä¸ªä»“åº“åˆ†æ”¯ç„¶åè¿›è¡Œä¿®è®¢ addï¼ˆæ·»åŠ ï¼‰ï¼šåœ¨æäº¤å‰å…ˆå°†ä»£ç æäº¤åˆ°æš‚å­˜åŒº commitï¼ˆæäº¤ï¼‰ï¼šæäº¤åˆ°æœ¬åœ°ä»“åº“ï¼Œæœ¬åœ°ä»“åº“ä¸­ä¿å­˜ä¿®æ”¹çš„å„ä¸ªå†å²ç‰ˆæœ¬ fetchï¼ˆæŠ“å–ï¼‰ï¼šä»è¿œç¨‹åº“ï¼ŒæŠ“å–åˆ°æœ¬åœ°ä»“åº“ï¼Œä¸è¿›è¡Œä»»ä½•çš„åˆå¹¶åŠ¨ä½œï¼Œä¸€èˆ¬æ“ä½œæ¯”è¾ƒå°‘ã€‚ pullï¼ˆæ‹‰å–ï¼‰ï¼šä»è¿œç¨‹åº“æ‹‰åˆ°æœ¬åœ°åº“ï¼Œè‡ªåŠ¨è¿›è¡Œåˆå¹¶ï¼ˆmergeï¼‰ï¼Œç„¶åæ”¾åˆ°å·¥ä½œåŒºï¼Œç›¸å½“äºfetch &#43; merge pushï¼ˆæ¨é€ï¼‰ï¼šä¿®æ”¹å®Œæˆåï¼Œéœ€è¦å’Œå›¢é˜Ÿæˆå‘˜å…±äº«ä»£ç æ—¶ï¼Œå°†ä»£ç æ¨é€åˆ°è¿œç¨‹ä»“åº“ GitåŸºæœ¬é…ç½® git config --global user.name &#34;xxx&#34; git config --global user.email &#34;xxx@gmail.com&#34; git config --global user.name git config --global user.email ç»™ä¸€äº›é•¿å‘½ä»¤èµ·åˆ«åï¼š
...</p>
    </div>
    <footer class="entry-footer"><span title='2024-08-20 22:30:13 +0800 CST'>2024-08-20</span>&nbsp;Â·&nbsp;<span>9 åˆ†é’Ÿ</span>&nbsp;Â·&nbsp;<span>4449 å­—</span>&nbsp;Â·&nbsp;updated:&nbsp;2024-08-20&nbsp;Â·&nbsp;<span>ShowGuan</span></footer>
  </div> 
  <a class="entry-link" aria-label="post link to Git" href="https://kennems.github.io/posts/tech/git/"></a>
</article>



<article class="post-entry">
  <div class="post-info">
    <header class="entry-header">
      <h2>Kotlinåç¨‹(3)
      </h2>
    </header>
    <div class="entry-content">
      <p>Kotlinåç¨‹(3) æ“ä½œç¬¦ è¿‡æ¸¡æµæ“ä½œç¬¦ å¯ä»¥ä½¿ç”¨æ“ä½œç¬¦è½¬æ¢ç¬¦ï¼Œå°±åƒä½¿ç”¨é›†åˆä¸åºåˆ—ä¸€æ · è¿‡æ¸¡æ“ä½œç¬¦åº”ç”¨äºä¸Šæ¸¸æµï¼Œå¹¶è¿”å›ä¸‹æ¸¸æµã€‚ è¿™äº›æ“ä½œç¬¦ä¹Ÿæ˜¯å†·æ“ä½œç¬¦ï¼Œå°±åƒæµä¸€æ ·ã€‚è¿™ç±»æ“ä½œç¬¦æœ¬èº«ä¸æ˜¯æŒ‚èµ·å‡½æ•°ã€‚ å®ƒè¿è¡Œçš„é€Ÿåº¦å¾ˆå¿«ï¼Œè¿”å›æ–°çš„è½¬æ¢æµçš„å®šä¹‰ã€‚ transform() // å®šä¹‰ä¸€ä¸ªæŒ‚èµ·å‡½æ•°ï¼Œæ¨¡æ‹Ÿå‘é€è¯·æ±‚å¹¶è¿”å›å“åº” suspend fun performRequest(request: Int): String { delay(1000) // æ¨¡æ‹Ÿç½‘ç»œå»¶è¿Ÿï¼Œå»¶è¿Ÿ 1000 æ¯«ç§’ï¼ˆ1 ç§’ï¼‰ return &#34;response $request&#34; // è¿”å›ä¸€ä¸ªå“åº”å­—ç¬¦ä¸² } // æµ‹è¯•å‡½æ•°ï¼Œä½¿ç”¨ JUnit æµ‹è¯•æ¡†æ¶ @Test fun `test transform flow operator`() = runBlocking { // å°†æ•´æ•°èŒƒå›´è½¬æ¢ä¸º Flow (1..3).asFlow() .transform { request -&gt; // ä½¿ç”¨ transform è¿ç®—ç¬¦è½¬æ¢æµçš„å…ƒç´  emit(&#34;Making request $request&#34;) // å‘å°„ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºæ­£åœ¨å‘é€è¯·æ±‚ emit(performRequest(request)) // å‘å°„ performRequest çš„è¿”å›å€¼ } .collect { v -&gt; // æ”¶é›†æµçš„å…ƒç´  println(v) // æ‰“å°æ”¶é›†åˆ°çš„å…ƒç´  } } take() // å®šä¹‰ä¸€ä¸ªç®€å•çš„ Flowï¼Œäº§ç”Ÿ Int ç±»å‹çš„å€¼ fun numbers() = flow&lt;Int&gt; { try { emit(1) // å‘å°„ç¬¬ä¸€ä¸ªæ•´æ•° 1 emit(2) // å‘å°„ç¬¬äºŒä¸ªæ•´æ•° 2 println(&#34;This line will not execute&#34;) // è¿™ä¸€è¡Œä»£ç ä¸ä¼šè¢«æ‰§è¡Œï¼Œå› ä¸º collect æ“ä½œä¼šæå‰ä¸­æ­¢ Flow emit(3) // å‘å°„ç¬¬ä¸‰ä¸ªæ•´æ•° 3ï¼ˆä¸ä¼šæ‰§è¡Œï¼‰ } finally { // åœ¨ Flow è¢«æ”¶é›†å®Œæˆæˆ–å–æ¶ˆæ—¶æ‰§è¡Œ println(&#34;Finally in numbers&#34;) // æ‰“å° &#34;Finally in numbers&#34;ï¼Œè¡¨ç¤º finally å—çš„æ‰§è¡Œ } } // æµ‹è¯•å‡½æ•°ï¼Œä½¿ç”¨ JUnit æµ‹è¯•æ¡†æ¶ @Test fun `test limit length operator`() = runBlocking { // è°ƒç”¨ numbers å‡½æ•°ï¼Œé™åˆ¶æ”¶é›†çš„å…ƒç´ æ•°é‡ä¸º 2 numbers() .take(2) // ä½¿ç”¨ take è¿ç®—ç¬¦ï¼Œåªæ”¶é›†å‰ 2 ä¸ªå…ƒç´  .collect { v -&gt; // æ”¶é›† Flow ä¸­çš„å…ƒç´  println(v) // æ‰“å°æ¯ä¸ªæ”¶é›†åˆ°çš„å…ƒç´  } } æœ«ç«¯æ“ä½œç¬¦ æœ«ç«¯æ“ä½œç¬¦æ˜¯åœ¨æµä¸Šç”¨äºå¯åŠ¨æµæ”¶é›†çš„æŒ‚èµ·å‡½æ•°ã€‚collectæ˜¯æœ€åŸºç¡€çš„æœ«ç«¯æ“ä½œç¬¦ï¼Œä½†æ˜¯è¿˜æœ‰å¦å¤–ä¸€äº›æ›´æ–¹ä¾¿ä½¿ç”¨çš„æœ«ç«¯æ“ä½œç¬¦ è½¬åŒ–ä¸ºå„ç§é›†åˆï¼Œä¾‹å¦‚toListå’ŒtoSet è·å–ç¬¬ä¸€ä¸ªï¼ˆfirstï¼‰å€¼ä¸ç¡®ä¿æµå‘å°„å•ä¸ªï¼ˆsingleï¼‰å€¼çš„æ“ä½œç¬¦ ä½¿ç”¨reduceä¸foldå°†æµè§„çº¦åˆ°å•ä¸ªå€¼ ç»„åˆå¤šä¸ªæµ å°±åƒKotlinæ ‡å‡†åº“ä¸­çš„Sequence.zipæ‹“å±•å‡½æ•°ä¸€æ ·ï¼Œæµæ‹¥æœ‰ä¸€ä¸ªzipæ“ä½œç¬¦ç”¨äºç»„åˆä¸¤ä¸ªæµä¸­çš„ç›¸å…³å€¼ @Test fun `test zip2`() = runBlocking { // åˆ›å»ºä¸€ä¸ªæ•´æ•°æµï¼Œå‘å°„ 1 åˆ° 3 çš„æ•°å­—ï¼Œæ¯ä¸ªæ•°å­—å‘å°„ä¹‹é—´å»¶è¿Ÿ 300 æ¯«ç§’ val numbs = (1..3).asFlow().onEach { delay(300) // æ¨¡æ‹Ÿå»¶è¿Ÿ } // åˆ›å»ºä¸€ä¸ªå­—ç¬¦ä¸²æµï¼Œå‘å°„ &#34;one&#34;ã€&#34;two&#34; å’Œ &#34;three&#34; çš„å­—ç¬¦ä¸²ï¼Œæ¯ä¸ªå­—ç¬¦ä¸²å‘å°„ä¹‹é—´å»¶è¿Ÿ 400 æ¯«ç§’ val strs = flowOf(&#34;one&#34;, &#34;two&#34;, &#34;three&#34;).onEach { delay(400) // æ¨¡æ‹Ÿå»¶è¿Ÿ } // è®°å½•æµ‹è¯•å¼€å§‹æ—¶é—´ val startTime = System.currentTimeMillis() // ä½¿ç”¨ zip æ“ä½œç¬¦å°†ä¸¤ä¸ªæµçš„å…ƒç´ é…å¯¹ numbs.zip(strs) { a, b -&gt; &#34;$a -&gt; $b&#34; } // å°† numbs å’Œ strs çš„æ¯å¯¹å…ƒç´ ç»„åˆæˆå­—ç¬¦ä¸² .collect { v -&gt; // æ”¶é›†é…å¯¹åçš„å…ƒç´  // æ‰“å°é…å¯¹åçš„å…ƒç´ å’Œä»æµ‹è¯•å¼€å§‹åˆ°å½“å‰æ—¶é—´çš„æ—¶é—´å·® println(&#34;$v, consume time : ${System.currentTimeMillis() - startTime} ms &#34;) } } å±•å¹³æµ æµè¡¨ç¤ºå¼‚æ­¥æ¥æ”¶çš„å€¼åºåˆ—ï¼Œæ‰€ä»¥å¾ˆå®¹æ˜“é‡åˆ°è¿™æ ·çš„æƒ…å†µï¼šæ¯ä¸ªå€¼éƒ½ä¼šè§¦å‘å¯¹å¦ä¸€ä¸ªå€¼åºåˆ—çš„è¯·æ±‚ï¼Œç„¶è€Œï¼Œç”±äºæµå…·æœ‰å¼‚æ­¥çš„æ€§è´¨ï¼Œå› æ­¤éœ€è¦ä¸åŒçš„å±•å¹³æ¨¡å¼ï¼Œä¸ºæ­¤ï¼Œå­˜åœ¨ä¸€ç³»åˆ—çš„æµå±•å¹³æ“ä½œç¬¦ï¼š flatMapConcat è¿æ¥æ¨¡å¼ flatMapMerge åˆå¹¶æ¨¡å¼ flatMapLatest æœ€æ–°å±•å¹³æ¨¡å¼ // ä½¿ç”¨ flatMapConcat æ“ä½œç¬¦çš„æµ‹è¯•å‡½æ•° @Test fun `test flatMapConcat`() = runBlocking&lt;Unit&gt; { val startTime = System.currentTimeMillis() // è®°å½•å¼€å§‹æ—¶é—´ // åˆ›å»ºä¸€ä¸ªæµï¼ŒåŒ…å«æ•°å­— 1 åˆ° 3 (1..3) .asFlow() // å°†æ•°å­—è½¬æ¢ä¸ºæµ .onEach { delay(100) } // åœ¨æ¯ä¸ªå…ƒç´ ä¸Šæ–½åŠ  100 æ¯«ç§’çš„å»¶è¿Ÿ // ä½¿ç”¨ flatMapConcat å°†æ¯ä¸ªå…ƒç´ è½¬æ¢ä¸ºæ–°çš„æµå¹¶ä¸²è” .flatMapConcat { requestFlow(it) } .collect { v -&gt; // æ”¶é›†å¹¶æ‰“å°æ¯ä¸ªå…ƒç´ çš„å€¼ä»¥åŠä»å¼€å§‹åˆ°ç°åœ¨çš„æ¶ˆè€—æ—¶é—´ println(&#34;$v, consume time : ${System.currentTimeMillis() - startTime} ms &#34;) } } // ä½¿ç”¨ flatMapMerge æ“ä½œç¬¦çš„æµ‹è¯•å‡½æ•° @Test fun `test flatMapMerge`() = runBlocking&lt;Unit&gt; { val startTime = System.currentTimeMillis() // è®°å½•å¼€å§‹æ—¶é—´ // åˆ›å»ºä¸€ä¸ªæµï¼ŒåŒ…å«æ•°å­— 1 åˆ° 3 (1..3) .asFlow() // å°†æ•°å­—è½¬æ¢ä¸ºæµ .onEach { delay(100) } // åœ¨æ¯ä¸ªå…ƒç´ ä¸Šæ–½åŠ  100 æ¯«ç§’çš„å»¶è¿Ÿ // ä½¿ç”¨ flatMapMerge å°†æ¯ä¸ªå…ƒç´ è½¬æ¢ä¸ºæ–°çš„æµå¹¶å¹¶å‘æ‰§è¡Œ .flatMapMerge { requestFlow(it) } .collect { v -&gt; // æ”¶é›†å¹¶æ‰“å°æ¯ä¸ªå…ƒç´ çš„å€¼ä»¥åŠä»å¼€å§‹åˆ°ç°åœ¨çš„æ¶ˆè€—æ—¶é—´ println(&#34;$v, consume time : ${System.currentTimeMillis() - startTime} ms &#34;) } } // ä½¿ç”¨ flatMapLatest æ“ä½œç¬¦çš„æµ‹è¯•å‡½æ•° @Test fun `test flatMapLatest`() = runBlocking&lt;Unit&gt; { val startTime = System.currentTimeMillis() // è®°å½•å¼€å§‹æ—¶é—´ // åˆ›å»ºä¸€ä¸ªæµï¼ŒåŒ…å«æ•°å­— 1 åˆ° 3 (1..3) .asFlow() // å°†æ•°å­—è½¬æ¢ä¸ºæµ .onEach { delay(100) } // åœ¨æ¯ä¸ªå…ƒç´ ä¸Šæ–½åŠ  100 æ¯«ç§’çš„å»¶è¿Ÿ // ä½¿ç”¨ flatMapLatest å°†æ¯ä¸ªå…ƒç´ è½¬æ¢ä¸ºæ–°çš„æµï¼Œä»…ä¿ç•™æœ€æ–°æµ .flatMapLatest { requestFlow(it) } .collect { v -&gt; // æ”¶é›†å¹¶æ‰“å°æ¯ä¸ªå…ƒç´ çš„å€¼ä»¥åŠä»å¼€å§‹åˆ°ç°åœ¨çš„æ¶ˆè€—æ—¶é—´ println(&#34;$v, consume time : ${System.currentTimeMillis() - startTime} ms &#34;) } } æµçš„å¼‚å¸¸å¤„ç† å½“è¿ç®—ç¬¦ä¸­çš„å‘å°„å™¨æˆ–ä»£ç æŠ›å‡ºå¼‚å¸¸æ—¶ï¼Œæœ‰å‡ ç§å¤„ç†å¼‚å¸¸çš„æ–¹æ³•ï¼š try/catchå— catchå‡½æ•° /** * æµ‹è¯•ç”¨ä¾‹ `test exception1`ï¼š * ä½¿ç”¨ runBlocking å¯åŠ¨åç¨‹ï¼Œæ”¶é›† simpleFlow çš„å€¼ã€‚ * å¦‚æœå€¼å¤§äº 1ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸å¹¶æ•è·ã€‚ */ @Test fun `test exception1`() = runBlocking&lt;Unit&gt; { try { simpleFlow().collect { v -&gt; println(v) check(v &lt;= 1) { &#34;Collected $v&#34; } } } catch (e: Throwable) { println(&#34;Caught $e&#34;) } } /** * æµ‹è¯•ç”¨ä¾‹ `test exception2`ï¼š * åˆ›å»ºä¸€ä¸ªæµï¼Œå‘å°„ä¸€ä¸ªå€¼åæŠ›å‡ºå¼‚å¸¸ã€‚ * ä½¿ç”¨ catch æ“ä½œç¬¦å¤„ç†å¼‚å¸¸ã€‚ */ @Test fun `test exception2`() = runBlocking&lt;Unit&gt; { flow { emit(1) throw ArithmeticException(&#34;Div 0&#34;) } .catch { e: Throwable -&gt; println(&#34;Caught: $e&#34;) } .flowOn(Dispatchers.IO) .collect { println(it) } } æµçš„å®Œæˆ å½“æµæ”¶é›†å®Œæˆæ—¶ï¼ˆæ™®é€šæƒ…å†µæˆ–å¼‚å¸¸æƒ…å†µï¼‰ï¼Œå®ƒå¯èƒ½éœ€è¦æ‰§è¡Œä¸€ä¸ªåŠ¨ä½œ å‘½ä»¤æ˜¯finallyå— onCompletionå£°æ˜å¼å¤„ç† // å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œè¿”å›1åˆ°3çš„å€¼ä½œä¸º Flow fun simpleFlow2() = (1..3).asFlow() @Test // æµ‹è¯•åœ¨ finally å—ä¸­å®Œæˆæµçš„å¤„ç† fun `test flow complete in finally`() = runBlocking { try { // æ”¶é›† simpleFlow2 æµä¸­çš„æ¯ä¸ªå€¼ simpleFlow2().collect { println(it) } } finally { // æ— è®ºæµçš„æ”¶é›†è¿‡ç¨‹æ˜¯å¦æˆåŠŸï¼Œè¿™æ¡æ¶ˆæ¯éƒ½ä¼šåœ¨æœ€åæ‰“å° println(&#34;Done!&#34;) } } // å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œè¿”å›ä¸€ä¸ª Flow&lt;Int&gt; ç±»å‹çš„æµ fun simpleFlow3() = flow&lt;Int&gt; { // å‘å°„ï¼ˆemitï¼‰ç¬¬ä¸€ä¸ªå€¼ emit(1) // å‘å°„ä¸€ä¸ªå¼‚å¸¸æ¥ä¸­æ–­æµ throw RuntimeException() } @Test // æµ‹è¯•ä½¿ç”¨ onCompletion æ“ä½œç¬¦å¤„ç†æµå®Œæˆ fun `test flow complete in onCompletion`() = runBlocking { simpleFlow3() // åœ¨æµå®Œæˆæ—¶è°ƒç”¨çš„æ“ä½œç¬¦ .onCompletion { exception -&gt; if (exception != null) { // å¦‚æœæœ‰å¼‚å¸¸ï¼Œæ‰“å°æµä»¥å¼‚å¸¸æ–¹å¼å®Œæˆ println(&#34;Flow completed exceptionally&#34;) } } // æ•è·æµä¸­çš„å¼‚å¸¸ .catch { exception -&gt; println(&#34;Caught $exception&#34;) } // æ”¶é›† simpleFlow3 æµä¸­çš„æ¯ä¸ªå€¼ .collect { println(it) } } é€šé“-å¤šè·¯å¤ç”¨-å¹¶å‘å®‰å…¨ Channel Channelæ˜¯ä¸€ä¸ªå¹¶å‘å®‰å…¨çš„é˜Ÿåˆ—ï¼Œå®ƒå¯ä»¥ç”¨æ¥è¿æ¥åç¨‹ï¼Œå®ç°ä¸åŒåç¨‹çš„é€šä¿¡ã€‚ @Test fun `test know channel`() = runBlocking&lt;Unit&gt; { // åˆ›å»ºä¸€ä¸ªæ•´æ•°ç±»å‹çš„é€šé“ï¼Œç”¨äºåœ¨ä¸åŒçš„åç¨‹ä¹‹é—´ä¼ é€’æ•°æ® val channel = Channel&lt;Int&gt;() // åœ¨å…¨å±€èŒƒå›´å†…å¯åŠ¨ä¸€ä¸ªç”Ÿäº§è€…åç¨‹ï¼Œè´Ÿè´£å‘é€šé“å‘é€æ•°æ® val producer = GlobalScope.launch { var i = 0 while (true) { // æ¯æ¬¡å‘é€å‰æš‚åœ1ç§’é’Ÿ delay(1000) // é€’å¢è®¡æ•°å™¨å¹¶å°†å€¼å‘é€åˆ°é€šé“ channel.send(&#43;&#43;i) println(&#34;send $i&#34;) } } // åœ¨å…¨å±€èŒƒå›´å†…å¯åŠ¨ä¸€ä¸ªæ¶ˆè´¹è€…åç¨‹ï¼Œè´Ÿè´£ä»é€šé“æ¥æ”¶æ•°æ® val consumer = GlobalScope.launch { while (true) { // æ¥æ”¶é€šé“ä¸­çš„æ•°æ® val element = channel.receive() println(&#34;receive $element&#34;) } } // ç­‰å¾…ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…åç¨‹ç»“æŸ joinAll(producer, consumer) } Channelçš„å®¹é‡ Channelå®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªé˜Ÿåˆ—ï¼Œé˜Ÿåˆ—ä¸­ä¸€å®šå­˜åœ¨ç¼“å†²åŒºï¼Œä¸€æ—¦è¿™ä¸ªç¼“å†²åŒºæ»¡äº†ï¼Œå¹¶ä¸”ä¸€ç›´æ²¡æœ‰äººè°ƒç”¨receiveå¹¶å–èµ°å‡½æ•°ï¼Œsendå°±éœ€è¦æŒ‚èµ·ã€‚æ•…æ„è®©æ¥æ”¶ç«¯çš„èŠ‚å¥æ”¾æ…¢ï¼Œå‘ç°sendæ€»æ˜¯ä¼šæŒ‚èµ·ï¼Œç›´åˆ°receiveä¹‹åæ‰ä¼šç»§ç»­å¾€ä¸‹æ‰§è¡Œã€‚ è¿­ä»£channel produce ä¸ actor æ„é€ ç”Ÿäº§è€…ä¸æ¶ˆè´¹è€…çš„ä¾¿æ·æ–¹æ³• å¯ä»¥é€šè¿‡produceæ–¹æ³•å¯åŠ¨ä¸€ä¸ªç”Ÿäº§è€…åç¨‹ï¼Œå¹¶è¿”å›ä¸€ä¸ªReceiveChannelï¼Œ å…¶ä»–åç¨‹å°±å¯ä»¥ç”¨è¿™ä¸ªChannelæ¥æ¥æ”¶æ•°æ®äº†ã€‚åä¹‹ï¼Œå¯ä»¥ç”¨actorå¯åŠ¨ä¸€ä¸ªæ¶ˆè´¹è€…åç¨‹ã€‚ @OptIn(DelicateCoroutinesApi::class) @Test fun `test fast consumer channel`() = runBlocking { // åˆ›å»ºä¸€ä¸ªå‘é€é€šé“ï¼Œå®ƒé€šè¿‡actoråç¨‹è¿›è¡Œæ•°æ®æ¥æ”¶å’Œå¤„ç† val sendChannel: SendChannel&lt;Int&gt; = GlobalScope.actor { while (true) { // æ¥æ”¶å¹¶å¤„ç†é€šé“ä¸­çš„æ•°æ® val element = receive() println(element) } } // åœ¨å…¨å±€èŒƒå›´å†…å¯åŠ¨ä¸€ä¸ªç”Ÿäº§è€…åç¨‹ï¼Œè´Ÿè´£å‘é€šé“å‘é€æ•°æ® val producer = GlobalScope.launch { for (i in 0..3) { // å‘é€šé“å‘é€æ•°æ® sendChannel.send(i) } } // ç­‰å¾…ç”Ÿäº§è€…åç¨‹å®Œæˆ producer.join() } Channelçš„å…³é—­ produceå’Œactorè¿”å›çš„Channeléƒ½ä¼šéšç€å¯¹åº”çš„åç¨‹æ‰§è¡Œå®Œæ¯•è€Œå…³é—­ï¼Œä¹Ÿæ­£æ˜¯è¿™æ ·ï¼ŒChannelæ‰è¢«ç§°ä¸ºçƒ­æ•°æ®æµã€‚ å¯¹äºChannelï¼Œå¦‚æœæˆ‘ä»¬è°ƒç”¨äº†å®ƒçš„closeæ–¹æ³•ï¼Œå®ƒä¼šç«‹å³åœæ­¢æ¥æ”¶æ–°å…ƒç´ ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™æ˜¯å®ƒçš„isClosedForSendä¼šç«‹å³è¿”å›trueã€‚è€Œç”±äºChannelç¼“å†²åŒºçš„å­˜åœ¨ï¼Œè¿™æ—¶å€™å¯èƒ½è¿˜æœ‰ä¸€äº›å…ƒç´ æ²¡æœ‰è¢«å¤„ç†å®Œï¼Œå› æ­¤è¦ç­‰æ‰€æœ‰çš„å…ƒç´ éƒ½è¢«è¯»å–ä¹‹åisClosedForSendæ‰ä¼šè¿”å›trueã€‚ Channelçš„ç”Ÿå‘½å‘¨æœŸæœ€å¥½ç”±ä¸»å¯¼æ–¹æ¥ç»´æŠ¤ï¼Œå»ºè®®ç”±ä¸»å¯¼çš„ä¸€æ–¹å®ç°å…³é—­ã€‚ @Test fun `test close channel`() = runBlocking { // åˆ›å»ºä¸€ä¸ªæ— ç•Œé™çš„æ•´æ•°ç±»å‹çš„é€šé“ï¼Œç”¨äºåœ¨ä¸åŒçš„åç¨‹ä¹‹é—´ä¼ é€’æ•°æ® val channel = Channel&lt;Int&gt;(Channel.UNLIMITED) // åœ¨å…¨å±€èŒƒå›´å†…å¯åŠ¨ä¸€ä¸ªç”Ÿäº§è€…åç¨‹ï¼Œè´Ÿè´£å‘é€šé“å‘é€æ•°æ® val producer = GlobalScope.launch { List(3) { channel.send(it) println(&#34;send $it&#34;) } // å‘é€å®Œæˆåå…³é—­é€šé“ channel.close() // æ‰“å°é€šé“çš„å…³é—­çŠ¶æ€ println( &#34;&#34;&#34;close channel. | -ClosedForSend : ${channel.isClosedForSend} | -ClosedForReceive: ${channel.isClosedForReceive} &#34;&#34;&#34;.trimMargin() ) } // åœ¨å…¨å±€èŒƒå›´å†…å¯åŠ¨ä¸€ä¸ªæ¶ˆè´¹è€…åç¨‹ï¼Œè´Ÿè´£ä»é€šé“æ¥æ”¶æ•°æ® val consumer = GlobalScope.launch { for (element in channel) { println(&#34;receive $element&#34;) delay(1000) } // æ¶ˆè´¹å®Œæˆåæ‰“å°é€šé“çš„å…³é—­çŠ¶æ€ println( &#34;&#34;&#34;close channel. | -ClosedForSend : ${channel.isClosedForSend} | -ClosedForReceive: ${channel.isClosedForReceive} &#34;&#34;&#34;.trimMargin() ) } // ç­‰å¾…ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…åç¨‹ç»“æŸ joinAll(producer, consumer) } BroadcastChannel å‘é€ç«¯å’Œæ¥æ”¶ç«¯åœ¨Channelä¸­å­˜åœ¨ä¸€å¯¹å¤šçš„æƒ…å½¢ï¼Œä»æ•°æ®å¤„ç†æœ¬èº«æ¥è®²ï¼Œè™½ç„¶æœ‰å¤šä¸ªæ¥æ”¶ç«¯ï¼Œä½†æ˜¯åŒä¸€ä¸ªå…ƒç´ åªä¼šè¢«ä¸€ä¸ªæ¥æ”¶ç«¯è¯»åˆ°ã€‚å¹¿æ’­åˆ™ä¸ç„¶ï¼Œå¤šä¸ªæ¥æ”¶ç«¯ä¸å­˜åœ¨äº’æ–¥è¡Œä¸ºã€‚
...</p>
    </div>
    <footer class="entry-footer"><span title='2024-08-13 22:30:13 +0800 CST'>2024-08-13</span>&nbsp;Â·&nbsp;<span>10 åˆ†é’Ÿ</span>&nbsp;Â·&nbsp;<span>4549 å­—</span>&nbsp;Â·&nbsp;updated:&nbsp;2024-08-13&nbsp;Â·&nbsp;<span>ShowGuan</span></footer>
  </div> 
  <a class="entry-link" aria-label="post link to Kotlinåç¨‹(3)" href="https://kennems.github.io/posts/tech/kotlin%E5%8D%8F%E7%A8%8B3/"></a>
</article>



<article class="post-entry">
  <div class="post-info">
    <header class="entry-header">
      <h2>Kotlinåç¨‹(2)
      </h2>
    </header>
    <div class="entry-content">
      <p>Kotlinåç¨‹(2) å¼‚å¸¸å¤„ç†çš„å¿…è¦æ€§ @OptIn(ExperimentalStdlibApi::class) // æ ‡è®°è¯¥ä»£ç ä½¿ç”¨äº†å®éªŒæ€§æ ‡å‡†åº“ API @Test // è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªæµ‹è¯•å‡½æ•° fun `test CoroutineContext extend2`() = runBlocking { // ä½¿ç”¨ runBlocking å¯åŠ¨åç¨‹ // åˆ›å»ºä¸€ä¸ªåç¨‹å¼‚å¸¸å¤„ç†å™¨ï¼Œç”¨äºæ•è·åç¨‹ä¸­çš„å¼‚å¸¸ val coroutineExceptionHandler = CoroutineExceptionHandler { _, exception -&gt; println(&#34;Caught : $exception&#34;) // æ‰“å°æ•è·åˆ°çš„å¼‚å¸¸ } // åˆ›å»ºä¸€ä¸ªåç¨‹ä½œç”¨åŸŸï¼ŒåŒ…å«ä¸€ä¸ª Jobï¼Œä½¿ç”¨ä¸»çº¿ç¨‹è°ƒåº¦å™¨å’Œå¼‚å¸¸å¤„ç†å™¨ val scope = CoroutineScope( Job() &#43; Dispatchers.Main &#43; coroutineExceptionHandler // Job() ç”¨äºç®¡ç†åç¨‹çš„ç”Ÿå‘½å‘¨æœŸ ) // åœ¨ IO çº¿ç¨‹ä¸Šå¯åŠ¨ä¸€ä¸ªæ–°çš„åç¨‹ val job = scope.launch(Dispatchers.IO) { // è·å–å½“å‰åç¨‹ä¸Šä¸‹æ–‡ä¸­çš„è°ƒåº¦å™¨ val dispatcher = coroutineContext[CoroutineDispatcher] // æ‰“å°å½“å‰ä½¿ç”¨çš„è°ƒåº¦å™¨ println(&#34;Current dispatcher: $dispatcher&#34;) } // ç­‰å¾…åç¨‹å®Œæˆ job.join() // ç¡®ä¿ä¸»åç¨‹åœ¨å­åç¨‹å®Œæˆåå†ç»§ç»­ } å¼‚å¸¸çš„ä¼ æ’­ åç¨‹æ„å»ºå™¨æœ‰ä¸¤ç§å½¢å¼ï¼š1ã€è‡ªåŠ¨ä¼ æ’­å¼‚å¸¸ï¼ˆlaunchä¸actorï¼‰2ã€å‘ç”¨æˆ·æš´éœ²å¼‚å¸¸ï¼ˆasyncä¸produceï¼‰ï¼Œ å½“è¿™äº›æ„å»ºå™¨ç”¨äºåˆ›å»ºä¸€ä¸ªæ ¹åç¨‹æ—¶ï¼ˆè¯¥åç¨‹ä¸æ˜¯å¦ä¸€ä¸ªåç¨‹çš„å­åç¨‹ï¼‰ï¼Œå‰è€…è¿™ç±»æ„å»ºå™¨ï¼Œå¼‚å¸¸ä¼šåœ¨å®ƒå‘ç”Ÿçš„ç¬¬ä¸€æ—¶é—´è¢«æŠ›å‡ºï¼Œè€Œåè€…åˆ™ä¾èµ–ç”¨æˆ·æ¥æœ€ç»ˆæ¶ˆè´¹å¼‚å¸¸ï¼Œä¾‹å¦‚é€šè¿‡awaitæˆ–receiveã€‚ // æ ¹åç¨‹ @Test @OptIn(DelicateCoroutinesApi::class) fun `test exception propagation`() = runBlocking&lt;Unit&gt; { // åœ¨ GlobalScope ä¸­å¯åŠ¨ä¸€ä¸ªæ–°åç¨‹ï¼Œè¿”å›ä¸€ä¸ª Job å¯¹è±¡ val job = GlobalScope.launch { try { // åœ¨åç¨‹ä¸­æŠ›å‡ºä¸€ä¸ª IndexOutOfBoundsException throw IndexOutOfBoundsException() } catch (e: Exception) { // æ•è·å¼‚å¸¸å¹¶æ‰“å°ä¸€æ¡æ¶ˆæ¯ï¼ŒæŒ‡ç¤ºæ•è·äº† IndexOutOfBoundsException println(&#34;IndexOutOfBoundsException&#34;) // å¦‚æœéœ€è¦å¯ä»¥é€‰æ‹©æ‰“å°å †æ ˆè½¨è¿¹ // e.printStackTrace() } } // ç­‰å¾…åç¨‹å®Œæˆ job.join() // åœ¨ GlobalScope ä¸­å¯åŠ¨ä¸€ä¸ªæ–°åç¨‹ï¼Œå¹¶è¿”å›ä¸€ä¸ª Deferred å¯¹è±¡ val deffer = GlobalScope.async { // åœ¨åç¨‹ä¸­æŠ›å‡ºä¸€ä¸ª ArithmeticException throw ArithmeticException() } try { // ç­‰å¾…å¼‚æ­¥ä»»åŠ¡å®Œæˆå¹¶è·å–ç»“æœï¼Œå¦‚æœä»»åŠ¡æŠ›å‡ºå¼‚å¸¸ï¼Œè¿™é‡Œä¼šé‡æ–°æŠ›å‡ºå¼‚å¸¸ deffer.await() } catch (e: Exception) { // æ•è·å¼‚å¸¸å¹¶æ‰“å°ä¸€æ¡æ¶ˆæ¯ï¼ŒæŒ‡ç¤ºæ•è·äº† ArithmeticException println(&#34;ArithmeticException&#34;) // å¦‚æœéœ€è¦å¯ä»¥é€‰æ‹©æ‰“å°å †æ ˆè½¨è¿¹ // e.printStackTrace() } } éæ ¹åç¨‹çš„å¼‚å¸¸ å…¶ä»–åç¨‹æ‰€åˆ›å»ºçš„åç¨‹ä¸­ï¼Œäº§ç”Ÿçš„å¼‚å¸¸æ€»æ˜¯ä¼šè¢«ä¼ æ’­ /* éæ ¹åç¨‹ï¼Œjobæ˜¯scopeå†…çš„å­åç¨‹ï¼Œæ‰€ä»¥ä¼šç›´æ¥æ¶ˆè´¹æ‰å¼‚å¸¸ */ @Test fun `test exception propagation2`() = runBlocking { // åˆ›å»ºä¸€ä¸ªæ–°çš„ CoroutineScopeï¼Œä½¿ç”¨ Job ä½œä¸ºå…¶ä¸Šä¸‹æ–‡å…ƒç´  val scope = CoroutineScope(Job()) // åœ¨ scope ä¸­å¯åŠ¨ä¸€ä¸ªæ–°åç¨‹ï¼Œè¿”å›ä¸€ä¸ª Job å¯¹è±¡ val job = scope.launch { // åœ¨åç¨‹ä¸­å¯åŠ¨ä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡ async { // åœ¨å¼‚æ­¥ä»»åŠ¡ä¸­æŠ›å‡ºä¸€ä¸ª IllegalArgumentException throw IllegalArgumentException() } } // ç­‰å¾… launch å¯åŠ¨çš„åç¨‹å®Œæˆ job.join() } å¼‚å¸¸çš„ä¼ æ’­ç‰¹æ€§ å½“ä¸€ä¸ªåç¨‹ç”±äºä¸€ä¸ªå¼‚å¸¸è€Œè¿è¡Œå¤±è´¥æ—¶ï¼Œå®ƒä¼šä¼ æ’­è¿™ä¸ªå¼‚å¸¸å¹¶ä¼ é€’ç»™å®ƒçš„çˆ¶çº§ã€‚æ¥ä¸‹æ¥ï¼Œçˆ¶çº§ä¼šè¿›è¡Œä¸‹é¢å‡ æ­¥æ“ä½œï¼š å–æ¶ˆå®ƒè‡ªå·±çš„å­çº§ å–æ¶ˆå®ƒè‡ªå·± å°†å¼‚å¸¸ä¼ æ’­å¹¶ä¼ é€’ç»™å®ƒçš„çˆ¶çº§ SupervisorJob ä½¿ç”¨SupervisorJobæ—¶ï¼Œä¸€ä¸ªå­åç¨‹çš„è¿è¡Œå¤±è´¥ä¸ä¼šå½±å“å…¶ä»–å­åç¨‹ï¼ŒSupervisorJobä¸ä¼šä¼ æ’­å¼‚å¸¸ç»™å®ƒçš„çˆ¶çº§ï¼Œå®ƒä¼šè®©å­åç¨‹è‡ªå·±å¤„ç†å¼‚å¸¸ã€‚ éœ€æ±‚ï¼šåœ¨ä½œç”¨åŸŸå†…å®šä¹‰ä½œä¸šçš„UIç»„ä»¶ï¼Œå¦‚æœä»»ä½•ä¸€ä¸ªUIçš„å­ä½œä¸šæ‰§è¡Œå¤±è´¥äº†ï¼Œå®ƒå¹¶ä¸æ€»æ˜¯æœ‰å¿…è¦å–æ¶ˆæ•´ä¸ªUIç»„ä»¶ï¼Œä½†æ˜¯å¦‚æœUIç»„ä»¶è¢«é”€æ¯äº†ï¼Œç”±äºå®ƒçš„ç»“æœä¸å†è¢«éœ€è¦äº†ï¼Œå®ƒå°±æœ‰å¿…è¦ä½¿æ‰€æœ‰çš„å­ä½œä¸šæ‰§è¡Œå¤±è´¥ã€‚ @Test fun `test supervisorJob`() = runBlocking&lt;Unit&gt; { // åˆ›å»ºä¸€ä¸ªæ–°çš„ CoroutineScopeï¼Œä½¿ç”¨ SupervisorJob ä½œä¸ºå…¶ä¸Šä¸‹æ–‡å…ƒç´  val supervisor = CoroutineScope(SupervisorJob()) // å¦‚æœä½¿ç”¨æ™®é€šçš„ Jobï¼Œæ³¨é‡Šæ‰ä¸Šä¸€è¡Œå¹¶å¯ç”¨ä»¥ä¸‹è¡Œ // val supervisor = CoroutineScope(Job()) // åœ¨ supervisor ä½œç”¨åŸŸä¸­å¯åŠ¨ç¬¬ä¸€ä¸ªå­åç¨‹ï¼Œè¿”å›ä¸€ä¸ª Job å¯¹è±¡ val job1 = supervisor.launch { // å»¶è¿Ÿ 100 æ¯«ç§’ä»¥æ¨¡æ‹Ÿä¸€äº›å·¥ä½œ delay(100) println(&#34;child 1&#34;) // åœ¨ç¬¬ä¸€ä¸ªå­åç¨‹ä¸­æŠ›å‡ºä¸€ä¸ª IllegalArgumentException throw IllegalArgumentException() } // åœ¨ supervisor ä½œç”¨åŸŸä¸­å¯åŠ¨ç¬¬äºŒä¸ªå­åç¨‹ï¼Œè¿”å›ä¸€ä¸ª Job å¯¹è±¡ val job2 = supervisor.launch { try { // æ— é™å»¶è¿Ÿä»¥æ¨¡æ‹Ÿé•¿æ—¶é—´è¿è¡Œçš„ä»»åŠ¡ delay(Long.MAX_VALUE) } finally { // å½“åç¨‹å–æ¶ˆæ—¶ï¼Œæœ€ç»ˆä¼šæ‰“å° &#34;child 2 finished&#34; println(&#34;child 2 finished&#34;) } } // ä»¥ä¸‹æ˜¯å¯é€‰éƒ¨åˆ†ï¼Œå¦‚æœéœ€è¦ï¼Œå¯ä»¥å–æ¶ˆæ³¨é‡Š // å»¶è¿Ÿ 200 æ¯«ç§’åå–æ¶ˆ supervisor ä½œç”¨åŸŸå†…çš„æ‰€æœ‰åç¨‹ // delay(200) // supervisor.cancel() // ç­‰å¾… job1 å’Œ job2 éƒ½å®Œæˆ joinAll(job1, job2) } SupervisorScope å½“ä½œä¸šè‡ªèº«æ‰§è¡Œå¤±è´¥çš„æ—¶å€™ï¼Œæ‰€ä»¥å­ä½œä¸šå°†ä¼šè¢«å…¨éƒ¨å–æ¶ˆ @Test fun `test supervisorScope`() = runBlocking&lt;Unit&gt; { // ä½¿ç”¨ supervisorScope å¯åŠ¨ä¸€ä¸ªæ–°çš„åç¨‹ä½œç”¨åŸŸ supervisorScope { // åœ¨ supervisorScope ä¸­å¯åŠ¨ä¸€ä¸ªå­åç¨‹ï¼Œè¿”å›ä¸€ä¸ª Job å¯¹è±¡ launch { // å»¶è¿Ÿ 100 æ¯«ç§’ä»¥æ¨¡æ‹Ÿä¸€äº›å·¥ä½œ delay(100) // è¾“å‡º &#34;child 1&#34;ï¼Œè¡¨ç¤ºå­åç¨‹å·²å®Œæˆå…¶ä»»åŠ¡ println(&#34;child 1&#34;) // åœ¨åç¨‹ä¸­æŠ›å‡ºä¸€ä¸ª IllegalArgumentExceptionï¼Œä»¥æµ‹è¯•å¼‚å¸¸ä¼ æ’­ throw IllegalArgumentException() } // åœ¨ supervisorScope ä¸­å¯åŠ¨å¦ä¸€ä¸ªåç¨‹ try { // å»¶è¿Ÿä¸€ä¸ªéå¸¸é•¿çš„æ—¶é—´ï¼Œæ¨¡æ‹Ÿé•¿æ—¶é—´è¿è¡Œçš„ä»»åŠ¡ delay(Long.MAX_VALUE) } finally { // å½“ supervisorScope è¢«å–æ¶ˆæ—¶ï¼ˆç”±äºå¼‚å¸¸ï¼‰ï¼Œæœ€ç»ˆä¼šæ‰“å° &#34;child 2 finished.&#34; println(&#34;child 2 finished.&#34;) } } } @Test fun `test supervisorScope2`() = runBlocking&lt;Unit&gt; { // ä½¿ç”¨ supervisorScope æ¥å¯åŠ¨ä¸€ä¸ªåç¨‹ä½œç”¨åŸŸ supervisorScope { // åœ¨ supervisorScope ä¸­å¯åŠ¨ä¸€ä¸ªå­åç¨‹ val child = launch { try { // è¾“å‡º &#34;The child is sleeping&#34; è¡¨ç¤ºå­åç¨‹è¿›å…¥ç¡çœ çŠ¶æ€ println(&#34;The child is sleeping&#34;) // å»¶è¿Ÿæ— é™é•¿çš„æ—¶é—´ï¼Œæ¨¡æ‹Ÿé•¿æ—¶é—´è¿è¡Œçš„ä»»åŠ¡ delay(Long.MAX_VALUE) } finally { // å½“å­åç¨‹è¢«å–æ¶ˆæ—¶ï¼Œæœ€ç»ˆä¼šæ‰“å° &#34;The child is cancelled&#34; println(&#34;The child is cancelled&#34;) } } // è®©å‡ºçº¿ç¨‹ä»¥ç¡®ä¿å­åç¨‹å¯åŠ¨å¹¶è¿›å…¥å»¶è¿ŸçŠ¶æ€ yield() // åœ¨ supervisorScope ä¸­æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ println(&#34;Throwing an exception from the scope&#34;) throw AssertionError() // æŠ›å‡ºä¸€ä¸ªæ–­è¨€é”™è¯¯ï¼Œç”¨äºæµ‹è¯•ä½œç”¨åŸŸçš„å¼‚å¸¸å¤„ç† } } å¼‚å¸¸çš„æ•è· ä½¿ç”¨CoroutineExcepitonHandlerå¯¹åç¨‹çš„å¼‚å¸¸è¿›è¡Œæ•è· ä»¥ä¸‹çš„æ¡ä»¶è¢«æ»¡è¶³æ—¶ï¼Œå¼‚å¸¸å°±ä¼šè¢«æ•è·ï¼š æ—¶æœºï¼šå¼‚å¸¸æ˜¯è¢«è‡ªåŠ¨æŠ›å‡ºå¼‚å¸¸çš„åç¨‹æ‰€æŠ›å‡ºçš„ï¼ˆä½¿ç”¨launchï¼Œè€Œä¸æ˜¯asyncæ—¶ï¼‰ï¼› ä½ç½®ï¼šåœ¨CoroutineScopeçš„CoroutineContextä¸­æˆ–åœ¨ä¸€ä¸ªæ ¹åç¨‹ï¼ˆCoroutineScopeæˆ–è€…supervisorScopeçš„ç›´æ¥å­åç¨‹ï¼‰ä¸­ã€‚ Androidä¸­å…¨å±€å¼‚å¸¸å¤„ç† å…¨å±€å¼‚å¸¸å¤„ç†å™¨å¯ä»¥è·å–åˆ°æ‰€æœ‰åç¨‹æœªå¤„ç†çš„æœªæ•è·å¼‚å¸¸ï¼Œä¸è¿‡å®ƒå¹¶ä¸èƒ½å¯¹å¼‚å¸¸è¿›è¡Œæ•è·ï¼Œè™½ç„¶ä¸èƒ½é˜»æ­¢ç¨‹åºå´©æºƒï¼Œå…¨å±€å¼‚å¸¸å¤„ç†å™¨åœ¨ç¨‹åºè°ƒè¯•å’Œå¼‚å¸¸ä¸ŠæŠ¥ç­‰åœºæ™¯ä¸­ä»ç„¶æœ‰éå¸¸å¤§çš„ç”¨å¤„ã€‚ æˆ‘ä»¬éœ€è¦åœ¨classpathä¸‹é¢åˆ›å»ºMETA-INF/servicesç›®å½•ï¼Œå¹¶åœ¨å…¶ä¸­åˆ›å»ºä¸€ä¸ªåä¸ºkotlinx.coroutines.CoroutineExceptionHandlerçš„æ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹å°±æ˜¯æˆ‘ä»¬çš„å…¨å±€å¼‚å¸¸å¤„ç†å™¨çš„å…¨ç±»åã€‚ å–æ¶ˆä¸å¼‚å¸¸ å–æ¶ˆä¸å¼‚å¸¸ç´§å¯†ç›¸å…³ï¼Œåç¨‹å†…éƒ¨ä½¿ç”¨CancellationExcepitonæ¥è¿›è¡Œå–æ¶ˆï¼Œè¿™ä¸ªå¼‚å¸¸ä¼šè¢«å¿½ç•¥ã€‚ å½“å­åç¨‹è¢«å–æ¶ˆæ—¶ï¼Œä¸ä¼šå–æ¶ˆå®ƒçš„çˆ¶åç¨‹ å¦‚æœä¸€ä¸ªåç¨‹é‡åˆ°äº†CancellationExcepitonä»¥å¤–çš„å¼‚å¸¸ï¼Œå®ƒå°†ä½¿ç”¨è¯¥å¼‚å¸¸å–æ¶ˆå®ƒçš„çˆ¶åç¨‹ã€‚å½“çˆ¶åç¨‹çš„æ‰€æœ‰å­åç¨‹éƒ½ç»“æŸåï¼Œå¼‚å¸¸æ‰ä¼šè¢«çˆ¶åç¨‹å¤„ç†ã€‚ @Test fun `test cancel and exception`() = runBlocking&lt;Unit&gt; { // å¯åŠ¨ä¸€ä¸ªåç¨‹ä½œä¸ºçˆ¶åç¨‹ val job = launch { // åœ¨çˆ¶åç¨‹ä¸­å¯åŠ¨ä¸€ä¸ªå­åç¨‹ val child = launch { try { // å­åç¨‹å°è¯•å»¶è¿Ÿæ‰§è¡Œï¼Œæ¨¡æ‹Ÿé•¿æ—¶é—´è¿è¡Œçš„ä»»åŠ¡ delay(Long.MAX_VALUE) } finally { // å½“å­åç¨‹è¢«å–æ¶ˆæ—¶ï¼Œæ‰§è¡Œæ­¤å— println(&#34;Child is cancelled&#34;) } } // è®©çˆ¶åç¨‹æš‚æ—¶è®©å‡ºçº¿ç¨‹ï¼Œç»™å…¶ä»–åç¨‹æ‰§è¡Œçš„æœºä¼š yield() println(&#34;Cancelling child&#34;) // å–æ¶ˆå­åç¨‹ï¼Œå¹¶ç­‰å¾…å…¶æ‰§è¡Œå®Œ finally å— child.cancelAndJoin() // å†æ¬¡è®©å‡ºçº¿ç¨‹ yield() println(&#34;Parent is not cancelled&#34;) } // ç­‰å¾…çˆ¶åç¨‹å®Œæˆæ‰§è¡Œ job.join() } @Test fun `test cancel and exception2`() = runBlocking&lt;Unit&gt; { // å®šä¹‰ä¸€ä¸ª CoroutineExceptionHandler æ¥å¤„ç†æœªæ•è·çš„å¼‚å¸¸ val handler = CoroutineExceptionHandler { _, exception -&gt; println(&#34;Caught: $exception&#34;) } // ä½¿ç”¨ GlobalScope å¯åŠ¨ä¸€ä¸ªé¡¶å±‚åç¨‹ï¼Œå¹¶åº”ç”¨å¼‚å¸¸å¤„ç†å™¨ val job = GlobalScope.launch(handler) { // ç¬¬ä¸€ä¸ªå­åç¨‹ï¼Œæ¨¡æ‹Ÿä¸€ä¸ªéœ€è¦å¾ˆé•¿æ—¶é—´çš„ä»»åŠ¡ launch { try { // ä½¿ç”¨ä¸€ä¸ªå¾ˆé•¿çš„å»¶è¿Ÿæ¥æ¨¡æ‹Ÿé•¿æ—¶é—´è¿è¡Œçš„ä»»åŠ¡ delay(Long.MAX_VALUE) } finally { // ç¡®ä¿åœ¨åç¨‹è¢«å–æ¶ˆæ—¶ï¼Œæ‰§è¡Œä»¥ä¸‹ä»£ç  withContext(NonCancellable) { println(&#34;Children are cancelled, but exceptions are not handled&#34;) delay(100) // ç¡®ä¿è¾“å‡ºè¯­å¥æœ‰æœºä¼šæ‰§è¡Œ println(&#34;The first child finished its non cancellable block&#34;) } } } // ç¬¬äºŒä¸ªå­åç¨‹ï¼Œåœ¨çŸ­æš‚å»¶è¿ŸåæŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ launch { delay(10) println(&#34;Second child throws an exception&#34;) throw ArithmeticException() // æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸æ¥æµ‹è¯•å¼‚å¸¸å¤„ç† } } // ç­‰å¾…çˆ¶åç¨‹å®Œæˆ job.join() } å¼‚å¸¸èšåˆ å½“åç¨‹çš„å¤šä¸ªå­åç¨‹å› ä¸ºå¼‚å¸¸è€Œå¤±è´¥æ—¶ï¼Œä¸€èˆ¬æƒ…å†µä¸‹å–ç¬¬ä¸€ä¸ªå¼‚å¸¸è¿›è¡Œå¤„ç†ã€‚åœ¨ç¬¬ä¸€å¼‚å¸¸ä¹‹åå‘ç”Ÿçš„æ‰€æœ‰å…¶ä»–å¼‚å¸¸ï¼Œéƒ½å°†ç»‘å®šåˆ°ç¬¬ä¸€ä¸ªå¼‚å¸¸ä¹‹ä¸Šã€‚ @Test fun `test exception aggregation`() = runBlocking&lt;Unit&gt; { // å®šä¹‰ä¸€ä¸ª CoroutineExceptionHandler æ¥å¤„ç†æœªæ•è·çš„å¼‚å¸¸ val handler = CoroutineExceptionHandler { _, exception -&gt; // è¾“å‡ºè¢«æ•è·çš„ä¸»å¼‚å¸¸å’ŒæŠ‘åˆ¶çš„å¼‚å¸¸ï¼ˆå¦‚æœæœ‰ï¼‰ println(&#34;Caught: $exception, Suppressed: ${exception.suppressed.contentToString()}&#34;) } // ä½¿ç”¨ GlobalScope å¯åŠ¨ä¸€ä¸ªé¡¶å±‚åç¨‹ï¼Œå¹¶åº”ç”¨å¼‚å¸¸å¤„ç†å™¨ val job = GlobalScope.launch(handler) { // ç¬¬ä¸€ä¸ªå­åç¨‹ launch { try { // æ¨¡æ‹Ÿé•¿æ—¶é—´è¿è¡Œçš„ä»»åŠ¡ delay(Long.MAX_VALUE) } finally { // åœ¨å–æ¶ˆæ—¶æŠ›å‡º ArithmeticException throw ArithmeticException() } } // ç¬¬äºŒä¸ªå­åç¨‹ launch { try { // è¿›è¡ŒçŸ­æš‚çš„å»¶è¿Ÿ delay(100) } finally { // åœ¨å–æ¶ˆæ—¶æŠ›å‡º IOException throw IOException() } } // ç¬¬ä¸‰ä¸ªå­åç¨‹ launch { try { // è¿›è¡Œæ›´çŸ­æš‚çš„å»¶è¿Ÿ delay(10) } finally { // åœ¨å–æ¶ˆæ—¶æŠ›å‡º IndexOutOfBoundsException throw IndexOutOfBoundsException() } } } // ç­‰å¾…çˆ¶åç¨‹å®Œæˆï¼Œç¡®ä¿æ‰€æœ‰å­åç¨‹çš„å¼‚å¸¸éƒ½è¢«å¤„ç† job.join() } Flow-å¼‚æ­¥æµ // å®šä¹‰ä¸€ä¸ªåä¸º simpleFlow çš„æŒ‚èµ·å‡½æ•°ï¼Œè¿”å›ä¸€ä¸ª Flow&lt;Int&gt; suspend fun simpleFlow() = flow&lt;Int&gt; { // ä½¿ç”¨ for å¾ªç¯éå†ä» 1 åˆ° 100 çš„æ•´æ•° for (i in 1..100) { delay(1000) // å»¶è¿Ÿ 1 ç§’é’Ÿï¼Œæ¨¡æ‹Ÿå¼‚æ­¥ä»»åŠ¡çš„å»¶è¿Ÿ emit(i) // å‘ä¸‹æ¸¸å‘å°„å½“å‰æ•´æ•° } } // è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•å‡½æ•°ï¼Œæ¼”ç¤ºäº†å¼‚æ­¥ã€éé˜»å¡å¼çš„è¡Œä¸º @Test fun `test multiple values3`() = runBlocking&lt;Unit&gt; { // å¯åŠ¨ä¸€ä¸ªæ–°çš„åç¨‹ï¼Œä¸é˜»å¡ä¸»çº¿ç¨‹ launch { // ä½¿ç”¨ for å¾ªç¯æ‰“å°ä¿¡æ¯ï¼Œå±•ç¤ºä¸»çº¿ç¨‹æ²¡æœ‰è¢«é˜»å¡ for (k in 1..3) { println(&#34;I am not blocked $k&#34;) delay(1500) // å»¶è¿Ÿ 1.5 ç§’é’Ÿ } } // æ”¶é›† simpleFlow() å‘å°„çš„å€¼ simpleFlow().collect { value -&gt; println(value) // æ‰“å°æ¯ä¸ªæ”¶é›†åˆ°çš„å€¼ } } å†·æµ Flowæ˜¯ä¸€ç§ç±»ä¼¼äºåºåˆ—çš„å†·æµï¼Œflowæ„å»ºå™¨ä¸­çš„ä»£ç ç›´åˆ°æµè¢«æ”¶é›†çš„æ—¶å€™æ‰è¿è¡Œ // æµ‹è¯•å‡½æ•°ï¼Œæ¼”ç¤º Flow æ˜¯å†·æµçš„æ¦‚å¿µ @Test fun `test flow is cold`() = runBlocking { // åˆ›å»ºä¸€ä¸ªæ–°çš„ Flow å®ä¾‹ val flow = simpleFlow2() // é¦–æ¬¡è°ƒç”¨ collectï¼Œå¼€å§‹æ”¶é›† Flow å‘å°„çš„å€¼ println(&#34;Calling collect...&#34;) flow.collect { value -&gt; println(value) // æ‰“å°æ¯ä¸ªæ”¶é›†åˆ°çš„å€¼ } // å†æ¬¡è°ƒç”¨ collectï¼Œé‡æ–°æ”¶é›† Flow å‘å°„çš„å€¼ println(&#34;Calling collect again...&#34;) flow.collect { value -&gt; println(value) // æ‰“å°æ¯ä¸ªæ”¶é›†åˆ°çš„å€¼ } } æµçš„è¿ç»­æ€§ æµçš„æ¯æ¬¡å•ç‹¬æ”¶é›†éƒ½æ˜¯æŒ‰é¡ºåºæ‰§è¡Œçš„ï¼Œé™¤éä½¿ç”¨ç‰¹æ®Šæ“ä½œç¬¦ ä»ä¸Šæ¸¸åˆ°ä¸‹æ¸¸æ¯ä¸ªè¿‡æ¸¡æ“ä½œç¬¦éƒ½ä¼šå¤„ç†æ¯ä¸ªå‘å°„å‡ºçš„å€¼ï¼Œç„¶åå†äº¤ç»™æœ«ç«¯æ“ä½œç¬¦ã€‚ // æµ‹è¯•å‡½æ•°ï¼Œæ¼”ç¤ºæµçš„è¿ç»­æ“ä½œ @Test fun `test flow continuation`() = runBlocking { // å°† 1 åˆ° 5 çš„æ•´æ•°è½¬æ¢æˆæµ (1..5).asFlow() // è¿‡æ»¤æµï¼Œåªä¿ç•™å¶æ•° .filter { it % 2 == 0 } // å°†æ¯ä¸ªæ•´æ•°è½¬æ¢ä¸ºå­—ç¬¦ä¸² .map { &#34;String $it&#34; } // æ”¶é›†æµä¸­çš„æ¯ä¸ªå…ƒç´  .collect { value -&gt; println(&#34;Collect $value&#34;) // æ‰“å°æ”¶é›†åˆ°çš„æ¯ä¸ªå…ƒç´  } } æµæ„å»ºå™¨ flowOfæ„å»ºå™¨å®šä¹‰äº†ä¸€ä¸ªå‘å°„å›ºå®šå€¼é›†çš„æµã€‚ @Test fun `test flow continuation`() = runBlocking { // å°† 1 åˆ° 5 çš„æ•´æ•°è½¬æ¢æˆæµ (1..5).asFlow() // è¿‡æ»¤æµï¼Œåªä¿ç•™å¶æ•° .filter { it % 2 == 0 } // å°†æ¯ä¸ªæ•´æ•°è½¬æ¢ä¸ºå­—ç¬¦ä¸² .map { &#34;String $it&#34; } // æ”¶é›†æµä¸­çš„æ¯ä¸ªå…ƒç´  .collect { value -&gt; println(&#34;Collect $value&#34;) // æ‰“å°æ”¶é›†åˆ°çš„æ¯ä¸ªå…ƒç´  } } ä½¿ç”¨.asFlow()æ‰©å±•å‡½æ•°ï¼Œå¯ä»¥å°†å„ç§é›†åˆä¸åºåˆ—è½¬æ¢ä¸ºæµã€‚ @Test fun `test flow builder2`() = runBlocking&lt;Unit&gt; { // åˆ›å»ºä¸€ä¸ªåŒ…å«ä¸‰ä¸ªå­—ç¬¦ä¸²å…ƒç´ çš„ Flowï¼š&#34;one&#34;ã€&#34;two&#34; å’Œ &#34;three&#34; flowOf(&#34;one&#34;, &#34;two&#34;, &#34;three&#34;) // å¯¹ Flow ä¸­çš„æ¯ä¸ªå…ƒç´ ï¼Œåº”ç”¨ 1000 æ¯«ç§’ï¼ˆ1 ç§’ï¼‰çš„å»¶è¿Ÿ .onEach { delay(1000) } // æ”¶é›† Flow ä¸­çš„æ¯ä¸ªå…ƒç´ ï¼Œå¹¶å°†å…¶æ‰“å°åˆ°æ§åˆ¶å° .collect { v -&gt; println(v) } // å°†æ•´æ•°èŒƒå›´ä» 1 åˆ° 3 è½¬æ¢ä¸º Flow å¹¶æ”¶é›†æ¯ä¸ªå…ƒç´  (1..3).asFlow() .collect { println(it) // å°†æ¯ä¸ªæ”¶é›†åˆ°çš„æ•´æ•°æ‰“å°åˆ°æ§åˆ¶å° } } æµçš„ä¸Šä¸‹æ–‡ æµçš„æ”¶é›†æ€»æ˜¯åœ¨è°ƒç”¨åç¨‹çš„ä¸Šä¸‹æ–‡ä¸­å‘ç”Ÿï¼Œæµçš„è¯¥å±æ€§ç§°ä¸ºä¸Šä¸‹æ–‡ä¿å­˜ flow{...}æ„å»ºå™¨ä¸­çš„ä»£ç å¿…é¡»éµå¾ªä¸Šä¸‹æ–‡ä¿å­˜å±æ€§ï¼Œå¹¶ä¸”ä¸å…è®¸ä»å…¶ä»–ä¸Šä¸‹æ–‡ä¸­å‘å°„ï¼ˆemitï¼‰ flowOnæ“ä½œç¬¦ï¼Œè¯¥å‡½æ•°ç”¨äºæ›´æ”¹æµå‘å°„çš„ä¸Šä¸‹æ–‡ã€‚ // å®šä¹‰ä¸€ä¸ªç®€å•çš„ Flowï¼Œè¿”å› Int ç±»å‹çš„å€¼ fun simpleFlow5() = flow&lt;Int&gt; { // æ‰“å°å½“å‰çº¿ç¨‹çš„åç§°ï¼Œè¡¨æ˜ Flow å¼€å§‹æ‰§è¡Œ println(&#34;Flow started ${Thread.currentThread().name}&#34;) // ç”Ÿæˆä» 1 åˆ° 3 çš„æ•´æ•° for (i in 1..3) { // å»¶è¿Ÿ 1000 æ¯«ç§’ï¼ˆ1 ç§’ï¼‰æ¨¡æ‹Ÿè€—æ—¶æ“ä½œ delay(1000) // å‘å°„ï¼ˆemitï¼‰å½“å‰æ•´æ•° emit(i) } // è®¾ç½® Flow åœ¨é»˜è®¤çš„è°ƒåº¦å™¨ï¼ˆDispatcherï¼‰ä¸Šè¿è¡Œ }.flowOn(Dispatchers.Default) // æµ‹è¯•å‡½æ•°ï¼Œä½¿ç”¨ JUnit æµ‹è¯•æ¡†æ¶ @Test fun `test flow context3`() = runBlocking&lt;Unit&gt; { // æ”¶é›† Flow ä¸­å‘å°„çš„å€¼ simpleFlow5().collect { v -&gt; // æ‰“å°å½“å‰çº¿ç¨‹çš„åç§°å’Œæ”¶é›†åˆ°çš„å€¼ println(&#34;Collected $v ${Thread.currentThread().name}&#34;) } } å¯åŠ¨æµ ä½¿ç”¨launchInæ›¿æ¢collectï¼Œå¯ä»¥åœ¨å•ç‹¬çš„åç¨‹ä¸­å¯åŠ¨æµçš„æ”¶é›†
...</p>
    </div>
    <footer class="entry-footer"><span title='2024-08-09 22:30:13 +0800 CST'>2024-08-09</span>&nbsp;Â·&nbsp;<span>11 åˆ†é’Ÿ</span>&nbsp;Â·&nbsp;<span>5211 å­—</span>&nbsp;Â·&nbsp;updated:&nbsp;2024-08-13&nbsp;Â·&nbsp;<span>ShowGuan</span></footer>
  </div> 
  <a class="entry-link" aria-label="post link to Kotlinåç¨‹(2)" href="https://kennems.github.io/posts/tech/kotlin%E5%8D%8F%E7%A8%8B2/"></a>
</article>



<article class="post-entry">
  <div class="post-info">
    <header class="entry-header">
      <h2>Kotlinåç¨‹(1)
      </h2>
    </header>
    <div class="entry-content">
      <p>Kotlinåç¨‹(1) çœ‹æ˜ç™½ï¼Œè®²æ¸…æ¥šã€‚
åç¨‹å¤„ç†çš„é—®é¢˜ï¼š
å¤„ç†è€—æ—¶ä»»åŠ¡ï¼Œ è¿™ç§ä»»åŠ¡å¸¸å¸¸ä¼šé˜»å¡ä¸»çº¿ç¨‹ ä¿è¯ä¸»çº¿ç¨‹å®‰å…¨ï¼Œå³ç¡®ä¿å®‰å…¨çš„ä»ä¸»çº¿ç¨‹è°ƒç”¨ä»»ä½•suspendå‡½æ•° å¼‚æ­¥ä»»åŠ¡ åç¨‹è®©å¼‚æ­¥é€»è¾‘åŒæ­¥åŒ–ï¼Œæœç»å›è°ƒåœ°ç‹± åç¨‹æœ€æ ¸å¿ƒçš„ç‚¹å°±æ˜¯ï¼šå‡½æ•°æˆ–ä¸€æ®µç¨‹åºèƒ½å¤Ÿè¢«æŒ‚èµ·ï¼Œç¨åå†åœ¨æŒ‚èµ·çš„ä½ç½®æ¢å¤ åç¨‹çš„æŒ‚èµ·ä¸æ¢å¤ å¸¸è§„å‡½æ•°åŸºç¡€æ“ä½œåŒ…æ‹¬ ï¼š invoke(call) å’Œ return, åç¨‹æ–°å¢äº† suspend å’Œ resume ï¼› suspend â€”â€” ä¹Ÿç§°ä¸ºæŒ‚èµ·æˆ–æš‚åœï¼Œç”¨äºæš‚åœæ‰§è¡Œå½“å‰åç¨‹ï¼Œå¹¶ä¿å­˜æ‰€æœ‰å±€éƒ¨å˜é‡ resumeâ€”â€”ç”¨äºè®©å·²æš‚åœçš„åç¨‹ä»å…¶æš‚åœå¤„ç»§ç»­æ‰§è¡Œ æŒ‚èµ·å‡½æ•° ä½¿ç”¨suspendå…³é”®å­—ä¿®é¥°çš„å‡½æ•°å«åšæŒ‚èµ·å‡½æ•° æŒ‚èµ·å‡½æ•°åªèƒ½åœ¨åç¨‹ä½“å†…æˆ–å…¶ä»–æŒ‚èµ·å‡½æ•°å†…è°ƒç”¨ Kotlinåç¨‹çš„ä¸¤éƒ¨åˆ† åŸºç¡€è®¾æ–½å±‚æ¬¡ï¼Œæ ‡å‡†åº“çš„åç¨‹APIï¼Œ ä¸»è¦å¯¹åç¨‹æä¾›äº†æ¦‚å¿µå’Œè¯­ä¹‰ä¸Šæœ€åŸºæœ¬çš„æ”¯æŒ ä¸šåŠ¡æ¡†æ¶å±‚ï¼Œåç¨‹çš„ä¸Šå±‚æ¡†æ¶æ”¯æŒ è°ƒåº¦å™¨ æ‰€æœ‰åç¨‹å¿…é¡»åœ¨è°ƒåº¦å™¨ä¸­è¿è¡Œï¼Œå³ä½¿å®ƒä»¬åœ¨ä¸»çº¿ç¨‹ä¸Šè¿è¡Œä¹Ÿæ˜¯å¦‚æ­¤ã€‚
...</p>
    </div>
    <footer class="entry-footer"><span title='2024-08-06 22:30:13 +0800 CST'>2024-08-06</span>&nbsp;Â·&nbsp;<span>10 åˆ†é’Ÿ</span>&nbsp;Â·&nbsp;<span>4864 å­—</span>&nbsp;Â·&nbsp;updated:&nbsp;2024-08-13&nbsp;Â·&nbsp;<span>ShowGuan</span></footer>
  </div> 
  <a class="entry-link" aria-label="post link to Kotlinåç¨‹(1)" href="https://kennems.github.io/posts/tech/kotlin%E5%8D%8F%E7%A8%8B1/"></a>
</article>



<article class="post-entry">
  <div class="post-info">
    <header class="entry-header">
      <h2>Kotlinåç¨‹(5)
      </h2>
    </header>
    <div class="entry-content">
      <p>Kotlinåç¨‹(5) Binding è§†å›¾ç»‘å®š
View Binding: é€šè¿‡View Bindingï¼Œ Android ä¼šä¸ºæ¯ä¸ªXMLå¸ƒå±€æ–‡ä»¶è‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªç»‘å®šç±»ã€‚åœ¨è¿™ä¸ªç±»ä¸­ï¼Œæ¯ä¸ªViewéƒ½æœ‰ä¸€ä¸ªç›´æ¥å¯¹åº”çš„å±æ€§ï¼Œå¯ä»¥é¿å…findViewByIdçš„ä½¿ç”¨ï¼Œä»è€Œå‡å°‘äº†æ‰‹åŠ¨æŸ¥æ‰¾è§†å›¾å’Œç±»å‹è½¬æ¢çš„å·¥ä½œã€‚æé«˜ä»£ç çš„å®‰å…¨æ€§å’Œå¯è¯»æ€§ã€‚ val binding = ActivityMainBinding.inflate(layoutInflater) setContentView(binding.root) binding.textView.text = &#34;Hello World&#34; Data Binding: åŠŸèƒ½æ¯”View Binding æ›´ä¸ºå¼ºå¤§ï¼Œå…è®¸åœ¨å¸ƒå±€æ–‡ä»¶ä¸­ç›´æ¥ç»‘å®šUIç»„ä»¶åˆ°æ•°æ®æºï¼ˆå¦‚ViewModelï¼‰ï¼Œè¿™æ ·ï¼Œæ•°æ®çš„å˜åŒ–ä¼šè‡ªåŠ¨æ›´æ–°UI &lt;data&gt; &lt;variable name=&#34;user&#34; type=&#34;com.example.User&#34;/&gt; &lt;/data&gt; &lt;TextView android:text=&#34;@{user.name}&#34;/&gt; Activity ä¸­ï¼š
...</p>
    </div>
    <footer class="entry-footer"><span title='2024-08-06 22:30:13 +0800 CST'>2024-08-06</span>&nbsp;Â·&nbsp;<span>5 åˆ†é’Ÿ</span>&nbsp;Â·&nbsp;<span>2116 å­—</span>&nbsp;Â·&nbsp;updated:&nbsp;2024-08-13&nbsp;Â·&nbsp;<span>ShowGuan</span></footer>
  </div> 
  <a class="entry-link" aria-label="post link to Kotlinåç¨‹(5)" href="https://kennems.github.io/posts/tech/kotlin%E5%8D%8F%E7%A8%8B5/"></a>
</article>



<article class="post-entry">
  <div class="post-info">
    <header class="entry-header">
      <h2>Hugoé…ç½®ä¸ä½¿ç”¨
      </h2>
    </header>
    <div class="entry-content">
      <p>Hugoé…ç½®ä¸ä½¿ç”¨ ä¸‹è½½PaperModä¸»é¢˜ï¼š
git clone https://github.com/adityatelange/hugo-PaperMod themes/PaperMod --depth=1 ç”Ÿæˆpublicå†…å®¹æ—¶æ¸…ç©ºæ–‡ä»¶å¤¹
hugo -F --cleanDestinationDir æ–°å»ºpost
hugo new content posts/my-first-post.md å®ŒæˆGit pushæµç¨‹
echo &#34;# showguan.github.io&#34; &gt;&gt; README.md git init git add README.md git commit -m &#34;first commit&#34; git branch -M main git remote add origin https://github.com/showguan/showguan.github.io.git git push -u origin main git remote add origin https://github.com/showguan/showguan.github.io.git git branch -M main git push -u origin main å¼ºåˆ¶pushåˆ°ä»“åº“
...</p>
    </div>
    <footer class="entry-footer"><span title='2024-08-03 22:30:13 +0800 CST'>2024-08-03</span>&nbsp;Â·&nbsp;<span>5 åˆ†é’Ÿ</span>&nbsp;Â·&nbsp;<span>2366 å­—</span>&nbsp;Â·&nbsp;updated:&nbsp;2024-09-01&nbsp;Â·&nbsp;<span>ShowGuan</span></footer>
  </div> 
  <a class="entry-link" aria-label="post link to Hugoé…ç½®ä¸ä½¿ç”¨" href="https://kennems.github.io/posts/tech/hugo/"></a>
</article>



<article class="post-entry">
  <div class="post-info">
    <header class="entry-header">
      <h2>KotlinåŸºç¡€
      </h2>
    </header>
    <div class="entry-content">
      <p>KotlinåŸºç¡€ val &amp; var const ç¼–è¯‘æ—¶å¸¸é‡åªèƒ½åœ¨å‡½æ•°ä¹‹å¤–å®šä¹‰ï¼Œå› ä¸ºç¼–è¯‘æ—¶å¸¸é‡å¿…é¡»åœ¨ç¼–è¯‘æ—¶èµ‹å€¼ï¼Œ è€Œå‡½æ•°éƒ½æ˜¯åœ¨è¿è¡Œæ—¶æ‰è°ƒç”¨ï¼Œ å‡½æ•°å†…çš„å˜é‡ä¹Ÿæ˜¯åœ¨è¿è¡Œæ—¶èµ‹å€¼ï¼Œç¼–è¯‘æ—¶å¸¸é‡è¦åœ¨è¿™äº›å˜é‡èµ‹å€¼å‰å°±å·²ç»å­˜åœ¨ã€‚ å‡½æ•°å‚æ•° fun main(){ println(doSomething(1, false)) println(fix(&#34;Jack&#34;)) println(fix(age=10, name=&#34;Rose&#34;)) } private fun doSomething(age:Int, flag:Boolean):String{ return &#34;result&#34; } fun fix(name:String, age:Int = 2){ println(name &#43; &#34; &#34; &#43; age) } å‡½æ•°æ²¡æœ‰è¿”å›ç±»å‹æ—¶é»˜è®¤è¿”å›Unit
...</p>
    </div>
    <footer class="entry-footer"><span title='2024-08-03 22:30:13 +0800 CST'>2024-08-03</span>&nbsp;Â·&nbsp;<span>11 åˆ†é’Ÿ</span>&nbsp;Â·&nbsp;<span>5496 å­—</span>&nbsp;Â·&nbsp;updated:&nbsp;2024-08-03&nbsp;Â·&nbsp;<span>ShowGuan</span></footer>
  </div> 
  <a class="entry-link" aria-label="post link to KotlinåŸºç¡€" href="https://kennems.github.io/posts/tech/kotlin%E5%9F%BA%E7%A1%80/"></a>
</article>



<article class="post-entry">
  <div class="post-info">
    <header class="entry-header">
      <h2>è®­ç»ƒè¥ç¬¬åäºŒå¤©ç¬”è®°
      </h2>
    </header>
    <div class="entry-content">
      <p>ç¬¬åäºŒå¤©ç¬”è®° SW å±å¹•é€‚é…
Handlerå®ç°é€šä¿¡ã€‚
ä»£ç å¯ç»´æŠ¤ï¼Œç²¾ç®€
</p>
    </div>
    <footer class="entry-footer"><span title='2024-07-17 22:30:13 +0800 CST'>2024-07-17</span>&nbsp;Â·&nbsp;<span>1 åˆ†é’Ÿ</span>&nbsp;Â·&nbsp;<span>31 å­—</span>&nbsp;Â·&nbsp;updated:&nbsp;2024-07-17&nbsp;Â·&nbsp;<span>ShowGuan</span></footer>
  </div> 
  <a class="entry-link" aria-label="post link to è®­ç»ƒè¥ç¬¬åäºŒå¤©ç¬”è®°" href="https://kennems.github.io/posts/tech/%E7%AC%AC%E5%8D%81%E4%BA%8C%E5%A4%A9%E7%AC%94%E8%AE%B0/"></a>
</article>



<article class="post-entry">
  <div class="post-info">
    <header class="entry-header">
      <h2>è®­ç»ƒè¥ç¬¬åä¸€å¤©ç¬”è®°
      </h2>
    </header>
    <div class="entry-content">
      <p>ç¬¬åä¸€å¤©ç¬”è®° Kotlin è®²ä¹‰æ€»ç»“ 1. åŒ…çš„å®šä¹‰ä¸å¯¼å…¥ 1) åŒ…çš„å£°æ˜
åŒ…çš„å£°æ˜åœ¨ä»£ç æ–‡ä»¶çš„å¼€å¤´ï¼Œæ ¼å¼ä¸º package åŒ…åã€‚ åŒ…åæ˜¯å·¥ç¨‹æ ¹ç›®å½•ä¸‹çš„å­ç›®å½•ï¼Œå¦‚ com.jetbrainsã€‚ åœ¨æ ¹ç›®å½•ä¸‹åˆ›å»º com.jetbrains åŒ…ï¼Œå¹¶åœ¨æ­¤åŒ…ä¸‹åˆ›å»º Demo1.kt æ–‡ä»¶ï¼Œæ–‡ä»¶ç¬¬ä¸€è¡Œå£°æ˜åŒ…åï¼špackage com.jetbrainsã€‚ 2) åŒ…çš„å¯¼å…¥
...</p>
    </div>
    <footer class="entry-footer"><span title='2024-07-16 22:30:13 +0800 CST'>2024-07-16</span>&nbsp;Â·&nbsp;<span>7 åˆ†é’Ÿ</span>&nbsp;Â·&nbsp;<span>3018 å­—</span>&nbsp;Â·&nbsp;updated:&nbsp;2024-07-16&nbsp;Â·&nbsp;<span>ShowGuan</span></footer>
  </div> 
  <a class="entry-link" aria-label="post link to è®­ç»ƒè¥ç¬¬åä¸€å¤©ç¬”è®°" href="https://kennems.github.io/posts/tech/%E7%AC%AC%E5%8D%81%E4%B8%80%E5%A4%A9%E7%AC%94%E8%AE%B0/"></a>
</article>



<article class="post-entry">
  <div class="post-info">
    <header class="entry-header">
      <h2>è®­ç»ƒè¥ç¬¬åå¤©ç¬”è®°
      </h2>
    </header>
    <div class="entry-content">
      <p>ç¬¬åå¤©ç¬”è®° å†…å­˜æ³„æ¼ 1. Javaåƒåœ¾å›æ”¶æœºåˆ¶ 1.1 ä»€ä¹ˆæ˜¯åƒåœ¾å›æ”¶ åƒåœ¾å›æ”¶ï¼ˆGCï¼‰æ˜¯ç”±Javaè™šæ‹Ÿæœºï¼ˆJVMï¼‰åƒåœ¾å›æ”¶å™¨æä¾›çš„ä¸€ç§å†…å­˜å›æ”¶æœºåˆ¶ã€‚ å½“å†…å­˜ç©ºé—´æˆ–å†…å­˜å ç”¨è¿‡é«˜æ—¶ï¼Œç³»ç»Ÿä¼šå›æ”¶é‚£äº›æ²¡æœ‰å¼•ç”¨çš„å¯¹è±¡ã€‚ JVMå†…å­˜æ¨¡å‹ è¿è¡Œæ—¶æ•°æ®åŒºåŸŸï¼šåŒ…æ‹¬æ–¹æ³•åŒºã€å †ã€æ ˆã€æœ¬åœ°æ–¹æ³•æ ˆå’Œç¨‹åºè®¡æ•°å™¨ç­‰ã€‚ å †å†…å­˜ï¼š æ–°ç”Ÿä»£ï¼ˆYoung Generationï¼‰ï¼šåˆ†ä¸ºEdenåŒºå’Œä¸¤ä¸ªSurvivoråŒºï¼ˆS0ã€S1ï¼‰ã€‚ è€å¹´ä»£ï¼ˆOld Generationï¼‰ã€‚ æ–¹æ³•åŒºï¼ˆMetaSpaceï¼‰ï¼šå­˜å‚¨ç±»å…ƒæ•°æ®ã€æ–¹æ³•ä¿¡æ¯ç­‰ã€‚ 1.2 åˆ¤æ–­å¯¹è±¡æ˜¯å¦æ˜¯åƒåœ¾çš„ç®—æ³• 1.2.1 å¼•ç”¨è®¡æ•°ç®—æ³• å¯¹è±¡è¢«åˆ›å»ºåï¼Œç³»ç»Ÿä¸ºå…¶åˆå§‹åŒ–å¼•ç”¨è®¡æ•°å™¨ã€‚ æ¯å½“å¯¹è±¡è¢«å¼•ç”¨æ—¶ï¼Œè®¡æ•°å™¨åŠ 1ï¼Œå¼•ç”¨å¤±æ•ˆæ—¶ï¼Œè®¡æ•°å™¨å‡1ã€‚ å½“è®¡æ•°å™¨ä¸º0æ—¶ï¼Œå¯¹è±¡ä¸å†è¢«å¼•ç”¨ï¼Œå¯ä»¥è¿›è¡Œå›æ”¶ã€‚ ä¼˜ç‚¹ï¼šåˆ¤æ–­ç®€å•ï¼Œæ•ˆç‡é«˜ã€‚ ç¼ºç‚¹ï¼šæ— æ³•é¿å…å¾ªç¯å¼•ç”¨ã€‚ 1.2.2 å¯è¾¾æ€§åˆ†ææ³• ä»GC Rootså‡ºå‘ï¼Œé€æ­¥éå†åˆ°æ‰€æœ‰å¯è¾¾çš„å¯¹è±¡ã€‚ è¿™äº›å¯¹è±¡ç§°ä¸ºå¯è¾¾å¯¹è±¡ï¼Œä¸å¯è¾¾çš„å¯¹è±¡åˆ™è¢«æ ‡è®°ä¸ºåƒåœ¾ï¼Œéœ€è¦å›æ”¶ã€‚ GC RootsåŒ…æ‹¬çš„å¯¹è±¡ï¼š è™šæ‹Ÿæœºæ ˆä¸­å¼•ç”¨çš„å¯¹è±¡ï¼ˆæ ˆå¸§ä¸­çš„æœ¬åœ°å˜é‡è¡¨ï¼‰ã€‚ æ–¹æ³•åŒºä¸­ç±»é™æ€å±æ€§å¼•ç”¨çš„å¯¹è±¡ã€‚ æ–¹æ³•åŒºä¸­å¸¸é‡å¼•ç”¨çš„å¯¹è±¡ã€‚ æœ¬åœ°æ–¹æ³•æ ˆä¸­JNIï¼ˆNativeæ–¹æ³•ï¼‰å¼•ç”¨çš„å¯¹è±¡ã€‚ Javaä¸­çš„å¯¹è±¡å¼•ç”¨ Javaä¸­çš„å¯¹è±¡å¼•ç”¨ä¸»è¦åˆ†ä¸ºå››ç§ç±»å‹ï¼š
...</p>
    </div>
    <footer class="entry-footer"><span title='2024-07-15 22:30:13 +0800 CST'>2024-07-15</span>&nbsp;Â·&nbsp;<span>3 åˆ†é’Ÿ</span>&nbsp;Â·&nbsp;<span>1411 å­—</span>&nbsp;Â·&nbsp;updated:&nbsp;2024-07-15&nbsp;Â·&nbsp;<span>ShowGuan</span></footer>
  </div> 
  <a class="entry-link" aria-label="post link to è®­ç»ƒè¥ç¬¬åå¤©ç¬”è®°" href="https://kennems.github.io/posts/tech/%E7%AC%AC%E5%8D%81%E5%A4%A9%E7%AC%94%E8%AE%B0/"></a>
</article>



<article class="post-entry">
  <div class="post-info">
    <header class="entry-header">
      <h2>è®­ç»ƒè¥ç¬¬ä¹å¤©ç¬”è®°
      </h2>
    </header>
    <div class="entry-content">
      <p>ç¬¬ä¹å¤©ç¬”è®° æƒé™ä¸ç½‘ç»œè¯·æ±‚è¯¾ç¨‹é¢„ä¹  1. æœ‰å“ªäº›æƒé™ï¼Œå…·ä½“æƒé™çš„ä»‹ç» æ™®é€šæƒé™ ç½‘ç»œæƒé™ï¼šå…è®¸è®¾å¤‡è®¿é—®ç½‘ç»œ
&lt;uses-permission android:name=&#34;android.permission.INTERNET&#34; /&gt; è·å–ç½‘ç»œçš„çŠ¶æ€ï¼šå¦‚æ˜¯å¦æœ‰ç½‘
&lt;uses-permission android:name=&#34;android.permission.ACCESS_NETWORK_STATE&#34; /&gt; è¯»å–æ‰‹æœºçŠ¶æ€ï¼šå¦‚IMEIç­‰ä¿¡æ¯
&lt;uses-permission android:name=&#34;android.permission.READ_PHONE_STATE&#34; /&gt; è·å–WiFiçš„çŠ¶æ€
&lt;uses-permission android:name=&#34;android.permission.ACCESS_WIFI_STATE&#34; /&gt; æ•æ„Ÿæƒé™ å†™å…¥SDKæƒé™ï¼šæ–‡ä»¶ä¸‹è½½ã€å›¾ç‰‡ä¸‹è½½
...</p>
    </div>
    <footer class="entry-footer"><span title='2024-07-14 22:30:13 +0800 CST'>2024-07-14</span>&nbsp;Â·&nbsp;<span>7 åˆ†é’Ÿ</span>&nbsp;Â·&nbsp;<span>3076 å­—</span>&nbsp;Â·&nbsp;updated:&nbsp;2024-07-14&nbsp;Â·&nbsp;<span>ShowGuan</span></footer>
  </div> 
  <a class="entry-link" aria-label="post link to è®­ç»ƒè¥ç¬¬ä¹å¤©ç¬”è®°" href="https://kennems.github.io/posts/tech/%E7%AC%AC%E4%B9%9D%E5%A4%A9%E7%AC%94%E8%AE%B0/"></a>
</article>
<footer class="page-footer">
  <nav class="pagination">
    <a class="prev" href="https://kennems.github.io/posts/tech/page/5/">
      Â«&nbsp;ä¸Šä¸€é¡µ&nbsp;
    </a>
    <a class="next" href="https://kennems.github.io/posts/tech/page/7/">ä¸‹ä¸€é¡µ&nbsp;&nbsp;Â»
    </a>
  </nav>
</footer>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="https://kennems.github.io/">Kennem&#39;s Blog</a></span> Â· 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu');
    if (menu) {
        
        const scrollPosition = localStorage.getItem("menu-scroll-position");
        if (scrollPosition) {
            menu.scrollLeft = parseInt(scrollPosition, 10);
        }
        
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        const html = document.querySelector("html");
        if (html.dataset.theme === "dark") {
            html.dataset.theme = 'light';
            localStorage.setItem("pref-theme", 'light');
        } else {
            html.dataset.theme = 'dark';
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>

<footer class="footer">
    
    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

    <span id="busuanzi_container">
    ğŸ‘¤ Visitors: <span id="busuanzi_value_site_uv"></span>
    ğŸ‘€ Views: <span id="busuanzi_value_site_pv"></span>
  </span>
</footer>



</body>

</html>
