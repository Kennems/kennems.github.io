<!DOCTYPE html>
<html lang="zh" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">

<meta name="msvalidate.01" content="DF5FE493CC759E62BFE073BEA8EFD472" />
<title>Acwing算法学习 | Kennem&#39;s Blog</title>
<meta name="keywords" content="算法笔记">
<meta name="description" content="Acwing算法学习">
<meta name="author" content="ShowGuan">
<link rel="canonical" href="https://kennems.github.io/posts/tech/acwing/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.1a7bc7e6d01b82c8ca2b2e53cfcf7e33d2fd9058f6b28245f94da0d91447c6a0.css" integrity="sha256-GnvH5tAbgsjKKy5Tz89&#43;M9L9kFj2soJF&#43;U2g2RRHxqA=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://kennems.github.io/img/sun.png">
<link rel="icon" type="image/png" sizes="16x16" href="https://kennems.github.io/img/sun.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://kennems.github.io/img/sun.png">
<link rel="apple-touch-icon" href="https://kennems.github.io/img/sun.png">
<link rel="mask-icon" href="https://kennems.github.io/img/sun.png">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="zh" href="https://kennems.github.io/posts/tech/acwing/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous">

<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.js" integrity="sha384-VQ8d8WVFw0yHhCk5E8I86oOhv48xLpnDZx5T9GogA/Y84DcCKWXDmSDfn13bzFZY" crossorigin="anonymous"></script>

<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/contrib/auto-render.min.js" integrity="sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR" crossorigin="anonymous"
    onload="renderMathInElement(document.body);"></script>


<script>
document.addEventListener("DOMContentLoaded", function() {
    renderMathInElement(document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "$", right: "$", display: false}
        ]
    });
});
</script>


<link rel="stylesheet" href="https://fonts.cdnfonts.com/css/code-new-roman">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  

<meta property="og:url" content="https://kennems.github.io/posts/tech/acwing/">
  <meta property="og:site_name" content="Kennem&#39;s Blog">
  <meta property="og:title" content="Acwing算法学习">
  <meta property="og:description" content="Acwing算法学习">
  <meta property="og:locale" content="zh">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-04-09T15:37:01+08:00">
    <meta property="article:modified_time" content="2024-04-09T15:37:01+08:00">
    <meta property="article:tag" content="算法笔记">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Acwing算法学习">
<meta name="twitter:description" content="Acwing算法学习">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "📚文章",
      "item": "https://kennems.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "💻技术",
      "item": "https://kennems.github.io/posts/tech/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "Acwing算法学习",
      "item": "https://kennems.github.io/posts/tech/acwing/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Acwing算法学习",
  "name": "Acwing算法学习",
  "description": "Acwing算法学习",
  "keywords": [
    "算法笔记"
  ],
  "articleBody": "Acwing算法学习 [TOC]\n第一章 课上：学思想\n课下：背代码\n题目，一道题写好几遍\n理解没有任何意义，体力活+脑力活\n记忆力 毅力/自制力\n沉下心背东西\n快速排序算法模板 —— 模板题 AcWing 785. 快速排序 分治\n1、确定分界点，l、r、（l+r)/2 随机\n2、调整区间，分为两边，左边小于等于x,右边大于等于x\n3、递归处理左右两段\n1 2 3 4 5 6 7 8 9 10 11 12 13 void quick_sort(int q[], int l, int r) { if (l \u003e= r) return; int i = l - 1, j = r + 1, x = q[l + r \u003e\u003e 1]; while (i \u003c j) { do i ++ ; while (q[i] \u003c x); do j -- ; while (q[j] \u003e x); if (i \u003c j) swap(q[i], q[j]); } quick_sort(q, l, j), quick_sort(q, j + 1, r); } -std=c++11 归并排序算法模板 —— 模板题 AcWing 787. 归并排序 排序稳定：序列中相同的值排序后的相对位置是否发生改变\n时间复杂度有 （nlogn)\n1）确定分界点mid\n2）递归排序两边\n2）归并，合并为一个有序数组\n1 2 3 4 5 6 7 8 9 10 11 12 13 void merge_sort(int q[], int l, int r) { if (l \u003e= r) return; int mid = l + r \u003e\u003e 1; merge_sort(q, l, mid); merge_sort(q, mid + 1, r); int k = 0, i = l, j = mid + 1; while (i \u003c= mid \u0026\u0026 j \u003c= r) if (q[i] \u003c q[j]) tmp[k ++ ] = q[i ++ ]; else tmp[k ++ ] = q[j ++ ]; while (i \u003c= mid) tmp[k ++ ] = q[i ++ ]; while (j \u003c= r) tmp[k ++ ] = q[j ++ ]; for (i = l, j = 0; i \u003c= r; i ++, j ++ ) q[i] = tmp[j]; } 整数二分算法模板 —— 模板题 AcWing 789. 数的范围 边界问题\n本质：区间内一半满足一半不满足\nl=mid时加一\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 bool check(int x) {/* ... */} // 检查x是否满足某种性质 // 区间[l, r]被划分成[l, mid]和[mid + 1, r]时使用： int bsearch_1(int l, int r) { while (l \u003c r) { int mid = l + r \u003e\u003e 1; if (check(mid)) r = mid; // check()判断mid是否满足性质 else l = mid + 1; } return l; } // 区间[l, r]被划分成[l, mid - 1]和[mid, r]时使用： int bsearch_2(int l, int r) { while (l \u003c r) { int mid = l + r + 1 \u003e\u003e 1; if (check(mid)) l = mid; else r = mid - 1; } return l; } 浮点数二分算法模板 —— 模板题 AcWing 790. 数的三次方根 浮点数二分，比较对应整数二分\n1 2 3 4 5 6 7 8 9 10 11 12 bool check(double x) {/* ... */} // 检查x是否满足某种性质 double bsearch_3(double l, double r) { const double eps = 1e-6; // eps 表示精度，取决于题目对精度的要求 while (r - l \u003e eps) { double mid = (l + r) / 2; if (check(mid)) r = mid; else l = mid; } return l; } 高精度加法 —— 模板题 AcWing 791. 高精度加法 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 // C = A + B, A \u003e= 0, B \u003e= 0 vector\u003cint\u003e add(vector\u003cint\u003e \u0026A, vector\u003cint\u003e \u0026B) { if (A.size() \u003c B.size()) return add(B, A); vector\u003cint\u003e C; int t = 0; for (int i = 0; i \u003c A.size(); i ++ ) { t += A[i]; if (i \u003c B.size()) t += B[i]; C.push_back(t % 10); t /= 10; } if (t) C.push_back(t); return C; } 高精度减法 —— 模板题 AcWing 792. 高精度减法 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 // C = A - B, 满足A \u003e= B, A \u003e= 0, B \u003e= 0 vector\u003cint\u003e sub(vector\u003cint\u003e \u0026A, vector\u003cint\u003e \u0026B) { vector\u003cint\u003e C; for (int i = 0, t = 0; i \u003c A.size(); i ++ ) { t = A[i] - t; if (i \u003c B.size()) t -= B[i]; C.push_back((t + 10) % 10); if (t \u003c 0) t = 1; else t = 0; } while (C.size() \u003e 1 \u0026\u0026 C.back() == 0) C.pop_back(); return C; } 高精度乘低精度 —— 模板题 AcWing 793. 高精度乘法 1 2 3 4 5 6 7 8 9 10 11 12 13 // C = A * b, A \u003e= 0, b \u003e 0 vector\u003cint\u003e mul(vector\u003cint\u003e \u0026A, int b) { vector\u003cint\u003e C; int t = 0; for (int i = 0; i \u003c A.size() || t; i ++ ) { if (i \u003c A.size()) t += A[i] * b; C.push_back(t % 10); t /= 10; } return C; } 高精度除以低精度 —— 模板题 AcWing 794. 高精度除法 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 // A / b = C ... r, A \u003e= 0, b \u003e 0 vector\u003cint\u003e div(vector\u003cint\u003e \u0026A, int b, int \u0026r) { vector\u003cint\u003e C; r = 0; for (int i = A.size() - 1; i \u003e= 0; i -- ) { r = r * 10 + A[i]; C.push_back(r / b); r %= b; } reverse(C.begin(), C.end()); while (C.size() \u003e 1 \u0026\u0026 C.back() == 0) C.pop_back(); return C; } 一维前缀和 —— 模板题 AcWing 795. 前缀和 快速求区间和\n1 2 S[i] = a[1] + a[2] + ... a[i] a[l] + ... + a[r] = S[r] - S[l - 1] 从1开始，便于处理边界 二维前缀和 —— 模板题 AcWing 796. 子矩阵的和 1 2 3 S[i, j] = 第i行j列格子左上部分所有元素的和 以(x1, y1)为左上角，(x2, y2)为右下角的子矩阵的和为： S[x2, y2] - S[x1 - 1, y2] - S[x2, y1 - 1] + S[x1 - 1, y1 - 1] 一维差分 —— 模板题 AcWing 797. 差分 1 2 3 给区间[l, r]中的每个数加上c： B[l] += c, B[r + 1] -= c 二维差分 —— 模板题 AcWing 798. 差分矩阵/二维差分 1 2 3 4 5 给以(x1, y1)为左上角，(x2, y2)为右下角的子矩阵中的所有元素加上c： S[x1, y1] += c, S[x2 + 1, y1] -= c, S[x1, y2 + 1] -= c, S[x2 + 1, y2 + 1] += c 双指针算法 —— 模板题 AcWIng 799. 最长连续不重复子序列, AcWing 800. 数组元素的目标和 __滑动窗口？ 核心：把O(n^2)算法优化为O(n)\n1 2 3 4 5 6 7 8 for (int i = 0, j = 0; i \u003c n; i ++ ) { while (j \u003c i \u0026\u0026 check(j, i)) j ++ ; // 具体问题的逻辑 } 常见问题分类： (1) 对于一个序列，用两个指针维护一段区间 (2) 对于两个序列，维护某种次序，比如归并排序中合并两个有序序列的操作 位运算 —— 模板题 AcWing 801. 二进制中1的个数 1 2 3 原码，反码，补码 求n二进制表示中第k位数字: n \u003e\u003e k \u0026 1 返回n的最后一位1：lowbit(n) = n \u0026 -n 树状数组基本操作 整数离散化 —— 模板题 AcWing 802. 区间和 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 vector\u003cint\u003e alls; // 存储所有待离散化的值 sort(alls.begin(), alls.end()); // 将所有值排序 alls.erase(unique(alls.begin(), alls.end())返回去重后数组末尾端点, alls.end()); // 去掉重复元素 // 二分求出x对应的离散化的值 int find(int x) // 找到第一个大于等于x的位置 { int l = 0, r = alls.size() - 1; while (l \u003c r) { int mid = l + r \u003e\u003e 1; if (alls[mid] \u003e= x) r = mid; else l = mid + 1; } return r + 1; // 映射到1, 2, ...n } 区间合并 —— 模板题 AcWing 803. 区间合并 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 // 将所有存在交集的区间合并 贪心 void merge(vector\u003cPII\u003e \u0026segs) { vector\u003cPII\u003e res; sort(segs.begin(), segs.end()); //区间左端点排序 int st = -2e9, ed = -2e9; for (auto seg : segs) if (ed \u003c seg.first) { if (st != -2e9) res.push_back({st, ed}); st = seg.first, ed = seg.second; } else ed = max(ed, seg.second); if (st != -2e9) res.push_back({st, ed}); segs = res; } 作者：yxc 链接：https://www.acwing.com/blog/content/277/ 来源：AcWing 著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。\n第二章 数据结构，以数组模拟的形式\n指针+结构体 ： 面试题\n单链表 —— 模板题 AcWing 826. 单链表 邻接表-存储树和图 静态链表\n下标从0开始\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 // head存储链表头，e[]存储节点的值，ne[]存储节点的next指针，idx表示当前用到了哪个节点 int head, e[N], ne[N], idx; // 初始化 void init() { head = -1; idx = 0; } // 在链表头插入一个数a void insert(int a) { e[idx] = a, ne[idx] = head, head = idx ++ ; } // 插入下标k后面 void add(int k,int x) { e[idx]= x, ne[idx] = ne[k], ne[k] = idx++ ; } // 将头结点删除，需要保证头结点存在 void remove() { head = ne[head]; } // 将k后面的点删掉 void remove(int k) { ne[k] = ne[ne[k]]; } 双链表 —— 模板题 AcWing 827. 双链表 优化某些问题\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 // e[]表示节点的值，l[]表示节点的左指针，r[]表示节点的右指针，idx表示当前用到了哪个节点 int e[N], l[N], r[N], idx; // 初始化 void init() { //0是左端点，1是右端点 r[0] = 1, l[1] = 0; idx = 2; } // 在节点a的右边插入一个数x void insert(int a, int x) { e[idx] = x; l[idx] = a, r[idx] = r[a]; l[r[a]] = idx, r[a] = idx ++ ; } // 删除节点a void remove(int a) { l[r[a]] = l[a]; r[l[a]] = r[a]; } 栈 —— 模板题 AcWing 828. 模拟栈 1 2 3 4 5 6 7 8 9 10 11 12 // tt表示栈顶 int stk[N], tt = 0; // 向栈顶插入一个数 stk[ ++ tt] = x; // 从栈顶弹出一个数 tt -- ; // 栈顶的值 stk[tt]; // 判断栈是否为空 if (tt \u003e 0) { } 队列 —— 模板题 AcWing 829. 模拟队列 普通队列\n1 2 3 4 5 6 7 8 9 10 11 12 13 // hh 表示队头，tt表示队尾 int q[N], hh = 0, tt = -1; // 向队尾插入一个数 q[ ++ tt] = x; // 从队头弹出一个数 hh ++ ; // 队头的值 q[hh]; // 判断队列是否为空 if (hh \u003c= tt) { //不空 } 循环队列\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 // hh 表示队头，tt表示队尾的后一个位置 int q[N], hh = 0, tt = 0; // 向队尾插入一个数 q[tt ++ ] = x; if (tt == N) tt = 0; // 从队头弹出一个数 hh ++ ; if (hh == N) hh = 0; // 队头的值 q[hh]; // 判断队列是否为空 if (hh != tt) { } 单调栈 —— 模板题 AcWing 830. 单调栈 1 2 3 4 5 6 7 常见模型：找出每个数左边离它最近的比它大/小的数 int tt = 0; for (int i = 1; i \u003c= n; i ++ ) { while (tt \u0026\u0026 check(stk[tt], i)) tt -- ; stk[ ++ tt] = i; } 单调队列 —— 模板题 AcWing 154. 滑动窗口 1 2 3 4 5 6 7 8 常见模型：找出滑动窗口中的最大值/最小值 int hh = 0, tt = -1; for (int i = 0; i \u003c n; i ++ ) { while (hh \u003c= tt \u0026\u0026 check_out(q[hh])) hh ++ ; // 判断队头是否滑出窗口 while (hh \u003c= tt \u0026\u0026 check(q[tt], i)) tt -- ; q[ ++ tt] = i; } KMP —— 模板题 AcWing 831. KMP字符串 用模板串来匹配模式串，找到模式串\ns的真前缀以及真后缀是指不等于s的前缀以及后缀，即至少是s[1n-2]或s[0n-1]\nne[i] : 以i结尾的串中 最长真前缀与真后缀相等的串 的长度，如果没有则为0。\n1 2 3 4 5 6 7 8 9 10 11 12 //前缀h vector\u003cint\u003e prefix_function(string s) { int n = (int)s.length(); vector\u003cint\u003e pi(n); for (int i = 1; i \u003c n; i++) { int j = pi[i - 1]; while (j \u003e 0 \u0026\u0026 s[i] != s[j]) j = pi[j - 1]; if (s[i] == s[j]) j++; pi[i] = j; } return pi; } 实际使用范例（下面这个例子字符串从1开始）\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 // 求Next数组： // ne[i] 存储真前缀和真后缀相等的长度，所以至少从2开始： //abcab,从b开始才有真前缀 // s[]是模式串，p[]是模板串, n是s的长度，m是p的长度 for (int i = 2, j = 0; i \u003c= m; i ++ ) { while (j \u0026\u0026 p[i] != p[j + 1]) j = ne[j]; if (p[i] == p[j + 1]) j ++ ; ne[i] = j; } // 匹配 for (int i = 1, j = 0; i \u003c= n; i ++ ) { while (j \u0026\u0026 s[i] != p[j + 1]) j = ne[j]; if (s[i] == p[j + 1]) j ++ ; if (j == m) { j = ne[j]; // 匹配成功后的逻辑 } } Trie树 —— 模板题 AcWing 835. Trie字符串统计 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 int son[N][26], cnt[N], idx; // 0号点既是根节点，又是空节点 // son[][]存储树中每个节点的子节点 // cnt[]存储以每个节点结尾的单词数量 // 插入一个字符串 void insert(char *str) { int p = 0; for (int i = 0; str[i]; i ++ ) { int u = str[i] - 'a'; if (!son[p][u]) son[p][u] = ++ idx; p = son[p][u]; } cnt[p] ++ ; } // 查询字符串出现的次数 int query(char *str) { int p = 0; for (int i = 0; str[i]; i ++ ) { int u = str[i] - 'a'; if (!son[p][u]) return 0; p = son[p][u]; } return cnt[p]; } 并查集 —— 模板题 AcWing 836. 合并集合, AcWing 837. 连通块中点的数量 按秩合并\n字符按字符串读入\n(1)朴素并查集：\n1 2 3 4 5 6 7 8 9 10 11 int p[N]; //存储每个点的祖宗节点 // 返回x的祖宗节点 int find(int x) { if (p[x] != x) p[x] = find(p[x]); return p[x]; } // 初始化，假定节点编号是1~n for (int i = 1; i \u003c= n; i ++ ) p[i] = i; // 合并a和b所在的两个集合： p[find(a)] = find(b); (2)维护size的并查集：\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 int p[N], size[N]; //p[]存储每个点的祖宗节点, size[]只有祖宗节点的有意义，表示祖宗节点所在集合中的点的数量 // 返回x的祖宗节点 int find(int x) { if (p[x] != x) p[x] = find(p[x]); return p[x]; } // 初始化，假定节点编号是1~n for (int i = 1; i \u003c= n; i ++ ) { p[i] = i; size[i] = 1; } // 合并a和b所在的两个集合： p[find(a)] = find(b); size[b] += size[a]; (3)维护到祖宗节点距离的并查集：\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 int p[N], d[N]; //p[]存储每个点的祖宗节点, d[x]存储x到p[x]的距离 // 返回x的祖宗节点 int find(int x) { if (p[x] != x) { int u = find(p[x]); d[x] += d[p[x]]; p[x] = u; } return p[x]; } // 初始化，假定节点编号是1~n for (int i = 1; i \u003c= n; i ++ ) { p[i] = i; d[i] = 0; } // 合并a和b所在的两个集合： p[find(a)] = find(b); d[find(a)] = distance; // 根据具体问题，初始化find(a)的偏移量 堆 —— 模板题 AcWing 838. 堆排序, AcWing 839. 模拟堆 维护集合的数据结构 （大根堆，父节点值不小于子节点值）\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 // h[N]存储堆中的值, h[1]是堆顶，x的左儿子是2x, 右儿子是2x + 1 // pos[k]存储第k个插入的点在堆中的位置 // ord[k]存储堆中下标是k的点是第几个插入的 int h[N], ph[N], hp[N], size; // 交换两个点，及其映射关系 void heap_swap(int a, int b) { //swap(ph[hp[a]],ph[hp[b]]); 根据题意 //swap(hp[a], hp[b]); swap(h[a], h[b]); } void down(int u) { int t = u; if (u * 2 \u003c= size \u0026\u0026 h[u * 2] \u003c h[t]) t = u * 2; if (u * 2 + 1 \u003c= size \u0026\u0026 h[u * 2 + 1] \u003c h[t]) t = u * 2 + 1; if (u != t) { heap_swap(u, t); down(t); } } void up(int u) { while (u / 2 \u0026\u0026 h[u] \u003c h[u / 2]) { heap_swap(u, u / 2); u \u003e\u003e= 1; } } // O(n)建堆 for (int i = n / 2; i; i -- ) down(i); heap[++size] = x; up(size); //添加元素 heap[1]; //堆顶元素 heap[1]=heap[size]; size--; down(1);//删除第size个结点 heap[k]=heap[size]; size---; down(k);up(k);//删除第k个结点 heap[k]=x; down(k); up(k); //将第k个元素赋值为x 一般哈希 —— 模板题 AcWing 840. 模拟散列表 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 (1) 拉链法 int h[N], e[N], ne[N], idx; // 向哈希表中插入一个数 void insert(int x) { int k = (x % N + N) % N; e[idx] = x; ne[idx] = h[k]; h[k] = idx ++ ; } // 在哈希表中查询某个数是否存在 bool find(int x) { int k = (x % N + N) % N; for (int i = h[k]; i != -1; i = ne[i]) if (e[i] == x) return true; return false; } (2) 开放寻址法 int h[N]; // 如果x在哈希表中，返回x的下标；如果x不在哈希表中，返回x应该插入的位置 int find(int x) { int t = (x % N + N) % N; while (h[t] != null \u0026\u0026 h[t] != x) { t ++ ; if (t == N) t = 0; } return t; } 字符串哈希 —— 模板题 AcWing 841. 字符串哈希 核心思想：将字符串看成P进制数，P的经验值是131或13331，取这两个值的冲突概率低 小技巧：取模的数用2^64，这样直接用unsigned long long存储，溢出的结果就是取模的结果。\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 typedef unsigned long long ULL; const int P = 131 or 13331 ; ULL h[N], p[N]; // h[k]存储字符串前k个字母的哈希值, p[k]存储 P^k mod 2^64 // 初始化 p[0] = 1; for (int i = 1; i \u003c= n; i ++ ) { h[i] = h[i - 1] * P + str[i]; p[i] = p[i - 1] * P; } // 计算子串 str[l ~ r] 的哈希值 ULL get(int l, int r) { return h[r] - h[l - 1] * p[r - l + 1]; } C++ STL简介 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 所有容器都有size() empty() vector, 变长数组，倍增的思想 size() 返回元素个数 empty() 返回是否为空 clear() 清空 front()/back() push_back()/pop_back() begin()/end() [] 支持比较运算，按字典序 vector\u003cint\u003e a(10,2); a.empty(); pair\u003cint, int\u003e first, 第一个元素 second, 第二个元素 支持比较运算，以first为第一关键字，以second为第二关键字（字典序） pair\u003cint,int\u003e p; p=make_pair(1,1); p={1,1}; string，字符串 size()/length() 返回字符串长度 empty() clear() substr(起始下标，(子串长度)) 返回子串 c_str() 返回字符串所在字符数组的起始地址 strcpy(c,s.c_str());//c_str()的使用方法 queue, 队列 没有clear函数 清空用新建queue size() empty() push() 向队尾插入一个元素 front() 返回队头元素 back() 返回队尾元素 pop() 弹出队头元素 priority_queue, 优先队列，默认是大根堆 push() 插入一个元素 top() 返回堆顶元素 pop() 弹出堆顶元素 定义成小根堆的方式：priority_queue\u003cint, vector\u003cint\u003e, greater\u003cint\u003e\u003e q; stack, 栈 size() empty() push() 向栈顶插入一个元素 top() 返回栈顶元素 pop() 弹出栈顶元素 deque, 双端队列 size() empty() clear() front()/back() push_back()/pop_back() push_front()/pop_front() begin()/end() [] 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 set, map, multiset, multimap, 基于平衡二叉树（红黑树），动态维护有序序列 size() empty() clear() begin()/end() ++, -- 返回前驱和后继，时间复杂度 O(logn) set/multiset insert() 插入一个数 find() 查找一个数 count() 返回某一个数的个数 erase() (1) 输入是一个数x，删除所有x O(k + logn) (2) 输入一个迭代器，删除这个迭代器 lower_bound()/upper_bound() lower_bound(x) 返回大于等于x的最小的数的迭代器 upper_bound(x) 返回大于x的最小的数的迭代器 map/multimap insert() 插入的数是一个pair erase() 输入的参数是pair或者迭代器 find() [] 注意multimap不支持此操作。 时间复杂度是 O(logn) lower_bound()/upper_bound() unordered_set, unordered_map, unordered_multiset, unordered_multimap, 哈希表 和上面类似，增删改查的时间复杂度是 O(1) 不支持 lower_bound()/upper_bound()， 迭代器的++，-- bitset, 圧位 bitset\u003c10000\u003e s; ~, \u0026, |, ^ \u003e\u003e, \u003c\u003c ==, != [] count() 返回有多少个1 none() 判断是否全为0 any() 判断是否至少有一个1 set() 把所有位置成1 set(k, v) 将第k位变成v reset() 把所有位变成0 flip() 等价于~ flip(k) 把第k位取反 作者：yxc 链接：https://www.acwing.com/blog/content/404/ 来源：AcWing 著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。\n第三章 树与图的存储 树是一种特殊的图: 无环连通图，与图的存储方式相同。 对于无向图中的边ab，存储两条有向边a-\u003eb, b-\u003ea。 因此我们可以只考虑有向图的存储。\n1 2 3 4 5 6 7 8 9 10 11 12 (1) 邻接矩阵：g[a][b] 存储边a-\u003eb (2) 邻接表： // 对于每个点k，开一个单链表，存储k所有可以走到的点。h[k]存储这个单链表的头结点 int h[N], e[N], ne[N], idx; // 添加一条边a-\u003eb void add(int a, int b) { e[idx] = b, ne[idx] = h[a], h[a] = idx ++ ; } // 初始化 idx = 0; memset(h, -1, sizeof h); 树与图的遍历 时间复杂度 O(n+m)O(n+m), nn 表示点数，mm 表示边数\n(1) 深度优先遍历 —— 模板题 AcWing 846. 树的重心 1 2 3 4 5 6 7 8 9 int dfs(int u) { st[u] = true; // st[u] 表示点u已经被遍历过 for (int i = h[u]; i != -1; i = ne[i]) { int j = e[i]; if (!st[j]) dfs(j); } } (2) 宽度优先遍历 —— 模板题 AcWing 847. 图中点的层次 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 queue\u003cint\u003e q; st[1] = true; // 表示1号点已经被遍历过 q.push(1); while (q.size()) { int t = q.front(); q.pop(); for (int i = h[t]; i != -1; i = ne[i]) { int j = e[i]; if (!st[j]) { st[j] = true; // 表示点j已经被遍历过 q.push(j); } } } 拓扑排序 —— 模板题 AcWing 848. 有向图的拓扑序列 时间复杂度 O(n+m)O(n+m), nn 表示点数，mm 表示边数\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 bool topsort() { int hh = 0, tt = -1; // d[i] 存储点i的入度 for (int i = 1; i \u003c= n; i ++ ) if (!d[i]) q[ ++ tt] = i; while (hh \u003c= tt) { int t = q[hh ++ ]; for (int i = h[t]; i != -1; i = ne[i]) { int j = e[i]; if (-- d[j] == 0) q[ ++ tt] = j; } } // 如果所有点都入队了，说明存在拓扑序列；否则不存在拓扑序列。 return tt == n - 1; } 最短路 单源最短路\n所有边权均为正：朴素Dijkstra O(n^2)；堆优化版的Dijkstra(mlogn)\n存在负权变：Bellman-Ford O(nm) ； SPFA（队列优化Bellman-Ford) 一般：O(m) 最坏 O(nm)\n多元汇最短路：Floyed算法 O(n^3)\n朴素dijkstra算法 —— 模板题 AcWing 849. Dijkstra求最短路 I 基于贪心 时间复杂是 O(n^2+m), n 表示点数，m 表示边数\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 int g[N][N]; // 存储每条边， int dist[N]; // 存储1号点到每个点的最短距离 bool st[N]; // 存储每个点的最短路是否已经确定 // 求1号点到n号点的最短路，如果不存在则返回-1 int dijkstra() { memset(dist, 0x3f, sizeof dist); dist[1] = 0; for (int i = 0; i \u003c n - 1; i ++ ) { int t = -1; // 在还未确定最短路的点中，寻找距离最小的点 for (int j = 1; j \u003c= n; j ++ ) if (!st[j] \u0026\u0026 (t == -1 || dist[t] \u003e dist[j])) t = j; // 用t更新其他点的距离 for (int j = 1; j \u003c= n; j ++ ) dist[j] = min(dist[j], dist[t] + g[t][j]); st[t] = true; } if (dist[n] == 0x3f3f3f3f) return -1; return dist[n]; } 堆优化版dijkstra —— 模板题 AcWing 850. Dijkstra求最短路 II 时间复杂度 O(mlogn), n 表示点数，m 表示边数\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 typedef pair\u003cint, int\u003e PII; int n; // 点的数量 int h[N], w[N], e[N], ne[N], idx; // 邻接表存储所有边 int dist[N]; // 存储所有点到1号点的距离 bool st[N]; // 存储每个点的最短距离是否已确定 // 求1号点到n号点的最短距离，如果不存在，则返回-1 int dijkstra() { memset(dist, 0x3f, sizeof dist); dist[1] = 0; priority_queue\u003cPII, vector\u003cPII\u003e, greater\u003cPII\u003e\u003e heap; heap.push({0, 1}); // first存储距离，second存储节点编号 while (heap.size()) { auto t = heap.top(); heap.pop(); int ver = t.second, distance = t.first; if (st[ver]) continue; st[ver] = true; for (int i = h[ver]; i != -1; i = ne[i]) { int j = e[i]; if (dist[j] \u003e distance + w[i]) { dist[j] = distance + w[i]; heap.push({dist[j], j}); } } } if (dist[n] == 0x3f3f3f3f) return -1; return dist[n]; } Bellman-Ford算法 —— 模板题 AcWing 853. 有边数限制的最短路 时间复杂度 O(nm), n 表示点数，m表示边数 注意在模板题中需要对下面的模板稍作修改，加上备份数组，详情见模板题。\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 int n, m; // n表示点数，m表示边数 int dist[N]; // dist[x]存储1到x的最短路距离 struct Edge // 边，a表示出点，b表示入点，w表示边的权重 { int a, b, w; }edges[M]; // 求1到n的最短路距离，如果无法从1走到n，则返回-1。 int bellman_ford() { memset(dist, 0x3f, sizeof dist); dist[1] = 0; // 如果第n次迭代仍然会松弛三角不等式，就说明存在一条长度是n+1的最短路径，由抽屉原理，路径中至少存在两个相同的点，说明图中存在负权回路。 for (int i = 0; i \u003c n; i ++ ) { for (int j = 0; j \u003c m; j ++ ) { int a = edges[j].a, b = edges[j].b, w = edges[j].w; if (dist[b] \u003e dist[a] + w) dist[b] = dist[a] + w; } } if (dist[n] \u003e 0x3f3f3f3f / 2) return -1; return dist[n]; } spfa 算法（队列优化的Bellman-Ford算法） —— 模板题 AcWing 851. spfa求最短路 时间复杂度 平均情况下 O(m)，最坏情况下 O(nm), n 表示点数，m 表示边数\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 int n; // 总点数 int h[N], w[N], e[N], ne[N], idx; // 邻接表存储所有边 int dist[N]; // 存储每个点到1号点的最短距离 bool st[N]; // 存储每个点是否在队列中 // 求1号点到n号点的最短路距离，如果从1号点无法走到n号点则返回-1 int spfa() { memset(dist, 0x3f, sizeof dist); dist[1] = 0; queue\u003cint\u003e q; q.push(1); st[1] = true; while (q.size()) { auto t = q.front(); q.pop(); st[t] = false; for (int i = h[t]; i != -1; i = ne[i]) { int j = e[i]; if (dist[j] \u003e dist[t] + w[i]) { dist[j] = dist[t] + w[i]; if (!st[j]) // 如果队列中已存在j，则不需要将j重复插入 { q.push(j); st[j] = true; } } } } if (dist[n] == 0x3f3f3f3f) return -1; return dist[n]; } spfa判断图中是否存在负环 —— 模板题 AcWing 852. spfa判断负环 时间复杂度是 O(nm), n 表示点数，m 表示边数\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 int n; // 总点数 int h[N], w[N], e[N], ne[N], idx; // 邻接表存储所有边 int dist[N], cnt[N]; // dist[x]存储1号点到x的最短距离，cnt[x]存储1到x的最短路中经过的点数 bool st[N]; // 存储每个点是否在队列中 // 如果存在负环，则返回true，否则返回false。 bool spfa() { // 不需要初始化dist数组 // 原理：如果某条最短路径上有n个点（除了自己），那么加上自己之后一共有n+1个点，由抽屉原理一定有两个点相同，所以存在环。 queue\u003cint\u003e q; for (int i = 1; i \u003c= n; i ++ ) { q.push(i); st[i] = true; } while (q.size()) { auto t = q.front(); q.pop(); st[t] = false; for (int i = h[t]; i != -1; i = ne[i]) { int j = e[i]; if (dist[j] \u003e dist[t] + w[i]) { dist[j] = dist[t] + w[i]; cnt[j] = cnt[t] + 1; if (cnt[j] \u003e= n) return true; // 如果从1号点到x的最短路中包含至少n个点（不包括自己），则说明存在环 if (!st[j]) { q.push(j); st[j] = true; } } } } return false; } floyd算法 —— 模板题 AcWing 854. Floyd求最短路 1 2 3 4 5 6 7 8 9 10 11 12 13 14 时间复杂度是 O(n3)O(n3), nn 表示点数 初始化： for (int i = 1; i \u003c= n; i ++ ) for (int j = 1; j \u003c= n; j ++ ) if (i == j) d[i][j] = 0; else d[i][j] = INF; // 算法结束后，d[a][b]表示a到b的最短距离 void floyd() { for (int k = 1; k \u003c= n; k ++ ) for (int i = 1; i \u003c= n; i ++ ) for (int j = 1; j \u003c= n; j ++ ) d[i][j] = min(d[i][j], d[i][k] + d[k][j]); } 最小生成树（无向图） Prim : 朴素版Prim O(n^2)(稠密图) ; 堆优化版Prim O(mlogn)(一般不会用)\nKruskal : O(mlogm)(稀疏图)\n朴素版prim算法 —— 模板题 AcWing 858. Prim算法求最小生成树 时间复杂度是 O(n^2+m), n 表示点数，m 表示边数\n初始化距离为正无穷，迭代所有点，找到集合中最近的点，更新它到集合的距离，把t加到集合中。\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 int n; // n表示点数 int g[N][N]; // 邻接矩阵，存储所有边 int dist[N]; // 存储其他点到当前最小生成树的距离 bool st[N]; // 存储每个点是否已经在生成树中 // 如果图不连通，则返回INF(值是0x3f3f3f3f), 否则返回最小生成树的树边权重之和 int prim() { memset(dist, 0x3f, sizeof dist); int res = 0; for (int i = 0; i \u003c n; i ++ ) { int t = -1; for (int j = 1; j \u003c= n; j ++ ) if (!st[j] \u0026\u0026 (t == -1 || dist[t] \u003e dist[j])) t = j; if (i \u0026\u0026 dist[t] == INF) return INF; if (i) res += dist[t]; st[t] = true; for (int j = 1; j \u003c= n; j ++ ) dist[j] = min(dist[j], g[t][j]); } return res; } Kruskal算法 —— 模板题 AcWing 859. Kruskal算法求最小生成树 时间复杂度是 O(mlogm), n 表示点数，m 表示边数\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 int n, m; // n是点数，m是边数 int p[N]; // 并查集的父节点数组 struct Edge // 存储边 { int a, b, w; // 重载小于号运算符 // 用于比较两个Edge对象的大小关系 bool operator \u003c (const Edge \u0026W) const { return w \u003c W.w; // 如果当前对象的边权小于W对象的边权，返回true，否则返回false } }edges[M]; int find(int x) // 并查集核心操作 { if (p[x] != x) p[x] = find(p[x]); return p[x]; } int kruskal() { sort(edges, edges + m); for (int i = 1; i \u003c= n; i ++ ) p[i] = i; // 初始化并查集 int res = 0, cnt = 0; for (int i = 0; i \u003c m; i ++ ) { int a = edges[i].a, b = edges[i].b, w = edges[i].w; a = find(a), b = find(b); if (a != b) // 如果两个连通块不连通，则将这两个连通块合并 { p[a] = b; res += w; cnt ++ ; } } if (cnt \u003c n - 1) return INF; return res; } 染色法（本质dfs)判别二分图 —— 模板题 AcWing 860. 染色法判定二分图 给定一个 n 个点m条边的无向图，图中可能存在重边和自环。请你判断这个图是否是二分图。\n时间复杂度是 O(n+m), n 表示点数，m 表示边数\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 int n; // n表示点数 int h[N], e[M], ne[M], idx; // 邻接表存储图 int color[N]; // 表示每个点的颜色，-1表示为染色，0表示白色，1表示黑色 // 参数：u表示当前节点，c表示当前点的颜色 bool dfs(int u, int c) { color[u] = c; for (int i = h[u]; i != -1; i = ne[i]) { int j = e[i]; if (color[j] == -1) { if (!dfs(j, !c)) return false; } else if (color[j] == c) return false; } return true; } bool check() { memset(color, -1, sizeof color); bool flag = true; for (int i = 1; i \u003c= n; i ++ ) if (color[i] == -1) if (!dfs(i, 0)) { flag = false; break; } return flag; } 匈牙利算法 —— 模板题 AcWing 861. 二分图的最大匹配 时间复杂度最坏是 O(nm)，实际运行时间一般远小于O(nm)， n 表示点数，m 表示边数\n做错一件事，错过一件事\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 int n1, n2; // n1表示第一个集合中的点数，n2表示第二个集合中的点数 int h[N], e[M], ne[M], idx; // 邻接表存储所有边，匈牙利算法中只会用到从第二个集合指向第一个集合的边，所以这里只用存一个方向的边 int match[N]; // 存储第二个集合中的每个点当前匹配的第一个集合中的点是哪个 bool st[N]; // 表示第二个集合中的每个点是否已经被遍历过 bool find(int x) { for (int i = h[x]; i != -1; i = ne[i]) { int j = e[i]; if (!st[j]) { st[j] = true; if (match[j] == 0 || find(match[j])) { match[j] = x; return true; } } } return false; } // 求最大匹配数，依次枚举第一个集合中的每个点能否匹配第二个集合中的点 int res = 0; for (int i = 1; i \u003c= n1; i ++ ) { memset(st, false, sizeof st); if (find(i)) res ++ ; } 作者：yxc 链接：https://www.acwing.com/blog/content/405/ 来源：AcWing 著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。\n第四章 试除法判定质数 —— 模板题 AcWing 866. 试除法判定质数 质数：大于1的整数中，如果只包含1和本身两个约束，称为质数（素数）\n（1）判定，试除法\n（2）分解质因数\n1 2 3 4 5 6 7 8 bool is_prime(int x) { if (x \u003c 2) return false; for (int i = 2; i \u003c= x / i; i ++ ) if (x % i == 0) return false; return true; } 试除法分解质因数 —— 模板题 AcWing 867. 分解质因数 1 2 3 4 5 6 7 8 9 10 11 12 void divide(int x) { for (int i = 2; i \u003c= x / i; i ++ ) if (x % i == 0) { int s = 0; while (x % i == 0) x /= i, s ++ ; cout \u003c\u003c i \u003c\u003c ' ' \u003c\u003c s \u003c\u003c endl; } if (x \u003e 1) cout \u003c\u003c x \u003c\u003c ' ' \u003c\u003c 1 \u003c\u003c endl; cout \u003c\u003c endl; } 朴素筛法求素数 —— 模板题 AcWing 868. 筛质数 1 2 3 4 5 6 7 8 9 10 11 12 int primes[N], cnt; // primes[]存储所有素数 bool st[N]; // st[x]存储x是否被筛掉 void get_primes(int n) { for (int i = 2; i \u003c= n; i ++ ) { if (st[i]) continue; primes[cnt ++ ] = i; for (int j = i; j \u003c= n; j += i) st[j] = true; } } 线性筛法求素数 —— 模板题 AcWing 868. 筛质数 被最小质因子筛掉\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 int primes[N], cnt; // primes[]存储所有素数 bool st[N]; // st[x]存储x是否被筛掉 void get_primes(int n) { for (int i = 2; i \u003c= n; i ++ ) { if (!st[i]) primes[cnt ++ ] = i; for (int j = 0; primes[j] \u003c= n / i; j ++ ) { st[primes[j] * i] = true; if (i % primes[j] == 0) break; } } } 试除法求所有约数 —— 模板题 AcWing 869. 试除法求约数 int范围内约数个数最多为1500个左右\n1 2 3 4 5 6 7 8 9 10 11 12 vector\u003cint\u003e get_divisors(int x) { vector\u003cint\u003e res; for (int i = 1; i \u003c= x / i; i ++ ) if (x % i == 0) { res.push_back(i); if (i != x / i) res.push_back(x / i); } sort(res.begin(), res.end()); return res; } 约数个数和约数之和 —— 模板题 AcWing 870. 约数个数, AcWing 871. 约数之和 1 2 3 如果 N = p1^c1 * p2^c2 * ... *pk^ck 约数个数： (c1 + 1) * (c2 + 1) * ... * (ck + 1) 约数之和： (p1^0 + p1^1 + ... + p1^c1) * ... * (pk^0 + pk^1 + ... + pk^ck) 欧几里得算法 —— 模板题 AcWing 872. 最大公约数 1 2 3 4 int gcd(int a, int b) { return b ? gcd(b, a % b) : a; } 求欧拉函数 —— 模板题 AcWing 873. 欧拉函数 欧拉函数公式（容斥原理) : n*(1-p1)*(1-p2)…(1-pk)\n1 2 3 4 5 6 7 8 9 10 11 12 int phi(int x) { int res = x; for (int i = 2; i \u003c= x / i; i ++ ) if (x % i == 0) { res = res / i * (i - 1); while (x % i == 0) x /= i; } if (x \u003e 1) res = res / x * (x - 1); return res; } 筛法求欧拉函数 —— 模板题 AcWing 874. 筛法求欧拉函数 O(n) 线性求所有数的欧拉函数\n应用：欧拉定理：a与n互质 a^φ(n)=1(mod n)\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 int primes[N], cnt; // primes[]存储所有素数 int euler[N]; // 存储每个数的欧拉函数 bool st[N]; // st[x]存储x是否被筛掉 void get_eulers(int n) { euler[1] = 1; for (int i = 2; i \u003c= n; i ++ ) { if (!st[i]) { primes[cnt ++ ] = i; euler[i] = i - 1; } for (int j = 0; primes[j] \u003c= n / i; j ++ ) { int t = primes[j] * i; st[t] = true; if (i % primes[j] == 0) { euler[t] = euler[i] * primes[j]; break; } euler[t] = euler[i] * (primes[j] - 1); } } } 快速幂 —— 模板题 AcWing 875. 快速幂 求 m^k mod p，时间复杂度 O(logk)。\n1 2 3 4 5 6 7 8 9 10 11 int qmi(int m, int k, int p) { int res = 1 % p, t = m; while (k) { if (k\u00261) res = res * t % p; t = t * t % p; k \u003e\u003e= 1; } return res; } 扩展欧几里得算法 —— 模板题 AcWing 877. 扩展欧几里得算法 1 2 3 4 5 6 7 8 9 10 11 12 // 求x, y，使得ax + by = gcd(a, b) int exgcd(int a, int b, int \u0026x, int \u0026y) { if (!b) { x = 1; y = 0; return a; } int d = exgcd(b, a % b, y, x); y -= (a/b) * x; return d; } 高斯消元 —— 模板题 AcWing 883. 高斯消元解线性方程组 O(n^3)时间内解n个方程n个未知数的解。\n解：无解 ； 无穷多组解 ； 唯一解 ；\n完美阶梯型：唯一解 *0=*非零 ： *无解 0=0 ： 无穷多组解 高斯消元：\n枚举每一列c：\n找到绝对值最大的一行 将该行换到最上面 将该行第一个数变成1 将下面所有行的第c列消成0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 // a[N][N]是增广矩阵 int gauss() { int c, r; for (c = 0, r = 0; c \u003c n; c ++ ) { int t = r; for (int i = r; i \u003c n; i ++ ) // 找到绝对值最大的行 if (fabs(a[i][c]) \u003e fabs(a[t][c])) t = i; if (fabs(a[t][c]) \u003c eps) continue; for (int i = c; i \u003c= n; i ++ ) swap(a[t][i], a[r][i]); // 将绝对值最大的行换到最顶端 for (int i = n; i \u003e= c; i -- ) a[r][i] /= a[r][c]; // 将当前上的首位变成1 for (int i = r + 1; i \u003c n; i ++ ) // 用当前行将下面所有的列消成0 if (fabs(a[i][c]) \u003e eps) for (int j = n; j \u003e= c; j -- ) a[i][j] -= a[r][j] * a[i][c]; r ++ ; } if (r \u003c n) { for (int i = r; i \u003c n; i ++ ) if (fabs(a[i][n]) \u003e eps) return 2; // 无解 return 1; // 有无穷多组解 } for (int i = n - 1; i \u003e= 0; i -- ) for (int j = i + 1; j \u003c n; j ++ ) a[i][n] -= a[i][j] * a[j][n]; return 0; // 有唯一解 } 递归法求组合数 —— 模板题 AcWing 885. 求组合数 I 十万 1",
  "wordCount" : "15215",
  "inLanguage": "zh",
  "datePublished": "2024-04-09T15:37:01+08:00",
  "dateModified": "2024-04-09T15:37:01+08:00",
  "author":{
    "@type": "Person",
    "name": "ShowGuan"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://kennems.github.io/posts/tech/acwing/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Kennem's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://kennems.github.io/img/sun.png"
    }
  }
}
</script>
<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />
<script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>




</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://kennems.github.io/" accesskey="h" title="Kennem&#39;s Blog (Alt + H)">
                <img src="https://kennems.github.io/img/sun.png" alt="" aria-label="logo"
                    height="35">Kennem&#39;s Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://kennems.github.io/" title="🏠主页">
                    <span>🏠主页</span>
                </a>
            </li>
            <li>
                <a href="https://kennems.github.io/search" title="🔍搜索 (Alt &#43; /)" accesskey=/>
                    <span>🔍搜索</span>
                </a>
            </li>
            <li>
                <a href="https://kennems.github.io/posts" title="📚文章">
                    <span>📚文章</span>
                </a>
            </li>
            <li>
                <a href="https://kennems.github.io/archives" title="⏱时间轴">
                    <span>⏱时间轴</span>
                </a>
            </li>
            <li>
                <a href="https://kennems.github.io/tags" title="🔖标签">
                    <span>🔖标签</span>
                </a>
            </li>
            <li>
                <a href="https://kennems.github.io/categories" title="🗂️分类">
                    <span>🗂️分类</span>
                </a>
            </li>
            <li>
                <a href="https://kennems.github.io/about" title="🙋🏻‍♂️关于">
                    <span>🙋🏻‍♂️关于</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://kennems.github.io/">主页</a>&nbsp;»&nbsp;<a href="https://kennems.github.io/posts/">📚文章</a>&nbsp;»&nbsp;<a href="https://kennems.github.io/posts/tech/">💻技术</a></div>
    <h1 class="post-title entry-hint-parent">
      Acwing算法学习
    </h1>
    <div class="post-description">
      Acwing算法学习
    </div>
    <div class="post-meta"><span title='2024-04-09 15:37:01 +0800 CST'>2024-04-09</span>&nbsp;·&nbsp;31 分钟&nbsp;·&nbsp;15215 字&nbsp;·&nbsp;updated:&nbsp;2024-04-09&nbsp;·&nbsp;ShowGuan

</div>
    
     <div class="post-password">
        
    </div>
  </header> <aside id="toc-container" class="toc-container wide">
    <div class="toc">
        <details  open>
            <summary accesskey="c" title="(Alt + C)">
                <span class="details">目录</span>
            </summary>

            <div class="inner"><ul>
                    <li>
                        <a href="#acwing%e7%ae%97%e6%b3%95%e5%ad%a6%e4%b9%a0" aria-label="Acwing算法学习">Acwing算法学习</a><ul>
                            
                    <li>
                        <a href="#%e7%ac%ac%e4%b8%80%e7%ab%a0" aria-label="第一章">第一章</a><ul>
                            
                    <li>
                        <a href="#%e5%bf%ab%e9%80%9f%e6%8e%92%e5%ba%8f%e7%ae%97%e6%b3%95%e6%a8%a1%e6%9d%bf--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-785-%e5%bf%ab%e9%80%9f%e6%8e%92%e5%ba%8f" aria-label="快速排序算法模板 —— 模板题 AcWing 785. 快速排序">快速排序算法模板 —— 模板题 AcWing 785. 快速排序</a></li>
                    <li>
                        <a href="#%e5%bd%92%e5%b9%b6%e6%8e%92%e5%ba%8f%e7%ae%97%e6%b3%95%e6%a8%a1%e6%9d%bf--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-787-%e5%bd%92%e5%b9%b6%e6%8e%92%e5%ba%8f" aria-label="归并排序算法模板 —— 模板题 AcWing 787. 归并排序">归并排序算法模板 —— 模板题 AcWing 787. 归并排序</a></li>
                    <li>
                        <a href="#%e6%95%b4%e6%95%b0%e4%ba%8c%e5%88%86%e7%ae%97%e6%b3%95%e6%a8%a1%e6%9d%bf--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-789-%e6%95%b0%e7%9a%84%e8%8c%83%e5%9b%b4" aria-label="整数二分算法模板 —— 模板题 AcWing 789. 数的范围">整数二分算法模板 —— 模板题 AcWing 789. 数的范围</a></li>
                    <li>
                        <a href="#%e6%b5%ae%e7%82%b9%e6%95%b0%e4%ba%8c%e5%88%86%e7%ae%97%e6%b3%95%e6%a8%a1%e6%9d%bf--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-790-%e6%95%b0%e7%9a%84%e4%b8%89%e6%ac%a1%e6%96%b9%e6%a0%b9" aria-label="浮点数二分算法模板 —— 模板题 AcWing 790. 数的三次方根">浮点数二分算法模板 —— 模板题 AcWing 790. 数的三次方根</a></li>
                    <li>
                        <a href="#%e9%ab%98%e7%b2%be%e5%ba%a6%e5%8a%a0%e6%b3%95--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-791-%e9%ab%98%e7%b2%be%e5%ba%a6%e5%8a%a0%e6%b3%95" aria-label="高精度加法 —— 模板题 AcWing 791. 高精度加法">高精度加法 —— 模板题 AcWing 791. 高精度加法</a></li>
                    <li>
                        <a href="#%e9%ab%98%e7%b2%be%e5%ba%a6%e5%87%8f%e6%b3%95--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-792-%e9%ab%98%e7%b2%be%e5%ba%a6%e5%87%8f%e6%b3%95" aria-label="高精度减法 —— 模板题 AcWing 792. 高精度减法">高精度减法 —— 模板题 AcWing 792. 高精度减法</a></li>
                    <li>
                        <a href="#%e9%ab%98%e7%b2%be%e5%ba%a6%e4%b9%98%e4%bd%8e%e7%b2%be%e5%ba%a6--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-793-%e9%ab%98%e7%b2%be%e5%ba%a6%e4%b9%98%e6%b3%95" aria-label="高精度乘低精度 —— 模板题 AcWing 793. 高精度乘法">高精度乘低精度 —— 模板题 AcWing 793. 高精度乘法</a></li>
                    <li>
                        <a href="#%e9%ab%98%e7%b2%be%e5%ba%a6%e9%99%a4%e4%bb%a5%e4%bd%8e%e7%b2%be%e5%ba%a6--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-794-%e9%ab%98%e7%b2%be%e5%ba%a6%e9%99%a4%e6%b3%95" aria-label="高精度除以低精度 —— 模板题 AcWing 794. 高精度除法">高精度除以低精度 —— 模板题 AcWing 794. 高精度除法</a></li>
                    <li>
                        <a href="#%e4%b8%80%e7%bb%b4%e5%89%8d%e7%bc%80%e5%92%8c--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-795-%e5%89%8d%e7%bc%80%e5%92%8c" aria-label="一维前缀和 —— 模板题 AcWing 795. 前缀和">一维前缀和 —— 模板题 AcWing 795. 前缀和</a></li>
                    <li>
                        <a href="#%e4%ba%8c%e7%bb%b4%e5%89%8d%e7%bc%80%e5%92%8c--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-796-%e5%ad%90%e7%9f%a9%e9%98%b5%e7%9a%84%e5%92%8c" aria-label="二维前缀和 —— 模板题 AcWing 796. 子矩阵的和">二维前缀和 —— 模板题 AcWing 796. 子矩阵的和</a></li>
                    <li>
                        <a href="#%e4%b8%80%e7%bb%b4%e5%b7%ae%e5%88%86--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-797-%e5%b7%ae%e5%88%86" aria-label="一维差分 —— 模板题 AcWing 797. 差分">一维差分 —— 模板题 AcWing 797. 差分</a></li>
                    <li>
                        <a href="#%e4%ba%8c%e7%bb%b4%e5%b7%ae%e5%88%86--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-798-%e5%b7%ae%e5%88%86%e7%9f%a9%e9%98%b5%e4%ba%8c%e7%bb%b4%e5%b7%ae%e5%88%86" aria-label="二维差分 —— 模板题 AcWing 798. 差分矩阵/二维差分">二维差分 —— 模板题 AcWing 798. 差分矩阵/二维差分</a></li>
                    <li>
                        <a href="#%e5%8f%8c%e6%8c%87%e9%92%88%e7%ae%97%e6%b3%95--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-799-%e6%9c%80%e9%95%bf%e8%bf%9e%e7%bb%ad%e4%b8%8d%e9%87%8d%e5%a4%8d%e5%ad%90%e5%ba%8f%e5%88%97-acwing-800-%e6%95%b0%e7%bb%84%e5%85%83%e7%b4%a0%e7%9a%84%e7%9b%ae%e6%a0%87%e5%92%8c-__%e6%bb%91%e5%8a%a8%e7%aa%97%e5%8f%a3" aria-label="双指针算法 —— 模板题 AcWIng 799. 最长连续不重复子序列, AcWing 800. 数组元素的目标和 __滑动窗口？">双指针算法 —— 模板题 AcWIng 799. 最长连续不重复子序列, AcWing 800. 数组元素的目标和 __滑动窗口？</a></li>
                    <li>
                        <a href="#%e4%bd%8d%e8%bf%90%e7%ae%97--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-801-%e4%ba%8c%e8%bf%9b%e5%88%b6%e4%b8%ad1%e7%9a%84%e4%b8%aa%e6%95%b0" aria-label="位运算 —— 模板题 AcWing 801. 二进制中1的个数">位运算 —— 模板题 AcWing 801. 二进制中1的个数</a></li>
                    <li>
                        <a href="#%e6%95%b4%e6%95%b0%e7%a6%bb%e6%95%a3%e5%8c%96--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-802-%e5%8c%ba%e9%97%b4%e5%92%8c" aria-label="整数离散化 —— 模板题 AcWing 802. 区间和">整数离散化 —— 模板题 AcWing 802. 区间和</a></li>
                    <li>
                        <a href="#%e5%8c%ba%e9%97%b4%e5%90%88%e5%b9%b6--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-803-%e5%8c%ba%e9%97%b4%e5%90%88%e5%b9%b6" aria-label="区间合并 —— 模板题 AcWing 803. 区间合并">区间合并 —— 模板题 AcWing 803. 区间合并</a></li></ul>
                    </li>
                    <li>
                        <a href="#%e7%ac%ac%e4%ba%8c%e7%ab%a0" aria-label="第二章">第二章</a><ul>
                            
                    <li>
                        <a href="#%e5%8d%95%e9%93%be%e8%a1%a8--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-826-%e5%8d%95%e9%93%be%e8%a1%a8" aria-label="单链表 —— 模板题 AcWing 826. 单链表">单链表 —— 模板题 AcWing 826. 单链表</a></li>
                    <li>
                        <a href="#%e5%8f%8c%e9%93%be%e8%a1%a8--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-827-%e5%8f%8c%e9%93%be%e8%a1%a8" aria-label="双链表 —— 模板题 AcWing 827. 双链表">双链表 —— 模板题 AcWing 827. 双链表</a></li>
                    <li>
                        <a href="#%e6%a0%88--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-828-%e6%a8%a1%e6%8b%9f%e6%a0%88" aria-label="栈 —— 模板题 AcWing 828. 模拟栈">栈 —— 模板题 AcWing 828. 模拟栈</a></li>
                    <li>
                        <a href="#%e9%98%9f%e5%88%97--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-829-%e6%a8%a1%e6%8b%9f%e9%98%9f%e5%88%97" aria-label="队列 —— 模板题 AcWing 829. 模拟队列">队列 —— 模板题 AcWing 829. 模拟队列</a></li>
                    <li>
                        <a href="#%e5%8d%95%e8%b0%83%e6%a0%88--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-830-%e5%8d%95%e8%b0%83%e6%a0%88" aria-label="单调栈 —— 模板题 AcWing 830. 单调栈">单调栈 —— 模板题 AcWing 830. 单调栈</a></li>
                    <li>
                        <a href="#%e5%8d%95%e8%b0%83%e9%98%9f%e5%88%97--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-154-%e6%bb%91%e5%8a%a8%e7%aa%97%e5%8f%a3" aria-label="单调队列 —— 模板题 AcWing 154. 滑动窗口">单调队列 —— 模板题 AcWing 154. 滑动窗口</a></li>
                    <li>
                        <a href="#kmp--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-831-kmp%e5%ad%97%e7%ac%a6%e4%b8%b2" aria-label="KMP —— 模板题 AcWing 831. KMP字符串">KMP —— 模板题 AcWing 831. KMP字符串</a></li>
                    <li>
                        <a href="#trie%e6%a0%91--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-835-trie%e5%ad%97%e7%ac%a6%e4%b8%b2%e7%bb%9f%e8%ae%a1" aria-label="Trie树 —— 模板题 AcWing 835. Trie字符串统计">Trie树 —— 模板题 AcWing 835. Trie字符串统计</a></li>
                    <li>
                        <a href="#%e5%b9%b6%e6%9f%a5%e9%9b%86--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-836-%e5%90%88%e5%b9%b6%e9%9b%86%e5%90%88-acwing-837-%e8%bf%9e%e9%80%9a%e5%9d%97%e4%b8%ad%e7%82%b9%e7%9a%84%e6%95%b0%e9%87%8f" aria-label="并查集 —— 模板题 AcWing 836. 合并集合, AcWing 837. 连通块中点的数量">并查集 —— 模板题 AcWing 836. 合并集合, AcWing 837. 连通块中点的数量</a></li>
                    <li>
                        <a href="#%e5%a0%86--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-838-%e5%a0%86%e6%8e%92%e5%ba%8f-acwing-839-%e6%a8%a1%e6%8b%9f%e5%a0%86" aria-label="堆 —— 模板题 AcWing 838. 堆排序, AcWing 839. 模拟堆">堆 —— 模板题 AcWing 838. 堆排序, AcWing 839. 模拟堆</a></li>
                    <li>
                        <a href="#%e4%b8%80%e8%88%ac%e5%93%88%e5%b8%8c--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-840-%e6%a8%a1%e6%8b%9f%e6%95%a3%e5%88%97%e8%a1%a8" aria-label="一般哈希 —— 模板题 AcWing 840. 模拟散列表">一般哈希 —— 模板题 AcWing 840. 模拟散列表</a></li>
                    <li>
                        <a href="#%e5%ad%97%e7%ac%a6%e4%b8%b2%e5%93%88%e5%b8%8c--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-841-%e5%ad%97%e7%ac%a6%e4%b8%b2%e5%93%88%e5%b8%8c" aria-label="字符串哈希 —— 模板题 AcWing 841. 字符串哈希">字符串哈希 —— 模板题 AcWing 841. 字符串哈希</a></li></ul>
                    </li>
                    <li>
                        <a href="#c-stl%e7%ae%80%e4%bb%8b" aria-label="C&#43;&#43; STL简介">C++ STL简介</a></li>
                    <li>
                        <a href="#%e7%ac%ac%e4%b8%89%e7%ab%a0" aria-label="第三章">第三章</a><ul>
                            
                    <li>
                        <a href="#%e6%a0%91%e4%b8%8e%e5%9b%be%e7%9a%84%e5%ad%98%e5%82%a8" aria-label="树与图的存储">树与图的存储</a></li>
                    <li>
                        <a href="#%e6%a0%91%e4%b8%8e%e5%9b%be%e7%9a%84%e9%81%8d%e5%8e%86" aria-label="树与图的遍历">树与图的遍历</a><ul>
                            
                    <li>
                        <a href="#1-%e6%b7%b1%e5%ba%a6%e4%bc%98%e5%85%88%e9%81%8d%e5%8e%86--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-846-%e6%a0%91%e7%9a%84%e9%87%8d%e5%bf%83" aria-label="(1) 深度优先遍历 —— 模板题 AcWing 846. 树的重心">(1) 深度优先遍历 —— 模板题 AcWing 846. 树的重心</a></li>
                    <li>
                        <a href="#2-%e5%ae%bd%e5%ba%a6%e4%bc%98%e5%85%88%e9%81%8d%e5%8e%86--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-847-%e5%9b%be%e4%b8%ad%e7%82%b9%e7%9a%84%e5%b1%82%e6%ac%a1" aria-label="(2) 宽度优先遍历 —— 模板题 AcWing 847. 图中点的层次">(2) 宽度优先遍历 —— 模板题 AcWing 847. 图中点的层次</a></li></ul>
                    </li>
                    <li>
                        <a href="#%e6%8b%93%e6%89%91%e6%8e%92%e5%ba%8f--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-848-%e6%9c%89%e5%90%91%e5%9b%be%e7%9a%84%e6%8b%93%e6%89%91%e5%ba%8f%e5%88%97" aria-label="拓扑排序 —— 模板题 AcWing 848. 有向图的拓扑序列">拓扑排序 —— 模板题 AcWing 848. 有向图的拓扑序列</a></li>
                    <li>
                        <a href="#%e6%9c%80%e7%9f%ad%e8%b7%af" aria-label="最短路">最短路</a></li>
                    <li>
                        <a href="#%e6%9c%b4%e7%b4%a0dijkstra%e7%ae%97%e6%b3%95--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-849-dijkstra%e6%b1%82%e6%9c%80%e7%9f%ad%e8%b7%af-i-%e5%9f%ba%e4%ba%8e%e8%b4%aa%e5%bf%83" aria-label="朴素dijkstra算法 —— 模板题 AcWing 849. Dijkstra求最短路 I 基于贪心">朴素dijkstra算法 —— 模板题 AcWing 849. Dijkstra求最短路 I 基于贪心</a></li>
                    <li>
                        <a href="#%e5%a0%86%e4%bc%98%e5%8c%96%e7%89%88dijkstra--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-850-dijkstra%e6%b1%82%e6%9c%80%e7%9f%ad%e8%b7%af-ii" aria-label="堆优化版dijkstra —— 模板题 AcWing 850. Dijkstra求最短路 II">堆优化版dijkstra —— 模板题 AcWing 850. Dijkstra求最短路 II</a></li>
                    <li>
                        <a href="#bellman-ford%e7%ae%97%e6%b3%95--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-853-%e6%9c%89%e8%be%b9%e6%95%b0%e9%99%90%e5%88%b6%e7%9a%84%e6%9c%80%e7%9f%ad%e8%b7%af" aria-label="Bellman-Ford算法 —— 模板题 AcWing 853. 有边数限制的最短路">Bellman-Ford算法 —— 模板题 AcWing 853. 有边数限制的最短路</a></li>
                    <li>
                        <a href="#spfa-%e7%ae%97%e6%b3%95%e9%98%9f%e5%88%97%e4%bc%98%e5%8c%96%e7%9a%84bellman-ford%e7%ae%97%e6%b3%95--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-851-spfa%e6%b1%82%e6%9c%80%e7%9f%ad%e8%b7%af" aria-label="spfa 算法（队列优化的Bellman-Ford算法） —— 模板题 AcWing 851. spfa求最短路">spfa 算法（队列优化的Bellman-Ford算法） —— 模板题 AcWing 851. spfa求最短路</a></li>
                    <li>
                        <a href="#spfa%e5%88%a4%e6%96%ad%e5%9b%be%e4%b8%ad%e6%98%af%e5%90%a6%e5%ad%98%e5%9c%a8%e8%b4%9f%e7%8e%af--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-852-spfa%e5%88%a4%e6%96%ad%e8%b4%9f%e7%8e%af" aria-label="spfa判断图中是否存在负环 —— 模板题 AcWing 852. spfa判断负环">spfa判断图中是否存在负环 —— 模板题 AcWing 852. spfa判断负环</a></li>
                    <li>
                        <a href="#floyd%e7%ae%97%e6%b3%95--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-854-floyd%e6%b1%82%e6%9c%80%e7%9f%ad%e8%b7%af" aria-label="floyd算法 —— 模板题 AcWing 854. Floyd求最短路">floyd算法 —— 模板题 AcWing 854. Floyd求最短路</a></li>
                    <li>
                        <a href="#%e6%9c%80%e5%b0%8f%e7%94%9f%e6%88%90%e6%a0%91%e6%97%a0%e5%90%91%e5%9b%be" aria-label="最小生成树（无向图）">最小生成树（无向图）</a></li>
                    <li>
                        <a href="#%e6%9c%b4%e7%b4%a0%e7%89%88prim%e7%ae%97%e6%b3%95--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-858-prim%e7%ae%97%e6%b3%95%e6%b1%82%e6%9c%80%e5%b0%8f%e7%94%9f%e6%88%90%e6%a0%91" aria-label="朴素版prim算法 —— 模板题 AcWing 858. Prim算法求最小生成树">朴素版prim算法 —— 模板题 AcWing 858. Prim算法求最小生成树</a></li>
                    <li>
                        <a href="#kruskal%e7%ae%97%e6%b3%95--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-859-kruskal%e7%ae%97%e6%b3%95%e6%b1%82%e6%9c%80%e5%b0%8f%e7%94%9f%e6%88%90%e6%a0%91" aria-label="Kruskal算法 —— 模板题 AcWing 859. Kruskal算法求最小生成树">Kruskal算法 —— 模板题 AcWing 859. Kruskal算法求最小生成树</a></li>
                    <li>
                        <a href="#%e6%9f%93%e8%89%b2%e6%b3%95%e6%9c%ac%e8%b4%a8dfs%e5%88%a4%e5%88%ab%e4%ba%8c%e5%88%86%e5%9b%be--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-860-%e6%9f%93%e8%89%b2%e6%b3%95%e5%88%a4%e5%ae%9a%e4%ba%8c%e5%88%86%e5%9b%be" aria-label="染色法（本质dfs)判别二分图 —— 模板题 AcWing 860. 染色法判定二分图">染色法（本质dfs)判别二分图 —— 模板题 AcWing 860. 染色法判定二分图</a></li>
                    <li>
                        <a href="#%e5%8c%88%e7%89%99%e5%88%a9%e7%ae%97%e6%b3%95--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-861-%e4%ba%8c%e5%88%86%e5%9b%be%e7%9a%84%e6%9c%80%e5%a4%a7%e5%8c%b9%e9%85%8d" aria-label="匈牙利算法 —— 模板题 AcWing 861. 二分图的最大匹配">匈牙利算法 —— 模板题 AcWing 861. 二分图的最大匹配</a></li></ul>
                    </li>
                    <li>
                        <a href="#%e7%ac%ac%e5%9b%9b%e7%ab%a0" aria-label="第四章">第四章</a><ul>
                            
                    <li>
                        <a href="#%e8%af%95%e9%99%a4%e6%b3%95%e5%88%a4%e5%ae%9a%e8%b4%a8%e6%95%b0--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-866-%e8%af%95%e9%99%a4%e6%b3%95%e5%88%a4%e5%ae%9a%e8%b4%a8%e6%95%b0" aria-label="试除法判定质数 —— 模板题 AcWing 866. 试除法判定质数">试除法判定质数 —— 模板题 AcWing 866. 试除法判定质数</a></li>
                    <li>
                        <a href="#%e8%af%95%e9%99%a4%e6%b3%95%e5%88%86%e8%a7%a3%e8%b4%a8%e5%9b%a0%e6%95%b0--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-867-%e5%88%86%e8%a7%a3%e8%b4%a8%e5%9b%a0%e6%95%b0" aria-label="试除法分解质因数 —— 模板题 AcWing 867. 分解质因数">试除法分解质因数 —— 模板题 AcWing 867. 分解质因数</a></li>
                    <li>
                        <a href="#%e6%9c%b4%e7%b4%a0%e7%ad%9b%e6%b3%95%e6%b1%82%e7%b4%a0%e6%95%b0--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-868-%e7%ad%9b%e8%b4%a8%e6%95%b0" aria-label="朴素筛法求素数 —— 模板题 AcWing 868. 筛质数">朴素筛法求素数 —— 模板题 AcWing 868. 筛质数</a></li>
                    <li>
                        <a href="#%e7%ba%bf%e6%80%a7%e7%ad%9b%e6%b3%95%e6%b1%82%e7%b4%a0%e6%95%b0--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-868-%e7%ad%9b%e8%b4%a8%e6%95%b0" aria-label="线性筛法求素数 —— 模板题 AcWing 868. 筛质数">线性筛法求素数 —— 模板题 AcWing 868. 筛质数</a></li>
                    <li>
                        <a href="#%e8%af%95%e9%99%a4%e6%b3%95%e6%b1%82%e6%89%80%e6%9c%89%e7%ba%a6%e6%95%b0--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-869-%e8%af%95%e9%99%a4%e6%b3%95%e6%b1%82%e7%ba%a6%e6%95%b0" aria-label="试除法求所有约数 —— 模板题 AcWing 869. 试除法求约数">试除法求所有约数 —— 模板题 AcWing 869. 试除法求约数</a></li>
                    <li>
                        <a href="#%e7%ba%a6%e6%95%b0%e4%b8%aa%e6%95%b0%e5%92%8c%e7%ba%a6%e6%95%b0%e4%b9%8b%e5%92%8c--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-870-%e7%ba%a6%e6%95%b0%e4%b8%aa%e6%95%b0-acwing-871-%e7%ba%a6%e6%95%b0%e4%b9%8b%e5%92%8c" aria-label="约数个数和约数之和 —— 模板题 AcWing 870. 约数个数, AcWing 871. 约数之和">约数个数和约数之和 —— 模板题 AcWing 870. 约数个数, AcWing 871. 约数之和</a></li>
                    <li>
                        <a href="#%e6%ac%a7%e5%87%a0%e9%87%8c%e5%be%97%e7%ae%97%e6%b3%95--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-872-%e6%9c%80%e5%a4%a7%e5%85%ac%e7%ba%a6%e6%95%b0" aria-label="欧几里得算法 —— 模板题 AcWing 872. 最大公约数">欧几里得算法 —— 模板题 AcWing 872. 最大公约数</a></li>
                    <li>
                        <a href="#%e6%b1%82%e6%ac%a7%e6%8b%89%e5%87%bd%e6%95%b0--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-873-%e6%ac%a7%e6%8b%89%e5%87%bd%e6%95%b0" aria-label="求欧拉函数 —— 模板题 AcWing 873. 欧拉函数">求欧拉函数 —— 模板题 AcWing 873. 欧拉函数</a></li>
                    <li>
                        <a href="#%e7%ad%9b%e6%b3%95%e6%b1%82%e6%ac%a7%e6%8b%89%e5%87%bd%e6%95%b0--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-874-%e7%ad%9b%e6%b3%95%e6%b1%82%e6%ac%a7%e6%8b%89%e5%87%bd%e6%95%b0" aria-label="筛法求欧拉函数 —— 模板题 AcWing 874. 筛法求欧拉函数">筛法求欧拉函数 —— 模板题 AcWing 874. 筛法求欧拉函数</a></li>
                    <li>
                        <a href="#%e5%bf%ab%e9%80%9f%e5%b9%82--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-875-%e5%bf%ab%e9%80%9f%e5%b9%82" aria-label="快速幂 —— 模板题 AcWing 875. 快速幂">快速幂 —— 模板题 AcWing 875. 快速幂</a></li>
                    <li>
                        <a href="#%e6%89%a9%e5%b1%95%e6%ac%a7%e5%87%a0%e9%87%8c%e5%be%97%e7%ae%97%e6%b3%95--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-877-%e6%89%a9%e5%b1%95%e6%ac%a7%e5%87%a0%e9%87%8c%e5%be%97%e7%ae%97%e6%b3%95" aria-label="扩展欧几里得算法 —— 模板题 AcWing 877. 扩展欧几里得算法">扩展欧几里得算法 —— 模板题 AcWing 877. 扩展欧几里得算法</a></li>
                    <li>
                        <a href="#%e9%ab%98%e6%96%af%e6%b6%88%e5%85%83--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-883-%e9%ab%98%e6%96%af%e6%b6%88%e5%85%83%e8%a7%a3%e7%ba%bf%e6%80%a7%e6%96%b9%e7%a8%8b%e7%bb%84" aria-label="高斯消元 —— 模板题 AcWing 883. 高斯消元解线性方程组">高斯消元 —— 模板题 AcWing 883. 高斯消元解线性方程组</a></li>
                    <li>
                        <a href="#%e9%80%92%e5%bd%92%e6%b3%95%e6%b1%82%e7%bb%84%e5%90%88%e6%95%b0--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-885-%e6%b1%82%e7%bb%84%e5%90%88%e6%95%b0-i" aria-label="递归法求组合数 —— 模板题 AcWing 885. 求组合数 I">递归法求组合数 —— 模板题 <em>AcWing</em> 885. 求组合数 I</a></li>
                    <li>
                        <a href="#%e9%80%9a%e8%bf%87%e9%a2%84%e5%a4%84%e7%90%86%e9%80%86%e5%85%83%e7%9a%84%e6%96%b9%e5%bc%8f%e6%b1%82%e7%bb%84%e5%90%88%e6%95%b0--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-886-%e6%b1%82%e7%bb%84%e5%90%88%e6%95%b0-ii" aria-label="通过预处理逆元的方式求组合数 —— 模板题 AcWing 886. 求组合数 II">通过预处理逆元的方式求组合数 —— 模板题 AcWing 886. 求组合数 II</a></li>
                    <li>
                        <a href="#lucas%e5%ae%9a%e7%90%86--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-887-%e6%b1%82%e7%bb%84%e5%90%88%e6%95%b0-iii" aria-label="Lucas定理 —— 模板题 AcWing 887. 求组合数 III"><em>Lucas</em>定理 —— 模板题 AcWing 887. 求组合数 III</a></li>
                    <li>
                        <a href="#%e5%88%86%e8%a7%a3%e8%b4%a8%e5%9b%a0%e6%95%b0%e6%b3%95%e6%b1%82%e7%bb%84%e5%90%88%e6%95%b0--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-888-%e6%b1%82%e7%bb%84%e5%90%88%e6%95%b0-iv" aria-label="分解质因数法求组合数 —— 模板题 AcWing 888. 求组合数 IV">分解质因数法求组合数 —— 模板题 AcWing 888. 求组合数 IV</a></li>
                    <li>
                        <a href="#%e5%8d%a1%e7%89%b9%e5%85%b0%e6%95%b0--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-889-%e6%bb%a1%e8%b6%b3%e6%9d%a1%e4%bb%b6%e7%9a%8401%e5%ba%8f%e5%88%97" aria-label="卡特兰数 —— 模板题 AcWing 889. 满足条件的01序列">卡特兰数 —— 模板题 AcWing 889. 满足条件的01序列</a></li>
                    <li>
                        <a href="#%e5%ae%b9%e6%96%a5%e5%8e%9f%e7%90%86" aria-label="容斥原理">容斥原理</a></li>
                    <li>
                        <a href="#nim%e5%b0%bc%e5%a7%86%e6%b8%b8%e6%88%8f--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-891-nim%e6%b8%b8%e6%88%8f" aria-label="NIM(尼姆)游戏 —— 模板题 AcWing 891. Nim游戏">NIM(尼姆)游戏 —— 模板题 AcWing 891. Nim游戏</a></li>
                    <li>
                        <a href="#%e6%9c%89%e5%90%91%e5%9b%be%e6%b8%b8%e6%88%8f%e7%9a%84%e5%92%8c--%e6%a8%a1%e6%9d%bf%e9%a2%98-acwing-893-%e9%9b%86%e5%90%88-nim%e6%b8%b8%e6%88%8f" aria-label="有向图游戏的和 —— 模板题 AcWing 893. 集合-Nim游戏">有向图游戏的和 —— 模板题 AcWing 893. 集合-Nim游戏</a></li></ul>
                    </li>
                    <li>
                        <a href="#%e6%97%b6%e7%a9%ba%e5%a4%8d%e6%9d%82%e5%ba%a6%e5%88%86%e6%9e%90" aria-label="时空复杂度分析">时空复杂度分析</a></li></ul>
                    </li>
                    <li>
                        <a href="#%e5%8a%a8%e6%80%81%e8%a7%84%e5%88%92" aria-label="动态规划">动态规划</a><ul>
                            
                    <li>
                        <a href="#%e8%83%8c%e5%8c%85-%e4%b9%9d%e8%ae%b2" aria-label="背包 九讲">背包 九讲</a><ul>
                            
                    <li>
                        <a href="#01%e8%83%8c%e5%8c%85" aria-label="01背包">01背包</a></li>
                    <li>
                        <a href="#%e5%ae%8c%e5%85%a8%e8%83%8c%e5%8c%85" aria-label="完全背包">完全背包</a></li>
                    <li>
                        <a href="#%e5%a4%9a%e9%87%8d%e8%83%8c%e5%8c%85" aria-label="多重背包">多重背包</a><ul>
                            
                    <li>
                        <a href="#%e4%ba%8c%e8%bf%9b%e5%88%b6%e4%bc%98%e5%8c%96" aria-label="二进制优化">二进制优化</a></li>
                    <li>
                        <a href="#%e5%8d%95%e8%b0%83%e9%98%9f%e5%88%97%e4%bc%98%e5%8c%96" aria-label="单调队列优化">单调队列优化</a></li></ul>
                    </li>
                    <li>
                        <a href="#%e5%88%86%e7%bb%84%e8%83%8c%e5%8c%85" aria-label="分组背包">分组背包</a></li>
                    <li>
                        <a href="#%e6%b7%b7%e5%90%88%e8%83%8c%e5%8c%85" aria-label="混合背包">混合背包</a></li>
                    <li>
                        <a href="#%e4%ba%8c%e7%bb%b4%e8%b4%b9%e7%94%a8%e7%9a%84%e8%83%8c%e5%8c%85%e9%97%ae%e9%a2%98" aria-label="二维费用的背包问题">二维费用的背包问题</a></li></ul>
                    </li>
                    <li>
                        <a href="#%e7%ba%bf%e6%80%a7dp" aria-label="线性dp">线性dp</a><ul>
                            <ul>
                            
                    <li>
                        <a href="#%e6%95%b0%e5%ad%97%e4%b8%89%e8%a7%92%e5%bd%a2" aria-label="数字三角形">数字三角形</a></li>
                    <li>
                        <a href="#lis" aria-label="LIS">LIS</a></li>
                    <li>
                        <a href="#lcs" aria-label="LCS">LCS</a></li></ul>
                        
                    <li>
                        <a href="#%e5%8c%ba%e9%97%b4dp" aria-label="区间dp">区间dp</a><ul>
                            
                    <li>
                        <a href="#%e7%9f%b3%e5%ad%90%e5%90%88%e5%b9%b6" aria-label="石子合并">石子合并</a></li></ul>
                    </li></ul>
                    </li>
                    <li>
                        <a href="#%e6%95%b0%e4%bd%8d%e7%bb%9f%e8%ae%a1dp" aria-label="数位统计dp">数位统计dp</a></li>
                    <li>
                        <a href="#%e7%8a%b6%e6%80%81%e5%8e%8b%e7%bc%a9-dp" aria-label="状态压缩 dp">状态压缩 dp</a></li>
                    <li>
                        <a href="#%e6%a0%91%e5%bd%a2dp" aria-label="树形dp">树形dp</a><ul>
                            
                    <li>
                        <a href="#%e8%ae%b0%e5%bf%86%e5%8c%96" aria-label="记忆化">记忆化</a></li></ul>
                    </li></ul>
                    </li>
                    <li>
                        <a href="#%e4%b9%a0%e9%a2%98%e8%af%be" aria-label="习题课">习题课</a>
                    </li>
                </ul>
            </div>
        </details>
    </div>
</aside>
<script>
    let activeElement;
    let elements;
    window.addEventListener('DOMContentLoaded', function (event) {
        checkTocPosition();

        elements = document.querySelectorAll('h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]');
         
         activeElement = elements[0];
         const id = encodeURI(activeElement.getAttribute('id')).toLowerCase();
         document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
     }, false);

    window.addEventListener('resize', function(event) {
        checkTocPosition();
    }, false);

    window.addEventListener('scroll', () => {
        
        activeElement = Array.from(elements).find((element) => {
            if ((getOffsetTop(element) - window.pageYOffset) > 0 && 
                (getOffsetTop(element) - window.pageYOffset) < window.innerHeight/2) {
                return element;
            }
        }) || activeElement

        elements.forEach(element => {
             const id = encodeURI(element.getAttribute('id')).toLowerCase();
             if (element === activeElement){
                 document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
             } else {
                 document.querySelector(`.inner ul li a[href="#${id}"]`).classList.remove('active');
             }
         })
     }, false);

    const main = parseInt(getComputedStyle(document.body).getPropertyValue('--article-width'), 10);
    const toc = parseInt(getComputedStyle(document.body).getPropertyValue('--toc-width'), 10);
    const gap = parseInt(getComputedStyle(document.body).getPropertyValue('--gap'), 10);

    function checkTocPosition() {
        const width = document.body.scrollWidth;

        if (width - main - (toc * 2) - (gap * 4) > 0) {
            document.getElementById("toc-container").classList.add("wide");
        } else {
            document.getElementById("toc-container").classList.remove("wide");
        }
    }

    function getOffsetTop(element) {
        if (!element.getClientRects().length) {
            return 0;
        }
        let rect = element.getBoundingClientRect();
        let win = element.ownerDocument.defaultView;
        return rect.top + win.pageYOffset;   
    }
</script>

  <div class="post-content"><h1 id="acwing算法学习">Acwing算法学习<a hidden class="anchor" aria-hidden="true" href="#acwing算法学习">#</a></h1>
<p>[TOC]</p>
<h2 id="第一章">第一章<a hidden class="anchor" aria-hidden="true" href="#第一章">#</a></h2>
<p>课上：学思想</p>
<p>课下：背代码</p>
<p>题目，一道题写好几遍</p>
<p>理解没有任何意义，体力活+脑力活</p>
<p><strong>记忆力 毅力/自制力</strong></p>
<p>沉下心背东西</p>
<h3 id="快速排序算法模板--模板题-acwing-785-快速排序">快速排序算法模板 —— 模板题 AcWing 785. 快速排序<a hidden class="anchor" aria-hidden="true" href="#快速排序算法模板--模板题-acwing-785-快速排序">#</a></h3>
<p><strong>分治</strong></p>
<p>1、确定分界点，l、r、（l+r)/2 随机</p>
<p>2、调整区间，分为两边，左边小于等于x,右边大于等于x</p>
<p>3、递归处理左右两段</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-0-1"><a class="lnlinks" href="#hl-0-1"> 1</a>
</span><span class="lnt" id="hl-0-2"><a class="lnlinks" href="#hl-0-2"> 2</a>
</span><span class="lnt" id="hl-0-3"><a class="lnlinks" href="#hl-0-3"> 3</a>
</span><span class="lnt" id="hl-0-4"><a class="lnlinks" href="#hl-0-4"> 4</a>
</span><span class="lnt" id="hl-0-5"><a class="lnlinks" href="#hl-0-5"> 5</a>
</span><span class="lnt" id="hl-0-6"><a class="lnlinks" href="#hl-0-6"> 6</a>
</span><span class="lnt" id="hl-0-7"><a class="lnlinks" href="#hl-0-7"> 7</a>
</span><span class="lnt" id="hl-0-8"><a class="lnlinks" href="#hl-0-8"> 8</a>
</span><span class="lnt" id="hl-0-9"><a class="lnlinks" href="#hl-0-9"> 9</a>
</span><span class="lnt" id="hl-0-10"><a class="lnlinks" href="#hl-0-10">10</a>
</span><span class="lnt" id="hl-0-11"><a class="lnlinks" href="#hl-0-11">11</a>
</span><span class="lnt" id="hl-0-12"><a class="lnlinks" href="#hl-0-12">12</a>
</span><span class="lnt" id="hl-0-13"><a class="lnlinks" href="#hl-0-13">13</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">quick_sort</span><span class="p">(</span><span class="kt">int</span> <span class="n">q</span><span class="p">[],</span> <span class="kt">int</span> <span class="n">l</span><span class="p">,</span> <span class="kt">int</span> <span class="n">r</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">l</span> <span class="o">&gt;=</span> <span class="n">r</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">l</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">r</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">q</span><span class="p">[</span><span class="n">l</span> <span class="o">+</span> <span class="n">r</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">j</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">do</span> <span class="n">i</span> <span class="o">++</span> <span class="p">;</span> <span class="k">while</span> <span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">x</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">do</span> <span class="n">j</span> <span class="o">--</span> <span class="p">;</span> <span class="k">while</span> <span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">x</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">j</span><span class="p">)</span> <span class="n">swap</span><span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">q</span><span class="p">[</span><span class="n">j</span><span class="p">]);</span> 
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">quick_sort</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">j</span><span class="p">),</span> <span class="n">quick_sort</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">r</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="o">-</span><span class="n">std</span><span class="o">=</span><span class="n">c</span><span class="o">++</span><span class="mi">11</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="归并排序算法模板--模板题-acwing-787-归并排序">归并排序算法模板 —— 模板题 AcWing 787. 归并排序<a hidden class="anchor" aria-hidden="true" href="#归并排序算法模板--模板题-acwing-787-归并排序">#</a></h3>
<p>排序稳定：序列中相同的值排序后的相对位置是否发生改变</p>
<p>时间复杂度有 （nlogn)</p>
<p>1）确定分界点mid</p>
<p>2）递归排序两边</p>
<p>2）归并，合并为一个有序数组</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-1-1"><a class="lnlinks" href="#hl-1-1"> 1</a>
</span><span class="lnt" id="hl-1-2"><a class="lnlinks" href="#hl-1-2"> 2</a>
</span><span class="lnt" id="hl-1-3"><a class="lnlinks" href="#hl-1-3"> 3</a>
</span><span class="lnt" id="hl-1-4"><a class="lnlinks" href="#hl-1-4"> 4</a>
</span><span class="lnt" id="hl-1-5"><a class="lnlinks" href="#hl-1-5"> 5</a>
</span><span class="lnt" id="hl-1-6"><a class="lnlinks" href="#hl-1-6"> 6</a>
</span><span class="lnt" id="hl-1-7"><a class="lnlinks" href="#hl-1-7"> 7</a>
</span><span class="lnt" id="hl-1-8"><a class="lnlinks" href="#hl-1-8"> 8</a>
</span><span class="lnt" id="hl-1-9"><a class="lnlinks" href="#hl-1-9"> 9</a>
</span><span class="lnt" id="hl-1-10"><a class="lnlinks" href="#hl-1-10">10</a>
</span><span class="lnt" id="hl-1-11"><a class="lnlinks" href="#hl-1-11">11</a>
</span><span class="lnt" id="hl-1-12"><a class="lnlinks" href="#hl-1-12">12</a>
</span><span class="lnt" id="hl-1-13"><a class="lnlinks" href="#hl-1-13">13</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">merge_sort</span><span class="p">(</span><span class="kt">int</span> <span class="n">q</span><span class="p">[],</span> <span class="kt">int</span> <span class="n">l</span><span class="p">,</span> <span class="kt">int</span> <span class="n">r</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">l</span> <span class="o">&gt;=</span> <span class="n">r</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">mid</span> <span class="o">=</span> <span class="n">l</span> <span class="o">+</span> <span class="n">r</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">merge_sort</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">mid</span><span class="p">);</span> <span class="n">merge_sort</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">r</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">i</span> <span class="o">=</span> <span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;=</span> <span class="n">mid</span> <span class="o">&amp;&amp;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">r</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">q</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="n">tmp</span><span class="p">[</span><span class="n">k</span> <span class="o">++</span> <span class="p">]</span> <span class="o">=</span> <span class="n">q</span><span class="p">[</span><span class="n">i</span> <span class="o">++</span> <span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span> <span class="n">tmp</span><span class="p">[</span><span class="n">k</span> <span class="o">++</span> <span class="p">]</span> <span class="o">=</span> <span class="n">q</span><span class="p">[</span><span class="n">j</span> <span class="o">++</span> <span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;=</span> <span class="n">mid</span><span class="p">)</span> <span class="n">tmp</span><span class="p">[</span><span class="n">k</span> <span class="o">++</span> <span class="p">]</span> <span class="o">=</span> <span class="n">q</span><span class="p">[</span><span class="n">i</span> <span class="o">++</span> <span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">j</span> <span class="o">&lt;=</span> <span class="n">r</span><span class="p">)</span> <span class="n">tmp</span><span class="p">[</span><span class="n">k</span> <span class="o">++</span> <span class="p">]</span> <span class="o">=</span> <span class="n">q</span><span class="p">[</span><span class="n">j</span> <span class="o">++</span> <span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">r</span><span class="p">;</span> <span class="n">i</span> <span class="o">++</span><span class="p">,</span> <span class="n">j</span> <span class="o">++</span> <span class="p">)</span> <span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="整数二分算法模板--模板题-acwing-789-数的范围">整数二分算法模板 —— 模板题 AcWing 789. 数的范围<a hidden class="anchor" aria-hidden="true" href="#整数二分算法模板--模板题-acwing-789-数的范围">#</a></h3>
<p>边界问题</p>
<p>本质：区间内一半满足一半不满足</p>
<p>l=mid时加一</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-2-1"><a class="lnlinks" href="#hl-2-1"> 1</a>
</span><span class="lnt" id="hl-2-2"><a class="lnlinks" href="#hl-2-2"> 2</a>
</span><span class="lnt" id="hl-2-3"><a class="lnlinks" href="#hl-2-3"> 3</a>
</span><span class="lnt" id="hl-2-4"><a class="lnlinks" href="#hl-2-4"> 4</a>
</span><span class="lnt" id="hl-2-5"><a class="lnlinks" href="#hl-2-5"> 5</a>
</span><span class="lnt" id="hl-2-6"><a class="lnlinks" href="#hl-2-6"> 6</a>
</span><span class="lnt" id="hl-2-7"><a class="lnlinks" href="#hl-2-7"> 7</a>
</span><span class="lnt" id="hl-2-8"><a class="lnlinks" href="#hl-2-8"> 8</a>
</span><span class="lnt" id="hl-2-9"><a class="lnlinks" href="#hl-2-9"> 9</a>
</span><span class="lnt" id="hl-2-10"><a class="lnlinks" href="#hl-2-10">10</a>
</span><span class="lnt" id="hl-2-11"><a class="lnlinks" href="#hl-2-11">11</a>
</span><span class="lnt" id="hl-2-12"><a class="lnlinks" href="#hl-2-12">12</a>
</span><span class="lnt" id="hl-2-13"><a class="lnlinks" href="#hl-2-13">13</a>
</span><span class="lnt" id="hl-2-14"><a class="lnlinks" href="#hl-2-14">14</a>
</span><span class="lnt" id="hl-2-15"><a class="lnlinks" href="#hl-2-15">15</a>
</span><span class="lnt" id="hl-2-16"><a class="lnlinks" href="#hl-2-16">16</a>
</span><span class="lnt" id="hl-2-17"><a class="lnlinks" href="#hl-2-17">17</a>
</span><span class="lnt" id="hl-2-18"><a class="lnlinks" href="#hl-2-18">18</a>
</span><span class="lnt" id="hl-2-19"><a class="lnlinks" href="#hl-2-19">19</a>
</span><span class="lnt" id="hl-2-20"><a class="lnlinks" href="#hl-2-20">20</a>
</span><span class="lnt" id="hl-2-21"><a class="lnlinks" href="#hl-2-21">21</a>
</span><span class="lnt" id="hl-2-22"><a class="lnlinks" href="#hl-2-22">22</a>
</span><span class="lnt" id="hl-2-23"><a class="lnlinks" href="#hl-2-23">23</a>
</span><span class="lnt" id="hl-2-24"><a class="lnlinks" href="#hl-2-24">24</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">bool</span> <span class="nf">check</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span><span class="cm">/* ... */</span><span class="p">}</span> <span class="c1">// 检查x是否满足某种性质
</span></span></span><span class="line"><span class="cl"><span class="c1">// 区间[l, r]被划分成[l, mid]和[mid + 1, r]时使用：
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="nf">bsearch_1</span><span class="p">(</span><span class="kt">int</span> <span class="n">l</span><span class="p">,</span> <span class="kt">int</span> <span class="n">r</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">l</span> <span class="o">&lt;</span> <span class="n">r</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">mid</span> <span class="o">=</span> <span class="n">l</span> <span class="o">+</span> <span class="n">r</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">check</span><span class="p">(</span><span class="n">mid</span><span class="p">))</span> <span class="n">r</span> <span class="o">=</span> <span class="n">mid</span><span class="p">;</span>    <span class="c1">// check()判断mid是否满足性质
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">else</span> <span class="n">l</span> <span class="o">=</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">l</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 区间[l, r]被划分成[l, mid - 1]和[mid, r]时使用：
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="nf">bsearch_2</span><span class="p">(</span><span class="kt">int</span> <span class="n">l</span><span class="p">,</span> <span class="kt">int</span> <span class="n">r</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">l</span> <span class="o">&lt;</span> <span class="n">r</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">mid</span> <span class="o">=</span> <span class="n">l</span> <span class="o">+</span> <span class="n">r</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">check</span><span class="p">(</span><span class="n">mid</span><span class="p">))</span> <span class="n">l</span> <span class="o">=</span> <span class="n">mid</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span> <span class="n">r</span> <span class="o">=</span> <span class="n">mid</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">l</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="浮点数二分算法模板--模板题-acwing-790-数的三次方根">浮点数二分算法模板 —— 模板题 AcWing 790. 数的三次方根<a hidden class="anchor" aria-hidden="true" href="#浮点数二分算法模板--模板题-acwing-790-数的三次方根">#</a></h3>
<p>浮点数二分，比较对应整数二分</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-3-1"><a class="lnlinks" href="#hl-3-1"> 1</a>
</span><span class="lnt" id="hl-3-2"><a class="lnlinks" href="#hl-3-2"> 2</a>
</span><span class="lnt" id="hl-3-3"><a class="lnlinks" href="#hl-3-3"> 3</a>
</span><span class="lnt" id="hl-3-4"><a class="lnlinks" href="#hl-3-4"> 4</a>
</span><span class="lnt" id="hl-3-5"><a class="lnlinks" href="#hl-3-5"> 5</a>
</span><span class="lnt" id="hl-3-6"><a class="lnlinks" href="#hl-3-6"> 6</a>
</span><span class="lnt" id="hl-3-7"><a class="lnlinks" href="#hl-3-7"> 7</a>
</span><span class="lnt" id="hl-3-8"><a class="lnlinks" href="#hl-3-8"> 8</a>
</span><span class="lnt" id="hl-3-9"><a class="lnlinks" href="#hl-3-9"> 9</a>
</span><span class="lnt" id="hl-3-10"><a class="lnlinks" href="#hl-3-10">10</a>
</span><span class="lnt" id="hl-3-11"><a class="lnlinks" href="#hl-3-11">11</a>
</span><span class="lnt" id="hl-3-12"><a class="lnlinks" href="#hl-3-12">12</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">bool</span> <span class="nf">check</span><span class="p">(</span><span class="kt">double</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span><span class="cm">/* ... */</span><span class="p">}</span> <span class="c1">// 检查x是否满足某种性质
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">double</span> <span class="nf">bsearch_3</span><span class="p">(</span><span class="kt">double</span> <span class="n">l</span><span class="p">,</span> <span class="kt">double</span> <span class="n">r</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">const</span> <span class="kt">double</span> <span class="n">eps</span> <span class="o">=</span> <span class="mf">1e-6</span><span class="p">;</span>   <span class="c1">// eps 表示精度，取决于题目对精度的要求
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">while</span> <span class="p">(</span><span class="n">r</span> <span class="o">-</span> <span class="n">l</span> <span class="o">&gt;</span> <span class="n">eps</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kt">double</span> <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="n">r</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">check</span><span class="p">(</span><span class="n">mid</span><span class="p">))</span> <span class="n">r</span> <span class="o">=</span> <span class="n">mid</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span> <span class="n">l</span> <span class="o">=</span> <span class="n">mid</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">l</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="高精度加法--模板题-acwing-791-高精度加法">高精度加法 —— 模板题 AcWing 791. 高精度加法<a hidden class="anchor" aria-hidden="true" href="#高精度加法--模板题-acwing-791-高精度加法">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-4-1"><a class="lnlinks" href="#hl-4-1"> 1</a>
</span><span class="lnt" id="hl-4-2"><a class="lnlinks" href="#hl-4-2"> 2</a>
</span><span class="lnt" id="hl-4-3"><a class="lnlinks" href="#hl-4-3"> 3</a>
</span><span class="lnt" id="hl-4-4"><a class="lnlinks" href="#hl-4-4"> 4</a>
</span><span class="lnt" id="hl-4-5"><a class="lnlinks" href="#hl-4-5"> 5</a>
</span><span class="lnt" id="hl-4-6"><a class="lnlinks" href="#hl-4-6"> 6</a>
</span><span class="lnt" id="hl-4-7"><a class="lnlinks" href="#hl-4-7"> 7</a>
</span><span class="lnt" id="hl-4-8"><a class="lnlinks" href="#hl-4-8"> 8</a>
</span><span class="lnt" id="hl-4-9"><a class="lnlinks" href="#hl-4-9"> 9</a>
</span><span class="lnt" id="hl-4-10"><a class="lnlinks" href="#hl-4-10">10</a>
</span><span class="lnt" id="hl-4-11"><a class="lnlinks" href="#hl-4-11">11</a>
</span><span class="lnt" id="hl-4-12"><a class="lnlinks" href="#hl-4-12">12</a>
</span><span class="lnt" id="hl-4-13"><a class="lnlinks" href="#hl-4-13">13</a>
</span><span class="lnt" id="hl-4-14"><a class="lnlinks" href="#hl-4-14">14</a>
</span><span class="lnt" id="hl-4-15"><a class="lnlinks" href="#hl-4-15">15</a>
</span><span class="lnt" id="hl-4-16"><a class="lnlinks" href="#hl-4-16">16</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="c1">// C = A + B, A &gt;= 0, B &gt;= 0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">add</span><span class="p">(</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">A</span><span class="p">,</span> <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">B</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">A</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">B</span><span class="p">.</span><span class="n">size</span><span class="p">())</span> <span class="k">return</span> <span class="n">add</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">A</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">C</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">t</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">A</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="n">i</span> <span class="o">++</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">t</span> <span class="o">+=</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">B</span><span class="p">.</span><span class="n">size</span><span class="p">())</span> <span class="n">t</span> <span class="o">+=</span> <span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="n">C</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">t</span> <span class="o">%</span> <span class="mi">10</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">t</span> <span class="o">/=</span> <span class="mi">10</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="n">C</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">t</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">C</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="高精度减法--模板题-acwing-792-高精度减法">高精度减法 —— 模板题 AcWing 792. 高精度减法<a hidden class="anchor" aria-hidden="true" href="#高精度减法--模板题-acwing-792-高精度减法">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-5-1"><a class="lnlinks" href="#hl-5-1"> 1</a>
</span><span class="lnt" id="hl-5-2"><a class="lnlinks" href="#hl-5-2"> 2</a>
</span><span class="lnt" id="hl-5-3"><a class="lnlinks" href="#hl-5-3"> 3</a>
</span><span class="lnt" id="hl-5-4"><a class="lnlinks" href="#hl-5-4"> 4</a>
</span><span class="lnt" id="hl-5-5"><a class="lnlinks" href="#hl-5-5"> 5</a>
</span><span class="lnt" id="hl-5-6"><a class="lnlinks" href="#hl-5-6"> 6</a>
</span><span class="lnt" id="hl-5-7"><a class="lnlinks" href="#hl-5-7"> 7</a>
</span><span class="lnt" id="hl-5-8"><a class="lnlinks" href="#hl-5-8"> 8</a>
</span><span class="lnt" id="hl-5-9"><a class="lnlinks" href="#hl-5-9"> 9</a>
</span><span class="lnt" id="hl-5-10"><a class="lnlinks" href="#hl-5-10">10</a>
</span><span class="lnt" id="hl-5-11"><a class="lnlinks" href="#hl-5-11">11</a>
</span><span class="lnt" id="hl-5-12"><a class="lnlinks" href="#hl-5-12">12</a>
</span><span class="lnt" id="hl-5-13"><a class="lnlinks" href="#hl-5-13">13</a>
</span><span class="lnt" id="hl-5-14"><a class="lnlinks" href="#hl-5-14">14</a>
</span><span class="lnt" id="hl-5-15"><a class="lnlinks" href="#hl-5-15">15</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="c1">// C = A - B, 满足A &gt;= B, A &gt;= 0, B &gt;= 0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">sub</span><span class="p">(</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">A</span><span class="p">,</span> <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">B</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">C</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">A</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="n">i</span> <span class="o">++</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">t</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">t</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">B</span><span class="p">.</span><span class="n">size</span><span class="p">())</span> <span class="n">t</span> <span class="o">-=</span> <span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="n">C</span><span class="p">.</span><span class="n">push_back</span><span class="p">((</span><span class="n">t</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span> <span class="o">%</span> <span class="mi">10</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">t</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">t</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span> <span class="n">t</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">C</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="n">C</span><span class="p">.</span><span class="n">back</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">C</span><span class="p">.</span><span class="n">pop_back</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">C</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="高精度乘低精度--模板题-acwing-793-高精度乘法">高精度乘低精度 —— 模板题 AcWing 793. 高精度乘法<a hidden class="anchor" aria-hidden="true" href="#高精度乘低精度--模板题-acwing-793-高精度乘法">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-6-1"><a class="lnlinks" href="#hl-6-1"> 1</a>
</span><span class="lnt" id="hl-6-2"><a class="lnlinks" href="#hl-6-2"> 2</a>
</span><span class="lnt" id="hl-6-3"><a class="lnlinks" href="#hl-6-3"> 3</a>
</span><span class="lnt" id="hl-6-4"><a class="lnlinks" href="#hl-6-4"> 4</a>
</span><span class="lnt" id="hl-6-5"><a class="lnlinks" href="#hl-6-5"> 5</a>
</span><span class="lnt" id="hl-6-6"><a class="lnlinks" href="#hl-6-6"> 6</a>
</span><span class="lnt" id="hl-6-7"><a class="lnlinks" href="#hl-6-7"> 7</a>
</span><span class="lnt" id="hl-6-8"><a class="lnlinks" href="#hl-6-8"> 8</a>
</span><span class="lnt" id="hl-6-9"><a class="lnlinks" href="#hl-6-9"> 9</a>
</span><span class="lnt" id="hl-6-10"><a class="lnlinks" href="#hl-6-10">10</a>
</span><span class="lnt" id="hl-6-11"><a class="lnlinks" href="#hl-6-11">11</a>
</span><span class="lnt" id="hl-6-12"><a class="lnlinks" href="#hl-6-12">12</a>
</span><span class="lnt" id="hl-6-13"><a class="lnlinks" href="#hl-6-13">13</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="c1">// C = A * b, A &gt;= 0, b &gt; 0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">mul</span><span class="p">(</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">A</span><span class="p">,</span> <span class="kt">int</span> <span class="n">b</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">C</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">t</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">A</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">||</span> <span class="n">t</span><span class="p">;</span> <span class="n">i</span> <span class="o">++</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">A</span><span class="p">.</span><span class="n">size</span><span class="p">())</span> <span class="n">t</span> <span class="o">+=</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">C</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">t</span> <span class="o">%</span> <span class="mi">10</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">t</span> <span class="o">/=</span> <span class="mi">10</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">C</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="高精度除以低精度--模板题-acwing-794-高精度除法">高精度除以低精度 —— 模板题 AcWing 794. 高精度除法<a hidden class="anchor" aria-hidden="true" href="#高精度除以低精度--模板题-acwing-794-高精度除法">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-7-1"><a class="lnlinks" href="#hl-7-1"> 1</a>
</span><span class="lnt" id="hl-7-2"><a class="lnlinks" href="#hl-7-2"> 2</a>
</span><span class="lnt" id="hl-7-3"><a class="lnlinks" href="#hl-7-3"> 3</a>
</span><span class="lnt" id="hl-7-4"><a class="lnlinks" href="#hl-7-4"> 4</a>
</span><span class="lnt" id="hl-7-5"><a class="lnlinks" href="#hl-7-5"> 5</a>
</span><span class="lnt" id="hl-7-6"><a class="lnlinks" href="#hl-7-6"> 6</a>
</span><span class="lnt" id="hl-7-7"><a class="lnlinks" href="#hl-7-7"> 7</a>
</span><span class="lnt" id="hl-7-8"><a class="lnlinks" href="#hl-7-8"> 8</a>
</span><span class="lnt" id="hl-7-9"><a class="lnlinks" href="#hl-7-9"> 9</a>
</span><span class="lnt" id="hl-7-10"><a class="lnlinks" href="#hl-7-10">10</a>
</span><span class="lnt" id="hl-7-11"><a class="lnlinks" href="#hl-7-11">11</a>
</span><span class="lnt" id="hl-7-12"><a class="lnlinks" href="#hl-7-12">12</a>
</span><span class="lnt" id="hl-7-13"><a class="lnlinks" href="#hl-7-13">13</a>
</span><span class="lnt" id="hl-7-14"><a class="lnlinks" href="#hl-7-14">14</a>
</span><span class="lnt" id="hl-7-15"><a class="lnlinks" href="#hl-7-15">15</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="c1">// A / b = C ... r, A &gt;= 0, b &gt; 0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">div</span><span class="p">(</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">A</span><span class="p">,</span> <span class="kt">int</span> <span class="n">b</span><span class="p">,</span> <span class="kt">int</span> <span class="o">&amp;</span><span class="n">r</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">C</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">r</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">A</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">--</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">r</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">+</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="n">C</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">r</span> <span class="o">/</span> <span class="n">b</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">r</span> <span class="o">%=</span> <span class="n">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">reverse</span><span class="p">(</span><span class="n">C</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span> <span class="n">C</span><span class="p">.</span><span class="n">end</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">C</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="n">C</span><span class="p">.</span><span class="n">back</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">C</span><span class="p">.</span><span class="n">pop_back</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">C</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="一维前缀和--模板题-acwing-795-前缀和">一维前缀和 —— 模板题 AcWing 795. 前缀和<a hidden class="anchor" aria-hidden="true" href="#一维前缀和--模板题-acwing-795-前缀和">#</a></h3>
<p>快速求区间和</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-8-1"><a class="lnlinks" href="#hl-8-1">1</a>
</span><span class="lnt" id="hl-8-2"><a class="lnlinks" href="#hl-8-2">2</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="p">...</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">a</span><span class="p">[</span><span class="n">l</span><span class="p">]</span> <span class="o">+</span> <span class="p">...</span> <span class="o">+</span> <span class="n">a</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">=</span> <span class="n">S</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">-</span> <span class="n">S</span><span class="p">[</span><span class="n">l</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="err">从</span><span class="mi">1</span><span class="err">开始，便于处理边界</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="二维前缀和--模板题-acwing-796-子矩阵的和">二维前缀和 —— 模板题 AcWing 796. 子矩阵的和<a hidden class="anchor" aria-hidden="true" href="#二维前缀和--模板题-acwing-796-子矩阵的和">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-9-1"><a class="lnlinks" href="#hl-9-1">1</a>
</span><span class="lnt" id="hl-9-2"><a class="lnlinks" href="#hl-9-2">2</a>
</span><span class="lnt" id="hl-9-3"><a class="lnlinks" href="#hl-9-3">3</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="err">第</span><span class="n">i行j列格子左上部分所有元素的和</span>
</span></span><span class="line"><span class="cl"><span class="err">以</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">)</span><span class="err">为左上角，</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">)</span><span class="err">为右下角的子矩阵的和为：</span>
</span></span><span class="line"><span class="cl"><span class="n">S</span><span class="p">[</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">]</span> <span class="o">-</span> <span class="n">S</span><span class="p">[</span><span class="n">x1</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">y2</span><span class="p">]</span> <span class="o">-</span> <span class="n">S</span><span class="p">[</span><span class="n">x2</span><span class="p">,</span> <span class="n">y1</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">S</span><span class="p">[</span><span class="n">x1</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="一维差分--模板题-acwing-797-差分">一维差分 —— 模板题 AcWing 797. 差分<a hidden class="anchor" aria-hidden="true" href="#一维差分--模板题-acwing-797-差分">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-10-1"><a class="lnlinks" href="#hl-10-1">1</a>
</span><span class="lnt" id="hl-10-2"><a class="lnlinks" href="#hl-10-2">2</a>
</span><span class="lnt" id="hl-10-3"><a class="lnlinks" href="#hl-10-3">3</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="err">给区间</span><span class="p">[</span><span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">]</span><span class="err">中的每个数加上</span><span class="n">c</span><span class="err">：</span>
</span></span><span class="line"><span class="cl"><span class="n">B</span><span class="p">[</span><span class="n">l</span><span class="p">]</span> <span class="o">+=</span> <span class="n">c</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl"><span class="n">B</span><span class="p">[</span><span class="n">r</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-=</span> <span class="n">c</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="二维差分--模板题-acwing-798-差分矩阵二维差分">二维差分 —— 模板题 AcWing 798. 差分矩阵/二维差分<a hidden class="anchor" aria-hidden="true" href="#二维差分--模板题-acwing-798-差分矩阵二维差分">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-11-1"><a class="lnlinks" href="#hl-11-1">1</a>
</span><span class="lnt" id="hl-11-2"><a class="lnlinks" href="#hl-11-2">2</a>
</span><span class="lnt" id="hl-11-3"><a class="lnlinks" href="#hl-11-3">3</a>
</span><span class="lnt" id="hl-11-4"><a class="lnlinks" href="#hl-11-4">4</a>
</span><span class="lnt" id="hl-11-5"><a class="lnlinks" href="#hl-11-5">5</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="err">给以</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">)</span><span class="err">为左上角，</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">)</span><span class="err">为右下角的子矩阵中的所有元素加上</span><span class="n">c</span><span class="err">：</span>
</span></span><span class="line"><span class="cl"><span class="n">S</span><span class="p">[</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">c</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl"><span class="n">S</span><span class="p">[</span><span class="n">x2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">y1</span><span class="p">]</span> <span class="o">-=</span> <span class="n">c</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl"><span class="n">S</span><span class="p">[</span><span class="n">x1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-=</span> <span class="n">c</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl"><span class="n">S</span><span class="p">[</span><span class="n">x2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">c</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="双指针算法--模板题-acwing-799-最长连续不重复子序列-acwing-800-数组元素的目标和-__滑动窗口">双指针算法 —— 模板题 AcWIng 799. 最长连续不重复子序列, AcWing 800. 数组元素的目标和 __滑动窗口？<a hidden class="anchor" aria-hidden="true" href="#双指针算法--模板题-acwing-799-最长连续不重复子序列-acwing-800-数组元素的目标和-__滑动窗口">#</a></h3>
<p>核心：把O(n^2)算法优化为O(n)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-12-1"><a class="lnlinks" href="#hl-12-1">1</a>
</span><span class="lnt" id="hl-12-2"><a class="lnlinks" href="#hl-12-2">2</a>
</span><span class="lnt" id="hl-12-3"><a class="lnlinks" href="#hl-12-3">3</a>
</span><span class="lnt" id="hl-12-4"><a class="lnlinks" href="#hl-12-4">4</a>
</span><span class="lnt" id="hl-12-5"><a class="lnlinks" href="#hl-12-5">5</a>
</span><span class="lnt" id="hl-12-6"><a class="lnlinks" href="#hl-12-6">6</a>
</span><span class="lnt" id="hl-12-7"><a class="lnlinks" href="#hl-12-7">7</a>
</span><span class="lnt" id="hl-12-8"><a class="lnlinks" href="#hl-12-8">8</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span> <span class="o">++</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">j</span> <span class="o">&lt;</span> <span class="n">i</span> <span class="o">&amp;&amp;</span> <span class="n">check</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span> <span class="n">j</span> <span class="o">++</span> <span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 具体问题的逻辑
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="err">常见问题分类：</span> 
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="err">对于一个序列，用两个指针维护一段区间</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="err">对于两个序列，维护某种次序，比如归并排序中合并两个有序序列的操作</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="位运算--模板题-acwing-801-二进制中1的个数">位运算 —— 模板题 AcWing 801. 二进制中1的个数<a hidden class="anchor" aria-hidden="true" href="#位运算--模板题-acwing-801-二进制中1的个数">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-13-1"><a class="lnlinks" href="#hl-13-1">1</a>
</span><span class="lnt" id="hl-13-2"><a class="lnlinks" href="#hl-13-2">2</a>
</span><span class="lnt" id="hl-13-3"><a class="lnlinks" href="#hl-13-3">3</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="err">原码，反码，补码</span>
</span></span><span class="line"><span class="cl"><span class="err">求</span><span class="nl">n二进制表示中第k位数字</span><span class="p">:</span> <span class="n">n</span> <span class="o">&gt;&gt;</span> <span class="n">k</span> <span class="o">&amp;</span> <span class="mi">1</span> 
</span></span><span class="line"><span class="cl"><span class="err">返回</span><span class="n">n的最后一位1</span><span class="err">：</span><span class="n">lowbit</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="n">n</span> <span class="o">&amp;</span> <span class="o">-</span><span class="n">n</span> <span class="err">树状数组基本操作</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="整数离散化--模板题-acwing-802-区间和">整数离散化 —— 模板题 AcWing 802. 区间和<a hidden class="anchor" aria-hidden="true" href="#整数离散化--模板题-acwing-802-区间和">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-14-1"><a class="lnlinks" href="#hl-14-1"> 1</a>
</span><span class="lnt" id="hl-14-2"><a class="lnlinks" href="#hl-14-2"> 2</a>
</span><span class="lnt" id="hl-14-3"><a class="lnlinks" href="#hl-14-3"> 3</a>
</span><span class="lnt" id="hl-14-4"><a class="lnlinks" href="#hl-14-4"> 4</a>
</span><span class="lnt" id="hl-14-5"><a class="lnlinks" href="#hl-14-5"> 5</a>
</span><span class="lnt" id="hl-14-6"><a class="lnlinks" href="#hl-14-6"> 6</a>
</span><span class="lnt" id="hl-14-7"><a class="lnlinks" href="#hl-14-7"> 7</a>
</span><span class="lnt" id="hl-14-8"><a class="lnlinks" href="#hl-14-8"> 8</a>
</span><span class="lnt" id="hl-14-9"><a class="lnlinks" href="#hl-14-9"> 9</a>
</span><span class="lnt" id="hl-14-10"><a class="lnlinks" href="#hl-14-10">10</a>
</span><span class="lnt" id="hl-14-11"><a class="lnlinks" href="#hl-14-11">11</a>
</span><span class="lnt" id="hl-14-12"><a class="lnlinks" href="#hl-14-12">12</a>
</span><span class="lnt" id="hl-14-13"><a class="lnlinks" href="#hl-14-13">13</a>
</span><span class="lnt" id="hl-14-14"><a class="lnlinks" href="#hl-14-14">14</a>
</span><span class="lnt" id="hl-14-15"><a class="lnlinks" href="#hl-14-15">15</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">alls</span><span class="p">;</span> <span class="c1">// 存储所有待离散化的值
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">sort</span><span class="p">(</span><span class="n">alls</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span> <span class="n">alls</span><span class="p">.</span><span class="n">end</span><span class="p">());</span> <span class="c1">// 将所有值排序
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">alls</span><span class="p">.</span><span class="n">erase</span><span class="p">(</span><span class="n">unique</span><span class="p">(</span><span class="n">alls</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span> <span class="n">alls</span><span class="p">.</span><span class="n">end</span><span class="p">())</span><span class="err">返回去重后数组末尾端点</span><span class="p">,</span> <span class="n">alls</span><span class="p">.</span><span class="n">end</span><span class="p">());</span>   <span class="c1">// 去掉重复元素
</span></span></span><span class="line"><span class="cl"><span class="c1">// 二分求出x对应的离散化的值
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="nf">find</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span> <span class="c1">// 找到第一个大于等于x的位置
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">l</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">alls</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">l</span> <span class="o">&lt;</span> <span class="n">r</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">mid</span> <span class="o">=</span> <span class="n">l</span> <span class="o">+</span> <span class="n">r</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">alls</span><span class="p">[</span><span class="n">mid</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">x</span><span class="p">)</span> <span class="n">r</span> <span class="o">=</span> <span class="n">mid</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span> <span class="n">l</span> <span class="o">=</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">r</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span> <span class="c1">// 映射到1, 2, ...n
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="区间合并--模板题-acwing-803-区间合并">区间合并 —— 模板题 AcWing 803. 区间合并<a hidden class="anchor" aria-hidden="true" href="#区间合并--模板题-acwing-803-区间合并">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-15-1"><a class="lnlinks" href="#hl-15-1"> 1</a>
</span><span class="lnt" id="hl-15-2"><a class="lnlinks" href="#hl-15-2"> 2</a>
</span><span class="lnt" id="hl-15-3"><a class="lnlinks" href="#hl-15-3"> 3</a>
</span><span class="lnt" id="hl-15-4"><a class="lnlinks" href="#hl-15-4"> 4</a>
</span><span class="lnt" id="hl-15-5"><a class="lnlinks" href="#hl-15-5"> 5</a>
</span><span class="lnt" id="hl-15-6"><a class="lnlinks" href="#hl-15-6"> 6</a>
</span><span class="lnt" id="hl-15-7"><a class="lnlinks" href="#hl-15-7"> 7</a>
</span><span class="lnt" id="hl-15-8"><a class="lnlinks" href="#hl-15-8"> 8</a>
</span><span class="lnt" id="hl-15-9"><a class="lnlinks" href="#hl-15-9"> 9</a>
</span><span class="lnt" id="hl-15-10"><a class="lnlinks" href="#hl-15-10">10</a>
</span><span class="lnt" id="hl-15-11"><a class="lnlinks" href="#hl-15-11">11</a>
</span><span class="lnt" id="hl-15-12"><a class="lnlinks" href="#hl-15-12">12</a>
</span><span class="lnt" id="hl-15-13"><a class="lnlinks" href="#hl-15-13">13</a>
</span><span class="lnt" id="hl-15-14"><a class="lnlinks" href="#hl-15-14">14</a>
</span><span class="lnt" id="hl-15-15"><a class="lnlinks" href="#hl-15-15">15</a>
</span><span class="lnt" id="hl-15-16"><a class="lnlinks" href="#hl-15-16">16</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="c1">// 将所有存在交集的区间合并 贪心
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">void</span> <span class="nf">merge</span><span class="p">(</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">PII</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">segs</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">vector</span><span class="o">&lt;</span><span class="n">PII</span><span class="o">&gt;</span> <span class="n">res</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">sort</span><span class="p">(</span><span class="n">segs</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span> <span class="n">segs</span><span class="p">.</span><span class="n">end</span><span class="p">());</span> <span class="c1">//区间左端点排序
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">int</span> <span class="n">st</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2e9</span><span class="p">,</span> <span class="n">ed</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2e9</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="nl">seg</span> <span class="p">:</span> <span class="n">segs</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">ed</span> <span class="o">&lt;</span> <span class="n">seg</span><span class="p">.</span><span class="n">first</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">st</span> <span class="o">!=</span> <span class="o">-</span><span class="mf">2e9</span><span class="p">)</span> <span class="n">res</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span><span class="n">st</span><span class="p">,</span> <span class="n">ed</span><span class="p">});</span>
</span></span><span class="line"><span class="cl">            <span class="n">st</span> <span class="o">=</span> <span class="n">seg</span><span class="p">.</span><span class="n">first</span><span class="p">,</span> <span class="n">ed</span> <span class="o">=</span> <span class="n">seg</span><span class="p">.</span><span class="n">second</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span> <span class="n">ed</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">ed</span><span class="p">,</span> <span class="n">seg</span><span class="p">.</span><span class="n">second</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">st</span> <span class="o">!=</span> <span class="o">-</span><span class="mf">2e9</span><span class="p">)</span> <span class="n">res</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span><span class="n">st</span><span class="p">,</span> <span class="n">ed</span><span class="p">});</span>
</span></span><span class="line"><span class="cl">    <span class="n">segs</span> <span class="o">=</span> <span class="n">res</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>作者：yxc
链接：https://www.acwing.com/blog/content/277/
来源：AcWing
著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。</p>
<h2 id="第二章">第二章<a hidden class="anchor" aria-hidden="true" href="#第二章">#</a></h2>
<p>数据结构，以数组模拟的形式</p>
<p>指针+结构体 ： 面试题</p>
<h3 id="单链表--模板题-acwing-826-单链表">单链表 —— 模板题 AcWing 826. 单链表<a hidden class="anchor" aria-hidden="true" href="#单链表--模板题-acwing-826-单链表">#</a></h3>
<p>邻接表-存储树和图  静态链表</p>
<p>下标从0开始</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-16-1"><a class="lnlinks" href="#hl-16-1"> 1</a>
</span><span class="lnt" id="hl-16-2"><a class="lnlinks" href="#hl-16-2"> 2</a>
</span><span class="lnt" id="hl-16-3"><a class="lnlinks" href="#hl-16-3"> 3</a>
</span><span class="lnt" id="hl-16-4"><a class="lnlinks" href="#hl-16-4"> 4</a>
</span><span class="lnt" id="hl-16-5"><a class="lnlinks" href="#hl-16-5"> 5</a>
</span><span class="lnt" id="hl-16-6"><a class="lnlinks" href="#hl-16-6"> 6</a>
</span><span class="lnt" id="hl-16-7"><a class="lnlinks" href="#hl-16-7"> 7</a>
</span><span class="lnt" id="hl-16-8"><a class="lnlinks" href="#hl-16-8"> 8</a>
</span><span class="lnt" id="hl-16-9"><a class="lnlinks" href="#hl-16-9"> 9</a>
</span><span class="lnt" id="hl-16-10"><a class="lnlinks" href="#hl-16-10">10</a>
</span><span class="lnt" id="hl-16-11"><a class="lnlinks" href="#hl-16-11">11</a>
</span><span class="lnt" id="hl-16-12"><a class="lnlinks" href="#hl-16-12">12</a>
</span><span class="lnt" id="hl-16-13"><a class="lnlinks" href="#hl-16-13">13</a>
</span><span class="lnt" id="hl-16-14"><a class="lnlinks" href="#hl-16-14">14</a>
</span><span class="lnt" id="hl-16-15"><a class="lnlinks" href="#hl-16-15">15</a>
</span><span class="lnt" id="hl-16-16"><a class="lnlinks" href="#hl-16-16">16</a>
</span><span class="lnt" id="hl-16-17"><a class="lnlinks" href="#hl-16-17">17</a>
</span><span class="lnt" id="hl-16-18"><a class="lnlinks" href="#hl-16-18">18</a>
</span><span class="lnt" id="hl-16-19"><a class="lnlinks" href="#hl-16-19">19</a>
</span><span class="lnt" id="hl-16-20"><a class="lnlinks" href="#hl-16-20">20</a>
</span><span class="lnt" id="hl-16-21"><a class="lnlinks" href="#hl-16-21">21</a>
</span><span class="lnt" id="hl-16-22"><a class="lnlinks" href="#hl-16-22">22</a>
</span><span class="lnt" id="hl-16-23"><a class="lnlinks" href="#hl-16-23">23</a>
</span><span class="lnt" id="hl-16-24"><a class="lnlinks" href="#hl-16-24">24</a>
</span><span class="lnt" id="hl-16-25"><a class="lnlinks" href="#hl-16-25">25</a>
</span><span class="lnt" id="hl-16-26"><a class="lnlinks" href="#hl-16-26">26</a>
</span><span class="lnt" id="hl-16-27"><a class="lnlinks" href="#hl-16-27">27</a>
</span><span class="lnt" id="hl-16-28"><a class="lnlinks" href="#hl-16-28">28</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="c1">// head存储链表头，e[]存储节点的值，ne[]存储节点的next指针，idx表示当前用到了哪个节点
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="n">head</span><span class="p">,</span> <span class="n">e</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">ne</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">idx</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 初始化
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">void</span> <span class="nf">init</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">head</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 在链表头插入一个数a
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">void</span> <span class="nf">insert</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">e</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">,</span> <span class="n">ne</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">head</span><span class="p">,</span> <span class="n">head</span> <span class="o">=</span> <span class="n">idx</span> <span class="o">++</span> <span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 插入下标k后面
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">void</span> <span class="nf">add</span><span class="p">(</span><span class="kt">int</span> <span class="n">k</span><span class="p">,</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">e</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">=</span> <span class="n">x</span><span class="p">,</span> <span class="n">ne</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">ne</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">ne</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">idx</span><span class="o">++</span> <span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 将头结点删除，需要保证头结点存在
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">void</span> <span class="nf">remove</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">head</span> <span class="o">=</span> <span class="n">ne</span><span class="p">[</span><span class="n">head</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 将k后面的点删掉
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">void</span> <span class="nf">remove</span><span class="p">(</span><span class="kt">int</span> <span class="n">k</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ne</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">ne</span><span class="p">[</span><span class="n">ne</span><span class="p">[</span><span class="n">k</span><span class="p">]];</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="双链表--模板题-acwing-827-双链表">双链表 —— 模板题 AcWing 827. 双链表<a hidden class="anchor" aria-hidden="true" href="#双链表--模板题-acwing-827-双链表">#</a></h3>
<p>优化某些问题</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-17-1"><a class="lnlinks" href="#hl-17-1"> 1</a>
</span><span class="lnt" id="hl-17-2"><a class="lnlinks" href="#hl-17-2"> 2</a>
</span><span class="lnt" id="hl-17-3"><a class="lnlinks" href="#hl-17-3"> 3</a>
</span><span class="lnt" id="hl-17-4"><a class="lnlinks" href="#hl-17-4"> 4</a>
</span><span class="lnt" id="hl-17-5"><a class="lnlinks" href="#hl-17-5"> 5</a>
</span><span class="lnt" id="hl-17-6"><a class="lnlinks" href="#hl-17-6"> 6</a>
</span><span class="lnt" id="hl-17-7"><a class="lnlinks" href="#hl-17-7"> 7</a>
</span><span class="lnt" id="hl-17-8"><a class="lnlinks" href="#hl-17-8"> 8</a>
</span><span class="lnt" id="hl-17-9"><a class="lnlinks" href="#hl-17-9"> 9</a>
</span><span class="lnt" id="hl-17-10"><a class="lnlinks" href="#hl-17-10">10</a>
</span><span class="lnt" id="hl-17-11"><a class="lnlinks" href="#hl-17-11">11</a>
</span><span class="lnt" id="hl-17-12"><a class="lnlinks" href="#hl-17-12">12</a>
</span><span class="lnt" id="hl-17-13"><a class="lnlinks" href="#hl-17-13">13</a>
</span><span class="lnt" id="hl-17-14"><a class="lnlinks" href="#hl-17-14">14</a>
</span><span class="lnt" id="hl-17-15"><a class="lnlinks" href="#hl-17-15">15</a>
</span><span class="lnt" id="hl-17-16"><a class="lnlinks" href="#hl-17-16">16</a>
</span><span class="lnt" id="hl-17-17"><a class="lnlinks" href="#hl-17-17">17</a>
</span><span class="lnt" id="hl-17-18"><a class="lnlinks" href="#hl-17-18">18</a>
</span><span class="lnt" id="hl-17-19"><a class="lnlinks" href="#hl-17-19">19</a>
</span><span class="lnt" id="hl-17-20"><a class="lnlinks" href="#hl-17-20">20</a>
</span><span class="lnt" id="hl-17-21"><a class="lnlinks" href="#hl-17-21">21</a>
</span><span class="lnt" id="hl-17-22"><a class="lnlinks" href="#hl-17-22">22</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="c1">// e[]表示节点的值，l[]表示节点的左指针，r[]表示节点的右指针，idx表示当前用到了哪个节点
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="n">e</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">l</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">r</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">idx</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 初始化
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">void</span> <span class="nf">init</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">//0是左端点，1是右端点
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">idx</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 在节点a的右边插入一个数x
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">void</span> <span class="nf">insert</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="kt">int</span> <span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">e</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">l</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">,</span> <span class="n">r</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="n">a</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="n">l</span><span class="p">[</span><span class="n">r</span><span class="p">[</span><span class="n">a</span><span class="p">]]</span> <span class="o">=</span> <span class="n">idx</span><span class="p">,</span> <span class="n">r</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">idx</span> <span class="o">++</span> <span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 删除节点a
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">void</span> <span class="nf">remove</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">l</span><span class="p">[</span><span class="n">r</span><span class="p">[</span><span class="n">a</span><span class="p">]]</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">a</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="n">r</span><span class="p">[</span><span class="n">l</span><span class="p">[</span><span class="n">a</span><span class="p">]]</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="n">a</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="栈--模板题-acwing-828-模拟栈">栈 —— 模板题 AcWing 828. 模拟栈<a hidden class="anchor" aria-hidden="true" href="#栈--模板题-acwing-828-模拟栈">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-18-1"><a class="lnlinks" href="#hl-18-1"> 1</a>
</span><span class="lnt" id="hl-18-2"><a class="lnlinks" href="#hl-18-2"> 2</a>
</span><span class="lnt" id="hl-18-3"><a class="lnlinks" href="#hl-18-3"> 3</a>
</span><span class="lnt" id="hl-18-4"><a class="lnlinks" href="#hl-18-4"> 4</a>
</span><span class="lnt" id="hl-18-5"><a class="lnlinks" href="#hl-18-5"> 5</a>
</span><span class="lnt" id="hl-18-6"><a class="lnlinks" href="#hl-18-6"> 6</a>
</span><span class="lnt" id="hl-18-7"><a class="lnlinks" href="#hl-18-7"> 7</a>
</span><span class="lnt" id="hl-18-8"><a class="lnlinks" href="#hl-18-8"> 8</a>
</span><span class="lnt" id="hl-18-9"><a class="lnlinks" href="#hl-18-9"> 9</a>
</span><span class="lnt" id="hl-18-10"><a class="lnlinks" href="#hl-18-10">10</a>
</span><span class="lnt" id="hl-18-11"><a class="lnlinks" href="#hl-18-11">11</a>
</span><span class="lnt" id="hl-18-12"><a class="lnlinks" href="#hl-18-12">12</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="c1">// tt表示栈顶
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="n">stk</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">tt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 向栈顶插入一个数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">stk</span><span class="p">[</span> <span class="o">++</span> <span class="n">tt</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 从栈顶弹出一个数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">tt</span> <span class="o">--</span> <span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 栈顶的值
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">stk</span><span class="p">[</span><span class="n">tt</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 判断栈是否为空
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">if</span> <span class="p">(</span><span class="n">tt</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="队列--模板题-acwing-829-模拟队列">队列 —— 模板题 AcWing 829. 模拟队列<a hidden class="anchor" aria-hidden="true" href="#队列--模板题-acwing-829-模拟队列">#</a></h3>
<p>普通队列</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-19-1"><a class="lnlinks" href="#hl-19-1"> 1</a>
</span><span class="lnt" id="hl-19-2"><a class="lnlinks" href="#hl-19-2"> 2</a>
</span><span class="lnt" id="hl-19-3"><a class="lnlinks" href="#hl-19-3"> 3</a>
</span><span class="lnt" id="hl-19-4"><a class="lnlinks" href="#hl-19-4"> 4</a>
</span><span class="lnt" id="hl-19-5"><a class="lnlinks" href="#hl-19-5"> 5</a>
</span><span class="lnt" id="hl-19-6"><a class="lnlinks" href="#hl-19-6"> 6</a>
</span><span class="lnt" id="hl-19-7"><a class="lnlinks" href="#hl-19-7"> 7</a>
</span><span class="lnt" id="hl-19-8"><a class="lnlinks" href="#hl-19-8"> 8</a>
</span><span class="lnt" id="hl-19-9"><a class="lnlinks" href="#hl-19-9"> 9</a>
</span><span class="lnt" id="hl-19-10"><a class="lnlinks" href="#hl-19-10">10</a>
</span><span class="lnt" id="hl-19-11"><a class="lnlinks" href="#hl-19-11">11</a>
</span><span class="lnt" id="hl-19-12"><a class="lnlinks" href="#hl-19-12">12</a>
</span><span class="lnt" id="hl-19-13"><a class="lnlinks" href="#hl-19-13">13</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="c1">// hh 表示队头，tt表示队尾
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="n">q</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">hh</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">tt</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 向队尾插入一个数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">q</span><span class="p">[</span> <span class="o">++</span> <span class="n">tt</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 从队头弹出一个数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">hh</span> <span class="o">++</span> <span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 队头的值
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">q</span><span class="p">[</span><span class="n">hh</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 判断队列是否为空
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">if</span> <span class="p">(</span><span class="n">hh</span> <span class="o">&lt;=</span> <span class="n">tt</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">//不空
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>循环队列</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-20-1"><a class="lnlinks" href="#hl-20-1"> 1</a>
</span><span class="lnt" id="hl-20-2"><a class="lnlinks" href="#hl-20-2"> 2</a>
</span><span class="lnt" id="hl-20-3"><a class="lnlinks" href="#hl-20-3"> 3</a>
</span><span class="lnt" id="hl-20-4"><a class="lnlinks" href="#hl-20-4"> 4</a>
</span><span class="lnt" id="hl-20-5"><a class="lnlinks" href="#hl-20-5"> 5</a>
</span><span class="lnt" id="hl-20-6"><a class="lnlinks" href="#hl-20-6"> 6</a>
</span><span class="lnt" id="hl-20-7"><a class="lnlinks" href="#hl-20-7"> 7</a>
</span><span class="lnt" id="hl-20-8"><a class="lnlinks" href="#hl-20-8"> 8</a>
</span><span class="lnt" id="hl-20-9"><a class="lnlinks" href="#hl-20-9"> 9</a>
</span><span class="lnt" id="hl-20-10"><a class="lnlinks" href="#hl-20-10">10</a>
</span><span class="lnt" id="hl-20-11"><a class="lnlinks" href="#hl-20-11">11</a>
</span><span class="lnt" id="hl-20-12"><a class="lnlinks" href="#hl-20-12">12</a>
</span><span class="lnt" id="hl-20-13"><a class="lnlinks" href="#hl-20-13">13</a>
</span><span class="lnt" id="hl-20-14"><a class="lnlinks" href="#hl-20-14">14</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="c1">// hh 表示队头，tt表示队尾的后一个位置
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="n">q</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">hh</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">tt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 向队尾插入一个数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">q</span><span class="p">[</span><span class="n">tt</span> <span class="o">++</span> <span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="n">tt</span> <span class="o">==</span> <span class="n">N</span><span class="p">)</span> <span class="n">tt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 从队头弹出一个数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">hh</span> <span class="o">++</span> <span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="n">hh</span> <span class="o">==</span> <span class="n">N</span><span class="p">)</span> <span class="n">hh</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 队头的值
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">q</span><span class="p">[</span><span class="n">hh</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 判断队列是否为空
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">if</span> <span class="p">(</span><span class="n">hh</span> <span class="o">!=</span> <span class="n">tt</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="单调栈--模板题-acwing-830-单调栈">单调栈 —— 模板题 AcWing 830. 单调栈<a hidden class="anchor" aria-hidden="true" href="#单调栈--模板题-acwing-830-单调栈">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-21-1"><a class="lnlinks" href="#hl-21-1">1</a>
</span><span class="lnt" id="hl-21-2"><a class="lnlinks" href="#hl-21-2">2</a>
</span><span class="lnt" id="hl-21-3"><a class="lnlinks" href="#hl-21-3">3</a>
</span><span class="lnt" id="hl-21-4"><a class="lnlinks" href="#hl-21-4">4</a>
</span><span class="lnt" id="hl-21-5"><a class="lnlinks" href="#hl-21-5">5</a>
</span><span class="lnt" id="hl-21-6"><a class="lnlinks" href="#hl-21-6">6</a>
</span><span class="lnt" id="hl-21-7"><a class="lnlinks" href="#hl-21-7">7</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="err">常见模型：找出每个数左边离它最近的比它大</span><span class="o">/</span><span class="err">小的数</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">tt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span> <span class="o">++</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">tt</span> <span class="o">&amp;&amp;</span> <span class="n">check</span><span class="p">(</span><span class="n">stk</span><span class="p">[</span><span class="n">tt</span><span class="p">],</span> <span class="n">i</span><span class="p">))</span> <span class="n">tt</span> <span class="o">--</span> <span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">stk</span><span class="p">[</span> <span class="o">++</span> <span class="n">tt</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="单调队列--模板题-acwing-154-滑动窗口">单调队列 —— 模板题 AcWing 154. 滑动窗口<a hidden class="anchor" aria-hidden="true" href="#单调队列--模板题-acwing-154-滑动窗口">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-22-1"><a class="lnlinks" href="#hl-22-1">1</a>
</span><span class="lnt" id="hl-22-2"><a class="lnlinks" href="#hl-22-2">2</a>
</span><span class="lnt" id="hl-22-3"><a class="lnlinks" href="#hl-22-3">3</a>
</span><span class="lnt" id="hl-22-4"><a class="lnlinks" href="#hl-22-4">4</a>
</span><span class="lnt" id="hl-22-5"><a class="lnlinks" href="#hl-22-5">5</a>
</span><span class="lnt" id="hl-22-6"><a class="lnlinks" href="#hl-22-6">6</a>
</span><span class="lnt" id="hl-22-7"><a class="lnlinks" href="#hl-22-7">7</a>
</span><span class="lnt" id="hl-22-8"><a class="lnlinks" href="#hl-22-8">8</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="err">常见模型：找出滑动窗口中的最大值</span><span class="o">/</span><span class="err">最小值</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">hh</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">tt</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span> <span class="o">++</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">hh</span> <span class="o">&lt;=</span> <span class="n">tt</span> <span class="o">&amp;&amp;</span> <span class="n">check_out</span><span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="n">hh</span><span class="p">]))</span> <span class="n">hh</span> <span class="o">++</span> <span class="p">;</span>  <span class="c1">// 判断队头是否滑出窗口
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">while</span> <span class="p">(</span><span class="n">hh</span> <span class="o">&lt;=</span> <span class="n">tt</span> <span class="o">&amp;&amp;</span> <span class="n">check</span><span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="n">tt</span><span class="p">],</span> <span class="n">i</span><span class="p">))</span> <span class="n">tt</span> <span class="o">--</span> <span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">q</span><span class="p">[</span> <span class="o">++</span> <span class="n">tt</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="kmp--模板题-acwing-831-kmp字符串">KMP —— 模板题 AcWing 831. KMP字符串<a hidden class="anchor" aria-hidden="true" href="#kmp--模板题-acwing-831-kmp字符串">#</a></h3>
<p>用<strong>模板</strong>串来匹配<strong>模式</strong>串，找到模式串</p>
<p>s的真前缀以及真后缀是指不等于s的前缀以及后缀，即至少是<strong>s[1<del>n-2]<strong>或</strong>s[0</del>n-1]</strong></p>
<p>ne[i] : 以<strong>i</strong>结尾的串中 <strong>最长真前缀与真后缀相等的串</strong> 的长度，如果没有则为0。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-23-1"><a class="lnlinks" href="#hl-23-1"> 1</a>
</span><span class="lnt" id="hl-23-2"><a class="lnlinks" href="#hl-23-2"> 2</a>
</span><span class="lnt" id="hl-23-3"><a class="lnlinks" href="#hl-23-3"> 3</a>
</span><span class="lnt" id="hl-23-4"><a class="lnlinks" href="#hl-23-4"> 4</a>
</span><span class="lnt" id="hl-23-5"><a class="lnlinks" href="#hl-23-5"> 5</a>
</span><span class="lnt" id="hl-23-6"><a class="lnlinks" href="#hl-23-6"> 6</a>
</span><span class="lnt" id="hl-23-7"><a class="lnlinks" href="#hl-23-7"> 7</a>
</span><span class="lnt" id="hl-23-8"><a class="lnlinks" href="#hl-23-8"> 8</a>
</span><span class="lnt" id="hl-23-9"><a class="lnlinks" href="#hl-23-9"> 9</a>
</span><span class="lnt" id="hl-23-10"><a class="lnlinks" href="#hl-23-10">10</a>
</span><span class="lnt" id="hl-23-11"><a class="lnlinks" href="#hl-23-11">11</a>
</span><span class="lnt" id="hl-23-12"><a class="lnlinks" href="#hl-23-12">12</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="c1">//前缀h
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">prefix_function</span><span class="p">(</span><span class="n">string</span> <span class="n">s</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">s</span><span class="p">.</span><span class="n">length</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">pi</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">pi</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">j</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="n">j</span> <span class="o">=</span> <span class="n">pi</span><span class="p">[</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="n">j</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">pi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">j</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">pi</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>实际使用范例（下面这个例子字符串从1开始）</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-24-1"><a class="lnlinks" href="#hl-24-1"> 1</a>
</span><span class="lnt" id="hl-24-2"><a class="lnlinks" href="#hl-24-2"> 2</a>
</span><span class="lnt" id="hl-24-3"><a class="lnlinks" href="#hl-24-3"> 3</a>
</span><span class="lnt" id="hl-24-4"><a class="lnlinks" href="#hl-24-4"> 4</a>
</span><span class="lnt" id="hl-24-5"><a class="lnlinks" href="#hl-24-5"> 5</a>
</span><span class="lnt" id="hl-24-6"><a class="lnlinks" href="#hl-24-6"> 6</a>
</span><span class="lnt" id="hl-24-7"><a class="lnlinks" href="#hl-24-7"> 7</a>
</span><span class="lnt" id="hl-24-8"><a class="lnlinks" href="#hl-24-8"> 8</a>
</span><span class="lnt" id="hl-24-9"><a class="lnlinks" href="#hl-24-9"> 9</a>
</span><span class="lnt" id="hl-24-10"><a class="lnlinks" href="#hl-24-10">10</a>
</span><span class="lnt" id="hl-24-11"><a class="lnlinks" href="#hl-24-11">11</a>
</span><span class="lnt" id="hl-24-12"><a class="lnlinks" href="#hl-24-12">12</a>
</span><span class="lnt" id="hl-24-13"><a class="lnlinks" href="#hl-24-13">13</a>
</span><span class="lnt" id="hl-24-14"><a class="lnlinks" href="#hl-24-14">14</a>
</span><span class="lnt" id="hl-24-15"><a class="lnlinks" href="#hl-24-15">15</a>
</span><span class="lnt" id="hl-24-16"><a class="lnlinks" href="#hl-24-16">16</a>
</span><span class="lnt" id="hl-24-17"><a class="lnlinks" href="#hl-24-17">17</a>
</span><span class="lnt" id="hl-24-18"><a class="lnlinks" href="#hl-24-18">18</a>
</span><span class="lnt" id="hl-24-19"><a class="lnlinks" href="#hl-24-19">19</a>
</span><span class="lnt" id="hl-24-20"><a class="lnlinks" href="#hl-24-20">20</a>
</span><span class="lnt" id="hl-24-21"><a class="lnlinks" href="#hl-24-21">21</a>
</span><span class="lnt" id="hl-24-22"><a class="lnlinks" href="#hl-24-22">22</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="c1">// 求Next数组：
</span></span></span><span class="line"><span class="cl"><span class="c1">// ne[i] 存储真前缀和真后缀相等的长度，所以至少从2开始：
</span></span></span><span class="line"><span class="cl"><span class="c1">//abcab,从b开始才有真前缀
</span></span></span><span class="line"><span class="cl"><span class="c1">// s[]是模式串，p[]是模板串, n是s的长度，m是p的长度
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="p">;</span> <span class="n">i</span> <span class="o">++</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">j</span> <span class="o">&amp;&amp;</span> <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">p</span><span class="p">[</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="n">j</span> <span class="o">=</span> <span class="n">ne</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">p</span><span class="p">[</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="n">j</span> <span class="o">++</span> <span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">ne</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">j</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 匹配
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span> <span class="o">++</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">j</span> <span class="o">&amp;&amp;</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">p</span><span class="p">[</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="n">j</span> <span class="o">=</span> <span class="n">ne</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">p</span><span class="p">[</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="n">j</span> <span class="o">++</span> <span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">j</span> <span class="o">==</span> <span class="n">m</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">j</span> <span class="o">=</span> <span class="n">ne</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 匹配成功后的逻辑
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="trie树--模板题-acwing-835-trie字符串统计">Trie树 —— 模板题 AcWing 835. Trie字符串统计<a hidden class="anchor" aria-hidden="true" href="#trie树--模板题-acwing-835-trie字符串统计">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-25-1"><a class="lnlinks" href="#hl-25-1"> 1</a>
</span><span class="lnt" id="hl-25-2"><a class="lnlinks" href="#hl-25-2"> 2</a>
</span><span class="lnt" id="hl-25-3"><a class="lnlinks" href="#hl-25-3"> 3</a>
</span><span class="lnt" id="hl-25-4"><a class="lnlinks" href="#hl-25-4"> 4</a>
</span><span class="lnt" id="hl-25-5"><a class="lnlinks" href="#hl-25-5"> 5</a>
</span><span class="lnt" id="hl-25-6"><a class="lnlinks" href="#hl-25-6"> 6</a>
</span><span class="lnt" id="hl-25-7"><a class="lnlinks" href="#hl-25-7"> 7</a>
</span><span class="lnt" id="hl-25-8"><a class="lnlinks" href="#hl-25-8"> 8</a>
</span><span class="lnt" id="hl-25-9"><a class="lnlinks" href="#hl-25-9"> 9</a>
</span><span class="lnt" id="hl-25-10"><a class="lnlinks" href="#hl-25-10">10</a>
</span><span class="lnt" id="hl-25-11"><a class="lnlinks" href="#hl-25-11">11</a>
</span><span class="lnt" id="hl-25-12"><a class="lnlinks" href="#hl-25-12">12</a>
</span><span class="lnt" id="hl-25-13"><a class="lnlinks" href="#hl-25-13">13</a>
</span><span class="lnt" id="hl-25-14"><a class="lnlinks" href="#hl-25-14">14</a>
</span><span class="lnt" id="hl-25-15"><a class="lnlinks" href="#hl-25-15">15</a>
</span><span class="lnt" id="hl-25-16"><a class="lnlinks" href="#hl-25-16">16</a>
</span><span class="lnt" id="hl-25-17"><a class="lnlinks" href="#hl-25-17">17</a>
</span><span class="lnt" id="hl-25-18"><a class="lnlinks" href="#hl-25-18">18</a>
</span><span class="lnt" id="hl-25-19"><a class="lnlinks" href="#hl-25-19">19</a>
</span><span class="lnt" id="hl-25-20"><a class="lnlinks" href="#hl-25-20">20</a>
</span><span class="lnt" id="hl-25-21"><a class="lnlinks" href="#hl-25-21">21</a>
</span><span class="lnt" id="hl-25-22"><a class="lnlinks" href="#hl-25-22">22</a>
</span><span class="lnt" id="hl-25-23"><a class="lnlinks" href="#hl-25-23">23</a>
</span><span class="lnt" id="hl-25-24"><a class="lnlinks" href="#hl-25-24">24</a>
</span><span class="lnt" id="hl-25-25"><a class="lnlinks" href="#hl-25-25">25</a>
</span><span class="lnt" id="hl-25-26"><a class="lnlinks" href="#hl-25-26">26</a>
</span><span class="lnt" id="hl-25-27"><a class="lnlinks" href="#hl-25-27">27</a>
</span><span class="lnt" id="hl-25-28"><a class="lnlinks" href="#hl-25-28">28</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">son</span><span class="p">[</span><span class="n">N</span><span class="p">][</span><span class="mi">26</span><span class="p">],</span> <span class="n">cnt</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">idx</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 0号点既是根节点，又是空节点
</span></span></span><span class="line"><span class="cl"><span class="c1">// son[][]存储树中每个节点的子节点
</span></span></span><span class="line"><span class="cl"><span class="c1">// cnt[]存储以每个节点结尾的单词数量
</span></span></span><span class="line"><span class="cl"><span class="c1">// 插入一个字符串
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">void</span> <span class="nf">insert</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">str</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">p</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">str</span><span class="p">[</span><span class="n">i</span><span class="p">];</span> <span class="n">i</span> <span class="o">++</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">u</span> <span class="o">=</span> <span class="n">str</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="sc">&#39;a&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">son</span><span class="p">[</span><span class="n">p</span><span class="p">][</span><span class="n">u</span><span class="p">])</span> <span class="n">son</span><span class="p">[</span><span class="n">p</span><span class="p">][</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="o">++</span> <span class="n">idx</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">p</span> <span class="o">=</span> <span class="n">son</span><span class="p">[</span><span class="n">p</span><span class="p">][</span><span class="n">u</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">cnt</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="o">++</span> <span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 查询字符串出现的次数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="nf">query</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">str</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">p</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">str</span><span class="p">[</span><span class="n">i</span><span class="p">];</span> <span class="n">i</span> <span class="o">++</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">u</span> <span class="o">=</span> <span class="n">str</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="sc">&#39;a&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">son</span><span class="p">[</span><span class="n">p</span><span class="p">][</span><span class="n">u</span><span class="p">])</span> <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">p</span> <span class="o">=</span> <span class="n">son</span><span class="p">[</span><span class="n">p</span><span class="p">][</span><span class="n">u</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">cnt</span><span class="p">[</span><span class="n">p</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="并查集--模板题-acwing-836-合并集合-acwing-837-连通块中点的数量">并查集 —— 模板题 AcWing 836. 合并集合, AcWing 837. 连通块中点的数量<a hidden class="anchor" aria-hidden="true" href="#并查集--模板题-acwing-836-合并集合-acwing-837-连通块中点的数量">#</a></h3>
<p>按秩合并</p>
<p>字符按字符串读入</p>
<p>(1)朴素并查集：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-26-1"><a class="lnlinks" href="#hl-26-1"> 1</a>
</span><span class="lnt" id="hl-26-2"><a class="lnlinks" href="#hl-26-2"> 2</a>
</span><span class="lnt" id="hl-26-3"><a class="lnlinks" href="#hl-26-3"> 3</a>
</span><span class="lnt" id="hl-26-4"><a class="lnlinks" href="#hl-26-4"> 4</a>
</span><span class="lnt" id="hl-26-5"><a class="lnlinks" href="#hl-26-5"> 5</a>
</span><span class="lnt" id="hl-26-6"><a class="lnlinks" href="#hl-26-6"> 6</a>
</span><span class="lnt" id="hl-26-7"><a class="lnlinks" href="#hl-26-7"> 7</a>
</span><span class="lnt" id="hl-26-8"><a class="lnlinks" href="#hl-26-8"> 8</a>
</span><span class="lnt" id="hl-26-9"><a class="lnlinks" href="#hl-26-9"> 9</a>
</span><span class="lnt" id="hl-26-10"><a class="lnlinks" href="#hl-26-10">10</a>
</span><span class="lnt" id="hl-26-11"><a class="lnlinks" href="#hl-26-11">11</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">p</span><span class="p">[</span><span class="n">N</span><span class="p">];</span> <span class="c1">//存储每个点的祖宗节点
</span></span></span><span class="line"><span class="cl"><span class="c1">// 返回x的祖宗节点
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="nf">find</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">!=</span> <span class="n">x</span><span class="p">)</span> <span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">find</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 初始化，假定节点编号是1~n
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span> <span class="o">++</span> <span class="p">)</span> <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 合并a和b所在的两个集合：
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">p</span><span class="p">[</span><span class="n">find</span><span class="p">(</span><span class="n">a</span><span class="p">)]</span> <span class="o">=</span> <span class="n">find</span><span class="p">(</span><span class="n">b</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>(2)维护size的并查集：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-27-1"><a class="lnlinks" href="#hl-27-1"> 1</a>
</span><span class="lnt" id="hl-27-2"><a class="lnlinks" href="#hl-27-2"> 2</a>
</span><span class="lnt" id="hl-27-3"><a class="lnlinks" href="#hl-27-3"> 3</a>
</span><span class="lnt" id="hl-27-4"><a class="lnlinks" href="#hl-27-4"> 4</a>
</span><span class="lnt" id="hl-27-5"><a class="lnlinks" href="#hl-27-5"> 5</a>
</span><span class="lnt" id="hl-27-6"><a class="lnlinks" href="#hl-27-6"> 6</a>
</span><span class="lnt" id="hl-27-7"><a class="lnlinks" href="#hl-27-7"> 7</a>
</span><span class="lnt" id="hl-27-8"><a class="lnlinks" href="#hl-27-8"> 8</a>
</span><span class="lnt" id="hl-27-9"><a class="lnlinks" href="#hl-27-9"> 9</a>
</span><span class="lnt" id="hl-27-10"><a class="lnlinks" href="#hl-27-10">10</a>
</span><span class="lnt" id="hl-27-11"><a class="lnlinks" href="#hl-27-11">11</a>
</span><span class="lnt" id="hl-27-12"><a class="lnlinks" href="#hl-27-12">12</a>
</span><span class="lnt" id="hl-27-13"><a class="lnlinks" href="#hl-27-13">13</a>
</span><span class="lnt" id="hl-27-14"><a class="lnlinks" href="#hl-27-14">14</a>
</span><span class="lnt" id="hl-27-15"><a class="lnlinks" href="#hl-27-15">15</a>
</span><span class="lnt" id="hl-27-16"><a class="lnlinks" href="#hl-27-16">16</a>
</span><span class="lnt" id="hl-27-17"><a class="lnlinks" href="#hl-27-17">17</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">p</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">size</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="c1">//p[]存储每个点的祖宗节点, size[]只有祖宗节点的有意义，表示祖宗节点所在集合中的点的数量
</span></span></span><span class="line"><span class="cl"><span class="c1">// 返回x的祖宗节点
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="nf">find</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">!=</span> <span class="n">x</span><span class="p">)</span> <span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">find</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 初始化，假定节点编号是1~n
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span> <span class="o">++</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">size</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 合并a和b所在的两个集合：
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">p</span><span class="p">[</span><span class="n">find</span><span class="p">(</span><span class="n">a</span><span class="p">)]</span> <span class="o">=</span> <span class="n">find</span><span class="p">(</span><span class="n">b</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">size</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">size</span><span class="p">[</span><span class="n">a</span><span class="p">];</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>(3)维护到祖宗节点距离的并查集：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-28-1"><a class="lnlinks" href="#hl-28-1"> 1</a>
</span><span class="lnt" id="hl-28-2"><a class="lnlinks" href="#hl-28-2"> 2</a>
</span><span class="lnt" id="hl-28-3"><a class="lnlinks" href="#hl-28-3"> 3</a>
</span><span class="lnt" id="hl-28-4"><a class="lnlinks" href="#hl-28-4"> 4</a>
</span><span class="lnt" id="hl-28-5"><a class="lnlinks" href="#hl-28-5"> 5</a>
</span><span class="lnt" id="hl-28-6"><a class="lnlinks" href="#hl-28-6"> 6</a>
</span><span class="lnt" id="hl-28-7"><a class="lnlinks" href="#hl-28-7"> 7</a>
</span><span class="lnt" id="hl-28-8"><a class="lnlinks" href="#hl-28-8"> 8</a>
</span><span class="lnt" id="hl-28-9"><a class="lnlinks" href="#hl-28-9"> 9</a>
</span><span class="lnt" id="hl-28-10"><a class="lnlinks" href="#hl-28-10">10</a>
</span><span class="lnt" id="hl-28-11"><a class="lnlinks" href="#hl-28-11">11</a>
</span><span class="lnt" id="hl-28-12"><a class="lnlinks" href="#hl-28-12">12</a>
</span><span class="lnt" id="hl-28-13"><a class="lnlinks" href="#hl-28-13">13</a>
</span><span class="lnt" id="hl-28-14"><a class="lnlinks" href="#hl-28-14">14</a>
</span><span class="lnt" id="hl-28-15"><a class="lnlinks" href="#hl-28-15">15</a>
</span><span class="lnt" id="hl-28-16"><a class="lnlinks" href="#hl-28-16">16</a>
</span><span class="lnt" id="hl-28-17"><a class="lnlinks" href="#hl-28-17">17</a>
</span><span class="lnt" id="hl-28-18"><a class="lnlinks" href="#hl-28-18">18</a>
</span><span class="lnt" id="hl-28-19"><a class="lnlinks" href="#hl-28-19">19</a>
</span><span class="lnt" id="hl-28-20"><a class="lnlinks" href="#hl-28-20">20</a>
</span><span class="lnt" id="hl-28-21"><a class="lnlinks" href="#hl-28-21">21</a>
</span><span class="lnt" id="hl-28-22"><a class="lnlinks" href="#hl-28-22">22</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">p</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">d</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="c1">//p[]存储每个点的祖宗节点, d[x]存储x到p[x]的距离
</span></span></span><span class="line"><span class="cl"><span class="c1">// 返回x的祖宗节点
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="nf">find</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">!=</span> <span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">u</span> <span class="o">=</span> <span class="n">find</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">        <span class="n">d</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">+=</span> <span class="n">d</span><span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">]];</span>
</span></span><span class="line"><span class="cl">        <span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">u</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 初始化，假定节点编号是1~n
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span> <span class="o">++</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 合并a和b所在的两个集合：
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">p</span><span class="p">[</span><span class="n">find</span><span class="p">(</span><span class="n">a</span><span class="p">)]</span> <span class="o">=</span> <span class="n">find</span><span class="p">(</span><span class="n">b</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">d</span><span class="p">[</span><span class="n">find</span><span class="p">(</span><span class="n">a</span><span class="p">)]</span> <span class="o">=</span> <span class="n">distance</span><span class="p">;</span> <span class="c1">// 根据具体问题，初始化find(a)的偏移量
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="堆--模板题-acwing-838-堆排序-acwing-839-模拟堆">堆 —— 模板题 AcWing 838. 堆排序, AcWing 839. 模拟堆<a hidden class="anchor" aria-hidden="true" href="#堆--模板题-acwing-838-堆排序-acwing-839-模拟堆">#</a></h3>
<p>维护集合的数据结构 （大根堆，父节点值不小于子节点值）</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-29-1"><a class="lnlinks" href="#hl-29-1"> 1</a>
</span><span class="lnt" id="hl-29-2"><a class="lnlinks" href="#hl-29-2"> 2</a>
</span><span class="lnt" id="hl-29-3"><a class="lnlinks" href="#hl-29-3"> 3</a>
</span><span class="lnt" id="hl-29-4"><a class="lnlinks" href="#hl-29-4"> 4</a>
</span><span class="lnt" id="hl-29-5"><a class="lnlinks" href="#hl-29-5"> 5</a>
</span><span class="lnt" id="hl-29-6"><a class="lnlinks" href="#hl-29-6"> 6</a>
</span><span class="lnt" id="hl-29-7"><a class="lnlinks" href="#hl-29-7"> 7</a>
</span><span class="lnt" id="hl-29-8"><a class="lnlinks" href="#hl-29-8"> 8</a>
</span><span class="lnt" id="hl-29-9"><a class="lnlinks" href="#hl-29-9"> 9</a>
</span><span class="lnt" id="hl-29-10"><a class="lnlinks" href="#hl-29-10">10</a>
</span><span class="lnt" id="hl-29-11"><a class="lnlinks" href="#hl-29-11">11</a>
</span><span class="lnt" id="hl-29-12"><a class="lnlinks" href="#hl-29-12">12</a>
</span><span class="lnt" id="hl-29-13"><a class="lnlinks" href="#hl-29-13">13</a>
</span><span class="lnt" id="hl-29-14"><a class="lnlinks" href="#hl-29-14">14</a>
</span><span class="lnt" id="hl-29-15"><a class="lnlinks" href="#hl-29-15">15</a>
</span><span class="lnt" id="hl-29-16"><a class="lnlinks" href="#hl-29-16">16</a>
</span><span class="lnt" id="hl-29-17"><a class="lnlinks" href="#hl-29-17">17</a>
</span><span class="lnt" id="hl-29-18"><a class="lnlinks" href="#hl-29-18">18</a>
</span><span class="lnt" id="hl-29-19"><a class="lnlinks" href="#hl-29-19">19</a>
</span><span class="lnt" id="hl-29-20"><a class="lnlinks" href="#hl-29-20">20</a>
</span><span class="lnt" id="hl-29-21"><a class="lnlinks" href="#hl-29-21">21</a>
</span><span class="lnt" id="hl-29-22"><a class="lnlinks" href="#hl-29-22">22</a>
</span><span class="lnt" id="hl-29-23"><a class="lnlinks" href="#hl-29-23">23</a>
</span><span class="lnt" id="hl-29-24"><a class="lnlinks" href="#hl-29-24">24</a>
</span><span class="lnt" id="hl-29-25"><a class="lnlinks" href="#hl-29-25">25</a>
</span><span class="lnt" id="hl-29-26"><a class="lnlinks" href="#hl-29-26">26</a>
</span><span class="lnt" id="hl-29-27"><a class="lnlinks" href="#hl-29-27">27</a>
</span><span class="lnt" id="hl-29-28"><a class="lnlinks" href="#hl-29-28">28</a>
</span><span class="lnt" id="hl-29-29"><a class="lnlinks" href="#hl-29-29">29</a>
</span><span class="lnt" id="hl-29-30"><a class="lnlinks" href="#hl-29-30">30</a>
</span><span class="lnt" id="hl-29-31"><a class="lnlinks" href="#hl-29-31">31</a>
</span><span class="lnt" id="hl-29-32"><a class="lnlinks" href="#hl-29-32">32</a>
</span><span class="lnt" id="hl-29-33"><a class="lnlinks" href="#hl-29-33">33</a>
</span><span class="lnt" id="hl-29-34"><a class="lnlinks" href="#hl-29-34">34</a>
</span><span class="lnt" id="hl-29-35"><a class="lnlinks" href="#hl-29-35">35</a>
</span><span class="lnt" id="hl-29-36"><a class="lnlinks" href="#hl-29-36">36</a>
</span><span class="lnt" id="hl-29-37"><a class="lnlinks" href="#hl-29-37">37</a>
</span><span class="lnt" id="hl-29-38"><a class="lnlinks" href="#hl-29-38">38</a>
</span><span class="lnt" id="hl-29-39"><a class="lnlinks" href="#hl-29-39">39</a>
</span><span class="lnt" id="hl-29-40"><a class="lnlinks" href="#hl-29-40">40</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="c1">// h[N]存储堆中的值, h[1]是堆顶，x的左儿子是2x, 右儿子是2x + 1
</span></span></span><span class="line"><span class="cl"><span class="c1">// pos[k]存储第k个插入的点在堆中的位置
</span></span></span><span class="line"><span class="cl"><span class="c1">// ord[k]存储堆中下标是k的点是第几个插入的
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">h</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">ph</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">hp</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">size</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 交换两个点，及其映射关系
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">void</span> <span class="nf">heap_swap</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="kt">int</span> <span class="n">b</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">//swap(ph[hp[a]],ph[hp[b]]); 根据题意
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">//swap(hp[a], hp[b]);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">swap</span><span class="p">(</span><span class="n">h</span><span class="p">[</span><span class="n">a</span><span class="p">],</span> <span class="n">h</span><span class="p">[</span><span class="n">b</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">down</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">t</span> <span class="o">=</span> <span class="n">u</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">u</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">&lt;=</span> <span class="n">size</span> <span class="o">&amp;&amp;</span> <span class="n">h</span><span class="p">[</span><span class="n">u</span> <span class="o">*</span> <span class="mi">2</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">h</span><span class="p">[</span><span class="n">t</span><span class="p">])</span> <span class="n">t</span> <span class="o">=</span> <span class="n">u</span> <span class="o">*</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">u</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">size</span> <span class="o">&amp;&amp;</span> <span class="n">h</span><span class="p">[</span><span class="n">u</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">h</span><span class="p">[</span><span class="n">t</span><span class="p">])</span> <span class="n">t</span> <span class="o">=</span> <span class="n">u</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">u</span> <span class="o">!=</span> <span class="n">t</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">heap_swap</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">t</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">down</span><span class="p">(</span><span class="n">t</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">up</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">u</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">&amp;&amp;</span> <span class="n">h</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">h</span><span class="p">[</span><span class="n">u</span> <span class="o">/</span> <span class="mi">2</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">heap_swap</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">u</span> <span class="o">/</span> <span class="mi">2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">u</span> <span class="o">&gt;&gt;=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">// O(n)建堆
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">n</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span> <span class="n">i</span><span class="p">;</span> <span class="n">i</span> <span class="o">--</span> <span class="p">)</span> <span class="n">down</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">heap</span><span class="p">[</span><span class="o">++</span><span class="n">size</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">;</span> <span class="n">up</span><span class="p">(</span><span class="n">size</span><span class="p">);</span> <span class="c1">//添加元素
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">heap</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span> <span class="c1">//堆顶元素
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">heap</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">heap</span><span class="p">[</span><span class="n">size</span><span class="p">];</span> <span class="n">size</span><span class="o">--</span><span class="p">;</span> <span class="n">down</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span><span class="c1">//删除第size个结点
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">heap</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">=</span><span class="n">heap</span><span class="p">[</span><span class="n">size</span><span class="p">];</span> <span class="n">size</span><span class="o">---</span><span class="p">;</span> <span class="n">down</span><span class="p">(</span><span class="n">k</span><span class="p">);</span><span class="n">up</span><span class="p">(</span><span class="n">k</span><span class="p">);</span><span class="c1">//删除第k个结点
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">heap</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">=</span><span class="n">x</span><span class="p">;</span> <span class="n">down</span><span class="p">(</span><span class="n">k</span><span class="p">);</span> <span class="n">up</span><span class="p">(</span><span class="n">k</span><span class="p">);</span> <span class="c1">//将第k个元素赋值为x
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="一般哈希--模板题-acwing-840-模拟散列表">一般哈希 —— 模板题 AcWing 840. 模拟散列表<a hidden class="anchor" aria-hidden="true" href="#一般哈希--模板题-acwing-840-模拟散列表">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-30-1"><a class="lnlinks" href="#hl-30-1"> 1</a>
</span><span class="lnt" id="hl-30-2"><a class="lnlinks" href="#hl-30-2"> 2</a>
</span><span class="lnt" id="hl-30-3"><a class="lnlinks" href="#hl-30-3"> 3</a>
</span><span class="lnt" id="hl-30-4"><a class="lnlinks" href="#hl-30-4"> 4</a>
</span><span class="lnt" id="hl-30-5"><a class="lnlinks" href="#hl-30-5"> 5</a>
</span><span class="lnt" id="hl-30-6"><a class="lnlinks" href="#hl-30-6"> 6</a>
</span><span class="lnt" id="hl-30-7"><a class="lnlinks" href="#hl-30-7"> 7</a>
</span><span class="lnt" id="hl-30-8"><a class="lnlinks" href="#hl-30-8"> 8</a>
</span><span class="lnt" id="hl-30-9"><a class="lnlinks" href="#hl-30-9"> 9</a>
</span><span class="lnt" id="hl-30-10"><a class="lnlinks" href="#hl-30-10">10</a>
</span><span class="lnt" id="hl-30-11"><a class="lnlinks" href="#hl-30-11">11</a>
</span><span class="lnt" id="hl-30-12"><a class="lnlinks" href="#hl-30-12">12</a>
</span><span class="lnt" id="hl-30-13"><a class="lnlinks" href="#hl-30-13">13</a>
</span><span class="lnt" id="hl-30-14"><a class="lnlinks" href="#hl-30-14">14</a>
</span><span class="lnt" id="hl-30-15"><a class="lnlinks" href="#hl-30-15">15</a>
</span><span class="lnt" id="hl-30-16"><a class="lnlinks" href="#hl-30-16">16</a>
</span><span class="lnt" id="hl-30-17"><a class="lnlinks" href="#hl-30-17">17</a>
</span><span class="lnt" id="hl-30-18"><a class="lnlinks" href="#hl-30-18">18</a>
</span><span class="lnt" id="hl-30-19"><a class="lnlinks" href="#hl-30-19">19</a>
</span><span class="lnt" id="hl-30-20"><a class="lnlinks" href="#hl-30-20">20</a>
</span><span class="lnt" id="hl-30-21"><a class="lnlinks" href="#hl-30-21">21</a>
</span><span class="lnt" id="hl-30-22"><a class="lnlinks" href="#hl-30-22">22</a>
</span><span class="lnt" id="hl-30-23"><a class="lnlinks" href="#hl-30-23">23</a>
</span><span class="lnt" id="hl-30-24"><a class="lnlinks" href="#hl-30-24">24</a>
</span><span class="lnt" id="hl-30-25"><a class="lnlinks" href="#hl-30-25">25</a>
</span><span class="lnt" id="hl-30-26"><a class="lnlinks" href="#hl-30-26">26</a>
</span><span class="lnt" id="hl-30-27"><a class="lnlinks" href="#hl-30-27">27</a>
</span><span class="lnt" id="hl-30-28"><a class="lnlinks" href="#hl-30-28">28</a>
</span><span class="lnt" id="hl-30-29"><a class="lnlinks" href="#hl-30-29">29</a>
</span><span class="lnt" id="hl-30-30"><a class="lnlinks" href="#hl-30-30">30</a>
</span><span class="lnt" id="hl-30-31"><a class="lnlinks" href="#hl-30-31">31</a>
</span><span class="lnt" id="hl-30-32"><a class="lnlinks" href="#hl-30-32">32</a>
</span><span class="lnt" id="hl-30-33"><a class="lnlinks" href="#hl-30-33">33</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="err">拉链法</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">h</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">ne</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">idx</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 向哈希表中插入一个数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">void</span> <span class="nf">insert</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">%</span> <span class="n">N</span> <span class="o">+</span> <span class="n">N</span><span class="p">)</span> <span class="o">%</span> <span class="n">N</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">e</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">ne</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">h</span><span class="p">[</span><span class="n">k</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="n">h</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">idx</span> <span class="o">++</span> <span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 在哈希表中查询某个数是否存在
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">bool</span> <span class="nf">find</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">%</span> <span class="n">N</span> <span class="o">+</span> <span class="n">N</span><span class="p">)</span> <span class="o">%</span> <span class="n">N</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">h</span><span class="p">[</span><span class="n">k</span><span class="p">];</span> <span class="n">i</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">=</span> <span class="n">ne</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="err">开放寻址法</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">h</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 如果x在哈希表中，返回x的下标；如果x不在哈希表中，返回x应该插入的位置
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="nf">find</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">%</span> <span class="n">N</span> <span class="o">+</span> <span class="n">N</span><span class="p">)</span> <span class="o">%</span> <span class="n">N</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">h</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">!=</span> <span class="n">null</span> <span class="o">&amp;&amp;</span> <span class="n">h</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">!=</span> <span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">t</span> <span class="o">++</span> <span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">t</span> <span class="o">==</span> <span class="n">N</span><span class="p">)</span> <span class="n">t</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">t</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="字符串哈希--模板题-acwing-841-字符串哈希">字符串哈希 —— 模板题 AcWing 841. 字符串哈希<a hidden class="anchor" aria-hidden="true" href="#字符串哈希--模板题-acwing-841-字符串哈希">#</a></h3>
<p>核心思想：将字符串看成P进制数，P的经验值是131或13331，取这两个值的冲突概率低
小技巧：取模的数用2^64，这样直接用unsigned long long存储，溢出的结果就是取模的结果。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-31-1"><a class="lnlinks" href="#hl-31-1"> 1</a>
</span><span class="lnt" id="hl-31-2"><a class="lnlinks" href="#hl-31-2"> 2</a>
</span><span class="lnt" id="hl-31-3"><a class="lnlinks" href="#hl-31-3"> 3</a>
</span><span class="lnt" id="hl-31-4"><a class="lnlinks" href="#hl-31-4"> 4</a>
</span><span class="lnt" id="hl-31-5"><a class="lnlinks" href="#hl-31-5"> 5</a>
</span><span class="lnt" id="hl-31-6"><a class="lnlinks" href="#hl-31-6"> 6</a>
</span><span class="lnt" id="hl-31-7"><a class="lnlinks" href="#hl-31-7"> 7</a>
</span><span class="lnt" id="hl-31-8"><a class="lnlinks" href="#hl-31-8"> 8</a>
</span><span class="lnt" id="hl-31-9"><a class="lnlinks" href="#hl-31-9"> 9</a>
</span><span class="lnt" id="hl-31-10"><a class="lnlinks" href="#hl-31-10">10</a>
</span><span class="lnt" id="hl-31-11"><a class="lnlinks" href="#hl-31-11">11</a>
</span><span class="lnt" id="hl-31-12"><a class="lnlinks" href="#hl-31-12">12</a>
</span><span class="lnt" id="hl-31-13"><a class="lnlinks" href="#hl-31-13">13</a>
</span><span class="lnt" id="hl-31-14"><a class="lnlinks" href="#hl-31-14">14</a>
</span><span class="lnt" id="hl-31-15"><a class="lnlinks" href="#hl-31-15">15</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">typedef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">ULL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">P</span> <span class="o">=</span> <span class="mi">131</span> <span class="n">or</span> <span class="mi">13331</span> <span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">ULL</span> <span class="n">h</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="n">N</span><span class="p">];</span> <span class="c1">// h[k]存储字符串前k个字母的哈希值, p[k]存储 P^k mod 2^64
</span></span></span><span class="line"><span class="cl"><span class="c1">// 初始化
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span> <span class="o">++</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">h</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">h</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">P</span> <span class="o">+</span> <span class="n">str</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">P</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 计算子串 str[l ~ r] 的哈希值
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">ULL</span> <span class="nf">get</span><span class="p">(</span><span class="kt">int</span> <span class="n">l</span><span class="p">,</span> <span class="kt">int</span> <span class="n">r</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">h</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">-</span> <span class="n">h</span><span class="p">[</span><span class="n">l</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">p</span><span class="p">[</span><span class="n">r</span> <span class="o">-</span> <span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="c-stl简介">C++ STL简介<a hidden class="anchor" aria-hidden="true" href="#c-stl简介">#</a></h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-32-1"><a class="lnlinks" href="#hl-32-1"> 1</a>
</span><span class="lnt" id="hl-32-2"><a class="lnlinks" href="#hl-32-2"> 2</a>
</span><span class="lnt" id="hl-32-3"><a class="lnlinks" href="#hl-32-3"> 3</a>
</span><span class="lnt" id="hl-32-4"><a class="lnlinks" href="#hl-32-4"> 4</a>
</span><span class="lnt" id="hl-32-5"><a class="lnlinks" href="#hl-32-5"> 5</a>
</span><span class="lnt" id="hl-32-6"><a class="lnlinks" href="#hl-32-6"> 6</a>
</span><span class="lnt" id="hl-32-7"><a class="lnlinks" href="#hl-32-7"> 7</a>
</span><span class="lnt" id="hl-32-8"><a class="lnlinks" href="#hl-32-8"> 8</a>
</span><span class="lnt" id="hl-32-9"><a class="lnlinks" href="#hl-32-9"> 9</a>
</span><span class="lnt" id="hl-32-10"><a class="lnlinks" href="#hl-32-10">10</a>
</span><span class="lnt" id="hl-32-11"><a class="lnlinks" href="#hl-32-11">11</a>
</span><span class="lnt" id="hl-32-12"><a class="lnlinks" href="#hl-32-12">12</a>
</span><span class="lnt" id="hl-32-13"><a class="lnlinks" href="#hl-32-13">13</a>
</span><span class="lnt" id="hl-32-14"><a class="lnlinks" href="#hl-32-14">14</a>
</span><span class="lnt" id="hl-32-15"><a class="lnlinks" href="#hl-32-15">15</a>
</span><span class="lnt" id="hl-32-16"><a class="lnlinks" href="#hl-32-16">16</a>
</span><span class="lnt" id="hl-32-17"><a class="lnlinks" href="#hl-32-17">17</a>
</span><span class="lnt" id="hl-32-18"><a class="lnlinks" href="#hl-32-18">18</a>
</span><span class="lnt" id="hl-32-19"><a class="lnlinks" href="#hl-32-19">19</a>
</span><span class="lnt" id="hl-32-20"><a class="lnlinks" href="#hl-32-20">20</a>
</span><span class="lnt" id="hl-32-21"><a class="lnlinks" href="#hl-32-21">21</a>
</span><span class="lnt" id="hl-32-22"><a class="lnlinks" href="#hl-32-22">22</a>
</span><span class="lnt" id="hl-32-23"><a class="lnlinks" href="#hl-32-23">23</a>
</span><span class="lnt" id="hl-32-24"><a class="lnlinks" href="#hl-32-24">24</a>
</span><span class="lnt" id="hl-32-25"><a class="lnlinks" href="#hl-32-25">25</a>
</span><span class="lnt" id="hl-32-26"><a class="lnlinks" href="#hl-32-26">26</a>
</span><span class="lnt" id="hl-32-27"><a class="lnlinks" href="#hl-32-27">27</a>
</span><span class="lnt" id="hl-32-28"><a class="lnlinks" href="#hl-32-28">28</a>
</span><span class="lnt" id="hl-32-29"><a class="lnlinks" href="#hl-32-29">29</a>
</span><span class="lnt" id="hl-32-30"><a class="lnlinks" href="#hl-32-30">30</a>
</span><span class="lnt" id="hl-32-31"><a class="lnlinks" href="#hl-32-31">31</a>
</span><span class="lnt" id="hl-32-32"><a class="lnlinks" href="#hl-32-32">32</a>
</span><span class="lnt" id="hl-32-33"><a class="lnlinks" href="#hl-32-33">33</a>
</span><span class="lnt" id="hl-32-34"><a class="lnlinks" href="#hl-32-34">34</a>
</span><span class="lnt" id="hl-32-35"><a class="lnlinks" href="#hl-32-35">35</a>
</span><span class="lnt" id="hl-32-36"><a class="lnlinks" href="#hl-32-36">36</a>
</span><span class="lnt" id="hl-32-37"><a class="lnlinks" href="#hl-32-37">37</a>
</span><span class="lnt" id="hl-32-38"><a class="lnlinks" href="#hl-32-38">38</a>
</span><span class="lnt" id="hl-32-39"><a class="lnlinks" href="#hl-32-39">39</a>
</span><span class="lnt" id="hl-32-40"><a class="lnlinks" href="#hl-32-40">40</a>
</span><span class="lnt" id="hl-32-41"><a class="lnlinks" href="#hl-32-41">41</a>
</span><span class="lnt" id="hl-32-42"><a class="lnlinks" href="#hl-32-42">42</a>
</span><span class="lnt" id="hl-32-43"><a class="lnlinks" href="#hl-32-43">43</a>
</span><span class="lnt" id="hl-32-44"><a class="lnlinks" href="#hl-32-44">44</a>
</span><span class="lnt" id="hl-32-45"><a class="lnlinks" href="#hl-32-45">45</a>
</span><span class="lnt" id="hl-32-46"><a class="lnlinks" href="#hl-32-46">46</a>
</span><span class="lnt" id="hl-32-47"><a class="lnlinks" href="#hl-32-47">47</a>
</span><span class="lnt" id="hl-32-48"><a class="lnlinks" href="#hl-32-48">48</a>
</span><span class="lnt" id="hl-32-49"><a class="lnlinks" href="#hl-32-49">49</a>
</span><span class="lnt" id="hl-32-50"><a class="lnlinks" href="#hl-32-50">50</a>
</span><span class="lnt" id="hl-32-51"><a class="lnlinks" href="#hl-32-51">51</a>
</span><span class="lnt" id="hl-32-52"><a class="lnlinks" href="#hl-32-52">52</a>
</span><span class="lnt" id="hl-32-53"><a class="lnlinks" href="#hl-32-53">53</a>
</span><span class="lnt" id="hl-32-54"><a class="lnlinks" href="#hl-32-54">54</a>
</span><span class="lnt" id="hl-32-55"><a class="lnlinks" href="#hl-32-55">55</a>
</span><span class="lnt" id="hl-32-56"><a class="lnlinks" href="#hl-32-56">56</a>
</span><span class="lnt" id="hl-32-57"><a class="lnlinks" href="#hl-32-57">57</a>
</span><span class="lnt" id="hl-32-58"><a class="lnlinks" href="#hl-32-58">58</a>
</span><span class="lnt" id="hl-32-59"><a class="lnlinks" href="#hl-32-59">59</a>
</span><span class="lnt" id="hl-32-60"><a class="lnlinks" href="#hl-32-60">60</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="err">所有容器都有</span><span class="n">size</span><span class="p">()</span> <span class="n">empty</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl"><span class="n">vector</span><span class="p">,</span> <span class="err">变长数组，倍增的思想</span>
</span></span><span class="line"><span class="cl">    <span class="n">size</span><span class="p">()</span>  <span class="err">返回元素个数</span>
</span></span><span class="line"><span class="cl">    <span class="n">empty</span><span class="p">()</span>  <span class="err">返回是否为空</span>
</span></span><span class="line"><span class="cl">    <span class="n">clear</span><span class="p">()</span>  <span class="err">清空</span>
</span></span><span class="line"><span class="cl">    <span class="n">front</span><span class="p">()</span><span class="o">/</span><span class="n">back</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">push_back</span><span class="p">()</span><span class="o">/</span><span class="n">pop_back</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">begin</span><span class="p">()</span><span class="o">/</span><span class="n">end</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="err">支持比较运算，按字典序</span>
</span></span><span class="line"><span class="cl">    <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">a</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">a</span><span class="p">.</span><span class="n">empty</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="n">first</span><span class="p">,</span> <span class="err">第一个元素</span>
</span></span><span class="line"><span class="cl">    <span class="n">second</span><span class="p">,</span> <span class="err">第二个元素</span>
</span></span><span class="line"><span class="cl">    <span class="err">支持比较运算，以</span><span class="n">first为第一关键字</span><span class="err">，以</span><span class="n">second为第二关键字</span><span class="err">（字典序）</span>
</span></span><span class="line"><span class="cl">	<span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">p</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="n">p</span><span class="o">=</span><span class="n">make_pair</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">p</span><span class="o">=</span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="n">string</span><span class="err">，字符串</span>
</span></span><span class="line"><span class="cl">    <span class="n">size</span><span class="p">()</span><span class="o">/</span><span class="n">length</span><span class="p">()</span>  <span class="err">返回字符串长度</span>
</span></span><span class="line"><span class="cl">    <span class="n">empty</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">clear</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">substr</span><span class="p">(</span><span class="err">起始下标，</span><span class="p">(</span><span class="err">子串长度</span><span class="p">))</span>  <span class="err">返回子串</span>
</span></span><span class="line"><span class="cl">    <span class="n">c_str</span><span class="p">()</span>  <span class="err">返回字符串所在字符数组的起始地址</span>
</span></span><span class="line"><span class="cl">        <span class="n">strcpy</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">s</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span><span class="c1">//c_str()的使用方法
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="n">queue</span><span class="p">,</span> <span class="err">队列</span>
</span></span><span class="line"><span class="cl">    <span class="err">没有</span><span class="n">clear函数</span>
</span></span><span class="line"><span class="cl">    <span class="err">清空用新建</span><span class="n">queue</span>
</span></span><span class="line"><span class="cl">    <span class="n">size</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">empty</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">push</span><span class="p">()</span>  <span class="err">向队尾插入一个元素</span>
</span></span><span class="line"><span class="cl">    <span class="n">front</span><span class="p">()</span>  <span class="err">返回队头元素</span>
</span></span><span class="line"><span class="cl">    <span class="n">back</span><span class="p">()</span>  <span class="err">返回队尾元素</span>
</span></span><span class="line"><span class="cl">    <span class="n">pop</span><span class="p">()</span>  <span class="err">弹出队头元素</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">priority_queue</span><span class="p">,</span> <span class="err">优先队列，默认是大根堆</span>
</span></span><span class="line"><span class="cl">    <span class="n">push</span><span class="p">()</span>  <span class="err">插入一个元素</span>
</span></span><span class="line"><span class="cl">    <span class="n">top</span><span class="p">()</span>  <span class="err">返回堆顶元素</span>
</span></span><span class="line"><span class="cl">    <span class="n">pop</span><span class="p">()</span>  <span class="err">弹出堆顶元素</span>
</span></span><span class="line"><span class="cl">    <span class="err">定义成小根堆的方式：</span><span class="n">priority_queue</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">greater</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&gt;</span> <span class="n">q</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">stack</span><span class="p">,</span> <span class="err">栈</span>
</span></span><span class="line"><span class="cl">    <span class="n">size</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">empty</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">push</span><span class="p">()</span>  <span class="err">向栈顶插入一个元素</span>
</span></span><span class="line"><span class="cl">    <span class="n">top</span><span class="p">()</span>  <span class="err">返回栈顶元素</span>
</span></span><span class="line"><span class="cl">    <span class="n">pop</span><span class="p">()</span>  <span class="err">弹出栈顶元素</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">deque</span><span class="p">,</span> <span class="err">双端队列</span>
</span></span><span class="line"><span class="cl">    <span class="n">size</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">empty</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">clear</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">front</span><span class="p">()</span><span class="o">/</span><span class="n">back</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">push_back</span><span class="p">()</span><span class="o">/</span><span class="n">pop_back</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">push_front</span><span class="p">()</span><span class="o">/</span><span class="n">pop_front</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">begin</span><span class="p">()</span><span class="o">/</span><span class="n">end</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">[]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-33-1"><a class="lnlinks" href="#hl-33-1"> 1</a>
</span><span class="lnt" id="hl-33-2"><a class="lnlinks" href="#hl-33-2"> 2</a>
</span><span class="lnt" id="hl-33-3"><a class="lnlinks" href="#hl-33-3"> 3</a>
</span><span class="lnt" id="hl-33-4"><a class="lnlinks" href="#hl-33-4"> 4</a>
</span><span class="lnt" id="hl-33-5"><a class="lnlinks" href="#hl-33-5"> 5</a>
</span><span class="lnt" id="hl-33-6"><a class="lnlinks" href="#hl-33-6"> 6</a>
</span><span class="lnt" id="hl-33-7"><a class="lnlinks" href="#hl-33-7"> 7</a>
</span><span class="lnt" id="hl-33-8"><a class="lnlinks" href="#hl-33-8"> 8</a>
</span><span class="lnt" id="hl-33-9"><a class="lnlinks" href="#hl-33-9"> 9</a>
</span><span class="lnt" id="hl-33-10"><a class="lnlinks" href="#hl-33-10">10</a>
</span><span class="lnt" id="hl-33-11"><a class="lnlinks" href="#hl-33-11">11</a>
</span><span class="lnt" id="hl-33-12"><a class="lnlinks" href="#hl-33-12">12</a>
</span><span class="lnt" id="hl-33-13"><a class="lnlinks" href="#hl-33-13">13</a>
</span><span class="lnt" id="hl-33-14"><a class="lnlinks" href="#hl-33-14">14</a>
</span><span class="lnt" id="hl-33-15"><a class="lnlinks" href="#hl-33-15">15</a>
</span><span class="lnt" id="hl-33-16"><a class="lnlinks" href="#hl-33-16">16</a>
</span><span class="lnt" id="hl-33-17"><a class="lnlinks" href="#hl-33-17">17</a>
</span><span class="lnt" id="hl-33-18"><a class="lnlinks" href="#hl-33-18">18</a>
</span><span class="lnt" id="hl-33-19"><a class="lnlinks" href="#hl-33-19">19</a>
</span><span class="lnt" id="hl-33-20"><a class="lnlinks" href="#hl-33-20">20</a>
</span><span class="lnt" id="hl-33-21"><a class="lnlinks" href="#hl-33-21">21</a>
</span><span class="lnt" id="hl-33-22"><a class="lnlinks" href="#hl-33-22">22</a>
</span><span class="lnt" id="hl-33-23"><a class="lnlinks" href="#hl-33-23">23</a>
</span><span class="lnt" id="hl-33-24"><a class="lnlinks" href="#hl-33-24">24</a>
</span><span class="lnt" id="hl-33-25"><a class="lnlinks" href="#hl-33-25">25</a>
</span><span class="lnt" id="hl-33-26"><a class="lnlinks" href="#hl-33-26">26</a>
</span><span class="lnt" id="hl-33-27"><a class="lnlinks" href="#hl-33-27">27</a>
</span><span class="lnt" id="hl-33-28"><a class="lnlinks" href="#hl-33-28">28</a>
</span><span class="lnt" id="hl-33-29"><a class="lnlinks" href="#hl-33-29">29</a>
</span><span class="lnt" id="hl-33-30"><a class="lnlinks" href="#hl-33-30">30</a>
</span><span class="lnt" id="hl-33-31"><a class="lnlinks" href="#hl-33-31">31</a>
</span><span class="lnt" id="hl-33-32"><a class="lnlinks" href="#hl-33-32">32</a>
</span><span class="lnt" id="hl-33-33"><a class="lnlinks" href="#hl-33-33">33</a>
</span><span class="lnt" id="hl-33-34"><a class="lnlinks" href="#hl-33-34">34</a>
</span><span class="lnt" id="hl-33-35"><a class="lnlinks" href="#hl-33-35">35</a>
</span><span class="lnt" id="hl-33-36"><a class="lnlinks" href="#hl-33-36">36</a>
</span><span class="lnt" id="hl-33-37"><a class="lnlinks" href="#hl-33-37">37</a>
</span><span class="lnt" id="hl-33-38"><a class="lnlinks" href="#hl-33-38">38</a>
</span><span class="lnt" id="hl-33-39"><a class="lnlinks" href="#hl-33-39">39</a>
</span><span class="lnt" id="hl-33-40"><a class="lnlinks" href="#hl-33-40">40</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="n">set</span><span class="p">,</span> <span class="n">map</span><span class="p">,</span> <span class="n">multiset</span><span class="p">,</span> <span class="n">multimap</span><span class="p">,</span> <span class="err">基于平衡二叉树（红黑树），动态维护有序序列</span>
</span></span><span class="line"><span class="cl">    <span class="n">size</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">empty</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">clear</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">begin</span><span class="p">()</span><span class="o">/</span><span class="n">end</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="o">++</span><span class="p">,</span> <span class="o">--</span> <span class="err">返回前驱和后继，时间复杂度</span> <span class="n">O</span><span class="p">(</span><span class="n">logn</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">set</span><span class="o">/</span><span class="n">multiset</span>
</span></span><span class="line"><span class="cl">    <span class="n">insert</span><span class="p">()</span>  <span class="err">插入一个数</span>
</span></span><span class="line"><span class="cl">    <span class="n">find</span><span class="p">()</span>  <span class="err">查找一个数</span>
</span></span><span class="line"><span class="cl">    <span class="n">count</span><span class="p">()</span>  <span class="err">返回某一个数的个数</span>
</span></span><span class="line"><span class="cl">    <span class="n">erase</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="err">输入是一个数</span><span class="n">x</span><span class="err">，删除所有</span><span class="n">x</span>   <span class="n">O</span><span class="p">(</span><span class="n">k</span> <span class="o">+</span> <span class="n">logn</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="err">输入一个迭代器，删除这个迭代器</span>
</span></span><span class="line"><span class="cl">    <span class="n">lower_bound</span><span class="p">()</span><span class="o">/</span><span class="n">upper_bound</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="n">lower_bound</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="err">返回大于等于</span><span class="n">x的最小的数的迭代器</span>
</span></span><span class="line"><span class="cl">        <span class="n">upper_bound</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="err">返回大于</span><span class="n">x的最小的数的迭代器</span>
</span></span><span class="line"><span class="cl"><span class="n">map</span><span class="o">/</span><span class="n">multimap</span>
</span></span><span class="line"><span class="cl">    <span class="n">insert</span><span class="p">()</span>  <span class="err">插入的数是一个</span><span class="n">pair</span>
</span></span><span class="line"><span class="cl">    <span class="n">erase</span><span class="p">()</span>  <span class="err">输入的参数是</span><span class="n">pair或者迭代器</span>
</span></span><span class="line"><span class="cl">    <span class="n">find</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">[]</span>  <span class="err">注意</span><span class="n">multimap不支持此操作</span><span class="err">。</span> <span class="err">时间复杂度是</span> <span class="n">O</span><span class="p">(</span><span class="n">logn</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">lower_bound</span><span class="p">()</span><span class="o">/</span><span class="n">upper_bound</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl"><span class="n">unordered_set</span><span class="p">,</span> <span class="n">unordered_map</span><span class="p">,</span> <span class="n">unordered_multiset</span><span class="p">,</span> <span class="n">unordered_multimap</span><span class="p">,</span> <span class="err">哈希表</span>
</span></span><span class="line"><span class="cl">    <span class="err">和上面类似，增删改查的时间复杂度是</span> <span class="n">O</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="err">不支持</span> <span class="n">lower_bound</span><span class="p">()</span><span class="o">/</span><span class="n">upper_bound</span><span class="p">()</span><span class="err">，</span> <span class="err">迭代器的</span><span class="o">++</span><span class="err">，</span><span class="o">--</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">bitset</span><span class="p">,</span> <span class="err">圧位</span>
</span></span><span class="line"><span class="cl">    <span class="n">bitset</span><span class="o">&lt;</span><span class="mi">10000</span><span class="o">&gt;</span> <span class="n">s</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">~</span><span class="p">,</span> <span class="o">&amp;</span><span class="p">,</span> <span class="o">|</span><span class="p">,</span> <span class="o">^</span>
</span></span><span class="line"><span class="cl">    <span class="o">&gt;&gt;</span><span class="p">,</span> <span class="o">&lt;&lt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">==</span><span class="p">,</span> <span class="o">!=</span>
</span></span><span class="line"><span class="cl">    <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="n">count</span><span class="p">()</span>  <span class="err">返回有多少个</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="n">none</span><span class="p">()</span>  <span class="err">判断是否全为</span><span class="mi">0</span>     <span class="n">any</span><span class="p">()</span>  <span class="err">判断是否至少有一个</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="n">set</span><span class="p">()</span>  <span class="err">把所有位置成</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="n">set</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>  <span class="err">将第</span><span class="n">k位变成v</span>
</span></span><span class="line"><span class="cl">    <span class="n">reset</span><span class="p">()</span>  <span class="err">把所有位变成</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="n">flip</span><span class="p">()</span>  <span class="err">等价于</span><span class="o">~</span>
</span></span><span class="line"><span class="cl">    <span class="n">flip</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="err">把第</span><span class="n">k位取反</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>作者：yxc
链接：https://www.acwing.com/blog/content/404/
来源：AcWing
著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。</p>
<h2 id="第三章">第三章<a hidden class="anchor" aria-hidden="true" href="#第三章">#</a></h2>
<h3 id="树与图的存储">树与图的存储<a hidden class="anchor" aria-hidden="true" href="#树与图的存储">#</a></h3>
<p><strong>树是一种特殊的图: 无环连通图</strong>，与图的存储方式相同。
对于无向图中的边ab，存储两条有向边a-&gt;b, b-&gt;a。
因此我们可以只考虑有向图的存储。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-34-1"><a class="lnlinks" href="#hl-34-1"> 1</a>
</span><span class="lnt" id="hl-34-2"><a class="lnlinks" href="#hl-34-2"> 2</a>
</span><span class="lnt" id="hl-34-3"><a class="lnlinks" href="#hl-34-3"> 3</a>
</span><span class="lnt" id="hl-34-4"><a class="lnlinks" href="#hl-34-4"> 4</a>
</span><span class="lnt" id="hl-34-5"><a class="lnlinks" href="#hl-34-5"> 5</a>
</span><span class="lnt" id="hl-34-6"><a class="lnlinks" href="#hl-34-6"> 6</a>
</span><span class="lnt" id="hl-34-7"><a class="lnlinks" href="#hl-34-7"> 7</a>
</span><span class="lnt" id="hl-34-8"><a class="lnlinks" href="#hl-34-8"> 8</a>
</span><span class="lnt" id="hl-34-9"><a class="lnlinks" href="#hl-34-9"> 9</a>
</span><span class="lnt" id="hl-34-10"><a class="lnlinks" href="#hl-34-10">10</a>
</span><span class="lnt" id="hl-34-11"><a class="lnlinks" href="#hl-34-11">11</a>
</span><span class="lnt" id="hl-34-12"><a class="lnlinks" href="#hl-34-12">12</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="err">邻接矩阵：</span><span class="n">g</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">b</span><span class="p">]</span> <span class="err">存储边</span><span class="n">a</span><span class="o">-&gt;</span><span class="n">b</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="err">邻接表：</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 对于每个点k，开一个单链表，存储k所有可以走到的点。h[k]存储这个单链表的头结点
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="n">h</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">ne</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">idx</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 添加一条边a-&gt;b
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">void</span> <span class="nf">add</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="kt">int</span> <span class="n">b</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">e</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span><span class="p">,</span> <span class="n">ne</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">h</span><span class="p">[</span><span class="n">a</span><span class="p">],</span> <span class="n">h</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">idx</span> <span class="o">++</span> <span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 初始化
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">memset</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="k">sizeof</span> <span class="n">h</span><span class="p">);</span> 
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="树与图的遍历">树与图的遍历<a hidden class="anchor" aria-hidden="true" href="#树与图的遍历">#</a></h3>
<p>时间复杂度 O(n+m)O(n+m), nn 表示点数，mm 表示边数</p>
<h4 id="1-深度优先遍历--模板题-acwing-846-树的重心">(1) 深度优先遍历 —— 模板题 AcWing 846. 树的重心<a hidden class="anchor" aria-hidden="true" href="#1-深度优先遍历--模板题-acwing-846-树的重心">#</a></h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-35-1"><a class="lnlinks" href="#hl-35-1">1</a>
</span><span class="lnt" id="hl-35-2"><a class="lnlinks" href="#hl-35-2">2</a>
</span><span class="lnt" id="hl-35-3"><a class="lnlinks" href="#hl-35-3">3</a>
</span><span class="lnt" id="hl-35-4"><a class="lnlinks" href="#hl-35-4">4</a>
</span><span class="lnt" id="hl-35-5"><a class="lnlinks" href="#hl-35-5">5</a>
</span><span class="lnt" id="hl-35-6"><a class="lnlinks" href="#hl-35-6">6</a>
</span><span class="lnt" id="hl-35-7"><a class="lnlinks" href="#hl-35-7">7</a>
</span><span class="lnt" id="hl-35-8"><a class="lnlinks" href="#hl-35-8">8</a>
</span><span class="lnt" id="hl-35-9"><a class="lnlinks" href="#hl-35-9">9</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">dfs</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">st</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span> <span class="c1">// st[u] 表示点u已经被遍历过
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">h</span><span class="p">[</span><span class="n">u</span><span class="p">];</span> <span class="n">i</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">=</span> <span class="n">ne</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">st</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="n">dfs</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="2-宽度优先遍历--模板题-acwing-847-图中点的层次">(2) 宽度优先遍历 —— 模板题 AcWing 847. 图中点的层次<a hidden class="anchor" aria-hidden="true" href="#2-宽度优先遍历--模板题-acwing-847-图中点的层次">#</a></h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-36-1"><a class="lnlinks" href="#hl-36-1"> 1</a>
</span><span class="lnt" id="hl-36-2"><a class="lnlinks" href="#hl-36-2"> 2</a>
</span><span class="lnt" id="hl-36-3"><a class="lnlinks" href="#hl-36-3"> 3</a>
</span><span class="lnt" id="hl-36-4"><a class="lnlinks" href="#hl-36-4"> 4</a>
</span><span class="lnt" id="hl-36-5"><a class="lnlinks" href="#hl-36-5"> 5</a>
</span><span class="lnt" id="hl-36-6"><a class="lnlinks" href="#hl-36-6"> 6</a>
</span><span class="lnt" id="hl-36-7"><a class="lnlinks" href="#hl-36-7"> 7</a>
</span><span class="lnt" id="hl-36-8"><a class="lnlinks" href="#hl-36-8"> 8</a>
</span><span class="lnt" id="hl-36-9"><a class="lnlinks" href="#hl-36-9"> 9</a>
</span><span class="lnt" id="hl-36-10"><a class="lnlinks" href="#hl-36-10">10</a>
</span><span class="lnt" id="hl-36-11"><a class="lnlinks" href="#hl-36-11">11</a>
</span><span class="lnt" id="hl-36-12"><a class="lnlinks" href="#hl-36-12">12</a>
</span><span class="lnt" id="hl-36-13"><a class="lnlinks" href="#hl-36-13">13</a>
</span><span class="lnt" id="hl-36-14"><a class="lnlinks" href="#hl-36-14">14</a>
</span><span class="lnt" id="hl-36-15"><a class="lnlinks" href="#hl-36-15">15</a>
</span><span class="lnt" id="hl-36-16"><a class="lnlinks" href="#hl-36-16">16</a>
</span><span class="lnt" id="hl-36-17"><a class="lnlinks" href="#hl-36-17">17</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="n">queue</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">q</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">st</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span> <span class="c1">// 表示1号点已经被遍历过
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">while</span> <span class="p">(</span><span class="n">q</span><span class="p">.</span><span class="n">size</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">t</span> <span class="o">=</span> <span class="n">q</span><span class="p">.</span><span class="n">front</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="n">q</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">h</span><span class="p">[</span><span class="n">t</span><span class="p">];</span> <span class="n">i</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">=</span> <span class="n">ne</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">st</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">st</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span> <span class="c1">// 表示点j已经被遍历过
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="拓扑排序--模板题-acwing-848-有向图的拓扑序列">拓扑排序 —— 模板题 AcWing 848. 有向图的拓扑序列<a hidden class="anchor" aria-hidden="true" href="#拓扑排序--模板题-acwing-848-有向图的拓扑序列">#</a></h3>
<p>时间复杂度 O(n+m)O(n+m), nn 表示点数，mm 表示边数</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-37-1"><a class="lnlinks" href="#hl-37-1"> 1</a>
</span><span class="lnt" id="hl-37-2"><a class="lnlinks" href="#hl-37-2"> 2</a>
</span><span class="lnt" id="hl-37-3"><a class="lnlinks" href="#hl-37-3"> 3</a>
</span><span class="lnt" id="hl-37-4"><a class="lnlinks" href="#hl-37-4"> 4</a>
</span><span class="lnt" id="hl-37-5"><a class="lnlinks" href="#hl-37-5"> 5</a>
</span><span class="lnt" id="hl-37-6"><a class="lnlinks" href="#hl-37-6"> 6</a>
</span><span class="lnt" id="hl-37-7"><a class="lnlinks" href="#hl-37-7"> 7</a>
</span><span class="lnt" id="hl-37-8"><a class="lnlinks" href="#hl-37-8"> 8</a>
</span><span class="lnt" id="hl-37-9"><a class="lnlinks" href="#hl-37-9"> 9</a>
</span><span class="lnt" id="hl-37-10"><a class="lnlinks" href="#hl-37-10">10</a>
</span><span class="lnt" id="hl-37-11"><a class="lnlinks" href="#hl-37-11">11</a>
</span><span class="lnt" id="hl-37-12"><a class="lnlinks" href="#hl-37-12">12</a>
</span><span class="lnt" id="hl-37-13"><a class="lnlinks" href="#hl-37-13">13</a>
</span><span class="lnt" id="hl-37-14"><a class="lnlinks" href="#hl-37-14">14</a>
</span><span class="lnt" id="hl-37-15"><a class="lnlinks" href="#hl-37-15">15</a>
</span><span class="lnt" id="hl-37-16"><a class="lnlinks" href="#hl-37-16">16</a>
</span><span class="lnt" id="hl-37-17"><a class="lnlinks" href="#hl-37-17">17</a>
</span><span class="lnt" id="hl-37-18"><a class="lnlinks" href="#hl-37-18">18</a>
</span><span class="lnt" id="hl-37-19"><a class="lnlinks" href="#hl-37-19">19</a>
</span><span class="lnt" id="hl-37-20"><a class="lnlinks" href="#hl-37-20">20</a>
</span><span class="lnt" id="hl-37-21"><a class="lnlinks" href="#hl-37-21">21</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">bool</span> <span class="nf">topsort</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">hh</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">tt</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// d[i] 存储点i的入度
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span> <span class="o">++</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">            <span class="n">q</span><span class="p">[</span> <span class="o">++</span> <span class="n">tt</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">hh</span> <span class="o">&lt;=</span> <span class="n">tt</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">t</span> <span class="o">=</span> <span class="n">q</span><span class="p">[</span><span class="n">hh</span> <span class="o">++</span> <span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">h</span><span class="p">[</span><span class="n">t</span><span class="p">];</span> <span class="n">i</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">=</span> <span class="n">ne</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="o">--</span> <span class="n">d</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">q</span><span class="p">[</span> <span class="o">++</span> <span class="n">tt</span><span class="p">]</span> <span class="o">=</span> <span class="n">j</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 如果所有点都入队了，说明存在拓扑序列；否则不存在拓扑序列。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">return</span> <span class="n">tt</span> <span class="o">==</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="最短路">最短路<a hidden class="anchor" aria-hidden="true" href="#最短路">#</a></h3>
<p>单源最短路</p>
<p>所有边权均为正：朴素Dijkstra O(n^2)；堆优化版的Dijkstra(mlogn)</p>
<p>存在负权变：Bellman-Ford O(nm) ； SPFA（队列优化Bellman-Ford) 一般：O(m) 最坏 O(nm)</p>
<p>多元汇最短路：Floyed算法 O(n^3)</p>
<h3 id="朴素dijkstra算法--模板题-acwing-849-dijkstra求最短路-i-基于贪心">朴素dijkstra算法 —— 模板题 AcWing 849. Dijkstra求最短路 I 基于贪心<a hidden class="anchor" aria-hidden="true" href="#朴素dijkstra算法--模板题-acwing-849-dijkstra求最短路-i-基于贪心">#</a></h3>
<p>时间复杂是 O(n^2+m), n 表示点数，m 表示边数</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-38-1"><a class="lnlinks" href="#hl-38-1"> 1</a>
</span><span class="lnt" id="hl-38-2"><a class="lnlinks" href="#hl-38-2"> 2</a>
</span><span class="lnt" id="hl-38-3"><a class="lnlinks" href="#hl-38-3"> 3</a>
</span><span class="lnt" id="hl-38-4"><a class="lnlinks" href="#hl-38-4"> 4</a>
</span><span class="lnt" id="hl-38-5"><a class="lnlinks" href="#hl-38-5"> 5</a>
</span><span class="lnt" id="hl-38-6"><a class="lnlinks" href="#hl-38-6"> 6</a>
</span><span class="lnt" id="hl-38-7"><a class="lnlinks" href="#hl-38-7"> 7</a>
</span><span class="lnt" id="hl-38-8"><a class="lnlinks" href="#hl-38-8"> 8</a>
</span><span class="lnt" id="hl-38-9"><a class="lnlinks" href="#hl-38-9"> 9</a>
</span><span class="lnt" id="hl-38-10"><a class="lnlinks" href="#hl-38-10">10</a>
</span><span class="lnt" id="hl-38-11"><a class="lnlinks" href="#hl-38-11">11</a>
</span><span class="lnt" id="hl-38-12"><a class="lnlinks" href="#hl-38-12">12</a>
</span><span class="lnt" id="hl-38-13"><a class="lnlinks" href="#hl-38-13">13</a>
</span><span class="lnt" id="hl-38-14"><a class="lnlinks" href="#hl-38-14">14</a>
</span><span class="lnt" id="hl-38-15"><a class="lnlinks" href="#hl-38-15">15</a>
</span><span class="lnt" id="hl-38-16"><a class="lnlinks" href="#hl-38-16">16</a>
</span><span class="lnt" id="hl-38-17"><a class="lnlinks" href="#hl-38-17">17</a>
</span><span class="lnt" id="hl-38-18"><a class="lnlinks" href="#hl-38-18">18</a>
</span><span class="lnt" id="hl-38-19"><a class="lnlinks" href="#hl-38-19">19</a>
</span><span class="lnt" id="hl-38-20"><a class="lnlinks" href="#hl-38-20">20</a>
</span><span class="lnt" id="hl-38-21"><a class="lnlinks" href="#hl-38-21">21</a>
</span><span class="lnt" id="hl-38-22"><a class="lnlinks" href="#hl-38-22">22</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">g</span><span class="p">[</span><span class="n">N</span><span class="p">][</span><span class="n">N</span><span class="p">];</span>  <span class="c1">// 存储每条边，
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="n">dist</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>  <span class="c1">// 存储1号点到每个点的最短距离
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">bool</span> <span class="n">st</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>   <span class="c1">// 存储每个点的最短路是否已经确定
</span></span></span><span class="line"><span class="cl"><span class="c1">// 求1号点到n号点的最短路，如果不存在则返回-1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="nf">dijkstra</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">memset</span><span class="p">(</span><span class="n">dist</span><span class="p">,</span> <span class="mh">0x3f</span><span class="p">,</span> <span class="k">sizeof</span> <span class="n">dist</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">dist</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">++</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">t</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>     <span class="c1">// 在还未确定最短路的点中，寻找距离最小的点
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">j</span> <span class="o">++</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">st</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">t</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="o">||</span> <span class="n">dist</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">dist</span><span class="p">[</span><span class="n">j</span><span class="p">]))</span>
</span></span><span class="line"><span class="cl">                <span class="n">t</span> <span class="o">=</span> <span class="n">j</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 用t更新其他点的距离
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">j</span> <span class="o">++</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">dist</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">min</span><span class="p">(</span><span class="n">dist</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">dist</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">g</span><span class="p">[</span><span class="n">t</span><span class="p">][</span><span class="n">j</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">        <span class="n">st</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">dist</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">==</span> <span class="mh">0x3f3f3f3f</span><span class="p">)</span> <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">dist</span><span class="p">[</span><span class="n">n</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="堆优化版dijkstra--模板题-acwing-850-dijkstra求最短路-ii">堆优化版dijkstra —— 模板题 AcWing 850. Dijkstra求最短路 II<a hidden class="anchor" aria-hidden="true" href="#堆优化版dijkstra--模板题-acwing-850-dijkstra求最短路-ii">#</a></h3>
<p>时间复杂度 O(mlogn), n 表示点数，m 表示边数</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-39-1"><a class="lnlinks" href="#hl-39-1"> 1</a>
</span><span class="lnt" id="hl-39-2"><a class="lnlinks" href="#hl-39-2"> 2</a>
</span><span class="lnt" id="hl-39-3"><a class="lnlinks" href="#hl-39-3"> 3</a>
</span><span class="lnt" id="hl-39-4"><a class="lnlinks" href="#hl-39-4"> 4</a>
</span><span class="lnt" id="hl-39-5"><a class="lnlinks" href="#hl-39-5"> 5</a>
</span><span class="lnt" id="hl-39-6"><a class="lnlinks" href="#hl-39-6"> 6</a>
</span><span class="lnt" id="hl-39-7"><a class="lnlinks" href="#hl-39-7"> 7</a>
</span><span class="lnt" id="hl-39-8"><a class="lnlinks" href="#hl-39-8"> 8</a>
</span><span class="lnt" id="hl-39-9"><a class="lnlinks" href="#hl-39-9"> 9</a>
</span><span class="lnt" id="hl-39-10"><a class="lnlinks" href="#hl-39-10">10</a>
</span><span class="lnt" id="hl-39-11"><a class="lnlinks" href="#hl-39-11">11</a>
</span><span class="lnt" id="hl-39-12"><a class="lnlinks" href="#hl-39-12">12</a>
</span><span class="lnt" id="hl-39-13"><a class="lnlinks" href="#hl-39-13">13</a>
</span><span class="lnt" id="hl-39-14"><a class="lnlinks" href="#hl-39-14">14</a>
</span><span class="lnt" id="hl-39-15"><a class="lnlinks" href="#hl-39-15">15</a>
</span><span class="lnt" id="hl-39-16"><a class="lnlinks" href="#hl-39-16">16</a>
</span><span class="lnt" id="hl-39-17"><a class="lnlinks" href="#hl-39-17">17</a>
</span><span class="lnt" id="hl-39-18"><a class="lnlinks" href="#hl-39-18">18</a>
</span><span class="lnt" id="hl-39-19"><a class="lnlinks" href="#hl-39-19">19</a>
</span><span class="lnt" id="hl-39-20"><a class="lnlinks" href="#hl-39-20">20</a>
</span><span class="lnt" id="hl-39-21"><a class="lnlinks" href="#hl-39-21">21</a>
</span><span class="lnt" id="hl-39-22"><a class="lnlinks" href="#hl-39-22">22</a>
</span><span class="lnt" id="hl-39-23"><a class="lnlinks" href="#hl-39-23">23</a>
</span><span class="lnt" id="hl-39-24"><a class="lnlinks" href="#hl-39-24">24</a>
</span><span class="lnt" id="hl-39-25"><a class="lnlinks" href="#hl-39-25">25</a>
</span><span class="lnt" id="hl-39-26"><a class="lnlinks" href="#hl-39-26">26</a>
</span><span class="lnt" id="hl-39-27"><a class="lnlinks" href="#hl-39-27">27</a>
</span><span class="lnt" id="hl-39-28"><a class="lnlinks" href="#hl-39-28">28</a>
</span><span class="lnt" id="hl-39-29"><a class="lnlinks" href="#hl-39-29">29</a>
</span><span class="lnt" id="hl-39-30"><a class="lnlinks" href="#hl-39-30">30</a>
</span><span class="lnt" id="hl-39-31"><a class="lnlinks" href="#hl-39-31">31</a>
</span><span class="lnt" id="hl-39-32"><a class="lnlinks" href="#hl-39-32">32</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">typedef</span> <span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;</span> <span class="n">PII</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">n</span><span class="p">;</span>      <span class="c1">// 点的数量
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="n">h</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">w</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">ne</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">idx</span><span class="p">;</span>       <span class="c1">// 邻接表存储所有边
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="n">dist</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>        <span class="c1">// 存储所有点到1号点的距离
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">bool</span> <span class="n">st</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>     <span class="c1">// 存储每个点的最短距离是否已确定
</span></span></span><span class="line"><span class="cl"><span class="c1">// 求1号点到n号点的最短距离，如果不存在，则返回-1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="nf">dijkstra</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">memset</span><span class="p">(</span><span class="n">dist</span><span class="p">,</span> <span class="mh">0x3f</span><span class="p">,</span> <span class="k">sizeof</span> <span class="n">dist</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">dist</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">priority_queue</span><span class="o">&lt;</span><span class="n">PII</span><span class="p">,</span> <span class="n">vector</span><span class="o">&lt;</span><span class="n">PII</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">greater</span><span class="o">&lt;</span><span class="n">PII</span><span class="o">&gt;&gt;</span> <span class="n">heap</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">heap</span><span class="p">.</span><span class="n">push</span><span class="p">({</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">});</span>      <span class="c1">// first存储距离，second存储节点编号
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">while</span> <span class="p">(</span><span class="n">heap</span><span class="p">.</span><span class="n">size</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">auto</span> <span class="n">t</span> <span class="o">=</span> <span class="n">heap</span><span class="p">.</span><span class="n">top</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">heap</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">ver</span> <span class="o">=</span> <span class="n">t</span><span class="p">.</span><span class="n">second</span><span class="p">,</span> <span class="n">distance</span> <span class="o">=</span> <span class="n">t</span><span class="p">.</span><span class="n">first</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">st</span><span class="p">[</span><span class="n">ver</span><span class="p">])</span> <span class="k">continue</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">st</span><span class="p">[</span><span class="n">ver</span><span class="p">]</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">h</span><span class="p">[</span><span class="n">ver</span><span class="p">];</span> <span class="n">i</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">=</span> <span class="n">ne</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">dist</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">distance</span> <span class="o">+</span> <span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">dist</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">distance</span> <span class="o">+</span> <span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">                <span class="n">heap</span><span class="p">.</span><span class="n">push</span><span class="p">({</span><span class="n">dist</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">j</span><span class="p">});</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">dist</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">==</span> <span class="mh">0x3f3f3f3f</span><span class="p">)</span> <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">dist</span><span class="p">[</span><span class="n">n</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="bellman-ford算法--模板题-acwing-853-有边数限制的最短路">Bellman-Ford算法 —— 模板题 AcWing 853. 有边数限制的最短路<a hidden class="anchor" aria-hidden="true" href="#bellman-ford算法--模板题-acwing-853-有边数限制的最短路">#</a></h3>
<p>时间复杂度 O(nm), n 表示点数，m表示边数
注意在模板题中需要对下面的模板稍作修改，加上备份数组，详情见模板题。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-40-1"><a class="lnlinks" href="#hl-40-1"> 1</a>
</span><span class="lnt" id="hl-40-2"><a class="lnlinks" href="#hl-40-2"> 2</a>
</span><span class="lnt" id="hl-40-3"><a class="lnlinks" href="#hl-40-3"> 3</a>
</span><span class="lnt" id="hl-40-4"><a class="lnlinks" href="#hl-40-4"> 4</a>
</span><span class="lnt" id="hl-40-5"><a class="lnlinks" href="#hl-40-5"> 5</a>
</span><span class="lnt" id="hl-40-6"><a class="lnlinks" href="#hl-40-6"> 6</a>
</span><span class="lnt" id="hl-40-7"><a class="lnlinks" href="#hl-40-7"> 7</a>
</span><span class="lnt" id="hl-40-8"><a class="lnlinks" href="#hl-40-8"> 8</a>
</span><span class="lnt" id="hl-40-9"><a class="lnlinks" href="#hl-40-9"> 9</a>
</span><span class="lnt" id="hl-40-10"><a class="lnlinks" href="#hl-40-10">10</a>
</span><span class="lnt" id="hl-40-11"><a class="lnlinks" href="#hl-40-11">11</a>
</span><span class="lnt" id="hl-40-12"><a class="lnlinks" href="#hl-40-12">12</a>
</span><span class="lnt" id="hl-40-13"><a class="lnlinks" href="#hl-40-13">13</a>
</span><span class="lnt" id="hl-40-14"><a class="lnlinks" href="#hl-40-14">14</a>
</span><span class="lnt" id="hl-40-15"><a class="lnlinks" href="#hl-40-15">15</a>
</span><span class="lnt" id="hl-40-16"><a class="lnlinks" href="#hl-40-16">16</a>
</span><span class="lnt" id="hl-40-17"><a class="lnlinks" href="#hl-40-17">17</a>
</span><span class="lnt" id="hl-40-18"><a class="lnlinks" href="#hl-40-18">18</a>
</span><span class="lnt" id="hl-40-19"><a class="lnlinks" href="#hl-40-19">19</a>
</span><span class="lnt" id="hl-40-20"><a class="lnlinks" href="#hl-40-20">20</a>
</span><span class="lnt" id="hl-40-21"><a class="lnlinks" href="#hl-40-21">21</a>
</span><span class="lnt" id="hl-40-22"><a class="lnlinks" href="#hl-40-22">22</a>
</span><span class="lnt" id="hl-40-23"><a class="lnlinks" href="#hl-40-23">23</a>
</span><span class="lnt" id="hl-40-24"><a class="lnlinks" href="#hl-40-24">24</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">;</span>       <span class="c1">// n表示点数，m表示边数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="n">dist</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>        <span class="c1">// dist[x]存储1到x的最短路距离
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">struct</span> <span class="nc">Edge</span>     <span class="c1">// 边，a表示出点，b表示入点，w表示边的权重
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">w</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span><span class="n">edges</span><span class="p">[</span><span class="n">M</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 求1到n的最短路距离，如果无法从1走到n，则返回-1。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="nf">bellman_ford</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">memset</span><span class="p">(</span><span class="n">dist</span><span class="p">,</span> <span class="mh">0x3f</span><span class="p">,</span> <span class="k">sizeof</span> <span class="n">dist</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">dist</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 如果第n次迭代仍然会松弛三角不等式，就说明存在一条长度是n+1的最短路径，由抽屉原理，路径中至少存在两个相同的点，说明图中存在负权回路。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span> <span class="o">++</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">m</span><span class="p">;</span> <span class="n">j</span> <span class="o">++</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="n">edges</span><span class="p">[</span><span class="n">j</span><span class="p">].</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">edges</span><span class="p">[</span><span class="n">j</span><span class="p">].</span><span class="n">b</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">edges</span><span class="p">[</span><span class="n">j</span><span class="p">].</span><span class="n">w</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">dist</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">dist</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">+</span> <span class="n">w</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">dist</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">=</span> <span class="n">dist</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">+</span> <span class="n">w</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">dist</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mh">0x3f3f3f3f</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">dist</span><span class="p">[</span><span class="n">n</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="spfa-算法队列优化的bellman-ford算法--模板题-acwing-851-spfa求最短路">spfa 算法（队列优化的Bellman-Ford算法） —— 模板题 AcWing 851. spfa求最短路<a hidden class="anchor" aria-hidden="true" href="#spfa-算法队列优化的bellman-ford算法--模板题-acwing-851-spfa求最短路">#</a></h3>
<p>时间复杂度 平均情况下 O(m)，最坏情况下 O(nm), n 表示点数，m 表示边数</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-41-1"><a class="lnlinks" href="#hl-41-1"> 1</a>
</span><span class="lnt" id="hl-41-2"><a class="lnlinks" href="#hl-41-2"> 2</a>
</span><span class="lnt" id="hl-41-3"><a class="lnlinks" href="#hl-41-3"> 3</a>
</span><span class="lnt" id="hl-41-4"><a class="lnlinks" href="#hl-41-4"> 4</a>
</span><span class="lnt" id="hl-41-5"><a class="lnlinks" href="#hl-41-5"> 5</a>
</span><span class="lnt" id="hl-41-6"><a class="lnlinks" href="#hl-41-6"> 6</a>
</span><span class="lnt" id="hl-41-7"><a class="lnlinks" href="#hl-41-7"> 7</a>
</span><span class="lnt" id="hl-41-8"><a class="lnlinks" href="#hl-41-8"> 8</a>
</span><span class="lnt" id="hl-41-9"><a class="lnlinks" href="#hl-41-9"> 9</a>
</span><span class="lnt" id="hl-41-10"><a class="lnlinks" href="#hl-41-10">10</a>
</span><span class="lnt" id="hl-41-11"><a class="lnlinks" href="#hl-41-11">11</a>
</span><span class="lnt" id="hl-41-12"><a class="lnlinks" href="#hl-41-12">12</a>
</span><span class="lnt" id="hl-41-13"><a class="lnlinks" href="#hl-41-13">13</a>
</span><span class="lnt" id="hl-41-14"><a class="lnlinks" href="#hl-41-14">14</a>
</span><span class="lnt" id="hl-41-15"><a class="lnlinks" href="#hl-41-15">15</a>
</span><span class="lnt" id="hl-41-16"><a class="lnlinks" href="#hl-41-16">16</a>
</span><span class="lnt" id="hl-41-17"><a class="lnlinks" href="#hl-41-17">17</a>
</span><span class="lnt" id="hl-41-18"><a class="lnlinks" href="#hl-41-18">18</a>
</span><span class="lnt" id="hl-41-19"><a class="lnlinks" href="#hl-41-19">19</a>
</span><span class="lnt" id="hl-41-20"><a class="lnlinks" href="#hl-41-20">20</a>
</span><span class="lnt" id="hl-41-21"><a class="lnlinks" href="#hl-41-21">21</a>
</span><span class="lnt" id="hl-41-22"><a class="lnlinks" href="#hl-41-22">22</a>
</span><span class="lnt" id="hl-41-23"><a class="lnlinks" href="#hl-41-23">23</a>
</span><span class="lnt" id="hl-41-24"><a class="lnlinks" href="#hl-41-24">24</a>
</span><span class="lnt" id="hl-41-25"><a class="lnlinks" href="#hl-41-25">25</a>
</span><span class="lnt" id="hl-41-26"><a class="lnlinks" href="#hl-41-26">26</a>
</span><span class="lnt" id="hl-41-27"><a class="lnlinks" href="#hl-41-27">27</a>
</span><span class="lnt" id="hl-41-28"><a class="lnlinks" href="#hl-41-28">28</a>
</span><span class="lnt" id="hl-41-29"><a class="lnlinks" href="#hl-41-29">29</a>
</span><span class="lnt" id="hl-41-30"><a class="lnlinks" href="#hl-41-30">30</a>
</span><span class="lnt" id="hl-41-31"><a class="lnlinks" href="#hl-41-31">31</a>
</span><span class="lnt" id="hl-41-32"><a class="lnlinks" href="#hl-41-32">32</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">n</span><span class="p">;</span>      <span class="c1">// 总点数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="n">h</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">w</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">ne</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">idx</span><span class="p">;</span>       <span class="c1">// 邻接表存储所有边
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="n">dist</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>        <span class="c1">// 存储每个点到1号点的最短距离
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">bool</span> <span class="n">st</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>     <span class="c1">// 存储每个点是否在队列中
</span></span></span><span class="line"><span class="cl"><span class="c1">// 求1号点到n号点的最短路距离，如果从1号点无法走到n号点则返回-1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="nf">spfa</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">memset</span><span class="p">(</span><span class="n">dist</span><span class="p">,</span> <span class="mh">0x3f</span><span class="p">,</span> <span class="k">sizeof</span> <span class="n">dist</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">dist</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">queue</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">q</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">st</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">q</span><span class="p">.</span><span class="n">size</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">auto</span> <span class="n">t</span> <span class="o">=</span> <span class="n">q</span><span class="p">.</span><span class="n">front</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">q</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span> <span class="n">st</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">h</span><span class="p">[</span><span class="n">t</span><span class="p">];</span> <span class="n">i</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">=</span> <span class="n">ne</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">dist</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">dist</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">dist</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">dist</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">st</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>     <span class="c1">// 如果队列中已存在j，则不需要将j重复插入
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">j</span><span class="p">);</span> <span class="n">st</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">dist</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">==</span> <span class="mh">0x3f3f3f3f</span><span class="p">)</span> <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">dist</span><span class="p">[</span><span class="n">n</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="spfa判断图中是否存在负环--模板题-acwing-852-spfa判断负环">spfa判断图中是否存在负环 —— 模板题 AcWing 852. spfa判断负环<a hidden class="anchor" aria-hidden="true" href="#spfa判断图中是否存在负环--模板题-acwing-852-spfa判断负环">#</a></h3>
<p>时间复杂度是 O(nm), n 表示点数，m 表示边数</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-42-1"><a class="lnlinks" href="#hl-42-1"> 1</a>
</span><span class="lnt" id="hl-42-2"><a class="lnlinks" href="#hl-42-2"> 2</a>
</span><span class="lnt" id="hl-42-3"><a class="lnlinks" href="#hl-42-3"> 3</a>
</span><span class="lnt" id="hl-42-4"><a class="lnlinks" href="#hl-42-4"> 4</a>
</span><span class="lnt" id="hl-42-5"><a class="lnlinks" href="#hl-42-5"> 5</a>
</span><span class="lnt" id="hl-42-6"><a class="lnlinks" href="#hl-42-6"> 6</a>
</span><span class="lnt" id="hl-42-7"><a class="lnlinks" href="#hl-42-7"> 7</a>
</span><span class="lnt" id="hl-42-8"><a class="lnlinks" href="#hl-42-8"> 8</a>
</span><span class="lnt" id="hl-42-9"><a class="lnlinks" href="#hl-42-9"> 9</a>
</span><span class="lnt" id="hl-42-10"><a class="lnlinks" href="#hl-42-10">10</a>
</span><span class="lnt" id="hl-42-11"><a class="lnlinks" href="#hl-42-11">11</a>
</span><span class="lnt" id="hl-42-12"><a class="lnlinks" href="#hl-42-12">12</a>
</span><span class="lnt" id="hl-42-13"><a class="lnlinks" href="#hl-42-13">13</a>
</span><span class="lnt" id="hl-42-14"><a class="lnlinks" href="#hl-42-14">14</a>
</span><span class="lnt" id="hl-42-15"><a class="lnlinks" href="#hl-42-15">15</a>
</span><span class="lnt" id="hl-42-16"><a class="lnlinks" href="#hl-42-16">16</a>
</span><span class="lnt" id="hl-42-17"><a class="lnlinks" href="#hl-42-17">17</a>
</span><span class="lnt" id="hl-42-18"><a class="lnlinks" href="#hl-42-18">18</a>
</span><span class="lnt" id="hl-42-19"><a class="lnlinks" href="#hl-42-19">19</a>
</span><span class="lnt" id="hl-42-20"><a class="lnlinks" href="#hl-42-20">20</a>
</span><span class="lnt" id="hl-42-21"><a class="lnlinks" href="#hl-42-21">21</a>
</span><span class="lnt" id="hl-42-22"><a class="lnlinks" href="#hl-42-22">22</a>
</span><span class="lnt" id="hl-42-23"><a class="lnlinks" href="#hl-42-23">23</a>
</span><span class="lnt" id="hl-42-24"><a class="lnlinks" href="#hl-42-24">24</a>
</span><span class="lnt" id="hl-42-25"><a class="lnlinks" href="#hl-42-25">25</a>
</span><span class="lnt" id="hl-42-26"><a class="lnlinks" href="#hl-42-26">26</a>
</span><span class="lnt" id="hl-42-27"><a class="lnlinks" href="#hl-42-27">27</a>
</span><span class="lnt" id="hl-42-28"><a class="lnlinks" href="#hl-42-28">28</a>
</span><span class="lnt" id="hl-42-29"><a class="lnlinks" href="#hl-42-29">29</a>
</span><span class="lnt" id="hl-42-30"><a class="lnlinks" href="#hl-42-30">30</a>
</span><span class="lnt" id="hl-42-31"><a class="lnlinks" href="#hl-42-31">31</a>
</span><span class="lnt" id="hl-42-32"><a class="lnlinks" href="#hl-42-32">32</a>
</span><span class="lnt" id="hl-42-33"><a class="lnlinks" href="#hl-42-33">33</a>
</span><span class="lnt" id="hl-42-34"><a class="lnlinks" href="#hl-42-34">34</a>
</span><span class="lnt" id="hl-42-35"><a class="lnlinks" href="#hl-42-35">35</a>
</span><span class="lnt" id="hl-42-36"><a class="lnlinks" href="#hl-42-36">36</a>
</span><span class="lnt" id="hl-42-37"><a class="lnlinks" href="#hl-42-37">37</a>
</span><span class="lnt" id="hl-42-38"><a class="lnlinks" href="#hl-42-38">38</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">n</span><span class="p">;</span>      <span class="c1">// 总点数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="n">h</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">w</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">ne</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">idx</span><span class="p">;</span>       <span class="c1">// 邻接表存储所有边
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="n">dist</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">cnt</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>        <span class="c1">// dist[x]存储1号点到x的最短距离，cnt[x]存储1到x的最短路中经过的点数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">bool</span> <span class="n">st</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>     <span class="c1">// 存储每个点是否在队列中
</span></span></span><span class="line"><span class="cl"><span class="c1">// 如果存在负环，则返回true，否则返回false。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">bool</span> <span class="nf">spfa</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 不需要初始化dist数组
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// 原理：如果某条最短路径上有n个点（除了自己），那么加上自己之后一共有n+1个点，由抽屉原理一定有两个点相同，所以存在环。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">queue</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">q</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span> <span class="o">++</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">st</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">q</span><span class="p">.</span><span class="n">size</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">auto</span> <span class="n">t</span> <span class="o">=</span> <span class="n">q</span><span class="p">.</span><span class="n">front</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">q</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">st</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">h</span><span class="p">[</span><span class="n">t</span><span class="p">];</span> <span class="n">i</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">=</span> <span class="n">ne</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">dist</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">dist</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">dist</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">dist</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">                <span class="n">cnt</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">cnt</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="p">(</span><span class="n">cnt</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">n</span><span class="p">)</span> <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>       <span class="c1">// 如果从1号点到x的最短路中包含至少n个点（不包括自己），则说明存在环
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">st</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                    <span class="n">st</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="floyd算法--模板题-acwing-854-floyd求最短路">floyd算法 —— 模板题 AcWing 854. Floyd求最短路<a hidden class="anchor" aria-hidden="true" href="#floyd算法--模板题-acwing-854-floyd求最短路">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-43-1"><a class="lnlinks" href="#hl-43-1"> 1</a>
</span><span class="lnt" id="hl-43-2"><a class="lnlinks" href="#hl-43-2"> 2</a>
</span><span class="lnt" id="hl-43-3"><a class="lnlinks" href="#hl-43-3"> 3</a>
</span><span class="lnt" id="hl-43-4"><a class="lnlinks" href="#hl-43-4"> 4</a>
</span><span class="lnt" id="hl-43-5"><a class="lnlinks" href="#hl-43-5"> 5</a>
</span><span class="lnt" id="hl-43-6"><a class="lnlinks" href="#hl-43-6"> 6</a>
</span><span class="lnt" id="hl-43-7"><a class="lnlinks" href="#hl-43-7"> 7</a>
</span><span class="lnt" id="hl-43-8"><a class="lnlinks" href="#hl-43-8"> 8</a>
</span><span class="lnt" id="hl-43-9"><a class="lnlinks" href="#hl-43-9"> 9</a>
</span><span class="lnt" id="hl-43-10"><a class="lnlinks" href="#hl-43-10">10</a>
</span><span class="lnt" id="hl-43-11"><a class="lnlinks" href="#hl-43-11">11</a>
</span><span class="lnt" id="hl-43-12"><a class="lnlinks" href="#hl-43-12">12</a>
</span><span class="lnt" id="hl-43-13"><a class="lnlinks" href="#hl-43-13">13</a>
</span><span class="lnt" id="hl-43-14"><a class="lnlinks" href="#hl-43-14">14</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="err">时间复杂度是</span> <span class="nf">O</span><span class="p">(</span><span class="n">n3</span><span class="p">)</span><span class="n">O</span><span class="p">(</span><span class="n">n3</span><span class="p">),</span> <span class="n">nn</span> <span class="err">表示点数</span>
</span></span><span class="line"><span class="cl"><span class="err">初始化：</span> 
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span> <span class="o">++</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">j</span> <span class="o">++</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="n">j</span><span class="p">)</span> <span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span> <span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">INF</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 算法结束后，d[a][b]表示a到b的最短距离
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">void</span> <span class="nf">floyd</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">k</span> <span class="o">++</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span> <span class="o">++</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">j</span> <span class="o">++</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">min</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">],</span> <span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">d</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">j</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="最小生成树无向图">最小生成树（无向图）<a hidden class="anchor" aria-hidden="true" href="#最小生成树无向图">#</a></h3>
<p>Prim : 朴素版Prim O(n^2)(稠密图) ; 堆优化版Prim O(mlogn)(一般不会用)</p>
<p>Kruskal  : O(mlogm)(稀疏图)</p>
<h3 id="朴素版prim算法--模板题-acwing-858-prim算法求最小生成树">朴素版prim算法 —— 模板题 AcWing 858. Prim算法求最小生成树<a hidden class="anchor" aria-hidden="true" href="#朴素版prim算法--模板题-acwing-858-prim算法求最小生成树">#</a></h3>
<p>时间复杂度是 O(n^2+m), n 表示点数，m 表示边数</p>
<p>初始化距离为正无穷，迭代所有点，找到集合中最近的点，更新它到<strong>集合</strong>的距离，把t加到集合中。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-44-1"><a class="lnlinks" href="#hl-44-1"> 1</a>
</span><span class="lnt" id="hl-44-2"><a class="lnlinks" href="#hl-44-2"> 2</a>
</span><span class="lnt" id="hl-44-3"><a class="lnlinks" href="#hl-44-3"> 3</a>
</span><span class="lnt" id="hl-44-4"><a class="lnlinks" href="#hl-44-4"> 4</a>
</span><span class="lnt" id="hl-44-5"><a class="lnlinks" href="#hl-44-5"> 5</a>
</span><span class="lnt" id="hl-44-6"><a class="lnlinks" href="#hl-44-6"> 6</a>
</span><span class="lnt" id="hl-44-7"><a class="lnlinks" href="#hl-44-7"> 7</a>
</span><span class="lnt" id="hl-44-8"><a class="lnlinks" href="#hl-44-8"> 8</a>
</span><span class="lnt" id="hl-44-9"><a class="lnlinks" href="#hl-44-9"> 9</a>
</span><span class="lnt" id="hl-44-10"><a class="lnlinks" href="#hl-44-10">10</a>
</span><span class="lnt" id="hl-44-11"><a class="lnlinks" href="#hl-44-11">11</a>
</span><span class="lnt" id="hl-44-12"><a class="lnlinks" href="#hl-44-12">12</a>
</span><span class="lnt" id="hl-44-13"><a class="lnlinks" href="#hl-44-13">13</a>
</span><span class="lnt" id="hl-44-14"><a class="lnlinks" href="#hl-44-14">14</a>
</span><span class="lnt" id="hl-44-15"><a class="lnlinks" href="#hl-44-15">15</a>
</span><span class="lnt" id="hl-44-16"><a class="lnlinks" href="#hl-44-16">16</a>
</span><span class="lnt" id="hl-44-17"><a class="lnlinks" href="#hl-44-17">17</a>
</span><span class="lnt" id="hl-44-18"><a class="lnlinks" href="#hl-44-18">18</a>
</span><span class="lnt" id="hl-44-19"><a class="lnlinks" href="#hl-44-19">19</a>
</span><span class="lnt" id="hl-44-20"><a class="lnlinks" href="#hl-44-20">20</a>
</span><span class="lnt" id="hl-44-21"><a class="lnlinks" href="#hl-44-21">21</a>
</span><span class="lnt" id="hl-44-22"><a class="lnlinks" href="#hl-44-22">22</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">n</span><span class="p">;</span>      <span class="c1">// n表示点数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="n">g</span><span class="p">[</span><span class="n">N</span><span class="p">][</span><span class="n">N</span><span class="p">];</span>        <span class="c1">// 邻接矩阵，存储所有边
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="n">dist</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>        <span class="c1">// 存储其他点到当前最小生成树的距离
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">bool</span> <span class="n">st</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>     <span class="c1">// 存储每个点是否已经在生成树中
</span></span></span><span class="line"><span class="cl"><span class="c1">// 如果图不连通，则返回INF(值是0x3f3f3f3f), 否则返回最小生成树的树边权重之和
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="nf">prim</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">memset</span><span class="p">(</span><span class="n">dist</span><span class="p">,</span> <span class="mh">0x3f</span><span class="p">,</span> <span class="k">sizeof</span> <span class="n">dist</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">res</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span> <span class="o">++</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">t</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">j</span> <span class="o">++</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">st</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">t</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="o">||</span> <span class="n">dist</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">dist</span><span class="p">[</span><span class="n">j</span><span class="p">]))</span>
</span></span><span class="line"><span class="cl">                <span class="n">t</span> <span class="o">=</span> <span class="n">j</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">&amp;&amp;</span> <span class="n">dist</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">==</span> <span class="n">INF</span><span class="p">)</span> <span class="k">return</span> <span class="n">INF</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="n">res</span> <span class="o">+=</span> <span class="n">dist</span><span class="p">[</span><span class="n">t</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="n">st</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">j</span> <span class="o">++</span> <span class="p">)</span> <span class="n">dist</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">min</span><span class="p">(</span><span class="n">dist</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">g</span><span class="p">[</span><span class="n">t</span><span class="p">][</span><span class="n">j</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">res</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="kruskal算法--模板题-acwing-859-kruskal算法求最小生成树">Kruskal算法 —— 模板题 AcWing 859. Kruskal算法求最小生成树<a hidden class="anchor" aria-hidden="true" href="#kruskal算法--模板题-acwing-859-kruskal算法求最小生成树">#</a></h3>
<p>时间复杂度是 O(mlogm), n 表示点数，m 表示边数</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-45-1"><a class="lnlinks" href="#hl-45-1"> 1</a>
</span><span class="lnt" id="hl-45-2"><a class="lnlinks" href="#hl-45-2"> 2</a>
</span><span class="lnt" id="hl-45-3"><a class="lnlinks" href="#hl-45-3"> 3</a>
</span><span class="lnt" id="hl-45-4"><a class="lnlinks" href="#hl-45-4"> 4</a>
</span><span class="lnt" id="hl-45-5"><a class="lnlinks" href="#hl-45-5"> 5</a>
</span><span class="lnt" id="hl-45-6"><a class="lnlinks" href="#hl-45-6"> 6</a>
</span><span class="lnt" id="hl-45-7"><a class="lnlinks" href="#hl-45-7"> 7</a>
</span><span class="lnt" id="hl-45-8"><a class="lnlinks" href="#hl-45-8"> 8</a>
</span><span class="lnt" id="hl-45-9"><a class="lnlinks" href="#hl-45-9"> 9</a>
</span><span class="lnt" id="hl-45-10"><a class="lnlinks" href="#hl-45-10">10</a>
</span><span class="lnt" id="hl-45-11"><a class="lnlinks" href="#hl-45-11">11</a>
</span><span class="lnt" id="hl-45-12"><a class="lnlinks" href="#hl-45-12">12</a>
</span><span class="lnt" id="hl-45-13"><a class="lnlinks" href="#hl-45-13">13</a>
</span><span class="lnt" id="hl-45-14"><a class="lnlinks" href="#hl-45-14">14</a>
</span><span class="lnt" id="hl-45-15"><a class="lnlinks" href="#hl-45-15">15</a>
</span><span class="lnt" id="hl-45-16"><a class="lnlinks" href="#hl-45-16">16</a>
</span><span class="lnt" id="hl-45-17"><a class="lnlinks" href="#hl-45-17">17</a>
</span><span class="lnt" id="hl-45-18"><a class="lnlinks" href="#hl-45-18">18</a>
</span><span class="lnt" id="hl-45-19"><a class="lnlinks" href="#hl-45-19">19</a>
</span><span class="lnt" id="hl-45-20"><a class="lnlinks" href="#hl-45-20">20</a>
</span><span class="lnt" id="hl-45-21"><a class="lnlinks" href="#hl-45-21">21</a>
</span><span class="lnt" id="hl-45-22"><a class="lnlinks" href="#hl-45-22">22</a>
</span><span class="lnt" id="hl-45-23"><a class="lnlinks" href="#hl-45-23">23</a>
</span><span class="lnt" id="hl-45-24"><a class="lnlinks" href="#hl-45-24">24</a>
</span><span class="lnt" id="hl-45-25"><a class="lnlinks" href="#hl-45-25">25</a>
</span><span class="lnt" id="hl-45-26"><a class="lnlinks" href="#hl-45-26">26</a>
</span><span class="lnt" id="hl-45-27"><a class="lnlinks" href="#hl-45-27">27</a>
</span><span class="lnt" id="hl-45-28"><a class="lnlinks" href="#hl-45-28">28</a>
</span><span class="lnt" id="hl-45-29"><a class="lnlinks" href="#hl-45-29">29</a>
</span><span class="lnt" id="hl-45-30"><a class="lnlinks" href="#hl-45-30">30</a>
</span><span class="lnt" id="hl-45-31"><a class="lnlinks" href="#hl-45-31">31</a>
</span><span class="lnt" id="hl-45-32"><a class="lnlinks" href="#hl-45-32">32</a>
</span><span class="lnt" id="hl-45-33"><a class="lnlinks" href="#hl-45-33">33</a>
</span><span class="lnt" id="hl-45-34"><a class="lnlinks" href="#hl-45-34">34</a>
</span><span class="lnt" id="hl-45-35"><a class="lnlinks" href="#hl-45-35">35</a>
</span><span class="lnt" id="hl-45-36"><a class="lnlinks" href="#hl-45-36">36</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">;</span>       <span class="c1">// n是点数，m是边数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="n">p</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>       <span class="c1">// 并查集的父节点数组
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">struct</span> <span class="nc">Edge</span>     <span class="c1">// 存储边
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">w</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 重载小于号运算符
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// 用于比较两个Edge对象的大小关系
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">bool</span> <span class="k">operator</span> <span class="o">&lt;</span> <span class="p">(</span><span class="k">const</span> <span class="n">Edge</span> <span class="o">&amp;</span><span class="n">W</span><span class="p">)</span> <span class="k">const</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">w</span> <span class="o">&lt;</span> <span class="n">W</span><span class="p">.</span><span class="n">w</span><span class="p">;</span> <span class="c1">// 如果当前对象的边权小于W对象的边权，返回true，否则返回false
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span><span class="n">edges</span><span class="p">[</span><span class="n">M</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">find</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span>     <span class="c1">// 并查集核心操作
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">!=</span> <span class="n">x</span><span class="p">)</span> <span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">find</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">p</span><span class="p">[</span><span class="n">x</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">kruskal</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">sort</span><span class="p">(</span><span class="n">edges</span><span class="p">,</span> <span class="n">edges</span> <span class="o">+</span> <span class="n">m</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span> <span class="o">++</span> <span class="p">)</span> <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>    <span class="c1">// 初始化并查集
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">int</span> <span class="n">res</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">m</span><span class="p">;</span> <span class="n">i</span> <span class="o">++</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">b</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">w</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">a</span> <span class="o">=</span> <span class="n">find</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">b</span> <span class="o">=</span> <span class="n">find</span><span class="p">(</span><span class="n">b</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">a</span> <span class="o">!=</span> <span class="n">b</span><span class="p">)</span>     <span class="c1">// 如果两个连通块不连通，则将这两个连通块合并
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">p</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">res</span> <span class="o">+=</span> <span class="n">w</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">cnt</span> <span class="o">++</span> <span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">cnt</span> <span class="o">&lt;</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="k">return</span> <span class="n">INF</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">res</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="染色法本质dfs判别二分图--模板题-acwing-860-染色法判定二分图">染色法（本质dfs)判别二分图 —— 模板题 AcWing 860. 染色法判定二分图<a hidden class="anchor" aria-hidden="true" href="#染色法本质dfs判别二分图--模板题-acwing-860-染色法判定二分图">#</a></h3>
<p><strong>给定一个 n 个点m条边的无向图，图中可能存在重边和自环。请你判断这个图是否是二分图。</strong></p>
<p>时间复杂度是 O(n+m), n 表示点数，m 表示边数</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-46-1"><a class="lnlinks" href="#hl-46-1"> 1</a>
</span><span class="lnt" id="hl-46-2"><a class="lnlinks" href="#hl-46-2"> 2</a>
</span><span class="lnt" id="hl-46-3"><a class="lnlinks" href="#hl-46-3"> 3</a>
</span><span class="lnt" id="hl-46-4"><a class="lnlinks" href="#hl-46-4"> 4</a>
</span><span class="lnt" id="hl-46-5"><a class="lnlinks" href="#hl-46-5"> 5</a>
</span><span class="lnt" id="hl-46-6"><a class="lnlinks" href="#hl-46-6"> 6</a>
</span><span class="lnt" id="hl-46-7"><a class="lnlinks" href="#hl-46-7"> 7</a>
</span><span class="lnt" id="hl-46-8"><a class="lnlinks" href="#hl-46-8"> 8</a>
</span><span class="lnt" id="hl-46-9"><a class="lnlinks" href="#hl-46-9"> 9</a>
</span><span class="lnt" id="hl-46-10"><a class="lnlinks" href="#hl-46-10">10</a>
</span><span class="lnt" id="hl-46-11"><a class="lnlinks" href="#hl-46-11">11</a>
</span><span class="lnt" id="hl-46-12"><a class="lnlinks" href="#hl-46-12">12</a>
</span><span class="lnt" id="hl-46-13"><a class="lnlinks" href="#hl-46-13">13</a>
</span><span class="lnt" id="hl-46-14"><a class="lnlinks" href="#hl-46-14">14</a>
</span><span class="lnt" id="hl-46-15"><a class="lnlinks" href="#hl-46-15">15</a>
</span><span class="lnt" id="hl-46-16"><a class="lnlinks" href="#hl-46-16">16</a>
</span><span class="lnt" id="hl-46-17"><a class="lnlinks" href="#hl-46-17">17</a>
</span><span class="lnt" id="hl-46-18"><a class="lnlinks" href="#hl-46-18">18</a>
</span><span class="lnt" id="hl-46-19"><a class="lnlinks" href="#hl-46-19">19</a>
</span><span class="lnt" id="hl-46-20"><a class="lnlinks" href="#hl-46-20">20</a>
</span><span class="lnt" id="hl-46-21"><a class="lnlinks" href="#hl-46-21">21</a>
</span><span class="lnt" id="hl-46-22"><a class="lnlinks" href="#hl-46-22">22</a>
</span><span class="lnt" id="hl-46-23"><a class="lnlinks" href="#hl-46-23">23</a>
</span><span class="lnt" id="hl-46-24"><a class="lnlinks" href="#hl-46-24">24</a>
</span><span class="lnt" id="hl-46-25"><a class="lnlinks" href="#hl-46-25">25</a>
</span><span class="lnt" id="hl-46-26"><a class="lnlinks" href="#hl-46-26">26</a>
</span><span class="lnt" id="hl-46-27"><a class="lnlinks" href="#hl-46-27">27</a>
</span><span class="lnt" id="hl-46-28"><a class="lnlinks" href="#hl-46-28">28</a>
</span><span class="lnt" id="hl-46-29"><a class="lnlinks" href="#hl-46-29">29</a>
</span><span class="lnt" id="hl-46-30"><a class="lnlinks" href="#hl-46-30">30</a>
</span><span class="lnt" id="hl-46-31"><a class="lnlinks" href="#hl-46-31">31</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">n</span><span class="p">;</span>      <span class="c1">// n表示点数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="n">h</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="n">M</span><span class="p">],</span> <span class="n">ne</span><span class="p">[</span><span class="n">M</span><span class="p">],</span> <span class="n">idx</span><span class="p">;</span>     <span class="c1">// 邻接表存储图
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="n">color</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>       <span class="c1">// 表示每个点的颜色，-1表示为染色，0表示白色，1表示黑色
</span></span></span><span class="line"><span class="cl"><span class="c1">// 参数：u表示当前节点，c表示当前点的颜色
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">bool</span> <span class="nf">dfs</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="kt">int</span> <span class="n">c</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">color</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">h</span><span class="p">[</span><span class="n">u</span><span class="p">];</span> <span class="n">i</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">=</span> <span class="n">ne</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">color</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">dfs</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="o">!</span><span class="n">c</span><span class="p">))</span> <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">color</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="n">c</span><span class="p">)</span> <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">bool</span> <span class="nf">check</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">memset</span><span class="p">(</span><span class="n">color</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="k">sizeof</span> <span class="n">color</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">bool</span> <span class="n">flag</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span> <span class="o">++</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">color</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">dfs</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">flag</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">flag</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="匈牙利算法--模板题-acwing-861-二分图的最大匹配">匈牙利算法 —— 模板题 AcWing 861. 二分图的最大匹配<a hidden class="anchor" aria-hidden="true" href="#匈牙利算法--模板题-acwing-861-二分图的最大匹配">#</a></h3>
<p>时间复杂度最坏是 O(nm)，实际运行时间一般远小于O(nm)， n 表示点数，m 表示边数</p>
<p>做错一件事，错过一件事</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-47-1"><a class="lnlinks" href="#hl-47-1"> 1</a>
</span><span class="lnt" id="hl-47-2"><a class="lnlinks" href="#hl-47-2"> 2</a>
</span><span class="lnt" id="hl-47-3"><a class="lnlinks" href="#hl-47-3"> 3</a>
</span><span class="lnt" id="hl-47-4"><a class="lnlinks" href="#hl-47-4"> 4</a>
</span><span class="lnt" id="hl-47-5"><a class="lnlinks" href="#hl-47-5"> 5</a>
</span><span class="lnt" id="hl-47-6"><a class="lnlinks" href="#hl-47-6"> 6</a>
</span><span class="lnt" id="hl-47-7"><a class="lnlinks" href="#hl-47-7"> 7</a>
</span><span class="lnt" id="hl-47-8"><a class="lnlinks" href="#hl-47-8"> 8</a>
</span><span class="lnt" id="hl-47-9"><a class="lnlinks" href="#hl-47-9"> 9</a>
</span><span class="lnt" id="hl-47-10"><a class="lnlinks" href="#hl-47-10">10</a>
</span><span class="lnt" id="hl-47-11"><a class="lnlinks" href="#hl-47-11">11</a>
</span><span class="lnt" id="hl-47-12"><a class="lnlinks" href="#hl-47-12">12</a>
</span><span class="lnt" id="hl-47-13"><a class="lnlinks" href="#hl-47-13">13</a>
</span><span class="lnt" id="hl-47-14"><a class="lnlinks" href="#hl-47-14">14</a>
</span><span class="lnt" id="hl-47-15"><a class="lnlinks" href="#hl-47-15">15</a>
</span><span class="lnt" id="hl-47-16"><a class="lnlinks" href="#hl-47-16">16</a>
</span><span class="lnt" id="hl-47-17"><a class="lnlinks" href="#hl-47-17">17</a>
</span><span class="lnt" id="hl-47-18"><a class="lnlinks" href="#hl-47-18">18</a>
</span><span class="lnt" id="hl-47-19"><a class="lnlinks" href="#hl-47-19">19</a>
</span><span class="lnt" id="hl-47-20"><a class="lnlinks" href="#hl-47-20">20</a>
</span><span class="lnt" id="hl-47-21"><a class="lnlinks" href="#hl-47-21">21</a>
</span><span class="lnt" id="hl-47-22"><a class="lnlinks" href="#hl-47-22">22</a>
</span><span class="lnt" id="hl-47-23"><a class="lnlinks" href="#hl-47-23">23</a>
</span><span class="lnt" id="hl-47-24"><a class="lnlinks" href="#hl-47-24">24</a>
</span><span class="lnt" id="hl-47-25"><a class="lnlinks" href="#hl-47-25">25</a>
</span><span class="lnt" id="hl-47-26"><a class="lnlinks" href="#hl-47-26">26</a>
</span><span class="lnt" id="hl-47-27"><a class="lnlinks" href="#hl-47-27">27</a>
</span><span class="lnt" id="hl-47-28"><a class="lnlinks" href="#hl-47-28">28</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">n1</span><span class="p">,</span> <span class="n">n2</span><span class="p">;</span>     <span class="c1">// n1表示第一个集合中的点数，n2表示第二个集合中的点数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="n">h</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="n">M</span><span class="p">],</span> <span class="n">ne</span><span class="p">[</span><span class="n">M</span><span class="p">],</span> <span class="n">idx</span><span class="p">;</span>     <span class="c1">// 邻接表存储所有边，匈牙利算法中只会用到从第二个集合指向第一个集合的边，所以这里只用存一个方向的边
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="n">match</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>       <span class="c1">// 存储第二个集合中的每个点当前匹配的第一个集合中的点是哪个
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">bool</span> <span class="n">st</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>     <span class="c1">// 表示第二个集合中的每个点是否已经被遍历过
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">bool</span> <span class="nf">find</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">h</span><span class="p">[</span><span class="n">x</span><span class="p">];</span> <span class="n">i</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">=</span> <span class="n">ne</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">st</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">st</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">match</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">find</span><span class="p">(</span><span class="n">match</span><span class="p">[</span><span class="n">j</span><span class="p">]))</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">match</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 求最大匹配数，依次枚举第一个集合中的每个点能否匹配第二个集合中的点
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="n">res</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n1</span><span class="p">;</span> <span class="n">i</span> <span class="o">++</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">memset</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="nb">false</span><span class="p">,</span> <span class="k">sizeof</span> <span class="n">st</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">find</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="n">res</span> <span class="o">++</span> <span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>作者：yxc
链接：https://www.acwing.com/blog/content/405/
来源：AcWing
著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。</p>
<h2 id="第四章">第四章<a hidden class="anchor" aria-hidden="true" href="#第四章">#</a></h2>
<h3 id="试除法判定质数--模板题-acwing-866-试除法判定质数">试除法判定质数 —— 模板题 AcWing 866. 试除法判定质数<a hidden class="anchor" aria-hidden="true" href="#试除法判定质数--模板题-acwing-866-试除法判定质数">#</a></h3>
<p>质数：大于1的整数中，如果只包含1和本身两个约束，称为质数（素数）</p>
<p>（1）判定，试除法</p>
<p>（2）分解质因数</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-48-1"><a class="lnlinks" href="#hl-48-1">1</a>
</span><span class="lnt" id="hl-48-2"><a class="lnlinks" href="#hl-48-2">2</a>
</span><span class="lnt" id="hl-48-3"><a class="lnlinks" href="#hl-48-3">3</a>
</span><span class="lnt" id="hl-48-4"><a class="lnlinks" href="#hl-48-4">4</a>
</span><span class="lnt" id="hl-48-5"><a class="lnlinks" href="#hl-48-5">5</a>
</span><span class="lnt" id="hl-48-6"><a class="lnlinks" href="#hl-48-6">6</a>
</span><span class="lnt" id="hl-48-7"><a class="lnlinks" href="#hl-48-7">7</a>
</span><span class="lnt" id="hl-48-8"><a class="lnlinks" href="#hl-48-8">8</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">bool</span> <span class="nf">is_prime</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">x</span> <span class="o">/</span> <span class="n">i</span><span class="p">;</span> <span class="n">i</span> <span class="o">++</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">%</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="试除法分解质因数--模板题-acwing-867-分解质因数">试除法分解质因数 —— 模板题 AcWing 867. 分解质因数<a hidden class="anchor" aria-hidden="true" href="#试除法分解质因数--模板题-acwing-867-分解质因数">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-49-1"><a class="lnlinks" href="#hl-49-1"> 1</a>
</span><span class="lnt" id="hl-49-2"><a class="lnlinks" href="#hl-49-2"> 2</a>
</span><span class="lnt" id="hl-49-3"><a class="lnlinks" href="#hl-49-3"> 3</a>
</span><span class="lnt" id="hl-49-4"><a class="lnlinks" href="#hl-49-4"> 4</a>
</span><span class="lnt" id="hl-49-5"><a class="lnlinks" href="#hl-49-5"> 5</a>
</span><span class="lnt" id="hl-49-6"><a class="lnlinks" href="#hl-49-6"> 6</a>
</span><span class="lnt" id="hl-49-7"><a class="lnlinks" href="#hl-49-7"> 7</a>
</span><span class="lnt" id="hl-49-8"><a class="lnlinks" href="#hl-49-8"> 8</a>
</span><span class="lnt" id="hl-49-9"><a class="lnlinks" href="#hl-49-9"> 9</a>
</span><span class="lnt" id="hl-49-10"><a class="lnlinks" href="#hl-49-10">10</a>
</span><span class="lnt" id="hl-49-11"><a class="lnlinks" href="#hl-49-11">11</a>
</span><span class="lnt" id="hl-49-12"><a class="lnlinks" href="#hl-49-12">12</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">divide</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">x</span> <span class="o">/</span> <span class="n">i</span><span class="p">;</span> <span class="n">i</span> <span class="o">++</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">%</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kt">int</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">while</span> <span class="p">(</span><span class="n">x</span> <span class="o">%</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">x</span> <span class="o">/=</span> <span class="n">i</span><span class="p">,</span> <span class="n">s</span> <span class="o">++</span> <span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">i</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39; &#39;</span> <span class="o">&lt;&lt;</span> <span class="n">s</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39; &#39;</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="朴素筛法求素数--模板题-acwing-868-筛质数">朴素筛法求素数 —— 模板题 AcWing 868. 筛质数<a hidden class="anchor" aria-hidden="true" href="#朴素筛法求素数--模板题-acwing-868-筛质数">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-50-1"><a class="lnlinks" href="#hl-50-1"> 1</a>
</span><span class="lnt" id="hl-50-2"><a class="lnlinks" href="#hl-50-2"> 2</a>
</span><span class="lnt" id="hl-50-3"><a class="lnlinks" href="#hl-50-3"> 3</a>
</span><span class="lnt" id="hl-50-4"><a class="lnlinks" href="#hl-50-4"> 4</a>
</span><span class="lnt" id="hl-50-5"><a class="lnlinks" href="#hl-50-5"> 5</a>
</span><span class="lnt" id="hl-50-6"><a class="lnlinks" href="#hl-50-6"> 6</a>
</span><span class="lnt" id="hl-50-7"><a class="lnlinks" href="#hl-50-7"> 7</a>
</span><span class="lnt" id="hl-50-8"><a class="lnlinks" href="#hl-50-8"> 8</a>
</span><span class="lnt" id="hl-50-9"><a class="lnlinks" href="#hl-50-9"> 9</a>
</span><span class="lnt" id="hl-50-10"><a class="lnlinks" href="#hl-50-10">10</a>
</span><span class="lnt" id="hl-50-11"><a class="lnlinks" href="#hl-50-11">11</a>
</span><span class="lnt" id="hl-50-12"><a class="lnlinks" href="#hl-50-12">12</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">primes</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">cnt</span><span class="p">;</span>     <span class="c1">// primes[]存储所有素数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">bool</span> <span class="n">st</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>         <span class="c1">// st[x]存储x是否被筛掉
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">void</span> <span class="nf">get_primes</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span> <span class="o">++</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">st</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">continue</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">primes</span><span class="p">[</span><span class="n">cnt</span> <span class="o">++</span> <span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">j</span> <span class="o">+=</span> <span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">st</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="线性筛法求素数--模板题-acwing-868-筛质数">线性筛法求素数 —— 模板题 AcWing 868. 筛质数<a hidden class="anchor" aria-hidden="true" href="#线性筛法求素数--模板题-acwing-868-筛质数">#</a></h3>
<p>被最小质因子筛掉</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-51-1"><a class="lnlinks" href="#hl-51-1"> 1</a>
</span><span class="lnt" id="hl-51-2"><a class="lnlinks" href="#hl-51-2"> 2</a>
</span><span class="lnt" id="hl-51-3"><a class="lnlinks" href="#hl-51-3"> 3</a>
</span><span class="lnt" id="hl-51-4"><a class="lnlinks" href="#hl-51-4"> 4</a>
</span><span class="lnt" id="hl-51-5"><a class="lnlinks" href="#hl-51-5"> 5</a>
</span><span class="lnt" id="hl-51-6"><a class="lnlinks" href="#hl-51-6"> 6</a>
</span><span class="lnt" id="hl-51-7"><a class="lnlinks" href="#hl-51-7"> 7</a>
</span><span class="lnt" id="hl-51-8"><a class="lnlinks" href="#hl-51-8"> 8</a>
</span><span class="lnt" id="hl-51-9"><a class="lnlinks" href="#hl-51-9"> 9</a>
</span><span class="lnt" id="hl-51-10"><a class="lnlinks" href="#hl-51-10">10</a>
</span><span class="lnt" id="hl-51-11"><a class="lnlinks" href="#hl-51-11">11</a>
</span><span class="lnt" id="hl-51-12"><a class="lnlinks" href="#hl-51-12">12</a>
</span><span class="lnt" id="hl-51-13"><a class="lnlinks" href="#hl-51-13">13</a>
</span><span class="lnt" id="hl-51-14"><a class="lnlinks" href="#hl-51-14">14</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">primes</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">cnt</span><span class="p">;</span>     <span class="c1">// primes[]存储所有素数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">bool</span> <span class="n">st</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>         <span class="c1">// st[x]存储x是否被筛掉
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">void</span> <span class="nf">get_primes</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span> <span class="o">++</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">st</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="n">primes</span><span class="p">[</span><span class="n">cnt</span> <span class="o">++</span> <span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">primes</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">n</span> <span class="o">/</span> <span class="n">i</span><span class="p">;</span> <span class="n">j</span> <span class="o">++</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">st</span><span class="p">[</span><span class="n">primes</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">%</span> <span class="n">primes</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="试除法求所有约数--模板题-acwing-869-试除法求约数">试除法求所有约数 —— 模板题 AcWing 869. 试除法求约数<a hidden class="anchor" aria-hidden="true" href="#试除法求所有约数--模板题-acwing-869-试除法求约数">#</a></h3>
<p>int范围内约数个数最多为1500个左右</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-52-1"><a class="lnlinks" href="#hl-52-1"> 1</a>
</span><span class="lnt" id="hl-52-2"><a class="lnlinks" href="#hl-52-2"> 2</a>
</span><span class="lnt" id="hl-52-3"><a class="lnlinks" href="#hl-52-3"> 3</a>
</span><span class="lnt" id="hl-52-4"><a class="lnlinks" href="#hl-52-4"> 4</a>
</span><span class="lnt" id="hl-52-5"><a class="lnlinks" href="#hl-52-5"> 5</a>
</span><span class="lnt" id="hl-52-6"><a class="lnlinks" href="#hl-52-6"> 6</a>
</span><span class="lnt" id="hl-52-7"><a class="lnlinks" href="#hl-52-7"> 7</a>
</span><span class="lnt" id="hl-52-8"><a class="lnlinks" href="#hl-52-8"> 8</a>
</span><span class="lnt" id="hl-52-9"><a class="lnlinks" href="#hl-52-9"> 9</a>
</span><span class="lnt" id="hl-52-10"><a class="lnlinks" href="#hl-52-10">10</a>
</span><span class="lnt" id="hl-52-11"><a class="lnlinks" href="#hl-52-11">11</a>
</span><span class="lnt" id="hl-52-12"><a class="lnlinks" href="#hl-52-12">12</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">get_divisors</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">res</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">x</span> <span class="o">/</span> <span class="n">i</span><span class="p">;</span> <span class="n">i</span> <span class="o">++</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">%</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">res</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">!=</span> <span class="n">x</span> <span class="o">/</span> <span class="n">i</span><span class="p">)</span> <span class="n">res</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">x</span> <span class="o">/</span> <span class="n">i</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">sort</span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span> <span class="n">res</span><span class="p">.</span><span class="n">end</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">res</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="约数个数和约数之和--模板题-acwing-870-约数个数-acwing-871-约数之和">约数个数和约数之和 —— 模板题 AcWing 870. 约数个数, AcWing 871. 约数之和<a hidden class="anchor" aria-hidden="true" href="#约数个数和约数之和--模板题-acwing-870-约数个数-acwing-871-约数之和">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-53-1"><a class="lnlinks" href="#hl-53-1">1</a>
</span><span class="lnt" id="hl-53-2"><a class="lnlinks" href="#hl-53-2">2</a>
</span><span class="lnt" id="hl-53-3"><a class="lnlinks" href="#hl-53-3">3</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="err">如果</span> <span class="n">N</span> <span class="o">=</span> <span class="n">p1</span><span class="o">^</span><span class="n">c1</span> <span class="o">*</span> <span class="n">p2</span><span class="o">^</span><span class="n">c2</span> <span class="o">*</span> <span class="p">...</span> <span class="o">*</span><span class="n">pk</span><span class="o">^</span><span class="n">ck</span>
</span></span><span class="line"><span class="cl"><span class="err">约数个数：</span> <span class="p">(</span><span class="n">c1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">c2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">...</span> <span class="o">*</span> <span class="p">(</span><span class="n">ck</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="err">约数之和：</span> <span class="p">(</span><span class="n">p1</span><span class="o">^</span><span class="mi">0</span> <span class="o">+</span> <span class="n">p1</span><span class="o">^</span><span class="mi">1</span> <span class="o">+</span> <span class="p">...</span> <span class="o">+</span> <span class="n">p1</span><span class="o">^</span><span class="n">c1</span><span class="p">)</span> <span class="o">*</span> <span class="p">...</span> <span class="o">*</span> <span class="p">(</span><span class="n">pk</span><span class="o">^</span><span class="mi">0</span> <span class="o">+</span> <span class="n">pk</span><span class="o">^</span><span class="mi">1</span> <span class="o">+</span> <span class="p">...</span> <span class="o">+</span> <span class="n">pk</span><span class="o">^</span><span class="n">ck</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="欧几里得算法--模板题-acwing-872-最大公约数">欧几里得算法 —— 模板题 AcWing 872. 最大公约数<a hidden class="anchor" aria-hidden="true" href="#欧几里得算法--模板题-acwing-872-最大公约数">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-54-1"><a class="lnlinks" href="#hl-54-1">1</a>
</span><span class="lnt" id="hl-54-2"><a class="lnlinks" href="#hl-54-2">2</a>
</span><span class="lnt" id="hl-54-3"><a class="lnlinks" href="#hl-54-3">3</a>
</span><span class="lnt" id="hl-54-4"><a class="lnlinks" href="#hl-54-4">4</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">gcd</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="kt">int</span> <span class="n">b</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">b</span> <span class="o">?</span> <span class="n">gcd</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">%</span> <span class="n">b</span><span class="p">)</span> <span class="o">:</span> <span class="n">a</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="求欧拉函数--模板题-acwing-873-欧拉函数">求欧拉函数 —— 模板题 AcWing 873. 欧拉函数<a hidden class="anchor" aria-hidden="true" href="#求欧拉函数--模板题-acwing-873-欧拉函数">#</a></h3>
<p>欧拉函数公式（容斥原理) : n*(1-p1)*(1-p2)&hellip;(1-pk)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-55-1"><a class="lnlinks" href="#hl-55-1"> 1</a>
</span><span class="lnt" id="hl-55-2"><a class="lnlinks" href="#hl-55-2"> 2</a>
</span><span class="lnt" id="hl-55-3"><a class="lnlinks" href="#hl-55-3"> 3</a>
</span><span class="lnt" id="hl-55-4"><a class="lnlinks" href="#hl-55-4"> 4</a>
</span><span class="lnt" id="hl-55-5"><a class="lnlinks" href="#hl-55-5"> 5</a>
</span><span class="lnt" id="hl-55-6"><a class="lnlinks" href="#hl-55-6"> 6</a>
</span><span class="lnt" id="hl-55-7"><a class="lnlinks" href="#hl-55-7"> 7</a>
</span><span class="lnt" id="hl-55-8"><a class="lnlinks" href="#hl-55-8"> 8</a>
</span><span class="lnt" id="hl-55-9"><a class="lnlinks" href="#hl-55-9"> 9</a>
</span><span class="lnt" id="hl-55-10"><a class="lnlinks" href="#hl-55-10">10</a>
</span><span class="lnt" id="hl-55-11"><a class="lnlinks" href="#hl-55-11">11</a>
</span><span class="lnt" id="hl-55-12"><a class="lnlinks" href="#hl-55-12">12</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">phi</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">res</span> <span class="o">=</span> <span class="n">x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">x</span> <span class="o">/</span> <span class="n">i</span><span class="p">;</span> <span class="n">i</span> <span class="o">++</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">%</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">res</span> <span class="o">=</span> <span class="n">res</span> <span class="o">/</span> <span class="n">i</span> <span class="o">*</span> <span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="k">while</span> <span class="p">(</span><span class="n">x</span> <span class="o">%</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">x</span> <span class="o">/=</span> <span class="n">i</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="n">res</span> <span class="o">=</span> <span class="n">res</span> <span class="o">/</span> <span class="n">x</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">res</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="筛法求欧拉函数--模板题-acwing-874-筛法求欧拉函数">筛法求欧拉函数 —— 模板题 AcWing 874. 筛法求欧拉函数<a hidden class="anchor" aria-hidden="true" href="#筛法求欧拉函数--模板题-acwing-874-筛法求欧拉函数">#</a></h3>
<p>O(n) 线性求所有数的欧拉函数</p>
<p>应用：欧拉定理：a与n互质   a^φ(n)=1(mod n)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-56-1"><a class="lnlinks" href="#hl-56-1"> 1</a>
</span><span class="lnt" id="hl-56-2"><a class="lnlinks" href="#hl-56-2"> 2</a>
</span><span class="lnt" id="hl-56-3"><a class="lnlinks" href="#hl-56-3"> 3</a>
</span><span class="lnt" id="hl-56-4"><a class="lnlinks" href="#hl-56-4"> 4</a>
</span><span class="lnt" id="hl-56-5"><a class="lnlinks" href="#hl-56-5"> 5</a>
</span><span class="lnt" id="hl-56-6"><a class="lnlinks" href="#hl-56-6"> 6</a>
</span><span class="lnt" id="hl-56-7"><a class="lnlinks" href="#hl-56-7"> 7</a>
</span><span class="lnt" id="hl-56-8"><a class="lnlinks" href="#hl-56-8"> 8</a>
</span><span class="lnt" id="hl-56-9"><a class="lnlinks" href="#hl-56-9"> 9</a>
</span><span class="lnt" id="hl-56-10"><a class="lnlinks" href="#hl-56-10">10</a>
</span><span class="lnt" id="hl-56-11"><a class="lnlinks" href="#hl-56-11">11</a>
</span><span class="lnt" id="hl-56-12"><a class="lnlinks" href="#hl-56-12">12</a>
</span><span class="lnt" id="hl-56-13"><a class="lnlinks" href="#hl-56-13">13</a>
</span><span class="lnt" id="hl-56-14"><a class="lnlinks" href="#hl-56-14">14</a>
</span><span class="lnt" id="hl-56-15"><a class="lnlinks" href="#hl-56-15">15</a>
</span><span class="lnt" id="hl-56-16"><a class="lnlinks" href="#hl-56-16">16</a>
</span><span class="lnt" id="hl-56-17"><a class="lnlinks" href="#hl-56-17">17</a>
</span><span class="lnt" id="hl-56-18"><a class="lnlinks" href="#hl-56-18">18</a>
</span><span class="lnt" id="hl-56-19"><a class="lnlinks" href="#hl-56-19">19</a>
</span><span class="lnt" id="hl-56-20"><a class="lnlinks" href="#hl-56-20">20</a>
</span><span class="lnt" id="hl-56-21"><a class="lnlinks" href="#hl-56-21">21</a>
</span><span class="lnt" id="hl-56-22"><a class="lnlinks" href="#hl-56-22">22</a>
</span><span class="lnt" id="hl-56-23"><a class="lnlinks" href="#hl-56-23">23</a>
</span><span class="lnt" id="hl-56-24"><a class="lnlinks" href="#hl-56-24">24</a>
</span><span class="lnt" id="hl-56-25"><a class="lnlinks" href="#hl-56-25">25</a>
</span><span class="lnt" id="hl-56-26"><a class="lnlinks" href="#hl-56-26">26</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">primes</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">cnt</span><span class="p">;</span>     <span class="c1">// primes[]存储所有素数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="n">euler</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>           <span class="c1">// 存储每个数的欧拉函数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">bool</span> <span class="n">st</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>         <span class="c1">// st[x]存储x是否被筛掉
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">void</span> <span class="nf">get_eulers</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">euler</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span> <span class="o">++</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">st</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">primes</span><span class="p">[</span><span class="n">cnt</span> <span class="o">++</span> <span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">euler</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">primes</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">n</span> <span class="o">/</span> <span class="n">i</span><span class="p">;</span> <span class="n">j</span> <span class="o">++</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kt">int</span> <span class="n">t</span> <span class="o">=</span> <span class="n">primes</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">i</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">st</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">%</span> <span class="n">primes</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">euler</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">euler</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">primes</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">                <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="n">euler</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">euler</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">primes</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="快速幂--模板题-acwing-875-快速幂">快速幂 —— 模板题 AcWing 875. 快速幂<a hidden class="anchor" aria-hidden="true" href="#快速幂--模板题-acwing-875-快速幂">#</a></h3>
<p>求 m^k mod p，时间复杂度 O(logk)。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-57-1"><a class="lnlinks" href="#hl-57-1"> 1</a>
</span><span class="lnt" id="hl-57-2"><a class="lnlinks" href="#hl-57-2"> 2</a>
</span><span class="lnt" id="hl-57-3"><a class="lnlinks" href="#hl-57-3"> 3</a>
</span><span class="lnt" id="hl-57-4"><a class="lnlinks" href="#hl-57-4"> 4</a>
</span><span class="lnt" id="hl-57-5"><a class="lnlinks" href="#hl-57-5"> 5</a>
</span><span class="lnt" id="hl-57-6"><a class="lnlinks" href="#hl-57-6"> 6</a>
</span><span class="lnt" id="hl-57-7"><a class="lnlinks" href="#hl-57-7"> 7</a>
</span><span class="lnt" id="hl-57-8"><a class="lnlinks" href="#hl-57-8"> 8</a>
</span><span class="lnt" id="hl-57-9"><a class="lnlinks" href="#hl-57-9"> 9</a>
</span><span class="lnt" id="hl-57-10"><a class="lnlinks" href="#hl-57-10">10</a>
</span><span class="lnt" id="hl-57-11"><a class="lnlinks" href="#hl-57-11">11</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">qmi</span><span class="p">(</span><span class="kt">int</span> <span class="n">m</span><span class="p">,</span> <span class="kt">int</span> <span class="n">k</span><span class="p">,</span> <span class="kt">int</span> <span class="n">p</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">res</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">%</span> <span class="n">p</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">m</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">k</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">k</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">)</span> <span class="n">res</span> <span class="o">=</span> <span class="n">res</span> <span class="o">*</span> <span class="n">t</span> <span class="o">%</span> <span class="n">p</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">t</span> <span class="o">=</span> <span class="n">t</span> <span class="o">*</span> <span class="n">t</span> <span class="o">%</span> <span class="n">p</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">k</span> <span class="o">&gt;&gt;=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">res</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="扩展欧几里得算法--模板题-acwing-877-扩展欧几里得算法">扩展欧几里得算法 —— 模板题 AcWing 877. 扩展欧几里得算法<a hidden class="anchor" aria-hidden="true" href="#扩展欧几里得算法--模板题-acwing-877-扩展欧几里得算法">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-58-1"><a class="lnlinks" href="#hl-58-1"> 1</a>
</span><span class="lnt" id="hl-58-2"><a class="lnlinks" href="#hl-58-2"> 2</a>
</span><span class="lnt" id="hl-58-3"><a class="lnlinks" href="#hl-58-3"> 3</a>
</span><span class="lnt" id="hl-58-4"><a class="lnlinks" href="#hl-58-4"> 4</a>
</span><span class="lnt" id="hl-58-5"><a class="lnlinks" href="#hl-58-5"> 5</a>
</span><span class="lnt" id="hl-58-6"><a class="lnlinks" href="#hl-58-6"> 6</a>
</span><span class="lnt" id="hl-58-7"><a class="lnlinks" href="#hl-58-7"> 7</a>
</span><span class="lnt" id="hl-58-8"><a class="lnlinks" href="#hl-58-8"> 8</a>
</span><span class="lnt" id="hl-58-9"><a class="lnlinks" href="#hl-58-9"> 9</a>
</span><span class="lnt" id="hl-58-10"><a class="lnlinks" href="#hl-58-10">10</a>
</span><span class="lnt" id="hl-58-11"><a class="lnlinks" href="#hl-58-11">11</a>
</span><span class="lnt" id="hl-58-12"><a class="lnlinks" href="#hl-58-12">12</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="c1">// 求x, y，使得ax + by = gcd(a, b)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="nf">exgcd</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="kt">int</span> <span class="n">b</span><span class="p">,</span> <span class="kt">int</span> <span class="o">&amp;</span><span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="o">&amp;</span><span class="n">y</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">b</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">a</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">d</span> <span class="o">=</span> <span class="n">exgcd</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">%</span> <span class="n">b</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">y</span> <span class="o">-=</span> <span class="p">(</span><span class="n">a</span><span class="o">/</span><span class="n">b</span><span class="p">)</span> <span class="o">*</span> <span class="n">x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">d</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="高斯消元--模板题-acwing-883-高斯消元解线性方程组">高斯消元 —— 模板题 AcWing 883. 高斯消元解线性方程组<a hidden class="anchor" aria-hidden="true" href="#高斯消元--模板题-acwing-883-高斯消元解线性方程组">#</a></h3>
<p>O(n^3)时间内解n个方程n个未知数的解。</p>
<p>解：无解 ； 无穷多组解 ； 唯一解 ；</p>
<ul>
<li>完美阶梯型：唯一解</li>
<li>*0=*非零 ： *<em>无解</em></li>
<li>0=0 ： 无穷多组解</li>
</ul>
<p>高斯消元：</p>
<p>枚举每一列c：</p>
<ol>
<li>找到绝对值最大的一行</li>
<li>将该行换到最上面</li>
<li>将该行第一个数变成1</li>
<li>将下面所有行的第c列消成0</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-59-1"><a class="lnlinks" href="#hl-59-1"> 1</a>
</span><span class="lnt" id="hl-59-2"><a class="lnlinks" href="#hl-59-2"> 2</a>
</span><span class="lnt" id="hl-59-3"><a class="lnlinks" href="#hl-59-3"> 3</a>
</span><span class="lnt" id="hl-59-4"><a class="lnlinks" href="#hl-59-4"> 4</a>
</span><span class="lnt" id="hl-59-5"><a class="lnlinks" href="#hl-59-5"> 5</a>
</span><span class="lnt" id="hl-59-6"><a class="lnlinks" href="#hl-59-6"> 6</a>
</span><span class="lnt" id="hl-59-7"><a class="lnlinks" href="#hl-59-7"> 7</a>
</span><span class="lnt" id="hl-59-8"><a class="lnlinks" href="#hl-59-8"> 8</a>
</span><span class="lnt" id="hl-59-9"><a class="lnlinks" href="#hl-59-9"> 9</a>
</span><span class="lnt" id="hl-59-10"><a class="lnlinks" href="#hl-59-10">10</a>
</span><span class="lnt" id="hl-59-11"><a class="lnlinks" href="#hl-59-11">11</a>
</span><span class="lnt" id="hl-59-12"><a class="lnlinks" href="#hl-59-12">12</a>
</span><span class="lnt" id="hl-59-13"><a class="lnlinks" href="#hl-59-13">13</a>
</span><span class="lnt" id="hl-59-14"><a class="lnlinks" href="#hl-59-14">14</a>
</span><span class="lnt" id="hl-59-15"><a class="lnlinks" href="#hl-59-15">15</a>
</span><span class="lnt" id="hl-59-16"><a class="lnlinks" href="#hl-59-16">16</a>
</span><span class="lnt" id="hl-59-17"><a class="lnlinks" href="#hl-59-17">17</a>
</span><span class="lnt" id="hl-59-18"><a class="lnlinks" href="#hl-59-18">18</a>
</span><span class="lnt" id="hl-59-19"><a class="lnlinks" href="#hl-59-19">19</a>
</span><span class="lnt" id="hl-59-20"><a class="lnlinks" href="#hl-59-20">20</a>
</span><span class="lnt" id="hl-59-21"><a class="lnlinks" href="#hl-59-21">21</a>
</span><span class="lnt" id="hl-59-22"><a class="lnlinks" href="#hl-59-22">22</a>
</span><span class="lnt" id="hl-59-23"><a class="lnlinks" href="#hl-59-23">23</a>
</span><span class="lnt" id="hl-59-24"><a class="lnlinks" href="#hl-59-24">24</a>
</span><span class="lnt" id="hl-59-25"><a class="lnlinks" href="#hl-59-25">25</a>
</span><span class="lnt" id="hl-59-26"><a class="lnlinks" href="#hl-59-26">26</a>
</span><span class="lnt" id="hl-59-27"><a class="lnlinks" href="#hl-59-27">27</a>
</span><span class="lnt" id="hl-59-28"><a class="lnlinks" href="#hl-59-28">28</a>
</span><span class="lnt" id="hl-59-29"><a class="lnlinks" href="#hl-59-29">29</a>
</span><span class="lnt" id="hl-59-30"><a class="lnlinks" href="#hl-59-30">30</a>
</span><span class="lnt" id="hl-59-31"><a class="lnlinks" href="#hl-59-31">31</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="c1">// a[N][N]是增广矩阵
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="nf">gauss</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">c</span><span class="p">,</span> <span class="n">r</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="n">c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">c</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">c</span> <span class="o">++</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">t</span> <span class="o">=</span> <span class="n">r</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">r</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span> <span class="o">++</span> <span class="p">)</span>   <span class="c1">// 找到绝对值最大的行
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="k">if</span> <span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">c</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">fabs</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">t</span><span class="p">][</span><span class="n">c</span><span class="p">]))</span>
</span></span><span class="line"><span class="cl">                <span class="n">t</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">t</span><span class="p">][</span><span class="n">c</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">eps</span><span class="p">)</span> <span class="k">continue</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">c</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span> <span class="o">++</span> <span class="p">)</span> <span class="n">swap</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">t</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">i</span><span class="p">]);</span>      <span class="c1">// 将绝对值最大的行换到最顶端
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="n">c</span><span class="p">;</span> <span class="n">i</span> <span class="o">--</span> <span class="p">)</span> <span class="n">a</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">/=</span> <span class="n">a</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">];</span>      <span class="c1">// 将当前上的首位变成1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">r</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span> <span class="o">++</span> <span class="p">)</span>       <span class="c1">// 用当前行将下面所有的列消成0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="k">if</span> <span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">c</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">eps</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">n</span><span class="p">;</span> <span class="n">j</span> <span class="o">&gt;=</span> <span class="n">c</span><span class="p">;</span> <span class="n">j</span> <span class="o">--</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">                    <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">-=</span> <span class="n">a</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">c</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="n">r</span> <span class="o">++</span> <span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">r</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">r</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span> <span class="o">++</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">n</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">eps</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="mi">2</span><span class="p">;</span> <span class="c1">// 无解
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">return</span> <span class="mi">1</span><span class="p">;</span> <span class="c1">// 有无穷多组解
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">--</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">j</span> <span class="o">++</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">n</span><span class="p">]</span> <span class="o">-=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">n</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span> <span class="c1">// 有唯一解
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="递归法求组合数--模板题-acwing-885-求组合数-i">递归法求组合数 —— 模板题 <em>AcWing</em> 885. 求组合数 I<a hidden class="anchor" aria-hidden="true" href="#递归法求组合数--模板题-acwing-885-求组合数-i">#</a></h3>
<p>十万 1&lt;b&lt;a&lt;2000 O(n^2)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-60-1"><a class="lnlinks" href="#hl-60-1">1</a>
</span><span class="lnt" id="hl-60-2"><a class="lnlinks" href="#hl-60-2">2</a>
</span><span class="lnt" id="hl-60-3"><a class="lnlinks" href="#hl-60-3">3</a>
</span><span class="lnt" id="hl-60-4"><a class="lnlinks" href="#hl-60-4">4</a>
</span><span class="lnt" id="hl-60-5"><a class="lnlinks" href="#hl-60-5">5</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="c1">// c[a][b] 表示从a个苹果中选b个的方案数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">N</span><span class="p">;</span> <span class="n">i</span> <span class="o">++</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">i</span><span class="p">;</span> <span class="n">j</span> <span class="o">++</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">j</span><span class="p">)</span> <span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span> <span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">c</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span> <span class="o">%</span> <span class="n">mod</span><span class="p">;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="通过预处理逆元的方式求组合数--模板题-acwing-886-求组合数-ii">通过预处理逆元的方式求组合数 —— 模板题 AcWing 886. 求组合数 II<a hidden class="anchor" aria-hidden="true" href="#通过预处理逆元的方式求组合数--模板题-acwing-886-求组合数-ii">#</a></h3>
<p>一万 1&lt;b&lt;a&lt;10^5 O(logn)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-61-1"><a class="lnlinks" href="#hl-61-1"> 1</a>
</span><span class="lnt" id="hl-61-2"><a class="lnlinks" href="#hl-61-2"> 2</a>
</span><span class="lnt" id="hl-61-3"><a class="lnlinks" href="#hl-61-3"> 3</a>
</span><span class="lnt" id="hl-61-4"><a class="lnlinks" href="#hl-61-4"> 4</a>
</span><span class="lnt" id="hl-61-5"><a class="lnlinks" href="#hl-61-5"> 5</a>
</span><span class="lnt" id="hl-61-6"><a class="lnlinks" href="#hl-61-6"> 6</a>
</span><span class="lnt" id="hl-61-7"><a class="lnlinks" href="#hl-61-7"> 7</a>
</span><span class="lnt" id="hl-61-8"><a class="lnlinks" href="#hl-61-8"> 8</a>
</span><span class="lnt" id="hl-61-9"><a class="lnlinks" href="#hl-61-9"> 9</a>
</span><span class="lnt" id="hl-61-10"><a class="lnlinks" href="#hl-61-10">10</a>
</span><span class="lnt" id="hl-61-11"><a class="lnlinks" href="#hl-61-11">11</a>
</span><span class="lnt" id="hl-61-12"><a class="lnlinks" href="#hl-61-12">12</a>
</span><span class="lnt" id="hl-61-13"><a class="lnlinks" href="#hl-61-13">13</a>
</span><span class="lnt" id="hl-61-14"><a class="lnlinks" href="#hl-61-14">14</a>
</span><span class="lnt" id="hl-61-15"><a class="lnlinks" href="#hl-61-15">15</a>
</span><span class="lnt" id="hl-61-16"><a class="lnlinks" href="#hl-61-16">16</a>
</span><span class="lnt" id="hl-61-17"><a class="lnlinks" href="#hl-61-17">17</a>
</span><span class="lnt" id="hl-61-18"><a class="lnlinks" href="#hl-61-18">18</a>
</span><span class="lnt" id="hl-61-19"><a class="lnlinks" href="#hl-61-19">19</a>
</span><span class="lnt" id="hl-61-20"><a class="lnlinks" href="#hl-61-20">20</a>
</span><span class="lnt" id="hl-61-21"><a class="lnlinks" href="#hl-61-21">21</a>
</span><span class="lnt" id="hl-61-22"><a class="lnlinks" href="#hl-61-22">22</a>
</span><span class="lnt" id="hl-61-23"><a class="lnlinks" href="#hl-61-23">23</a>
</span><span class="lnt" id="hl-61-24"><a class="lnlinks" href="#hl-61-24">24</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="err">首先预处理出所有阶乘取模的余数</span><span class="n">fact</span><span class="p">[</span><span class="n">N</span><span class="p">]</span><span class="err">，以及所有阶乘取模的逆元</span><span class="n">infact</span><span class="p">[</span><span class="n">N</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="err">如果取模的数是质数，可以用费马小定理求逆元</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">qmi</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="kt">int</span> <span class="n">k</span><span class="p">,</span> <span class="kt">int</span> <span class="n">p</span><span class="p">)</span>    <span class="c1">// 快速幂模板
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">res</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">k</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">k</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span> <span class="n">res</span> <span class="o">=</span> <span class="p">(</span><span class="n">LL</span><span class="p">)</span><span class="n">res</span> <span class="o">*</span> <span class="n">a</span> <span class="o">%</span> <span class="n">p</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="n">LL</span><span class="p">)</span><span class="n">a</span> <span class="o">*</span> <span class="n">a</span> <span class="o">%</span> <span class="n">p</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">k</span> <span class="o">&gt;&gt;=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">res</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 预处理阶乘的余数和阶乘逆元的余数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">fact</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">infact</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">N</span><span class="p">;</span> <span class="n">i</span> <span class="o">++</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">fact</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">LL</span><span class="p">)</span><span class="n">fact</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">i</span> <span class="o">%</span> <span class="n">mod</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">infact</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">LL</span><span class="p">)</span><span class="n">infact</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">qmi</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">mod</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="n">mod</span><span class="p">)</span> <span class="o">%</span> <span class="n">mod</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">ll</span> <span class="nf">C</span><span class="p">(</span><span class="n">ll</span> <span class="n">n</span><span class="p">,</span><span class="n">ll</span> <span class="n">m</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="n">m</span><span class="o">&gt;</span><span class="n">n</span><span class="p">)</span> <span class="k">return</span> <span class="mi">0ll</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">fact</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">*</span><span class="n">infact</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="o">%</span><span class="n">mod</span><span class="o">*</span><span class="n">infact</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="n">m</span><span class="p">]</span><span class="o">%</span><span class="n">mod</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="lucas定理--模板题-acwing-887-求组合数-iii"><em>Lucas</em>定理 —— 模板题 AcWing 887. 求组合数 III<a hidden class="anchor" aria-hidden="true" href="#lucas定理--模板题-acwing-887-求组合数-iii">#</a></h3>
<p>组合数，1&lt;b&lt;a</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-62-1"><a class="lnlinks" href="#hl-62-1"> 1</a>
</span><span class="lnt" id="hl-62-2"><a class="lnlinks" href="#hl-62-2"> 2</a>
</span><span class="lnt" id="hl-62-3"><a class="lnlinks" href="#hl-62-3"> 3</a>
</span><span class="lnt" id="hl-62-4"><a class="lnlinks" href="#hl-62-4"> 4</a>
</span><span class="lnt" id="hl-62-5"><a class="lnlinks" href="#hl-62-5"> 5</a>
</span><span class="lnt" id="hl-62-6"><a class="lnlinks" href="#hl-62-6"> 6</a>
</span><span class="lnt" id="hl-62-7"><a class="lnlinks" href="#hl-62-7"> 7</a>
</span><span class="lnt" id="hl-62-8"><a class="lnlinks" href="#hl-62-8"> 8</a>
</span><span class="lnt" id="hl-62-9"><a class="lnlinks" href="#hl-62-9"> 9</a>
</span><span class="lnt" id="hl-62-10"><a class="lnlinks" href="#hl-62-10">10</a>
</span><span class="lnt" id="hl-62-11"><a class="lnlinks" href="#hl-62-11">11</a>
</span><span class="lnt" id="hl-62-12"><a class="lnlinks" href="#hl-62-12">12</a>
</span><span class="lnt" id="hl-62-13"><a class="lnlinks" href="#hl-62-13">13</a>
</span><span class="lnt" id="hl-62-14"><a class="lnlinks" href="#hl-62-14">14</a>
</span><span class="lnt" id="hl-62-15"><a class="lnlinks" href="#hl-62-15">15</a>
</span><span class="lnt" id="hl-62-16"><a class="lnlinks" href="#hl-62-16">16</a>
</span><span class="lnt" id="hl-62-17"><a class="lnlinks" href="#hl-62-17">17</a>
</span><span class="lnt" id="hl-62-18"><a class="lnlinks" href="#hl-62-18">18</a>
</span><span class="lnt" id="hl-62-19"><a class="lnlinks" href="#hl-62-19">19</a>
</span><span class="lnt" id="hl-62-20"><a class="lnlinks" href="#hl-62-20">20</a>
</span><span class="lnt" id="hl-62-21"><a class="lnlinks" href="#hl-62-21">21</a>
</span><span class="lnt" id="hl-62-22"><a class="lnlinks" href="#hl-62-22">22</a>
</span><span class="lnt" id="hl-62-23"><a class="lnlinks" href="#hl-62-23">23</a>
</span><span class="lnt" id="hl-62-24"><a class="lnlinks" href="#hl-62-24">24</a>
</span><span class="lnt" id="hl-62-25"><a class="lnlinks" href="#hl-62-25">25</a>
</span><span class="lnt" id="hl-62-26"><a class="lnlinks" href="#hl-62-26">26</a>
</span><span class="lnt" id="hl-62-27"><a class="lnlinks" href="#hl-62-27">27</a>
</span><span class="lnt" id="hl-62-28"><a class="lnlinks" href="#hl-62-28">28</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="err">若</span><span class="n">p是质数</span><span class="err">，则对于任意整数</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">m</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="err">，有：</span>
</span></span><span class="line"><span class="cl">    <span class="n">C</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span> <span class="o">=</span> <span class="n">C</span><span class="p">(</span><span class="n">n</span> <span class="o">%</span> <span class="n">p</span><span class="p">,</span> <span class="n">m</span> <span class="o">%</span> <span class="n">p</span><span class="p">)</span> <span class="o">*</span> <span class="n">C</span><span class="p">(</span><span class="n">n</span> <span class="o">/</span> <span class="n">p</span><span class="p">,</span> <span class="n">m</span> <span class="o">/</span> <span class="n">p</span><span class="p">)</span> <span class="p">(</span><span class="n">mod</span> <span class="n">p</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">qmi</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="kt">int</span> <span class="n">k</span><span class="p">)</span>       <span class="c1">// 快速幂模板
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">res</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">k</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">k</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span> <span class="n">res</span> <span class="o">=</span> <span class="p">(</span><span class="n">LL</span><span class="p">)</span><span class="n">res</span> <span class="o">*</span> <span class="n">a</span> <span class="o">%</span> <span class="n">p</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="n">LL</span><span class="p">)</span><span class="n">a</span> <span class="o">*</span> <span class="n">a</span> <span class="o">%</span> <span class="n">p</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">k</span> <span class="o">&gt;&gt;=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">res</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">C</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="kt">int</span> <span class="n">b</span><span class="p">)</span>     <span class="c1">// 通过定理求组合数C(a, b)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">res</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">a</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">b</span><span class="p">;</span> <span class="n">i</span> <span class="o">++</span><span class="p">,</span> <span class="n">j</span> <span class="o">--</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">res</span> <span class="o">=</span> <span class="p">(</span><span class="n">LL</span><span class="p">)</span><span class="n">res</span> <span class="o">*</span> <span class="n">j</span> <span class="o">%</span> <span class="n">p</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">res</span> <span class="o">=</span> <span class="p">(</span><span class="n">LL</span><span class="p">)</span><span class="n">res</span> <span class="o">*</span> <span class="n">qmi</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">p</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="o">%</span> <span class="n">p</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">res</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">lucas</span><span class="p">(</span><span class="n">LL</span> <span class="n">a</span><span class="p">,</span> <span class="n">LL</span> <span class="n">b</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">a</span> <span class="o">&lt;</span> <span class="n">p</span> <span class="o">&amp;&amp;</span> <span class="n">b</span> <span class="o">&lt;</span> <span class="n">p</span><span class="p">)</span> <span class="k">return</span> <span class="n">C</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">(</span><span class="n">LL</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="n">a</span> <span class="o">%</span> <span class="n">p</span><span class="p">,</span> <span class="n">b</span> <span class="o">%</span> <span class="n">p</span><span class="p">)</span> <span class="o">*</span> <span class="n">lucas</span><span class="p">(</span><span class="n">a</span> <span class="o">/</span> <span class="n">p</span><span class="p">,</span> <span class="n">b</span> <span class="o">/</span> <span class="n">p</span><span class="p">)</span> <span class="o">%</span> <span class="n">p</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="分解质因数法求组合数--模板题-acwing-888-求组合数-iv">分解质因数法求组合数 —— 模板题 AcWing 888. 求组合数 IV<a hidden class="anchor" aria-hidden="true" href="#分解质因数法求组合数--模板题-acwing-888-求组合数-iv">#</a></h3>
<p>当我们需要求出组合数的真实值，而非对某个数的余数时，分解质因数的方式比较好用：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-63-1"><a class="lnlinks" href="#hl-63-1"> 1</a>
</span><span class="lnt" id="hl-63-2"><a class="lnlinks" href="#hl-63-2"> 2</a>
</span><span class="lnt" id="hl-63-3"><a class="lnlinks" href="#hl-63-3"> 3</a>
</span><span class="lnt" id="hl-63-4"><a class="lnlinks" href="#hl-63-4"> 4</a>
</span><span class="lnt" id="hl-63-5"><a class="lnlinks" href="#hl-63-5"> 5</a>
</span><span class="lnt" id="hl-63-6"><a class="lnlinks" href="#hl-63-6"> 6</a>
</span><span class="lnt" id="hl-63-7"><a class="lnlinks" href="#hl-63-7"> 7</a>
</span><span class="lnt" id="hl-63-8"><a class="lnlinks" href="#hl-63-8"> 8</a>
</span><span class="lnt" id="hl-63-9"><a class="lnlinks" href="#hl-63-9"> 9</a>
</span><span class="lnt" id="hl-63-10"><a class="lnlinks" href="#hl-63-10">10</a>
</span><span class="lnt" id="hl-63-11"><a class="lnlinks" href="#hl-63-11">11</a>
</span><span class="lnt" id="hl-63-12"><a class="lnlinks" href="#hl-63-12">12</a>
</span><span class="lnt" id="hl-63-13"><a class="lnlinks" href="#hl-63-13">13</a>
</span><span class="lnt" id="hl-63-14"><a class="lnlinks" href="#hl-63-14">14</a>
</span><span class="lnt" id="hl-63-15"><a class="lnlinks" href="#hl-63-15">15</a>
</span><span class="lnt" id="hl-63-16"><a class="lnlinks" href="#hl-63-16">16</a>
</span><span class="lnt" id="hl-63-17"><a class="lnlinks" href="#hl-63-17">17</a>
</span><span class="lnt" id="hl-63-18"><a class="lnlinks" href="#hl-63-18">18</a>
</span><span class="lnt" id="hl-63-19"><a class="lnlinks" href="#hl-63-19">19</a>
</span><span class="lnt" id="hl-63-20"><a class="lnlinks" href="#hl-63-20">20</a>
</span><span class="lnt" id="hl-63-21"><a class="lnlinks" href="#hl-63-21">21</a>
</span><span class="lnt" id="hl-63-22"><a class="lnlinks" href="#hl-63-22">22</a>
</span><span class="lnt" id="hl-63-23"><a class="lnlinks" href="#hl-63-23">23</a>
</span><span class="lnt" id="hl-63-24"><a class="lnlinks" href="#hl-63-24">24</a>
</span><span class="lnt" id="hl-63-25"><a class="lnlinks" href="#hl-63-25">25</a>
</span><span class="lnt" id="hl-63-26"><a class="lnlinks" href="#hl-63-26">26</a>
</span><span class="lnt" id="hl-63-27"><a class="lnlinks" href="#hl-63-27">27</a>
</span><span class="lnt" id="hl-63-28"><a class="lnlinks" href="#hl-63-28">28</a>
</span><span class="lnt" id="hl-63-29"><a class="lnlinks" href="#hl-63-29">29</a>
</span><span class="lnt" id="hl-63-30"><a class="lnlinks" href="#hl-63-30">30</a>
</span><span class="lnt" id="hl-63-31"><a class="lnlinks" href="#hl-63-31">31</a>
</span><span class="lnt" id="hl-63-32"><a class="lnlinks" href="#hl-63-32">32</a>
</span><span class="lnt" id="hl-63-33"><a class="lnlinks" href="#hl-63-33">33</a>
</span><span class="lnt" id="hl-63-34"><a class="lnlinks" href="#hl-63-34">34</a>
</span><span class="lnt" id="hl-63-35"><a class="lnlinks" href="#hl-63-35">35</a>
</span><span class="lnt" id="hl-63-36"><a class="lnlinks" href="#hl-63-36">36</a>
</span><span class="lnt" id="hl-63-37"><a class="lnlinks" href="#hl-63-37">37</a>
</span><span class="lnt" id="hl-63-38"><a class="lnlinks" href="#hl-63-38">38</a>
</span><span class="lnt" id="hl-63-39"><a class="lnlinks" href="#hl-63-39">39</a>
</span><span class="lnt" id="hl-63-40"><a class="lnlinks" href="#hl-63-40">40</a>
</span><span class="lnt" id="hl-63-41"><a class="lnlinks" href="#hl-63-41">41</a>
</span><span class="lnt" id="hl-63-42"><a class="lnlinks" href="#hl-63-42">42</a>
</span><span class="lnt" id="hl-63-43"><a class="lnlinks" href="#hl-63-43">43</a>
</span><span class="lnt" id="hl-63-44"><a class="lnlinks" href="#hl-63-44">44</a>
</span><span class="lnt" id="hl-63-45"><a class="lnlinks" href="#hl-63-45">45</a>
</span><span class="lnt" id="hl-63-46"><a class="lnlinks" href="#hl-63-46">46</a>
</span><span class="lnt" id="hl-63-47"><a class="lnlinks" href="#hl-63-47">47</a>
</span><span class="lnt" id="hl-63-48"><a class="lnlinks" href="#hl-63-48">48</a>
</span><span class="lnt" id="hl-63-49"><a class="lnlinks" href="#hl-63-49">49</a>
</span><span class="lnt" id="hl-63-50"><a class="lnlinks" href="#hl-63-50">50</a>
</span><span class="lnt" id="hl-63-51"><a class="lnlinks" href="#hl-63-51">51</a>
</span><span class="lnt" id="hl-63-52"><a class="lnlinks" href="#hl-63-52">52</a>
</span><span class="lnt" id="hl-63-53"><a class="lnlinks" href="#hl-63-53">53</a>
</span><span class="lnt" id="hl-63-54"><a class="lnlinks" href="#hl-63-54">54</a>
</span><span class="lnt" id="hl-63-55"><a class="lnlinks" href="#hl-63-55">55</a>
</span><span class="lnt" id="hl-63-56"><a class="lnlinks" href="#hl-63-56">56</a>
</span><span class="lnt" id="hl-63-57"><a class="lnlinks" href="#hl-63-57">57</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="mf">1.</span> <span class="err">筛法求出范围内的所有质数</span>
</span></span><span class="line"><span class="cl"><span class="mf">2.</span> <span class="err">通过</span> <span class="n">C</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="o">=</span> <span class="n">a</span><span class="o">!</span> <span class="o">/</span> <span class="n">b</span><span class="o">!</span> <span class="o">/</span> <span class="p">(</span><span class="n">a</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span><span class="o">!</span> <span class="err">这个公式求出每个质因子的次数。</span> <span class="n">n</span><span class="o">!</span> <span class="err">中</span><span class="n">p的次数是</span> <span class="n">n</span> <span class="o">/</span> <span class="n">p</span> <span class="o">+</span> <span class="n">n</span> <span class="o">/</span> <span class="n">p</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">n</span> <span class="o">/</span> <span class="n">p</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="p">...</span>
</span></span><span class="line"><span class="cl"><span class="mf">3.</span> <span class="err">用高精度乘法将所有质因子相乘</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">primes</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">cnt</span><span class="p">;</span>     <span class="c1">// 存储所有质数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="n">sum</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>     <span class="c1">// 存储每个质数的次数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">bool</span> <span class="n">st</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>     <span class="c1">// 存储每个数是否已被筛掉
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">void</span> <span class="nf">get_primes</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">)</span>      <span class="c1">// 线性筛法求素数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span> <span class="o">++</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">st</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="n">primes</span><span class="p">[</span><span class="n">cnt</span> <span class="o">++</span> <span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">primes</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">n</span> <span class="o">/</span> <span class="n">i</span><span class="p">;</span> <span class="n">j</span> <span class="o">++</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">st</span><span class="p">[</span><span class="n">primes</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">%</span> <span class="n">primes</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">get</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="kt">int</span> <span class="n">p</span><span class="p">)</span>       <span class="c1">// 求n！中的次数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">res</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">res</span> <span class="o">+=</span> <span class="n">n</span> <span class="o">/</span> <span class="n">p</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">n</span> <span class="o">/=</span> <span class="n">p</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">res</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">mul</span><span class="p">(</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">a</span><span class="p">,</span> <span class="kt">int</span> <span class="n">b</span><span class="p">)</span>       <span class="c1">// 高精度乘低精度模板
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">c</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">t</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">a</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="n">i</span> <span class="o">++</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">t</span> <span class="o">+=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">c</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">t</span> <span class="o">%</span> <span class="mi">10</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">t</span> <span class="o">/=</span> <span class="mi">10</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">t</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">c</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">t</span> <span class="o">%</span> <span class="mi">10</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">t</span> <span class="o">/=</span> <span class="mi">10</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">c</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">get_primes</span><span class="p">(</span><span class="n">a</span><span class="p">);</span>  <span class="c1">// 预处理范围内的所有质数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">cnt</span><span class="p">;</span> <span class="n">i</span> <span class="o">++</span> <span class="p">)</span>     <span class="c1">// 求每个质因数的次数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">p</span> <span class="o">=</span> <span class="n">primes</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="n">sum</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">get</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="o">-</span> <span class="n">get</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="o">-</span> <span class="n">get</span><span class="p">(</span><span class="n">a</span> <span class="o">-</span> <span class="n">b</span><span class="p">,</span> <span class="n">p</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">res</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">res</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">cnt</span><span class="p">;</span> <span class="n">i</span> <span class="o">++</span> <span class="p">)</span>     <span class="c1">// 用高精度乘法将所有质因子相乘
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">sum</span><span class="p">[</span><span class="n">i</span><span class="p">];</span> <span class="n">j</span> <span class="o">++</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">res</span> <span class="o">=</span> <span class="n">mul</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">primes</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="卡特兰数--模板题-acwing-889-满足条件的01序列">卡特兰数 —— 模板题 AcWing 889. 满足条件的01序列<a hidden class="anchor" aria-hidden="true" href="#卡特兰数--模板题-acwing-889-满足条件的01序列">#</a></h3>
<p>给定n个0和n个1，它们按照某种顺序排成长度为2n的序列，满足任意前缀中0的个数都不少于1的个数的序列的数量为：
$$
Cat(n) = C(2n, n) / (n + 1)
$$</p>
<h3 id="容斥原理">容斥原理<a hidden class="anchor" aria-hidden="true" href="#容斥原理">#</a></h3>
<p>找1~n中能至少被素数p1,p2,&hellip;,pn一个整除的整数有多少个。</p>
<p>位运算对应容斥原理集合，1~n中能被x整除的个数为n/x，奇数加上，偶数减去</p>
<h3 id="nim尼姆游戏--模板题-acwing-891-nim游戏">NIM(尼姆)游戏 —— 模板题 AcWing 891. Nim游戏<a hidden class="anchor" aria-hidden="true" href="#nim尼姆游戏--模板题-acwing-891-nim游戏">#</a></h3>
<p>给定<strong>N</strong>堆物品，第<strong>i</strong>堆物品有<strong>Ai</strong>个。两名玩家轮流行动，每次可以任选一堆，取走任意多个物品，可把一堆取光，但不能不取。取走最后一件物品者获胜。两人都采取最优策略，问先手是否必胜。</p>
<p>我们把这种游戏称为<strong>NIM</strong>博弈。把游戏过程中面临的状态称为局面。整局游戏第一个行动的称为先手，第二个行动的称为后手。若在某一局面下无论采取何种行动，都会输掉游戏，则称该局面必败。
所谓采取最优策略是指，若在某一局面下存在某种行动，使得行动后对面面临必败局面，则优先采取该行动。同时，这样的局面被称为必胜。我们讨论的博弈问题一般都只考虑理想情况，即两人均无失误，都采取最优策略行动时游戏的结果。
<strong>NIM</strong>博弈不存在平局，只有<strong>先手必胜</strong>和<strong>先手必败</strong>两种情况。</p>
<p><strong>定理</strong>： <strong>NIM</strong>博弈<strong>先手必胜</strong>，当且仅当 A1 ^ A2 ^ … ^ An != 0</p>
<p>公平组合游戏ICG
若一个游戏满足：</p>
<p>由两名玩家交替行动；
在游戏进程的任意时刻，可以执行的合法行动与轮到哪名玩家无关；
不能行动的玩家判负；
则称该游戏为一个公平组合游戏。
NIM博弈属于公平组合游戏，但城建的棋类游戏，比如围棋，就不是公平组合游戏。因为围棋交战双方分别只能落黑子和白子，胜负判定也比较复杂，不满足条件2和条件3。</p>
<p><strong>有向图游戏</strong>
给定一个有向无环图，图中有一个唯一的起点，在起点上放有一枚棋子。两名玩家交替地把这枚棋子沿有向边进行移动，每次可以移动一步，无法移动者判负。该游戏被称为有向图游戏。
任何一个公平组合游戏都可以转化为有向图游戏。具体方法是，把每个局面看成图中的一个节点，并且从每个局面向沿着合法行动能够到达的下一个局面连有向边。</p>
<p><strong>Mex运算</strong>
设S表示一个非负整数集合。定义mex(S)为求出不属于集合S的最小非负整数的运算，即：
mex(S) = min{x}, x属于自然数，且x不属于S</p>
<p><strong>SG函数</strong>
在有向图游戏中，对于每个节点x，设从x出发共有k条有向边，分别到达节点y1, y2, …, yk，定义SG(x)为x的后继节点y1, y2, …, yk 的SG函数值构成的集合再执行**mex(S)**运算的结果，即：
SG(x) = mex({SG(y1), SG(y2), …, SG(yk)})
特别地，整个有向图游戏G的SG函数值被定义为有向图游戏起点s的SG函数值，即SG(G) = SG(s)。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-64-1"><a class="lnlinks" href="#hl-64-1"> 1</a>
</span><span class="lnt" id="hl-64-2"><a class="lnlinks" href="#hl-64-2"> 2</a>
</span><span class="lnt" id="hl-64-3"><a class="lnlinks" href="#hl-64-3"> 3</a>
</span><span class="lnt" id="hl-64-4"><a class="lnlinks" href="#hl-64-4"> 4</a>
</span><span class="lnt" id="hl-64-5"><a class="lnlinks" href="#hl-64-5"> 5</a>
</span><span class="lnt" id="hl-64-6"><a class="lnlinks" href="#hl-64-6"> 6</a>
</span><span class="lnt" id="hl-64-7"><a class="lnlinks" href="#hl-64-7"> 7</a>
</span><span class="lnt" id="hl-64-8"><a class="lnlinks" href="#hl-64-8"> 8</a>
</span><span class="lnt" id="hl-64-9"><a class="lnlinks" href="#hl-64-9"> 9</a>
</span><span class="lnt" id="hl-64-10"><a class="lnlinks" href="#hl-64-10">10</a>
</span><span class="lnt" id="hl-64-11"><a class="lnlinks" href="#hl-64-11">11</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">sg</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">return</span> <span class="n">f</span><span class="p">[</span><span class="n">x</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="n">unordered_set</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">S</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">m</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="kt">int</span> <span class="n">sum</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="n">sum</span><span class="p">)</span> <span class="n">S</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="n">sg</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">sum</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="p">;</span> <span class="n">i</span><span class="o">++</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">S</span><span class="p">.</span><span class="n">count</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">            	<span class="k">return</span> <span class="n">f</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="有向图游戏的和--模板题-acwing-893-集合-nim游戏">有向图游戏的和 —— 模板题 AcWing 893. 集合-Nim游戏<a hidden class="anchor" aria-hidden="true" href="#有向图游戏的和--模板题-acwing-893-集合-nim游戏">#</a></h3>
<p>设G1, G2, …, Gm 是<strong>m个有向图游戏</strong>。定义有向图游戏G，它的行动规则是任选某个有向图游戏Gi，并在Gi上行动一步。G被称为有向图游戏G1, G2, …, Gm的和。
有向图游戏的<strong>和的SG函数值</strong>等于它包含的各个子游戏SG函数值的异或和，即：
SG(G) = SG(G1) ^ SG(G2) ^ … ^ SG(Gm)</p>
<p>定理
有向图游戏的某个局面必胜，当且仅当该局面对应节点的SG函数值大于0。
有向图游戏的某个局面必败，当且仅当该局面对应节点的SG函数值等于0。</p>
<p>作者：yxc
链接：https://www.acwing.com/blog/content/406/
来源：AcWing
著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。</p>
<h2 id="时空复杂度分析">时空复杂度分析<a hidden class="anchor" aria-hidden="true" href="#时空复杂度分析">#</a></h2>
<p>当处理ACM或笔试题时，通常时间限制为1秒或2秒。在这种情况下，C++代码中的操作次数应控制在10^7 到 10^8之间，这是最佳范围。</p>
<p>以下是在不同数据规模下，代码的时间复杂度和算法选择的指导：</p>
<ol>
<li><strong>n ≤ 30</strong>：指数级别，使用DFS+剪枝，状态压缩DP。</li>
<li><strong>n ≤ 100</strong>：O(n^3)，适用于Floyd、DP、高斯消元。</li>
<li><strong>n ≤ 1000</strong>：O(n^2)或O(n^2*logn)，适用于DP、分治、高斯消元、朴素版Dijkstra、朴素版Prim、Bellman-Ford。</li>
<li><strong>n ≤ 10000</strong>：O(n * √n)，适用于块状链表、分块、莫队。</li>
<li><strong>n ≤ 100000</strong>：O(nlogn)，适用于各种排序、线段树、树状数组、集合/映射、堆、拓扑排序、Dijkstra+堆、Prim、Kruskal、SPFA、求凸包、求半平面交、二分、CDQ分治、整体二分、后缀数组、树链剖分、动态树。</li>
<li><strong>n &lt; 1000000</strong>：O(n)或常数较小的O(nlogn)，适用于单调队列、哈希映射、双指针扫描、BFS、并查集、KMP、AC自动机、常数较小的O(nlogn)的做法（如排序、树状数组、堆、Dijkstra、SPFA）。</li>
<li><strong>n &lt; 10000000</strong>：O(n)，适用于双指针扫描、KMP、AC自动机、线性筛素数。</li>
<li><strong>n ≤ 10^9</strong>：O(n√n)，适用于判断质数。</li>
<li><strong>n ≤ 10^18</strong>：O(logn)，适用于最大公约数、快速幂、数位DP。</li>
<li><strong>n ≤ 10^1000</strong>：O((logn)^2)，适用于高精度加减乘除。</li>
<li><strong>n ≤ 10^100000</strong>：O(logk × loglogk)，其中k表示位数，适用于高精度加减、FFT/NTT。</li>
</ol>
<p>动态规划计算量 ： 状态数 * 状态转移数量</p>
<p>1 Byte = 8 bit</p>
<p>1KB = 1024 Byte</p>
<p>1MB = 1024<em>1024</em>1024 Byte</p>
<p>1GB = 1024 * 1024 * 1024 Byte</p>
<p>int 4 Byte</p>
<p>char 1 Byte</p>
<p>double, long long 8 Byte</p>
<h1 id="动态规划">动态规划<a hidden class="anchor" aria-hidden="true" href="#动态规划">#</a></h1>
<p>常见模型</p>
<h2 id="背包-九讲">背包 九讲<a hidden class="anchor" aria-hidden="true" href="#背包-九讲">#</a></h2>
<h3 id="01背包">01背包<a hidden class="anchor" aria-hidden="true" href="#01背包">#</a></h3>
<p><strong>每件物品最多可以用一次</strong></p>
<p>体积从大到小的原因 ： 如果从小到大，则<code>f[j-w[i]]+v[i]</code>实际是<code>f[i-1][j-w[i]]+v[i]</code>，需要的是上一维度f[i-1]维度，所以从大到小可以使用上一维度的，因为这一维度的还没有被计算到。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-65-1"><a class="lnlinks" href="#hl-65-1">1</a>
</span><span class="lnt" id="hl-65-2"><a class="lnlinks" href="#hl-65-2">2</a>
</span><span class="lnt" id="hl-65-3"><a class="lnlinks" href="#hl-65-3">3</a>
</span><span class="lnt" id="hl-65-4"><a class="lnlinks" href="#hl-65-4">4</a>
</span><span class="lnt" id="hl-65-5"><a class="lnlinks" href="#hl-65-5">5</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl">    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="n">V</span><span class="p">;</span><span class="n">j</span><span class="o">&gt;=</span><span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="n">j</span><span class="o">--</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">            <span class="n">f</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">max</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">j</span><span class="p">],</span><span class="n">f</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">+</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="完全背包">完全背包<a hidden class="anchor" aria-hidden="true" href="#完全背包">#</a></h3>
<p>每件物品可以用无限次</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-66-1"><a class="lnlinks" href="#hl-66-1">1</a>
</span><span class="lnt" id="hl-66-2"><a class="lnlinks" href="#hl-66-2">2</a>
</span><span class="lnt" id="hl-66-3"><a class="lnlinks" href="#hl-66-3">3</a>
</span><span class="lnt" id="hl-66-4"><a class="lnlinks" href="#hl-66-4">4</a>
</span><span class="lnt" id="hl-66-5"><a class="lnlinks" href="#hl-66-5">5</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl">    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="n">j</span><span class="o">&lt;=</span><span class="n">V</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">            <span class="n">f</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">max</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">j</span><span class="p">],</span><span class="n">f</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">+</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="多重背包">多重背包<a hidden class="anchor" aria-hidden="true" href="#多重背包">#</a></h3>
<p>每件物品特定数量</p>
<h4 id="二进制优化">二进制优化<a hidden class="anchor" aria-hidden="true" href="#二进制优化">#</a></h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-67-1"><a class="lnlinks" href="#hl-67-1"> 1</a>
</span><span class="lnt" id="hl-67-2"><a class="lnlinks" href="#hl-67-2"> 2</a>
</span><span class="lnt" id="hl-67-3"><a class="lnlinks" href="#hl-67-3"> 3</a>
</span><span class="lnt" id="hl-67-4"><a class="lnlinks" href="#hl-67-4"> 4</a>
</span><span class="lnt" id="hl-67-5"><a class="lnlinks" href="#hl-67-5"> 5</a>
</span><span class="lnt" id="hl-67-6"><a class="lnlinks" href="#hl-67-6"> 6</a>
</span><span class="lnt" id="hl-67-7"><a class="lnlinks" href="#hl-67-7"> 7</a>
</span><span class="lnt" id="hl-67-8"><a class="lnlinks" href="#hl-67-8"> 8</a>
</span><span class="lnt" id="hl-67-9"><a class="lnlinks" href="#hl-67-9"> 9</a>
</span><span class="lnt" id="hl-67-10"><a class="lnlinks" href="#hl-67-10">10</a>
</span><span class="lnt" id="hl-67-11"><a class="lnlinks" href="#hl-67-11">11</a>
</span><span class="lnt" id="hl-67-12"><a class="lnlinks" href="#hl-67-12">12</a>
</span><span class="lnt" id="hl-67-13"><a class="lnlinks" href="#hl-67-13">13</a>
</span><span class="lnt" id="hl-67-14"><a class="lnlinks" href="#hl-67-14">14</a>
</span><span class="lnt" id="hl-67-15"><a class="lnlinks" href="#hl-67-15">15</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl">    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">a</span><span class="o">&gt;&gt;</span><span class="n">b</span><span class="o">&gt;&gt;</span><span class="n">c</span><span class="p">;</span> <span class="c1">//权重a,价值b，数量c
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="kt">int</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span><span class="p">(</span><span class="n">k</span><span class="o">&lt;=</span><span class="n">c</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">            <span class="n">cnt</span><span class="o">++</span><span class="p">;</span> <span class="n">c</span><span class="o">-=</span><span class="n">k</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">w</span><span class="p">[</span><span class="n">cnt</span><span class="p">]</span><span class="o">=</span><span class="n">k</span><span class="o">*</span><span class="n">a</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">v</span><span class="p">[</span><span class="n">cnt</span><span class="p">]</span><span class="o">=</span><span class="n">k</span><span class="o">*</span><span class="n">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">k</span><span class="o">*=</span><span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="n">c</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">            <span class="n">cnt</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">w</span><span class="p">[</span><span class="n">cnt</span><span class="p">]</span><span class="o">=</span><span class="n">c</span><span class="o">*</span><span class="n">a</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">v</span><span class="p">[</span><span class="n">cnt</span><span class="p">]</span><span class="o">=</span><span class="n">c</span><span class="o">*</span><span class="n">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="c1">//之后用01背包
</span></span></span></code></pre></td></tr></table>
</div>
</div><h4 id="单调队列优化">单调队列优化<a hidden class="anchor" aria-hidden="true" href="#单调队列优化">#</a></h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-68-1"><a class="lnlinks" href="#hl-68-1"> 1</a>
</span><span class="lnt" id="hl-68-2"><a class="lnlinks" href="#hl-68-2"> 2</a>
</span><span class="lnt" id="hl-68-3"><a class="lnlinks" href="#hl-68-3"> 3</a>
</span><span class="lnt" id="hl-68-4"><a class="lnlinks" href="#hl-68-4"> 4</a>
</span><span class="lnt" id="hl-68-5"><a class="lnlinks" href="#hl-68-5"> 5</a>
</span><span class="lnt" id="hl-68-6"><a class="lnlinks" href="#hl-68-6"> 6</a>
</span><span class="lnt" id="hl-68-7"><a class="lnlinks" href="#hl-68-7"> 7</a>
</span><span class="lnt" id="hl-68-8"><a class="lnlinks" href="#hl-68-8"> 8</a>
</span><span class="lnt" id="hl-68-9"><a class="lnlinks" href="#hl-68-9"> 9</a>
</span><span class="lnt" id="hl-68-10"><a class="lnlinks" href="#hl-68-10">10</a>
</span><span class="lnt" id="hl-68-11"><a class="lnlinks" href="#hl-68-11">11</a>
</span><span class="lnt" id="hl-68-12"><a class="lnlinks" href="#hl-68-12">12</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl">    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span> <span class="c1">// 遍历每件物品
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">memcpy</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="k">sizeof</span> <span class="n">g</span><span class="p">);</span> <span class="c1">// 将上一轮的最优解拷贝给g数组
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">r</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">r</span><span class="o">&lt;</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="n">r</span><span class="o">++</span><span class="p">){</span> <span class="c1">// 遍历余数r（用于优化循环）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="kt">int</span> <span class="n">h</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">t</span><span class="o">=-</span><span class="mi">1</span><span class="p">;</span> <span class="c1">// 滑动窗口的起始索引和结束索引
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">l</span><span class="o">=</span><span class="n">r</span><span class="p">;</span><span class="n">l</span><span class="o">&lt;=</span><span class="n">V</span><span class="p">;</span><span class="n">l</span><span class="o">+=</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]){</span> <span class="c1">// 遍历背包容量，间隔为当前物品体积
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="k">while</span><span class="p">(</span><span class="n">h</span><span class="o">&lt;=</span><span class="n">t</span> <span class="o">&amp;&amp;</span> <span class="n">l</span><span class="o">-</span><span class="n">q</span><span class="p">[</span><span class="n">h</span><span class="p">]</span><span class="o">&gt;</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="n">h</span><span class="o">++</span><span class="p">;</span> <span class="c1">// 如果窗口左边界超出限制，则左边界右移
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="k">while</span><span class="p">(</span><span class="n">h</span><span class="o">&lt;=</span><span class="n">t</span> <span class="o">&amp;&amp;</span> <span class="n">g</span><span class="p">[</span><span class="n">q</span><span class="p">[</span><span class="n">t</span><span class="p">]]</span> <span class="o">+</span> <span class="p">(</span><span class="n">l</span><span class="o">-</span><span class="n">q</span><span class="p">[</span><span class="n">t</span><span class="p">])</span><span class="o">/</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&lt;=</span><span class="n">g</span><span class="p">[</span><span class="n">l</span><span class="p">])</span> <span class="n">t</span><span class="o">--</span><span class="p">;</span> <span class="c1">// 保持窗口单调性，将窗口内不符合条件的解移除
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="n">q</span><span class="p">[</span><span class="o">++</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">l</span><span class="p">;</span> <span class="c1">// 将当前状态的背包容量加入窗口
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="n">f</span><span class="p">[</span><span class="n">l</span><span class="p">]</span> <span class="o">=</span> <span class="n">g</span><span class="p">[</span><span class="n">q</span><span class="p">[</span><span class="n">h</span><span class="p">]]</span> <span class="o">+</span> <span class="p">(</span><span class="n">l</span><span class="o">-</span><span class="n">q</span><span class="p">[</span><span class="n">h</span><span class="p">])</span><span class="o">/</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">];</span> <span class="c1">// 更新当前状态的最优解
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="分组背包">分组背包<a hidden class="anchor" aria-hidden="true" href="#分组背包">#</a></h3>
<p>若干组，一组只能选一个</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-69-1"><a class="lnlinks" href="#hl-69-1">1</a>
</span><span class="lnt" id="hl-69-2"><a class="lnlinks" href="#hl-69-2">2</a>
</span><span class="lnt" id="hl-69-3"><a class="lnlinks" href="#hl-69-3">3</a>
</span><span class="lnt" id="hl-69-4"><a class="lnlinks" href="#hl-69-4">4</a>
</span><span class="lnt" id="hl-69-5"><a class="lnlinks" href="#hl-69-5">5</a>
</span><span class="lnt" id="hl-69-6"><a class="lnlinks" href="#hl-69-6">6</a>
</span><span class="lnt" id="hl-69-7"><a class="lnlinks" href="#hl-69-7">7</a>
</span><span class="lnt" id="hl-69-8"><a class="lnlinks" href="#hl-69-8">8</a>
</span><span class="lnt" id="hl-69-9"><a class="lnlinks" href="#hl-69-9">9</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl">    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="n">V</span><span class="p">;</span><span class="n">j</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">--</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">            <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">k</span><span class="o">&lt;=</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="n">k</span><span class="o">++</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span><span class="p">(</span><span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">k</span><span class="p">]</span><span class="o">&lt;=</span><span class="n">j</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">                    <span class="n">f</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">max</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">j</span><span class="p">],</span><span class="n">f</span><span class="p">[</span><span class="n">j</span><span class="o">-</span> <span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="p">]</span><span class="o">+</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">k</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="混合背包">混合背包<a hidden class="anchor" aria-hidden="true" href="#混合背包">#</a></h3>
<p>转换成01背包问题</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-70-1"><a class="lnlinks" href="#hl-70-1"> 1</a>
</span><span class="lnt" id="hl-70-2"><a class="lnlinks" href="#hl-70-2"> 2</a>
</span><span class="lnt" id="hl-70-3"><a class="lnlinks" href="#hl-70-3"> 3</a>
</span><span class="lnt" id="hl-70-4"><a class="lnlinks" href="#hl-70-4"> 4</a>
</span><span class="lnt" id="hl-70-5"><a class="lnlinks" href="#hl-70-5"> 5</a>
</span><span class="lnt" id="hl-70-6"><a class="lnlinks" href="#hl-70-6"> 6</a>
</span><span class="lnt" id="hl-70-7"><a class="lnlinks" href="#hl-70-7"> 7</a>
</span><span class="lnt" id="hl-70-8"><a class="lnlinks" href="#hl-70-8"> 8</a>
</span><span class="lnt" id="hl-70-9"><a class="lnlinks" href="#hl-70-9"> 9</a>
</span><span class="lnt" id="hl-70-10"><a class="lnlinks" href="#hl-70-10">10</a>
</span><span class="lnt" id="hl-70-11"><a class="lnlinks" href="#hl-70-11">11</a>
</span><span class="lnt" id="hl-70-12"><a class="lnlinks" href="#hl-70-12">12</a>
</span><span class="lnt" id="hl-70-13"><a class="lnlinks" href="#hl-70-13">13</a>
</span><span class="lnt" id="hl-70-14"><a class="lnlinks" href="#hl-70-14">14</a>
</span><span class="lnt" id="hl-70-15"><a class="lnlinks" href="#hl-70-15">15</a>
</span><span class="lnt" id="hl-70-16"><a class="lnlinks" href="#hl-70-16">16</a>
</span><span class="lnt" id="hl-70-17"><a class="lnlinks" href="#hl-70-17">17</a>
</span><span class="lnt" id="hl-70-18"><a class="lnlinks" href="#hl-70-18">18</a>
</span><span class="lnt" id="hl-70-19"><a class="lnlinks" href="#hl-70-19">19</a>
</span><span class="lnt" id="hl-70-20"><a class="lnlinks" href="#hl-70-20">20</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl">    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">a</span><span class="o">&gt;&gt;</span><span class="n">b</span><span class="o">&gt;&gt;</span><span class="n">s</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="n">s</span><span class="o">==-</span><span class="mi">1</span><span class="p">)</span> <span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span> <span class="nf">if</span><span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="n">s</span><span class="o">=</span><span class="n">V</span><span class="o">/</span><span class="n">a</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span><span class="p">(</span><span class="n">k</span><span class="o">&lt;=</span><span class="n">s</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">            <span class="n">s</span><span class="o">-=</span><span class="n">k</span><span class="p">;</span> <span class="n">cnt</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">v</span><span class="p">[</span><span class="n">cnt</span><span class="p">]</span> <span class="o">=</span> <span class="n">k</span><span class="o">*</span><span class="n">a</span><span class="p">;</span> <span class="n">w</span><span class="p">[</span><span class="n">cnt</span><span class="p">]</span> <span class="o">=</span> <span class="n">k</span><span class="o">*</span><span class="n">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">k</span><span class="o">*=</span><span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="n">s</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">            <span class="n">cnt</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">v</span><span class="p">[</span><span class="n">cnt</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span><span class="o">*</span><span class="n">a</span><span class="p">;</span> <span class="n">w</span><span class="p">[</span><span class="n">cnt</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span><span class="o">*</span><span class="n">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">cnt</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="n">V</span><span class="p">;</span><span class="n">j</span><span class="o">&gt;=</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="n">j</span><span class="o">--</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">            <span class="n">f</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">f</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">+</span><span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="二维费用的背包问题">二维费用的背包问题<a hidden class="anchor" aria-hidden="true" href="#二维费用的背包问题">#</a></h3>
<p>采用两层循环</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-71-1"><a class="lnlinks" href="#hl-71-1"> 1</a>
</span><span class="lnt" id="hl-71-2"><a class="lnlinks" href="#hl-71-2"> 2</a>
</span><span class="lnt" id="hl-71-3"><a class="lnlinks" href="#hl-71-3"> 3</a>
</span><span class="lnt" id="hl-71-4"><a class="lnlinks" href="#hl-71-4"> 4</a>
</span><span class="lnt" id="hl-71-5"><a class="lnlinks" href="#hl-71-5"> 5</a>
</span><span class="lnt" id="hl-71-6"><a class="lnlinks" href="#hl-71-6"> 6</a>
</span><span class="lnt" id="hl-71-7"><a class="lnlinks" href="#hl-71-7"> 7</a>
</span><span class="lnt" id="hl-71-8"><a class="lnlinks" href="#hl-71-8"> 8</a>
</span><span class="lnt" id="hl-71-9"><a class="lnlinks" href="#hl-71-9"> 9</a>
</span><span class="lnt" id="hl-71-10"><a class="lnlinks" href="#hl-71-10">10</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl">    <span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">N</span><span class="o">&gt;&gt;</span><span class="n">V</span><span class="o">&gt;&gt;</span><span class="n">W</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">N</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">v</span><span class="o">&gt;&gt;</span><span class="n">m</span><span class="o">&gt;&gt;</span><span class="n">w</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="n">V</span><span class="p">;</span><span class="n">j</span><span class="o">&gt;=</span><span class="n">v</span><span class="p">;</span><span class="n">j</span><span class="o">--</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">            <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">k</span><span class="o">=</span><span class="n">W</span><span class="p">;</span><span class="n">k</span><span class="o">&gt;=</span><span class="n">m</span><span class="p">;</span><span class="n">k</span><span class="o">--</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">                <span class="n">f</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">],</span> <span class="n">f</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="n">v</span><span class="p">][</span><span class="n">k</span><span class="o">-</span><span class="n">m</span><span class="p">]</span> <span class="o">+</span> <span class="n">w</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">f</span><span class="p">[</span><span class="n">V</span><span class="p">][</span><span class="n">W</span><span class="p">]</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="线性dp">线性dp<a hidden class="anchor" aria-hidden="true" href="#线性dp">#</a></h2>
<h4 id="数字三角形">数字三角形<a hidden class="anchor" aria-hidden="true" href="#数字三角形">#</a></h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-72-1"><a class="lnlinks" href="#hl-72-1">1</a>
</span><span class="lnt" id="hl-72-2"><a class="lnlinks" href="#hl-72-2">2</a>
</span><span class="lnt" id="hl-72-3"><a class="lnlinks" href="#hl-72-3">3</a>
</span><span class="lnt" id="hl-72-4"><a class="lnlinks" href="#hl-72-4">4</a>
</span><span class="lnt" id="hl-72-5"><a class="lnlinks" href="#hl-72-5">5</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;=</span><span class="n">i</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">			<span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">+=</span><span class="n">max</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">],</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="lis">LIS<a hidden class="anchor" aria-hidden="true" href="#lis">#</a></h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-73-1"><a class="lnlinks" href="#hl-73-1">1</a>
</span><span class="lnt" id="hl-73-2"><a class="lnlinks" href="#hl-73-2">2</a>
</span><span class="lnt" id="hl-73-3"><a class="lnlinks" href="#hl-73-3">3</a>
</span><span class="lnt" id="hl-73-4"><a class="lnlinks" href="#hl-73-4">4</a>
</span><span class="lnt" id="hl-73-5"><a class="lnlinks" href="#hl-73-5">5</a>
</span><span class="lnt" id="hl-73-6"><a class="lnlinks" href="#hl-73-6">6</a>
</span><span class="lnt" id="hl-73-7"><a class="lnlinks" href="#hl-73-7">7</a>
</span><span class="lnt" id="hl-73-8"><a class="lnlinks" href="#hl-73-8">8</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">i</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">			<span class="k">if</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">&lt;</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">max</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">		<span class="n">ma</span><span class="o">=</span><span class="n">max</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">ma</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="lcs">LCS<a hidden class="anchor" aria-hidden="true" href="#lcs">#</a></h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-74-1"><a class="lnlinks" href="#hl-74-1">1</a>
</span><span class="lnt" id="hl-74-2"><a class="lnlinks" href="#hl-74-2">2</a>
</span><span class="lnt" id="hl-74-3"><a class="lnlinks" href="#hl-74-3">3</a>
</span><span class="lnt" id="hl-74-4"><a class="lnlinks" href="#hl-74-4">4</a>
</span><span class="lnt" id="hl-74-5"><a class="lnlinks" href="#hl-74-5">5</a>
</span><span class="lnt" id="hl-74-6"><a class="lnlinks" href="#hl-74-6">6</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;=</span><span class="n">m</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">			<span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">max</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">],</span><span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">			<span class="k">if</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="n">b</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="区间dp">区间dp<a hidden class="anchor" aria-hidden="true" href="#区间dp">#</a></h3>
<h4 id="石子合并">石子合并<a hidden class="anchor" aria-hidden="true" href="#石子合并">#</a></h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-75-1"><a class="lnlinks" href="#hl-75-1"> 1</a>
</span><span class="lnt" id="hl-75-2"><a class="lnlinks" href="#hl-75-2"> 2</a>
</span><span class="lnt" id="hl-75-3"><a class="lnlinks" href="#hl-75-3"> 3</a>
</span><span class="lnt" id="hl-75-4"><a class="lnlinks" href="#hl-75-4"> 4</a>
</span><span class="lnt" id="hl-75-5"><a class="lnlinks" href="#hl-75-5"> 5</a>
</span><span class="lnt" id="hl-75-6"><a class="lnlinks" href="#hl-75-6"> 6</a>
</span><span class="lnt" id="hl-75-7"><a class="lnlinks" href="#hl-75-7"> 7</a>
</span><span class="lnt" id="hl-75-8"><a class="lnlinks" href="#hl-75-8"> 8</a>
</span><span class="lnt" id="hl-75-9"><a class="lnlinks" href="#hl-75-9"> 9</a>
</span><span class="lnt" id="hl-75-10"><a class="lnlinks" href="#hl-75-10">10</a>
</span><span class="lnt" id="hl-75-11"><a class="lnlinks" href="#hl-75-11">11</a>
</span><span class="lnt" id="hl-75-12"><a class="lnlinks" href="#hl-75-12">12</a>
</span><span class="lnt" id="hl-75-13"><a class="lnlinks" href="#hl-75-13">13</a>
</span><span class="lnt" id="hl-75-14"><a class="lnlinks" href="#hl-75-14">14</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl">	<span class="n">memset</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mh">0x3f</span><span class="p">,</span> <span class="k">sizeof</span> <span class="n">f</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">len</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span><span class="n">len</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">len</span><span class="o">++</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">+</span><span class="n">len</span><span class="o">-</span><span class="mi">1</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">			<span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="n">len</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">len</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">             	<span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>  <span class="c1">// 边界初始化
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="k">continue</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">			<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">k</span><span class="o">=</span><span class="n">i</span><span class="p">;</span><span class="n">k</span><span class="o">&lt;</span><span class="n">j</span><span class="p">;</span><span class="n">k</span><span class="o">++</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">				<span class="n">f</span><span class="p">[</span><span class="n">l</span><span class="p">][</span><span class="n">r</span><span class="p">]</span><span class="o">=</span><span class="n">min</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">l</span><span class="p">][</span><span class="n">r</span><span class="p">],</span><span class="n">f</span><span class="p">[</span><span class="n">l</span><span class="p">][</span><span class="n">k</span><span class="p">]</span><span class="o">+</span><span class="n">f</span><span class="p">[</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">r</span><span class="p">]</span><span class="o">+</span><span class="n">s</span><span class="p">[</span><span class="n">r</span><span class="p">]</span><span class="o">-</span><span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="o">-</span><span class="mi">1</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">f</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">n</span><span class="p">];</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="数位统计dp">数位统计dp<a hidden class="anchor" aria-hidden="true" href="#数位统计dp">#</a></h2>
<p>状态表示</p>
<p>分情况讨论</p>
<h2 id="状态压缩-dp">状态压缩 dp<a hidden class="anchor" aria-hidden="true" href="#状态压缩-dp">#</a></h2>
<p>蒙德里安的梦想</p>
<p>最短Hamilton距离</p>
<h2 id="树形dp">树形dp<a hidden class="anchor" aria-hidden="true" href="#树形dp">#</a></h2>
<p>没有上司的舞会</p>
<h3 id="记忆化">记忆化<a hidden class="anchor" aria-hidden="true" href="#记忆化">#</a></h3>
<p>滑雪</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="hl-76-1"><a class="lnlinks" href="#hl-76-1"> 1</a>
</span><span class="lnt" id="hl-76-2"><a class="lnlinks" href="#hl-76-2"> 2</a>
</span><span class="lnt" id="hl-76-3"><a class="lnlinks" href="#hl-76-3"> 3</a>
</span><span class="lnt" id="hl-76-4"><a class="lnlinks" href="#hl-76-4"> 4</a>
</span><span class="lnt" id="hl-76-5"><a class="lnlinks" href="#hl-76-5"> 5</a>
</span><span class="lnt" id="hl-76-6"><a class="lnlinks" href="#hl-76-6"> 6</a>
</span><span class="lnt" id="hl-76-7"><a class="lnlinks" href="#hl-76-7"> 7</a>
</span><span class="lnt" id="hl-76-8"><a class="lnlinks" href="#hl-76-8"> 8</a>
</span><span class="lnt" id="hl-76-9"><a class="lnlinks" href="#hl-76-9"> 9</a>
</span><span class="lnt" id="hl-76-10"><a class="lnlinks" href="#hl-76-10">10</a>
</span><span class="lnt" id="hl-76-11"><a class="lnlinks" href="#hl-76-11">11</a>
</span><span class="lnt" id="hl-76-12"><a class="lnlinks" href="#hl-76-12">12</a>
</span><span class="lnt" id="hl-76-13"><a class="lnlinks" href="#hl-76-13">13</a>
</span><span class="lnt" id="hl-76-14"><a class="lnlinks" href="#hl-76-14">14</a>
</span><span class="lnt" id="hl-76-15"><a class="lnlinks" href="#hl-76-15">15</a>
</span><span class="lnt" id="hl-76-16"><a class="lnlinks" href="#hl-76-16">16</a>
</span><span class="lnt" id="hl-76-17"><a class="lnlinks" href="#hl-76-17">17</a>
</span><span class="lnt" id="hl-76-18"><a class="lnlinks" href="#hl-76-18">18</a>
</span><span class="lnt" id="hl-76-19"><a class="lnlinks" href="#hl-76-19">19</a>
</span><span class="lnt" id="hl-76-20"><a class="lnlinks" href="#hl-76-20">20</a>
</span><span class="lnt" id="hl-76-21"><a class="lnlinks" href="#hl-76-21">21</a>
</span><span class="lnt" id="hl-76-22"><a class="lnlinks" href="#hl-76-22">22</a>
</span><span class="lnt" id="hl-76-23"><a class="lnlinks" href="#hl-76-23">23</a>
</span><span class="lnt" id="hl-76-24"><a class="lnlinks" href="#hl-76-24">24</a>
</span><span class="lnt" id="hl-76-25"><a class="lnlinks" href="#hl-76-25">25</a>
</span><span class="lnt" id="hl-76-26"><a class="lnlinks" href="#hl-76-26">26</a>
</span><span class="lnt" id="hl-76-27"><a class="lnlinks" href="#hl-76-27">27</a>
</span><span class="lnt" id="hl-76-28"><a class="lnlinks" href="#hl-76-28">28</a>
</span><span class="lnt" id="hl-76-29"><a class="lnlinks" href="#hl-76-29">29</a>
</span><span class="lnt" id="hl-76-30"><a class="lnlinks" href="#hl-76-30">30</a>
</span><span class="lnt" id="hl-76-31"><a class="lnlinks" href="#hl-76-31">31</a>
</span><span class="lnt" id="hl-76-32"><a class="lnlinks" href="#hl-76-32">32</a>
</span><span class="lnt" id="hl-76-33"><a class="lnlinks" href="#hl-76-33">33</a>
</span><span class="lnt" id="hl-76-34"><a class="lnlinks" href="#hl-76-34">34</a>
</span><span class="lnt" id="hl-76-35"><a class="lnlinks" href="#hl-76-35">35</a>
</span><span class="lnt" id="hl-76-36"><a class="lnlinks" href="#hl-76-36">36</a>
</span><span class="lnt" id="hl-76-37"><a class="lnlinks" href="#hl-76-37">37</a>
</span><span class="lnt" id="hl-76-38"><a class="lnlinks" href="#hl-76-38">38</a>
</span><span class="lnt" id="hl-76-39"><a class="lnlinks" href="#hl-76-39">39</a>
</span><span class="lnt" id="hl-76-40"><a class="lnlinks" href="#hl-76-40">40</a>
</span><span class="lnt" id="hl-76-41"><a class="lnlinks" href="#hl-76-41">41</a>
</span><span class="lnt" id="hl-76-42"><a class="lnlinks" href="#hl-76-42">42</a>
</span><span class="lnt" id="hl-76-43"><a class="lnlinks" href="#hl-76-43">43</a>
</span><span class="lnt" id="hl-76-44"><a class="lnlinks" href="#hl-76-44">44</a>
</span><span class="lnt" id="hl-76-45"><a class="lnlinks" href="#hl-76-45">45</a>
</span><span class="lnt" id="hl-76-46"><a class="lnlinks" href="#hl-76-46">46</a>
</span><span class="lnt" id="hl-76-47"><a class="lnlinks" href="#hl-76-47">47</a>
</span><span class="lnt" id="hl-76-48"><a class="lnlinks" href="#hl-76-48">48</a>
</span><span class="lnt" id="hl-76-49"><a class="lnlinks" href="#hl-76-49">49</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="cp">#include&lt;bits/stdc++.h&gt;
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="cp">#define ll long long
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">const</span> <span class="kt">int</span> <span class="n">maxn</span><span class="o">=</span><span class="mf">1e4</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">ll</span> <span class="n">f</span><span class="p">[</span><span class="n">maxn</span><span class="p">][</span><span class="n">maxn</span><span class="p">],</span><span class="n">g</span><span class="p">[</span><span class="n">maxn</span><span class="p">][</span><span class="n">maxn</span><span class="p">];</span> <span class="c1">//distance
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">struct</span> <span class="nc">node</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ll</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">num</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span><span class="n">a</span><span class="p">[</span><span class="n">maxn</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="k">struct</span> <span class="nc">cmp</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">bool</span> <span class="nf">operator</span> <span class="p">()</span> <span class="p">(</span><span class="n">node</span> <span class="n">x</span><span class="p">,</span><span class="n">node</span> <span class="n">y</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">x</span><span class="p">.</span><span class="n">num</span><span class="o">&gt;</span><span class="n">y</span><span class="p">.</span><span class="n">num</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">ll</span> <span class="n">n</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">ma</span><span class="o">=-</span><span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">n</span><span class="o">&gt;&gt;</span><span class="n">m</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">priority_queue</span><span class="o">&lt;</span><span class="n">node</span><span class="p">,</span> <span class="n">vector</span><span class="o">&lt;</span><span class="n">node</span><span class="o">&gt;</span><span class="p">,</span><span class="n">cmp</span><span class="o">&gt;</span><span class="n">pq</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span><span class="p">(</span><span class="n">ll</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span><span class="p">(</span><span class="n">ll</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;=</span><span class="n">m</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">            <span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">node</span> <span class="n">a</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">a</span><span class="p">.</span><span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">a</span><span class="p">.</span><span class="n">j</span><span class="o">=</span><span class="n">j</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">a</span><span class="p">.</span><span class="n">num</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">g</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">a</span><span class="p">.</span><span class="n">num</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">pq</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">a</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="n">pq</span><span class="p">.</span><span class="n">empty</span><span class="p">()){</span>
</span></span><span class="line"><span class="cl">        <span class="n">node</span> <span class="n">t</span><span class="o">=</span><span class="n">pq</span><span class="p">.</span><span class="n">top</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">pq</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">ll</span> <span class="n">i</span><span class="o">=</span><span class="n">t</span><span class="p">.</span><span class="n">i</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">ll</span> <span class="n">j</span><span class="o">=</span><span class="n">t</span><span class="p">.</span><span class="n">j</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">ll</span> <span class="n">nu</span><span class="o">=</span><span class="n">t</span><span class="p">.</span><span class="n">num</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="n">g</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">&lt;</span><span class="n">nu</span><span class="p">)</span> <span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">max</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">],</span><span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="n">g</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">&lt;</span><span class="n">nu</span><span class="p">)</span> <span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">max</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">],</span><span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="n">g</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">&lt;</span><span class="n">nu</span><span class="p">)</span> <span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">max</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">],</span><span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="n">g</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">&lt;</span><span class="n">nu</span><span class="p">)</span> <span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">max</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">],</span><span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">ma</span><span class="o">=</span><span class="n">max</span><span class="p">(</span><span class="n">ma</span><span class="p">,</span><span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">ma</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="习题课">习题课<a hidden class="anchor" aria-hidden="true" href="#习题课">#</a></h1>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://kennems.github.io/tags/%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0/">算法笔记</a></li>
    </ul>
        
    
    <ul id="categories">
      
        <li><a href="https://kennems.github.io/categories/%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0">算法笔记</a> </li>
      
    </ul>
    
    
<nav class="paginav">
  <a class="prev" href="https://kennems.github.io/posts/tech/java20%E5%A4%A9%E9%80%9F%E6%88%90%E5%9F%BA%E7%A1%80%E8%AF%BE%E7%A8%8B/">
    <span class="title">« 上一页</span>
    <br>
    <span>Java20天速成——基础课程</span>
  </a>
  <a class="next" href="https://kennems.github.io/posts/tech/%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0%E4%BA%8C%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84python%E5%AE%9E%E7%8E%B0/">
    <span class="title">下一页 »</span>
    <br>
    <span>算法笔记（二）——数据结构(Python实现)</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="https://kennems.github.io/">Kennem&#39;s Blog</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = '复制';

        function copyingDone() {
            copybutton.innerHTML = '已复制！';
            setTimeout(() => {
                copybutton.innerHTML = '复制';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
<footer class="footer">
    <script async src="https://busuanzi.sukap.cn/busuanzi.pure.mini.js"></script>
    <span id="busuanzi_container">
        <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
        Visitors: <span id="busuanzi_value_page_uv"></span>
        Views: <span id="busuanzi_value_page_pv"></span>

        
    </span>
</footer>



</body>

</html>
