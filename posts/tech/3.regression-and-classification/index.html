<!DOCTYPE html>
<html lang="zh" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">

<meta name="msvalidate.01" content="DF5FE493CC759E62BFE073BEA8EFD472" />
<title>3. Regression and Classification | Kennem&#39;s Blog</title>
<meta name="keywords" content="机器学习">
<meta name="description" content="机器学习笔记">
<meta name="author" content="ShowGuan">
<link rel="canonical" href="https://kennems.github.io/posts/tech/3.regression-and-classification/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.92e6d237fe179cc604a93575ea9ce4dbea8c09a9b1c7aa3449a9a0514c2b3ab5.css" integrity="sha256-kubSN/4XnMYEqTV16pzk2&#43;qMCamxx6o0SamgUUwrOrU=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://kennems.github.io/img/sun.png">
<link rel="icon" type="image/png" sizes="16x16" href="https://kennems.github.io/img/sun.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://kennems.github.io/img/sun.png">
<link rel="apple-touch-icon" href="https://kennems.github.io/img/sun.png">
<link rel="mask-icon" href="https://kennems.github.io/img/sun.png">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="zh" href="https://kennems.github.io/posts/tech/3.regression-and-classification/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous">

<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.js" integrity="sha384-VQ8d8WVFw0yHhCk5E8I86oOhv48xLpnDZx5T9GogA/Y84DcCKWXDmSDfn13bzFZY" crossorigin="anonymous"></script>

<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/contrib/auto-render.min.js" integrity="sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR" crossorigin="anonymous"
    onload="renderMathInElement(document.body);"></script>


<script>
document.addEventListener("DOMContentLoaded", function() {
    renderMathInElement(document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "$", right: "$", display: false}
        ]
    });
});
</script>


<link href="https://fonts.cdnfonts.com/css/code-new-roman" rel="stylesheet">
                <meta property="og:title" content="3. Regression and Classification" />
<meta property="og:description" content="机器学习笔记" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://kennems.github.io/posts/tech/3.regression-and-classification/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-09-02T22:30:13+08:00" />
<meta property="article:modified_time" content="2023-09-02T22:20:13+08:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="3. Regression and Classification"/>
<meta name="twitter:description" content="机器学习笔记"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "📚文章",
      "item": "https://kennems.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "💻技术",
      "item": "https://kennems.github.io/posts/tech/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "3. Regression and Classification",
      "item": "https://kennems.github.io/posts/tech/3.regression-and-classification/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "3. Regression and Classification",
  "name": "3. Regression and Classification",
  "description": "机器学习笔记",
  "keywords": [
    "机器学习"
  ],
  "articleBody": "Officially begin Deep = Many hidden layers\nNeurall Network Find a function in function set.\nGoodness of function Pick the best function\nBackpropagation - Backward Pass(反向传播) 反向的neural network\nRegression Stock Market Forecast Self-driving Car Recommendation Step 1 : Model A set of function\nStep 2 : Goodness of Function $$ \\hat{y}^1代表x^1对应的确切值 $$\nLoss function L： $$ L(f)=L(w,b) ~ Estimated ~ y ~ basedoninputfunction $$\n$$ L(w,b)=\\sum_{n=1}^{10}(\\hat{y}^n-(b+w\\cdot x_{cp}^n))^2 $$\nStep 3 ：Best Function In linear regression, the loss function L is convex.\nOverfitting\nRegularization $$ L(w,b)=\\sum_{n=1}^{10}(\\hat{y}^n-(b+w\\cdot x_{cp}^n))^2+\\lambda\\cdot \\sum(w_i)^2 $$\n不需要考虑bias，调整平滑程度，smooth\nGradient descent Overfitting and Regularization Classification independently and identically distributed(i.i.d) $$ L(h^{train},D_{all})-L(h^{all}, d_{all}) \\leq \\delta\\ we\\ need \\ \\forall h \\in \\H, |L(h,D_{train}) -L(h,D_{all}) | \\leq \\delta/2\\ L(h^{train},D_{all})\\leq L(h^{train},D_{all}) + \\delta/2 $$ 重温数码宝贝：\n模型出现bad的概率： $$ P(D_{train}\\ is\\ bad)\\leq |H| \\cdot 2exp(-2N\\epsilon^2 ) \\ N \\ge \\frac{log(2|H|/\\delta)}{2\\epsilon^2} $$ Tradeoff of Model Complexity\nTraining data for Classification pair\nIdeal Alternatives Function(Model): $$ f(x)\\ x -\u003e g(x)\u003e0~Output=class1\\ else\\ Output=class2 $$\nlossfunction: The number of times of get incotrrect results on training data. $$ L(f) = \\sum_{n}\\delta(f(x^n)\\neq\\hat{y}^n) $$\nFind the best function; Example : Perceptron, SVM Prior $$ P(C_1|x)=\\frac{P(x|C_1)P(C_1)}{P(x|C_1)P(C_1)+P(x|C_2)P(C_2)} $$\nGaussian Maximum Likelihood\n2D array or 3D array mean the array with 2 or 3 axes respectively, but the n-dimensional vector mean the vector of length n.\nLearn something that can really differ you from others.\nLogistics Regression Function Set $$ f_{w,b}=\\sigma(\\sum_{i}w_ix_i)+b $$\nOutput : Between 0 and 1 $$ f_{w,b}(x)=P_{w,b}(C_1|x) $$\n$$ w^,b^=arg\\ \\underset{w,b}{max}L(w,b)\\ 等同于 w^,b^ = arg\\ \\underset{w,b}{min}-lnL(w,b) $$\nCross Entropy: $$ Distribution \\ p: p(x=1)=\\hat{y}^n\\ p(x=0)=1-\\hat{y}^n\\ Distribution \\ q: q(x=1)=f(x^n)\\ q(x=0)=1-f(x^n)\\ H(p,q)=-\\sum_xp(x)ln(q(x)) $$\nLoss Function $$ L(f)=\\sum_nC(f(x^n),\\hat{y}^n)\\ C(f(x^n),\\hat{y}^n)=-[\\hat{y}^nlnf(x^n)+(1-\\hat{y}^n)ln(1-f(x^n))] $$\nUpdate logistic regression 和 linear regression 形式完全相同 $$ w_i\\gets w_i-\\eta \\sum_{n}-(\\hat{y}^n-f_{w,b}(x^n))x_i^n $$\nDiscriminative (logistic) \u0026 Generative (Gaussian描述) Generative做了某些假设。\nBenefit of generative model With the assumption of probability distribution, less training data is needed With the assumption of probability distribution, more robust to the noise Priors and class-dependent probabilities can be estimated from different sources. Multi-class Classification SoftMax $$ Softmax(z_i)=\\frac{e^{z_i}}{\\sum_{c=1}^{C} e^{z_c}}\\ 1 \u003e y_i’ \u003e 0\\ \\sum_iy_i’=1 $$\nLimitation of Logistic Regression 只能画一条直线\nFeature Transformation Cascading logistic regression models Optimization Issue 层数较多表现的反而没有层数较少的好\nOver fitting 增加训练资料\nData augmentation\nconstrained model\nLess parameters, sharing parameters Less features Early stopping CNN-\u003e比较没有弹性的model\n分Training Set\nN-fold Cross Validation Optimization Fail H : Hessian\nTayler Series Approximation $$ L(\\theta) \\approx L(\\theta^\\prime)+\\frac{1}{2}(\\theta-\\theta^\\prime)^TH(\\theta-\\theta^\\prime) $$\nH is positive definte = All eigen values are positive -\u003e local minima H is negative definte = All eigen values are negative -\u003e **local ** Some eigen values are positive , and some are negative -\u003e Saddle point 在高维下local minima可能会变成saddle poing\nTips for training : Batch and Momentum Batch 1 epoch = see all the batches once -\u003e shuffle after each epoch\nMomentum Movement not just based on gradient, but previous movement.\nDifferent parameters needs different learning rate $$ \\theta_i^{t+1} \\gets \\theta_i^t-\\frac{\\eta}{\\sigma_i^t}g_i^t\\ \\sigma_i^t=\\sqrt{\\frac{1}{t+1}\\sum_{i=0}^t(g_i^t)^2} $$\nAdagred\nRMSProp $$ \\theta_i^{t+1} \\gets \\theta_i^t-\\frac{\\eta}{\\sigma_i^t}g_i^t\\ \\sigma_i^t = \\sqrt{\\alpha(\\sigma_i^{t-1})^2+(1-\\alpha)(g_i^t)^2} $$\nAdam : RMSProp + Momentum\nLearning Rate Sceduling $$ \\theta_i^{t+1} \\gets \\theta_i^t-\\frac{\\eta^t}{\\sigma_i^t}g_i^t\\ $$\nWarm Up New Optimization ",
  "wordCount" : "685",
  "inLanguage": "zh",
  "datePublished": "2023-09-02T22:30:13+08:00",
  "dateModified": "2023-09-02T22:20:13+08:00",
  "author":{
    "@type": "Person",
    "name": "ShowGuan"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://kennems.github.io/posts/tech/3.regression-and-classification/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Kennem's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://kennems.github.io/img/sun.png"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://kennems.github.io/" accesskey="h" title="Kennem&#39;s Blog (Alt + H)">
                <img src="https://kennems.github.io/img/sun.png" alt="" aria-label="logo"
                    height="35">Kennem&#39;s Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://kennems.github.io/" title="🏠主页">
                    <span>🏠主页</span>
                </a>
            </li>
            <li>
                <a href="https://kennems.github.io/search" title="🔍搜索 (Alt &#43; /)" accesskey=/>
                    <span>🔍搜索</span>
                </a>
            </li>
            <li>
                <a href="https://kennems.github.io/posts" title="📚文章">
                    <span>📚文章</span>
                </a>
            </li>
            <li>
                <a href="https://kennems.github.io/archives/" title="⏱时间轴">
                    <span>⏱时间轴</span>
                </a>
            </li>
            <li>
                <a href="https://kennems.github.io/tags" title="🔖标签">
                    <span>🔖标签</span>
                </a>
            </li>
            <li>
                <a href="https://kennems.github.io/categories" title="🗂️分类">
                    <span>🗂️分类</span>
                </a>
            </li>
            <li>
                <a href="https://kennems.github.io/about" title="🙋🏻‍♂️关于">
                    <span>🙋🏻‍♂️关于</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://kennems.github.io/">主页</a>&nbsp;»&nbsp;<a href="https://kennems.github.io/posts/">📚文章</a>&nbsp;»&nbsp;<a href="https://kennems.github.io/posts/tech/">💻技术</a></div>
    <h1 class="post-title entry-hint-parent">
      3. Regression and Classification
    </h1>
    <div class="post-description">
      机器学习笔记
    </div>
    <div class="post-meta"><span title='2023-09-02 22:30:13 +0800 CST'>2023-09-02</span>&nbsp;·&nbsp;2 分钟&nbsp;·&nbsp;685 字&nbsp;·&nbsp;updated:&nbsp;2023-09-02&nbsp;·&nbsp;ShowGuan

</div>
	
	 <div class="post-password">
        
    </div>
  </header> <div class="toc">
    <details  open>
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">目录</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#officially-begin" aria-label="Officially begin">Officially begin</a><ul>
                        <ul>
                        
                <li>
                    <a href="#neurall-network" aria-label="Neurall Network">Neurall Network</a></li>
                <li>
                    <a href="#goodness-of-function" aria-label="Goodness of function">Goodness of function</a></li>
                <li>
                    <a href="#backpropagation---backward-pass%e5%8f%8d%e5%90%91%e4%bc%a0%e6%92%ad" aria-label="Backpropagation - Backward Pass(反向传播)">Backpropagation - Backward Pass(反向传播)</a></li></ul>
                    </ul>
                </li>
                <li>
                    <a href="#regression" aria-label="Regression">Regression</a><ul>
                        
                <li>
                    <a href="#step-1--model" aria-label="Step 1 : Model">Step 1 : Model</a></li>
                <li>
                    <a href="#step-2--goodness-of-function" aria-label="Step 2 : Goodness of Function">Step 2 : Goodness of Function</a></li>
                <li>
                    <a href="#step-3-best-function" aria-label="Step 3 ：Best Function">Step 3 ：Best Function</a></li>
                <li>
                    <a href="#regularization" aria-label="Regularization">Regularization</a></li></ul>
                </li>
                <li>
                    <a href="#classification" aria-label="Classification">Classification</a><ul>
                        
                <li>
                    <a href="#training-data-for-classification" aria-label="Training data for Classification">Training data for Classification</a></li>
                <li>
                    <a href="#ideal-alternatives" aria-label="Ideal Alternatives">Ideal Alternatives</a><ul>
                        <ul>
                        
                <li>
                    <a href="#functionmodel" aria-label="Function(Model):">Function(Model):</a></li>
                <li>
                    <a href="#lossfunction" aria-label="lossfunction:">lossfunction:</a></li>
                <li>
                    <a href="#find-the-best-function" aria-label="Find the best function;">Find the best function;</a></li></ul>
                    
                <li>
                    <a href="#prior" aria-label="Prior">Prior</a></li>
                <li>
                    <a href="#gaussian" aria-label="Gaussian">Gaussian</a></li></ul>
                </li></ul>
                </li>
                <li>
                    <a href="#logistics-regression" aria-label="Logistics Regression">Logistics Regression</a><ul>
                        
                <li>
                    <a href="#function-set" aria-label="Function Set">Function Set</a></li>
                <li>
                    <a href="#loss-function" aria-label="Loss Function">Loss Function</a></li>
                <li>
                    <a href="#update" aria-label="Update">Update</a></li>
                <li>
                    <a href="#discriminative-logistic--generative-gaussian%e6%8f%8f%e8%bf%b0" aria-label="Discriminative (logistic) &amp; Generative (Gaussian描述)">Discriminative (logistic) &amp; Generative (Gaussian描述)</a></li>
                <li>
                    <a href="#multi-class-classification" aria-label="Multi-class Classification">Multi-class Classification</a></li>
                <li>
                    <a href="#limitation-of-logistic-regression" aria-label="Limitation of Logistic Regression">Limitation of Logistic Regression</a></li>
                <li>
                    <a href="#optimization-issue" aria-label="Optimization Issue">Optimization Issue</a></li>
                <li>
                    <a href="#over-fitting" aria-label="Over fitting">Over fitting</a></li></ul>
                </li>
                <li>
                    <a href="#optimization-fail" aria-label="Optimization Fail">Optimization Fail</a></li>
                <li>
                    <a href="#tips-for-training--batch-and-momentum" aria-label="Tips for training : Batch and Momentum">Tips for training : Batch and Momentum</a><ul>
                        
                <li>
                    <a href="#batch" aria-label="Batch">Batch</a></li>
                <li>
                    <a href="#momentum" aria-label="Momentum">Momentum</a></li>
                <li>
                    <a href="#different-parameters-needs-different-learning-rate" aria-label="Different parameters needs different learning rate">Different parameters needs different learning rate</a></li>
                <li>
                    <a href="#rmsprop" aria-label="RMSProp">RMSProp</a></li>
                <li>
                    <a href="#learning-rate-sceduling" aria-label="Learning Rate Sceduling">Learning Rate Sceduling</a></li>
                <li>
                    <a href="#warm-up" aria-label="Warm Up">Warm Up</a></li></ul>
                </li>
                <li>
                    <a href="#new-optimization" aria-label="New Optimization">New Optimization</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h1 id="officially-begin">Officially begin<a hidden class="anchor" aria-hidden="true" href="#officially-begin">#</a></h1>
<p>Deep = Many hidden layers</p>
<h3 id="neurall-network">Neurall Network<a hidden class="anchor" aria-hidden="true" href="#neurall-network">#</a></h3>
<p>Find a function in function set.</p>
<h3 id="goodness-of-function">Goodness of function<a hidden class="anchor" aria-hidden="true" href="#goodness-of-function">#</a></h3>
<p>Pick the best function</p>
<h3 id="backpropagation---backward-pass反向传播">Backpropagation - Backward Pass(反向传播)<a hidden class="anchor" aria-hidden="true" href="#backpropagation---backward-pass反向传播">#</a></h3>
<p>反向的neural network</p>
<h1 id="regression">Regression<a hidden class="anchor" aria-hidden="true" href="#regression">#</a></h1>
<ul>
<li>Stock Market Forecast</li>
<li>Self-driving Car</li>
<li>Recommendation</li>
</ul>
<h2 id="step-1--model">Step 1 : Model<a hidden class="anchor" aria-hidden="true" href="#step-1--model">#</a></h2>
<p>A set of function</p>
<h2 id="step-2--goodness-of-function">Step 2 : Goodness of Function<a hidden class="anchor" aria-hidden="true" href="#step-2--goodness-of-function">#</a></h2>
<p>$$
\hat{y}^1代表x^1对应的确切值
$$</p>
<p>Loss function L：
$$
L(f)=L(w,b) ~ Estimated ~ y ~ based<del>oninput</del>function
$$</p>
<p>$$
L(w,b)=\sum_{n=1}^{10}(\hat{y}^n-(b+w\cdot x_{cp}^n))^2
$$</p>
<h2 id="step-3-best-function">Step 3 ：Best Function<a hidden class="anchor" aria-hidden="true" href="#step-3-best-function">#</a></h2>
<p>In linear regression, the loss function L is convex.</p>
<p>Overfitting</p>
<h2 id="regularization">Regularization<a hidden class="anchor" aria-hidden="true" href="#regularization">#</a></h2>
<p>$$
L(w,b)=\sum_{n=1}^{10}(\hat{y}^n-(b+w\cdot x_{cp}^n))^2+\lambda\cdot \sum(w_i)^2
$$</p>
<p>不需要考虑bias，调整平滑程度，smooth</p>
<ul>
<li>Gradient descent</li>
<li>Overfitting and Regularization</li>
</ul>
<h1 id="classification">Classification<a hidden class="anchor" aria-hidden="true" href="#classification">#</a></h1>
<p>independently and identically distributed(i.i.d)
$$
L(h^{train},D_{all})-L(h^{all}, d_{all}) \leq \delta\
we\ need \ \forall h \in \H, |L(h,D_{train}) -L(h,D_{all}) | \leq \delta/2\
L(h^{train},D_{all})\leq L(h^{train},D_{all}) + \delta/2
$$
重温数码宝贝：</p>
<p><strong>模型出现bad的概率：</strong>
$$
P(D_{train}\ is\ bad)\leq |H| \cdot 2exp(-2N\epsilon^2 ) \
N \ge \frac{log(2|H|/\delta)}{2\epsilon^2}
$$
<strong>Tradeoff of Model Complexity</strong></p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/kennems/blog-image/20230707153005.png" alt=""  />
</p>
<h2 id="training-data-for-classification">Training data for Classification<a hidden class="anchor" aria-hidden="true" href="#training-data-for-classification">#</a></h2>
<p>pair</p>
<h2 id="ideal-alternatives">Ideal Alternatives<a hidden class="anchor" aria-hidden="true" href="#ideal-alternatives">#</a></h2>
<h4 id="functionmodel">Function(Model):<a hidden class="anchor" aria-hidden="true" href="#functionmodel">#</a></h4>
<p>$$
f(x)\
x -&gt; g(x)&gt;0~Output=class1\
else\ Output=class2
$$</p>
<h4 id="lossfunction">lossfunction:<a hidden class="anchor" aria-hidden="true" href="#lossfunction">#</a></h4>
<p>The number of times of get incotrrect results on training data.
$$
L(f) = \sum_{n}\delta(f(x^n)\neq\hat{y}^n)
$$</p>
<h4 id="find-the-best-function">Find the best function;<a hidden class="anchor" aria-hidden="true" href="#find-the-best-function">#</a></h4>
<ul>
<li>Example : Perceptron, SVM</li>
</ul>
<h3 id="prior">Prior<a hidden class="anchor" aria-hidden="true" href="#prior">#</a></h3>
<p>$$
P(C_1|x)=\frac{P(x|C_1)P(C_1)}{P(x|C_1)P(C_1)+P(x|C_2)P(C_2)}
$$</p>
<h3 id="gaussian">Gaussian<a hidden class="anchor" aria-hidden="true" href="#gaussian">#</a></h3>
<p>Maximum Likelihood</p>
<p>2D array or 3D array mean the array with 2 or 3 axes respectively, but the n-dimensional vector mean the vector of length n.</p>
<p>Learn something that can really differ you from others.</p>
<h1 id="logistics-regression">Logistics Regression<a hidden class="anchor" aria-hidden="true" href="#logistics-regression">#</a></h1>
<h2 id="function-set">Function Set<a hidden class="anchor" aria-hidden="true" href="#function-set">#</a></h2>
<p>$$
f_{w,b}=\sigma(\sum_{i}w_ix_i)+b
$$</p>
<p><strong>Output</strong> : Between 0 and 1
$$
f_{w,b}(x)=P_{w,b}(C_1|x)
$$</p>
<p>$$
w^<em>,b^</em>=arg\ \underset{w,b}{max}L(w,b)\
等同于 w^<em>,b^</em> = arg\ \underset{w,b}{min}-lnL(w,b)
$$</p>
<p><strong>Cross Entropy</strong>:
$$
Distribution \ p:
p(x=1)=\hat{y}^n\
p(x=0)=1-\hat{y}^n\
Distribution \ q:
q(x=1)=f(x^n)\
q(x=0)=1-f(x^n)\
H(p,q)=-\sum_xp(x)ln(q(x))
$$</p>
<h2 id="loss-function">Loss Function<a hidden class="anchor" aria-hidden="true" href="#loss-function">#</a></h2>
<p>$$
L(f)=\sum_nC(f(x^n),\hat{y}^n)\
C(f(x^n),\hat{y}^n)=-[\hat{y}^nlnf(x^n)+(1-\hat{y}^n)ln(1-f(x^n))]
$$</p>
<h2 id="update">Update<a hidden class="anchor" aria-hidden="true" href="#update">#</a></h2>
<p>logistic regression 和 linear regression 形式完全相同
$$
w_i\gets w_i-\eta \sum_{n}-(\hat{y}^n-f_{w,b}(x^n))x_i^n
$$</p>
<h2 id="discriminative-logistic--generative-gaussian描述">Discriminative (logistic) &amp; Generative (Gaussian描述)<a hidden class="anchor" aria-hidden="true" href="#discriminative-logistic--generative-gaussian描述">#</a></h2>
<p>Generative做了某些假设。</p>
<ul>
<li>Benefit of generative model
<ul>
<li>With the assumption of probability distribution, less training data is needed</li>
<li>With the assumption of probability distribution, more robust to the noise</li>
<li><strong>Priors</strong> and <strong>class-dependent</strong> probabilities can be estimated from different sources.</li>
</ul>
</li>
</ul>
<h2 id="multi-class-classification">Multi-class Classification<a hidden class="anchor" aria-hidden="true" href="#multi-class-classification">#</a></h2>
<p><strong>SoftMax</strong>
$$
Softmax(z_i)=\frac{e^{z_i}}{\sum_{c=1}^{C} e^{z_c}}\
1 &gt; y_i&rsquo; &gt; 0\
\sum_iy_i&rsquo;=1
$$</p>
<h2 id="limitation-of-logistic-regression">Limitation of Logistic Regression<a hidden class="anchor" aria-hidden="true" href="#limitation-of-logistic-regression">#</a></h2>
<p>只能画一条直线</p>
<ul>
<li>Feature Transformation
<ul>
<li>Cascading logistic regression models</li>
</ul>
</li>
</ul>
<h2 id="optimization-issue">Optimization Issue<a hidden class="anchor" aria-hidden="true" href="#optimization-issue">#</a></h2>
<p>层数较多表现的反而没有层数较少的好</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/kennems/blog-image/20230705203112.png" alt=""  />
</p>
<h2 id="over-fitting">Over fitting<a hidden class="anchor" aria-hidden="true" href="#over-fitting">#</a></h2>
<ul>
<li>
<p>增加训练资料</p>
</li>
<li>
<p><strong>Data augmentation</strong></p>
</li>
<li>
<p>constrained model</p>
<ul>
<li>Less parameters, sharing parameters</li>
<li>Less features</li>
<li>Early stopping</li>
</ul>
</li>
</ul>
<p>CNN-&gt;比较没有弹性的model</p>
<p>分Training Set</p>
<ul>
<li>N-fold Cross Validation</li>
</ul>
<h1 id="optimization-fail">Optimization Fail<a hidden class="anchor" aria-hidden="true" href="#optimization-fail">#</a></h1>
<p>H : Hessian</p>
<p><strong>Tayler Series Approximation</strong>
$$
L(\theta) \approx L(\theta^\prime)+\frac{1}{2}(\theta-\theta^\prime)^TH(\theta-\theta^\prime)
$$</p>
<ul>
<li><strong>H</strong> is <strong>positive definte</strong> = All eigen values are positive -&gt; <strong>local minima</strong></li>
<li><strong>H</strong> is <strong>negative definte</strong> = All eigen values are negative -&gt; **local **</li>
<li>Some eigen values are positive , and some are negative -&gt; <strong>Saddle point</strong></li>
</ul>
<p>在高维下<strong>local minima</strong>可能会变成<strong>saddle poing</strong></p>
<h1 id="tips-for-training--batch-and-momentum">Tips for training : Batch and Momentum<a hidden class="anchor" aria-hidden="true" href="#tips-for-training--batch-and-momentum">#</a></h1>
<h2 id="batch">Batch<a hidden class="anchor" aria-hidden="true" href="#batch">#</a></h2>
<p>1 epoch = see all the batches once -&gt; <strong>shuffle</strong> after each epoch</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/kennems/blog-image/20230705230316.png" alt=""  />
</p>
<h2 id="momentum">Momentum<a hidden class="anchor" aria-hidden="true" href="#momentum">#</a></h2>
<p>Movement not just based on gradient, but previous movement.</p>
<h2 id="different-parameters-needs-different-learning-rate">Different parameters needs different learning rate<a hidden class="anchor" aria-hidden="true" href="#different-parameters-needs-different-learning-rate">#</a></h2>
<p>$$
\theta_i^{t+1} \gets \theta_i^t-\frac{\eta}{\sigma_i^t}g_i^t\
\sigma_i^t=\sqrt{\frac{1}{t+1}\sum_{i=0}^t(g_i^t)^2}
$$</p>
<p>Adagred</p>
<h2 id="rmsprop">RMSProp<a hidden class="anchor" aria-hidden="true" href="#rmsprop">#</a></h2>
<p>$$
\theta_i^{t+1} \gets \theta_i^t-\frac{\eta}{\sigma_i^t}g_i^t\
\sigma_i^t = \sqrt{\alpha(\sigma_i^{t-1})^2+(1-\alpha)(g_i^t)^2}
$$</p>
<p>Adam : RMSProp + Momentum</p>
<h2 id="learning-rate-sceduling">Learning Rate Sceduling<a hidden class="anchor" aria-hidden="true" href="#learning-rate-sceduling">#</a></h2>
<p>$$
\theta_i^{t+1} \gets \theta_i^t-\frac{\eta^t}{\sigma_i^t}g_i^t\
$$</p>
<h2 id="warm-up">Warm Up<a hidden class="anchor" aria-hidden="true" href="#warm-up">#</a></h2>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/kennems/blog-image/20230706094859.png" alt=""  />
</p>
<h1 id="new-optimization">New Optimization<a hidden class="anchor" aria-hidden="true" href="#new-optimization">#</a></h1>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://kennems.github.io/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/">机器学习</a></li>
    </ul>
		
	
	<ul id="categories">
	  
		<li><a href="https://kennems.github.io/en/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0">机器学习笔记</a> </li>
	  
	</ul>
	
	
<nav class="paginav">
  <a class="prev" href="https://kennems.github.io/posts/tech/2.pytorch/">
    <span class="title">« 上一页</span>
    <br>
    <span>2. PyTorch</span>
  </a>
  <a class="next" href="https://kennems.github.io/posts/tech/4.cnn/">
    <span class="title">下一页 »</span>
    <br>
    <span>4. CNN</span>
  </a>
</nav>


<ul class="share-buttons">
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share 3. Regression and Classification on x"
            href="https://x.com/intent/tweet/?text=3.%20Regression%20and%20Classification&amp;url=https%3a%2f%2fkennems.github.io%2fposts%2ftech%2f3.regression-and-classification%2f&amp;hashtags=%e6%9c%ba%e5%99%a8%e5%ad%a6%e4%b9%a0">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M512 62.554 L 512 449.446 C 512 483.97 483.97 512 449.446 512 L 62.554 512 C 28.03 512 0 483.97 0 449.446 L 0 62.554 C 0 28.03 28.029 0 62.554 0 L 449.446 0 C 483.971 0 512 28.03 512 62.554 Z M 269.951 190.75 L 182.567 75.216 L 56 75.216 L 207.216 272.95 L 63.9 436.783 L 125.266 436.783 L 235.9 310.383 L 332.567 436.783 L 456 436.783 L 298.367 228.367 L 432.367 75.216 L 371.033 75.216 Z M 127.633 110 L 164.101 110 L 383.481 400.065 L 349.5 400.065 Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share 3. Regression and Classification on linkedin"
            href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fkennems.github.io%2fposts%2ftech%2f3.regression-and-classification%2f&amp;title=3.%20Regression%20and%20Classification&amp;summary=3.%20Regression%20and%20Classification&amp;source=https%3a%2f%2fkennems.github.io%2fposts%2ftech%2f3.regression-and-classification%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share 3. Regression and Classification on reddit"
            href="https://reddit.com/submit?url=https%3a%2f%2fkennems.github.io%2fposts%2ftech%2f3.regression-and-classification%2f&title=3.%20Regression%20and%20Classification">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share 3. Regression and Classification on facebook"
            href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fkennems.github.io%2fposts%2ftech%2f3.regression-and-classification%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share 3. Regression and Classification on whatsapp"
            href="https://api.whatsapp.com/send?text=3.%20Regression%20and%20Classification%20-%20https%3a%2f%2fkennems.github.io%2fposts%2ftech%2f3.regression-and-classification%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share 3. Regression and Classification on telegram"
            href="https://telegram.me/share/url?text=3.%20Regression%20and%20Classification&amp;url=https%3a%2f%2fkennems.github.io%2fposts%2ftech%2f3.regression-and-classification%2f">
            <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28" height="30px" width="30px" fill="currentColor">
                <path
                    d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share 3. Regression and Classification on ycombinator"
            href="https://news.ycombinator.com/submitlink?t=3.%20Regression%20and%20Classification&u=https%3a%2f%2fkennems.github.io%2fposts%2ftech%2f3.regression-and-classification%2f">
            <svg version="1.1" xml:space="preserve" width="30px" height="30px" viewBox="0 0 512 512" fill="currentColor"
                xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape">
                <path
                    d="M449.446 0C483.971 0 512 28.03 512 62.554L512 449.446C512 483.97 483.97 512 449.446 512L62.554 512C28.03 512 0 483.97 0 449.446L0 62.554C0 28.03 28.029 0 62.554 0L449.446 0ZM183.8767 87.9921H121.8427L230.6673 292.4508V424.0079H281.3328V292.4508L390.1575 87.9921H328.1233L256 238.2489z" />
            </svg>
        </a>
    </li>
</ul>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2024 <a href="https://kennems.github.io/">Kennem&#39;s Blog</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = '复制';

        function copyingDone() {
            copybutton.innerHTML = '已复制！';
            setTimeout(() => {
                copybutton.innerHTML = '复制';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
<footer class="footer">
    <script async src="https://busuanzi.sukap.cn/busuanzi.pure.mini.js"></script>
    <span id="busuanzi_container">
        <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
        Visitors: <span id="busuanzi_value_page_uv"></span>
        Views: <span id="busuanzi_value_page_pv"></span>

        
    </span>
</footer>


</body>

</html>
